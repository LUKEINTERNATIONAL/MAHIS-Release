import{d as ee,ah as ze,G as Ct,E as St,ai as It,aj as Ke,$ as ae,I as Pt,a4 as Et,bf as Ye,aU as Ot,H as J,e as D,f as l,k as o,l as e,aV as xe,r as t,c as K,a as De,m as f,O as P,J as s,u as a,Q as H,F as oe,at as He,em as ya,en as ba,eo as Da,ay as wa,aE as xt,w as he,av as At,bS as ka,P as _e,aM as Ca,K as x,p as Le,bF as Sa,L as We,ep as dt,eq as pt,bk as Ge,er as mt,es as vt,c$ as ft,et as _t,eu as ht,ev as gt,d4 as yt,bR as Ia,ax as Pa,bZ as Ea,X as pe,al as nt,ak as Ce,N as ue,bt as de,a5 as ve,R as Oa,bl as Ue,b2 as xa,bn as Nt,a3 as Vt,bX as Aa,bI as Na,a6 as Q,c3 as bt,bs as Va,ew as $a,dX as Dt}from"./vendor-B45YKAfe.js";import{be as Xe,H as Ae,ag as Y,bg as $t,bf as Mt,b2 as Tt,u as Ne,_ as me,k as Te,aA as Re,aB as je,M as be,Q as Oe,S as Pe,aV as Z,t as fe,K as Fe,aP as ge,aQ as Ht,bO as Ma,bP as Ta,bF as Ha,b9 as Se,bb as Ie,bQ as Fa,aS as Ba,P as Ft,aW as wt,b0 as La,s as Ra,aI as Me,n as Ua,bo as qa,N as Wa,B as Ee,aw as kt,ao as et,as as tt,aK as Ga,ar as za}from"./index-BqZqQXlC.js";import{l as ye}from"./lodash-NJiRuGo9.js";import{P as Ya}from"./patient_complaints_service-DzSzD3-M.js";import{D as Bt}from"./DashBox-BH5GsJyv.js";import{u as ja}from"./useExposeFromStandardForm-D-pkuoEN.js";import{B as st}from"./BasicForm-DkU_7qSv.js";import{f as ot,c as Lt,a as Rt}from"./formatServerData-C1Okhs3N.js";import{A as Ka,P as Xa,D as Qa,b as Ja}from"./NextAppointment-DovFct7e.js";import{D as Za,b as en}from"./drug_prescription_service-BclmV_Up.js";import{_ as at,D as tn,A as an,R as nn,a as sn,b as on}from"./Outcome-Cvg7yR3v.js";const ln=ee({name:"Menu",components:{IonContent:Et,IonHeader:Pt,IonItem:ae,IonList:Ke,IonMenu:It,IonTitle:St,IonToolbar:Ct,List:Xe},computed:{...ze(Ne,["patient"]),...ze(Tt,["presentingComplaints"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:Mt(["#006401"]),listIcon:$t(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:Ot,pulseOutline:Ye}},watch:{$router:{async handler(){await this.updateList()},immediate:!0,deep:!0},patient:{async handler(){await this.updateList()},deep:!0}},async mounted(){await this.updateList()},methods:{async updateList(){const i=await Y.getAll(this.patient.patientID,"Presenting complaint"),r=ye.isEmpty(i)?[]:Promise.all(i.map(async u=>u.value_coded?{name:await Y.getConceptName(u.value_coded),obs_date:u.obs_datetime,duration:u.children[0].value_text}:[]));this.setListData(await r)},setListData(i){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 20px;",containSize:4,display:["Date","Presenting Complains","Duration"]}),i.forEach(r=>{this.list.push({actionBtn:!1,minHeight:"--min-height:20px;",class:"col_background",containSize:4,display:[Ae.toStandardHisFormat(r.obs_date),r.name,r.duration]})})}}}),rn={class:"modal_wrapper"};function cn(i,r,u,p,h,w){const E=J("list");return l(),D("div",rn,[o("div",null,[e(E,{listData:i.list},null,8,["listData"])])])}const un=me(ln,[["render",cn],["__scopeId","data-v-30434e22"]]),dn={key:0},pn={style:{"align-content":"center"}},mn={class:"ion-padding",slot:"content"},vn=ee({__name:"PresentingComplaints",setup(i,{expose:r}){const u=Tt(),{presentingComplaints:p}=xe(u),h=t(Te),w=t(!0),E=t(!1),N=t(!0),y=t(!1),k=t([]),d=t([]),g=t(),R=K(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:Te.search,hideSelected:!0,validation:C=>F(C==null?void 0:C.name,k.value)?"Presenting complaint already added":Re.required(C),options:d.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:Te.time,validation:C=>Re.isNotEmptyandNumber(C),grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:C=>!C||C===""?"Please select a unit.":null},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:Te.editPen,validation:C=>F(C,k.value)?"Presenting complaint already added":Re.required(C),condition:C=>{var $;return(($=C==null?void 0:C.PresentingComplaints)==null?void 0:$.name)==="Other"}},{componentType:"Alert",condition:C=>{var $;return Re.required(($=C==null?void 0:C.PresentingComplaints)==null?void 0:$.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:c}=ja(),_=async()=>{d.value=await Ya.getComplaintsList("Presenting complaint"),Oe(p.value,"PresentingComplaints","multiSelectData",d.value)},L=()=>{w.value=!1,N.value=!1,E.value=!0},O=async()=>{var W,v;const C=(W=c.value)==null?void 0:W.getFormValues();((v=c.value)==null?void 0:v.validateForm())==null&&(V(C),E.value=!1,N.value=!0)},V=C=>{var n;const $=C.duration+" "+C.duration_unit,W=C.PresentingComplaints,v=W.name==="Other"?C["Other (specify)"]:W.name;k.value.push({actionBtn:!0,btn:["delete"],name:v,concept_id:W.concept_id,duration:W.duration,durationUnits:W.duration_unit,display:[v,$],data:[{concept_id:8578,value_coded:W.concept_id,obs_datetime:Pe.getSessionDate(),child:[{concept_id:W.concept_id,value_text:$,obs_datetime:Pe.getSessionDate()}]}]}),(n=c.value)==null||n.resetForm(),y.value=!0},F=(C,$)=>$.some(W=>W.name===C),U=C=>{k.value=k.value.filter($=>$.display[0]!==C.name)},B=async()=>{const C=await Y.getObsByEncounterIdAndDate(Z.PRESENTING_COMPLAINTS),$=k.value.flatMap(W=>W.data);if($.length<=0&&C.length<=0)return fe("Presenting complaints is required");$.length<=0||(await Y.addObsToEncounterPatient($,Z.PRESENTING_COMPLAINTS),Fe("Presenting complaints saved successful"),k.value=[])};return De(async()=>{await _()}),r({onSubmit:B}),(C,$)=>{const W=J("ion-row"),v=J("ion-label"),n=J("ion-accordion"),T=J("ion-accordion-group");return l(),D(oe,null,[e(Bt,{status:w.value,content:"No presenting complaints added"},null,8,["status"]),y.value?(l(),D("span",dn,[e(Xe,{listData:k.value,"onClicked:delete":U},null,8,["listData"])])):f("",!0),E.value?(l(),P(W,{key:1},{default:s(()=>[e(je,{formData:R.value,ref_key:"formRef",ref:c},null,8,["formData"]),o("div",pn,[e(be,{fill:"clear",icon:h.value.plus,iconSlot:"icon-only","onClicked:btn":$[0]||($[0]=A=>O()),name:"Save"},null,8,["icon"])])]),_:1})):f("",!0),N.value?(l(),P(W,{key:2,style:{"margin-top":"10px"}},{default:s(()=>[e(be,{fill:"clear",icon:h.value.plus,iconSlot:"icon-only","onClicked:btn":$[1]||($[1]=A=>L()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):f("",!0),e(W,null,{default:s(()=>[e(T,{ref_key:"accordionGroup",ref:g,class:"previousView"},{default:s(()=>[e(n,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(v,{class:"previousLabel"},{default:s(()=>[...$[2]||($[2]=[H("Previous presenting complaints",-1)])]),_:1})]),_:1}),o("div",mn,[e(un)])]),_:1})]),_:1},512)]),_:1})],64)}}}),fn=me(vn,[["__scopeId","data-v-0f7271d6"]]),_n=K(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Spontaneously",value:"Spontaneously"},{label:"To speech",value:"To speech"},{label:"To pain",value:"To pain"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Oriented to time, place and person",value:"Oriented to time, place and person"},{label:"Confused",value:"Confused"},{label:"Inappropriate words",value:"Inappropriate words"},{label:"Incomprehensible sounds",value:"Incomprehensible sounds"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Obeys commands",value:"Obeys commands"},{label:"Moves to localised pain",value:"Moves to localised pain"},{label:"Flexion withdrawal from pain",value:"Flexion withdrawal from pain"},{label:"Abnormal flexion (decorticate)",value:"Abnormal flexion (decorticate)"},{label:"Abnormal extension (decerebrate)",value:"Abnormal extension (decerebrate)"},{label:"No response",value:"No response"}]}]),hn=K(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Directed eye movements",value:"Directed eye movements"},{label:"Not directed",value:"Not directed"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Appropriate cry",value:"Appropriate cry"},{label:"Inappropriate cry or moan",value:"Inappropriate cry or moan"},{label:"No cry",value:"No cry"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Localizes pain",value:"Localizes pain"},{label:"Withdraws from pain",value:"Withdraws from pain"},{label:"Non specific or no response",value:"Non specific or no response"}]}]),Ut={Spontaneously:4,"To speech":3,"To pain":2,"No response":1},qt={"Oriented to time, place and person":5,Confused:4,"Inappropriate words":3,"Incomprehensible sounds":2,"No response":1},Wt={"Obeys commands":6,"Moves to localised pain":5,"Flexion withdrawal from pain":4,"Abnormal flexion (decorticate)":3,"Abnormal extension (decerebrate)":2,"No response":1},Gt={"Not directed":0,"Directed eye movements":1},zt={"Non specific or no response":0,"Withdraws from pain":1,"Localizes pain":2},Yt={"No cry":0,"Inappropriate cry or moan":1,"Appropriate cry":2},gn={class:"allergies-container"},yn={key:0,class:"no-allergies"},bn={key:1,class:"date-groups"},Dn=["onClick"],wn={class:"date-info"},kn={class:"date-text"},Cn={class:"allergy-count"},Sn={class:"card-header"},In={class:"allergy-type"},Pn={class:"card-content"},En=ee({__name:"AllergiesListing",setup(i){const r=Ne(),{patient:u}=xe(r),p=t({}),h={antiviral:/abacavir|lamivudine|lopinavir|ritonavir|zidovudine|efavirenz|tenofovir/i,antibiotic:/penicillin|amoxicillin|cephalexin|azithromycin|ciprofloxacin|doxycycline/i,analgesic:/aspirin|ibuprofen|acetaminophen|morphine|codeine|tramadol/i,cardiac:/metoprolol|lisinopril|amlodipine|atorvastatin|warfarin/i,activated:/activated\s+charcoal/i},w={985:{name:"Other",icon:He,severity:"danger"},7759:{name:"Location/Environmental",icon:xt,severity:"info"},7579:{name:"Medical Condition",icon:wa,severity:"warning"},drug:{name:"Drug Allergy",icon:He,severity:"danger"},food:{name:"Food Allergy",icon:Da,severity:"danger"},environmental:{name:"Environmental",icon:ba,severity:"warning"},contact:{name:"Contact Allergy",icon:ya,severity:"warning"},unknown:{name:"Drug Allergy",icon:He,severity:"danger"}},E=c=>{const _=c.toLowerCase();return h.antiviral.test(_)?{type:"Antiviral Medication",icon:"shield-outline"}:h.antibiotic.test(_)?{type:"Antibiotic",icon:"bandage-outline"}:h.analgesic.test(_)?{type:"Pain Medication",icon:"fitness-outline"}:h.cardiac.test(_)?{type:"Cardiac Medication",icon:"heart-outline"}:h.activated.test(_)?{type:"Detoxification Agent",icon:"flask-outline"}:{type:"Medication",icon:"medical-outline"}},N=K(()=>{var c,_,L;return((L=(_=(c=u.value)==null?void 0:c.allergies)==null?void 0:_.saved)==null?void 0:L.length)>0}),y=K(()=>N.value?u.value.allergies.saved.map(c=>{var U;const _=((U=c.concept_id)==null?void 0:U.toString())||"unknown";console.log("###########: ",c);const L=w[_]||w.unknown;let O="Unknown",V=null;return c.value_text&&c.value_text!=="Unknown"&&c.value_text!==""?(O=c.value_text,_==="985###"&&(V=E(c.value_text))):c.concept_name&&(O=c.concept_name),{...V?{...L,name:V.type,icon:V.icon}:L,displayValue:O,conceptId:c.concept_id,date:c.obs_datetime||c.encounter_datetime,providerId:c.provider_id,locationId:c.location_id,encounterId:c.encounter_id,isDrug:_==="985",raw:c}}):[]),k=K(()=>{const c={};y.value.forEach(O=>{const V=O.date?g(O.date):"Unknown Date";c[V]||(c[V]=[]),c[V].push(O)});const _={};return Object.keys(c).sort((O,V)=>O==="Unknown Date"?1:V==="Unknown Date"?-1:new Date(V).getTime()-new Date(O).getTime()).forEach(O=>{_[O]=c[O]}),_}),d=c=>{p.value[c]=!p.value[c]},g=c=>{if(!c)return"Unknown Date";try{return new Date(c).toISOString().split("T")[0]}catch(_){return"Unknown Date"}},R=c=>{if(c==="Unknown Date")return"Unknown Date";try{const _=new Date(c),L=Ae.sessionDate(),O=new Date(L),V=new Date(O);V.setDate(V.getDate()-1);const F=_.toDateString(),U=O.toDateString(),B=V.toDateString();return F===U?"Today":F===B?"Yesterday":_.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(_){return c}};return he(()=>k.value,c=>{const _=Object.keys(c);_.length>0&&(p.value[_[0]]=!0)},{immediate:!0}),he(()=>{var c;return(c=u.value)==null?void 0:c.allergies},c=>{console.log("Allergies updated:",c)},{deep:!0}),De(()=>{var c;console.log("Allergies component mounted",(c=u.value)==null?void 0:c.allergies)}),(c,_)=>{const L=J("ion-icon"),O=J("ion-label");return l(),D("div",gn,[e(O,{class:"section-title"},{default:s(()=>[e(L,{icon:a(At),class:"alert-icon"},null,8,["icon"]),e(O,null,{default:s(()=>[..._[0]||(_[0]=[H("Allergies (Medication, Healthcare items, Environment and Food)",-1)])]),_:1})]),_:1}),N.value?(l(),D("div",bn,[(l(!0),D(oe,null,_e(k.value,(V,F)=>(l(),D("div",{key:F,class:"date-group"},[o("div",{class:Le(["date-header",{expanded:p.value[F]}]),onClick:U=>d(F)},[o("div",wn,[e(L,{icon:a(Ca),class:"date-icon"},null,8,["icon"]),o("span",kn,x(R(F)),1),o("span",Cn,"("+x(V.length)+" "+x(V.length===1?"allergy":"allergies")+")",1)]),e(L,{icon:a(Sa),class:Le(["expand-icon",{rotated:p.value[F]}])},null,8,["icon","class"])],10,Dn),o("div",{class:Le(["allergies-grid",{collapsed:!p.value[F]}])},[(l(!0),D(oe,null,_e(V,(U,B)=>(l(),D("div",{key:B,class:Le(["allergy-card",U.severity])},[o("div",Sn,[e(L,{icon:U.icon,class:"allergy-icon"},null,8,["icon"]),o("span",In,x(U.name),1)]),o("div",Pn,[o("div",{class:Le(["allergy-value",{"drug-name":U.isDrug}])},x(U.displayValue),3)])],2))),128))],2)]))),128))])):(l(),D("div",yn,[e(L,{icon:a(ka),class:"no-allergies-icon"},null,8,["icon"]),_[1]||(_[1]=o("p",null,"No known allergies",-1))]))])}}}),jt=me(En,[["__scopeId","data-v-1302dd03"]]),On=ee({name:"VisitHistory",components:{AllergiesListing:jt,IonIcon:We},setup(){const i=Ht();return{selectedAllergiesList2:K(()=>i.selectedMedicalAllergiesList),alertCircleOutline:At,documentTextOutline:Ea,femaleOutline:Pa,medicalOutline:He,warningOutline:Ia,bodyOutline:dt,eyeOutline:yt,nutritionOutline:gt,fitnessOutline:vt,pulseOutline:Ye,earOutline:ht,happyOutline:_t,manOutline:ft,moveOutline:mt,addOutline:Ge,scanOutline:pt}},data(){return{presentingComplaintsWithDuration:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},physicalExamCategories:{Eyes:{icon:yt,abnormalities:[],normal:!1},Mouth:{icon:gt,abnormalities:[],normal:!1},Ears:{icon:ht,abnormalities:[],normal:!1},Face:{icon:_t,abnormalities:[],normal:!1},Neck:{icon:ft,abnormalities:[],normal:!1},Chest:{icon:vt,abnormalities:[],normal:!1},"Chest Movement":{icon:mt,abnormalities:[],normal:!1},"Heart Sounds":{icon:Ye,abnormalities:[],normal:!1},"Breath Sounds":{icon:Ge,abnormalities:[],normal:!1},"Added Breath Sounds":{icon:Ge,abnormalities:[],normal:!1},"Abdominal Inspection":{icon:pt,abnormalities:[],normal:!1},"Genital Examination":{icon:dt,abnormalities:[],normal:!1}}}},computed:{...ze(Ne,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var i;return((i=this.presentingComplaintsWithDuration)==null?void 0:i.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var i;return((i=this.uniquePastMedicalHistory)==null?void 0:i.length)>0},hasAllergies(){var i,r;return((r=(i=this.selectedAllergiesList2)==null?void 0:i.filter(u=>u.selected))==null?void 0:r.length)>0},hasPhysicalExam(){return Object.values(this.physicalExamCategories).some(i=>i.abnormalities.length>0||i.normal)},uniquePastMedicalHistory(){return[...new Set(this.pastMedicalHistory)]},uniquePresentingComplaints(){return[...new Set(this.presentingComplaintsWithDuration.map(i=>i.name))]},isMinor(){var i,r;return Ae.getAgeInYears((r=(i=this.patient)==null?void 0:i.personInformation)==null?void 0:r.birthdate)<18},gcsScore(){var N,y,k;if(!this.hasLevelOfConsciousness)return null;const i=this.levelOfConsciousness.eyeResponse,r=this.levelOfConsciousness.motorResponse,u=this.levelOfConsciousness.verbalResponse,p=i&&(N=(this.isMinor?Gt:Ut)[i])!=null?N:0,h=r&&(y=(this.isMinor?zt:Wt)[r])!=null?y:0,w=u&&(k=(this.isMinor?Yt:qt)[u])!=null?k:0,E=p+h+w;return"(M ".concat(h," V ").concat(w," E ").concat(p,") ").concat(E,"/").concat(this.isMinor?5:15)}},methods:{async updateData(){var i;(i=this.patient)!=null&&i.patientID&&(await this.loadPresentingComplaints(),await this.loadPastMedicalHistory(),await this.loadLevelOfConsciousness(),await this.loadPregnancyStatus(),await this.loadPhysicalExam())},async loadPresentingComplaints(){try{const i=await Y.getObsByEncounterIdAndDate(Z.PRESENTING_COMPLAINTS);this.presentingComplaintsWithDuration=[];const r=i.filter(u=>u.concept_name==="Presenting complaint");for(const u of r){const p=i.find(w=>w.concept_id===u.value_coded&&w.concept_name!=="Presenting complaint"),h=await ge.getConceptName(u.value_coded);this.presentingComplaintsWithDuration.push({name:h,duration:(p==null?void 0:p.value_text)||"Duration not specified"})}}catch(i){console.error("Error loading presenting complaints:",i)}},async loadPastMedicalHistory(){try{const r=(await Y.getObsByEncounterIdAndDate(Z.PAST_MEDICAL_HISTORY)).filter(u=>u.concept_name==="Chronic disease");this.pastMedicalHistory=await Promise.all(r.map(async u=>await ge.getConceptName(u.value_coded)))}catch(i){console.error("Error loading past medical history:",i)}},async loadLevelOfConsciousness(){try{const i=await Y.getObsByEncounterIdAndDate(Z.ASSESSMENT);if(i&&Array.isArray(i)){const r=i.find(h=>h.concept_name==="Eye opening response");this.levelOfConsciousness.eyeResponse=r!=null&&r.value_coded?await ge.getConceptName(r.value_coded):null;const u=i.find(h=>h.concept_name==="Best verbal response");this.levelOfConsciousness.verbalResponse=u!=null&&u.value_coded?await ge.getConceptName(u.value_coded):null;const p=i.find(h=>h.concept_name==="Best motor response");this.levelOfConsciousness.motorResponse=p!=null&&p.value_coded?await ge.getConceptName(p.value_coded):null}}catch(i){console.error("Error loading level of consciousness:",i)}},async loadPregnancyStatus(){try{const i=await Y.getObsByEncounterIdAndDate(Z.PREGNANCY_STATUS);if(i&&Array.isArray(i)){const r=i.find(p=>p.concept_name==="Patient pregnant");this.pregnancy.patientPregnant=r!=null&&r.value_coded?await ge.getConceptName(r.value_coded):null;const u=i.find(p=>p.concept_name==="Is patient breast feeding?");this.pregnancy.breastFeeding=u!=null&&u.value_coded?await ge.getConceptName(u.value_coded):null}}catch(i){console.error("Error loading pregnancy status:",i)}},async loadPhysicalExam(){try{const i=await Y.getObsByEncounterIdAndDate(Z.PHYSICAL_EXAMINATION);Object.values(this.physicalExamCategories).forEach(r=>{r.abnormalities=[],r.normal=!1});for(const r of i)if(r.concept_id){if(r.value_coded===1065)switch(r.concept_id){case 10837:this.physicalExamCategories.Eyes.normal=!0;break;case 10842:this.physicalExamCategories.Mouth.normal=!0;break;case 11028:this.physicalExamCategories.Ears.normal=!0;break;case 10854:this.physicalExamCategories.Face.normal=!0;break;case 10858:this.physicalExamCategories.Neck.normal=!0;break;case 10894:this.physicalExamCategories.Chest.normal=!0;break;case 10903:this.physicalExamCategories["Heart Sounds"].normal=!0;break;case 10909:this.physicalExamCategories["Breath Sounds"].normal=!0;break;case 10919:case 10928:case 10939:this.physicalExamCategories["Abdominal Inspection"].normal=!0;break;case 10803:case 10946:this.physicalExamCategories["Genital Examination"].normal=!0;break}if(r.value_coded){const u=await ge.getConceptName(r.value_coded);switch(r.concept_id){case 10838:this.physicalExamCategories.Eyes.abnormalities.push(u);break;case 10843:this.physicalExamCategories.Mouth.abnormalities.push(u);break;case 10852:this.physicalExamCategories.Ears.abnormalities.push(u);break;case 10855:this.physicalExamCategories.Face.abnormalities.push(u);break;case 10859:this.physicalExamCategories.Neck.abnormalities.push(u);break;case 10897:this.physicalExamCategories.Chest.abnormalities.push(u);break;case 10904:this.physicalExamCategories["Heart Sounds"].abnormalities.push(u);break;case 10910:this.physicalExamCategories["Breath Sounds"].abnormalities.push(u);break;case 10920:case 10929:case 10939:this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(u);break;case 10797:case 10804:case 10947:this.physicalExamCategories["Genital Examination"].abnormalities.push(u);break}}}}catch(i){console.error("Error loading physical exam:",i)}}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),xn={class:"visit-container"},An={class:"visit-sections"},Nn={key:0,class:"visit-section"},Vn={class:"section-header"},$n={class:"section-content"},Mn={key:0,class:"info-item"},Tn={class:"info-value"},Hn={key:1,class:"info-item"},Fn={class:"info-value"},Bn={key:2,class:"info-item"},Ln={class:"info-value"},Rn={key:3,class:"info-item"},Un={class:"info-value highlight"},qn={key:1,class:"visit-section"},Wn={class:"section-header"},Gn={class:"complaints-container"},zn={class:"complaint-name"},Yn={class:"complaint-duration"},jn={key:2,class:"visit-section"},Kn={class:"section-header"},Xn={class:"section-content"},Qn={key:0,class:"info-item"},Jn={class:"info-value highlight"},Zn={key:1,class:"info-item"},es={class:"info-value highlight"},ts={key:3,class:"visit-section"},as={class:"section-header"},ns={class:"tags-container"},ss={class:"allergies-section"},os={class:"allergies-container"},ls={key:4,class:"visit-section"},is={class:"section-header"},rs={class:"exam-section"},cs={key:0,class:"exam-category"},us={class:"exam-category-header"},ds={class:"exam-items"},ps={key:1,class:"exam-item normal"};function ms(i,r,u,p,h,w){const E=J("ion-icon"),N=J("AllergiesListing");return l(),D("div",xn,[r[11]||(r[11]=o("div",{class:"visit-header"},[o("h5",null,"Patient's Clinical Assessment Summary")],-1)),o("div",An,[i.hasLevelOfConsciousness?(l(),D("div",Nn,[o("div",Vn,[e(E,{icon:i.alertCircleOutline,class:"section-icon"},null,8,["icon"]),r[0]||(r[0]=o("h3",null,"Level of Consciousness",-1))]),o("div",$n,[i.levelOfConsciousness.eyeResponse?(l(),D("div",Mn,[r[1]||(r[1]=o("span",{class:"info-label"},"Eye Response:",-1)),o("span",Tn,x(i.levelOfConsciousness.eyeResponse),1)])):f("",!0),i.levelOfConsciousness.verbalResponse?(l(),D("div",Hn,[r[2]||(r[2]=o("span",{class:"info-label"},"Verbal Response:",-1)),o("span",Fn,x(i.levelOfConsciousness.verbalResponse),1)])):f("",!0),i.levelOfConsciousness.motorResponse?(l(),D("div",Bn,[r[3]||(r[3]=o("span",{class:"info-label"},"Motor Response:",-1)),o("span",Ln,x(i.levelOfConsciousness.motorResponse),1)])):f("",!0),i.gcsScore?(l(),D("div",Rn,[r[4]||(r[4]=o("span",{class:"info-label"},"Score:",-1)),o("span",Un,x(i.gcsScore),1)])):f("",!0)])])):f("",!0),i.hasPresentingComplaints?(l(),D("div",qn,[o("div",Wn,[e(E,{icon:i.documentTextOutline,class:"section-icon"},null,8,["icon"]),r[5]||(r[5]=o("h3",null,"Presenting Complaints",-1))]),o("div",Gn,[(l(!0),D(oe,null,_e(i.presentingComplaintsWithDuration,(y,k)=>(l(),D("div",{class:"complaint-item",key:k},[o("div",zn,x(y.name),1),o("div",Yn,x(y.duration),1)]))),128))])])):f("",!0),i.hasPregnancyData?(l(),D("div",jn,[o("div",Kn,[e(E,{icon:i.femaleOutline,class:"section-icon"},null,8,["icon"]),r[6]||(r[6]=o("h3",null,"Pregnancy Status",-1))]),o("div",Xn,[i.pregnancy.patientPregnant?(l(),D("div",Qn,[r[7]||(r[7]=o("span",{class:"info-label"},"Pregnant:",-1)),o("span",Jn,x(i.pregnancy.patientPregnant),1)])):f("",!0),i.pregnancy.breastFeeding?(l(),D("div",Zn,[r[8]||(r[8]=o("span",{class:"info-label"},"Breastfeeding:",-1)),o("span",es,x(i.pregnancy.breastFeeding),1)])):f("",!0)])])):f("",!0),i.hasPastMedicalHistory?(l(),D("div",ts,[o("div",as,[e(E,{icon:i.medicalOutline,class:"section-icon"},null,8,["icon"]),r[9]||(r[9]=o("h3",null,"Medical History",-1))]),o("div",ns,[(l(!0),D(oe,null,_e(i.uniquePastMedicalHistory,(y,k)=>(l(),D("div",{class:"medical-tag",key:k},x(y),1))),128))])])):f("",!0),o("div",ss,[o("div",os,[e(N)])]),i.hasPhysicalExam?(l(),D("div",ls,[o("div",is,[e(E,{icon:i.bodyOutline,class:"section-icon"},null,8,["icon"]),r[10]||(r[10]=o("h3",null,"Physical Examination",-1))]),o("div",rs,[(l(!0),D(oe,null,_e(i.physicalExamCategories,(y,k)=>(l(),D(oe,{key:k},[y.abnormalities.length>0||y.normal?(l(),D("div",cs,[o("div",us,[e(E,{icon:y.icon},null,8,["icon"]),o("h4",null,x(k),1)]),o("div",ds,[y.abnormalities.length>0?(l(!0),D(oe,{key:0},_e(y.abnormalities,(d,g)=>(l(),D("div",{class:"exam-item abnormal",key:g},x(d),1))),128)):y.normal?(l(),D("div",ps," Normal examination ")):f("",!0)])])):f("",!0)],64))),128))])])):f("",!0)])])}const vs=me(On,[["render",ms],["__scopeId","data-v-795e1865"]]),fs={class:"modal_wrapper"},_s=ee({__name:"LevelOfConsciousness",setup(i,{expose:r}){var y,k;const u=Ne(),{patient:p}=xe(u),h=t(Ae.getAgeInYears((k=(y=p==null?void 0:p.value)==null?void 0:y.personInformation)==null?void 0:k.birthdate)),w=t(null),E=K(()=>{var U,B,C,$;const d=((U=w.value)==null?void 0:U.getFormValues())||{},g=d["Eye opening response"]||"",R=d["Best motor response"]||"",c=d["Best verbal response"]||"",_=h.value<18,L=(B=(_?Gt:Ut)[g])!=null?B:0,O=(C=(_?zt:Wt)[R])!=null?C:0,V=($=(_?Yt:qt)[c])!=null?$:0,F=L+O+V;return"(M ".concat(O," V ").concat(V," E ").concat(L,") ").concat(F,"/").concat(_?5:15)});return r({onSubmit:async()=>{var g;if(!w.value){console.error("Form reference is not available");return}const d=((g=w.value)==null?void 0:g.getFormValues())||{};d["Eye opening response"]||d["Best motor response"]||d["Best verbal response"]?(await Y.buildAddObsToEncounterPatient(d,Z.ASSESSMENT),w.value.resetForm(),Fe("Level of Consciousness saved successfully")):fe(" No level of consciousness data to save ")}}),(d,g)=>(l(),D("div",fs,[h.value<18?(l(),P(je,{key:0,formData:a(hn),ref_key:"formRef",ref:w},null,8,["formData"])):(l(),P(je,{key:1,formData:a(_n),ref_key:"formRef",ref:w},null,8,["formData"])),o("h5",null,x(E.value),1)]))}}),hs={class:"modal_wrapper"},gs=ee({__name:"PregnancyBreastfeeding",setup(i,{expose:r}){const u=Ma(),{pregnancy:p}=xe(u),h=()=>{};return r({onSubmit:async()=>{const E=await ot(p.value);E.length>0?(await Y.addObsToEncounterPatient(E,Z.PREGNANCY_STATUS),Fe("Pregnancy status saved successfully")):fe("No pregnancy status data to save ")}}),(E,N)=>(l(),D("div",hs,[e(st,{contentData:a(p),"onUpdate:inputValue":h},null,8,["contentData"])]))}}),ys={class:"modal_wrapper"},bs={class:"uniform_columns"},Ds=ee({__name:"PastMedicalHistory",setup(i,{expose:r}){const u=Ta(),{pastMedicalHistory:p}=xe(u),h=t([]);De(()=>{h.value=u.getInitial(),w()}),he(p,()=>{w()},{deep:!0});const w=()=>{var d;const k=["TB","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Epilepsy","Previous stroke","Peptic Ulcer Disease (PUD)","Mental disorder","Bleeding disorders","Hypertension","HIV Positive","Diabetes Mellitus"];(d=Ha(p.value,"None"))!=null&&d.checked?k.forEach(g=>{Se(p.value,"TB treatment","displayNone",!0),Oe(p.value,"TB drugs","displayNone",!0),Oe(p.value,"TB drug start date","displayNone",!0),Se(p.value,"Hypertension medication","displayNone",!0),Oe(p.value,"Current hypertension treatment regimen","displayNone",!0),Se(p.value,"HIV status","displayNone",!0),Oe(p.value,"ARV start date","displayNone",!0),Se(p.value,"Diabetes","displayNone",!0),Se(p.value,"Controlled by","displayNone",!0),Ie(p.value,g,"checked",!1),Ie(p.value,g,"disabled",!0)}):k.forEach(g=>{Ie(p.value,g,"disabled",!1)})},E=k=>{Oe(p.value,"TB drugs","popOverData",{filterData:!0,data:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"},{name:"Cycloserine 125mg"},{name:"Cycloserine 250mg"},{name:"Delamanid 50mg"},{name:"Ethambutol 100mg"},{name:"Ethambutol 400mg"},{name:"Ethionamide 250mg"},{name:"Isoniazid 100mg "},{name:"Isoniazid 300mg"},{name:"Isoniazid / Rifapentine 300mg / 300mg"},{name:"Levofloxacin 100mg"},{name:"Levofloxacin 250mg"},{name:"Linezolid 600mg"},{name:"Moxifloxacin 400mg"},{name:"Pyrazinamide 400mg"},{name:"Rifabutin 150mg Capsules"},{name:"Rifampicin 150mg/isoniazid 75mg"},{name:"Rifampicin 75mg+INH 50mg dispersible"},{name:"Rifampicin 75mg+INH 50mg+Pyrazinamide 150mg dispersible"},{name:"Rifampicin150mg/Isoniazid75mg/Pyrazinamide 400mg/Ethambutol"}]}),Oe(p.value,"Current hypertension treatment regimen","popOverData",{filterData:!0,data:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}]})},N=async()=>[...await Lt(p.value),...await ot(p.value),...await Rt(p.value)];return r({onSubmit:async()=>{const k=await N();if(k.length===0){fe("No past medical history data to save");return}await Y.addObsToEncounterPatient(k,Z.PAST_MEDICAL_HISTORY),Fe("Past medical history saved successful")}}),(k,d)=>(l(),D("div",ys,[o("div",bs,[e(st,{contentData:a(p),initialData:h.value,"onUpdate:inputValue":E,"onUpdate:selected":E},null,8,["contentData","initialData"])])]))}}),ws=me(Ds,[["__scopeId","data-v-49fdce72"]]),ks={class:"container"},Cs=ee({__name:"PhysicalExamination",setup(i,{expose:r}){const u=Fa(),p=Ne(),{physicalExam:h}=xe(u),{patient:w}=xe(p),E=t([]);De(()=>{E.value=u.getInitial(),N(),y()}),he(h,()=>{N(),y()},{deep:!0});const N=()=>{Ba(h.value,"Physical examination")=="No"?Se(h.value,"Reason why physical examination not done","displayNone",!1):(Se(h.value,"Reason why physical examination not done","displayNone",!0),Se(h.value,"Reason why physical examination not done","selectedValue",""))},y=()=>{var R,c;const g=(c=(R=w.value)==null?void 0:R.personInformation)==null?void 0:c.gender;g=="M"&&(Ie(h.value,"Vulva examination","disabled",!0),Ie(h.value,"Visible bleeding","disabled",!0)),g=="F"&&(Ie(h.value,"Urethral meatus abnormal","disabled",!0),Ie(h.value,"Scrotal swelling","disabled",!0),Ie(h.value,"Tastes swelling","disabled",!0))},k=async()=>[...await Lt(h.value),...await ot(h.value),...await Rt(h.value)];return r({onSubmit:async()=>{const g=await k();if(console.log("Selected physical data is",g),g.length===0){fe("No physical examination data to save");return}await Y.addObsToEncounterPatient(g,Z.PHYSICAL_EXAMINATION),console.log(Y.getObsByEncounterIdAndDate(Z.PHYSICAL_EXAMINATION)),Fe("Physical examination saved successful")}}),(g,R)=>{const c=J("ion-card-content"),_=J("ion-card");return l(),D("div",ks,[e(_,{class:"section"},{default:s(()=>[e(c,null,{default:s(()=>[e(st,{contentData:a(h),initialData:E.value},null,8,["contentData","initialData"])]),_:1})]),_:1})])}}}),Ss=me(Cs,[["__scopeId","data-v-0d34c6dd"]]),Is={key:0},Ps={class:"ion-padding",slot:"content"},Es={class:"nav-buttons"},Os={class:"ion-padding",slot:"content"},xs={class:"nav-buttons"},As={class:"ion-padding",slot:"content"},Ns={class:"nav-buttons"},Vs={class:"ion-padding",slot:"content"},$s={class:"nav-buttons"},Ms={class:"ion-padding",slot:"content"},Ts={class:"nav-buttons"},Hs={class:"ion-padding",slot:"content"},Fs={class:"nav-buttons"},Bs=ee({__name:"ClinicalAssessment",setup(i,{expose:r}){const u=t("loc"),p=t(0),h=t(!1),w=t(!1),E=new Ft,N=Ne(),y=()=>{p.value++},k=t(null),d=t(null),g=t(null),R=t(null),c=t(null),_=t(null),L=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>E.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}];async function O(){const v=Pe.getSessionDate(),n=[Z.ASSESSMENT,Z.PRESENTING_COMPLAINTS,Z.PAST_MEDICAL_HISTORY,Z.PHYSICAL_EXAMINATION,Z.PREGNANCY_STATUS];let T=!1;for(const A of n)try{const X=await Y.getObsByEncounterIdAndDate(A);if(X&&X.some(ne=>ne.obs_datetime?Ae.toStandardHisFormat(ne.obs_datetime)===Ae.toStandardHisFormat(v):!1)){T=!0;break}}catch(X){console.error("Error checking observations for encounter type ".concat(A,":"),X)}h.value=T}De(O),he(()=>N.patient,O);const V=K(()=>h.value),F=K(()=>L.filter(v=>typeof v.show=="function"?v.show():v.show)),U=v=>{const n=L.find(T=>T.id===v);return n?typeof n.show=="function"?n.show():n.show:!1},B=v=>F.value.findIndex(n=>n.id===v),C=v=>{const n=B(v);n>0&&(u.value=F.value[n-1].id)},$=v=>{const T=B(v)+1;T<F.value.length?u.value=F.value[T].id:(u.value="",y())};return r({onSubmit:async()=>{const v=[{ref:k,name:"PresentingComplaints"},{ref:d,name:"LevelOfConsciousness"},{ref:g,name:"PastMedicalHistory"},{ref:c,name:"PregnancyBreastfeeding"},{ref:_,name:"PhysicalExamination"}];for(const n of v)if(n.ref.value&&typeof n.ref.value.onSubmit=="function")try{await n.ref.value.onSubmit()}catch(T){console.error("Error calling ".concat(n.name," onSubmit:"),T)}else console.log("".concat(n.name," component ref not available or no onSubmit method"))}}),(v,n)=>{const T=J("ion-toggle");return l(),D(oe,null,[V.value?(l(),D("div",Is,[e(a(ae),{lines:"none"},{default:s(()=>[e(a(pe),null,{default:s(()=>[...n[14]||(n[14]=[H("Switch between Capture Mode and Summary Mode",-1)])]),_:1}),e(T,{checked:w.value,onIonChange:n[0]||(n[0]=A=>w.value=A.detail.checked),slot:"end"},null,8,["checked"])]),_:1}),w.value?f("",!0):(l(),P(vs,{key:p.value}))])):f("",!0),!V.value||w.value?(l(),P(a(ve),{key:1,style:{width:"100%"}},{default:s(()=>[e(a(nt),{value:u.value,"onUpdate:value":n[13]||(n[13]=A=>u.value=A),ref:"accordionGroup",class:"previousView"},{default:s(()=>[U("loc")?(l(),P(a(Ce),{key:0,value:"loc",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[15]||(n[15]=[H("Level of consciousness",-1)])]),_:1})]),_:1}),o("div",Ps,[e(_s,{"is-active":u.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:d,onDataSaved:y},null,8,["is-active"]),o("div",Es,[B("loc")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[1]||(n[1]=de(A=>C("loc"),["stop"]))},{default:s(()=>[...n[16]||(n[16]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[2]||(n[2]=de(A=>$("loc"),["stop"]))},{default:s(()=>[H(x(B("loc")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0),U("pc")?(l(),P(a(Ce),{key:1,value:"pc",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[17]||(n[17]=[H("Presenting complaints",-1)])]),_:1})]),_:1}),o("div",Os,[e(fn,{"is-active":u.value==="pc",onDataSaved:y,ref_key:"presentingComplaintsFormRef",ref:k},null,8,["is-active"]),o("div",xs,[B("pc")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[3]||(n[3]=de(A=>C("pc"),["stop"]))},{default:s(()=>[...n[18]||(n[18]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[4]||(n[4]=de(A=>$("pc"),["stop"]))},{default:s(()=>[H(x(B("pc")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0),U("pbs")?(l(),P(a(Ce),{key:2,value:"pbs",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[19]||(n[19]=[H("Pregnancy and breastfeeding status",-1)])]),_:1})]),_:1}),o("div",As,[e(gs,{"is-active":u.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:c,onDataSaved:y},null,8,["is-active"]),o("div",Ns,[B("pbs")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[5]||(n[5]=de(A=>C("pbs"),["stop"]))},{default:s(()=>[...n[20]||(n[20]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[6]||(n[6]=de(A=>$("pbs"),["stop"]))},{default:s(()=>[H(x(B("pbs")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0),U("pmh")?(l(),P(a(Ce),{key:3,value:"pmh",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[21]||(n[21]=[H("Past medical history",-1)])]),_:1})]),_:1}),o("div",Vs,[e(ws,{"is-active":u.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:g,onDataSaved:y},null,8,["is-active"]),o("div",$s,[B("pmh")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[7]||(n[7]=de(A=>C("pmh"),["stop"]))},{default:s(()=>[...n[22]||(n[22]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[8]||(n[8]=de(A=>$("pmh"),["stop"]))},{default:s(()=>[H(x(B("pmh")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0),U("al")?(l(),P(a(Ce),{key:4,value:"al",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[23]||(n[23]=[H("Allergies",-1)])]),_:1})]),_:1}),o("div",Ms,[e(Ka,{"is-active":u.value==="al",ref_key:"allergiesFormRef",ref:R,onDataSaved:y},null,8,["is-active"]),o("div",Ts,[B("al")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[9]||(n[9]=de(A=>C("al"),["stop"]))},{default:s(()=>[...n[24]||(n[24]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[10]||(n[10]=de(A=>$("al"),["stop"]))},{default:s(()=>[H(x(B("al")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0),U("pe")?(l(),P(a(Ce),{key:5,value:"pe",class:"_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(a(pe),{class:"previousLabel"},{default:s(()=>[...n[25]||(n[25]=[H("Physical examination",-1)])]),_:1})]),_:1}),o("div",Hs,[e(Ss,{"is-active":u.value==="pe",ref_key:"physicalExaminationFormRef",ref:_,onDataSaved:y},null,8,["is-active"]),o("div",Fs,[B("pe")>0?(l(),P(a(ue),{key:0,fill:"outline",onClick:n[11]||(n[11]=de(A=>C("pe"),["stop"]))},{default:s(()=>[...n[26]||(n[26]=[H(" Back ",-1)])]),_:1})):f("",!0),e(a(ue),{fill:"outline",onClick:n[12]||(n[12]=de(A=>$("pe"),["stop"]))},{default:s(()=>[H(x(B("pe")<F.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):f("",!0)]),_:1},8,["value"])]),_:1})):f("",!0)],64)}}}),qo=me(Bs,[["__scopeId","data-v-597092a6"]]);class Ls extends wt{constructor(r,u){super(r,8,u)}static async getDiagnosis(r="",u=1,p=10){const h=await ge.getConceptID("Qech outpatient diagnosis list");return wt.getJson("diagnosis",{id:h,name:r,page:u,page_size:p})}}const Rs=ee({name:"Menu",components:{IonContent:Et,IonHeader:Pt,IonItem:ae,IonList:Ke,IonMenu:It,IonTitle:St,IonToolbar:Ct,List:Xe},computed:{...ze(Ne,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:Mt(["#006401"]),listIcon:$t(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:Ot,pulseOutline:Ye}},async mounted(){const i=await Y.getAll(this.patient.patientID,"Primary diagnosis"),r=await Y.getAll(this.patient.patientID,"Secondary diagnosis"),u=await Y.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),p=[...i||[],...r||[],...u||[]],h=ye.isEmpty(p)?[]:Promise.all(p.map(async w=>({name:await Y.getConceptName(w.value_coded),obs_date:w.obs_datetime})));this.setListData(await h)},methods:{dismiss(){Oa.dismiss()},handleIcon(){},setActivClass(i){this.activeHeight="",this.activeBMI="",this.activeWeight="",i=="height"?this.activeHeight="_active":i=="weight"?this.activeWeight="_active":i=="BMI"&&(this.activeBMI="_active")},setListData(i){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),i.forEach(r=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[Ae.toStandardHisFormat(r.obs_date),r.name,""]})})}}}),Us={class:"modal_wrapper"};function qs(i,r,u,p,h,w){const E=J("list");return l(),D("div",Us,[o("div",null,[e(E,{listData:i.list},null,8,["listData"])])])}const Ws=me(Rs,[["render",qs],["__scopeId","data-v-88580898"]]),Gs={class:"custom_card",style:{padding:"10px"}},zs={key:0},Ys={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},js={class:"ion-padding",slot:"content"},Ks=ee({__name:"OPDDiagnosis",setup(i,{expose:r}){const u=Te,p=t(!0),h=t(!1),w=t(!0),E=t(!1),N=t(!0),y=t(""),k=t(""),d=t([]),g=t([]),R=t(),c=t(null);La();const _=K(()=>g.value.some(v=>v.data.concept_id===6542));he(g,()=>{$()},{deep:!0});const L=K(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:d.value,icon:u.search,onSearchChange:B,validation:Re.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:d.value,icon:u.search,condition:v=>v==null?void 0:v.secondaryDiagnosisCheckbox,onSearchChange:B,validation:(v,n)=>O(n,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:d.value,icon:u.search,isMultiple:!0,condition:v=>v==null?void 0:v.differentialDiagnosisCheckbox,onSearchChange:B,validation:(v,n)=>O(n,"differentialDiagnosis")}]),O=(v,n)=>{var te,z,we;if(!v)return null;const T=(te=v.primaryDiagnosis)==null?void 0:te.name,A=((z=v.secondaryDiagnosis)==null?void 0:z.map(le=>le.name))||[],X=((we=v.differentialDiagnosis)==null?void 0:we.map(le=>le.name))||[];if(n==="secondaryDiagnosis"&&A.includes(T)||n==="differentialDiagnosis"&&X.includes(T))return"".concat(T," is already the primary diagnosis");const ne=A.find(le=>X.includes(le));return ne?"".concat(ne," cannot be both secondary and differential"):null},V=()=>{k.value="",y.value="",p.value=!1,N.value=!1,h.value=!0},F=async()=>{var v;((v=c.value)==null?void 0:v.validateForm())==null&&(U(),h.value=!1,E.value=!0,N.value=!0,w.value=!1)},U=()=>{var te;const v=[],n=g.value.map(z=>z.name),T=((te=c.value)==null?void 0:te.getFormValues())||{},A=T.primaryDiagnosis||[],X=T.secondaryDiagnosis||[],ne=T.differentialDiagnosis||[];if(A.name&&!n.includes(A.name))if(!g.value.some(we=>we.data.concept_id===6542))v.push({actionBtn:!0,btn:["delete"],name:A.name,id:A.concept_id,display:[A.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:A.concept_id,obs_datetime:Pe.getSessionDate()}});else return Ra("Only one primary diagnosis is allowed"),!1;return X&&X.forEach(z=>{n.includes(z.name)||v.push({actionBtn:!0,btn:["delete"],name:z.name,id:z.concept_id,display:[z.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:z.concept_id,obs_datetime:Pe.getSessionDate()}})}),ne&&ne.forEach(z=>{n.includes(z.name)||v.push({actionBtn:!0,btn:["delete"],name:z.name,id:z.concept_id,display:[z.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:z.concept_id,obs_datetime:Pe.getSessionDate()}})}),v.length>0&&(g.value=[...g.value,...v]),!0},B=async v=>{const n=v.trim().toLowerCase()||"";return d.value=await Ls.getDiagnosis(n,1,15),d.value},C=v=>{const n=g.value,T=v.name,A=n.filter(X=>X.display[0]!==T);g.value=A},$=()=>{g.value.length>0?(E.value=!0,p.value=!1):h.value||(p.value=!0),N.value=!_.value},W=async()=>{if(g.value.length<=0){fe("Diagnosis not saved");return}const v=g.value.flatMap(T=>T.data);if(v.length<=0)return fe("Diagnosis not saved");const n=await Y.addObsToEncounter(v,Z.DIAGNOSIS);await Y.mergeObsToPatient(n),Fe("Diagnosis saved successful"),g.value=[]};return De(async()=>{$(),await B("")}),r({onSubmit:W}),(v,n)=>{const T=J("ion-row"),A=J("ion-label"),X=J("ion-accordion"),ne=J("ion-accordion-group");return l(),D(oe,null,[o("div",Gs,[e(Bt,{status:p.value,content:"No Diagnosis added"},null,8,["status"]),E.value?(l(),D("span",zs,[e(Xe,{listData:g.value,"onClicked:delete":C},null,8,["listData"]),_.value?(l(),D("div",Ys," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):f("",!0)])):f("",!0),h.value?(l(),P(T,{key:1},{default:s(()=>{var te;return[o("div",null,[e(je,{formData:L.value,ref_key:"formRef",ref:c},null,8,["formData"])]),o("div",null,[e(be,{fill:"clear",icon:a(u).plus,iconSlot:"icon-only","onClicked:btn":n[0]||(n[0]=z=>F()),name:"Save",disabled:(te=c.value)==null?void 0:te.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):f("",!0),N.value?(l(),P(T,{key:2,style:{"margin-top":"10px"}},{default:s(()=>[e(be,{fill:"clear",icon:a(u).plus,iconSlot:"icon-only","onClicked:btn":n[1]||(n[1]=te=>V()),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):f("",!0)]),e(T,null,{default:s(()=>[e(ne,{ref_key:"accordionGroup",ref:R,class:"previousView"},{default:s(()=>[e(X,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:s(()=>[e(a(ae),{slot:"header",color:"light"},{default:s(()=>[e(A,{class:"previousLabel"},{default:s(()=>[...n[2]||(n[2]=[H("Previous Diagnosis",-1)])]),_:1})]),_:1}),o("div",js,[e(Ws)])]),_:1})]),_:1},512)]),_:1})],64)}}}),Wo=me(Ks,[["__scopeId","data-v-a440f286"]]),Xs={class:"allergies-section"},Qs={class:"allergies-container"},Js={class:"medication-section"},Zs={class:"medication-content"},eo={key:0,class:"add-medication-form"},to={class:"form-group"},ao={class:"option-label"},no={key:0,class:"error-message"},so={class:"form-row"},oo={class:"form-group"},lo={key:0,class:"error-message"},io={class:"form-group"},ro={key:0,class:"error-message"},co={class:"form-group"},uo={key:0,class:"error-message"},po={class:"action-buttons"},mo={class:"notes-section"},vo={class:"notes-content"},fo={class:"notes-input-container"},_o={class:"ion-padding",slot:"content"},ho={class:"notes-timeline"},go={class:"note-date"},yo={class:"note-content"},bo={class:"ion-padding",slot:"content"},Do={class:"note-date"},wo={class:"note-content"},ko=ee({watch:{},name:"xxxComponent"}),Co=ee({...ko,setup(i){const r=Te,u=Za,p=t(!1),h=t(!1),w=t(!0),E=t(0),N=t(""),y=t(!1),k=t(),d=t(!1),g=t(""),R=t(""),c=t(""),_=t(""),L=t(""),O=t(""),V="Add new medication",F=Me(),U=Ht(),B=K(()=>U.selectedMedicalAllergiesList),C=K(()=>F.selectedMedicalDrugsList),$=K(()=>F.partialOPDdrugList),W=K(()=>F.nonPharmalogicalTherapyAndOtherNotes),v=["first","second","third"],n=t(),T=t(),A=t(),X=t(!1),ne=t(!1),te=t("Show more notes"),z=t(),we=t(),le=t(),Ve=K(()=>F.editingDrugItem),qe=t("Select a route"),S=t(!1),M=t("Select frequency"),q=t(!1),ce=t("Select drug"),Qe=t(!1),ie=t(),re=t(),ke=t(),Be=t([]),Kt=t([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),Xt=K(()=>Be.value.length?Be.value:Kt.value);function Qt(b){ie.value=b}async function Jt(){return await en()}async function Zt(b=5,m=1e3){let I=0;for(;I<b&&(Be.value=await Jt(),!(Be.value.length>0));)I++,await new Promise(G=>setTimeout(G,m));Be.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}De(async()=>{const b=new Xa,{previousDrugPrescriptions:m,previousClinicalNotes:I,previousDrugAllergies:G}=await b.getPatientEncounters();n.value=m,T.value=Object.entries(I)[0];const[,...j]=Object.entries(I);A.value=j,z.value=Object.entries(G)[0];const[,...se]=Object.entries(G);we.value=se,await Zt()}),he(()=>R.value,async b=>{sa()}),he(()=>c.value,async b=>{lt()});function ea(){if(ye.isEmpty(ie.value)==!0)return S.value=!0,!1;if(ye.isEmpty(ie.value)==!1)return S.value=!1,!0}function ta(){if(ye.isEmpty(re.value)==!0)return q.value=!0,!1;if(ye.isEmpty(re.value)==!1)return q.value=!1,!0}function aa(){if(ye.isEmpty(ke.value)==!0)return Qe.value=!0,!1;if(ye.isEmpty(ke.value)==!1)return Qe.value=!1,!0}function na(){w.value=!w.value,p.value=!0,y.value=!1,d.value=!1}async function sa(){return ct(R.value)?y.value=!1:(N.value="please enter a number",y.value=!0),y.value}async function lt(){return ct(c.value)?d.value=!1:(k.value="please enter a number",d.value=!0),d.value}async function it(){const b=await lt(),m=ta(),I=aa(),G=ea();return!b&&m==!0&&I==!0&&G==!0}function oa(b){re.value=b}async function rt(){try{const b=()=>le.value.dose_strength!=null&&le.value.dose_strength?Math.trunc(le.value.dose_strength):1;if(Ve.value!==null){if(!await it()){fe("Please enter correct data values",4e3);return}const I=Pe.getSessionDate(),G=ut(I,parseInt(c.value));let j=!1;Je(le.value)==!0&&(j=!0);const se={drugName:g.value,dose:b(),frequency:re.value.label,frequency_code:re.value.code,duration:c.value,prescription:G,drug_id:O.value,units:L.value,route_concept_id:ie.value.concept_id,route_name:ie.value.name,highlightbackground:j},Ze=Me();console.log(Ze.setSelectedMedicalDrugsList([se])),Ze.editingDrugItem=null,w.value=!0}else{if(!await it()){fe("Please enter correct data values",4e3);return}va();const I=Pe.getSessionDate(),G=ut(I,parseInt(c.value));let j=!1;Je(le.value)==!0&&(j=!0);const se={drugName:g.value,dose:b(),frequency:re.value.label,frequency_code:re.value.code,duration:c.value,prescription:G,drug_id:O.value,units:L.value,route_concept_id:ie.value.concept_id,route_name:ie.value.name,highlightbackground:j};Me().setSelectedMedicalDrugsList([se])}O.value="",g.value="",R.value="",re.value=null,c.value="",_.value="",E.value++,ke.value=null,ie.value=null}catch(b){console.error("Error saving data:",b)}}async function la(b){const m=b,j=await Wa.getOfflineOPDDrugs({name:m,page:1,page_size:10});j.map(se=>({label:se.name,value:se.name,other:se})),F.setPartialOPDdrugList(j)}function Je(b){const m=[];return B.value.forEach(G=>{G.selected&&m.push(G.concept_id)}),ia([b],m)==!0?(fe("Client is allergic to the selected medication",4e6),!0):!1}function ia(b,m){try{return b.some(I=>m.includes(I.concept_id))}catch(I){return!1}}function ra(b){b&&(g.value=b.name,O.value=b.drug_id,L.value=b.units,le.value=b,Je(b))}function ca(b){const m=C.value[b],I=Me();I.removeDrugById(m.drug_id),I.editingDrugItem=m,O.value="",g.value="",R.value="",re.value=null,c.value="",_.value="",ke.value=null,ie.value=null,O.value=m.drug_id,g.value=m.drugName,R.value=m.dose,re.value={label:m.frequency,code:m.frequency_code},c.value=m.duration,_.value=m.prescription;const G=$.value.find(j=>j.name===m.drugName);G&&(ke.value=G),ie.value={concept_id:m.route_concept_id,name:m.route_name},w.value=!1,E.value++}function ua(){if(Ve.value!==null){O.value="",g.value="",R.value="",re.value=null,c.value="",_.value="",ke.value=null,ie.value=null;const b=Me();b.setSelectedMedicalDrugsList([Ve.value]),b.editingDrugItem=null}w.value=!0,E.value++}function da(b){C.value.splice(b,1),E.value++,fe("you have removed a drug from list",6e3)}function pa(b){let m=b.target.value;ma(m)}function ma(b){Me().setNonPharmalogicalTherapyAndOtherNotes(b)}function ct(b){return/^[0-9]+$/.test(b)}function ut(b,m){const I=new Date(b);I.setDate(I.getDate()+m);const G=I.getFullYear(),j=String(I.getMonth()+1).padStart(2,"0"),se=String(I.getDate()).padStart(2,"0");return"".concat(G,"-").concat(j,"-").concat(se)}function va(){p.value=!1,h.value=!0,w.value=!0}function fa(b){v.filter(I=>I!==b.detail.value);const m=b.detail.value;m!==void 0?m=="third"&&(te.value="Show less notes",ne.value=!X.value):(te.value="Show more notes",ne.value=!X.value)}function _a(b){return b[1]}function ha(b){(b.key==="Enter"||b.key==="ArrowDown")&&(b.preventDefault(),rt())}const $e=K(()=>[{showAddItemButton:!0,addItemButton:!0,name:Ve.value!==null?"Update":"ADD",fn:rt},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",fn:ga}]),ga=async()=>{Ua(qa,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to cancle?"},{cancel:G=>{},confirm:async G=>{G.detail==!0&&ua()}})};return(b,m)=>(l(),P(a(Ke),null,{default:s(()=>[o("div",Xs,[o("div",Qs,[e(jt)])]),o("div",Js,[e(a(ae),{lines:"none",class:"section-header"},{default:s(()=>[e(a(We),{icon:a(He),class:"section-icon"},null,8,["icon"]),e(a(pe),{class:"section-title",style:{"margin-top":"12px"}},{default:s(()=>[...m[9]||(m[9]=[H("Medication",-1)])]),_:1})]),_:1}),o("div",Zs,[(l(),P(Qa,{_selectedMedicalDrugsList:C.value,onEditItem:ca,onRemoveItem:da,key:E.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),w.value?f("",!0):(l(),D("div",eo,[o("div",to,[m[10]||(m[10]=o("label",{class:"input-label"},"Medication",-1)),e(a(Ue),{modelValue:ke.value,"onUpdate:modelValue":[m[0]||(m[0]=I=>ke.value=I),m[1]||(m[1]=I=>ra(I))],options:$.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:m[2]||(m[2]=I=>la(I))},{option:s(I=>[o("div",ao,x(I.option.name),1)]),_:1},8,["modelValue","options"]),Qe.value?(l(),D("div",no,x(ce.value),1)):f("",!0)]),o("div",so,[o("div",oo,[m[11]||(m[11]=o("label",{class:"input-label"},"Route",-1)),e(a(Ue),{modelValue:ie.value,"onUpdate:modelValue":[m[3]||(m[3]=I=>ie.value=I),m[4]||(m[4]=I=>Qt(I))],options:Xt.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id",disabled:!1},null,8,["modelValue","options"]),S.value?(l(),D("div",lo,x(qe.value),1)):f("",!0)]),o("div",io,[m[12]||(m[12]=o("label",{class:"input-label"},"Frequency",-1)),e(a(Ue),{modelValue:re.value,"onUpdate:modelValue":[m[5]||(m[5]=I=>re.value=I),m[6]||(m[6]=I=>oa(I))],options:a(u),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),q.value?(l(),D("div",ro,x(M.value),1)):f("",!0)]),o("div",co,[m[13]||(m[13]=o("label",{class:"input-label"},"Duration (days)",-1)),e(a(xa),{modelValue:c.value,"onUpdate:modelValue":m[7]||(m[7]=I=>c.value=I),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:ha},null,8,["modelValue"]),d.value?(l(),D("div",uo,x(k.value),1)):f("",!0)])]),o("div",po,[$e.value[0].addItemButton?(l(),P(be,{key:0,name:$e.value[0].name,icon:a(Nt),"onClicked:btn":$e.value[0].fn,class:"save-button"},null,8,["name","icon","onClicked:btn"])):f("",!0),$e.value[1].addItemButton?(l(),P(be,{key:1,name:$e.value[1].name,icon:a(Vt),"onClicked:btn":$e.value[1].fn,class:"cancel-button"},null,8,["name","icon","onClicked:btn"])):f("",!0)])])),w.value?(l(),P(be,{key:1,name:V,icon:a(Ge),fontWeight:"600","onClicked:btn":na,class:"add-new-button"},null,8,["icon"])):f("",!0)])]),o("div",mo,[e(a(ae),{lines:"none",class:"section-header"},{default:s(()=>[e(a(We),{icon:a(Aa),class:"section-icon"},null,8,["icon"]),e(a(pe),{class:"section-title"},{default:s(()=>[...m[14]||(m[14]=[H("Non-pharmacological therapy and other notes",-1)])]),_:1})]),_:1}),o("div",vo,[e(Ja,{class:"intervention-component"}),o("div",fo,[e(a(ae),{class:"notes-input-item"},{default:s(()=>[e(a(We),{slot:"start",icon:a(r).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),e(a(Na),{modelValue:W.value,"onUpdate:modelValue":m[8]||(m[8]=I=>W.value=I),onIonInput:pa,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),e(a(nt),{ref:"accordionGroup",class:"previous-notes"},{default:s(()=>[e(a(Ce),{value:"fourth","toggle-icon-slot":"start"},{default:s(()=>[e(a(ae),{slot:"header",color:"light",class:"previous-notes-header"},{default:s(()=>[e(a(pe),null,{default:s(()=>[...m[15]||(m[15]=[H("Previous visit notes",-1)])]),_:1})]),_:1}),o("div",_o,[o("div",ho,[b.index===1?(l(!0),D(oe,{key:0},_e(T.value,(I,G)=>(l(),D("div",{key:G,class:"note-entry"},[(l(!0),D(oe,null,_e(I,(j,se)=>(l(),D("div",{key:se},[o("div",go,x(j.date),1),o("div",yo,x(j.notes),1)]))),128))]))),128)):f("",!0),e(a(nt),{onIonChange:fa},{default:s(()=>[e(a(Ce),{value:"third","toggle-icon-slot":"start"},{default:s(()=>[e(a(ae),{slot:"header",color:"light",class:"show-more-header"},{default:s(()=>[e(a(pe),{color:"primary"},{default:s(()=>[H(x(te.value),1)]),_:1})]),_:1}),o("div",bo,[(l(!0),D(oe,null,_e(A.value,(I,G)=>(l(),D("div",{key:G,class:"note-entry"},[(l(!0),D(oe,null,_e(_a(I),(j,se)=>(l(),D("div",{key:se},[o("div",Do,x(j.date),1),o("div",wo,x(j.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1}))}}),Go=me(Co,[["__scopeId","data-v-928c62f1"]]),So=ee({name:"xxxComponent"}),Io=ee({...So,emits:["dataSaved"],setup(i,{emit:r}){const u=t(),p=t("gurdian phone number");t(!0),t(!0);const h=t(!0),w=t(),E=t();De(async()=>{we()});const N=[{placeHolder:{default:"Enter time of death if known"},property_name:"timeOfDeath",dataHandler:F,dataValue:t(),show_error:t(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time arrived"},property_name:"timeArrived",dataHandler:U,dataValue:t(),show_error:t(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time confirming death"},property_name:"timeOfDeathConfirmation",dataHandler:B,dataValue:t(),show_error:t(!1),error_message:"Time required",skip_validation:!1}],y=[{placeHolder:{default:"Enter date of death"},property_name:"dateOfDeath",dataHandler:C,dataValue:t(),show_error:t(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date arrived"},property_name:"dateArrived",dataHandler:$,dataValue:t(),show_error:t(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date confirming death"},property_name:"dateOfDeathConfirmation",dataHandler:W,dataValue:t(),show_error:t(!1),error_message:"Date required",type:"date",skip_validation:!1}],k=[{lblTxt:"Was the individual pregnant at the time of death?",value:t(!1),disable_checkbox:t(!0)}],d=[{placeHolder:"Enter place of death",property_name:"placeOfDeath",dataHandler:v,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter name of guardian",property_name:"nameOfGuardian",dataHandler:n,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter name of person confirming death",property_name:"nameOfPersonConfirmindDeath",dataHandler:T,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter position of the person confirming death",property_name:"positionOfthePersonConfirmingDeath",dataHandler:A,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter medical council registration number of the person confirming death",property_name:"medicalConcilRegistrationNumberOfThePersonConfirmingDeath",dataHandler:X,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters and numbers are allowed",type:"alphanumeric",skip_validation:!1},{placeHolder:"Other (specify)",property_name:"otherNotes",dataHandler:ne,dataValue:t(),show_error:t(!1),error_message:"Input required, Only letters allowed",dissabled:h.value,type:"text",skip_validation:!0}],g=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:le},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:L}],R=t([{id:1,name:"Natural",selected:!1},{id:2,name:"Accident",selected:!1},{id:3,name:"Homicide",selected:!1},{id:4,name:"Suicide",selected:!1},{id:5,name:"Pending investigation",selected:!1},{id:6,name:"Could not be determined",selected:!1},{id:7,name:"Other - specify",selected:!1}]),c=t([{id:1,name:"Motor vehicle (passenger)",selected:!1},{id:2,name:"Motor vehicle (pedestrian)",selected:!1},{id:3,name:"Drowning",selected:!1},{id:4,name:"Other - specify",selected:!1}]),_=[{multi_Selection:!1,manner_of_death_Selection_value:t(),show_list_label:!0,unqueId:"qwerty",name_of_list:"Manner of death ",property_name:"mannerOfDeath",placeHolder:"Choose one",items:R.value,listUpdatedFN:te,listFilteredFN:()=>{},use_internal_filter:!0,disabled:t(!1),show_error:t(!1),error_message:"selection required"},{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty1hjkn",name_of_list:"How did it occur?",property_name:"howDiditOccur",placeHolder:"Choose one",items:c.value,listUpdatedFN:z,listFilteredFN:()=>{},use_internal_filter:!0,disabled:t(!0),show_error:t(!1),error_message:"selection required"}];function L(){V()}const O=r;function V(S={dataSaved:!0}){O("dataSaved",S)}function F(S){N[0].dataValue.value=S}function U(S){N[1].dataValue.value=S}function B(S){N[2].dataValue.value=S}function C(S){const M={day:S.value.day,month:S.value.month,year:S.value.year,formattedDate:S.value.formattedDate};y[0].dataValue.value=M}function $(S){const M={day:S.value.day,month:S.value.month,year:S.value.year,formattedDate:S.value.formattedDate};y[1].dataValue.value=M,console.log(y[2].dataValue.value)}function W(S){const M={day:S.value.day,month:S.value.month,year:S.value.year,formattedDate:S.value.formattedDate};y[2].dataValue.value=M,console.log(y[2].dataValue.value)}function v(S){const M=S.target.value;d[0].dataValue.value=M}function n(S){const M=S.target.value;d[1].dataValue.value=M}function T(S){const M=S.target.value;d[2].dataValue.value=M}function A(S){const M=S.target.value;d[3].dataValue.value=M}function X(S){const M=S.target.value;d[4].dataValue.value=M}function ne(S){const M=S.target.value;d[5].dataValue.value=M}function te(S){R.value.forEach(q=>q.selected=!1);const M=R.value.find(q=>q.id==S.id);_[1].disabled.value=S.name!="Accident",M.selected=!0}function z(S){console.log("listUpdated",S),c.value.forEach(q=>q.selected=!1);const M=c.value.find(q=>q.id==S.id);M.selected=!0}function we(){const M=new Ft().isChildBearing;M==!0&&(k[0].disable_checkbox.value=!1),M==!1&&(k[0].disable_checkbox.value=!0)}function le(){et(d),et(y),et(N),Ve();const S=ye.merge(tt(d),tt(y),tt(N),qe(_[0]),qe(_[1]));console.log(S)}function Ve(){const S=R.value.filter(M=>M.selected);if(S.length==0)_[0].show_error.value=!0;else if(_[0].show_error.value=!1,S[0].name=="Accident"){const M=c.value.filter(q=>q.selected);_[1].show_error.value=M.length==0}}function qe(S){const M=[];let q={};return S.items.forEach(ce=>{ce.selected==!0&&M.push({property_name:S.property_name,name:ce.name})}),M.length>0&&(q[M[0].property_name]=M[0].name),q}return(S,M)=>{const q=J("ion-label");return l(),D(oe,null,[e(a(ve),{class:"checkbox_content md"},{default:s(()=>[e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[0].placeHolder,icon:a(xt),inputValue:d[0].dataValue.value,"onUpdate:inputValue":d[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),o("div",null,[d[0].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[0].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(kt,{place_holder:y[0].placeHolder,onDateUpDated:y[0].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),o("div",null,[y[0].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(y[0].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(at,{place_holder:N[0].placeHolder,onTimeUpDated:N[0].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),o("div",null,[N[0].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(N[0].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q))]),_:1}),e(a(ve),{class:"checkbox_content md"},{default:s(()=>[e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[1].placeHolder,icon:a(bt),inputValue:d[1].dataValue.value,"onUpdate:inputValue":d[1].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),o("div",null,[d[1].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[1].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(a(Va),{value:k[0].value,alignment:"start",class:"ion-lblCls",disabled:k[0].disable_checkbox.value},{default:s(()=>[H(x(k[0].lblTxt),1)]),_:1},8,["value","disabled"])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:p.value,icon:a($a),inputValue:u.value},null,8,["placeholder","icon","inputValue"])]),_:1}),e(a(Q))]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(kt,{place_holder:y[1].placeHolder,onDateUpDated:y[1].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),o("div",null,[y[1].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(y[1].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(at,{place_holder:N[1].placeHolder,onTimeUpDated:N[1].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),o("div",null,[N[1].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(N[1].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(a(Ue),{modelValue:w.value,"onUpdate:modelValue":[M[0]||(M[0]=ce=>w.value=ce),M[1]||(M[1]=ce=>te(ce))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Manner of death",placeholder:"Manner of death",selectLabel:"",label:"name",searchable:!0,"track-by":"id",options:R.value},null,8,["modelValue","options"]),o("div",null,[_[0].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(_[0].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(a(Ue),{modelValue:E.value,"onUpdate:modelValue":[M[2]||(M[2]=ce=>E.value=ce),M[3]||(M[3]=ce=>z(ce))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"How did it occur?",placeholder:"How did it occur?",selectLabel:"",label:"name",disabled:_[1].disabled.value,searchable:!0,"track-by":"id",options:c.value},null,8,["modelValue","disabled","options"]),o("div",null,[_[1].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(_[1].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[5].placeHolder,icon:a(Dt),inputValue:d[5].dataValue.value,disabled:h.value,"onUpdate:inputValue":d[5].dataHandler},null,8,["placeholder","icon","inputValue","disabled","onUpdate:inputValue"]),o("div",null,[d[5].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[5].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(at,{place_holder:N[2].placeHolder,onTimeUpDated:N[2].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),o("div",null,[N[2].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(N[2].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[2].placeHolder,icon:a(bt),inputValue:d[2].dataValue.value,"onUpdate:inputValue":d[2].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),o("div",null,[d[2].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[2].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),e(a(ve),null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[3].placeHolder,icon:a(He),inputValue:d[3].dataValue.value,"onUpdate:inputValue":d[3].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),o("div",null,[d[3].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[3].error_message),1)]),_:1})):f("",!0)])]),_:1}),e(a(Q),null,{default:s(()=>[e(Ee,{placeholder:d[4].placeHolder,icon:a(Dt),inputValue:d[4].dataValue.value,"onUpdate:inputValue":d[4].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),o("div",null,[d[4].show_error.value?(l(),P(q,{key:0,class:"error-label"},{default:s(()=>[H(x(d[4].error_message),1)]),_:1})):f("",!0)])]),_:1})]),_:1}),(l(),P(a(ve),{key:0,class:"spc_btwn"},{default:s(()=>[g[0].addItemButton?(l(),P(be,{key:0,name:g[0].name,fill:g[0].btnFill,icon:a(Nt),"onClicked:btn":g[0].fn},null,8,["name","fill","icon","onClicked:btn"])):f("",!0),g[1].addItemButton?(l(),P(be,{key:1,name:g[1].name,fill:g[1].btnFill,icon:a(Vt),"onClicked:btn":g[1].fn},null,8,["name","fill","icon","onClicked:btn"])):f("",!0)]),_:1}))],64)}}}),Po=me(Io,[["__scopeId","data-v-0aad2f08"]]),Eo={class:"dash_box"},Oo={key:1},xo=ee({name:"xxxComponent"}),Ao=ee({...xo,setup(i){const r=t("No outcome created yet"),u=t(!1),p=t("please select a type"),h=t(!0),w=t(""),E=t(!0),N=t(!1),y=Ga(),k=K(()=>y.outcomes),d=t(!1),g=t(!1),R=t(!1),c=t(!1),_=t(!1),L=t(!1),O=t([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]),V=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:O.value,listUpdatedFN:F,listFilteredFN:()=>{},use_internal_filter:!0,disabled:t(!1)}];function F(n){O.value=n,O.value.forEach(T=>{T.selected==!0&&(w.value=T.name)})}De(async()=>{B()}),he(()=>w.value,async n=>{d.value==!0?d.value=!1:W()}),he(()=>k.value.length,async n=>{B()});function U(){O.value.forEach(n=>{n.selected=!1}),w.value=""}function B(){k.value.length>0?E.value=!1:k.value.length==0&&N.value==!1&&(E.value=!0)}function C(n){k.value.splice(n,1)}const $=n=>{};async function W(n=!0){const T=w.value;console.log(T),w.value=T;const A=w.value;A==O.value[0].name?R.value=!0:R.value=!1,A==O.value[1].name?(c.value=!0,console.log("show_discharged_options is set to true")):c.value=!1,A==O.value[2].name?(_.value=!0,console.log("show_discharged_options is set to true")):_.value=!1,A==O.value[3].name?L.value=!0:L.value=!1}function v(){g.value=!1,R.value=!1,c.value=!1,_.value=!1,U()}return(n,T)=>{const A=J("ion-row");return l(),P(a(Ke),null,{default:s(()=>[e(A,null,{default:s(()=>[e(a(Q),null,{default:s(()=>[(l(),P(tn,{key:0,"onUpdate:removeItem":C,"onUpdate:editItem":$,displayData:k.value},null,8,["displayData"]))]),_:1})]),_:1}),E.value?(l(),P(A,{key:0},{default:s(()=>[o("span",Eo,x(r.value),1)]),_:1})):f("",!0),h.value?(l(),D("div",Oo,[e(A,null,{default:s(()=>[e(a(Q),null,{default:s(()=>[e(za,{multiSelection:V[0].multi_Selection,show_label:V[0].show_list_label,uniqueId:V[0].unqueId,name_of_list:V[0].name_of_list,choose_place_holder:V[0].placeHolder,"items_-list":V[0].items,use_internal_filter:V[0].use_internal_filter,disabled:V[0].disabled.value,onItemListUpDated:V[0].listUpdatedFN,onItemListFiltered:V[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),o("div",null,[u.value?(l(),P(a(pe),{key:0,class:"error-label"},{default:s(()=>[H(x(p.value),1)]),_:1})):f("",!0)])]),_:1})]),_:1})])):f("",!0),R.value?(l(),P(an,{key:2,onDataSaved:v,selected_ward_prop:"",admitted_other_props:""})):f("",!0),c.value?(l(),P(nn,{key:3,onDataSaved:v,selected_referral_data:"",selected_other_referral_data:""})):f("",!0),_.value?(l(),P(sn,{key:4,onDataSaved:v,selected_discharged_prop:"",selected_discharged_data:""})):f("",!0),g.value?(l(),P(Po,{key:5,onDataSaved:v})):f("",!0),L.value?(l(),P(on,{key:6,onDataSaved:v})):f("",!0)]),_:1})}}}),zo=me(Ao,[["__scopeId","data-v-fc637de7"]]);export{qo as C,Wo as O,fn as P,gs as _,Go as a,zo as b,Ss as c,_s as d,Ls as e};
