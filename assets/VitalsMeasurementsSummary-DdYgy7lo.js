import{d as W,ar as O,b$ as P,a0 as $,a3 as V,U as F,T as R,as as N,ac as q,G as z,S as G,a9 as J,c2 as K,a1 as U,a2 as j,E as Q,e as g,f,l as X,z as Y,k as L,F as Z,L as tt,B as et}from"./vendor-BzS-GRGX.js";import{D as at,B as st,aq as it,a4 as u,H as d,b4 as x,an as nt,aK as ot,P as A,A as rt,u as ct,ar as lt,i as pt,_ as ut}from"./index-xmN8DORW.js";import{D as dt}from"./DashBox-bjCJqNrw.js";import{L as mt}from"./SvgDynamicColor-Q4ht95M8.js";import{B as ht}from"./BasicForm-Cp32qII-.js";import{p as gt}from"./previousDiagnosis-umkRdZKY.js";import"./lodash-Dt8AsbQm.js";import"./DateInputField-D9J0rJ_Y.js";const ft=W({name:"Menu",components:{IonContent:J,IonHeader:G,IonItem:z,IonList:q,IonMenu:N,IonTitle:R,IonToolbar:F,IonInput:V,IonPopover:$,DashBox:dt,SelectionPopover:it,BasicInputField:st,List:mt,BasicForm:ht,DynamicButton:at,previousDiagnosis:gt,DataTable:P},data(){return{iconsContent:pt,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",conditionStatus:"",data:[],diagnosisData:[],popoverOpen:!1,event:"",selectedCondition:"",tableData:[],options:{responsive:!0,select:!1,layout:{topStart:"",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},header:["Date","Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic","BMI"],visits:[],BMI:"",nextAppointMent:"",drugs:"",visitDate:[],primaryDiagnosis:[],presentingComplaint:[],secondaryDiagnosis:[],labOrders:[],vitals:{},vitalsWeightHeight:{},savedEncounters:[],pregnancy:{}}},setup(){return{checkmark:j,pulseOutline:U}},computed:{...O(lt,["diagnosis"]),...O(ct,["patient"])},watch:{$route:{async handler(){await this.setListData()},deep:!0}},async mounted(){await this.updateData(),await this.setListData(),this.$nextTick(()=>{const t=this.$refs.dataTable.dt;t.columns.adjust().draw(),t.on("click",".delete-btn",a=>{const e=a.target.getAttribute("data-id");this.voidDiagnosis(JSON.parse(e),a)})})},methods:{async voidDiagnosis(t,a){await rt("Do you want to delete ".concat(t.name," ?"),a)&&(await u.voidObs(t.id),await this.setListData())},async openEnterResultModal(){await this.setListData()},async updateData(){const t=new A;this.visits=await A.getPatientVisits(t.getID(),!1),this.tableData=[],Promise.all(this.visits.map(async a=>{await this.loadSavedEncounters(a)}))},covertDate(t){return d.toStandardHisDisplayFormat(t)},async loadSavedEncounters(t){this.visitDate=t;const a=await ot.getEncounters(this.patient.patientID,{date:t});await this.setVitalsEncounters(a,t)},findEncounter(t,a){return t.find(e=>e.type&&e.type.name===a)},async getConceptValues(t,a){if(t)return await Promise.all(t==null?void 0:t.map(async e=>await nt.getConceptName(e.value_coded)))},filterObs(t,a){return t==null?void 0:t.filter(e=>e.concept.concept_names.some(s=>s.name===a))},async setVitalsEncounters(t,a){var n,l,p,v,D,I,y,b,S,_,w,B,M,C,T,E,H;const e=(n=this.findEncounter(t,"VITALS"))==null?void 0:n.observations;let s="";if(!e)return;const c=["Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic"].map(i=>this.filterObs(e,i).length||0),r=Math.max(...c);for(let i=0;i<r;i++){const m=(p=(l=this.filterObs(e,"Weight")[i])==null?void 0:l.value_numeric)!=null?p:"",h=(D=(v=this.filterObs(e,"Height (cm)")[i])==null?void 0:v.value_numeric)!=null?D:"";m&&h&&(s=await this.setBMI(m,h));const k=[a,m,h,(y=(I=this.filterObs(e,"Temperature")[i])==null?void 0:I.value_numeric)!=null?y:"",(S=(b=this.filterObs(e,"Pulse")[i])==null?void 0:b.value_numeric)!=null?S:"",(w=(_=this.filterObs(e,"SAO2")[i])==null?void 0:_.value_numeric)!=null?w:"",(M=(B=this.filterObs(e,"Systolic")[i])==null?void 0:B.value_numeric)!=null?M:"",(T=(C=this.filterObs(e,"Respiration rate")[i])==null?void 0:C.value_numeric)!=null?T:"",(H=(E=this.filterObs(e,"Diastolic")[i])==null?void 0:E.value_numeric)!=null?H:"",s||""];this.tableData.push(k)}},async setBMI(t,a){var e,s,o,c,r,n,l,p;return(s=(e=this.patient)==null?void 0:e.personInformation)!=null&&s.gender&&((c=(o=this.patient)==null?void 0:o.personInformation)!=null&&c.birthdate)&&(this.BMI=await x.getBMI(parseInt(t),parseInt(a),(n=(r=this.patient)==null?void 0:r.personInformation)==null?void 0:n.gender,d.calculateAge((p=(l=this.patient)==null?void 0:l.personInformation)==null?void 0:p.birthdate,d.sessionDate()))),this.updateBMI()},async updateBMI(){var a,e,s,o,c,r,n;const t=(e=(a=this.BMI)==null?void 0:a.color)!=null?e:[];return this.vitalsWeightHeight.icon=x.iconBMI(t),this.vitalsWeightHeight.backgroundColor=t[0],this.vitalsWeightHeight.textColor=t[1],this.vitalsWeightHeight.index="BMI "+((o=(s=this.BMI)==null?void 0:s.index)!=null?o:""),this.vitalsWeightHeight.value=(r=(c=this.BMI)==null?void 0:c.result)!=null?r:"",(n=this.BMI)==null?void 0:n.index},async setListData(){const t=await u.getAll(this.patient.patientID,"Primary diagnosis"),a=await u.getAll(this.patient.patientID,"Secondary diagnosis");[...t||[],...a||[]],P.use(K)},async generateListItems(t){return t.length>0?await Promise.all(t.map(async e=>{const s=await u.getConceptName(e.value_coded),o=e.obs_datetime;return[s,d.toStandardHisFormat(o)]})):[]}}}),vt={class:"table-responsive"};function Dt(t,a,e,s,o,c){const r=Q("DataTable");return f(),g("div",vt,[X(r,{ref:"dataTable",options:t.options,data:t.tableData,class:"display nowrap",width:"100%"},{default:Y(()=>[L("thead",null,[L("tr",null,[(f(!0),g(Z,null,tt(t.header,n=>(f(),g("th",{key:n},et(n),1))),128))])])]),_:1},8,["options","data"])])}const Ct=ut(ft,[["render",Dt],["__scopeId","data-v-cf07efa2"]]);export{Ct as default};
