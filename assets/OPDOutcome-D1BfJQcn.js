import{d as te,ao as Ve,U as mt,T as pt,ap as vt,ak as Ae,G as K,S as ft,ah as ht,a9 as Je,aa as gt,E as J,e as o,f as s,k as e,l as a,a$ as Pe,r as c,c as Q,a as Oe,m as x,y as $,z as d,u as r,A as O,F as T,W as le,I as Ee,e1 as nn,be as _t,e2 as sn,cQ as an,e3 as on,e4 as ln,e5 as rn,e6 as un,c$ as cn,e7 as dn,e8 as mn,aw as yt,aA as pn,bU as vn,ay as bt,aP as fn,B as E,L as U,w as _e,M as Be,J as ce,D as G,bx as re,ai as hn,X as gn,i as _n,e9 as yn,v as bn,bo as Qe,ab as Dn,bq as wn,ag as Sn,bS as xn,bI as Cn,aj as ut}from"./vendor-D2vbv48U.js";import{b4 as qe,H as Ue,a9 as ee,b6 as Dt,b5 as wt,aQ as St,u as Ne,_ as de,i as Ie,as as Re,at as He,D as we,w as De,S as Se,E as xe,t as ue,y as $e,aF as j,aD as Me,b7 as Fe,bu as kn,aG as xt,bv as En,bw as In,aT as An,b2 as he,aU as ge,bx as Pn,a3 as On,P as Nn,aJ as ct,aO as $n,m as Ln,a1 as ke,aC as Mn,al as Fn}from"./index-CMsVXkiA.js";import{l as fe}from"./lodash-Dt8AsbQm.js";import{P as Bn}from"./patient_complaints_service-DOlkjm7K.js";import{D as Ct}from"./DashBox-Bm9w7F0_.js";import{u as Rn}from"./useExposeFromStandardForm-DTCBagmg.js";import{B as Xe}from"./BasicForm-DyV0B5g6.js";import{f as Ze,c as kt,a as Et}from"./formatServerData-CEGt1sj1.js";import{A as Tn,P as Vn,D as Hn,n as qn}from"./NextAppointment-D3QnNPzC.js";import{D as Un,b as Wn}from"./drug_prescription_service-EYDgZb6n.js";import{D as dt}from"./drug_service-oFr-fIPv.js";import{D as zn,A as Gn,R as Yn,a as jn}from"./Outcome-DRrMZXg9.js";const Kn=te({name:"Menu",components:{IonContent:ht,IonHeader:ft,IonItem:K,IonList:Ae,IonMenu:vt,IonTitle:pt,IonToolbar:mt,List:qe},computed:{...Ve(Ne,["patient"]),...Ve(St,["presentingComplaints"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:wt(["#006401"]),listIcon:Dt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:gt,pulseOutline:Je}},watch:{$router:{async handler(){await this.updateList()},immediate:!0,deep:!0},patient:{async handler(){await this.updateList()},deep:!0}},async mounted(){await this.updateList()},methods:{async updateList(){const t=await ee.getAll(this.patient.patientID,"Presenting complaint"),n=fe.isEmpty(t)?[]:Promise.all(t.map(async v=>v.value_coded?{name:await ee.getConceptName(v.value_coded),obs_date:v.obs_datetime,duration:v.children[0].value_text}:[]));this.setListData(await n)},setListData(t){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 20px;",containSize:4,display:["Date","Presenting Complains","Duration"]}),t.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height:20px;",class:"col_background",containSize:4,display:[Ue.toStandardHisFormat(n.obs_date),n.name,n.duration]})})}}}),Qn={class:"modal_wrapper"};function Jn(t,n,v,g,w,C){const m=J("list");return s(),o("div",Qn,[e("div",null,[a(m,{listData:t.list},null,8,["listData"])])])}const Xn=de(Kn,[["render",Jn],["__scopeId","data-v-30434e22"]]),Zn={key:0},es={style:{"align-content":"center"}},ts={class:"ion-padding",slot:"content"},ns=te({__name:"PresentingComplaints",setup(t,{expose:n}){const v=St(),{presentingComplaints:g}=Pe(v),w=c(Ie),C=c(!0),m=c(!1),y=c(!0),D=c(!1),u=c([]),h=c([]),l=c(),V=Q(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:Ie.search,hideSelected:!0,validation:_=>H(_==null?void 0:_.name,u.value)?"Presenting complaint already added":Re.required(_),options:h.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:Ie.time,validation:_=>Re.isNotEmptyandNumber(_),grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:_=>!_||_===""?"Please select a unit.":null},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:Ie.editPen,validation:_=>H(_,u.value)?"Presenting complaint already added":Re.required(_),condition:_=>{var i;return((i=_==null?void 0:_.PresentingComplaints)==null?void 0:i.name)==="Other"}},{componentType:"Alert",condition:_=>{var i;return Re.required((i=_==null?void 0:_.PresentingComplaints)==null?void 0:i.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:P}=Rn(),R=async()=>{h.value=await Bn.getComplaintsList("Presenting complaint"),De(g.value,"PresentingComplaints","multiSelectData",h.value)},A=()=>{C.value=!1,y.value=!1,m.value=!0},L=async()=>{var k,b;const _=(k=P.value)==null?void 0:k.getFormValues();((b=P.value)==null?void 0:b.validateForm())==null&&(F(_),m.value=!1,y.value=!0)},F=_=>{var I;const i=_.duration+" "+_.duration_unit,k=_.PresentingComplaints,b=k.name==="Other"?_["Other (specify)"]:k.name;u.value.push({actionBtn:!0,btn:["delete"],name:b,concept_id:k.concept_id,duration:k.duration,durationUnits:k.duration_unit,display:[b,i],data:[{concept_id:8578,value_coded:k.concept_id,obs_datetime:Se.getSessionDate(),child:[{concept_id:k.concept_id,value_text:i,obs_datetime:Se.getSessionDate()}]}]}),(I=P.value)==null||I.resetForm(),D.value=!0},H=(_,i)=>i.some(k=>k.name===_),Y=_=>{u.value=u.value.filter(i=>i.display[0]!==_.name)},X=async()=>{const _=await ee.getObsByEncounterIdAndDate(xe.PRESENTING_COMPLAINTS),i=u.value.flatMap(k=>k.data);if(i.length<=0&&_.length<=0)return ue("Presenting complaints is required");i.length<=0||(await ee.addObsToEncounterPatient(i,xe.PRESENTING_COMPLAINTS),$e("Presenting complaints saved successful"),u.value=[])};return Oe(async()=>{await R()}),n({onSubmit:X}),(_,i)=>{const k=J("ion-row"),b=J("ion-label"),I=J("ion-accordion"),M=J("ion-accordion-group");return s(),o(T,null,[a(Ct,{status:C.value,content:"No presenting complaints added"},null,8,["status"]),D.value?(s(),o("span",Zn,[a(qe,{listData:u.value,"onClicked:delete":Y},null,8,["listData"])])):x("",!0),m.value?(s(),$(k,{key:1},{default:d(()=>[a(He,{formData:V.value,ref_key:"formRef",ref:P},null,8,["formData"]),e("div",es,[a(we,{fill:"clear",icon:w.value.plus,iconSlot:"icon-only","onClicked:btn":i[0]||(i[0]=z=>L()),name:"Save"},null,8,["icon"])])]),_:1})):x("",!0),y.value?(s(),$(k,{key:2,style:{"margin-top":"10px"}},{default:d(()=>[a(we,{fill:"clear",icon:w.value.plus,iconSlot:"icon-only","onClicked:btn":i[1]||(i[1]=z=>A()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):x("",!0),a(k,null,{default:d(()=>[a(M,{ref_key:"accordionGroup",ref:l,class:"previousView"},{default:d(()=>[a(I,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(b,{class:"previousLabel"},{default:d(()=>i[2]||(i[2]=[O("Previous presenting complaints")])),_:1,__:[2]})]),_:1}),e("div",ts,[a(Xn)])]),_:1})]),_:1},512)]),_:1})],64)}}}),ss=de(ns,[["__scopeId","data-v-7ca4ad60"]]),as=te({name:"VisitHistory",components:{IonIcon:Ee,IonButton:le},setup(){const t=xt();return{selectedAllergiesList2:Q(()=>t.selectedMedicalAllergiesList),calendarOutline:fn,alertCircleOutline:bt,documentTextOutline:vn,femaleOutline:pn,medicalOutline:yt,warningOutline:mn,bodyOutline:dn,eyeOutline:cn,nutritionOutline:un,fitnessOutline:rn,pulseOutline:Je,earOutline:ln,happyOutline:on,manOutline:an,moveOutline:sn,addOutline:_t,scanOutline:nn}},data(){return{visits:[],visitDate:null,presentingComplaint:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},eyesAbnormal:[],mouthAbnormal:[],earsAbnormal:[],faceAbnormal:[],neckAbnormal:[],chestAbnormal:[],chestMovementAbnormal:[],heartSoundsAbnormal:[],breathSoundsAbnormal:[],addedBreathSoundsAbnormal:[],abdominalInspectionAbnormal:[],eyesExamined:!1,mouthExamined:!1,earsExamined:!1,faceExamined:!1,neckExamined:!1,chestExamined:!1,chestMovementExamined:!1,heartSoundsExamined:!1,breathSoundsExamined:!1,addedBreathSoundsExamined:!1,abdominalInspectionExamined:!1}},computed:{...Ve(Ne,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var t;return((t=this.uniquePresentingComplaints)==null?void 0:t.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var t;return((t=this.uniquePastMedicalHistory)==null?void 0:t.length)>0},hasAllergies(){var t,n;return((n=(t=this.selectedAllergiesList2)==null?void 0:t.filter(v=>v.selected))==null?void 0:n.length)>0},hasPhysicalExam(){var t,n,v,g,w,C,m,y,D,u,h;return((t=this.eyesAbnormal)==null?void 0:t.length)>0||this.eyesExamined||((n=this.mouthAbnormal)==null?void 0:n.length)>0||this.mouthExamined||((v=this.earsAbnormal)==null?void 0:v.length)>0||this.earsExamined||((g=this.faceAbnormal)==null?void 0:g.length)>0||this.faceExamined||((w=this.neckAbnormal)==null?void 0:w.length)>0||this.neckExamined||((C=this.chestAbnormal)==null?void 0:C.length)>0||this.chestExamined||((m=this.chestMovementAbnormal)==null?void 0:m.length)>0||this.chestMovementExamined||((y=this.heartSoundsAbnormal)==null?void 0:y.length)>0||this.heartSoundsExamined||((D=this.breathSoundsAbnormal)==null?void 0:D.length)>0||this.breathSoundsExamined||((u=this.addedBreathSoundsAbnormal)==null?void 0:u.length)>0||this.addedBreathSoundsExamined||((h=this.abdominalInspectionAbnormal)==null?void 0:h.length)>0||this.abdominalInspectionExamined},uniquePastMedicalHistory(){return[...new Map(this.pastMedicalHistory.map(t=>[t,t])).values()]},uniquePresentingComplaints(){return[...new Map(this.presentingComplaint.map(t=>[t,t])).values()]}},methods:{formatVisitDate(t){return t?Ue.toStandardHisDisplayFormat(t):"No visit date"},async updateData(){var n,v;if(!((n=this.patient)!=null&&n.patientID))return;const t=await kn(this.patient.patientID);t&&(this.visits=((v=t.visits)==null?void 0:v.visitsDates)||[],this.visits.length>0&&await this.loadSavedEncounters(this.visits[0]))},async loadSavedEncounters(t){this.visitDate=t;const n=Me("presentingComplaints"),v=Me("pastMedicalHistory"),g=Me("levelOfConsciousness"),w=Me("pregnancy"),C=Me("physicalExam"),m=Fe(n),y=Fe(v),D=Fe(g),u=Fe(w),h=Fe(C);await this.setPresentingComplainsEncounters(m),await this.setPastMedicalHistoryEncounters(y),await this.setLevelOfConsciousnessEncounters(D),await this.setPregnancyStatusEncounters(u),await this.setPhysicalExamEncounters(h)},filterObs(t,n){return t?t.filter(v=>{var g,w;return((w=(g=v.concept)==null?void 0:g.concept_names)==null?void 0:w.some(C=>C.name===n))||v.concept_name===n}):[]},async getConceptValues(t,n){return t?await Promise.all(t.map(async v=>v.value_coded?await j.getConceptName(v.value_coded):v.concept_name||v.name)):[]},async setPresentingComplainsEncounters(t){this.presentingComplaint=await this.getConceptValues(this.filterObs(t,"Presenting complaint"),"coded")},async setLevelOfConsciousnessEncounters(t){if(t&&Array.isArray(t)){const n=this.filterObs(t,"Eye opening response");this.levelOfConsciousness.eyeResponse=n.length>0?await j.getConceptName(n[0].value_coded):null;const v=this.filterObs(t,"Best verbal response");this.levelOfConsciousness.verbalResponse=v.length>0?await j.getConceptName(v[0].value_coded):null;const g=this.filterObs(t,"Best motor response");this.levelOfConsciousness.motorResponse=g.length>0?await j.getConceptName(g[0].value_coded):null}},async setPregnancyStatusEncounters(t){if(t&&Array.isArray(t)){const n=this.filterObs(t,"Patient pregnant");this.pregnancy.patientPregnant=n.length>0?await j.getConceptName(n[0].value_coded):null;const v=this.filterObs(t,"Is patient breast feeding?");this.pregnancy.breastFeeding=v.length>0?await j.getConceptName(v[0].value_coded):null}},async setPhysicalExamEncounters(t){var n,v,g,w,C,m,y,D;if(!(!t||!Array.isArray(t))){this.eyesAbnormal=[],this.mouthAbnormal=[],this.earsAbnormal=[],this.faceAbnormal=[],this.neckAbnormal=[],this.chestAbnormal=[],this.chestMovementAbnormal=[],this.heartSoundsAbnormal=[],this.breathSoundsAbnormal=[],this.addedBreathSoundsAbnormal=[],this.abdominalInspectionAbnormal=[],this.eyesExamined=!1,this.mouthExamined=!1,this.earsExamined=!1,this.faceExamined=!1,this.neckExamined=!1,this.chestExamined=!1,this.chestMovementExamined=!1,this.heartSoundsExamined=!1,this.breathSoundsExamined=!1,this.addedBreathSoundsExamined=!1,this.abdominalInspectionExamined=!1;for(const u of t){if(!u.concept_name&&!((n=u.concept)!=null&&n.concept_names))continue;const h=u.concept_name||((w=(g=(v=u.concept)==null?void 0:v.concept_names)==null?void 0:g.find(l=>l.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:w.name);h&&(h.includes("normal")||h.includes("Normal"))&&u.value_coded===1065&&(h.includes("Eyes normal")?this.eyesExamined=!0:h.includes("Mouth normal")?this.mouthExamined=!0:h.includes("Ears normal")?this.earsExamined=!0:h.includes("Face normal")?this.faceExamined=!0:h.includes("Neck normal")?this.neckExamined=!0:h.includes("Chest inspection normal")?this.chestExamined=!0:h.includes("Heart sounds normal")?this.heartSoundsExamined=!0:h.includes("Breath sounds normal")?this.breathSoundsExamined=!0:h.includes("Abdominal inspection normal")&&(this.abdominalInspectionExamined=!0))}for(const u of t){if(!u.concept_name&&!((C=u.concept)!=null&&C.concept_names))continue;const h=u.concept_name||((D=(y=(m=u.concept)==null?void 0:m.concept_names)==null?void 0:y.find(l=>l.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:D.name);if(h&&!(h.includes("normal")||h.includes("Normal"))){if(h.includes("Abnormality for eyes"))if(this.eyesExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.eyesAbnormal.push(l)}else u.value_text&&this.eyesAbnormal.push(u.value_text);else if(h.includes("Abnormality for mouth"))if(this.mouthExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.mouthAbnormal.push(l)}else u.value_text&&this.mouthAbnormal.push(u.value_text);else if(h.includes("Abnormality for ears"))if(this.earsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.earsAbnormal.push(l)}else u.value_text&&this.earsAbnormal.push(u.value_text);else if(h.includes("Abnormality for face"))if(this.faceExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.faceAbnormal.push(l)}else u.value_text&&this.faceAbnormal.push(u.value_text);else if(h.includes("Abnormality for neck"))if(this.neckExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.neckAbnormal.push(l)}else u.value_text&&this.neckAbnormal.push(u.value_text);else if(h.includes("Abnormality for chest inspection"))if(this.chestExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.chestAbnormal.push(l)}else u.value_text&&this.chestAbnormal.push(u.value_text);else if(h.includes("Chest movements"))if(this.chestMovementExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.chestMovementAbnormal.push(l)}else u.value_text&&this.chestMovementAbnormal.push(u.value_text);else if(h.includes("Heart sounds abnormality"))if(this.heartSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.heartSoundsAbnormal.push(l)}else u.value_text&&this.heartSoundsAbnormal.push(u.value_text);else if(h.includes("Breath sounds abnormality"))if(this.breathSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.breathSoundsAbnormal.push(l)}else u.value_text&&this.breathSoundsAbnormal.push(u.value_text);else if(h.includes("Abnormalities when added"))if(this.addedBreathSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.addedBreathSoundsAbnormal.push(l)}else u.value_text&&this.addedBreathSoundsAbnormal.push(u.value_text);else if(h.includes("Abdominal inspection abnormality"))if(this.abdominalInspectionExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.abdominalInspectionAbnormal.push(l)}else u.value_text&&this.abdominalInspectionAbnormal.push(u.value_text)}}}},async setPastMedicalHistoryEncounters(t){this.pastMedicalHistory=await this.getConceptValues(this.filterObs(t,"Chronic disease"),"coded")}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),os={class:"visit-container"},is={class:"visit-header"},ls={class:"visit-date"},rs={class:"visit-sections"},us={key:0,class:"visit-section"},cs={class:"section-header"},ds={class:"section-content"},ms={key:0,class:"info-item"},ps={class:"info-value"},vs={key:1,class:"info-item"},fs={class:"info-value"},hs={key:2,class:"info-item"},gs={class:"info-value"},_s={key:1,class:"empty-section"},ys={key:2,class:"visit-section"},bs={class:"section-header"},Ds={class:"tags-container"},ws={key:3,class:"empty-section"},Ss={key:4,class:"visit-section"},xs={class:"section-header"},Cs={class:"section-content"},ks={key:0,class:"info-item"},Es={class:"info-value highlight"},Is={key:1,class:"info-item"},As={class:"info-value highlight"},Ps={key:5,class:"empty-section"},Os={key:6,class:"visit-section"},Ns={class:"section-header"},$s={class:"tags-container"},Ls={key:7,class:"empty-section"},Ms={key:8,class:"visit-section"},Fs={class:"section-header"},Bs={class:"tags-container"},Rs={key:9,class:"empty-section"},Ts={key:10,class:"visit-section"},Vs={class:"section-header"},Hs={class:"exam-section"},qs={key:0,class:"exam-category"},Us={class:"exam-category-header"},Ws={class:"exam-items"},zs={key:1,class:"exam-category normal"},Gs={class:"exam-category-header"},Ys={key:2,class:"exam-category"},js={class:"exam-category-header"},Ks={class:"exam-items"},Qs={key:3,class:"exam-category normal"},Js={class:"exam-category-header"},Xs={key:4,class:"exam-category"},Zs={class:"exam-category-header"},ea={class:"exam-items"},ta={key:5,class:"exam-category normal"},na={class:"exam-category-header"},sa={key:6,class:"exam-category"},aa={class:"exam-category-header"},oa={class:"exam-items"},ia={key:7,class:"exam-category normal"},la={class:"exam-category-header"},ra={key:8,class:"exam-category"},ua={class:"exam-category-header"},ca={class:"exam-items"},da={key:9,class:"exam-category normal"},ma={class:"exam-category-header"},pa={key:10,class:"exam-category"},va={class:"exam-category-header"},fa={class:"exam-items"},ha={key:11,class:"exam-category normal"},ga={class:"exam-category-header"},_a={key:12,class:"exam-category"},ya={class:"exam-category-header"},ba={class:"exam-items"},Da={key:13,class:"exam-category normal"},wa={class:"exam-category-header"},Sa={key:14,class:"exam-category"},xa={class:"exam-category-header"},Ca={class:"exam-items"},ka={key:15,class:"exam-category normal"},Ea={class:"exam-category-header"},Ia={key:16,class:"exam-category"},Aa={class:"exam-items"},Pa={key:17,class:"exam-category normal"},Oa={key:18,class:"exam-category"},Na={class:"exam-category-header"},$a={class:"exam-items"},La={key:19,class:"exam-category normal"},Ma={class:"exam-category-header"},Fa={key:20,class:"exam-category"},Ba={class:"exam-category-header"},Ra={class:"exam-items"},Ta={key:21,class:"exam-category normal"},Va={class:"exam-category-header"},Ha={key:11,class:"empty-section"};function qa(t,n,v,g,w,C){const m=J("ion-icon");return s(),o("div",os,[e("div",is,[n[0]||(n[0]=e("h5",null,"Patient's Clinical Assessment Summary",-1)),e("div",ls,[a(m,{icon:t.calendarOutline},null,8,["icon"]),e("span",null,E(t.formatVisitDate(t.visitDate)),1)])]),e("div",rs,[t.hasLevelOfConsciousness?(s(),o("div",us,[e("div",cs,[a(m,{icon:t.alertCircleOutline,class:"section-icon"},null,8,["icon"]),n[1]||(n[1]=e("h3",null,"Level of Consciousness",-1))]),e("div",ds,[t.levelOfConsciousness.eyeResponse?(s(),o("div",ms,[n[2]||(n[2]=e("span",{class:"info-label"},"Eye Response:",-1)),e("span",ps,E(t.levelOfConsciousness.eyeResponse),1)])):x("",!0),t.levelOfConsciousness.verbalResponse?(s(),o("div",vs,[n[3]||(n[3]=e("span",{class:"info-label"},"Verbal Response:",-1)),e("span",fs,E(t.levelOfConsciousness.verbalResponse),1)])):x("",!0),t.levelOfConsciousness.motorResponse?(s(),o("div",hs,[n[4]||(n[4]=e("span",{class:"info-label"},"Motor Response:",-1)),e("span",gs,E(t.levelOfConsciousness.motorResponse),1)])):x("",!0)])])):(s(),o("div",_s,[a(m,{icon:t.alertCircleOutline},null,8,["icon"]),n[5]||(n[5]=e("p",null,"No level of consciousness recorded",-1))])),t.hasPresentingComplaints?(s(),o("div",ys,[e("div",bs,[a(m,{icon:t.documentTextOutline,class:"section-icon"},null,8,["icon"]),n[6]||(n[6]=e("h3",null,"Presenting Complaints",-1))]),e("div",Ds,[(s(!0),o(T,null,U(t.uniquePresentingComplaints,(y,D)=>(s(),o("div",{class:"complaint-tag",key:D},E(y),1))),128))])])):(s(),o("div",ws,[a(m,{icon:t.documentTextOutline},null,8,["icon"]),n[7]||(n[7]=e("p",null,"No presenting complaints recorded",-1))])),t.hasPregnancyData?(s(),o("div",Ss,[e("div",xs,[a(m,{icon:t.femaleOutline,class:"section-icon"},null,8,["icon"]),n[8]||(n[8]=e("h3",null,"Pregnancy Status",-1))]),e("div",Cs,[t.pregnancy.patientPregnant?(s(),o("div",ks,[n[9]||(n[9]=e("span",{class:"info-label"},"Pregnant:",-1)),e("span",Es,E(t.pregnancy.patientPregnant),1)])):x("",!0),t.pregnancy.breastFeeding?(s(),o("div",Is,[n[10]||(n[10]=e("span",{class:"info-label"},"Breastfeeding:",-1)),e("span",As,E(t.pregnancy.breastFeeding),1)])):x("",!0)])])):(s(),o("div",Ps,[a(m,{icon:t.femaleOutline},null,8,["icon"]),n[11]||(n[11]=e("p",null,"No pregnancy status recorded",-1))])),t.hasPastMedicalHistory?(s(),o("div",Os,[e("div",Ns,[a(m,{icon:t.medicalOutline,class:"section-icon"},null,8,["icon"]),n[12]||(n[12]=e("h3",null,"Medical History",-1))]),e("div",$s,[(s(!0),o(T,null,U(t.uniquePastMedicalHistory,(y,D)=>(s(),o("div",{class:"medical-tag",key:D},E(y),1))),128))])])):(s(),o("div",Ls,[a(m,{icon:t.medicalOutline},null,8,["icon"]),n[13]||(n[13]=e("p",null,"No medical history recorded",-1))])),t.hasAllergies?(s(),o("div",Ms,[e("div",Fs,[a(m,{icon:t.warningOutline,class:"section-icon"},null,8,["icon"]),n[14]||(n[14]=e("h3",null,"Allergies",-1))]),e("div",Bs,[t.item.selected?(s(!0),o(T,{key:0},U(t.selectedAllergiesList2,(y,D)=>(s(),o("div",{class:"allergy-tag",key:D},E(y.name),1))),128)):x("",!0)])])):(s(),o("div",Rs,[a(m,{icon:t.warningOutline},null,8,["icon"]),n[15]||(n[15]=e("p",null,"No allergies recorded",-1))])),t.hasPhysicalExam?(s(),o("div",Ts,[e("div",Vs,[a(m,{icon:t.bodyOutline,class:"section-icon"},null,8,["icon"]),n[16]||(n[16]=e("h3",null,"Physical Examination",-1))]),e("div",Hs,[t.eyesAbnormal.length?(s(),o("div",qs,[e("div",Us,[a(m,{icon:t.eyeOutline},null,8,["icon"]),n[17]||(n[17]=e("h4",null,"Eyes",-1))]),e("div",Ws,[(s(!0),o(T,null,U(t.eyesAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"eyes-"+D},E(y),1))),128))])])):t.eyesExamined?(s(),o("div",zs,[e("div",Gs,[a(m,{icon:t.eyeOutline},null,8,["icon"]),n[18]||(n[18]=e("h4",null,"Eyes",-1))]),n[19]||(n[19]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.mouthAbnormal.length?(s(),o("div",Ys,[e("div",js,[a(m,{icon:t.nutritionOutline},null,8,["icon"]),n[20]||(n[20]=e("h4",null,"Mouth",-1))]),e("div",Ks,[(s(!0),o(T,null,U(t.mouthAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"mouth-"+D},E(y),1))),128))])])):t.mouthExamined?(s(),o("div",Qs,[e("div",Js,[a(m,{icon:t.nutritionOutline},null,8,["icon"]),n[21]||(n[21]=e("h4",null,"Mouth",-1))]),n[22]||(n[22]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.earsAbnormal.length?(s(),o("div",Xs,[e("div",Zs,[a(m,{icon:t.earOutline},null,8,["icon"]),n[23]||(n[23]=e("h4",null,"Ears",-1))]),e("div",ea,[(s(!0),o(T,null,U(t.earsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"ears-"+D},E(y),1))),128))])])):t.earsExamined?(s(),o("div",ta,[e("div",na,[a(m,{icon:t.earOutline},null,8,["icon"]),n[24]||(n[24]=e("h4",null,"Ears",-1))]),n[25]||(n[25]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.faceAbnormal.length?(s(),o("div",sa,[e("div",aa,[a(m,{icon:t.happyOutline},null,8,["icon"]),n[26]||(n[26]=e("h4",null,"Face",-1))]),e("div",oa,[(s(!0),o(T,null,U(t.faceAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"face-"+D},E(y),1))),128))])])):t.faceExamined?(s(),o("div",ia,[e("div",la,[a(m,{icon:t.happyOutline},null,8,["icon"]),n[27]||(n[27]=e("h4",null,"Face",-1))]),n[28]||(n[28]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.neckAbnormal.length?(s(),o("div",ra,[e("div",ua,[a(m,{icon:t.manOutline},null,8,["icon"]),n[29]||(n[29]=e("h4",null,"Neck",-1))]),e("div",ca,[(s(!0),o(T,null,U(t.neckAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"neck-"+D},E(y),1))),128))])])):t.neckExamined?(s(),o("div",da,[e("div",ma,[a(m,{icon:t.manOutline},null,8,["icon"]),n[30]||(n[30]=e("h4",null,"Neck",-1))]),n[31]||(n[31]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.chestAbnormal.length?(s(),o("div",pa,[e("div",va,[a(m,{icon:t.fitnessOutline},null,8,["icon"]),n[32]||(n[32]=e("h4",null,"Chest",-1))]),e("div",fa,[(s(!0),o(T,null,U(t.chestAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"chest-"+D},E(y),1))),128))])])):t.chestExamined?(s(),o("div",ha,[e("div",ga,[a(m,{icon:t.fitnessOutline},null,8,["icon"]),n[33]||(n[33]=e("h4",null,"Chest",-1))]),n[34]||(n[34]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):x("",!0),t.chestMovementAbnormal.length?(s(),o("div",_a,[e("div",ya,[a(m,{icon:t.moveOutline},null,8,["icon"]),n[35]||(n[35]=e("h4",null,"Chest Movement",-1))]),e("div",ba,[(s(!0),o(T,null,U(t.chestMovementAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"chest-move-"+D},E(y),1))),128))])])):t.chestMovementExamined?(s(),o("div",Da,[e("div",wa,[a(m,{icon:t.moveOutline},null,8,["icon"]),n[36]||(n[36]=e("h4",null,"Chest Movement",-1))]),n[37]||(n[37]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal movement ")],-1))])):x("",!0),t.heartSoundsAbnormal.length?(s(),o("div",Sa,[e("div",xa,[a(m,{icon:t.pulseOutline},null,8,["icon"]),n[38]||(n[38]=e("h4",null,"Heart Sounds",-1))]),e("div",Ca,[(s(!0),o(T,null,U(t.heartSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"heart-"+D},E(y),1))),128))])])):t.heartSoundsExamined?(s(),o("div",ka,[e("div",Ea,[a(m,{icon:t.pulseOutline},null,8,["icon"]),n[39]||(n[39]=e("h4",null,"Heart Sounds",-1))]),n[40]||(n[40]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal heart sounds ")],-1))])):x("",!0),t.breathSoundsAbnormal.length?(s(),o("div",Ia,[n[41]||(n[41]=e("div",{class:"exam-category-header"},[e("h4",null,"Breath Sounds")],-1)),e("div",Aa,[(s(!0),o(T,null,U(t.breathSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"breath-"+D},E(y),1))),128))])])):t.breathSoundsExamined?(s(),o("div",Pa,n[42]||(n[42]=[e("div",{class:"exam-category-header"},[e("h4",null,"Breath Sounds")],-1),e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal breath sounds ")],-1)]))):x("",!0),t.addedBreathSoundsAbnormal.length?(s(),o("div",Oa,[e("div",Na,[a(m,{icon:t.addOutline},null,8,["icon"]),n[43]||(n[43]=e("h4",null,"Added Breath Sounds",-1))]),e("div",$a,[(s(!0),o(T,null,U(t.addedBreathSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"added-breath-"+D},E(y),1))),128))])])):t.addedBreathSoundsExamined?(s(),o("div",La,[e("div",Ma,[a(m,{icon:t.addOutline},null,8,["icon"]),n[44]||(n[44]=e("h4",null,"Added Breath Sounds",-1))]),n[45]||(n[45]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," No abnormal added sounds ")],-1))])):x("",!0),t.abdominalInspectionAbnormal.length?(s(),o("div",Fa,[e("div",Ba,[a(m,{icon:t.scanOutline},null,8,["icon"]),n[46]||(n[46]=e("h4",null,"Abdominal Inspection",-1))]),e("div",Ra,[(s(!0),o(T,null,U(t.abdominalInspectionAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"abdomen-"+D},E(y),1))),128))])])):t.abdominalInspectionExamined?(s(),o("div",Ta,[e("div",Va,[a(m,{icon:t.scanOutline},null,8,["icon"]),n[47]||(n[47]=e("h4",null,"Abdominal Inspection",-1))]),n[48]||(n[48]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal abdominal inspection ")],-1))])):x("",!0)])])):(s(),o("div",Ha,[a(m,{icon:t.bodyOutline},null,8,["icon"]),n[49]||(n[49]=e("p",null,"No physical exam recorded",-1))]))])])}const Ua=de(as,[["render",qa],["__scopeId","data-v-8f0a8a33"]]),Wa=Q(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Spontaneously",value:"Spontaneously"},{label:"To speech",value:"To speech"},{label:"To pain",value:"To pain"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Oriented to time, place and person",value:"Oriented to time, place and person"},{label:"Confused",value:"Confused"},{label:"Inappropriate words",value:"Inappropriate words"},{label:"Incomprehensible sounds",value:"Incomprehensible sounds"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Obeys commands",value:"Obeys commands"},{label:"Moves to localised pain",value:"Moves to localised pain"},{label:"Flexion withdrawal from pain",value:"Flexion withdrawal from pain"},{label:"Abnormal flexion (decorticate)",value:"Abnormal flexion (decorticate)"},{label:"Abnormal extension (decerebrate)",value:"Abnormal extension (decerebrate)"},{label:"No response",value:"No response"}]}]),za=Q(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Directed eye movements",value:"Directed eye movements"},{label:"Not directed",value:"Not directed"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Appropriate cry",value:"Appropriate cry"},{label:"Inappropriate cry or moan",value:"Inappropriate cry or moan"},{label:"No cry",value:"No cry"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Localizes pain",value:"Localizes pain"},{label:"Withdraws from pain",value:"Withdraws from pain"},{label:"Non specific or no response",value:"Non specific or no response"}]}]),Ga={Spontaneously:4,"To speech":3,"To pain":2,"No response":1},Ya={"Oriented to time, place and person":5,Confused:4,"Inappropriate words":3,"Incomprehensible sounds":2,"No response":1},ja={"Obeys commands":6,"Moves to localised pain":5,"Flexion withdrawal from pain":4,"Abnormal flexion (decorticate)":3,"Abnormal extension (decerebrate)":2,"No response":1},Ka={"Not directed":0,"Directed eye movements":1},Qa={"Non specific or no response":0,"Withdraws from pain":1,"Localizes pain":2},Ja={"No cry":0,"Inappropriate cry or moan":1,"Appropriate cry":2},Xa={class:"modal_wrapper"},Za=te({__name:"LevelOfConsciousness",setup(t,{expose:n}){var D,u;const v=Ne(),{patient:g}=Pe(v),w=c(Ue.getAgeInYears((u=(D=g==null?void 0:g.value)==null?void 0:D.personInformation)==null?void 0:u.birthdate)),C=c(null),m=Q(()=>{var Y,X,_,i;const h=((Y=C.value)==null?void 0:Y.getFormValues())||{},l=h["Eye opening response"]||"",V=h["Best motor response"]||"",P=h["Best verbal response"]||"",R=w.value<18,A=(X=(R?Ka:Ga)[l])!=null?X:0,L=(_=(R?Qa:ja)[V])!=null?_:0,F=(i=(R?Ja:Ya)[P])!=null?i:0,H=A+L+F;return"(M ".concat(L," V ").concat(F," E ").concat(A,") ").concat(H,"/").concat(R?5:15)});return n({onSubmit:async()=>{var l;if(!C.value){console.error("Form reference is not available");return}const h=((l=C.value)==null?void 0:l.getFormValues())||{};h["Eye opening response"]||h["Best motor response"]||h["Best verbal response"]?(await ee.buildAddObsToEncounterPatient(h,xe.ASSESSMENT),C.value.resetForm(),$e("Level of Consciousness saved successfully")):ue(" No level of consciousness data to save ")}}),(h,l)=>(s(),o("div",Xa,[w.value<18?(s(),$(He,{key:0,formData:r(za),ref_key:"formRef",ref:C},null,8,["formData"])):(s(),$(He,{key:1,formData:r(Wa),ref_key:"formRef",ref:C},null,8,["formData"])),e("h5",null,E(m.value),1)]))}}),eo={class:"modal_wrapper"},to=te({__name:"PregnancyBreastfeeding",setup(t,{expose:n}){const v=En(),{pregnancy:g}=Pe(v),w=()=>{};return n({onSubmit:async()=>{const m=await Ze(g.value);m.length>0?(await ee.addObsToEncounterPatient(m,xe.PREGNANCY_STATUS),$e("Pregnancy status saved successfully")):ue("No pregnancy status data to save ")}}),(m,y)=>(s(),o("div",eo,[a(Xe,{contentData:r(g),"onUpdate:inputValue":w},null,8,["contentData"])]))}}),no={class:"modal_wrapper"},so={class:"uniform_columns"},ao=te({__name:"PastMedicalHistory",setup(t,{expose:n}){const v=In(),{pastMedicalHistory:g}=Pe(v),w=c([]);Oe(()=>{w.value=v.getInitial(),C()}),_e(g,()=>{C()},{deep:!0});const C=()=>{var h;const u=["TB","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Epilepsy","Previous stroke","Peptic Ulcer Disease (PUD)","Mental disorder","Bleeding disorders","Hypertension","HIV Positive","Diabetes Mellitus"];(h=An(g.value,"None"))!=null&&h.checked?u.forEach(l=>{he(g.value,"TB treatment","displayNone",!0),De(g.value,"TB drugs","displayNone",!0),De(g.value,"TB drug start date","displayNone",!0),he(g.value,"Hypertension medication","displayNone",!0),De(g.value,"Current hypertension treatment regimen","displayNone",!0),he(g.value,"HIV status","displayNone",!0),De(g.value,"ARV start date","displayNone",!0),he(g.value,"Diabetes","displayNone",!0),he(g.value,"Controlled by","displayNone",!0),ge(g.value,l,"checked",!1),ge(g.value,l,"disabled",!0)}):u.forEach(l=>{ge(g.value,l,"disabled",!1)})},m=u=>{De(g.value,"TB drugs","popOverData",{filterData:!0,data:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"},{name:"Cycloserine 125mg"},{name:"Cycloserine 250mg"},{name:"Delamanid 50mg"},{name:"Ethambutol 100mg"},{name:"Ethambutol 400mg"},{name:"Ethionamide 250mg"},{name:"Isoniazid 100mg "},{name:"Isoniazid 300mg"},{name:"Isoniazid / Rifapentine 300mg / 300mg"},{name:"Levofloxacin 100mg"},{name:"Levofloxacin 250mg"},{name:"Linezolid 600mg"},{name:"Moxifloxacin 400mg"},{name:"Pyrazinamide 400mg"},{name:"Rifabutin 150mg Capsules"},{name:"Rifampicin 150mg/isoniazid 75mg"},{name:"Rifampicin 75mg+INH 50mg dispersible"},{name:"Rifampicin 75mg+INH 50mg+Pyrazinamide 150mg dispersible"},{name:"Rifampicin150mg/Isoniazid75mg/Pyrazinamide 400mg/Ethambutol"}]}),De(g.value,"Current hypertension treatment regimen","popOverData",{filterData:!0,data:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}]})},y=async()=>[...await kt(g.value),...await Ze(g.value),...await Et(g.value)];return n({onSubmit:async()=>{const u=await y();if(u.length===0){ue("No past medical history data to save");return}await ee.addObsToEncounterPatient(u,xe.PAST_MEDICAL_HISTORY),$e("Past medical history saved successful")}}),(u,h)=>(s(),o("div",no,[e("div",so,[a(Xe,{contentData:r(g),initialData:w.value,"onUpdate:inputValue":m,"onUpdate:selected":m},null,8,["contentData","initialData"])])]))}}),oo=de(ao,[["__scopeId","data-v-49fdce72"]]),io={class:"container"},lo=te({__name:"PhysicalExamination",setup(t,{expose:n}){const v=Pn(),g=Ne(),{physicalExam:w}=Pe(v),{patient:C}=Pe(g),m=c([]);Oe(()=>{m.value=v.getInitial(),y(),D()}),_e(w,()=>{y(),D()},{deep:!0});const y=()=>{On(w.value,"Physical examination")=="No"?he(w.value,"Reason why physical examination not done","displayNone",!1):(he(w.value,"Reason why physical examination not done","displayNone",!0),he(w.value,"Reason why physical examination not done","selectedValue",""))},D=()=>{var V,P;const l=(P=(V=C.value)==null?void 0:V.personInformation)==null?void 0:P.gender;l=="M"&&(ge(w.value,"Vulva examination","disabled",!0),ge(w.value,"Visible bleeding","disabled",!0)),l=="F"&&(ge(w.value,"Urethral meatus abnormal","disabled",!0),ge(w.value,"Scrotal swelling","disabled",!0),ge(w.value,"Tastes swelling","disabled",!0))},u=async()=>[...await kt(w.value),...await Ze(w.value),...await Et(w.value)];return n({onSubmit:async()=>{const l=await u();if(l.length===0){ue("No physical examination data to save");return}await ee.addObsToEncounterPatient(l,xe.PHYSICAL_EXAMINATION),$e("Diagnosis saved successful")}}),(l,V)=>{const P=J("ion-card-content"),R=J("ion-card");return s(),o("div",io,[a(R,{class:"section"},{default:d(()=>[a(P,null,{default:d(()=>[a(Xe,{contentData:r(w),initialData:m.value},null,8,["contentData","initialData"])]),_:1})]),_:1})])}}}),ro=de(lo,[["__scopeId","data-v-3818e796"]]),uo={key:0},co={class:"ion-padding",slot:"content"},mo={class:"nav-buttons"},po={class:"ion-padding",slot:"content"},vo={class:"nav-buttons"},fo={class:"ion-padding",slot:"content"},ho={class:"nav-buttons"},go={class:"ion-padding",slot:"content"},_o={class:"nav-buttons"},yo={class:"ion-padding",slot:"content"},bo={class:"nav-buttons"},Do={class:"ion-padding",slot:"content"},wo={class:"nav-buttons"},So=te({__name:"ClinicalAssessment",setup(t,{expose:n}){const v=c("loc"),g=c(0),w=new Nn,C=Ne(),m=()=>{g.value++},y=c(null),D=c(null),u=c(null),h=c(null),l=c(null),V=c(null),P=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>w.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}],R=Q(()=>{const _=C.patient;if(!_)return!1;const k=new Date().toISOString().split("T")[0];return["levelOfConsciousness","presentingComplaints","pastMedicalHistory","physicalExam","allergies","pregnancy"].some(I=>{var z,Z;return[...((z=_[I])==null?void 0:z.saved)||[],...((Z=_[I])==null?void 0:Z.unsaved)||[]].some(ne=>ne.obs_datetime?new Date(ne.obs_datetime).toISOString().split("T")[0]===k:!1)})}),A=Q(()=>P.filter(_=>typeof _.show=="function"?_.show():_.show)),L=_=>{const i=P.find(k=>k.id===_);return i?typeof i.show=="function"?i.show():i.show:!1},F=_=>A.value.findIndex(i=>i.id===_),H=_=>{const i=F(_);i>0&&(v.value=A.value[i-1].id)},Y=_=>{const k=F(_)+1;k<A.value.length?v.value=A.value[k].id:(v.value="",m())};return n({onSubmit:async()=>{const _=[{ref:y,name:"PresentingComplaints"},{ref:D,name:"LevelOfConsciousness"},{ref:u,name:"PastMedicalHistory"},{ref:l,name:"PregnancyBreastfeeding"},{ref:V,name:"PhysicalExamination"}];for(const i of _)if(i.ref.value&&typeof i.ref.value.onSubmit=="function")try{await i.ref.value.onSubmit()}catch(k){console.error("Error calling ".concat(i.name," onSubmit:"),k)}else console.log("".concat(i.name," component ref not available or no onSubmit method"))}}),(_,i)=>R.value?(s(),o("div",uo,[(s(),$(Ua,{key:g.value}))])):(s(),$(r(hn),{key:1,style:{width:"100%"}},{default:d(()=>[a(r(Be),{value:v.value,"onUpdate:value":i[12]||(i[12]=k=>v.value=k),ref:"accordionGroup",class:"previousView"},{default:d(()=>[L("loc")?(s(),$(r(ce),{key:0,value:"loc",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[13]||(i[13]=[O("Level of consciousness")])),_:1,__:[13]})]),_:1}),e("div",co,[a(Za,{"is-active":v.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:D,onDataSaved:m},null,8,["is-active"]),e("div",mo,[F("loc")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[0]||(i[0]=re(k=>H("loc"),["stop"]))},{default:d(()=>i[14]||(i[14]=[O(" Back ")])),_:1,__:[14]})):x("",!0),a(r(le),{fill:"outline",onClick:i[1]||(i[1]=re(k=>Y("loc"),["stop"]))},{default:d(()=>[O(E(F("loc")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0),L("pc")?(s(),$(r(ce),{key:1,value:"pc",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[15]||(i[15]=[O("Presenting complaints")])),_:1,__:[15]})]),_:1}),e("div",po,[a(ss,{"is-active":v.value==="pc",onDataSaved:m,ref_key:"presentingComplaintsFormRef",ref:y},null,8,["is-active"]),e("div",vo,[F("pc")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[2]||(i[2]=re(k=>H("pc"),["stop"]))},{default:d(()=>i[16]||(i[16]=[O(" Back ")])),_:1,__:[16]})):x("",!0),a(r(le),{fill:"outline",onClick:i[3]||(i[3]=re(k=>Y("pc"),["stop"]))},{default:d(()=>[O(E(F("pc")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0),L("pbs")?(s(),$(r(ce),{key:2,value:"pbs",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[17]||(i[17]=[O("Pregnancy and breastfeeding status")])),_:1,__:[17]})]),_:1}),e("div",fo,[a(to,{"is-active":v.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:l,onDataSaved:m},null,8,["is-active"]),e("div",ho,[F("pbs")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[4]||(i[4]=re(k=>H("pbs"),["stop"]))},{default:d(()=>i[18]||(i[18]=[O(" Back ")])),_:1,__:[18]})):x("",!0),a(r(le),{fill:"outline",onClick:i[5]||(i[5]=re(k=>Y("pbs"),["stop"]))},{default:d(()=>[O(E(F("pbs")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0),L("pmh")?(s(),$(r(ce),{key:3,value:"pmh",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[19]||(i[19]=[O("Past medical history")])),_:1,__:[19]})]),_:1}),e("div",go,[a(oo,{"is-active":v.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:u,onDataSaved:m},null,8,["is-active"]),e("div",_o,[F("pmh")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[6]||(i[6]=re(k=>H("pmh"),["stop"]))},{default:d(()=>i[20]||(i[20]=[O(" Back ")])),_:1,__:[20]})):x("",!0),a(r(le),{fill:"outline",onClick:i[7]||(i[7]=re(k=>Y("pmh"),["stop"]))},{default:d(()=>[O(E(F("pmh")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0),L("al")?(s(),$(r(ce),{key:4,value:"al",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[21]||(i[21]=[O("Allergies")])),_:1,__:[21]})]),_:1}),e("div",yo,[a(Tn,{"is-active":v.value==="al",ref_key:"allergiesFormRef",ref:h,onDataSaved:m},null,8,["is-active"]),e("div",bo,[F("al")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[8]||(i[8]=re(k=>H("al"),["stop"]))},{default:d(()=>i[22]||(i[22]=[O(" Back ")])),_:1,__:[22]})):x("",!0),a(r(le),{fill:"outline",onClick:i[9]||(i[9]=re(k=>Y("al"),["stop"]))},{default:d(()=>[O(E(F("al")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0),L("pe")?(s(),$(r(ce),{key:5,value:"pe",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[23]||(i[23]=[O("Physical examination")])),_:1,__:[23]})]),_:1}),e("div",Do,[a(ro,{"is-active":v.value==="pe",ref_key:"physicalExaminationFormRef",ref:V,onDataSaved:m},null,8,["is-active"]),e("div",wo,[F("pe")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[10]||(i[10]=re(k=>H("pe"),["stop"]))},{default:d(()=>i[24]||(i[24]=[O(" Back ")])),_:1,__:[24]})):x("",!0),a(r(le),{fill:"outline",onClick:i[11]||(i[11]=re(k=>Y("pe"),["stop"]))},{default:d(()=>[O(E(F("pe")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):x("",!0)]),_:1},8,["value"])]),_:1}))}}),Oi=de(So,[["__scopeId","data-v-a8c21622"]]);class xo extends ct{constructor(n,v){super(n,8,v)}static async getDiagnosis(n="",v=1,g=10){const w=await j.getConceptID("Qech outpatient diagnosis list");return ct.getJson("diagnosis",{id:w,name:n,page:v,page_size:g})}}const Co=te({name:"Menu",components:{IonContent:ht,IonHeader:ft,IonItem:K,IonList:Ae,IonMenu:vt,IonTitle:pt,IonToolbar:mt,List:qe},computed:{...Ve(Ne,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:wt(["#006401"]),listIcon:Dt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:gt,pulseOutline:Je}},async mounted(){const t=await ee.getAll(this.patient.patientID,"Primary diagnosis"),n=await ee.getAll(this.patient.patientID,"Secondary diagnosis"),v=await ee.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),g=[...t||[],...n||[],...v||[]],w=fe.isEmpty(g)?[]:Promise.all(g.map(async C=>({name:await ee.getConceptName(C.value_coded),obs_date:C.obs_datetime})));this.setListData(await w)},methods:{dismiss(){gn.dismiss()},handleIcon(){},setActivClass(t){this.activeHeight="",this.activeBMI="",this.activeWeight="",t=="height"?this.activeHeight="_active":t=="weight"?this.activeWeight="_active":t=="BMI"&&(this.activeBMI="_active")},setListData(t){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),t.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[Ue.toStandardHisFormat(n.obs_date),n.name,""]})})}}}),ko={class:"modal_wrapper"};function Eo(t,n,v,g,w,C){const m=J("list");return s(),o("div",ko,[e("div",null,[a(m,{listData:t.list},null,8,["listData"])])])}const Io=de(Co,[["render",Eo],["__scopeId","data-v-88580898"]]),Ao={class:"custom_card",style:{padding:"10px"}},Po={key:0},Oo={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},No={class:"ion-padding",slot:"content"},$o=te({__name:"OPDDiagnosis",setup(t,{expose:n}){const v=Ie,g=c(!0),w=c(!1),C=c(!0),m=c(!1),y=c(!0),D=c(""),u=c(""),h=c([]),l=c([]),V=c(),P=c(null);$n();const R=Q(()=>l.value.some(b=>b.data.concept_id===6542));_e(l,()=>{i()},{deep:!0});const A=Q(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:h.value,icon:v.search,onSearchChange:X,validation:Re.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:h.value,icon:v.search,condition:b=>b==null?void 0:b.secondaryDiagnosisCheckbox,onSearchChange:X,validation:(b,I)=>L(I,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:h.value,icon:v.search,isMultiple:!0,condition:b=>b==null?void 0:b.differentialDiagnosisCheckbox,onSearchChange:X,validation:(b,I)=>L(I,"differentialDiagnosis")}]),L=(b,I)=>{var se,q,ye;if(!b)return null;const M=(se=b.primaryDiagnosis)==null?void 0:se.name,z=((q=b.secondaryDiagnosis)==null?void 0:q.map(me=>me.name))||[],Z=((ye=b.differentialDiagnosis)==null?void 0:ye.map(me=>me.name))||[];if(I==="secondaryDiagnosis"&&z.includes(M)||I==="differentialDiagnosis"&&Z.includes(M))return"".concat(M," is already the primary diagnosis");const ne=z.find(me=>Z.includes(me));return ne?"".concat(ne," cannot be both secondary and differential"):null},F=()=>{u.value="",D.value="",g.value=!1,y.value=!1,w.value=!0},H=async()=>{var b;((b=P.value)==null?void 0:b.validateForm())==null&&(Y(),w.value=!1,m.value=!0,y.value=!0,C.value=!1)},Y=()=>{var se;const b=[],I=l.value.map(q=>q.name),M=((se=P.value)==null?void 0:se.getFormValues())||{},z=M.primaryDiagnosis||[],Z=M.secondaryDiagnosis||[],ne=M.differentialDiagnosis||[];if(z.name&&!I.includes(z.name))if(!l.value.some(ye=>ye.data.concept_id===6542))b.push({actionBtn:!0,btn:["delete"],name:z.name,id:z.concept_id,display:[z.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:z.concept_id,obs_datetime:Se.getSessionDate()}});else return Ln("Only one primary diagnosis is allowed"),!1;return Z&&Z.forEach(q=>{I.includes(q.name)||b.push({actionBtn:!0,btn:["delete"],name:q.name,id:q.concept_id,display:[q.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:q.concept_id,obs_datetime:Se.getSessionDate()}})}),ne&&ne.forEach(q=>{I.includes(q.name)||b.push({actionBtn:!0,btn:["delete"],name:q.name,id:q.concept_id,display:[q.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:q.concept_id,obs_datetime:Se.getSessionDate()}})}),b.length>0&&(l.value=[...l.value,...b]),!0},X=async b=>{const I=b.trim().toLowerCase()||"";return h.value=await xo.getDiagnosis(I,1,15),h.value},_=b=>{const I=l.value,M=b.name,z=I.filter(Z=>Z.display[0]!==M);l.value=z},i=()=>{l.value.length>0?(m.value=!0,g.value=!1):w.value||(g.value=!0),y.value=!R.value},k=async()=>{if(l.value.length<=0){ue("Diagnosis not saved");return}const b=l.value.flatMap(M=>M.data);if(b.length<=0)return ue("Diagnosis not saved");const I=await ee.addObsToEncounter(b,xe.DIAGNOSIS);await ee.mergeObsToPatient(I),$e("Diagnosis saved successful"),l.value=[]};return Oe(async()=>{i(),await X("")}),n({onSubmit:k}),(b,I)=>{const M=J("ion-row"),z=J("ion-label"),Z=J("ion-accordion"),ne=J("ion-accordion-group");return s(),o(T,null,[e("div",Ao,[a(Ct,{status:g.value,content:"No Diagnosis added"},null,8,["status"]),m.value?(s(),o("span",Po,[a(qe,{listData:l.value,"onClicked:delete":_},null,8,["listData"]),R.value?(s(),o("div",Oo," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):x("",!0)])):x("",!0),w.value?(s(),$(M,{key:1},{default:d(()=>{var se;return[e("div",null,[a(He,{formData:A.value,ref_key:"formRef",ref:P},null,8,["formData"])]),e("div",null,[a(we,{fill:"clear",icon:r(v).plus,iconSlot:"icon-only","onClicked:btn":I[0]||(I[0]=q=>H()),name:"Save",disabled:(se=P.value)==null?void 0:se.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):x("",!0),y.value?(s(),$(M,{key:2,style:{"margin-top":"10px"}},{default:d(()=>[a(we,{fill:"clear",icon:r(v).plus,iconSlot:"icon-only","onClicked:btn":I[1]||(I[1]=se=>F()),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):x("",!0)]),a(M,null,{default:d(()=>[a(ne,{ref_key:"accordionGroup",ref:V,class:"previousView"},{default:d(()=>[a(Z,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(z,{class:"previousLabel"},{default:d(()=>I[2]||(I[2]=[O("Previous Diagnosis")])),_:1,__:[2]})]),_:1}),e("div",No,[a(Io)])]),_:1})]),_:1},512)]),_:1})],64)}}}),Ni=de($o,[["__scopeId","data-v-cdf4ce7e"]]),Lo={class:"allergies-section"},Mo={class:"allergies-container"},Fo={key:0,class:"allergies-grid"},Bo={key:1,class:"no-allergies"},Ro={class:"ion-padding",slot:"content"},To={key:0},Vo={class:"previousSecDrgs"},Ho={class:"ion-padding",slot:"content"},qo={class:"previousSecDrgs"},Uo={class:"medication-section"},Wo={class:"medication-content"},zo={key:0,class:"add-medication-form"},Go={class:"form-group"},Yo={class:"option-label"},jo={key:0,class:"error-message"},Ko={class:"form-row"},Qo={class:"form-group"},Jo={key:0,class:"error-message"},Xo={class:"form-group"},Zo={key:0,class:"error-message"},ei={class:"form-group"},ti={key:0,class:"error-message"},ni={class:"action-buttons"},si={class:"notes-section"},ai={class:"notes-content"},oi={class:"notes-input-container"},ii={class:"ion-padding",slot:"content"},li={class:"notes-timeline"},ri={class:"note-date"},ui={class:"note-content"},ci={class:"ion-padding",slot:"content"},di={class:"note-date"},mi={class:"note-content"},pi=te({watch:{},name:"xxxComponent"}),vi=te({...pi,setup(t){const n=Ie,v=Un,g=c(!1),w=c(!1),C=c(!0),m=c(0),y=c(""),D=c(!1),u=c(""),h=c(!1),l=c(),V=c(!1),P=c(""),R=c(""),A=c(""),L=c(""),F=c(""),H=c("");c(!1);const Y="Add new medication",X="clear";c("Show more medications");const _=ke(),i=xt(),k=Q(()=>i.selectedMedicalAllergiesList),b=Q(()=>_.selectedMedicalDrugsList),I=Q(()=>_.partialOPDdrugList),M=Q(()=>_.nonPharmalogicalTherapyAndOtherNotes),z=["first","second","third"],Z=c(),ne=c(),se=c(),q=c(!1),ye=c(!1),me=c(!1),We=c("Show more notes"),ze=c("Show more allergies"),et=c(),tt=c(),Ce=c(),Te=Q(()=>_.editingDrugItem),It=c("Select a route"),Ge=c(!1),At=c("Select frequency"),Ye=c(!1),Pt=c("Select drug"),je=c(!1),ae=c(),oe=c(),pe=c(),Le=c([]),Ot=c([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),Nt=Q(()=>Le.value.length?Le.value:Ot.value);function $t(f){ae.value=f}async function Lt(){return await Wn()}async function Mt(f=5,p=1e3){let N=0;for(;N<f&&(Le.value=await Lt(),!(Le.value.length>0));)N++,await new Promise(W=>setTimeout(W,p));Le.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}Oe(async()=>{const f=new Vn,{previousDrugPrescriptions:p,previousClinicalNotes:N,previousDrugAllergies:W}=await f.getPatientEncounters();Z.value=p,ne.value=Object.entries(N)[0];const[,...S]=Object.entries(N);se.value=S,et.value=Object.entries(W)[0];const[,...B]=Object.entries(W);tt.value=B,await Mt()}),_e(()=>P.value,async f=>{nt()}),_e(()=>R.value,async f=>{Vt()}),_e(()=>A.value,async f=>{st()});function Ft(){if(fe.isEmpty(ae.value)==!0)return Ge.value=!0,!1;if(fe.isEmpty(ae.value)==!1)return Ge.value=!1,!0}function Bt(){if(fe.isEmpty(oe.value)==!0)return Ye.value=!0,!1;if(fe.isEmpty(oe.value)==!1)return Ye.value=!1,!0}function Rt(){if(fe.isEmpty(pe.value)==!0)return je.value=!0,!1;if(fe.isEmpty(pe.value)==!1)return je.value=!1,!0}function Tt(){C.value=!C.value,g.value=!0,h.value=!1,V.value=!1}async function nt(){const f=await Wt();return console.log({drugNameExists:f}),f?D.value=!1:(y.value="please select a valid drug name",D.value=!0),D.value}async function Vt(){return it(R.value)?h.value=!1:(u.value="please enter a number",h.value=!0),h.value}async function st(){return it(A.value)?V.value=!1:(l.value="please enter a number",V.value=!0),V.value}async function at(){const f=await nt(),p=await st(),N=Bt(),W=Rt(),S=Ft();return!f&&!p&&N==!0&&W==!0&&S==!0}function Ht(f){oe.value=f}async function ot(){const f=()=>Ce.value.dose_strength!=null&&Ce.value.dose_strength?Math.trunc(Ce.value.dose_strength):1;if(Te.value!==null){if(!await at()){ue("Please enter correct data values",4e3);return}const N=Se.getSessionDate(),W=lt(N,parseInt(A.value));let S=!1;Ke(Ce.value)==!0&&(S=!0);const B={drugName:P.value,dose:f(),frequency:oe.value.label,frequency_code:oe.value.code,duration:A.value,prescription:W,drug_id:H.value,units:F.value,route_concept_id:ae.value.concept_id,route_name:ae.value.name,highlightbackground:S},ie=ke();console.log(ie.setSelectedMedicalDrugsList([B])),ie.editingDrugItem=null,C.value=!0}else{if(!await at()){ue("Please enter correct data values",4e3);return}Xt();const N=Se.getSessionDate(),W=lt(N,parseInt(A.value));let S=!1;Ke(Ce.value)==!0&&(S=!0);const B={drugName:P.value,dose:f(),frequency:oe.value.label,frequency_code:oe.value.code,duration:A.value,prescription:W,drug_id:H.value,units:F.value,route_concept_id:ae.value.concept_id,route_name:ae.value.name,highlightbackground:S};ke().setSelectedMedicalDrugsList([B])}H.value="",P.value="",R.value="",oe.value=null,A.value="",L.value="",m.value++,pe.value=null,ae.value=null}async function qt(f){const p=f,S=await dt.getOfflineOPDDrugs({name:p,page:1,page_size:10});S.map(B=>({label:B.name,value:B.name,other:B})),_.setPartialOPDdrugList(S)}async function Ut(f){let p;f.target===void 0?p=f:p=f.target.value;const S=await dt.getOPDDrugs({name:encodeURIComponent(p),page:1,page_size:10});return S.map(B=>({label:B.name,value:B.name,other:B})),S}function Ke(f){const p=[];return k.value.forEach(W=>{W.selected&&p.push(W.concept_id)}),zt([f],p)==!0?(ue("Client is allergic to the selected medication",4e6),!0):!1}async function Wt(){return(await Ut(P.value)).length>0?P.value.length!=0:!1}function zt(f,p){try{return f.some(N=>p.includes(N.concept_id))}catch(N){return!1}}function Gt(f){f&&(P.value=f.name,H.value=f.drug_id,F.value=f.units,Ce.value=f,Ke(f))}function Yt(f){const p=b.value[f],N=ke();N.removeDrugById(p.drug_id),N.editingDrugItem=p,H.value="",P.value="",R.value="",oe.value=null,A.value="",L.value="",pe.value=null,ae.value=null,H.value=p.drug_id,P.value=p.drugName,R.value=p.dose,oe.value={label:p.frequency,code:p.frequency_code},A.value=p.duration,L.value=p.prescription;const W=I.value.find(S=>S.name===p.drugName);W&&(pe.value=W),ae.value={concept_id:p.route_concept_id,name:p.route_name},C.value=!1,m.value++}function jt(){if(Te.value!==null){H.value="",P.value="",R.value="",oe.value=null,A.value="",L.value="",pe.value=null,ae.value=null;const f=ke();f.setSelectedMedicalDrugsList([Te.value]),f.editingDrugItem=null}C.value=!0,m.value++}function Kt(f){b.value.splice(f,1),m.value++,ue("you have removed a drug from list",6e3)}function Qt(f){let p=f.target.value;Jt(p)}function Jt(f){ke().setNonPharmalogicalTherapyAndOtherNotes(f)}function it(f){return/^[0-9]+$/.test(f)}function lt(f,p){const N=new Date(f);N.setDate(N.getDate()+p);const W=N.getFullYear(),S=String(N.getMonth()+1).padStart(2,"0"),B=String(N.getDate()).padStart(2,"0");return"".concat(W,"-").concat(S,"-").concat(B)}function Xt(){g.value=!1,w.value=!0,C.value=!0}function Zt(f){z.filter(N=>N!==f.detail.value);const p=f.detail.value;p!==void 0?p=="third"&&(We.value="Show less notes",ye.value=!q.value):(We.value="Show more notes",ye.value=!q.value)}function en(f){z.filter(N=>N!==f.detail.value);const p=f.detail.value;p!==void 0?p=="fith"&&(ze.value="Show less allegies",me.value=!q.value):(ze.value="Show more allegies",me.value=!q.value)}function rt(f){return f[1]}function tn(f){(f.key==="Enter"||f.key==="ArrowDown")&&(f.preventDefault(),ot())}const ve=Q(()=>[{showAddItemButton:!0,addItemButton:!0,name:Te.value!==null?"Update":"ADD",btnFill:"clear",fn:ot},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",btnFill:"clear",fn:jt}]);return(f,p)=>{const N=J("ion-chip"),W=J("ion-text");return s(),$(r(Ae),null,{default:d(()=>[e("div",Lo,[a(r(G),{class:"section-title"},{default:d(()=>[a(r(Ee),{icon:r(bt),class:"alert-icon"},null,8,["icon"]),a(r(G),null,{default:d(()=>p[9]||(p[9]=[O("Allergies (Medication, Healthcare items, Environment and Food)")])),_:1,__:[9]})]),_:1}),e("div",Mo,[k.value.some(S=>S.selected)?(s(),o("div",Fo,[(s(!0),o(T,null,U(k.value,(S,B)=>_n((s(),o("div",{key:B,class:"allergy-item"},[a(N,{class:"allergy-chip",color:"danger"},{default:d(()=>[a(r(G),null,{default:d(()=>[O(E(S.name),1)]),_:2},1024),a(r(Ee),{icon:r(yn)},null,8,["icon"])]),_:2},1024)])),[[bn,S.selected]])),128))])):(s(),o("div",Bo,[a(W,{style:{"font-size":"16px","font-weight":"600",color:"#9c8011"}},{default:d(()=>p[10]||(p[10]=[O("No allergies recorded")])),_:1,__:[10]})])),a(r(Be),{ref:"accordionGroup",class:"previousView"},{default:d(()=>[a(r(ce),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>p[11]||(p[11]=[O("Documented allergies timeline")])),_:1,__:[11]})]),_:1}),e("div",Ro,[(s(!0),o(T,null,U(et.value,(S,B)=>(s(),o("div",{class:"ionLbltp",key:B},[B==1?(s(),o("div",To,[e("div",null,[a(r(G),{class:"previousLabelDate"},{default:d(()=>[O(E(S[0].date),1)]),_:2},1024)]),(s(!0),o(T,null,U(S,(ie,be)=>(s(),o("div",{key:be},[e("div",Vo,[a(r(Ae),null,{default:d(()=>[a(r(G),{class:"notes_p"},{default:d(()=>[O(E(ie.value),1)]),_:2},1024)]),_:2},1024)])]))),128))])):x("",!0)]))),128)),a(r(Be),{onIonChange:en},{default:d(()=>[a(r(ce),{value:"fith","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"",color:"primary"},{default:d(()=>[O(E(ze.value),1)]),_:1})]),_:1}),e("div",Ho,[(s(!0),o(T,null,U(tt.value,(S,B)=>(s(),o("div",{class:"ionLbltp",key:B},[e("div",null,[a(r(G),{class:"previousLabelDate"},{default:d(()=>[O(E(S[0]),1)]),_:2},1024)]),(s(!0),o(T,null,U(rt(S),(ie,be)=>(s(),o("div",{key:be},[e("div",qo,[a(r(Ae),null,{default:d(()=>[a(r(G),{class:"notes_p"},{default:d(()=>[O(E(ie.value),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)])]),e("div",Uo,[a(r(K),{lines:"none",class:"section-header"},{default:d(()=>[a(r(Ee),{icon:r(yt),class:"section-icon"},null,8,["icon"]),a(r(G),{class:"section-title",style:{"margin-top":"12px"}},{default:d(()=>p[12]||(p[12]=[O("Medication")])),_:1,__:[12]})]),_:1}),e("div",Wo,[(s(),$(Hn,{_selectedMedicalDrugsList:b.value,onEditItem:Yt,onRemoveItem:Kt,key:m.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),C.value?x("",!0):(s(),o("div",zo,[e("div",Go,[p[13]||(p[13]=e("label",{class:"input-label"},"Medication",-1)),a(r(Qe),{modelValue:pe.value,"onUpdate:modelValue":[p[0]||(p[0]=S=>pe.value=S),p[1]||(p[1]=S=>Gt(S))],options:I.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:p[2]||(p[2]=S=>qt(S))},{option:d(S=>[e("div",Yo,E(S.option.name),1)]),_:1},8,["modelValue","options"]),je.value?(s(),o("div",jo,E(Pt.value),1)):x("",!0)]),e("div",Ko,[e("div",Qo,[p[14]||(p[14]=e("label",{class:"input-label"},"Route",-1)),a(r(Qe),{modelValue:ae.value,"onUpdate:modelValue":[p[3]||(p[3]=S=>ae.value=S),p[4]||(p[4]=S=>$t(S))],options:Nt.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id"},null,8,["modelValue","options"]),Ge.value?(s(),o("div",Jo,E(It.value),1)):x("",!0)]),e("div",Xo,[p[15]||(p[15]=e("label",{class:"input-label"},"Frequency",-1)),a(r(Qe),{modelValue:oe.value,"onUpdate:modelValue":[p[5]||(p[5]=S=>oe.value=S),p[6]||(p[6]=S=>Ht(S))],options:r(v),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),Ye.value?(s(),o("div",Zo,E(At.value),1)):x("",!0)]),e("div",ei,[p[16]||(p[16]=e("label",{class:"input-label"},"Duration (days)",-1)),a(r(Dn),{modelValue:A.value,"onUpdate:modelValue":p[7]||(p[7]=S=>A.value=S),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:tn},null,8,["modelValue"]),V.value?(s(),o("div",ti,E(l.value),1)):x("",!0)])]),e("div",ni,[ve.value[0].addItemButton?(s(),$(we,{key:0,name:ve.value[0].name,fill:ve.value[0].btnFill,icon:r(wn),"onClicked:btn":ve.value[0].fn,class:"save-button"},null,8,["name","fill","icon","onClicked:btn"])):x("",!0),ve.value[1].addItemButton?(s(),$(we,{key:1,name:ve.value[1].name,fill:ve.value[1].btnFill,icon:r(Sn),"onClicked:btn":ve.value[1].fn,class:"cancel-button"},null,8,["name","fill","icon","onClicked:btn"])):x("",!0)])])),C.value?(s(),$(we,{key:1,name:Y,fill:X,icon:r(_t),"onClicked:btn":Tt,class:"add-new-button"},null,8,["icon"])):x("",!0)])]),e("div",si,[a(r(K),{lines:"none",class:"section-header"},{default:d(()=>[a(r(Ee),{icon:r(xn),class:"section-icon"},null,8,["icon"]),a(r(G),{class:"section-title"},{default:d(()=>p[17]||(p[17]=[O("Non-pharmacological therapy and other notes")])),_:1,__:[17]})]),_:1}),e("div",ai,[a(qn,{class:"intervention-component"}),e("div",oi,[a(r(K),{class:"notes-input-item"},{default:d(()=>[a(r(Ee),{slot:"start",icon:r(n).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),a(r(Cn),{modelValue:M.value,"onUpdate:modelValue":p[8]||(p[8]=S=>M.value=S),onIonInput:Qt,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),a(r(Be),{ref:"accordionGroup",class:"previous-notes"},{default:d(()=>[a(r(ce),{value:"fourth","toggle-icon-slot":"start"},{default:d(()=>[a(r(K),{slot:"header",color:"light",class:"previous-notes-header"},{default:d(()=>[a(r(G),null,{default:d(()=>p[18]||(p[18]=[O("Previous visit notes")])),_:1,__:[18]})]),_:1}),e("div",ii,[e("div",li,[f.index===1?(s(!0),o(T,{key:0},U(ne.value,(S,B)=>(s(),o("div",{key:B,class:"note-entry"},[(s(!0),o(T,null,U(S,(ie,be)=>(s(),o("div",{key:be},[e("div",ri,E(ie.date),1),e("div",ui,E(ie.notes),1)]))),128))]))),128)):x("",!0),a(r(Be),{onIonChange:Zt},{default:d(()=>[a(r(ce),{value:"third","toggle-icon-slot":"start"},{default:d(()=>[a(r(K),{slot:"header",color:"light",class:"show-more-header"},{default:d(()=>[a(r(G),{color:"primary"},{default:d(()=>[O(E(We.value),1)]),_:1})]),_:1}),e("div",ci,[(s(!0),o(T,null,U(se.value,(S,B)=>(s(),o("div",{key:B,class:"note-entry"},[(s(!0),o(T,null,U(rt(S),(ie,be)=>(s(),o("div",{key:be},[e("div",di,E(ie.date),1),e("div",mi,E(ie.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1})}}}),$i=de(vi,[["__scopeId","data-v-e5aea6dd"]]),fi={class:"dash_box"},hi={key:1},gi=te({name:"xxxComponent"}),_i=te({...gi,setup(t){const n=c("No outcome created yet"),v=c(!1),g=c("please select a type");c("Add new outcome"),c(!0);const w=c(!0),C=c(""),m=c(!0),y=c(!1),D=Mn(),u=Q(()=>D.outcomes),h=c(!1),l=c(!1),V=c(!1),P=c(!1),R=c(!1);c(null),c(null);const A=c([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]),L=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:A.value,listUpdatedFN:F,listFilteredFN:()=>{},use_internal_filter:!0,disabled:c(!1)}];function F(b){A.value=b,A.value.forEach(I=>{I.selected==!0&&(C.value=I.name)})}Oe(async()=>{Y()}),_e(()=>C.value,async b=>{h.value==!0?h.value=!1:i()}),_e(()=>u.value.length,async b=>{Y()});function H(){A.value.forEach(b=>{b.selected=!1}),C.value=""}function Y(){u.value.length>0?m.value=!1:u.value.length==0&&y.value==!1&&(m.value=!0)}function X(b){u.value.splice(b,1)}const _=b=>{};async function i(b=!0){const I=C.value;console.log(I),C.value=I;const M=C.value;M==A.value[0].name?V.value=!0:V.value=!1,M==A.value[1].name?(P.value=!0,console.log("show_discharged_options is set to true")):P.value=!1,M==A.value[2].name?(R.value=!0,console.log("show_discharged_options is set to true")):R.value=!1}function k(){l.value=!1,V.value=!1,P.value=!1,R.value=!1,H()}return(b,I)=>{const M=J("ion-row");return s(),$(r(Ae),null,{default:d(()=>[a(M,null,{default:d(()=>[a(r(ut),null,{default:d(()=>[(s(),$(zn,{key:0,"onUpdate:removeItem":X,"onUpdate:editItem":_,displayData:u.value},null,8,["displayData"]))]),_:1})]),_:1}),m.value?(s(),$(M,{key:0},{default:d(()=>[e("span",fi,E(n.value),1)]),_:1})):x("",!0),w.value?(s(),o("div",hi,[a(M,null,{default:d(()=>[a(r(ut),null,{default:d(()=>[a(Fn,{multiSelection:L[0].multi_Selection,show_label:L[0].show_list_label,uniqueId:L[0].unqueId,name_of_list:L[0].name_of_list,choose_place_holder:L[0].placeHolder,"items_-list":L[0].items,use_internal_filter:L[0].use_internal_filter,disabled:L[0].disabled.value,onItemListUpDated:L[0].listUpdatedFN,onItemListFiltered:L[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),e("div",null,[v.value?(s(),$(r(G),{key:0,class:"error-label"},{default:d(()=>[O(E(g.value),1)]),_:1})):x("",!0)])]),_:1})]),_:1})])):x("",!0),V.value?(s(),$(Gn,{key:2,onDataSaved:k,selected_ward_prop:"",admitted_other_props:""})):x("",!0),P.value?(s(),$(Yn,{key:3,onDataSaved:k,selected_referral_data:"",selected_other_referral_data:""})):x("",!0),R.value?(s(),$(jn,{key:4,onDataSaved:k,selected_discharged_prop:"",selected_discharged_data:""})):x("",!0)]),_:1})}}}),Li=de(_i,[["__scopeId","data-v-b6576c18"]]);export{Oi as C,Ni as O,xo as P,to as _,$i as a,Li as b,ss as c,ro as d,Za as e};
