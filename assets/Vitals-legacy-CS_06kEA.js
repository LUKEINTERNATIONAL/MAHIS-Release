System.register(["./vendor-legacy-BZxCa0cX.js","./index-legacy-Ceg9NrRI.js","./BasicFooter-legacy-BpnABrfQ.js","./DemographicBar-legacy-DM7dpiOK.js","./SaveProgressModal-legacy-HXE7uDvr.js","./Stepper-legacy-CEXlCzaY.js","./formatServerData-legacy-zJJN_UYS.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-RFRzQ_eY.js","./lab_order-legacy--50EMpIc.js","./BasicForm-legacy-BK9BNWwv.js","./DateInputField-legacy-CBLnVWny.js","./DashBox-legacy-D50awMvH.js","./group_validation-legacy-C87rQmR3.js","./OPDOutcome-legacy-GrDr39sk.js","./patient_complaints_service-legacy-BxpPHoEe.js","./useExposeFromStandardForm-legacy-MT9V6lbX.js","./NextAppointment-legacy-CDLDNBQS.js","./drug_prescription_service-legacy-DyYVh9zK.js","./drug_service-legacy-BKQvGdq6.js","./ncd_appointment_service-legacy-DA7aiLPU.js","./BasicCard-legacy-BMAM6MJv.js","./LabTestsHistory-legacy-CzrGb8LX.js","./userService-legacy-BqR6vQ1S.js","./Outcome-legacy-B0lrK4YS.js","./TreatmentPlan-legacy-BsN5RuIE.js","./previousDiagnosis-legacy-CrNaB4eA.js","./FeatusModal-legacy-Dh-8KdcD.js","./PastObstreticHistoryStore-legacy-DTSP5-0U.js","./UpcomingFeature-legacy-Cp09v3kP.js"],function(a,t){"use strict";var e,i,s,n,o,l,r,c,d,u,h,g,v,p,m,D,y,S,I,f,w,j,_,b,T,x,E,z,F,V,B,P,k,C,L,M,O,N,W,A,H,U,$,R,G,Z,q,J,Y,X,K,Q,aa;return{setters:[a=>{e=a.d,i=a.ar,s=a.b8,n=a.D,o=a.G,l=a.M,r=a.J,c=a.a_,d=a.ca,u=a.a$,h=a.aZ,g=a.b0,v=a.W,p=a.U,m=a.T,D=a.af,y=a.ba,S=a.S,I=a.a9,f=a.a2,w=a.bG,j=a.E,_=a.y,b=a.f,T=a.z,x=a.e,E=a.m,z=a.l,F=a.k},a=>{V=a.z,B=a.T,P=a.h,k=a.a_,C=a.H,L=a.aZ,M=a.m,O=a.j,N=a.t,W=a.S,A=a.y,H=a.aw,U=a.aJ,$=a.x,R=a.a1,G=a.u,Z=a.i,q=a._},a=>{J=a.B},a=>{Y=a.D},a=>{X=a.S},a=>{K=a.S},a=>{Q=a.d,aa=a.a},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".spinner-overlay[data-v-c26176d1]{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;background-color:rgba(255,255,255,.5);z-index:9999}ion-spinner[data-v-c26176d1]{width:80px;height:80px}.loading-text[data-v-c26176d1]{margin-top:20px;font-size:18px;color:#333}.loading[data-v-c26176d1]{pointer-events:none}\n/*$vite$:1*/",document.head.appendChild(t);const ta=e({name:"Home",components:{IonContent:I,IonHeader:S,IonMenuButton:y,IonPage:D,IonTitle:m,IonToolbar:p,Toolbar:B,ToolbarSearch:V,DemographicBar:Y,IonButton:v,IonCard:g,IonCardContent:h,IonCardHeader:u,IonCardSubtitle:d,IonCardTitle:c,IonAccordion:r,IonAccordionGroup:l,IonItem:o,IonLabel:n,IonModal:s,Stepper:K,BasicFooter:J},data:()=>({isLoading:!1,hasValidationErrors:[],outcomes:"",actionBtn:"",wizardData:[{title:"Vital Signs",class:"common_step",checked:!1,disabled:!1,number:1,last_step:"last_step"}],StepperData:[{title:"Vital Signs",component:"VitalSigns",value:"1"}],isOpen:!1,iconsContent:Z}),computed:{...i(G,["patient"]),...i(R,["vitals"]),"Height Weight Reason"(){return $(this.vitals,"Height Weight Reason","value")}},async created(){},mounted(){this.markWizard()},watch:{vitals:{handler(){this.markWizard()},deep:!0},investigations:{handler(){this.markWizard()},deep:!0},diagnosis:{handler(){this.markWizard()},deep:!0},selectedMedicalDrugsList:{handler(){this.markWizard()}}},setup:()=>({chevronBackOutline:w,checkmark:f}),methods:{markWizard(){this.actionBtn=this.vitals[0].actionBtn;const a=C.sessionDate(),t=U("vitals").some(t=>C.toStandardHisFormat(t.obs_datetime)===C.toStandardHisFormat(a));this.vitals.validationStatus||t?(this.wizardData[0].checked=!0,this.wizardData[0].class="open_step common_step"):this.wizardData[0].checked=!1},async saveVitals(){try{const s=localStorage.getItem("userID")||W.getUserID(),n=new k(this.patient.patientID,s);await n.onFinish(this.vitals);const o=await Q(this.vitals),l=await aa(this.vitals);var a,t,e,i;(l.length>0||o.length>0)&&(null!==(t=(a=null!==(i=(e=this.patient).vitals)&&void 0!==i?i:e.vitals={}).unsaved)&&void 0!==t||(a.unsaved=[]),this.patient.vitals.unsaved.push(...l,...o),await H(this.patient)),A("Vitals saved successfully")}catch(s){throw console.error("Vitals save failed:",s),s}},async moveToNextStageAndRedirect(){const a=localStorage.getItem("locationID"),t=localStorage.getItem("userRoles")||W.getUserRoles();a?(await O.movePatientToNextStage(this.patient.patientID,"VITALS","CONSULTATION",a,this.patient.visitID||this.patient.visit_id),A("Vitals have been saved!"),t.includes("Nurse")?this.$router.push("patientProfile"):this.$router.push("OPDConsultationPlan")):M("Location ID not found")},async getSaveFunction(){this.isLoading=!0;try{if("Finish"!==this.actionBtn){if(await this.validaterowData(),!this.vitals.validationStatus)return void N("Please fill all required fields");await this.saveVitals()}await L(),await this.moveToNextStageAndRedirect()}catch(a){console.error("Error in getSaveFunction: ",a)}finally{this.isLoading=!1}},async saveData(){this.isLoading=!0;try{if("Finish"!=this.actionBtn)if(this.vitals.validationStatus){await this.saveVitals(),L();const a=localStorage.getItem("locationID");if(!a)return void M("Location ID not found");await O.movePatientToNextStage(this.patient.patientID,"VITALS","CONSULTATION",a,this.patient.visitID||this.patient.visit_id),this.$router.push("OPDConsultationPlan")}else await this.validaterowData(),N("Please correct validation errors in form");else this.$router.push("OPDConsultationPlan")}catch(a){console.error("Error in saveData: ",a)}finally{this.isLoading=!1}},async validaterowData(){var a;this.hasValidationErrors=[];const t=localStorage.getItem("userID"),e=new k(this.patient.patientID,t),i=C.getAgeInYears(null===(a=this.patient)||void 0===a||null===(a=a.personInformation)||void 0===a?void 0:a.birthdate);this.vitals.forEach((a,t)=>{var s,n;null!=a&&null!==(s=a.data)&&void 0!==s&&s.rowData&&(null==a||null===(n=a.data)||void 0===n||n.rowData.forEach((a,s)=>{a.colData.some((a,n)=>{if("Respiratory rate"===a.name&&i<=5){const i=e.validator(a);if((null==i?void 0:i.length)>0)return this.hasValidationErrors.push("false"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=i.flat(1/0)[0],!0;this.hasValidationErrors.push("true"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=!1,this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=""}else{const i=e.validator(a);if((null==i?void 0:i.length)>0)return this.hasValidationErrors.push("false"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=i.flat(1/0)[0],!0;this.hasValidationErrors.push("true"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=!1,this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=""}return!1})}))}),this.vitals.validationStatus=!this.hasValidationErrors.includes("false")},openModal(){P(X)}}}),ea={key:0,class:"spinner-overlay"};a("default",q(ta,[["render",function(a,t,e,i,s,n){const o=j("ion-spinner"),l=j("Toolbar"),r=j("DemographicBar"),c=j("Stepper"),d=j("ion-content"),u=j("ion-page");return b(),_(u,null,{default:T(()=>[a.isLoading?(b(),x("div",ea,[z(o,{name:"bubbles"}),t[1]||(t[1]=F("div",{class:"loading-text"},"Please wait...",-1))])):E("",!0),z(l),z(d,{fullscreen:!0},{default:T(()=>[z(r),z(c,{stepperTitle:"Vitals",wizardData:a.wizardData,onUpdateStatus:a.markWizard,onFinishBtn:t[0]||(t[0]=t=>a.saveData()),StepperData:a.StepperData,getSaveFunction:a.getSaveFunction},null,8,["wizardData","onUpdateStatus","StepperData","getSaveFunction"])]),_:1})]),_:1})}],["__scopeId","data-v-c26176d1"]]))}}});
