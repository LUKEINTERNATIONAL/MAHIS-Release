import{r as p,e3 as E,w as D,cg as P,ch as T,e4 as x,e5 as v,e6 as _,e7 as B}from"./vendor-CwRShy1a.js";import{l as M}from"./lodash-Dt8AsbQm.js";import{t as y,s as b,G as m}from"./index-v2y4nc5F.js";var i=(t=>(t.WEB="WEB",t.FILE_SYSTEM="FILE_SYSTEM",t))(i||{});const d={Desktop:{profileName:"Desktop",fileExport:"WEB",scanner:"BARCODE_SCANNER",printer:"WEB",keyboard:"NATIVE_AND_HIS_KEYBOARD"},Mobile:{profileName:"Mobile",fileExport:"FILE_SYSTEM",scanner:"CAMERA_SCANNER",printer:"BLUETOOTH",keyboard:"HIS_KEYBOARD_ONLY"}};function g(){const t=p(d.Desktop),e=p({}),r=localStorage.getItem("active_profile"),o=localStorage.getItem("platformProfiles");return typeof o=="string"?e.value=JSON.parse(o):e.value=d,typeof r=="string"&&"".concat(r).match(/\{.*\}/)?t.value=JSON.parse(r):M.isEmpty(e.value)||(E("mobile")&&"Mobile"in e.value?t.value=e.value.Mobile:E("desktop")&&"Desktop"in e.value&&(t.value=e.value.Desktop)),D(()=>t.value,a=>{localStorage.setItem("active_profile",JSON.stringify(a))}),{activePlatformProfile:t,platformProfiles:e}}function k(t){return t.reduce((e,r)=>e+r.map(o=>'"'.concat(o,'"')).join(",")+"\n","")}function S(t,e,r){let o=null;const a="MaHIS/".concat(t.replaceAll("/","_"));m('Exporting file to "Documents/'.concat(a,'"...')),r==="blob"?o=x({path:a,blob:e,directory:v.Documents,recursive:!0}):o=_.writeFile({path:a,data:e,directory:v.Documents,encoding:B.UTF8,recursive:!0}),o!=null&&o.then(()=>m('File exported to "Documents/'.concat(a,'"!'),3e3)).catch(l=>b(l))}function F(t,e,r="document"){e=h(e);const o=k(t.concat(e)),{activePlatformProfile:a}=g(),l="".concat(r,".csv");if(a.value.fileExport===i.WEB){const n=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.setAttribute("id","csv"),s.href=window.URL.createObjectURL(n),s.setAttribute("download","".concat(r,".csv")),document.body.appendChild(s),s.click(),s.remove()}else a.value.fileExport===i.FILE_SYSTEM?S(l,o,"text"):y("Platform not supported")}function L(t,e,r="document",o=!1,a={}){e=h(e);const l=new P({...a}),n=l.splitTextToSize(r,180),s=n.length<=1?20:n.length*10;l.text(n,14,10);const c={startY:s,head:[t[t.length-1]],body:e};o&&(c.tableWidth="wrap",c.horizontalPageBreak=!0,c.horizontalPageBreakRepeat=0),T(l,c);const{activePlatformProfile:f}=g(),u="".concat(r,".pdf");f.value.fileExport===i.WEB?l.save(u):f.value.fileExport===i.FILE_SYSTEM?S(u,l.output(),"blob"):b("Platform not supported")}function h(t){return t.map(r=>r.map(o=>typeof o=="string"?o.replace(/&lt;/g,"<"):o))}export{i as F,L as a,S as e,F as t,g as u};
