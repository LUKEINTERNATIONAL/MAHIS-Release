System.register(["./vendor-legacy-CJLpW7UD.js","./index-legacy-SH509MCW.js","./relationship_service-legacy-D4Z4C30K.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-KZZvWaHO.js"],function(e,a){"use strict";var l,t,n,i,u,s,o,r,d,c,b,v,g,f,y,m,p,h,V,_,I,D,k,T,w,F,x,C,P,A,B,H,S,E,M,N,R;return{setters:[e=>{l=e.d,t=e.r,n=e.c,i=e.a,u=e.H,s=e.N,o=e.f,r=e.J,d=e.l,c=e.u,b=e.a8,v=e.k,g=e.m,f=e.bh,y=e.a9,m=e.e,p=e.F,h=e.O,V=e.aa,_=e.aR,I=e.aO,D=e.ab,k=e.a1,T=e.b1,w=e.P,F=e.K,x=e.bl,C=e.M,P=e.ae},e=>{A=e.P,B=e.T,H=e.ae,S=e.H,E=e.ad,M=e._},e=>{N=e.R},e=>{R=e.l},null],execute:function(){var a=document.createElement("style");a.textContent=".styled-table[data-v-f0a17b1f]{width:100%;border-collapse:collapse;margin:20px 0;font-size:16px;text-align:left}.styled-table th[data-v-f0a17b1f]{border:1px solid black;padding:10px;background-color:#006400;color:#fff;font-weight:700}.styled-table td[data-v-f0a17b1f]{border:1px solid black;padding:10px}.styled-table tr[data-v-f0a17b1f]:nth-child(2n){background-color:#f9f9f9}.styled-table tr[data-v-f0a17b1f]:hover{background-color:#f1f1f1}.modal-content[data-v-f0a17b1f]{padding:20px;text-align:left}.modal-content h3[data-v-f0a17b1f]{margin-bottom:20px}.modal-content ul[data-v-f0a17b1f]{list-style-type:none;padding:0}.modal-content ul li[data-v-f0a17b1f]{margin-bottom:10px}\n/*$vite$:1*/",document.head.appendChild(a);const O={class:"styled-table"},j={key:0},G=["innerHTML"],L={key:1},$={class:"modal-content"};e("default",M(l({__name:"Mastercard",setup(e){const a=t([]),l=t([]),M=new A,K=t([]),W=t(!1),z=t([]),U=n(()=>R.chunk(l.value,7)),Y=t(!1),q=t(!1);function J(e){return a.value.includes(e)?"Yes":"No"}function Q(e){!function(e){const a=e=>e.map(([e,a])=>`${e} (${a})`).join("/");z.value=[{label:"Outcome",value:e.outcome},{label:"Outcome Date",value:e.outcome_date},{label:"Side effects",value:e.side_effects},{label:"Viral load",value:e.viral_load},{label:"Pills Brought",value:a(e.pills_brought)},{label:"Pills dispensed",value:a(e.pills_dispensed)},{label:"Visit by",value:e.visit_by},{label:"Regimen",value:e.regimen},{label:"Adherence",value:a(e.adherence)},{label:"TB Status",value:e.tb_status},{label:"Height (cm)",value:e.height},{label:"Weight (Kg)",value:e.weight},{label:"BMI",value:e.bmi},{label:"Is pregnant",value:e.isPregnant,visible:M.isFemale()},{label:"Is breastfeeding",value:e.isBreastfeeding,visible:M.isFemale()}]}(e),W.value=!0}function X(){W.value=!1}return i(()=>{l.value=[{label:"ARV Number",value:"...",staticValue:()=>M.getArvNumber(),other:{editable:!0,category:"arv_number"}},{label:"National Patient ID",value:"...",staticValue:()=>M.getNationalID()},{label:"Given Name",value:"...",staticValue:()=>M.getGivenName(),other:{editable:!0,attribute:"given_name",category:"demographics"}},{label:"Family Name",value:"...",staticValue:()=>M.getFamilyName(),other:{editable:!0,attribute:"family_name",category:"demographics"}},{label:"Age",value:"...",staticValue:()=>M.getAge(),other:{editable:!0,attribute:"year_birth_date",category:"demographics"}},{label:"Sex",value:"...",staticValue:()=>M.getGender(),other:{editable:!0,attribute:"gender",category:"demographics"}},{label:"Location",value:"...",staticValue:()=>M.getCurrentVillage(),other:{editable:!0,attribute:"home_region",category:"demographics"}},{label:"Landmark",value:"..."},{label:"Guardian",value:"...",asyncValue:async e=>{const a=await N.getGuardianDetails(M.getID());return R.isEmpty(a)?(e.other.editable=!0,"add"):a.map(e=>` ${e.name} (${e.relationshipType})`).join(" ")},other:{editable:!1,attribute:"",category:"guardian"}},{label:"Init W(KG)",value:"...",asyncValue:()=>M.getInitialWeight()},{label:"Init H(CM)",value:"...",asyncValue:()=>M.getInitialHeight()},{label:"Init BMI",value:"...",asyncValue:()=>M.getInitialBMI()},{label:"init Preg",value:"...",condition:()=>M.isFemale(),asyncValue:()=>M.getInitialObs("Is patient pregnant","value_coded")},{label:"init Breastfeeding",value:"...",condition:()=>M.isFemale(),asyncValue:()=>M.getInitialObs("Is patient breast feeding","value_coded")},{label:"cur Preg",value:"...",condition:()=>M.isFemale(),asyncValue:async()=>await M.isPregnant()?"Yes":"No"},{label:"cur Breastfeeding",value:"...",condition:()=>M.isFemale(),asyncValue:async()=>await M.isBreastfeeding()?"Yes":"No"},{label:"TI",value:"...",asyncValue:()=>H.getFirstValueCoded(M.getID(),"Ever received ART")},{label:"Agrees to follow up",value:"...",asyncValue:()=>H.getFirstValueCoded(M.getID(),"Agrees to followup")},{label:"Reason for starting ART",value:"...",asyncValue:()=>H.getFirstValueCoded(M.getID(),"Reason for ART eligibility")},{label:"HIV test date",value:"...",asyncValue:async()=>{const e=await H.getFirstValueDatetime(M.getID(),"Confirmatory HIV test date");return e?S.toStandardHisDisplayFormat(e):""}},{label:"HIV test place",value:"...",asyncValue:()=>H.getFirstValueText(M.getID(),"Confirmatory HIV test location")},{label:"Date of starting first line ART",value:"...",asyncValue:async()=>{const e=await H.getFirstValueDatetime(M.getID(),"Date ART started");return e?S.toStandardHisDisplayFormat(e):""}},{label:"Pulmonary TB within the last 2 years",value:"...",init:async()=>{a.value=await H.getAllValueCoded(M.getID(),"Who stages criteria present")||[]},staticValue:()=>J("Tuberculosis (PTB or EPTB) within the last 2 years")},{label:"Extra pulmonary TB (EPTB)",value:"...",staticValue:()=>J("Extrapulmonary tuberculosis (EPTB)")},{label:"Pulmonary TB (current)",value:"...",staticValue:()=>J("Pulmonary tuberculosis (current)")},{label:"Kaposis sarcoma",value:"...",staticValue:()=>J("Kaposis sarcoma")}],async function(){for(const e of l.value)"function"==typeof e.init&&await e.init(),"function"==typeof e.condition?e.visible=e.condition():e.visible=!0,"function"==typeof e.asyncValue?e.asyncValue(e).then(a=>e.value=a||""):"function"==typeof e.staticValue&&(e.value=e.staticValue())}(),(Y.value=!1,q.value=!0,A.getPatientVisits(M.getID(),!0).then(e=>{K.value=e.map(e=>[{val:S.toStandardHisDisplayFormat(e),actualDate:e},{val:"..."},{val:"..."},{val:"..."},{val:"..."},{val:"..."},{val:"..."},{btn:{label:"More"}}])}).finally(()=>{Y.value=!0,q.value=!1})).then(()=>async function(){q.value=!0;for(let e=0;e<K.value.length;++e){const a=K.value[e],l=a[0].actualDate,t=M.getID(),n=await E.getCurrentProgramInformation(t,l),i=await E.getMastercardDrugInformation(t,l),u=((null==i?void 0:i.pills_given)||[]).map(e=>`${e.short_name||e.name} <b>(${e.quantity||"?"})</b>`).join("<br/>");if(M.isFemale()){const e=await H.getFirstObs(t,"Is patient pregnant",l);e&&S.toStandardHisDisplayFormat(e.obs_datetime)===l&&e.value_coded;const a=await H.getFirstObs(t,"Is patient breast feeding",l);a&&S.toStandardHisDisplayFormat(a.obs_datetime)===l&&a.value_coded}a[1].val=n.weight,a[2].val=n.regimen,a[3].val=n.viral_load,a[4].val=n.tb_status,a[5].val=n.outcome.match(/Unk/i)?"Unknown":n.outcome,a[6].val=u,a[7].btn={label:"More",onClick:()=>Q(n)}}q.value=!0}()).finally(()=>q.value=!1)}),(e,a)=>{const l=u("ion-modal");return o(),s(c(P),null,{default:r(()=>[d(B),d(c(b),null,{default:r(()=>[a[4]||(a[4]=v("div",{class:"container"},[v("h4",{style:{width:"100%","text-align":"center","font-weight":"700"}},"Mastercard")],-1)),d(c(f),null,{default:r(()=>[d(c(y),null,{default:r(()=>[(o(!0),m(p,null,h(U.value,(e,a)=>(o(),s(c(V),{"size-lg":"3","size-md":"4","size-sm":"12",key:a},{default:r(()=>[d(c(_),null,{default:r(()=>[d(c(I),null,{default:r(()=>[d(c(D),null,{default:r(()=>[(o(!0),m(p,null,h(e,(e,a)=>(o(),s(c(k),{key:a},{default:r(()=>[d(c(T),null,{default:r(()=>[w(F(e.label),1)]),_:2},1024),d(c(T),{style:{"font-weight":"bold"},slot:"end"},{default:r(()=>[w(F(e.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),q.value?(o(),s(c(x),{key:0,type:"indeterminate"})):g("",!0),v("table",O,[a[1]||(a[1]=v("thead",null,[v("tr",null,[v("th",null,"VISIT DATE"),v("th",null,"WEIGHT (Kg)"),v("th",null,"REG"),v("th",null,"VIRAL LOAD"),v("th",null,"TB STATUS"),v("th",null,"OUTCOME"),v("th",null,"PILLS DISPENSED"),v("th",null,"ACTIONS")])],-1)),Y.value?(o(),m("tbody",j,[(o(!0),m(p,null,h(K.value,(e,a)=>(o(),m("tr",{key:a},[(o(!0),m(p,null,h(e,(e,a)=>(o(),m("td",{key:a},[e.val?(o(),m("span",{key:0,innerHTML:e.val},null,8,G)):e.btn&&"function"==typeof(null==e?void 0:e.btn.onClick)?(o(),s(c(C),{key:1,onClick:e.btn.onClick},{default:r(()=>[w(F(e.btn.label),1)]),_:2},1032,["onClick"])):g("",!0)]))),128))]))),128))])):(o(),m("tbody",L,[(o(),m(p,null,h(6,e=>v("tr",{key:e},a[0]||(a[0]=[v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1),v("td",null,"...",-1)]))),64))]))]),d(l,{"is-open":W.value,onIonModalDidDismiss:X},{default:r(()=>[v("div",$,[a[3]||(a[3]=v("h3",null,"Details",-1)),v("ul",null,[(o(!0),m(p,null,h(z.value,e=>(o(),m("li",{key:e.label},[v("strong",null,F(e.label)+":",1),w(" "+F(e.value),1)]))),128))]),d(c(C),{expand:"block",onClick:X},{default:r(()=>a[2]||(a[2]=[w("Close",-1)])),_:1,__:[2]})])]),_:1},8,["is-open"])]),_:1,__:[4]})]),_:1})}}}),[["__scopeId","data-v-f0a17b1f"]]))}}});
