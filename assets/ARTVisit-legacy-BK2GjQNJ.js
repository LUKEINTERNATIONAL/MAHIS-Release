System.register(["./vendor-legacy-DG-htyL-.js","./index-legacy-CgRFaIIG.js","./workflow_service-legacy-CWpdoVz0.js","./lodash-legacy-C-x9g9Na.js"],(function(e,n){"use strict";var l,t,o,a,i,r,u,c,s,d,p,v,g,m,y,b,f,_,h,D,k,I,T,x,w,P,j,F,A,R,C,S,V,N,E,W,z,H,B,L,M,U,$,Q,X,Y,q,G;return{setters:[e=>{l=e.d,t=e.ae,o=e.r,a=e.a,i=e.y,r=e.f,u=e.z,c=e.l,s=e.u,d=e.ez,p=e.k,v=e.ab,g=e.ad,m=e.e,y=e.ac,b=e.F,f=e.L,_=e.G,h=e.I,D=e.eA,k=e.eB,I=e.ev,T=e.B,x=e.cj,w=e.V,P=e.U,j=e.W,F=e.A,A=e.dS,R=e.co,C=e.aQ,S=e.aN,V=e.ed,N=e.cq,E=e.dr,W=e.eC,z=e.m,H=e.eD,B=e.b8,L=e.bR,M=e.a6},e=>{U=e.P,$=e.T,Q=e.S,X=e.m,Y=e.X,q=e._},e=>{G=e.W},null],execute:function(){var J=document.createElement("style");J.textContent="#main[data-v-cc7124d0]{height:calc(100vh - 69px);overflow-y:auto}.placeholder-content[data-v-cc7124d0]{padding:20px}\n/*$vite$:1*/",document.head.appendChild(J);const Z={key:1,style:{"margin-top":"10%"},class:"ion-padding ion-text-center"},K={class:"ion-page",id:"main"},O={key:0,class:"placeholder-content"},ee={style:{margin:"0px auto"},class:"ion-text-center"},ne={key:1},le={key:2,class:"ion-padding ion-text-center",style:{"margin-top":"15%"}};e("default",q(l({__name:"ARTVisit",setup(e){const l=[{label:"Emergency Refill",enableForDebugging:!1,component:L((()=>M((()=>n.import("./EmergencyRefill-legacy-X2Nxv9BH.js")),void 0,n.meta.url)))},{encounterTypeID:5,userProp:"patient type",label:"Patient Type",enableForDebugging:!1,component:L((()=>M((()=>n.import("./ARTPatientType-legacy-B-Z7QINa.js")),void 0,n.meta.url)))},{label:"Filing Number Management",enableForDebugging:!1,component:L((()=>M((()=>n.import("./FilingNumberManagement-legacy-C6ThHt8x.js")),void 0,n.meta.url)))},{encounterTypeID:9,userProp:"HIV first visits",enableForDebugging:!1,label:"HIV Clinic Registration",component:L((()=>M((()=>n.import("./ArtClinicRegistration-legacy-CowhAava.js")),void 0,n.meta.url)))},{encounterTypeID:51,userProp:"HIV reception visits",label:"Reception",enableForDebugging:!1,component:L((()=>M((()=>n.import("./Reception-legacy-B9WlhAEU.js")),void 0,n.meta.url)))},{encounterTypeID:6,otherWorkflowNames:["htn_vitals"],userProp:"vitals",label:"Vitals",enableForDebugging:!1,component:L((()=>M((()=>n.import("./Vitals-legacy-ANLjWuka.js")),void 0,n.meta.url)))},{encounterTypeID:52,userProp:"HIV staging visits",label:"Staging",enableForDebugging:!1,component:L((()=>M((()=>n.import("./Staging-legacy-C_NTogQl.js")),void 0,n.meta.url)))},{encounterTypeID:53,userProp:"HIV clinic consultations",label:"Consultation",enableForDebugging:!1,component:L((()=>M((()=>n.import("./Consultation-legacy-AbPt1_cy.js")),void 0,n.meta.url)))},{encounterTypeID:68,userProp:"ART adherence",label:"ART Adherence",enableForDebugging:!1,component:L((()=>M((()=>n.import("./ARTAdherence-legacy-5nPhqtPZ.js")),void 0,n.meta.url)))},{encounterTypeID:25,userProp:"Prescriptions",label:"Prescription",enableForDebugging:!1,component:L((()=>M((()=>n.import("./Prescription-legacy-DgNaet33.js")),void 0,n.meta.url)))},{encounterTypeID:54,userProp:"Drug Dispensations",label:"Dispense drugs",enableForDebugging:!1,component:L((()=>M((()=>n.import("./ArtDispensation-legacy-BVfKWJqo.js")),void 0,n.meta.url)))},{encounterTypeID:7,userProp:"Manage Appointments",label:"Appointment",enableForDebugging:!1,component:L((()=>M((()=>n.import("./ARTAppointment-legacy-CSbprzeG.js")),void 0,n.meta.url)))}],q=new U,J=t(),te=o(-1),oe=o(null),ae=o([]),ie=o([]),re=o(!1),ue=o(-1),ce=o(""),se=o(""),de=o("");function pe(e){var n;return!!e.enableForDebugging||!!e&&(!re.value&&ue.value===(null==e?void 0:e.encounterTypeID)||(null!==(n=null==e?void 0:e.otherWorkflowNames)&&void 0!==n?n:[]).includes(ce.value))}function ve(){if(0===ae.value.length||te.value===ae.value.length-1)return!1;const e=ae.value[te.value];return e&&pe(e)}async function ge(){de.value="",re.value=!0,se.value="",ce.value="";try{var e;const n=await G.nextTask(q.getID());if(!n)return se.value="No workflows found. You may exit this page or refresh",re.value=!1,void(te.value=-1);ce.value=n.name,ue.value=null!==(e=null==n?void 0:n.encounter_type_id)&&void 0!==e?e:-1;const l=ae.value.findIndex((e=>{var n;return(null==e?void 0:e.encounterTypeID)===ue.value||(null!==(n=e.otherWorkflowNames)&&void 0!==n?n:[]).includes(ce.value)}));if(-1!==l){de.value=n.description;const e=[...ae.value.slice(l),...ae.value.slice(0,l)];ae.value=e,te.value=0}else se.value="Error loading workflow task",te.value=l}catch(n){se.value="An error has occured while loading next task: "+n,console.error(n)}finally{await async function(){const e=await Y.getEncounters(q.getID(),{date:U.getSessionDate()});ie.value=e.map((e=>e.encounter_type))}(),re.value=!1}}function me(){(oe.value&&"function"==typeof oe.value.onSubmit?oe.value.onSubmit():Promise.resolve(!0)).then((e=>e&&ge()))}return a((()=>async function(){const e=await Q.getJson("user_properties",{property:"activities"});try{if(!e.property_value)return void(ae.value=l);const n=e.property_value.split(",").map((e=>e.toLowerCase()));ae.value=l.filter((e=>{var l;return e.enableForDebugging||n.includes(null===(l=e.userProp)||void 0===l?void 0:l.toLowerCase())}))}catch(n){X("Unable to load activities"),console.error(n)}}().then(ge))),(e,n)=>(r(),i(s(B),null,{default:u((()=>[c($),c(s(d),{style:{"margin-top":"70px"},when:"xs",contentId:"main"},{default:u((()=>{var e;return[c(s(v),{contentId:"main"},{default:u((()=>[c(s(g),null,{default:u((()=>[ae.value.length>0?(r(),i(s(y),{key:0},{default:u((()=>[(r(!0),m(b,null,f(ae.value,((e,n)=>(r(),i(s(_),{onClick:e=>function(e){if(e<0||e>=ae.value.length)return;const n=ae.value[e];n&&pe(n)&&(te.value=e)}(n),lines:"none",key:n,disabled:!pe(e),button:""},{default:u((()=>{return[(n=e,ie.value.includes(null!==(l=null==n?void 0:n.encounterTypeID)&&void 0!==l?l:0)?(r(),i(s(h),{key:0,icon:s(D),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):pe(e)?(r(),i(s(h),{key:2,icon:s(I),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):(r(),i(s(h),{key:1,icon:s(k),style:{padding:"10px"},slot:"start"},null,8,["icon"]))),p("b",null,T(e.label),1)];var n,l})),_:2},1032,["onClick","disabled"])))),128))])),_:1})):(r(),m("div",Z,[c(s(h),{style:{"font-size":"2rem"},icon:s(x)},null,8,["icon"]),n[2]||(n[2]=p("h4",null,"You are not assigned to any activities",-1))]))])),_:1}),c(s(w),null,{default:u((()=>[c(s(P),{color:"light"},{default:u((()=>[c(s(j),{onClick:n[0]||(n[0]=e=>s(J).back())},{default:u((()=>[c(s(h),{icon:s(A),slot:"start"},null,8,["icon"]),n[3]||(n[3]=F(" Back to dashboard "))])),_:1,__:[3]})])),_:1})])),_:1})])),_:1}),p("div",K,[re.value?(r(),m("div",O,[p("div",ee,[c(s(R),{name:"bubbles"}),n[4]||(n[4]=p("p",null,[p("h1",null,"Please wait...")],-1))])])):null!==(e=ae.value[te.value])&&void 0!==e&&e.component?(r(),m("div",ne,[c(s(C),null,{default:u((()=>[c(s(S),null,{default:u((()=>{var e;return[(r(),i(V,null,[(r(),i(N(null===(e=ae.value[te.value])||void 0===e?void 0:e.component),{ref_key:"formRef",ref:oe},null,512))],1024))]})),_:1})])),_:1})])):(r(),m("div",le,[c(s(h),{style:{color:"green","font-size":"80px"},icon:s(E)},null,8,["icon"]),p("h2",null,T(se.value),1),c(s(j),{size:"large",fill:"clear",onClick:n[1]||(n[1]=e=>s(J).back())},{default:u((()=>[c(s(h),{slot:"start",icon:s(W)},null,8,["icon"]),n[5]||(n[5]=F(" Exit page "))])),_:1,__:[5]})])),c(s(w),null,{default:u((()=>[c(s(P),{color:"light"},{default:u((()=>[ve()?(r(),i(s(j),{key:0,onClick:me,color:"primary",style:{padding:"4px"},slot:"end"},{default:u((()=>[n[6]||(n[6]=F(" Save and continue ")),c(s(h),{style:{padding:"4px"},icon:s(H),slot:"end"},null,8,["icon"])])),_:1,__:[6]})):z("",!0)])),_:1})])),_:1})])]})),_:1})])),_:1}))}}),[["__scopeId","data-v-cc7124d0"]]))}}}));
