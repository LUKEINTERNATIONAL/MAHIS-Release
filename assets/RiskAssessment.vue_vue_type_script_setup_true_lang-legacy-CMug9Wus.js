System.register(["./vendor-legacy-phTeNEOA.js","./index-legacy-BQzn0Rhs.js"],(function(e,a){"use strict";var t,o,n,l,s,i,r,d,u,c,p,v,m,b,g,f,S,y,k,_,h,w,T,D,F,E;return{setters:[e=>{t=e.d,o=e.aS,n=e.r,l=e.c,s=e.a,i=e.H,r=e.e,d=e.f,u=e.k,c=e.l,p=e.J,v=e.u,m=e.a2,b=e.Q,g=e.F,f=e.P,S=e.K},e=>{y=e.u,k=e.aA,_=e.t,h=e.ae,w=e.aS,T=e.G,D=e.aM,F=e.H,E=e.k}],execute:function(){const a={class:"card-container"},N={class:"custom-card"},A={class:"ion-padding",slot:"content"},R={class:"table-responsive"};e("_",t({__name:"RiskAssessment",setup(e,{expose:t}){const V=y(),{patient:x}=o(V),H=n([]),M=n(E),P=["Substance","Answer","Date","Action"],B={responsive:!0,select:!1,layout:{topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},O=l((()=>[{componentType:"Heading",name:"Substance use / Consumption",position:"center"},{componentType:"radioButtonField",header:"Smoking",name:"Smoking history",grid:{s:"3"},obsValueType:"value_coded",options:[{label:"Smoking",value:"Smoking"},{label:"Never",value:"Never"},{label:"Stopped",value:"Stopped"}]},{grid:{s:"2"}},{componentType:"radioButtonField",header:"Drinking alcohol",name:"Does the patient drink alcohol?",grid:{s:"3"},obsValueType:"value_coded",options:[{label:"Drinking",value:"Drinking"},{label:"Never",value:"Never"},{label:"Stopped",value:"Stopped"}]}])),j=n(null);return s((async()=>{await(async()=>{const e=await h.getObsByEncounterId(w.ASSESSMENT);if(!e||0===e.length)return[];const a=await Promise.all(e.flatMap((e=>e.obs.map((async e=>[e.concept_name||"",await D.getConceptName(e.value_coded)||"",F.toStandardHisFormat(e.obs_datetime),`<button class="btn btn-outline-danger btn-sm delete-btn" data-id='${JSON.stringify(e)}'>\n            ${M.value.delete2}</button>`])))));H.value=a})()})),t({validateForm:()=>{var e;return null===(e=j.value)||void 0===e?void 0:e.validateForm()},onSubmit:async()=>{if(!j.value)return void console.error("Form reference is not available");const e=j.value.getFormValues();e["Smoking history"]&&e["Does the patient drink alcohol?"]?(await h.buildAddObsToEncounterPatient(e,w.ASSESSMENT),j.value.resetForm(),T("Risk assessment saved successful")):_("Risk assessment not saved")}}),(e,t)=>{const o=i("ion-label"),n=i("DataTable"),l=i("ion-accordion"),s=i("ion-accordion-group"),y=i("ion-row");return d(),r(g,null,[u("div",a,[u("div",N,[c(k,{formData:O.value,ref_key:"formRef",ref:j},null,8,["formData"])])]),c(y,null,{default:p((()=>[c(s,{ref:"accordionGroup",class:"previousView"},{default:p((()=>[c(l,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:p((()=>[c(v(m),{slot:"header",color:"light"},{default:p((()=>[c(o,{class:"previousLabel"},{default:p((()=>t[0]||(t[0]=[b("Previous Visits")]))),_:1,__:[0]})])),_:1}),u("div",A,[u("div",R,[c(n,{ref:"dataTableRef",options:B,data:H.value,class:"display nowrap modern-table",width:"100%"},{default:p((()=>[u("thead",null,[u("tr",null,[(d(),r(g,null,f(P,(e=>u("th",{key:e},S(e),1))),64))])])])),_:1},8,["data"])])])])),_:1})])),_:1},512)])),_:1})],64)}}}))}}}));
