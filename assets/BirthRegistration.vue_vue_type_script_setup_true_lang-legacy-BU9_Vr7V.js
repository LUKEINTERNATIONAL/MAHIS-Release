!function(){function e(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}System.register(["./index-legacy-D84VBdSl.js","./vendor-legacy-CFX0KWSj.js","./StandardForm.vue_vue_type_script_setup_true_lang-legacy-BvagC7tb.js","./vaccines_service-legacy-Cm6C-cKn.js","./relations_service-legacy-DDqmfpee.js"],function(t,a){"use strict";var i,n,o,l,r,d,s,u,c,m,v,p,h,_,g,f,y,b,I,D,w,F,T,S,k,R,x,N,B,P,C,A,L,V,M,H,E,O,G,Y,j,q,W,U,z,J,$,Q,X,Z,K,ee,te;return{setters:[e=>{i=e.i,n=e.D,o=e._,l=e.aj,r=e.H,d=e.S,s=e.z,u=e.aU,c=e.m,m=e.E,v=e.f,p=e.P,h=e.u,_=e.Q,g=e.l,f=e.a0,y=e.j,b=e.a3,I=e.b,D=e.L,w=e.G},e=>{F=e.d,T=e.W,S=e.I,k=e.G,R=e.ac,x=e.ab,N=e.c$,B=e.aa,P=e.dq,C=e.D,A=e.X,L=e.E,V=e.e,M=e.f,H=e.m,E=e.l,O=e.k,G=e.z,Y=e.A,j=e.F,q=e.c,W=e.r,U=e.y,z=e.u,J=e.B,$=e.L,Q=e.O,X=e.bU,Z=e.w},e=>{K=e._},e=>{ee=e.g},e=>{te=e.R}],execute:function(){var a=document.createElement("style");a.textContent=".large-card[data-v-ffb46cdd]{padding:5%;border-radius:15px;border:1px solid #ccc;height:82vh;background-color:#fff;overflow-y:auto;-webkit-box-shadow:0px -2px 19px -2px rgba(196,190,196,1);-moz-box-shadow:0px -2px 19px -2px rgba(196,190,196,1);box-shadow:0 -2px 19px -2px #c4bec4}.header[data-v-ffb46cdd]{display:flex;gap:20px;padding:10px 20px}.position_content[data-v-ffb46cdd]{max-width:100vw}.accordion-expanded[data-v-ffb46cdd]{background-color:#ded}button[aria-expanded=false][data-v-ffb46cdd]{background:rgba(var(--ion-color-rose-rgb),.25)}ion-accordion.accordion-expanding ion-item[slot=header][data-v-ffb46cdd],ion-accordion.accordion-expanded ion-item[slot=header][data-v-ffb46cdd]{--background: #ddeedd}\n/*$vite$:1*/",document.head.appendChild(a),t({e:oe,u:ye});const ae=F({components:{IonLabel:C,IonAvatar:P,IonRow:B,IonImg:N,IonCol:x,IonList:R,IonItem:k,IonIcon:S,IonButton:T,DynamicButton:n},data:()=>({selectedResult:{},iconsContent:i,isAnyAccordionOpen:!0,isLoading:!1}),methods:{dismiss(e){A.dismiss(e)}}}),ie={key:0,class:"spinner-overlay"};const ne=t("C",o(ae,[["render",function(e,t,a,i,n,o){const l=L("ion-spinner"),r=L("ion-title"),d=L("ion-icon"),s=L("ion-header"),u=L("center"),c=L("ion-content"),m=L("DynamicButton"),v=L("ion-col"),p=L("ion-row"),h=L("ion-footer");return M(),V(j,null,[e.isLoading?(M(),V("div",ie,[E(l,{name:"bubbles"}),t[3]||(t[3]=O("div",{class:"loading-text"},"Please wait...",-1))])):H("",!0),E(s,{style:{display:"flex","justify-content":"space-between"}},{default:G(()=>[E(r,{class:"modalTitle"},{default:G(()=>t[4]||(t[4]=[Y("Printer")])),_:1,__:[4]}),E(d,{onClick:t[0]||(t[0]=t=>e.dismiss("dismiss")),style:{"padding-top":"10px","padding-right":"10px"},icon:e.iconsContent.cancel},null,8,["icon"])]),_:1}),E(c,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:G(()=>[E(u,null,{default:G(()=>t[5]||(t[5]=[O("h3",{class:"ion-padding"},"Do you want to print a barcode?",-1)])),_:1,__:[5]})]),_:1}),E(h,null,{default:G(()=>[E(p,null,{default:G(()=>[E(v,null,{default:G(()=>[E(m,{color:"danger",onClick:t[1]||(t[1]=t=>e.dismiss("dismiss")),name:"No",fill:"solid",style:{float:"right","margin-right":"2%",width:"100px"}}),E(m,{onClick:t[2]||(t[2]=t=>e.dismiss("Yes")),name:"Yes",fill:"solid",style:{float:"right","margin-right":"2%",width:"100px"}})]),_:1})]),_:1})]),_:1})],64)}]]));function oe(){const e=W(null),t=q(()=>{var t;return(null===(t=e.value)||void 0===t?void 0:t.formValues)||{}}),a=()=>{var t;return null===(t=e.value)||void 0===t?void 0:t.validateForm()},i=()=>{var t;return null===(t=e.value)||void 0===t?void 0:t.getFormValues()},n=()=>{var t;return null===(t=e.value)||void 0===t?void 0:t.resetForm()};return{formRef:e,currentFormValues:t,validateForm:a,getFormValues:i,resetForm:n,exposeFormMethods:()=>({currentFormValues:t,validateForm:a,getFormValues:i,resetForm:n})}}t("c",F({__name:"PersonalInformation",setup(e,{expose:t}){const{personalInformation:a}=(()=>{function e(e,t){const a=new Date(e);return a.setFullYear(a.getFullYear()-t),a.toISOString().split("T")[0]}return{personalInformation:q(()=>[{componentType:"Heading",name:"Personal Information",position:"center"},{componentType:"inputField",header:"National ID",name:"nationalID",placeholder:"__-__-__-__",icon:i.nationalID,validation:e=>l.isMWNationalID(e)},{componentType:"inputField",header:"First name",name:"firstname",icon:i.fullName,validation:e=>l.isName(e)},{componentType:"inputField",header:"Middle name",name:"middleName",icon:i.fullName,validation:e=>l.isNamesEmpty(e)},{componentType:"inputField",header:"Last name",name:"lastname",icon:i.fullName,validation:e=>l.isName(e)},{componentType:"radioButtonField",header:"Gender",name:"gender",type:"inline",validation:e=>l.required(e),options:[{label:"Male",value:"M"},{label:"Female",value:"F"}]},{componentType:"dateInputField",header:"Date of birth",name:"birthdate",icon:i.calenderPrimary,minDate:e(r.sessionDate(),110),validation:e=>l.required(e),condition:e=>!e.Estimate,disabled:e=>e.Estimate},{componentType:"inputField",header:"Estimated age",name:"estimation",icon:i.time,unit:"yrs",validation:e=>l.isEstimationDate(e),condition:e=>e.Estimate},{componentType:"checkboxField",name:"Estimate",type:"single",label:"Estimate age"},{componentType:"phoneInputField",name:"Phone Number",header:"Phone Number",validation:e=>l.isMWPhoneNumber(e.phoneNumber)}])}})(),{formRef:n,exposeFormMethods:o}=oe();return t(o()),(e,t)=>(M(),U(K,{formData:z(a),ref_key:"formRef",ref:n},null,8,["formData"]))}}));const le=F({components:{IonLabel:C,IonAvatar:P,IonRow:B,IonImg:N,IonCol:x,IonList:R,IonItem:k,IonIcon:S,IonButton:T},data:()=>({selectedResult:{},iconsContent:i,isAnyAccordionOpen:!0,isLoading:!1}),methods:{updateAccordionState(e){const t=this.$refs.accordionGroup;this.isAnyAccordionOpen=void 0!==t.value},dismiss(e){A.dismiss(e)},async init(){this.setData(this.deduplicationData[0]||{})},async onSelect(){A.dismiss(this.selectedResult)},setData(e){this.selectedResult=e},dateFormat:e=>r.toStandardHisDisplayFormat(e),probabilityToPercentage:e=>(100*e).toFixed(2)+"%"},props:{deduplicationData:{default:[]},to_be_registered:{default:[]}},mounted(){this.init()},activated(){this.init()}}),re={key:0,class:"spinner-overlay"},de={class:"header position_content"},se={style:{"font-size":"1.2em","font-weight":"700"}},ue={class:"due_date"},ce={class:"ion-padding",slot:"content"},me={style:{display:"flex","justify-content":"end",gap:"10px"}};const ve=o(le,[["render",function(e,t,a,i,n,o){const l=L("ion-spinner"),r=L("ion-icon"),d=L("ion-header"),s=L("ion-label"),u=L("ion-item"),c=L("ion-col"),m=L("ion-row"),v=L("ion-accordion"),p=L("ion-accordion-group"),h=L("ion-content"),_=L("ion-button"),g=L("ion-footer");return M(),V(j,null,[e.isLoading?(M(),V("div",re,[E(l,{name:"bubbles"}),t[3]||(t[3]=O("div",{class:"loading-text"},"Please wait...",-1))])):H("",!0),E(d,null,{default:G(()=>[O("div",de,[O("div",{style:{display:"flex","align-items":"center"},onClick:t[0]||(t[0]=t=>e.dismiss("back"))},[E(r,{slot:"separator",size:"large",icon:e.iconsContent.arrowLeft},null,8,["icon"])]),O("div",se,"Matches found: ("+J(e.deduplicationData.length)+")",1)])]),_:1}),E(h,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:G(()=>[E(p,{ref:"accordionGroup",class:"previousView",value:"0",onIonChange:e.updateAccordionState},{default:G(()=>[(M(!0),V(j,null,$(e.deduplicationData,(a,i)=>(M(),U(v,{style:{"margin-bottom":"15px"},value:i,"toggle-icon-slot":"start",class:"custom_card",button:"",key:i,detail:!0,color:a.value===e.selectedResult.value?"light":"",onClick:t=>e.setData(a)},{default:G(()=>[E(u,{slot:"header"},{default:G(()=>[E(s,{class:"previousLabel"},{default:G(()=>{var e,t;return[Y(J(null==a||null===(e=a.person)||void 0===e?void 0:e.given_name)+" "+J(null==a||null===(t=a.person)||void 0===t?void 0:t.family_name),1)]}),_:2},1024),O("div",ue,[t[4]||(t[4]=Y(" Score: ")),O("b",null,J(e.probabilityToPercentage(null==a?void 0:a.score)||"-"),1)])]),_:2},1024),O("div",ce,[E(m,null,{default:G(()=>[E(c,null,{default:G(()=>t[5]||(t[5]=[O("b",null,"To be Registered",-1)])),_:1,__:[5]}),E(c,null,{default:G(()=>t[6]||(t[6]=[O("b",null,"Already Registered",-1)])),_:1,__:[6]})]),_:1}),E(m,null,{default:G(()=>[E(c,null,{default:G(()=>[E(m,null,{default:G(()=>{var a,i;return[t[7]||(t[7]=Y(" Name: ")),O("b",null,J(null===(a=e.to_be_registered)||void 0===a?void 0:a.given_name)+" "+J(null===(i=e.to_be_registered)||void 0===i?void 0:i.family_name),1)]}),_:1,__:[7]}),E(m,null,{default:G(()=>{var a;return[t[8]||(t[8]=Y("Gender: ")),O("b",null,J(null===(a=e.to_be_registered)||void 0===a?void 0:a.gender),1)]}),_:1,__:[8]}),E(m,null,{default:G(()=>{var a;return[t[9]||(t[9]=Y("Birthdate: ")),O("b",null,J(null===(a=e.to_be_registered)||void 0===a?void 0:a.birthdate),1)]}),_:1,__:[9]}),E(m,null,{default:G(()=>{var a;return[t[10]||(t[10]=Y("Home District: ")),O("b",null,J(null===(a=e.to_be_registered)||void 0===a?void 0:a.home_district),1)]}),_:1,__:[10]}),E(m,null,{default:G(()=>{var a;return[t[11]||(t[11]=Y("Home TA: ")),O("b",null,J(null===(a=e.to_be_registered)||void 0===a?void 0:a.home_traditional_authority),1)]}),_:1,__:[11]})]),_:1}),E(c,null,{default:G(()=>[E(m,null,{default:G(()=>{var e,i;return[t[12]||(t[12]=Y(" Name: ")),O("b",null,J(null==a||null===(e=a.person)||void 0===e?void 0:e.given_name)+" "+J(null==a||null===(i=a.person)||void 0===i?void 0:i.family_name),1)]}),_:2,__:[12]},1024),E(m,null,{default:G(()=>{var e;return[t[13]||(t[13]=Y("Gender: ")),O("b",null,J(null==a||null===(e=a.person)||void 0===e?void 0:e.gender),1)]}),_:2,__:[13]},1024),E(m,null,{default:G(()=>{var i;return[t[14]||(t[14]=Y("Birthdate: ")),O("b",null,J(e.dateFormat(null==a||null===(i=a.person)||void 0===i?void 0:i.birthdate)),1)]}),_:2,__:[14]},1024),E(m,null,{default:G(()=>{var e;return[t[15]||(t[15]=Y("Home District: ")),O("b",null,J(null==a||null===(e=a.person)||void 0===e?void 0:e.home_district),1)]}),_:2,__:[15]},1024),E(m,null,{default:G(()=>{var e;return[t[16]||(t[16]=Y("Home TA: ")),O("b",null,J(null==a||null===(e=a.person)||void 0===e?void 0:e.home_traditional_authority),1)]}),_:2,__:[16]},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1032,["value","color","onClick"]))),128))]),_:1},8,["onIonChange"])]),_:1}),E(g,{collapse:"fade",class:"ion-no-border"},{default:G(()=>[O("div",me,[E(_,{fill:"solid",color:"secondary",onClick:t[1]||(t[1]=t=>e.dismiss("dismiss"))},{default:G(()=>t[17]||(t[17]=[Y(" Not Duplicate ")])),_:1,__:[17]}),E(_,{onClick:t[2]||(t[2]=t=>e.onSelect()),fill:"solid",disabled:!e.isAnyAccordionOpen},{default:G(()=>t[18]||(t[18]=[Y("Select ")])),_:1,__:[18]},8,["disabled"])])]),_:1})],64)}],["__scopeId","data-v-ffb46cdd"]]),pe=c();class he{async getDDEIds(){const e=d.getUseIndexDBStatus(),t=d.getModsStatus(),a=d.getAPIStatus();if(e)return await s("dde");if(t){const e=await u();return(null==e?void 0:e.npid)||[]}if(a)try{const e=await d.getJson("/dde/patients/sync_npids",{count:1,program_id:d.getProgramID()});return(null==e?void 0:e.npids)||[]}catch(i){return[]}return[]}async updateDDEIds(e){e=e.slice(1),pe.postData("OVERRIDE_OBJECT_STORE",{storeName:"dde",data:e})}async possibleDuplicates(e){try{const a=new m,i=await a.checkPotentialDuplicates(e);if(i.length>0){const n=await v(ve,{class:"fullScreenModal"},!0,{to_be_registered:e,deduplicationData:i});if("dismiss"!=n&&"back"!=n){var t;const e=await a.importPatient(null==n||null===(t=n.person)||void 0===t?void 0:t.id),i=await p.findByID(e.patient_id);return await h().setPatientRecord(i),!0}return"back"==n}return!1}catch(a){return!1}}}class _e{getRegion(e){return{1:"Central Region",2:"Northern Region",3:"Southern Region",4:"Foreign"}[e]}hasValidData(e,t=[]){return!(!e||"object"!=typeof e)&&(0===t.length?Object.values(e).some(e=>null!=e&&""!==e):t.every(t=>null!==e[t]&&void 0!==e[t]&&""!==e[t]))}async buildObservation(e,t){if(!t)return null;const a="object"==typeof t&&t.name?t.name:t;return await _.buildValueText(e,a)}buildGuardianInfo(e){const t={};return t.given_name=(null==e?void 0:e.guardianFirstname)||"",t.middle_name=(null==e?void 0:e.guardianMiddleName)||"",t.family_name=(null==e?void 0:e.guardianLastname)||"",t.cell_phone_number=(null==e?void 0:e.guardianPhoneNumber.phoneNumber)||"",t.national_id=(null==e?void 0:e.guardianNationalID)||"",t.gender="",t.birthdate="",t.birthdate_estimated="false",t.home_region="",t.home_district="",t.home_traditional_authority="",t.home_village="",t.current_region="",t.current_district="",t.current_traditional_authority="",t.current_village="",t.landmark="",{saved:[],unsaved:[t]}}async buildVitals(e){return null!=e&&e.Weight?{saved:[],unsaved:[await this.buildObservation("Weight",e.Weight)]}:null}async buildARTPatientType(e,t){const a=[];let i=[];return e&&a.push(await _.buildValueText("Art clinic location",e)),t&&a.push(await _.buildValueCoded("Type of patient",t)),0===a.length?[]:(i=[{encounter_type:"REGISTRATION",status:"unsaved",obs:a}],i)}async buildBirthRegistrationObservations(e){if(!this.hasValidData(e))return null;const t=(await Promise.all([this.buildObservation("How many doses of Tdv did the mother receive?",e["How many doses of Tdv did the mother receive?"]),this.buildObservation("Protected at birth",e["Protected at birth"]),this.buildObservation("HIV status",e["HIV status"])])).filter(e=>null!==e);return t.length>0?t:null}async buildPatientRecord(e,t){var a,i,n,o,l,r,s,u,c,m,v,p,h;const{personalInformation:_,currentLocation:g,homeLocation:f,birthRegistration:y,guardianInformation:b,socialHistory:I,patientType:D}=e;return{patientID:t,ID:t,NcdID:"",program_id:d.getProgramID(),location_id:d.getUserLocationId(),provider_id:d.getUserID(),encounter_datetime:(new Date).toISOString(),personInformation:{given_name:(null==_?void 0:_.firstname)||"",middle_name:(null==_?void 0:_.middleName)||"",family_name:(null==_?void 0:_.lastname)||"",gender:(null==_?void 0:_.gender)||"",birthdate:(null==_?void 0:_.birthdate)||(new ge).calculateDoB(null==_?void 0:_.estimation,"Years")||"",birthdate_estimated:null!=_&&_.estimation?"true":"false",home_region:this.getRegion(null==f||null===(a=f.home_district)||void 0===a?void 0:a.region_id)||"",home_district:(null==f||null===(i=f.home_district)||void 0===i?void 0:i.name)||"",home_traditional_authority:(null==f||null===(n=f.home_traditional_authority)||void 0===n?void 0:n.name)||"",home_village:(null==f||null===(o=f.home_village)||void 0===o?void 0:o.name)||"",current_region:this.getRegion(null==g||null===(l=g.current_district)||void 0===l?void 0:l.region_id)||"",current_district:(null==g||null===(r=g.current_district)||void 0===r?void 0:r.name)||"",current_traditional_authority:(null==g||null===(s=g.current_traditional_authority)||void 0===s?void 0:s.name)||"",current_village:(null==g||null===(u=g.current_village)||void 0===u?void 0:u.name)||"",country:(null==e?void 0:e.country.country.name)||"",landmark:(null==g||null===(c=g.closestLandmark)||void 0===c?void 0:c.name)||"",cell_phone_number:(null===(m=_["Phone Number"])||void 0===m?void 0:m.phoneNumber)||"",occupation:(null==I?void 0:I.occupation)||"",marital_status:(null==I?void 0:I.maritalStatus)||"",religion:(null==I||null===(v=I.religion)||void 0===v?void 0:v.name)||"",education_level:(null==I?void 0:I.highestLevelOfEducation)||""},guardianInformation:this.buildGuardianInfo(b),birthRegistration:await this.buildBirthRegistrationObservations(y),otherPersonInformation:{nationalID:(null==_?void 0:_.nationalID)||"",birthID:y["Serial Number"]||"",relationshipID:(null==b||null===(p=b.relationship)||void 0===p?void 0:p.id)||""},vitals:await this.buildVitals(y),vaccineSchedule:await ee(null==_?void 0:_.gender,null==_?void 0:_.birthdate),vaccineAdministration:{orders:[],obs:[],voided:[]},observations:await this.buildARTPatientType(null==D||null===(h=D.facility)||void 0===h?void 0:h.name,null==D?void 0:D.patient_type),appointments:{saved:[],unsaved:[]},saveStatusPersonInformation:"pending",saveStatusGuardianInformation:"pending",saveStatusBirthRegistration:"pending",saveStatusVitals:"pending",date_created:"",creator:"",sync_status:"unsynced"}}}class ge extends d{constructor(){super(),e(this,"patientRecordBuilder",void 0),this.patientRecordBuilder=new _e}async saveRegistrationData(e){var t;const a=await(new he).getDDEIds();if(a.length<=0&&g("DDE IDs are not available."),a.length<=0&&!d.getAPIStatus())return!1;const i=await this.patientRecordBuilder.buildPatientRecord(e,null===(t=a[0])||void 0===t?void 0:t.npid);return!(!d.getAPIStatus()||d.getModsStatus()||!(await(new he).possibleDuplicates(i.personInformation)))||!!(await f(i))&&(y("Registration successful"),d.getUseIndexDBStatus()&&await(new he).updateDDEIds(a),await this.printBarcode(),!0)}checkIfChild(e){if(!(null!=e&&e.estimation||null!=e&&e.birthdate))return{moreThanThirteenYears:!0,underNineMonths:!1,underFiveYears:!1};let t="";return t=e.estimation?this.calculateDoB(e.estimation,"Years")||"":e.birthdate,{moreThanThirteenYears:r.getAgeInYears(t)>13,underNineMonths:r.ageInMonths(t)<9,underFiveYears:r.getAgeInYears(t)<5}}async printBarcode(){"dismiss"!==await v(ne,{class:"small-confirm-modal "})&&(new b).printData("barcode")}calculateDoB(e,t){try{let a=Q(d.getSessionDate());if("Years"===t&&e<0)a=a.add(Math.abs(e),"years");else switch(t){case"Days":a=a.subtract(e,"days");break;case"Months":a=a.subtract(e,"months");break;case"Years":a=a.subtract(e,"years");break;default:return null}return r.toStandardHisDisplayFormat(a.format("YYYY-MM-DD"))||""}catch(a){return console.error("Error calculating date:",a),null}}}t("R",ge);const fe=(e,t)=>{const a=q(()=>(new ge).checkIfChild(e.value).moreThanThirteenYears),{getRelationships:n}=function(){const e=W([]),t=W([]),a=W([]),i=I();X();const n=q(()=>i.apiStatus),o=e=>{var i;const n=["Brother","Father","Son","Grandfather","Grandson","Boyfriend","Stepfather","Stepson"],o=["Sister","Mother","Daughter","Grandmother","Granddaughter","Girlfriend","Stepmother","Stepdaughter"],l=["Spouse/Partner","Aunt/Uncle","Niece/Nephew","Doctor","Other","Patient","TB Contact Person","TB Patient","treatment suporter"];(null===(i=t.value)||void 0===i?void 0:i.length)>0&&(a.value=t.value.filter(t=>"M"===e?n.includes(t.a_is_to_b)||l.includes(t.a_is_to_b):"F"===e&&(o.includes(t.a_is_to_b)||l.includes(t.a_is_to_b))))};return{relationships:e,relationshipsData:t,filteredRelationships:a,apiStatus:n,getRelationships:async l=>{var r;if(l)return t.value=await s("relationship"),n.value&&t.value.length!==(null===(r=i.offlineRelationshipStatus)||void 0===r?void 0:r.total)&&(t.value=await te.getRelations()),o(l),e.value=e.value=a.value.map(e=>[{name:e.b_is_to_a,id:e.relationship_type_id,trackByID:e.relationship_type_id+e.b_is_to_a}]).reduce((e,t)=>e.concat(t),[]),e.value},filterRelationships:o}}(),o=W();Z(e,async e=>{e&&(o.value=await n(e.gender))});return{guardianInformation:q(()=>[{componentType:"Heading",name:"Guardian Information",position:"center"},{componentType:"inputField",header:"Guardian National ID",name:"guardianNationalID",placeholder:"__-__-__-__",icon:i.nationalID,validation:e=>l.isMWNationalID(e)},{componentType:"inputField",header:"First name",name:"guardianFirstname",icon:i.fullName,validation:e=>a.value?l.isNameEmpty(e):l.isName(e)},{componentType:"inputField",header:"Middle name",name:"guardianMiddleName",icon:i.fullName,validation:e=>l.isNameEmpty(e)},{componentType:"inputField",header:"Last name",name:"guardianLastname",icon:i.fullName,validation:e=>a.value?l.isNameEmpty(e):l.isName(e)},{componentType:"phoneInputField",name:"guardianPhoneNumber",header:"Phone Number",validation:e=>l.isMWPhoneNumber(e.phoneNumber)},{componentType:"multiSelectInputField",header:"Relationship to patient",name:"relationship",trackBy:"trackByID",icon:i.search,validation:e=>a.value?null:l.required(null==e?void 0:e.name),options:()=>o.value,disabled:()=>!o.value}])}};t("b",F({__name:"GuardianInformation",props:{personalInformationFormValues:{}},setup(e,{expose:t}){const{formRef:a,exposeFormMethods:i}=oe(),n=e,o=q(()=>n.personalInformationFormValues),{guardianInformation:l}=fe(o);return t(i()),(e,t)=>(M(),U(K,{formData:z(l),ref_key:"formRef",ref:a},null,8,["formData"]))}}));function ye(){const e=W([]),t=W([]),a=W([]),i=W([]),n=W([]),o=W([]),l=W(null),r=W(null),d=W(!1),u=I(),c=q(()=>u.apiStatus);Z(l,async e=>{if(e)try{t.value=await v(e)}catch(a){t.value=[]}else t.value=[]}),Z(r,async e=>{if(e)try{a.value=await m(e)}catch(t){a.value=[]}else a.value=[]});const m=async e=>{try{const t=await s("villages",{whereClause:{traditional_authority_id:e}});return t.length>0?t:c.value?await D.getVillages(e):[]}catch(t){return console.error("Error getting villages:",t),[]}},v=async e=>{try{const t=await s("TAs",{whereClause:{district_id:e}});return t.length>0?t:c.value?await D.getTraditionalAuthorities(e):[]}catch(t){return console.error("Error getting TAs:",t),[]}};return{districtList:e,countriesList:i,locations:o,isLoading:d,selectedDistrictId:l,TAs:t,villages:a,selectedTraditionalAuthorityId:r,facilityList:n,apiStatus:c,getVillages:m,getTAs:v,getDistricts:async()=>{d.value=!0;try{var t;if(e.value=await s("districts"),c.value&&e.value.length!==(null===(t=u.offlineDistrictStatus)||void 0===t?void 0:t.total))for(let t of[1,2,3]){const a=await D.getDistricts(t);e.value.push(...a)}return e.value}catch(a){console.error("Error loading location data:",a)}finally{d.value=!1}},getCountries:async()=>{d.value=!0;try{var e;return i.value=await s("countries"),c.value&&i.value.length!==(null===(e=u.offlineCountriesStatus)||void 0===e?void 0:e.total)&&(i.value=await D.getDistricts(4)),i.value}catch(t){console.error("Error loading location data:",t)}finally{d.value=!1}},getFacilities:async()=>{n.value=await D.getAllFacilities()}}}const be=(e,t)=>(null==e||!e.same_as_current)&&!(null!=t&&t.length),Ie=(e,t)=>a=>{setTimeout(()=>{a?((e,t)=>{if(null==e||!e.value||null==t||!t.value)return;const{current_district:a,current_traditional_authority:i,current_village:n}=e.value;t.value.setFormValue("home_district",a),t.value.setFormValue("home_traditional_authority",i),t.value.setFormValue("home_village",n)})(e,t):(e=>{null!=e&&e.value&&(e.value.setFormValue("home_district",[]),e.value.setFormValue("home_traditional_authority",[]),e.value.setFormValue("home_village",[]))})(t)},0)};t("_",F({__name:"HomeLocation",props:{currentLocationFormValues:{}},setup(e,{expose:t}){const a=e,{formRef:n,exposeFormMethods:o}=oe(),r=q(()=>a.currentLocationFormValues),{homeLocation:d}=((e,t)=>{const{getDistricts:a,districtList:n,selectedTraditionalAuthorityId:o,villages:r,selectedDistrictId:d,TAs:s}=ye();a();const u=q(()=>[{componentType:"Heading",name:"Home Location",position:"center"},{componentType:"checkboxField",type:"single",name:"same_as_current",label:"Same as current",onChange:Ie(e,t)},{componentType:"multiSelectInputField",header:"Home district",name:"home_district",trackBy:"district_id",icon:i.search,validation:l.required,options:n.value,onChange:e=>((e,t,a)=>{t.value=(null==e?void 0:e.district_id)||null,null!=a&&a.value&&(a.value.setFormValue("home_traditional_authority",[]),a.value.setFormValue("home_village",[]))})(e,d,t)},{componentType:"multiSelectInputField",header:"Home traditional authority",name:"home_traditional_authority",trackBy:"traditional_authority_id",validation:l.required,icon:i.search,options:s.value,disabled:e=>be(e,s.value),onChange:e=>((e,t,a)=>{var i;t.value=(null==e?void 0:e.traditional_authority_id)||null,null==a||null===(i=a.value)||void 0===i||i.setFormValue("home_village",[])})(e,o,t),openDirection:"auto"},{componentType:"multiSelectInputField",header:"Home village",name:"home_village",trackBy:"village_id",icon:i.search,validation:l.required,options:r.value,disabled:e=>be(e,r.value),openDirection:"auto"}]);return{homeLocation:u}})(r,n);return t(o()),(e,t)=>(M(),U(K,{formData:z(d),ref_key:"formRef",ref:n},null,8,["formData"]))}})),t("a",F({__name:"CurrentLocation",setup(e,{expose:t}){const{currentLocation:a}=(()=>{const e=W(!1),{getDistricts:t,districtList:a,selectedTraditionalAuthorityId:n,villages:o,selectedDistrictId:r,TAs:d}=ye();return t(),{currentLocation:q(()=>[{componentType:"Heading",name:"Current Location",position:"center"},{componentType:"multiSelectInputField",header:"Current district",name:"current_district",trackBy:"district_id",validation:e=>l.required(e),icon:i.search,options:a.value,onChange:(e,t)=>{r.value=(null==e?void 0:e.district_id)||null}},{componentType:"multiSelectInputField",header:"Current traditional authority",name:"current_traditional_authority",trackBy:"traditional_authority_id",validation:e=>l.required(e),icon:i.search,options:d.value,disabled:e=>{var t;return!(null!=d&&null!==(t=d.value)&&void 0!==t&&t.length)},onChange:(e,t)=>{n.value=(null==e?void 0:e.traditional_authority_id)||null}},{componentType:"multiSelectInputField",header:"Current village",name:"current_village",trackBy:"village_id",icon:i.search,validation:e=>l.required(e),options:o.value,disabled:e=>{var t;return!(null!=o&&null!==(t=o.value)&&void 0!==t&&t.length)}},{componentType:"multiSelectInputField",header:"Closest landmark/Plot number",name:"closestLandmark",trackBy:"id",icon:i.search,options:[{id:1,name:"Church"},{id:2,name:"Mosque"},{id:3,name:"Primary School"},{id:4,name:"Borehole"},{id:5,name:"Secondary School"},{id:6,name:"College"},{id:7,name:"Market"},{id:8,name:"Football Ground"},{id:9,name:"Other"}]}]),TAs:d,isLoadingTAs:e,selectedDistrictId:r}})(),{formRef:n,exposeFormMethods:o}=oe();return t(o()),(e,t)=>(M(),U(K,{formData:z(a),ref_key:"formRef",ref:n},null,8,["formData"]))}})),t("d",F({__name:"SocialHistory",setup(e,{expose:t}){const{socialHistory:a}=(()=>{const e=W();return w.isProp("military_site=true").then(t=>{e.value=t}),{socialHistory:q(()=>[{componentType:"Heading",name:"Social History",position:"center"},{componentType:"multiSelectInputField",header:"Religion",name:"religion",icon:i.search,trackBy:"id",options:[{id:1,name:"Christianity"},{id:2,name:"Islam"},{id:3,name:"Judaism"},{id:4,name:"Hinduism"},{id:5,name:"Buddhism"},{id:6,name:"Sikhism"},{id:7,name:"Jainism"},{id:8,name:"Bahá'í Faith"},{id:9,name:"Zoroastrianism"},{id:10,name:"Confucianism"},{id:11,name:"Taoism"},{id:12,name:"Shinto"},{id:13,name:"Baha'i Faith"},{id:14,name:"Juche"},{id:15,name:"Rastafari"}]},{componentType:"radioButtonField",header:"Occupation status",name:"occupation",type:"inline",validation:l.required,condition:()=>1==d.getProgramID()&&e.value,options:[{label:"Military",value:"Military"},{label:"Civilian",value:"Civilian"}]},{componentType:"radioButtonField",header:"Occupation status",name:"occupation",type:"inline",condition:t=>!e,options:[{label:"Employed",value:"employed"},{label:"Student",value:"Student"},{label:"Unemployed",value:"unemployed"},{label:"Other",value:"Other"}]},{componentType:"radioButtonField",header:"Marital status",name:"maritalStatus",type:"inline",options:[{label:"Single",value:"single"},{label:"Married",value:"married"},{label:"Widow",value:"widow"},{label:"Widower",value:"widower"},{label:"Divorced",value:"divorced"}]},{componentType:"radioButtonField",header:"Highest level of education",name:"highestLevelOfEducation",type:"inline",options:[{label:"No education",value:"No education"},{label:"Primary school",value:"primary school"},{label:"Secondary school",value:"secondary school"},{label:"Tertiary education",value:"tertiary education"}]}])}})(),{formRef:n,exposeFormMethods:o}=oe();return t(o()),(e,t)=>(M(),U(K,{formData:z(a),ref_key:"formRef",ref:n},null,8,["formData"]))}})),t("f",F({__name:"BirthRegistration",setup(e,{expose:t}){const{formRef:a,exposeFormMethods:n}=oe(),{birthRegistration:o}=(e=>({birthRegistration:q(()=>[{componentType:"Heading",name:"Birth Registration",position:"center"},{componentType:"inputField",header:"Birth certificate number",name:"Serial Number",icon:i.nationalID,placeholder:"__-__-__-__"},{componentType:"inputField",header:"Birth Weight/First weight (kg)",name:"Weight",icon:i.weight,validation:e=>l.validateWeight(e)},{componentType:"multiSelectInputField",header:"How many doses of Tdv did the mother receive?",name:"How many doses of Tdv did the mother receive?",icon:i.search,options:[{concept_id:11997,name:"0-2 doses, less than two weeks before delivery"},{concept_id:11998,name:"2-5 doses more than two weeks of delivery"},{concept_id:1067,name:"Unknown"}],trackBy:"concept_id",validation:e=>l.required(e),onChange:t=>{const a=null==t?void 0:t.name;"Unknown"==a?e.value.setFormValue("Protected at birth",{concept_id:1067,name:"Don't know"}):"0-2 doses, less than two weeks before delivery"==a?e.value.setFormValue("Protected at birth",{concept_id:1066,name:"No"}):"2-5 doses more than two weeks of delivery"==a&&e.value.setFormValue("Protected at birth",{concept_id:1065,name:"Yes"})}},{componentType:"multiSelectInputField",header:"Protected at birth (PAB)",name:"Protected at birth",icon:i.search,trackBy:"concept_id",validation:e=>l.required(e),disabled:e=>!e["How many doses of Tdv did the mother receive?"]},{componentType:"multiSelectInputField",header:"HIV status of the Child's Mother",name:"HIV status",icon:i.search,options:[{id:703,name:"Positive"},{id:664,name:"Negative"},{id:1067,name:"Unknown"}],trackBy:"id",validation:e=>l.required(e)}])}))(a);return t(n()),(e,t)=>(M(),U(K,{formData:z(o),ref_key:"formRef",ref:a},null,8,["formData"]))}}))}}})}();
