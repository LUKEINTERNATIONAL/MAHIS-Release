import{D as bt,d as V,ab as B,b0 as ot,G as L,E as O,ac as rt,ad as U,a2 as A,I as W,a7 as R,R as $,ag as yt,bd as Dt,aR as Ct,H as r,e as y,m as I,f as _,k as i,O as N,Q as g,K as S,l as s,J as a,a as wt,r as x,u as j,_ as lt,b8 as kt,N as Q,F as M,eX as It,a3 as dt,a4 as ct,P as J,i as tt,v as et,a8 as K,a9 as ut,bg as St,af as Vt,ae as Bt,aN as $t,ck as Nt,aO as Ht,aM as Pt,aP as Tt,aa as ht,cb as Mt,M as Ot,L as At,b7 as Wt,a6 as Rt}from"./vendor-CwRShy1a.js";import{k as w,i as mt,B as pt,aK as vt,M as D,u as z,H as C,_ as H,j as b,t as X,$ as Ft,S as T,l as P,G as gt,n as Et,bf as st,K as k,bx as nt,cb as xt}from"./index-v2y4nc5F.js";import{l as F}from"./lodash-Dt8AsbQm.js";import{B as _t}from"./BasicForm-Cjk72wLs.js";import{c as Z}from"./customDatePicker-BKU2KofT.js";import{_ as Lt}from"./VitalsMixin.vue_vue_type_script_lang-8p8nXLxX.js";import{a as ft}from"./formatServerData-6L3IDssm.js";import{i as Y,s as Ut,j as zt}from"./vaccines_service-CLx-Th9C.js";import{I as jt}from"./barcode-qrcode-reader-Bb9ke-1k.js";import{S as qt}from"./stock_service-D46RjpGz.js";const at=[{data:{rowData:[{colData:[{inputHeader:"Systolic Pressure",unit:"mmHg",icon:w.systolicPressure,value:"",name:"Systolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsSystolic"},{inputHeader:"Diastolic pressure",unit:"mmHg",icon:w.diastolicPressure,value:"",name:"Diastolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsDiastolic"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"bp",index:""}],previousView:{name:"vitals"}},{data:{rowData:[{colData:[{inputHeader:"Temperature",unit:"C",icon:w.temprature,value:"",name:"Temperature",eventType:"input",validationFunctionName:"vitalsTemperature",valueType:"number"},{inputHeader:"Pulse rate",unit:"BMP",icon:w.pulse,value:"",name:"Pulse",eventType:"input",validationFunctionName:"vitalsPulseRate",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"temp",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"pulse",index:""}]},{data:{rowData:[{colData:[{inputHeader:"Respiratory rate",unit:"BMP",icon:w.respiratory,value:"",name:"Respiratory rate",eventType:"input",validationFunctionName:"vitalsRespiratoryRate",valueType:"number"},{inputHeader:"Oxygen saturation",unit:"%",icon:w.oxgenStaturation,value:"",name:"SAO2",eventType:"input",validationFunctionName:"vitalsOxygenSaturation",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"respiratory",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"oxygen",index:""}]}],q=bt("immunizationVitalsStore",{state:()=>({vitals:[...at]}),actions:{setVitals(t){this.vitals=t},getInitialVitals(){return[...F.cloneDeep(at)]}},persist:!0}),Gt=V({mixins:[Lt],components:{IonContent:R,IonHeader:W,IonItem:A,IonList:U,IonMenu:rt,IonTitle:O,IonToolbar:L,IonInput:ot,BasicInputField:pt,BasicForm:_t,PreviousVitals:mt,customDatePicker:Z},data(){return{iconsContent:w,vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1,pulseRate:!1},showPD:!1,todays_date:C.sessionDate(),formOpen:!0}},computed:{...B(z,["patient"]),...B(q,["vitals"])},async serverPrefetch(){this.updateVitalsStores()},async mounted(){this.cleanVitalForm(),this.vitalsData=this.vitals,await this.setTodayVitals(),await this.validateRowData()},watch:{vitals:{handler(){this.vitalsData=this.vitals},deep:!0},$route:{handler(){this.cleanVitalForm(),this.vitalsData=this.vitals}}},setup(){return{checkmark:Ct,pulseOutline:Dt}},methods:{cleanVitalForm(){const t=q();t.setVitals(t.getInitialVitals())},navigationMenu(t){yt.close(),this.$router.push(t)},updateVitalsStores(){q().setVitals(this.vitals)},async validateRowData(){const t=D(this.vitals,"Height (cm)","value"),e=D(this.vitals,"Weight","value"),n=D(this.vitals,"Systolic","value"),l=D(this.vitals,"Diastolic","value"),c=D(this.vitals,"Temperature","value"),v=D(this.vitals,"Pulse","value"),o=D(this.vitals,"Respiratory rate","value"),d=D(this.vitals,"SAO2","value");await this.setBMI(t,e),await this.updateBP(n,l);const u=this.getPulseRateStatus(v);await this.updateRate("pulse",v," BMP",u,4);const f=this.getTemperatureStatus(c);this.updateRate("temp",c,"Â°C",f,4);const h=this.getRespiratoryRateStatus(o);this.updateRate("respiratory",o,"BMP",h,6);const m=this.getOxygenSaturationStatus(d);this.updateRate("oxygen",d,"%",m,6)},showCPD(){this.showPD=!0},closeForm(){this.formOpen=!1},async saveVitals(){var e;$.dismiss();const t=await ft(this.vitals);if(t.length>0){let n=(e=this.patient)==null?void 0:e.vitals;n.unsaved=[...n.unsaved,...t],await vt(this.patient)}}}}),Qt={key:0,class:"modal_wrapper"},Jt={class:"OtherVitalsHeading"},Kt={class:"TodaysDate"},Xt={class:""},Zt={class:"btnContent"},Yt={class:"saveBtn"};function te(t,e,n,l,c,v){const o=r("basic-form"),d=r("customDatePicker"),u=r("ion-icon"),f=r("ion-button");return t.formOpen?(_(),y("div",Qt,[i("div",Jt,[e[3]||(e[3]=i("div",{class:"OtherVitalsTitle"},"OTHER VITALS",-1)),i("div",Kt,[e[1]||(e[1]=g("Todays Date: ")),e[2]||(e[2]=i("span",null,null,-1)),g(" "+S(t.todays_date),1)])]),i("div",Xt,[s(o,{contentData:t.vitals,"onUpdate:inputValue":e[0]||(e[0]=h=>t.validateRowData())},null,8,["contentData"])]),t.showPD?(_(),N(d,{key:0})):I("",!0),i("div",Zt,[i("div",Yt,[i("div",null,[s(f,{class:"btnText",fill:"solid",onClick:t.saveVitals},{default:a(()=>[e[4]||(e[4]=g(" Done today ")),s(u,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=i("div",null,null,-1)),i("div",null,[s(f,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:a(()=>[e[5]||(e[5]=g(" Done earlier ")),s(u,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])])])):I("",!0)}const Je=H(Gt,[["render",te],["__scopeId","data-v-d7374316"]]),ee={class:"flex flex-col items-center justify-center mt-6"},se={class:"phone mt-6"},ne={class:"content"},ae={class:"overlay"},ie={style:{"margin-top":"20px"}},oe=V({__name:"QRCodeReader",emits:["scanresult"],setup(t,{emit:e}){wt(async()=>{d()});const n=x(void 0),l=x(!1);function c(m){n.value=m,n.value!=null&&(b().setTempScannedBatchNumber(n.value),h(n.value))}function v(m){l.value=m}const o=x(null);function d(){var m;(m=o.value)==null||m.onCanPlay()}function u(){$.dismiss()}const f=e;function h(m){f("scanresult",m),u()}return(m,p)=>(_(),y(M,null,[i("div",ee,[i("div",se,[s(j(lt),null,{default:a(()=>[g(S(n.value),1)]),_:1}),i("div",ne,[i("div",ae,[s(j(jt),{ref_key:"refCamera",ref:o,capture:"shoot","show-on-stream":"",onOnloading:v,onResult:c},null,512),p[0]||(p[0]=kt('<div class="focus-frame" data-v-e0d52d85></div><div class="dark-overlay top" data-v-e0d52d85></div><div class="dark-overlay bottom" data-v-e0d52d85></div><div class="dark-overlay left" data-v-e0d52d85></div><div class="dark-overlay right" data-v-e0d52d85></div>',5))])])])]),i("div",ie,[s(j(Q),{onClick:u,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"99%"}},{default:a(()=>p[1]||(p[1]=[g(" Cancel ")])),_:1,__:[1]})])],64))}}),re=H(oe,[["__scopeId","data-v-e0d52d85"]]),le=V({name:"MyComponent",components:{IonAlert:It},data(){return{isOpen:!1,alertButtons:[{text:"Close",role:"cancel",cssClass:"alert-danger-button"}],messageContent:"No available batches/lot numbers"}},methods:{setOpen(t){this.isOpen=t},handleDismiss(){this.setOpen(!1),this.$emit("alertClosed"),this.dismiss()},dismiss(){$.dismiss()}},mounted(){this.setOpen(!0)}});function de(t,e,n,l,c,v){const o=r("ion-alert");return _(),N(o,{"is-open":t.isOpen,header:"Please update stock","sub-header":"",message:t.messageContent,buttons:t.alertButtons,"css-class":"my-custom-alert",onDidDismiss:t.handleDismiss},null,8,["is-open","message","buttons","onDidDismiss"])}const G=H(le,[["render",de],["__scopeId","data-v-cf655518"]]),ce=V({components:{IonRadioGroup:ct,IonRadio:dt,IonItem:A,IonList:U},props:{action:{type:Function,required:!0},retro:{type:Boolean,required:!0}},async mounted(){this.loadCurrentSelectedDrug()},watch:{retro:{handler(){this.checkToShow()},deep:!0}},data(){return{lotNumbers:[],selectedOption:{}}},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},checkIfSelected(){return F.has(this.selectedOption,"lotNumber")||this.checkDrugNameInt()==!0?!0:(X("Select a batch number!"),!1)},performAction(){this.checkIfSelected()==!0&&this.$emit("actionTriggered",this.selectedOption)},async loadCurrentSelectedDrug(){try{const e=b().getCurrentSelectedDrug();await this.formBatchList(e.drug.drug_id)}catch(t){}},async formBatchList(t){try{const n=b().getLotNumberData();n.length==0&&this.$emit("emptyList",""),n.forEach(l=>{const c={id:l.id,lotNumber:l.batch_number};this.lotNumbers.push(c)}),this.checkToShow()}catch(e){}},addUnkownLotNumberOption(){const e=b().getCurrentSelectedDrug();this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"})},checkToShow(){this.$props.retro==!0&&this.addUnkownLotNumberOption(),this.checkDrugNameInt()},checkDrugNameInt(){const e=b().getCurrentSelectedDrug();return Y(e.drug)==!0?(this.lotNumbers=[],this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"}),!0):!1}}});function ue(t,e,n,l,c,v){const o=r("ion-radio"),d=r("ion-item"),u=r("ion-radio-group"),f=r("ion-list"),h=r("ion-card"),m=r("ion-row");return _(),N(m,null,{default:a(()=>[s(h,{class:"shadowless-card",style:{width:"100%",padding:"0"}},{default:a(()=>[s(f,null,{default:a(()=>[s(u,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=p=>t.handleChange(p)),value:"start"},{default:a(()=>[(_(!0),y(M,null,J(t.lotNumbers,p=>(_(),N(d,{key:p.id},{default:a(()=>[s(o,{value:p},{default:a(()=>[g(S(p.lotNumber),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1},8,["compareWith"])]),_:1})]),_:1})]),_:1})}const he=H(ce,[["render",ue],["__scopeId","data-v-039b66ba"]]),me=V({components:{IonContent:R,IonHeader:W,IonItem:A,IonList:U,IonMenu:rt,IonTitle:O,IonToolbar:L,IonInput:ot,BasicInputField:pt,PreviousVitals:mt,customDatePicker:Z,lotNumberList:he,alert:G},data(){return{iconsContent:w,showPD:!1,showDateBtns:!0,vaccineDate:"",batchNumber:"",drugName:"",currentDrug:"",is_batch_number_valid:!1,batch_number_error_message:"Enter a valid batch number",full_name:"",sessionDate:C.toStandardHisDisplayFormat(T.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{P(re,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},selected_date_:"",is_a_vaccine:!0}},computed:{...B(b,["tempScannedBatchNumber"]),...B(z,["patient"])},setup(){const t=x(null);return{childComponentRef:t,triggerChildAction:()=>{t.value&&t.value.performAction()}}},async mounted(){this.loadCurrentSelectedDrug(),this.displayUserNames();const t=b();this.showPD=t.isVaccinePassed(),this.showDateBtns=!this.showPD},props:{customSchedule:{type:[],default:[]}},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}}},methods:{loadCurrentSelectedDrug(){const t=b();this.currentDrug=t.getCurrentSelectedDrug(),this.drugName=this.currentDrug.drug.drug_name,this.batchNumber=this.currentDrug.drug.vaccine_batch_number?this.currentDrug.drug.vaccine_batch_number:"",Y(this.currentDrug.drug)==!0&&(this.is_a_vaccine=!1,this.batchNumber="unknown")},showCPD(){this.showPD=!0,this.showDateBtns=!1},dismiss(){$.dismiss()},updateDate(t){this.vaccineDate=C.toStandardHisFormat(t)},saveBatchWithTodayDate(){let t=T.getSessionDate();this.saveDta(t)},saveBatch(){let t;F.isEmpty(this.vaccineDate)==!0?t=T.getSessionDate():t=this.vaccineDate,this.saveDta(t)},updateBatchNumber(t){var n;const e=t.target.value;this.batchNumber=e||((n=this.tempScannedBatchNumber)==null?void 0:n.text)||""},async ActionTriggered(t){const e={batch_number:t.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrug.drug.drug_id,drug_:this.currentDrug},n=b();n.setAdministeredVaccine(e),await Ut(this.patient),n.setTempScannedBatchNumber(null),this.dismiss()},saveDta(t){this.selected_date_=t,this.triggerChildAction()},isAlphaNumeric(t){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(t)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(t){this.batchNumber=t},displayUserNames(){const e=Ft().getUser(),n=e.person.names[0].given_name,l=e.person.names[0].family_name;this.full_name=n+" "+l},childAction(){},ShowAlert(){}}}),pe={class:"modal_wrapper"},ve={class:"lbl-ct"},ge={class:"client_admi"},_e={class:"client_admin_sub_x"},fe={class:"btnContent"},be={key:0,class:"saveBtn"},ye={key:1,class:"saveBtn"};function De(t,e,n,l,c,v){const o=r("ion-col"),d=r("ion-label"),u=r("ion-row"),f=r("lotNumberList"),h=r("customDatePicker"),m=r("ion-icon"),p=r("ion-button");return _(),y("div",pe,[s(u,{style:{"margin-top":"10px"}},{default:a(()=>[s(o,{style:{"margin-left":"-3px"}},{default:a(()=>e[0]||(e[0]=[i("div",{class:"om"},"Administer Vaccine",-1)])),_:1,__:[0]}),s(o,{size:"6",style:{"text-align":"right"}},{default:a(()=>[s(d,{class:"lbl-tl",style:{"font-size":"13"}},{default:a(()=>[e[1]||(e[1]=g(" Todays Date: ")),i("span",ve,S(t.sessionDate),1)]),_:1,__:[1]})]),_:1})]),_:1}),s(u,null,{default:a(()=>[s(d,{style:{"font-weight":"600px","font-size":"20px",margin:"10px","margin-left":"0px"}},{default:a(()=>[g(S(t.drugName),1)]),_:1})]),_:1}),tt(s(u,null,{default:a(()=>[s(d,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:a(()=>e[2]||(e[2]=[g("Select Batch number"),i("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[2]})]),_:1},512),[[et,t.is_a_vaccine]]),tt(i("div",null,[s(f,{action:t.childAction,retro:t.showPD,ref:"childComponentRef",onActionTriggered:t.ActionTriggered,onEmptyList:t.ShowAlert},null,8,["action","retro","onActionTriggered","onEmptyList"])],512),[[et,t.is_a_vaccine]]),i("div",ge,[e[3]||(e[3]=i("span",{class:"client_admi_sub"},"Vaccination done by: ",-1)),i("span",_e,S(t.full_name),1)]),t.showPD?(_(),N(h,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):I("",!0),i("div",fe,[t.showDateBtns?(_(),y("div",be,[i("div",null,[s(p,{onClick:t.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:a(()=>[e[4]||(e[4]=g(" Done today ")),s(m,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=i("div",{style:{"margin-bottom":"20px"}},null,-1)),i("div",null,[s(p,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:a(()=>[e[5]||(e[5]=g(" Done earlier ")),s(m,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])):I("",!0),t.showDateBtns?I("",!0):(_(),y("div",ye,[s(u,{"justify-content-between":""},{default:a(()=>[s(o,{size:"auto"},{default:a(()=>[s(p,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:a(()=>e[7]||(e[7]=[g(" Cancel ")])),_:1,__:[7]},8,["onClick"])]),_:1}),s(o,{size:"auto",class:"ion-text-end",style:{"margin-left":"auto"}},{default:a(()=>[s(p,{onClick:t.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:a(()=>e[8]||(e[8]=[g(" Save ")])),_:1,__:[8]},8,["onClick"])]),_:1})]),_:1})]))])])}const it=H(me,[["render",De],["__scopeId","data-v-58aa351e"]]),Ce=V({components:{IonRow:K,IonItem:A,IonList:U,IonRadio:dt,IonRadioGroup:ct},data(){return{reasons:[{id:1,name:"Mistake/ Wrong Entry",type:"Mistake/ Wrong Entry"},{id:2,name:"Duplicate",type:"Duplicate"},{id:3,name:"System Error",type:"System Error"}],selectedOption:{}}},computed:{...B(z,["patient"])},async mounted(){},props:{},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},dismiss(){try{$.dismiss()}catch(t){}},checkIfSelected(){return F.has(this.selectedOption,"name")==!0?!0:(X("Select a reason!"),!1)},async voidVaccine1(){if(this.checkIfSelected()==!0)try{const t=b(),e=t.getVaccineToBeVoided();await zt(this.patient,e,this.selectedOption.name),gt("Vaccine was successfully voided!"),t.setVaccineReload(!t.getVaccineReload()),$.dismiss({voided:!0})}catch(t){}}}}),we={class:"saveBtn"};function ke(t,e,n,l,c,v){const o=r("ion-row"),d=r("ion-radio"),u=r("ion-item"),f=r("ion-radio-group"),h=r("ion-list"),m=r("ion-button"),p=r("ion-col");return _(),y(M,null,[s(o,{class:"centered-content"},{default:a(()=>e[1]||(e[1]=[i("div",{class:"text-container"},[i("div",null,"Do you want to void this vaccine?"),i("div",null,"Please specify reason for voiding this administered vaccine?")],-1)])),_:1,__:[1]}),s(o,null,{default:a(()=>[s(h,{style:{width:"100%"}},{default:a(()=>[s(f,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=E=>t.handleChange(E)),value:"start"},{default:a(()=>[(_(!0),y(M,null,J(t.reasons,E=>(_(),N(u,null,{default:a(()=>[s(d,{value:E},{default:a(()=>[g(S(E.name),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1},8,["compareWith"])]),_:1})]),_:1}),i("div",we,[s(o,{class:"ion-justify-content-between"},{default:a(()=>[s(p,{size:"auto"},{default:a(()=>[s(m,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:a(()=>e[2]||(e[2]=[g(" Cancel ")])),_:1,__:[2]},8,["onClick"])]),_:1}),s(p,{size:"auto"},{default:a(()=>[s(m,{onClick:t.voidVaccine1,class:"btnText",fill:"solid",style:{width:"130px"}},{default:a(()=>e[3]||(e[3]=[g(" Void ")])),_:1,__:[3]},8,["onClick"])]),_:1})]),_:1})])],64)}const Ie=H(Ce,[["render",ke],["__scopeId","data-v-ea212a62"]]),Se=V({name:"Home",components:{IonContent:R,IonHeader:W,IonMenuButton:Mt,IonPage:ht,IonTitle:O,IonToolbar:L,IonButton:Q,IonCard:Tt,IonCardContent:Pt,IonCardHeader:Ht,IonCardSubtitle:Nt,IonCardTitle:$t,IonAccordion:Bt,IonAccordionGroup:Vt,IonItem:A,IonLabel:lt,IonModal:St,IonCol:ut,IonRow:K,alert:G},data(){return{iconsContent:w,fowardData:{}}},computed:{},created(){},mounted(){},props:{vaccines:{type:{},default:{}},milestone_status:{type:String,default:0}},watch:{},setup(){let t=!1;return{isModalOpening:t,cleanupModal:()=>{t=!1;const n=document.querySelector(".pr_o");n&&n.remove()}}},methods:{covertToDate(t){return C.toStandardHisDisplayFormat(t)},getColorForVaccine(t){if(t.status=="administered")return"success";if(t.status!="administered")return this.milestone_status=="upcoming"?"medium":this.milestone_status=="current"?"success":"danger"},getInjectSignForVaccine(t){if(t.status=="administered")return this.iconsContent.greenInjection;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.fadedGreenIjection},getCheckBoxForVaccine(t){if(t.status=="administered")return this.iconsContent.improvedGreenTick;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.whiteCheckbox},async openAdministerVaccineModal(t){const e=document.querySelector(".pr_o");if(this.isModalOpening||e){console.log("Modal already open or opening, current state:",{isModalOpening:this.isModalOpening,modalExists:!!e});return}try{this.isModalOpening=!0;const n=b();n.setCurrentSelectedDrug(t);const l=new qt,c=await Et("stock",{selector:{drug_id:t.drug_id}});n.setLotNumberData(c),this.checkIfAdminstredAndAskToVoid()||(c.length===0?Y(t)?P(it,{class:"otherVitalsModal pr_o"}):P(G,{class:"otherVitalsModal pr_o"}):P(it,{class:"otherVitalsModal pr_o"}))}catch(n){throw console.error("Error opening modal:",n),n}finally{this.isModalOpening=!1,console.log("Modal open process completed")}},disableVaccine(t){if(t.status!=null&&t.status=="administered")return!1;if(t.can_administer!=null&&t.can_administer==!1)return!0;if(t.can_administer!=null&&t.can_administer==!0)return!1},checkVaccineName(t){return t.replace(/Pentavalent/g,"Penta")},checkIfAdminstredAndAskToVoid(){const t=b(),e=t.getCurrentSelectedDrug();return e.drug.status=="administered"?(t.setVaccineToBeVoided(e),P(Ie,{class:"otherVitalsModal"},!1),!0):!1}}}),Ve={class:"vaccinesList"},Be={class:"button-content"},$e={style:{"margin-top":"20px"}};function Ne(t,e,n,l,c,v){const o=r("ion-icon"),d=r("ion-button"),u=r("ion-col"),f=r("ion-row");return _(),y("div",Ve,[s(f,null,{default:a(()=>[s(u,null,{default:a(()=>[(_(!0),y(M,null,J(t.vaccines,h=>(_(),N(d,{disabled:t.disableVaccine(h),class:"administerVac",key:h,onClick:m=>t.openAdministerVaccineModal(h),fill:"solid",color:t.getColorForVaccine(h),style:{background:"#ddeedd","border-radius":"8px",color:"#636363"}},{default:a(()=>[s(o,{slot:"start",icon:t.getInjectSignForVaccine(h)},null,8,["icon"]),i("div",Be,[i("div",$e,S(t.checkVaccineName(h.drug_name)),1),i("div",null,S(t.covertToDate(h.date_administered)),1)]),s(o,{slot:"end",icon:t.getCheckBoxForVaccine(h)},null,8,["icon"])]),_:2},1032,["disabled","onClick","color"]))),128))]),_:1})]),_:1})])}const He=H(Se,[["render",Ne],["__scopeId","data-v-245b1fb0"]]),Ke=V({name:"Home",components:{IonIcon:At,IonButton:Q,customVaccine:He,IonHeader:W,IonTitle:O,IonFooter:Ot,IonCol:ut,IonRow:K,IonContent:R},data(){return{iconsContent:w,vaccineHistory:[]}},setup(){return{closeCircleOutline:Rt,checkmarkOutline:Wt}},computed:{...B(b,["vaccineReload","vaccineSchedule"])},methods:{vaccinesGivenCount(t){const e=[];return t.antigens.forEach(n=>{n.status=="administered"&&e.push(n)}),e.length},dismiss(){$.dismiss()}}}),Pe=V({name:"Home",components:{IonContent:R,IonHeader:W,IonPage:ht,IonTitle:O,IonToolbar:L,BasicForm:_t,customDatePicker:Z},data(){return{popoverOpen:!1,iconContent:w,event:null,BMI:"",showPD:!1,vitals_date:C.toStandardHisFormat(C.sessionDate()),formOpen:!0,checkUnderSixWeeks:!1,showDateBtns:!0}},computed:{...B(z,["patient"]),...B(xt,["vitalsWeightHeight"])},watch:{patient:{async handler(){this.checkAge()}}},mounted(){this.checkAge()},setup(){},methods:{checkAge(){var t,e,n,l;F.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=C.dateDiffInDays(C.sessionDate(),(l=(n=this.patient)==null?void 0:n.personInformation)==null?void 0:l.birthdate)<42,this.controlHeight())},nav(t){this.$router.push(t)},formatBirthdate(){var t,e;return C.getBirthdateAge((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},controlHeight(){this.checkUnderSixWeeks?(k(this.vitalsWeightHeight,"Height (cm)","inputHeader","Height"),k(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!0)):k(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!1)},async validaterowData(t){const e=T.getUserID(),n=new nt(this.patient.patientID,e),l=D(this.vitalsWeightHeight,"weight","value"),c=D(this.vitalsWeightHeight,"Height (cm)","value"),v=n.validator({inputHeader:"Height*",value:c}),o=n.validator({inputHeader:"Weight*",value:l});v&&c?k(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",v.flat(1/0)[0]):k(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",""),o&&l?k(this.vitalsWeightHeight,"weight","alertsErrorMassage",o.flat(1/0)[0]):k(this.vitalsWeightHeight,"weight","alertsErrorMassage",""),this.setBMI(l,c)},async saveVitals(){const t=T.getUserID(),e=new nt(this.patient.patientID,t),n=D(this.vitalsWeightHeight,"weight","value"),l=D(this.vitalsWeightHeight,"Height (cm)","value");let c=null;this.checkUnderSixWeeks||(c=e.validator({inputHeader:"Height*",value:l}));const v=e.validator({inputHeader:"Weight*",value:n}),o=await ft(this.vitalsWeightHeight);if(o.length>0&&v==null&&c==null){const d=JSON.parse(JSON.stringify(this.patient));let u=d==null?void 0:d.vitals;u.unsaved=[...u.unsaved,...o],await vt(d),gt("Vitals saved successful"),this.cleanInputFields()}else X("Please complete the form")},cleanInputFields(){k(this.vitalsWeightHeight,"weight","value",""),k(this.vitalsWeightHeight,"Height (cm)","value",""),this.dismiss()},dismiss(){$.dismiss()},async setBMI(t,e){var n,l,c,v,o,d,u,f;(l=(n=this.patient)==null?void 0:n.personInformation)!=null&&l.gender&&((v=(c=this.patient)==null?void 0:c.personInformation)!=null&&v.birthdate)&&(this.BMI=await st.getBMI(parseInt(t),parseInt(e),(d=(o=this.patient)==null?void 0:o.personInformation)==null?void 0:d.gender,C.calculateAge((f=(u=this.patient)==null?void 0:u.personInformation)==null?void 0:f.birthdate,C.sessionDate()))),this.updateBMI()},async updateBMI(){var n,l,c,v,o,d;const t=(l=(n=this.BMI)==null?void 0:n.color)!=null?l:[],e=this.vitalsWeightHeight[0].alerts[0];e.icon=st.iconBMI(t),e.backgroundColor=t[0],e.textColor=t[1],e.index="BMI "+((v=(c=this.BMI)==null?void 0:c.index)!=null?v:""),e.value=(d=(o=this.BMI)==null?void 0:o.result)!=null?d:""},showCPD(){this.showPD=!0,this.showDateBtns=!1},updateDate(t){this.vitals_date=C.toStandardHisFormat(t)}}}),Te={key:0,class:"pim-cls-1 modal_wrapper"},Me={class:"center text_12"},Oe={class:"btnContent"},Ae={key:0,class:"saveBtn"},We={key:1,class:"saveBtn"};function Re(t,e,n,l,c,v){const o=r("BasicForm"),d=r("ion-row"),u=r("customDatePicker"),f=r("ion-icon"),h=r("ion-button"),m=r("ion-col");return t.formOpen?(_(),y("div",Te,[e[7]||(e[7]=i("div",{class:"OtherVitalsHeading"},[i("div",{class:"OtherVitalsTitle"},"Add Weight/Height")],-1)),i("div",null,[i("div",Me,[s(d,null,{default:a(()=>[s(o,{contentData:t.vitalsWeightHeight,"onUpdate:inputValue":e[0]||(e[0]=p=>t.validaterowData(p))},null,8,["contentData"])]),_:1})])]),t.showPD?(_(),N(u,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):I("",!0),i("div",Oe,[t.showDateBtns?(_(),y("div",Ae,[i("div",null,[s(h,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=p=>t.saveVitals())},{default:a(()=>[e[3]||(e[3]=g(" Done today ")),s(f,{slot:"end",size:"small",icon:t.iconContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[3]})]),i("div",null,[s(h,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:a(()=>[e[4]||(e[4]=g(" Done earlier ")),s(f,{slot:"end",size:"small",icon:t.iconContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])])])):I("",!0),t.showDateBtns?I("",!0):(_(),y("div",We,[s(d,null,{default:a(()=>[s(m,null,{default:a(()=>[s(h,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:a(()=>e[5]||(e[5]=[g(" Cancel ")])),_:1,__:[5]},8,["onClick"])]),_:1}),s(m,null,{default:a(()=>[s(h,{onClick:e[2]||(e[2]=p=>t.saveVitals()),class:"btnText",fill:"solid",style:{width:"130px"}},{default:a(()=>e[6]||(e[6]=[g(" save ")])),_:1,__:[6]})]),_:1})]),_:1})]))])])):I("",!0)}const Xe=H(Pe,[["render",Re],["__scopeId","data-v-7b242731"]]);export{Je as O,re as Q,Ke as _,G as a,it as b,He as c,he as l,Xe as w};
