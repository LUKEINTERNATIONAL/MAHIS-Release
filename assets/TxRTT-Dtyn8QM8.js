import{d as u,l as _,a as w}from"./index-DtOmmd1G.js";import{_ as D}from"./ReportTable.vue_vue_type_style_index_0_lang-F5YIr5_p.js";import{a as R}from"./tx_report_service-BjgG0wHs.js";import{l as v}from"./lodash-Dt8AsbQm.js";import{d as T,r as i,y as F,f as y}from"./vendor-CF1BfZgY.js";import"./apexcharts-DN__3LFM.js";import"./chartjs-BnucuA72.js";import"./barcode-qrcode-reader-qARKdyHp.js";import"./report_service-8iHlYLdA.js";import"./age_groups-BkW1n_F5.js";const q=T({__name:"TxRTT",setup(A){const d=i("-"),g=i([]),p=i(),o=new R,c=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:u},{path:"cd4_less_than_200",label:"CD4 <200",drillable:!0},{path:"cd4_greater_than_or_equal_to_200",label:"CD4 >=200",drillable:!0},{path:"unknown_cd4_count",label:"Unknown CD4",drillable:!0},{path:"not_eligible_for_cd4",label:"Not Eligible for CD4",drillable:!0},{path:"returned_less_than_3_months",label:"Returned <3 mo",drillable:!0},{path:"returned_greater_than_3_months_and_less_than_6_months",label:"Returned 3-5 mo",drillable:!0},{path:"returned_greater_than_or_equal_to_6_months",label:"Returned 6+ mo",drillable:!0}];function h(t){const r={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return t.reduce((a,e)=>{if(e.age_group!=="Unknown"){const n=e.gender;a[n].rows.push({...e,ageGroup:e.age_group}),a[n].aggregate=Object.keys(e).reduce((s,l)=>Array.isArray(e[l])?{...s,[l]:[...s[l]||[],...e[l]]}:s,a[n].aggregate)}return a},r)}function f(t){const r=Object.values(t.F.aggregate).flat(1),a=Object.values(t.M.aggregate).flat(1);p.value=v.uniq([...r,...a])}async function m({dateRange:t},r=!1){try{await _.show(),o.setStartDate(t.startDate),o.setEndDate(t.endDate),d.value=o.getDateIntervalPeriod();const a=await o.getTxRttReport(r),e=h(a);g.value=[...e.F.rows,...e.M.rows,{ageGroup:"All",gender:"Male",...e.M.aggregate},...await o.buildMaternityAgreggateRows(e.F.aggregate)],f(e)}catch(a){w("ERROR! Unable to load report data"),console.error(a)}await _.hide()}function b(t){return"".concat(t.column.label," | ").concat(t.row.ageGroup," | ").concat(u(t.row.gender),"s")}return(t,r)=>(y(),F(D,{title:"PEPFAR TX RTT Report",subtitle:"Clients that have their clinical dispensation visit falling \n      in the reporting period and there is a difference of 30 or more days \n      between their visit date and their previous appointment date / runout date","report-type":"PEPFAR",columns:c,rows:g.value,period:d.value,"total-clients":p.value,"drill-title":b,useDateRangeFilter:"",showIndices:"",onGenerate:m},null,8,["rows","period","total-clients"]))}});export{q as default};
