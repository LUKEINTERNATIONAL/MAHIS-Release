import{d as N,a0 as G,M as J,aa as H,a9 as k,bh as j,aO as K,aP as Q,aQ as W,aR as X,G as Z,E as ee,ae as R,I as te,a8 as Y,cr as se,dv as ae,dw as ne,dx as oe,au as ie,aI as le,bU as re,bs as ce,aA as de,az as ue,H as v,e as P,f as u,k as s,l as t,J as a,F,O as M,P as V,K as l,m as w,Y as fe,N as O,p as me,co as pe,aT as _e,r as m,bq as ge,a as he,w as ve,i as B,u as p,bf as be,v as U,L as ye}from"./vendor-f_p5GZUu.js";import{N as xe}from"./NavigationMenu-BvXh40bq.js";import{E as Pe}from"./EIRreportsStore-DefHbVI2.js";import{P as q,u as Ce,_ as L,$ as De,B as we}from"./index-DzUJ3B4y.js";import{b as Ie}from"./bottomNavBar-BFx_56xH.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-Db13O_GS.js";const ke=N({name:"ClientDetailsCard",components:{IonContent:Y,IonHeader:te,IonPage:R,IonTitle:ee,IonToolbar:Z,IonCard:X,IonCardHeader:W,IonCardTitle:Q,IonCardContent:K,IonGrid:j,IonRow:k,IonCol:H,IonButton:J,IonIcon:G},props:{clients:{type:Array,required:!0}},setup(){return{personOutline:ue,locationOutline:de,informationCircleOutline:ce,documentTextOutline:re,calendarOutline:le,heartOutline:ie,briefcaseOutline:oe,schoolOutline:ne,ribbonOutline:ae,openOutline:se}},methods:{calculateAge(e){const o=new Date,i=new Date(e);let _=o.getFullYear()-i.getFullYear();const A=o.getMonth()-i.getMonth();return(A<0||A===0&&o.getDate()<i.getDate())&&_--,_},formatDate(e){return new Date(e).toLocaleDateString()},findPersonAttribute(e,o){const i=e.person.person_attributes.find(_=>_.type.name===o);return i?i.value:"N/A"},toggleDetails(e){e.showDetails=!e.showDetails},async openClientProfile(e){e.forEach(async o=>{if(o.type.patient_identifier_type_id==3){const i=await q.findByNpid(o.identifier);Ce().setPatientRecord(i[0]),this.redirectUser()}})},redirectUser(){const e=JSON.parse(localStorage.getItem("userRoles")),o=e||[];o.some(i=>o.some(_=>_.role==="Pharmacist"))?this.$router.push("NCDDispensations"):this.$router.push("patientProfile")}},mounted(){this.clients.forEach(e=>{e.showDetails=!1})},emits:["view-profile"]}),Oe={class:"flex items-center mb-3"},Ne={class:"flex flex-col"},Ae={class:"font-semibold text-gray-800"},$e={class:"flex items-center mb-3"},ze={class:"flex flex-col"},Se={class:"font-semibold text-gray-800"},Ve={class:"mt-4"},Be={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Ue={class:"flex flex-col"},He={class:"font-semibold text-gray-800"},Le={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Ee={class:"flex flex-col"},Fe={class:"font-semibold text-gray-800"},Me={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Te={class:"flex flex-col"},Re={class:"font-semibold text-gray-800"},Ye={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},qe={class:"flex flex-col"},Ge={class:"font-semibold text-gray-800"},Je={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},je={class:"flex flex-col"},Ke={class:"font-semibold text-gray-800"};function Qe(e,o,i,_,A,$){const C=v("ion-button"),I=v("ion-card-title"),f=v("ion-col"),r=v("ion-icon"),b=v("ion-row"),g=v("ion-card-header"),y=v("ion-grid"),x=v("ion-card-content"),S=v("ion-card");return u(),P("div",null,[s("div",null,[t(b,null,{default:a(()=>[(u(!0),P(F,null,M(e.clients,n=>(u(),P("div",{key:n.patient_id,style:{width:"380px",margin:"10px"}},[t(S,{class:"shadow-md hover:shadow-lg transition-shadow",style:{width:"100%"}},{default:a(()=>[t(g,{class:"relative"},{default:a(()=>[t(b,null,{default:a(()=>[t(f,{class:"ion-text-left"},{default:a(()=>[t(I,{class:"text-indigo-800"},{default:a(()=>[t(C,{fill:"clear",style:{"font-size":"1.4rem","margin-left":"-30px"},onClick:h=>e.openClientProfile(n.patient_identifiers)},{default:a(()=>[V(l(n.person.names[0].given_name)+" "+l(n.person.names[0].family_name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),t(f,null,{default:a(()=>[t(C,{fill:"clear",class:"absolute top-0 right-0 z-10 text-indigo-600",onClick:h=>e.openClientProfile(n.patient_identifiers),style:{"font-size":"1.4rem"}},{default:a(()=>[t(r,{icon:e.openOutline,style:{"font-size":"2rem"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(x,{class:"card-content"},{default:a(()=>{var h,z;return[s("div",Oe,[t(r,{icon:e.personOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ne,[s("span",Ae,l(n.person.gender)+" | "+l(e.calculateAge(n.person.birthdate))+" years",1)])]),s("div",$e,[t(r,{icon:e.locationOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",ze,[s("span",Se,l((h=n.person.addresses[0])==null?void 0:h.city_village)+", "+l((z=n.person.addresses[0])==null?void 0:z.state_province),1)])]),s("div",Ve,[t(C,{onClick:D=>e.toggleDetails(n),fill:"outline",size:"small",class:"border-indigo-600 text-indigo-600 hover:bg-indigo-50"},{default:a(()=>[t(r,{icon:e.informationCircleOutline,class:"mr-2"},null,8,["icon"]),V(" "+l(n.showDetails?"Hide Details":"Show More Details"),1)]),_:2},1032,["onClick"]),n.showDetails?(u(),P("div",{key:0,class:"mt-4 bg-indigo-50 p-4 rounded-lg border border-indigo-100 shadow-inner",style:fe({maxHeight:n.showDetails?"1000px":"0"})},[o[0]||(o[0]=s("h3",{class:"text-lg font-semibold mb-3 flex items-center text-indigo-800 border-b border-indigo-200 pb-2"}," Personal Information ",-1)),t(y,null,{default:a(()=>[t(b,null,{default:a(()=>[t(f,{size:"auto"},{default:a(()=>[s("div",Be,[t(r,{icon:e.calendarOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ue,[s("span",He,l(e.formatDate(n.person.birthdate)),1)])])]),_:2},1024),t(f,{size:"auto"},{default:a(()=>[s("div",Le,[t(r,{icon:e.heartOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ee,[s("span",Fe,l(e.findPersonAttribute(n,"Civil Status")),1)])])]),_:2},1024),t(f,{size:"auto"},{default:a(()=>[s("div",Me,[t(r,{icon:e.briefcaseOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Te,[s("span",Re,l(e.findPersonAttribute(n,"Occupation")),1)])])]),_:2},1024),t(f,{size:"auto"},{default:a(()=>[s("div",Ye,[t(r,{icon:e.schoolOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",qe,[s("span",Ge,l(e.findPersonAttribute(n,"EDUCATION LEVEL")),1)])])]),_:2},1024),t(f,{size:"12","size-md":"6"},{default:a(()=>[s("div",Je,[t(r,{icon:e.ribbonOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",je,[s("span",Ke,l(e.findPersonAttribute(n,"Religion")),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1024),o[1]||(o[1]=s("h3",{class:"text-lg font-semibold mt-3 mb-2"},"Identifiers",-1)),t(y,null,{default:a(()=>[t(b,null,{default:a(()=>[(u(!0),P(F,null,M(n.patient_identifiers,D=>(u(),O(f,{key:D.uuid,size:"auto"},{default:a(()=>[s("p",null,[s("strong",null,l(D.type.name)+":",1),V(" "+l(D.identifier),1)])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)],4)):w("",!0)])]}),_:2},1024)]),_:2},1024)]))),128))]),_:1})])])}const We=L(ke,[["render",Qe],["__scopeId","data-v-843fbd69"]]),Xe={class:"loader-content"},Ze={key:0,class:"loader-message"},et=N({name:"ModernLoader"}),tt=N({...et,props:{message:{type:String,default:"Loading..."},fullscreen:{type:Boolean,default:!1}},setup(e){return(o,i)=>(u(),P("div",{class:me(["loader-container",{fullscreen:e.fullscreen,inline:!e.fullscreen}])},[s("div",Xe,[i[0]||(i[0]=s("div",{class:"spinner"},[s("div",{class:"spinner-ring"}),s("div",{class:"spinner-core"})],-1)),e.message?(u(),P("div",Ze,l(e.message),1)):w("",!0)])],2))}}),T=L(tt,[["__scopeId","data-v-0093b847"]]),st={class:"container"},at={key:1,class:"scrollable-content"},nt=N({name:"xxxComponent"}),ot=N({...nt,setup(e){const o=pe(),i=De(),{userFacilityName:_,user_ID:A}=_e(i),$=m(""),C=m(0),I=m([]),f=m(""),r=m(""),b=m(""),g=ge({page:1,itemsPerPage:10}),y=m(!1),x=m(!0),S=({page:c,itemsPerPage:d})=>{g.page=c,g.itemsPerPage=d,n()},n=async(c=!0)=>{c&&(y.value=!0);try{const d=await q.getNCDActivePatientsFfromMongo(g.page,g.itemsPerPage,f.value,r.value,b.value);C.value=d.count,I.value=d.results}catch(d){}finally{c&&(y.value=!1,x.value=!1)}},h=[{placeHolder:"Search for client",dataHandler:z,dataValue:m(),show_error:m(!1),error_message:"Please provide a reason"}];async function z(c){try{$.value=c.target.value,f.value="",r.value="",b.value="",$.value.length>0?(D($.value),g.page=1,await n()):await n(!1)}catch(d){await n(!1)}}function D(c){h[0].dataValue.value=c;const d=c.split(" ");f.value=d[0],r.value=d.length>=2?d[1]:"",b.value=d.length>=3?d[2]:""}const E=()=>{Pe().setNavigationPayload("NCD Active Patients (".concat(_.value,")"),!0,!1,"/","home",""),n()};return he(async()=>{E()}),ve(()=>o.name,c=>{c==="NCDActivePatients"&&E()},{immediate:!0}),(c,d)=>(u(),O(p(R),null,{default:a(()=>[t(xe),x.value?(u(),O(T,{key:0,fullscreen:!0,message:"Loading patient data..."})):w("",!0),B(t(p(Y),null,{default:a(()=>[s("div",st,[t(p(k),{class:"search-container"},{default:a(()=>[t(p(k),{class:"search-row"},{default:a(()=>[t(p(H),{class:"input-col"},{default:a(()=>[t(we,{placeholder:h[0].placeHolder,icon:p(be),inputValue:h[0].dataValue.value,"onUpdate:inputValue":h[0].dataHandler,minHeight:50,"-inner-action-btn-propeties":"","onUpdate:InnerActionBtnPropetiesAction":it=>""},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"])]),_:1})]),_:1})]),_:1}),y.value&&!x.value?(u(),O(T,{key:0,message:"Fetching patients..."})):w("",!0),y.value?w("",!0):B((u(),P("div",at,[!y.value||I.value.length>0?(u(),O(p(k),{key:0},{default:a(()=>[t(We,{clients:I.value},null,8,["clients"])]),_:1})):w("",!0)],512)),[[U,!x.value]])])]),_:1},512),[[U,!x.value]]),B(t(p(ye),{class:"sticky-footer"},{default:a(()=>[t(p(k),null,{default:a(()=>[t(p(H),{size:"12",style:{"max-width":"100%"}},{default:a(()=>[t(Ie,{totalItems:C.value,currentPage:g.page,itemsPerPage:g.itemsPerPage,"onUpdate:pagination":S},null,8,["totalItems","currentPage","itemsPerPage"])]),_:1})]),_:1})]),_:1},512),[[U,!x.value]])]),_:1}))}}),pt=L(ot,[["__scopeId","data-v-938afe99"]]);export{pt as default};
