import{d as N,ar as w,bm as O,D as U,cv as x,cu as L,I as $,W as z,aY as R,aZ as W,a_ as Z,a$ as j,ab as G,aa as Y,U as q,T as J,af as K,bf as Q,S as X,a9 as ee,r as g,c as k,a as te,bW as ne,cR as ae,cS as oe,cT as se,cU as re,cb as ie,bi as le,cc as pe,cd as de,ce,cf as ue,cg as me,ch as ge,ci as he,cj as _e,a2 as fe,ck as Pe,E as s,y as f,f as p,z as o,l as a,k as d,e as I,m as B,A as c,B as h,$ as ve,F as S,L as M}from"./vendor-BsZAuWFl.js";import{B as Ie,y as be,T as ye,H as V,_ as Ce}from"./index-7oXXhM88.js";import{B as Ae}from"./BasicForm-sBDzgrXz.js";import{A as we}from"./appointment_service-CTgFpZK5.js";import{u as D}from"./vaccines_service-Dmdq8tJI.js";import{u as ke}from"./StartEndDate-BBucP3Kp.js";import{n as Be}from"./nextApptInf-BpVuHPqz.js";import{N as Se}from"./NavigationMenu-BQWL7Ev0.js";import"./lodash-Dt8AsbQm.js";import"./DateInputField-Z8nNCC8K.js";import"./app_encounter_service-d1pbNlwk.js";import"./sms_service-DMrFmjBD.js";import"./EIRreportsStore-C6kJ0nS9.js";import"./Export-Cp-PYKXs.js";import"./voidReason-BoX9e4wl.js";const Me=N({name:"ManageAppointMentsTemplate",components:{IonContent:ee,IonHeader:X,IonMenuButton:Q,IonPage:K,IonTitle:J,IonToolbar:q,Toolbar:ye,ToolbarSearch:be,IonRow:Y,IonCol:G,IonCard:j,IonCardHeader:Z,IonCardTitle:W,IonCardContent:R,IonButton:z,nextApptInf:Be,BasicForm:Ae,IonIcon:$,IonSelect:L,IonSelectOption:x,IonLabel:U,BasicInputField:Ie,IonGrid:O,NavigationMenu:Se},data(){return{search_text:"",search_txt_error:!1}},setup(){const e=g([]),t=g([]),n=g(1),r=g(10),P=g(0),b=k(()=>Math.ceil(e.value.length/r.value)),v=k(()=>{const l=(n.value-1)*r.value,m=l+r.value;return e.value.slice(l,m)}),u=()=>{const l=window.innerHeight,m=180;P.value=l-m};return te(()=>{u(),window.addEventListener("resize",u)}),ne(()=>{window.removeEventListener("resize",u)}),{people:e,people_cpy:t,currentPage:n,totalPages:b,paginatedPeople:v,listHeight:P,chevronBackOutline:Pe,checkmark:fe,grid:_e,chevronDownCircle:he,chevronForwardCircle:ge,chevronUpCircle:me,colorPalette:ue,document:ce,globe:de,medkit:pe,itemsPerPage:r,add:le,person:ie,refreshOutline:re,chevronForwardOutline:se,bookOutline:oe,searchOutline:ae}},computed:{...w(D,["selectedAppointmentMentForAppointmentsPage","AppointmentsReload"]),...w(ke,["startEndDate"]),startIndex(){return(this.currentPage-1)*this.itemsPerPage+1},endIndex(){return Math.min(this.startIndex+this.itemsPerPage-1,this.people.length)}},watch:{selectedAppointmentMentForAppointmentsPage:{handler(){},deep:!0},AppointmentsReload:{handler(){this.loadPageInf()},deep:!0},$route:{async handler(e){e.name=="ManageAppointMentsTemplate"&&this.loadPageInf()},deep:!0}},async mounted(){this.loadPageInf()},methods:{formatBirthdate(e){return V.getBirthdateAge(e)},async getAppointments(){this.people.length=0,this.currentPage=1,this.itemsPerPage=10;try{const e=D();(await we.getDailiyAppointments(e.getStartEndDate().startDate,e.getStartEndDate().endDate,"")).forEach(n=>{const r={person_id:n.person_id,npid:n.npid,appointment_id:103,encounter_id:n.encounter_id,name:n.given_name.concat(" ",n.family_name),gender:n.gender,ageDob:this.formatBirthdate(n.birthdate),village:n.city_village,appointmentDate:V.toStandardHisDisplayFormat(n.appointment_date)};this.people.push(r)}),this.people_cpy=this.people}catch(e){}},async loadPageInf(){await this.getAppointments()},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},changePage(e){this.currentPage=e.detail.value},changeItemsPerPage(e){this.itemsPerPage=e.detail.value,this.currentPage=1},searchTextUpdated(e){const t=e.target.value;this.search_text=t,this.isValidString(this.search_text)==!0?(this.search_txt_error=!1,this.searchFirstLastName(this.search_text)):this.search_txt_error=!0},isValidString(e){return/^[a-zA-Z\s]*$/.test(e)},searchFirstLastName(e){const t=[],n=new RegExp(e,"i");this.people_cpy.forEach(r=>{n.test(r.name)==!0&&t.push(r)}),this.people=t}}}),Ve={class:"container"},De={key:0,class:"pagination-controls"},Fe={class:"pagination-info"},Te={class:"items-per-page"},Ee={class:"page-counter"};function He(e,t,n,r,P,b){const v=s("NavigationMenu"),u=s("BasicInputField"),l=s("ion-label"),m=s("ion-col"),F=s("ion-row"),T=s("nextApptInf"),y=s("ion-icon"),C=s("ion-button"),_=s("ion-select-option"),A=s("ion-select"),E=s("ion-content"),H=s("ion-page");return p(),f(H,null,{default:o(()=>[a(v),a(E,null,{default:o(()=>[d("div",Ve,[a(F,null,{default:o(()=>[a(m,{size:"12"},{default:o(()=>[a(u,{placeholder:"",icon:e.searchOutline,inputValue:e.search_text,"onUpdate:inputValue":e.searchTextUpdated},null,8,["icon","inputValue","onUpdate:inputValue"]),d("div",null,[e.search_txt_error?(p(),f(l,{key:0,class:"error-label"},{default:o(()=>t[2]||(t[2]=[c(h("only letters allowed"))])),_:1,__:[2]})):B("",!0)])]),_:1})]),_:1}),d("div",{class:"appointment-list",style:ve({height:e.listHeight+"px"})},[(p(!0),I(S,null,M(e.paginatedPeople,i=>(p(),f(T,{key:i.person_id,person:i},null,8,["person"]))),128))],4),e.people.length>0?(p(),I("div",De,[a(C,{class:"nav-button",onClick:e.prevPage,disabled:e.currentPage===1},{default:o(()=>[a(y,{icon:e.chevronBackOutline,slot:"icon-only"},null,8,["icon"])]),_:1},8,["onClick","disabled"]),d("div",Fe,[d("div",Te,[a(l,{style:{"margin-left":"20px"}},{default:o(()=>t[3]||(t[3]=[c("Items per page:")])),_:1,__:[3]}),a(A,{modelValue:e.itemsPerPage,"onUpdate:modelValue":t[0]||(t[0]=i=>e.itemsPerPage=i),onIonChange:e.changeItemsPerPage,interface:"popover"},{default:o(()=>[a(_,{value:10},{default:o(()=>t[4]||(t[4]=[c("10")])),_:1,__:[4]}),a(_,{value:20},{default:o(()=>t[5]||(t[5]=[c("20")])),_:1,__:[5]}),a(_,{value:50},{default:o(()=>t[6]||(t[6]=[c("50")])),_:1,__:[6]})]),_:1},8,["modelValue","onIonChange"])]),d("div",Ee,"Showing "+h(e.startIndex)+" - "+h(e.endIndex)+" of "+h(e.people.length),1),a(A,{modelValue:e.currentPage,"onUpdate:modelValue":t[1]||(t[1]=i=>e.currentPage=i),onIonChange:e.changePage,interface:"popover"},{default:o(()=>[(p(!0),I(S,null,M(e.totalPages,i=>(p(),f(_,{key:i,value:i},{default:o(()=>[c(" Page "+h(i),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onIonChange"])]),a(C,{class:"nav-button",onClick:e.nextPage,disabled:e.currentPage===e.totalPages},{default:o(()=>[a(y,{icon:e.chevronForwardOutline,slot:"icon-only"},null,8,["icon"])]),_:1},8,["onClick","disabled"])])):B("",!0)])]),_:1})]),_:1})}const Ke=Ce(Me,[["render",He],["__scopeId","data-v-98185ae1"]]);export{Ke as default};
