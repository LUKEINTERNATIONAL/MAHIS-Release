System.register(["./vendor-legacy-qLaA4lfC.js","./index-legacy-D5KB3apO.js","./BasicFooter-legacy-D7y1xmG3.js","./DemographicBar-legacy-B7Nwfuj5.js","./SaveProgressModal-legacy-Rw8CMxR1.js","./Stepper-legacy-D8_8NuMe.js","./vitals_service-legacy-sz_0q4r8.js","./formatServerData-legacy-B97dRQcE.js","./lodash-legacy-pOOc9Efu.js","./app_encounter_service-legacy-cWyyu9lx.js","./lab_order-legacy-C687agJY.js","./BasicForm-legacy-CiGeKWT-.js","./DateInputField-legacy-BId0pKUJ.js","./DashBox-legacy-B3Lx5Aq4.js","./SvgDynamicColor-legacy-Ba9UND3E.js","./group_validation-legacy-J8PH-M44.js","./Outcome-legacy-D4TCVmfQ.js","./SelectFacility-legacy-cyuj30BW.js","./patient_complaints_service-legacy-Rymefa0o.js","./StandardForm.vue_vue_type_script_setup_true_lang-legacy-Cphixc1Q.js","./useExposeFromStandardForm-legacy-ZO3UEy3P.js","./patient_lab_service-legacy-BY7AvY-3.js","./LabTestsHistory-legacy-CZsV4Uaq.js","./NextAppointment-legacy-D3_qZcYb.js","./previousDiagnosis-legacy-BJ_IkMVJ.js","./drug_prescription_service-legacy-C0MyCGn6.js","./drug_service-legacy-CCLnJjhH.js","./appointment_service-legacy-dEnyGyE2.js","./clinicalDaysStore-legacy-DWCMsmQh.js","./ncd_appointment_service-legacy-gpVjUuHT.js","./UpcomingFeature-legacy-CCNTOJko.js","./previousVitals-legacy-DacPDB1S.js","./apexcharts-legacy-DX-O3ogC.js","./FeatusModal-legacy-B9cNeceq.js","./PastObstreticHistoryStore-legacy-h3j6ovzF.js"],function(a,t){"use strict";var e,i,s,n,l,o,r,d,c,u,h,p,v,g,y,D,m,S,f,w,j,I,b,_,T,F,P,V,C,k,E,x,B,O,z,L,U,M,N,H,W,A,$,R,G,q,J,Y,Z,K,Q,X,aa,ta;return{setters:[a=>{e=a.d,i=a.ar,s=a.b8,n=a.D,l=a.G,o=a.M,r=a.J,d=a.a_,c=a.bC,u=a.a$,h=a.aZ,p=a.b0,v=a.W,g=a.U,y=a.T,D=a.af,m=a.ba,S=a.S,f=a.a9,w=a.a2,j=a.ck,I=a.E,b=a.y,_=a.f,T=a.z,F=a.e,P=a.m,V=a.l,C=a.k},a=>{k=a.y,E=a.T,x=a.f,B=a.S,O=a.H,z=a.am,L=a.j,U=a.aB,M=a.g,N=a.l,H=a.h,W=a.t,A=a.at,$=a.x,R=a.a1,G=a.u,q=a.i,J=a._},a=>{Y=a.B},a=>{Z=a.D},a=>{K=a.S},a=>{Q=a.S},a=>{X=a.V},a=>{aa=a.d,ta=a.a},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".spinner-overlay[data-v-9b3985d9]{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;background-color:rgba(255,255,255,.5);z-index:9999}ion-spinner[data-v-9b3985d9]{width:80px;height:80px}.loading-text[data-v-9b3985d9]{margin-top:20px;font-size:18px;color:#333}.loading[data-v-9b3985d9]{pointer-events:none}\n/*$vite$:1*/",document.head.appendChild(t);const ea=e({name:"Home",components:{IonContent:f,IonHeader:S,IonMenuButton:m,IonPage:D,IonTitle:y,IonToolbar:g,Toolbar:E,ToolbarSearch:k,DemographicBar:Z,IonButton:v,IonCard:p,IonCardContent:h,IonCardHeader:u,IonCardSubtitle:c,IonCardTitle:d,IonAccordion:r,IonAccordionGroup:o,IonItem:l,IonLabel:n,IonModal:s,Stepper:Q,BasicFooter:Y},data:()=>({isLoading:!1,hasValidationErrors:[],outcomes:"",actionBtn:"",wizardData:[{title:"Vital Signs",class:"common_step",checked:!1,disabled:!1,number:1,last_step:"last_step"}],StepperData:[{title:"Vital Signs",component:"VitalSigns",value:"1"}],isOpen:!1,iconsContent:q}),computed:{...i(G,["patient"]),...i(R,["vitals"]),"Height Weight Reason"(){return $(this.vitals,"Height Weight Reason","value")}},async created(){},mounted(){this.markWizard()},watch:{vitals:{handler(){this.markWizard()},deep:!0},investigations:{handler(){this.markWizard()},deep:!0},diagnosis:{handler(){this.markWizard()},deep:!0},selectedMedicalDrugsList:{handler(){this.markWizard()}}},setup:()=>({chevronBackOutline:j,checkmark:w}),methods:{markWizard(){this.actionBtn=this.vitals[0].actionBtn;const a=O.sessionDate(),t=A("vitals").some(t=>O.toStandardHisFormat(t.obs_datetime)===O.toStandardHisFormat(a));this.vitals.validationStatus||t?(this.wizardData[0].checked=!0,this.wizardData[0].class="open_step common_step"):this.wizardData[0].checked=!1},async getSaveFunction(){B.getUserID();const a=B.getUserRoles();this.isLoading=!0;try{if(await this.validaterowData(),"Finish"!=this.actionBtn)if(this.vitals.validationStatus){await this.saveVitals(),await U();const t=await M(),e=t?t.code:null;a.includes("Nurse")?(await H.addPatientToStage(this.patient.patientID,O.todayDateFormatted(),"CONSULTATION",e),L("Vitals have been saved!"),this.$router.push("patientProfile")):(await H.addPatientToStage(this.patient.patientID,O.todayDateFormatted(),"CONSULTATION",e),L("Vitals have been saved!"),this.$router.push("OPDConsultationPlan"))}else W("Please fill all required fields");else{const t=await M(),e=t?t.code:null;a.includes("Nurse")?(await H.addPatientToStage(this.patient.patientID,O.todayDateFormatted(),"CONSULTATION",e),L("Vitals have been saved!"),this.$router.push("patientProfile")):(await H.addPatientToStage(this.patient.patientID,O.todayDateFormatted(),"CONSULTATION",e),L("Vitals have been saved!"),this.$router.push("OPDConsultationPlan"))}}catch(t){console.error("Error in saveData: ",t)}finally{this.isLoading=!1}},async saveData(){this.isLoading=!0;try{if("Finish"!=this.actionBtn)if(this.vitals.validationStatus){await this.saveVitals(),U();const a=await M(),t=a?a.code:null;if(!t)return void N("Location ID could not be found. Please check your settings.");await H.addPatientToStage(this.patient.patientID,O.todayDateFormatted(),"CONSULTATION",t),this.$router.push("OPDConsultationPlan")}else await this.validaterowData(),W("Please correct validation errors in form");else this.$router.push("OPDConsultationPlan")}catch(a){console.error("Error in saveData: ",a)}finally{this.isLoading=!1}},async saveVitals(){const a=B.getUserID(),t=new X(this.patient.patientID,a);try{await t.onFinish(this.vitals);const a=await aa(this.vitals),l=await ta(this.vitals);var e,i,s,n;(l.length>0||a.length>0)&&(null!==(i=(e=null!==(n=(s=this.patient).vitals)&&void 0!==n?n:s.vitals={}).unsaved)&&void 0!==i||(e.unsaved=[]),this.patient.vitals.unsaved.push(...l,...a),await z(this.patient)),L("Vitals saved successfully")}catch(l){throw console.error("Vitals save failed:",l),l}},async validaterowData(){var a;this.hasValidationErrors=[];const t=B.getUserID(),e=new X(this.patient.patientID,t),i=O.getAgeInYears(null===(a=this.patient)||void 0===a||null===(a=a.personInformation)||void 0===a?void 0:a.birthdate);this.vitals.forEach((a,t)=>{var s,n;null!=a&&null!==(s=a.data)&&void 0!==s&&s.rowData&&(null==a||null===(n=a.data)||void 0===n||n.rowData.forEach((a,s)=>{a.colData.some((a,n)=>{if("Respiratory rate"===a.name&&i<=5){const i=e.validator(a);if((null==i?void 0:i.length)>0)return this.hasValidationErrors.push("false"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=i.flat(1/0)[0],!0;this.hasValidationErrors.push("true"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=!1,this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=""}else{const i=e.validator(a);if((null==i?void 0:i.length)>0)return this.hasValidationErrors.push("false"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=i.flat(1/0)[0],!0;this.hasValidationErrors.push("true"),this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=!1,this.vitals[t].data.rowData[s].colData[n].alertsErrorMassage=""}return!1})}))}),this.vitals.validationStatus=!this.hasValidationErrors.includes("false")},openModal(){x(K)}}}),ia={key:0,class:"spinner-overlay"};a("default",J(ea,[["render",function(a,t,e,i,s,n){const l=I("ion-spinner"),o=I("Toolbar"),r=I("DemographicBar"),d=I("Stepper"),c=I("ion-content"),u=I("ion-page");return _(),b(u,null,{default:T(()=>[a.isLoading?(_(),F("div",ia,[V(l,{name:"bubbles"}),t[1]||(t[1]=C("div",{class:"loading-text"},"Please wait...",-1))])):P("",!0),V(o),V(c,{fullscreen:!0},{default:T(()=>[V(r),V(d,{stepperTitle:"Vitals",wizardData:a.wizardData,onUpdateStatus:a.markWizard,onFinishBtn:t[0]||(t[0]=t=>a.saveData()),StepperData:a.StepperData,getSaveFunction:a.getSaveFunction},null,8,["wizardData","onUpdateStatus","StepperData","getSaveFunction"])]),_:1})]),_:1})}],["__scopeId","data-v-9b3985d9"]]))}}});
