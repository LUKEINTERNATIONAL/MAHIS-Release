import{S as J,m as ge,y as K,aN as _e,n as oe,l as ee,aa as we,C as De,i as Se,_ as Z,B as re,aC as ae,t as Q,ba as ie,D as Y,bb as be,L as Ie}from"./index-De0affBd.js";import{d as W,D as R,aj as $,G as ke,E as z,e as de,f as g,L as Ve,y as D,z as r,l as c,A as H,B as N,k as B,p as fe,F as me,r as n,w as q,u as i,dT as Ae,m as b,ae as Be,a as te,ak as le,bo as ve,ai as U,dB as he,bq as ue,ag as ce,c as Ce}from"./vendor-D2vbv48U.js";import{l as Oe}from"./lodash-Dt8AsbQm.js";const pe="stages",se="unsavedStages";class Ke extends J{static getOperationMode(){const e=J.getAPIStatus(),t=J.getModsStatus(),l=J.getUseIndexDBStatus();return e&&!l?"API_ONLY":e&&l?"API_WITH_INDEXDB":t&&!l?"MODS_ONLY":t&&l?"MODS_WITH_INDEXDB":"OFFLINE"}static async addPatientToStage(e,t,l,s){const _=this.getOperationMode();try{switch(_){case"API_ONLY":return await this._handleApiOnly(e,t,l,s);case"API_WITH_INDEXDB":return await this._handleApiWithIndexDB(e,t,l,s);case"MODS_ONLY":return await this._handleModsOnly(e,t,l,s);case"MODS_WITH_INDEXDB":return await this._handleModsWithIndexDB(e,t,l,s);default:throw new Error("Error adding patient mode")}}catch(u){throw ge("Failed to move patient to ".concat(t)),u}}static async _handleApiOnly(e,t,l,s){const _=await this._addPatientToStageViaAPI(e,t,l,s);return K("Patient moved to ".concat(t)),_}static async _handleApiWithIndexDB(e,t,l,s){try{const _=await this._addPatientToStageViaAPI(e,t,l,s);return await this._storeInIndexDB(_),K("Patient moved to ".concat(t)),_}catch(_){return console.warn("API failed, falling back to IndexDB"),this._addPatientToStageOffline(e,t,l,s)}}static async _handleModsOnly(e,t,l,s){if(!await _e())throw new Error("MODS connection unavailable");const u=await this._addPatientToStageViaAPI(e,t,l,s);return K("Patient moved to ".concat(t," (MODS)")),u}static async _handleModsWithIndexDB(e,t,l,s){try{if(await _e()){const u=await this._addPatientToStageViaAPI(e,t,l,s);return await this._storeInIndexDB(u),K("Patient moved to ".concat(t)),u}throw new Error("MODS connection unavailable")}catch(_){return console.warn("MODS failed, falling back to IndexDB"),this._addPatientToStageOffline(e,t,l,s)}}static async movePatientToNextStage(e,t,l,s,_){return await this.safeDeactivateStages(e),this.addPatientToStage(e,l,s,_)}static async _addPatientToStageViaAPI(e,t,l,s){return(await super.postJson("/stages",{stage:{patient_id:e,stage:t,location_id:l,visit_id:s,arrivalTime:new Date().toISOString()}})).data}static async _addPatientToStageOffline(e,t,l,s){const _=new Date().toISOString(),u=oe(),{fullName:v}=await this._resolvePatientDetails(e,l),h={patient_id:e,visit_id:s,stage:t,location_id:l,arrivalTime:_,status:1,fullName:v,sync_status:"pending"};return await u.postData("ADD_STAGE",{storeName:se,data:h}),K("Patient queued for ".concat(t," (offline)")),h}static async _storeInIndexDB(e){if(!J.getUseIndexDBStatus())return;await oe().postData("ADD_STAGE",{storeName:pe,data:{...e,sync_status:"synced"}})}static async safeDeactivateStages(e){const t=this.getOperationMode();try{return t.includes("API")&&await super.patchJson("/stages/deactivate",{patientId:e}),(t.includes("INDEXDB")||t==="OFFLINE")&&await this._deactivateStagesOffline(e),1}catch(l){throw console.error("Deactivation failed:",l),l}}static async _deactivateStagesOffline(e){const t=oe(),l=new Date().toISOString();await t.postData("UPDATE_STAGE",{storeName:se,whereClause:{patient_id:e,status:1},data:{status:0,updated_at:l,sync_status:"pending"}}),await t.postData("UPDATE_STAGE",{storeName:pe,whereClause:{patient_id:e,status:1},data:{status:0,updated_at:l,sync_status:"pending"}})}static async getCurrentStage(e){var s;const t=this.getOperationMode();try{if(t.includes("API"))return(await super.getJson("/stages/current",{patientId:e})).stage}catch(_){console.warn("Online fetch failed, falling back to offline")}return((s=(await ee(se,{whereClause:{patient_id:e,status:1}}))[0])==null?void 0:s.stage)||null}static async _resolvePatientDetails(e,t){var h;const s=(await ee("patientRecords",{whereClause:{patientID:e}}))[0],_=s!=null&&s.personInformation?[s.personInformation.given_name,s.personInformation.family_name].filter(Boolean).join(" "):void 0,v=(h=(await ee("visits",{whereClause:{patientId:e,location_id:t}}))[0])==null?void 0:h.id;return{fullName:_,visit_id:v}}}const Ee=W({components:{IonItem:ke,IonCol:$,IonLabel:R},data(){return{iconsContent:Se}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(o){const e=document.getElementById(o+"_lbl");e&&(e.style.color="#006401"),this.highlightActionBtns(o)},undoHighlightItem(o){const e=document.getElementById(o+"_lbl");e&&(e.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(o)},highlightActionBtns(o){const e=document.getElementsByClassName(o+"_spanlbl");for(let t=0;t<e.length;t++)e[t].style.display="block"},undohighlightActionBtns(o){const e=document.getElementsByClassName(o+"_spanlbl");for(let t=0;t<e.length;t++)e[t].style.display="none"},asignLblID(o){return o+"_lbl"},asignSpanLblID(o){return o+"_spanlbl"},async removeItemAtIndex(o,e){await De("Do you want to delete it?",e)&&this.$emit("update:removeItem",o)},async editItemAtIndex(o,e,t){await we("Do you want to edit it?",t)&&this.$emit("update:editItem",{index:o,item:e})},fomartDate(o){const e=o.year,t=(o.month<10?"0":"")+o.month,l=(o.day<10?"0":"")+o.day;return e+"-"+t+"-"+l}}});function Te(o,e,t,l,s,_){const u=z("ion-label"),v=z("ion-col"),h=z("ion-icon"),S=z("ion-item");return g(!0),de(me,null,Ve(o.displayData,(f,d)=>(g(),D(S,{displayData:o.displayData,class:"ionLbltp",key:d,onMousemove:w=>o.highlightItem(d),onMouseout:w=>o.undoHighlightItem(d)},{default:r(()=>[c(v,{class:"col-st1"},{default:r(()=>[c(u,{id:o.asignLblID(d),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:r(()=>[H(N(f.type),1)]),_:2},1032,["id"])]),_:2},1024),c(v,{class:"col-st2"},{default:r(()=>[c(u,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:r(()=>[e[0]||(e[0]=B("span",{class:"spaceBetween"},null,-1)),H(" "+N(f.name)+" ",1),e[1]||(e[1]=B("span",{class:"spaceBetween"},null,-1)),H(N(f.reason),1),e[2]||(e[2]=B("span",{class:"spaceBetween"},null,-1)),H(N(o.fomartDate(f.date)),1)]),_:2,__:[0,1,2]},1024)]),_:2},1024),c(v,{class:"action_buttons"},{default:r(()=>[c(u,{class:fe(o.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:w=>o.editItemAtIndex(d,f,w)},{default:r(()=>[c(h,{icon:o.iconsContent.edit},null,8,["icon"])]),_:2},1032,["class","onClick"]),c(u,{class:fe(o.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:w=>o.removeItemAtIndex(d,w)},{default:r(()=>[c(h,{icon:o.iconsContent.delete},null,8,["icon"])]),_:2},1032,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const Ne=Z(Ee,[["render",Te],["__scopeId","data-v-4346bf77"]]),ye=W({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(o,{emit:e}){const t=n(),l=n({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),s=n(),_={name:"Now",show:!0,fn:F},u=n(!0),v=n(!1),h=n(0),S=o;q(()=>S.time_prop,k=>{k&&(t.value=k.time)},{immediate:!0,deep:!0});const f=e;function d(){f("timeUpDated",s.value)}function w(k){v.value==!0?(u.value=!1,v.value=!1):u.value=!0,l.value.isOpen=!0,l.value.event=k}function O(k){t.value=k.detail.value;const V=x(t.value);if(T(V)==!0){F();return}t.value=V}function T(k){return k.indexOf("NaN")!==-1}function x(k){let V=new Date(k),I=V.getHours(),M=V.getMinutes(),C=I>=12?"PM":"AM";I=I%12,I=I||12;let A=I.toString().padStart(2,"0")+":"+M.toString().padStart(2,"0")+" "+C;return s.value={time:A,meridian:C},d(),A}function F(){v.value=!0,t.value=x(new Date),u.value=!1,h.value++}return(k,V)=>{const I=z("ion-popover");return g(),de(me,null,[(g(),D(re,{placeholder:S.place_holder.default,inputValue:t.value,icon:i(Ae),"-inner-action-btn-propeties":_,"onClicked:inputValue":w,"onUpdate:InnerActionBtnPropetiesAction":_.fn,key:h.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),c(I,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":l.value.isOpen,event:l.value.event,side:"top",onDidDismiss:V[0]||(V[0]=M=>l.value.isOpen=!1)},{default:r(()=>[u.value?(g(),D(i(Be),{key:0,onIonChange:O,id:"datetime",presentation:"time","show-default-buttons":!0})):b("",!0)]),_:1},8,["is-open","event"])],64)}}});async function Pe(o={}){try{const{name:e="",page:t=1,page_size:l=10}=o,s=e?{name:"%".concat(e,"%")}:{};return(await ee("wards",{likeClause:s,currentPage:t,itemsPerPage:l}).then(u=>u.records)).map(u=>({name:u.name,value:u.name,other:u}))}catch(e){throw console.error("Error fetching offline wards:",e.message),e}}const He=W({name:"xxxComponent"}),Fe=W({...He,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(o,{emit:e}){const t=n([]),l=ae(),s=n(NaN),_=n(!1),u=n(),v=n(!1);te(async()=>{V(),O()});const h=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:I},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:X}],S=[{placeHolder:"Reason",dataHandler:F,dataValue:n(),show_error:n(!1),error_message:"please provide a reason"}],f=[{placeHolder:{default:"Enter date"},dataHandler:x,dataValue:n(),show_error:n(!1),error_message:"please provide date"}],d=[{placeHolder:{default:"Enter time of admission"},dataHandler:T,dataValue:n(),show_error:n(!1),error_message:"error"}],w=o;q(()=>w.selected_ward_prop,p=>{p&&(u.value=p)},{immediate:!0,deep:!0}),q(()=>w.admitted_other_props,p=>{p&&(S[0].dataValue.value=p.reason,d[0].dataValue.value=p.time,f[0].dataValue.value=p.date)},{immediate:!0,deep:!0});function O(p=!0){v.value=p}function T(p){d[0].dataValue.value=p,I(!1)}function x(p){const a={day:p.value.day,month:p.value.month,year:p.value.year,formattedDate:p.value.formattedDate};f[0].dataValue.value=a,I(!1)}function F(p){const a=p.target.value;S[0].dataValue.value=a,k(),O(!1)}function k(){v.value==!0&&Q("Remember to press the SAVE button",1e4)}async function V(p){(await Pe({name:"",page:1,page_size:1e3})).forEach(y=>{const P={name:y.name,selected:!1,other:y,location_ward_id:y.other.location_id};t.value.push(P)})}function I(p=!0){M(),C(),L(),j(),f[0].show_error.value==!1&&d[0].show_error.value==!1&&S[0].show_error.value==!1&&_.value==!1?A():p&&Q("Please enter correct data values",4e3)}function M(){u.value===void 0||u.value==""?_.value=!0:_.value=!1}function C(){S[0].dataValue.value==""||S[0].dataValue.value===void 0?S[0].show_error.value=!0:S[0].show_error.value=!1}async function A(){const p={name:u.value.name,type:"Admitted for short stay",date:f[0].dataValue,time:d[0].dataValue,reason:S[0].dataValue,other:u.value,selected:!0};await l.addOutcomeData(p,s.value)&&E({dataSaved:!1})}const m=e;function E(p={dataSaved:!0}){m("dataSaved",p)}function X(){E()}function L(){f[0].dataValue.value===void 0||f[0].dataValue.value==""?f[0].show_error.value=!0:f[0].show_error.value=!1}function j(){d[0].dataValue.value===void 0||f[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}const G=p=>{u.value=p,O(),I(!1)};return(p,a)=>(g(),D(i(le),null,{default:r(()=>[c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[c(i(ve),{modelValue:u.value,"onUpdate:modelValue":[a[0]||(a[0]=y=>u.value=y),a[1]||(a[1]=y=>G(y))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:a[2]||(a[2]=y=>y={}),"track-by":"location_ward_id",options:t.value},null,8,["modelValue","options"]),B("div",null,[_.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>a[3]||(a[3]=[H(N("Please select a ward"))])),_:1,__:[3]})):b("",!0)])]),_:1})]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[B("div",null,[c(ie,{place_holder:f[0].placeHolder,onDateUpDated:f[0].dataHandler,date_prop:f[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),B("div",null,[f[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(f[0].error_message),1)]),_:1})):b("",!0)])])]),_:1})]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[B("div",null,[c(ye,{place_holder:d[0].placeHolder,onTimeUpDated:d[0].dataHandler,time_prop:d[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),B("div",null,[d[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(d[0].error_message),1)]),_:1})):b("",!0)])])]),_:1})]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[c(re,{placeholder:S[0].placeHolder,icon:i(he),inputValue:S[0].dataValue.value,"onUpdate:inputValue":S[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),B("div",null,[S[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(S[0].error_message),1)]),_:1})):b("",!0)])]),_:1})]),_:1}),h[0].showAddItemButton?(g(),D(i(U),{key:0,class:"spc_btwn"},{default:r(()=>[h[0].addItemButton?(g(),D(Y,{key:0,name:h[0].name,fill:h[0].btnFill,icon:i(ue),"onClicked:btn":h[0].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0),h[1].addItemButton?(g(),D(Y,{key:1,name:h[1].name,fill:h[1].btnFill,icon:i(ce),"onClicked:btn":h[1].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0)]),_:1})):b("",!0)]),_:1}))}}),Ue=Z(Fe,[["__scopeId","data-v-5ab5c4cb"]]),xe=W({name:"xxxComponent"}),Me=W({...xe,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(o,{emit:e}){const t=n(NaN),l=n(null),s=ae(),_=n(!1),u=n([]),v=n({}),h=n(!0),S={location_data:{}},f=[{placeHolder:"Reason",dataHandler:x,dataValue:n(),show_error:n(!1),error_message:"please provide a reason"}],d=[{placeHolder:{default:"Enter date"},dataHandler:T,dataValue:n(),show_error:n(!1),error_message:"please provide date"}],w=[{placeHolder:{default:"Enter time of referral"},dataHandler:k,dataValue:n(),show_error:n(!1),error_message:"error"}],O=o;q(()=>O.selected_other_referral_data,a=>{a&&(f[0].dataValue.value=a.reason,d[0].dataValue.value=a.date,w[0].dataValue.value=a.time)},{immediate:!0,deep:!0}),q(()=>O.selected_referral_data,a=>{if(!a)return;l.value=a.selected_location,S.location_data=a;const y=Array.isArray(a.selected_district_ids)?[...a.selected_district_ids]:[],P=a.selected_location?{...a.selected_location}:null;u.value=y,v.value=P},{immediate:!0,deep:!0}),te(()=>{m()});function T(a){const y={day:a.value.day,month:a.value.month,year:a.value.year,formattedDate:a.value.formattedDate};d[0].dataValue.value=y,V(!1)}function x(a){const y=a.target.value;f[0].dataValue.value=y,F(),m(!1)}function F(){h.value==!0&&Q("Remember to press the SAVE button",1e4)}function k(a){w[0].dataValue.value=a,V(!1)}function V(a=!0){A(),I(),M(),C(),d[0].show_error.value==!1&&w[0].show_error.value==!1&&f[0].show_error.value==!1&&_.value==!1?X():a&&Q("Please enter correct data values",4e3)}function I(){f[0].dataValue.value==""||f[0].dataValue.value===void 0?f[0].show_error.value=!0:f[0].show_error.value=!1}function M(){d[0].dataValue.value===void 0||d[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}function C(){w[0].dataValue.value===void 0||d[0].dataValue.value==""?w[0].show_error.value=!0:w[0].show_error.value=!1}function A(){l.value?_.value=!1:_.value=!0}function m(a=!0){h.value=a}const E=a=>{l.value=a.selected_location,A(),S.location_data=a,m(),V(!1)},X=async()=>{const a={name:l.value.name,type:"Referred out",selected:!0,date:d[0].dataValue,time:w[0].dataValue,reason:f[0].dataValue},y={...a,other:{ref_data:a,location_data:S.location_data}};await s.addOutcomeData(y,t.value)&&G({dataSaved:!1})},L=()=>{G()},j=e;function G(a={dataSaved:!0}){j("dataSaved",a)}const p=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:V},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:L}];return(a,y)=>(g(),D(i(le),null,{default:r(()=>[c(i(U),null,{default:r(()=>[c(be,{show_error:_.value,onFacilitySelected:E,selected_district_ids:u.value,selected_location:v.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[B("div",null,[c(ie,{place_holder:d[0].placeHolder,onDateUpDated:d[0].dataHandler,date_prop:d[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),B("div",null,[d[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(d[0].error_message),1)]),_:1})):b("",!0)])])]),_:1})]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[B("div",null,[c(ye,{place_holder:w[0].placeHolder,onTimeUpDated:w[0].dataHandler,time_prop:w[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),B("div",null,[w[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(w[0].error_message),1)]),_:1})):b("",!0)])])]),_:1})]),_:1}),c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[c(re,{placeholder:f[0].placeHolder,icon:i(he),inputValue:f[0].dataValue.value,"onUpdate:inputValue":f[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),B("div",null,[f[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(f[0].error_message),1)]),_:1})):b("",!0)])]),_:1})]),_:1}),p[0].showAddItemButton?(g(),D(i(U),{key:0,class:"spc_btwn"},{default:r(()=>[p[0].addItemButton?(g(),D(Y,{key:0,name:p[0].name,fill:p[0].btnFill,icon:i(ue),"onClicked:btn":p[0].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0),p[1].addItemButton?(g(),D(Y,{key:1,name:p[1].name,fill:p[1].btnFill,icon:i(ce),"onClicked:btn":p[1].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0)]),_:1})):b("",!0)]),_:1}))}}),Le=Z(Me,[["__scopeId","data-v-0bd5d54b"]]),$e=W({name:"xxxComponent"}),Re=W({...$e,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(o,{emit:e}){const t=n(NaN),l=n([]),s=ae(),_=n();te(async()=>{T("")});const u=[{placeHolder:"Reason",dataHandler:f,dataValue:n(),show_error:n(!1),error_message:"please provide a reason"}],v=[{placeHolder:{default:"Enter date"},dataHandler:S,dataValue:n(),show_error:n(!1),error_message:"please provide date"}],h=o;q(()=>h.selected_discharged_prop,m=>{m&&(_.value=m)},{immediate:!0,deep:!0}),q(()=>h.selected_discharged_data,m=>{m&&(v[0].dataValue.value=m.date||"",m.reason&&(u[0].dataValue.value=m.reason))},{immediate:!0,deep:!0});function S(m){const E={day:m.value.day,month:m.value.month,year:m.value.year,formattedDate:m.value.formattedDate};v[0].dataValue.value=E,F(!1)}function f(m){const E=m.target.value;u[0].dataValue.value=E}l.value,n(!1),n(!1);const d=[{placeHolder:{default:"Enter time of referral"},dataHandler:w,dataValue:n(),show_error:n(!1),error_message:"error"}];function w(m){d[0].dataValue.value=m}const O=new Set;async function T(m){const E=m;(await Ie.getFacilities({name:E})).forEach(L=>{O.has(L.location_id)||(O.add(L.location_id),Oe.isEmpty(L.name)==!1&&l.value.push({name:L.name,selected:!1,other:L}))})}function x(m){l.value=m}function F(m=!0){k(),v[0].show_error.value?m&&Q("Please enter a valid date",4e3):V()}function k(){v[0].dataValue.value===void 0||v[0].dataValue.value==""?v[0].show_error.value=!0:v[0].show_error.value=!1}async function V(){const m={type:"Discharged Home",date:v[0].dataValue,reason:u[0].dataValue.value};await s.addOutcomeData(m,t.value)&&C({dataSaved:!1})}function I(){C()}const M=e;function C(m={dataSaved:!0}){M("dataSaved",m)}const A=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:F},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:I}];return(m,E)=>(g(),D(i(le),null,{default:r(()=>[c(i(U),null,{default:r(()=>[c(i($),null,{default:r(()=>[B("div",null,[c(ie,{place_holder:v[0].placeHolder,onDateUpDated:v[0].dataHandler,date_prop:v[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),B("div",null,[v[0].show_error.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>[H(N(v[0].error_message),1)]),_:1})):b("",!0)])])]),_:1})]),_:1}),A[0].showAddItemButton?(g(),D(i(U),{key:0,class:"spc_btwn"},{default:r(()=>[A[0].addItemButton?(g(),D(Y,{key:0,name:A[0].name,fill:A[0].btnFill,icon:i(ue),"onClicked:btn":A[0].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0),A[1].addItemButton?(g(),D(Y,{key:1,name:A[1].name,fill:A[1].btnFill,icon:i(ce),"onClicked:btn":A[1].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0)]),_:1})):b("",!0)]),_:1}))}}),We=Z(Re,[["__scopeId","data-v-2483ba45"]]),qe={class:"dash_box"},Ge={key:0,style:{"margin-top":"100px"}},Xe=W({name:"xxxComponent"}),ze=W({...Xe,setup(o){const e=n("No outcome created yet"),t=n(!1),l=n(!0),s=n(""),_=n(!0),u=n(!1),v=ae(),h=Ce(()=>v.outcomes),S=n(!1),f=n(!1),d=n(!1),w=n(!1),O=n(!1),T=n(),x=n(null),F=n(null),k=n(null),V=n(null),I=n(null),M=n(null),C=n([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]);function A(a){C.value.forEach(y=>{a.selected==!0&&(a.name==y.name||a.type==y.name)&&(s.value=y.name)})}te(async()=>{E()}),q(()=>s.value,async a=>{S.value==!0?S.value=!1:j()}),q(()=>h.value.length,async a=>{E()});function m(){C.value.forEach(a=>{a.selected=!1}),s.value=""}function E(){h.value.length>0?_.value=!1:h.value.length==0&&u.value==!1&&(_.value=!0)}function X(a){h.value.splice(a,1)}const L=a=>{X(a.index),A(a.item),x.value=a.item.other.location_data,F.value={reason:a.item.reason,date:a.item.date,time:a.item.time},k.value=a.item.other,V.value=a.item,a.item.type==="Discharged Home"&&(I.value=a.item,M.value={reason:a.item.reason,date:a.item.date})};async function j(a=!0){const y=s.value;s.value=y;const P=s.value;P==C.value[0].name?d.value=!0:d.value=!1,P==C.value[1].name?w.value=!0:w.value=!1,P==C.value[2].name?O.value=!0:O.value=!1}function G(){f.value=!1,d.value=!1,O.value=!1,w.value=!1,m()}const p=a=>{C.value.forEach(y=>{y.selected=!1}),T.value=a,T.value.selected=!0,A(T.value)};return(a,y)=>{const P=z("ion-row");return g(),D(i(le),null,{default:r(()=>[c(P,null,{default:r(()=>[c(i($),null,{default:r(()=>[(g(),D(Ne,{key:0,"onUpdate:removeItem":X,"onUpdate:editItem":L,displayData:h.value},null,8,["displayData"]))]),_:1})]),_:1}),_.value?(g(),D(P,{key:0},{default:r(()=>[B("span",qe,N(e.value),1)]),_:1})):b("",!0),c(P,null,{default:r(()=>[c(i($),null,{default:r(()=>[l.value?(g(),de("div",Ge,[c(P,null,{default:r(()=>[c(i(ve),{modelValue:T.value,"onUpdate:modelValue":[y[0]||(y[0]=ne=>T.value=ne),y[1]||(y[1]=ne=>p(ne))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:C.value},null,8,["modelValue","options"]),B("div",null,[t.value?(g(),D(i(R),{key:0,class:"error-label"},{default:r(()=>y[2]||(y[2]=[H(N("please select a type"))])),_:1,__:[2]})):b("",!0)])]),_:1})])):b("",!0)]),_:1})]),_:1}),d.value?(g(),D(Ue,{key:1,onDataSaved:G,selected_ward_prop:k.value,admitted_other_props:V.value},null,8,["selected_ward_prop","admitted_other_props"])):b("",!0),w.value?(g(),D(Le,{key:2,onDataSaved:G,selected_referral_data:x.value,selected_other_referral_data:F.value},null,8,["selected_referral_data","selected_other_referral_data"])):b("",!0),O.value?(g(),D(We,{key:3,onDataSaved:G,selected_discharged_prop:I.value,selected_discharged_data:M.value},null,8,["selected_discharged_prop","selected_discharged_data"])):b("",!0)]),_:1})}}}),Qe=Z(ze,[["__scopeId","data-v-6366419c"]]);export{Ue as A,Ne as D,Qe as O,Le as R,Ke as S,We as a};
