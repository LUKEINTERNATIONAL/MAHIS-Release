System.register(["./vendor-legacy-CmJYp7WG.js","./index-legacy-BRh3PXCW.js"],function(e,a){"use strict";var t,o,n,l,s,i,r,u,d,c,v,p,b,m,g,f,S,y,k,h,_,w,E,T,D,F;return{setters:[e=>{t=e.d,o=e.b2,n=e.r,l=e.c,s=e.a,i=e.E,r=e.e,u=e.f,d=e.k,c=e.l,v=e.z,p=e.u,b=e.G,m=e.A,g=e.F,f=e.L,S=e.B},e=>{y=e.u,k=e.as,h=e.t,_=e.a8,w=e.E,E=e.k,T=e.ay,D=e.H,F=e.i}],execute:function(){const a={class:"card-container"},N={class:"custom-card"},A={class:"ion-padding",slot:"content"},V={class:"table-responsive"};e("_",t({__name:"RiskAssessment",setup(e,{expose:t}){const R=y(),{patient:x}=o(R),B=n([]),O=n(F),H=["Substance","Answer","Date","Action"],j={responsive:!0,select:!1,layout:{topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},C=l(()=>[{componentType:"Heading",name:"Substance use / Consumption",position:"center"},{componentType:"radioButtonField",header:"Smoking",name:"Smoking history",grid:{s:"3"},obsValueType:"value_coded",options:[{label:"Smoking",value:"Smoking"},{label:"Never",value:"Never"},{label:"Stopped",value:"Stopped"}]},{grid:{s:"2"}},{componentType:"radioButtonField",header:"Drinking alcohol",name:"Does the patient drink alcohol?",grid:{s:"3"},obsValueType:"value_coded",options:[{label:"Drinking",value:"Drinking"},{label:"Never",value:"Never"},{label:"Stopped",value:"Stopped"}]}]),G=n(null),L=async()=>{var e;const a=await _.getObsByEncounterId(w.ASSESSMENT);if(!a||null==a||!a.obs||0===(null==a||null===(e=a.obs)||void 0===e?void 0:e.length))return[];B.value=await Promise.all(a.obs.map(async e=>[e.concept_name||"",await T.getConceptName(e.value_coded)||"",D.toStandardHisFormat(e.obs_datetime),`<button class="btn btn-outline-danger btn-sm delete-btn" data-id='${JSON.stringify(e)}'>\n                            ${O.value.delete2}</button>`]))};return s(async()=>{await L()}),t({validateForm:()=>{var e;return null===(e=G.value)||void 0===e?void 0:e.validateForm()},onSubmit:async()=>{if(!G.value)return void console.error("Form reference is not available");const e=G.value.getFormValues();if(!e["Smoking history"]||!e["Does the patient drink alcohol?"])return void h("Risk assessment not saved");const a=await _.buildObsValuesWithEncounterType(e,w.ASSESSMENT);await _.buildSaveObs([a]),G.value.resetForm(),E("Risk assessment saved successful"),L()}}),(e,t)=>{const o=i("ion-label"),n=i("DataTable"),l=i("ion-accordion"),s=i("ion-accordion-group"),y=i("ion-row");return u(),r(g,null,[d("div",a,[d("div",N,[c(k,{formData:C.value,ref_key:"formRef",ref:G},null,8,["formData"])])]),c(y,null,{default:v(()=>[c(s,{ref:"accordionGroup",class:"previousView"},{default:v(()=>[c(l,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:v(()=>[c(p(b),{slot:"header",color:"light"},{default:v(()=>[c(o,{class:"previousLabel"},{default:v(()=>t[0]||(t[0]=[m("Previous Visits")])),_:1,__:[0]})]),_:1}),d("div",A,[d("div",V,[c(n,{ref:"dataTableRef",options:j,data:B.value,class:"display nowrap modern-table",width:"100%"},{default:v(()=>[d("thead",null,[d("tr",null,[(u(),r(g,null,f(H,e=>d("th",{key:e},S(e),1)),64))])])]),_:1},8,["data"])])])]),_:1})]),_:1},512)]),_:1})],64)}}}))}}});
