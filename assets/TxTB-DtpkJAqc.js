import{l as p}from"./report_service-ByZpHQux.js";import{t as u,f as b,b as D,c as R}from"./index-EBUpS4L5.js";import{a as E,c as F}from"./tx_report_service-DTMrrHbP.js";import{d as v,r as d,E as A,f as B}from"./vendor-BZmhsiOO.js";import"./lodash-Dt8AsbQm.js";import"./apexcharts-qhsxYq_s.js";import"./chartjs-DNDlIUTq.js";import"./barcode-qrcode-reader-B_Xr9wLp.js";import"./age_groups-BkW1n_F5.js";const C=v({__name:"TxTB",setup(x){const s=d("-"),l=d([]),o=new E,m=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:u},...b(F)];function f(e){const t={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return Object.entries(e).forEach(([r,a])=>{r!=="Unknown"&&Object.entries(a).forEach(([_,g])=>{const n=_;t[n].rows.push({ageGroup:r,gender:n,...g}),Object.entries(g).forEach(([i,T])=>{var c;t[n].aggregate[i]=[...(c=t[n].aggregate[i])!=null?c:[],...T]})})}),t}async function w({dateRange:e},t){try{await p.show(),o.setStartDate(e.startDate),o.setEndDate(e.endDate),s.value=o.getDateIntervalPeriod();const r=await o.getTxTbReport(t),a=f(r);l.value=[...a.F.rows,...a.M.rows,{ageGroup:"All",gender:"Male",...a.M.aggregate},...await o.buildMaternityAgreggateRows(a.F.aggregate)]}catch(r){R("ERROR! Unable to load report data"),console.error(r)}await p.hide()}function h(e){return"".concat(e.column.label," | ").concat(e.row.ageGroup," | ").concat(u(e.row.gender),"s")}return(e,t)=>(B(),A(D,{title:"PEPFAR TX TB Report","report-type":"PEPFAR",columns:m,rows:l.value,period:s.value,"drill-title":h,useDateRangeFilter:"",showIndices:"",onGenerate:w},null,8,["rows","period"]))}});export{C as default};
