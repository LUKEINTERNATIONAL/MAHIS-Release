!function(){function e(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}System.register(["./vendor-legacy-B___aDYJ.js","./lodash-legacy-pOOc9Efu.js","./index-legacy-bIC3wV2f.js","./Export-legacy-BhFfdsKR.js"],function(t,i){"use strict";var n,a,o,r,s,l,u,d,c,h,p,m,f,g,v,y,b,F,w,T,D,I,_,P,S,x,C,E,k,R,N,A,H,V,$,M,B,O,L,j,U,Y,q,G,z,W,Q,J,K,Z,X,ee,te,ie,ne,ae,oe,re,se,le,ue,de,ce,he,pe,me,fe,ge,ve,ye,be;return{setters:[e=>{n=e.eb,a=e.d,o=e.ec,r=e.ed,s=e.bD,l=e.bC,u=e.ee,d=e.I,c=e.W,h=e.E,p=e.e,m=e.f,f=e.k,g=e.m,v=e.F,y=e.L,b=e.p,F=e.a7,w=e.A,T=e.y,D=e.B,I=e.l,_=e.bx,P=e.z,S=e.j,x=e.ai,C=e.aj,E=e.bp,k=e.T,R=e.S,N=e.U,A=e.V,H=e.ah,V=e.an,$=e.aR,M=e.cj,B=e.X,O=e._,L=e.c7,j=e.co,U=e.a3,Y=e.ef,q=e.bO,G=e.i,z=e.v,W=e.ab,Q=e.G,J=e.r,K=e.w,Z=e.cd,X=e.O,ee=e.bz},e=>{te=e.l},e=>{ie=e.S,ne=e.au,ae=e.by,oe=e.H,re=e.bz,se=e.bA,le=e.m,ue=e.bB,de=e._,ce=e.t,he=e.aa,pe=e.bC,me=e.bD,fe=e.bE,ge=e.bF,ve=e.P},e=>{ye=e.t,be=e.a}],execute:function(){var Fe=document.createElement("style");Fe.textContent=".no-data-section[data-v-38e5dc7d]{text-align:center;font-weight:700;font-size:1em;color:#858585}a[data-v-38e5dc7d]{text-decoration:none;font-weight:600;font-size:1em}.report-table-top[data-v-38e5dc7d]{padding:1rem;position:relative;width:100%}.report-table[data-v-38e5dc7d]{width:100%;position:relative;text-align:left;font-size:.8em}.stick-report-header[data-v-38e5dc7d]{background:#fff;position:sticky;top:0;z-index:1000}table[data-v-38e5dc7d]{width:100%;border-collapse:unset}th[data-v-38e5dc7d]{background:#3880ff;color:#fff;padding:.5em;font-size:1.2em}th[data-v-38e5dc7d],td[data-v-38e5dc7d]{width:3%;border-collapse:collapse;text-align:center}td[data-v-38e5dc7d]{border-bottom:1px solid rgb(165,165,165);padding:.5em;font-weight:500;font-size:1.3em}tr[data-v-38e5dc7d]:nth-child(2n){background-color:#f0f0f0}.tool-bar-medium-card[data-v-19f0802a]{height:100%}.col[data-v-19f0802a]{margin:0;padding:0;text-align:left}.half[data-v-b4da23b3]{height:53vh!important}.half .view-port-content[data-v-b4da23b3]{height:86%}@keyframes placeHolderShimmer-e764537f{0%{background-position:-468px 0}to{background-position:468px 0}}.linear-background[data-v-e764537f]{animation-duration:1s;animation-fill-mode:forwards;animation-iteration-count:infinite;animation-name:placeHolderShimmer-e764537f;animation-timing-function:linear;background:linear-gradient(to right,#eee 8%,#ddd 18%,#eee 33%);background-size:1000px 104px;height:10vh;position:relative;overflow:hidden}.inter-draw[data-v-e764537f]{background:#fff;width:100%;height:100px;position:absolute;top:100px}.inter-right--top[data-v-e764537f]{background:#fff;width:100%;height:20px;position:absolute;top:20px;left:100px}.inter-right--bottom[data-v-e764537f]{background:#fff;width:100%;height:50px;position:absolute;top:60px;left:100px}.inter-crop[data-v-e764537f]{background:#fff;width:20px;height:100%;position:absolute;top:0;left:100px}.reset_button[data-v-7bf42b5b]{height:5vh}.input_display[data-v-7bf42b5b]{text-align:left;font-size:var(--his-sm-font-size);width:30vw;height:5vh;margin-bottom:2%;border:solid 1px #9d9b9b;border-radius:5px;padding:9px;margin-top:2%}\n/*$vite$:1*/",document.head.appendChild(Fe),t("b",Ie);const we=t("L",{one:"AL 1",two:"AL 2",three:"AL 3",four:"LA 4"});t("N",["Diabetes","Hypertension","Stroke","Suspected cancer","Confirmed cancer","Palliative cancer","Asthma","Depression","Acute psychosis","Chronic psychosis","Epilepsy"]),t("M",["Organic mental disorder (Chronic)","Organic mental disorder (acute)","Alcohol use mental disorder","Drug use mental disorder","Schizophrenia","Acute and transient psychotic disorder","Schizo-affective disorder","Mood-affective disorder (MANIC)","Mood-affective disorder (BIPOLAR)","Mood-affective disorder (DEPRESSION)","Anxiety disorder","Stress reaction adjustment disorder","Dissociative conversion disorder","Somatoform disorder","Puerperal mental disorder","Personality/Behaviour disorder","Mental retardation","Psychological mental disorder","Hyperkinetic conduct disorder","Epilepsy"]);class Te extends ie{constructor(){super(),e(this,"programID",void 0),e(this,"startDate",void 0),e(this,"endDate",void 0),e(this,"date",void 0),e(this,"epiweek",void 0),this.endDate="",this.startDate="",this.epiweek="",this.date=ie.getSessionDate(),this.programID=ie.getProgramID()}getPatientsWithNIDs(){return this.getReport("with_nids")}getClinicRegistrations(){return this.getReport("registration")}getAttendance(){return this.getReport(`programs/${this.programID}/reports/attendance`)}getDrugs(){const e=`programs/${this.programID}/reports/drug`;return ie.getJson(e,{start_date:this.startDate,end_date:this.endDate,date:this.date})}getDiagnosis(){const e=`programs/${this.programID}/reports/diagnosis`;return ie.getJson(e,{start_date:this.startDate,end_date:this.endDate,date:this.date})}getDiagnosisByAddress(){return this.getReport("diagnosis_by_address")}getLaPrescriptions(){const e=`programs/${this.programID}/reports/la_prescriptions`;return ie.getJson(e,{start_date:this.startDate,end_date:this.endDate})}getMalariaReport(){const e=`programs/${this.programID}/reports/malaria_report`;return ie.getJson(e,{start_date:this.startDate,end_date:this.endDate,date:this.date})}printLaReport(e){const t=new ne,i=`programs/${this.programID}/barcodes/la_report`,n={"date[start]":this.startDate,"date[end]":this.endDate};return Object.keys(we).forEach((t,i)=>{i++,n[`${i}[prescription]`]=e[`total_la_${t}_prescribed_drugs`],n[`${i}[dispensed]`]=e[`total_la_${t}_dispensed_drugs`]}),t.printLbl(`${i}?${ae.parameterizeObjToString(n)}`)}getDateIntervalPeriod(){return`${oe.toStandardHisDisplayFormat(this.startDate)} - ${oe.toStandardHisDisplayFormat(this.endDate)}`}setStartDate(e){this.startDate=e}setEndDate(e){this.endDate=e}setEpiWeek(e){this.epiweek=e}getReportPeriod(){return this.startDate&&this.endDate?`${oe.toStandardHisDisplayFormat(this.startDate)} - ${oe.toStandardHisDisplayFormat(this.endDate)}`:"-"}getReport(e,t={}){return ie.getJson(e,this.buildRequest(t))}buildRequest(e={}){const t={date:this.date,program_id:this.programID};return this.startDate&&this.endDate&&(t.start_date=this.startDate,t.end_date=this.endDate),this.epiweek&&(t.epiweek=this.epiweek),{...t,...e}}static getReportQuarters(e=4){const t=[];let i=oe.getCurrentYear();for(let n=0;n<e;++n)t.push({name:`Q4 ${i}`,start:`${i}-10-01`,end:`${i}-12-31`}),t.push({name:`Q3 ${i}`,start:`${i}-07-01`,end:`${i}-09-30`}),t.push({name:`Q2 ${i}`,start:`${i}-04-01`,end:`${i}-06-30`}),t.push({name:`Q1 ${i}`,start:`${i}-01-01`,end:`${i}-03-31`}),--i;return t}}function De(e){return"string"!=typeof e?e:se(e).replace(/,/gi," ").trim()}function Ie(e,t,i=""){const n=[],a=[],o=e=>"csvMode"===i&&"csvExportable"in e?e.csvExportable||!1:"pdfMode"===i&&"pdfExportable"in e?null==e.pdfExportable||e.pdfExportable:("ignorePDFColumnexport"!==i||!("pdfExportable"in e)||!e.pdfExportable)&&("exportable"in e?e.exportable||!1:void 0);for(const r in t){const i=[];t[r].forEach((t,n)=>{const a=e[e.length-1][n];o(a)&&i.push(t.value?De(t.value):De(t.td))}),n.push(i)}for(const r in e){const t=[];e[r].forEach(e=>{o(e)&&t.push(e.value?De(e.value):De(e.th))}),te.isEmpty(t)||a.push(t)}return{columns:a,rows:n}}function _e(e){const t={th:()=>e.th?e.th:"",td:()=>e.td?e.td:"",value:()=>e.value?e.value:"",sortValue:()=>e.sortValue?e.sortValue:0,type:()=>e.type?e.type:"string",exportable:()=>!("exportable"in e)||e.exportable,csvExportable:()=>!("csvExportable"in e)||e.csvExportable,pdfExportable:()=>"pdfExportable"in e?e.pdfExportable:void 0,sortable:()=>!("sortable"in e)||e.sortable,colspan:()=>e.colspan?e.colspan:0,cssClass:()=>e.cssClass?e.cssClass:0,style:()=>e.style?e.style:0,ascSort:()=>e.ascSort?e.ascSort:(e,t)=>n(t).asc(t=>{var i,n;return(null===(i=t[e])||void 0===i?void 0:i.sortValue)||(null===(n=t[e])||void 0===n?void 0:n.td)}),descSort:()=>e.descSort?e.descSort:(e,t)=>n(t).desc(t=>{var i,n;return(null===(i=t[e])||void 0===i?void 0:i.sortValue)||(null===(n=t[e])||void 0===n?void 0:n.td)})},i={};for(const n in t)i[n]=t[n]();return i}t("O",Te);const Pe=t("t",{thTxt:function(e,t={}){const i=t;return i.th=e,i.type="string",_e(i)},thNum:function(e,t={}){const i=t;return i.th=e,i.type="number",_e(i)},thDate:function(e,t={}){const i=t;return i.th=e,i.type="date",_e(i)},tdNum:function(e,t={}){const i={...t};return i.td=re(e),i.sortValue=parseInt(`${e}`),i.style={textAlign:"right",paddingRight:".5rem",...i.style},_e(i)},td:function(e,t={}){return{td:e,...t}},tdBtn:function(e,t,i={},n=""){const a={td:e,event:{click:t,color:n,obj:"button"}};return i.event&&(a.event={...a.event,...i.event},delete i.event),Object.assign(a,i)},tdDate:function(e,t={}){const i=t;return i.td=e?oe.toStandardHisDisplayFormat(e):"",_e(i)},tdLink:function(e,t,i={}){return{td:e,event:{click:t,obj:"link"},...i}}}),Se=a({emits:["onActiveRows","onActiveColumns","onPagination","onIsLoading","onTableRows"],components:{IonButton:c,IonIcon:d,IonSkeletonText:u},props:{config:{type:Object,default:()=>({})},columns:{type:Object,required:!0},rows:{type:Array,default:()=>[]},newPage:{type:Number},rowsPerPage:{type:Number},asyncRows:{type:Function},asyncRowParser:{type:Function},rowParser:{type:Function},searchFilter:{type:String},showFilters:{type:Boolean,default:!1},paginated:{type:Boolean,default:!1}},data:()=>({arrowUp:l,arrowDown:s,caretBack:r,caretForward:o,sortedIndex:-1,sortOrder:"descSort",tableColumns:[],tableRows:[],paginatedRows:[],activeRows:[],currentPage:0,itemsPerPage:20,isLoading:!1,errorMessage:""}),watch:{isLoading:{handler(e){"boolean"==typeof e&&this.$emit("onIsLoading",e)},immediate:!0},newPage:{handler(e){"number"==typeof e&&this.onChangePage(e)},immediate:!0},rowsPerPage:{handler(e){"number"==typeof e&&(this.itemsPerPage=e)},immediate:!0},async itemsPerPage(e){te.isEmpty(this.tableRows)||(this.currentPage=0,await ue(100),this.paginateTableRows(e),await this.setPage(this.currentPage))},tableRows:{handler(e){te.isEmpty(e)||this.$emit("onTableRows",e)},immediate:!0,deep:!0},searchFilter(e){e?this.activeRows=this.searchDataSet(e,this.tableRows):this.paginated?this.setPage(this.currentPage):this.activeRows=this.tableRows},activeRows:{handler(e){this.$emit("onActiveRows",e)},immediate:!0,deep:!0},columns:{handler(e){if(!te.isEmpty(e)){if(this.showIndex()){const e=[...this.columns],t=this.columns.length-1;e[t]=[Pe.thNum("#"),...e[t]],this.tableColumns=e}else this.tableColumns=e;this.$emit("onActiveColumns",this.tableColumns)}},immediate:!0,deep:!0},asyncRows:{async handler(e){if(this.errorMessage="","function"==typeof e){this.isLoading=!0;try{this.tableRows=this.addColumnIndexes(await e()),this.paginated?(this.paginateTableRows(),await this.setPage(0)):this.activeRows=this.tableRows}catch(t){this.errorMessage=`${t}`,le(`${t}`),console.error(t)}this.isLoading=!1}},immediate:!0,deep:!0},rows:{async handler(e){if(this.errorMessage="",!e||te.isEmpty(e))return this.activeRows=[],void(this.tableRows=[]);this.tableRows=this.addColumnIndexes(e),this.paginated?(this.paginateTableRows(),await this.setPage(0)):this.activeRows=this.tableRows},immediate:!0,deep:!0}},methods:{showIndex(){return!(!this.config||!("showIndex"in this.config))&&this.config.showIndex},addColumnIndexes(e){return this.showIndex()?e.map((e,t)=>{const i=[Pe.td(t+1)];return Array.isArray(e)?i.concat(e):[...i,e]}):e},paginateTableRows(e=0){this.paginatedRows=te.chunk(this.tableRows,e||this.itemsPerPage),this.$emit("onPagination",this.paginatedRows)},async setPage(e){this.activeRows=[];const t=this.paginatedRows[e];if(t){try{if("function"==typeof this.asyncRowParser){this.activeRows=t;for(const e in t)this.activeRows[e]=await this.asyncRowParser(t[e])}else this.isLoading=!0,this.activeRows="function"==typeof this.rowParser?await this.rowParser(t):t}catch(i){le(`${i}`),this.errorMessage=`${i}`,console.error(i)}this.isLoading=!1}},async sort(e,t){this.showIndex()&&"function"==typeof this.rowParser&&0!=e||(e===this.sortedIndex?this.sortOrder="ascSort"===this.sortOrder?"descSort":"ascSort":this.sortOrder="ascSort",this.sortedIndex=e,this.sortOrder in t&&(this.paginated?(this.tableRows=t[this.sortOrder](e,this.tableRows),this.paginateTableRows(),await this.setPage(this.currentPage)):this.activeRows=t[this.sortOrder](e,this.tableRows)))},searchDataSet:(e,t)=>t.filter(t=>{var i;const n=null===(i=JSON.stringify(t).match(/"td":"(.*?)"/g))||void 0===i?void 0:i.join(" ").replace(/"td":|"/g,"");return(null==n?void 0:n.match(new RegExp(e,"i")))||!1}),async onChangePage(e){this.currentPage=e,await this.setPage(e)}},computed:{noData(){return!this.isLoading&&te.isEmpty(this.activeRows)},columnLength(){try{return this.tableColumns[0].length}catch(e){return console.warn(e),5}},skeletonRows(){const e=[],t=this.config.skeletonTextRows?this.config.skeletonTextRows:10;for(let i=0;i<t;++i)e.push(i);return e}}}),xe={key:0,class:"stick-report-header"},Ce=["colspan","onClick"],Ee={key:1},ke=["colspan"],Re={key:2},Ne=["colspan"],Ae={key:0},He=["onClick"],Ve={key:1},$e={key:0,class:"no-data-section vertically-align"},Me={key:0},Be={key:1};const Oe=t("H",de(Se,[["render",function(e,t,i,n,a,o){const r=h("ion-icon"),s=h("ion-skeleton-text"),l=h("ion-button");return m(),p(v,null,[f("table",{class:b(["report-table",e.config.tableCssTheme||""])},[e.tableColumns?(m(),p("thead",xe,[(m(!0),p(v,null,y(e.tableColumns,(t,i)=>(m(),p("tr",{key:i},[(m(!0),p(v,null,y(t,(t,n)=>(m(),p("th",{key:n,colspan:t.colspan||0,onClick:i=>e.sort(n,t),style:F(t.style),class:b(t.cssClass)},[w(D(t.th)+" ",1),e.sortedIndex===n&&t.sortable&&i+1===e.tableColumns.length?(m(),T(r,{key:0,icon:"ascSort"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):g("",!0)],14,Ce))),128))]))),128))])):g("",!0),e.isLoading?(m(),p("tbody",Ee,[(m(!0),p(v,null,y(e.skeletonRows,(t,i)=>(m(),p("tr",{key:i},[f("td",{colspan:e.columnLength},[I(s,{animated:"",style:{width:"100%",height:"30px"}})],8,ke)]))),128))])):g("",!0),e.noData?g("",!0):(m(),p("tbody",Re,[(m(!0),p(v,null,y(e.activeRows,(e,t)=>(m(),p("tr",{key:t},[(m(!0),p(v,null,y(e,(e,t)=>{var i,n,a;return m(),p("td",{key:t,colspan:e.colspan||0,class:b(e.cssClass),style:F(e.style)},[e.event?(m(),p("div",Ae,["link"===(null==e||null===(i=e.event)||void 0===i?void 0:i.obj)?(m(),p("a",{key:0,href:"#",class:b(["his-sm-text",e.cssClass]),style:F(e.style),onClick:_(t=>e.event.click(),["prevent"])},D(e.td),15,He)):g("",!0),"button"===e.event.obj?(m(),T(l,{key:1,color:(null==e||null===(n=e.event)||void 0===n?void 0:n.color)||"",class:b(e.cssClass),style:F(e.style),disabled:null!=(null==e||null===(a=e.event)||void 0===a?void 0:a.disabled)&&!0===e.event.disabled,onClick:t=>e.event.click()},{default:P(()=>[w(D(e.td),1)]),_:2},1032,["color","class","style","disabled","onClick"])):g("",!0)])):(m(),p("div",Ve,[I(r,{class:"his-sm-text",slot:"start","aria-hidden":"true",icon:e.td},null,8,["icon"])]))],14,Ne)}),128))]))),128))]))],2),e.noData?(m(),p("h1",$e,[e.errorMessage?(m(),p("span",Me,D(e.errorMessage),1)):(m(),p("span",Be," No data available in table "))])):g("",!0)],64)}],["__scopeId","data-v-38e5dc7d"]])),Le=(e,t,i)=>{const n=e[t];return n?"function"==typeof n?n():Promise.resolve(n):new Promise((e,n)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==i?". Note that variables only represent file names one level deep.":""))))})};var je=(e=>(e.TT_LINKAGE_CODE="LinkageCodeInput",e.TT_MULTI_SELECT_GRID="HisMultiSelectGrid",e.TT_AGE_INPUT="HisAgeInput",e.TT_GROUP_SELECTOR="HisGroupSelector",e.TT_DATA_TABLE="HisDataTable",e.TT_GRID_SELECTOR="HisGridSelector",e.TT_NOTE="HisNote",e.TT_BARCODE="HisBarcodeInput",e.TT_MONTHLY_DAYS="HisMonthlyDays",e.TT_TEXT="HisTextInput",e.TT_NUMBER="HisNumberInput",e.TT_DATETIME="datetime",e.TT_SELECT="HisSelect",e.TT_MULTIPLE_SELECT="HisMultipleSelect",e.TT_ART_REGIMEN_SELECTION="HisArtRegimenSelection",e.TT_NEXT_VISIT_INTERVAL_SELECTION="HisNextVisitInterval",e.TT_TABLE_VIEWER="HisTableViewer",e.TT_DOSAGE_INPUT="HisDosageInput",e.TT_YES_NO="YesNoSelect",e.TT_MULTIPLE_YES_NO="MultiYesNoSelect",e.TT_SUMMARY="HisSummary",e.TT_WEIGHT_CHART="HisWeightChart",e.TT_VITALS_ENTRY="HisVitalsEntry",e.TT_ADHERENCE_INPUT="HisAdherenceInput",e.TT_ART_STAGING_SUMMARY="ArtStagingSummary",e.TT_LAB_ORDERS="HisLabOrders",e.TT_APPOINTMENTS_ENTRY="HisAppointments",e.TT_DISPENSATION_INPUT="DrugDispensationSelection",e.TT_PROGRAM_SELECTION="ProgramSelection",e.TT_DATE_PICKER="HisDatePicker",e.TT_PERSON_RESULT_VIEW="PersonSearchView",e.TT_RELATION_SELECTION="RelationsSelection",e.TT_FILING_NUMBER_VIEW="FilingNumberView",e.TT_CARD_SELECTOR="HisCardSelector",e.TT_PERSON_MATCH_VIEW="PersonMatchView",e.TT_FULL_DATE="HisDateInput",e.TT_BATCH_ENTRY="HisBatchEntry",e.TT_BATCH_VERIFICATION="HisBatchVerification",e.TT_BATCH_MOVEMENT="HisBatchMovement",e.TT_COMPLAINTS_PICKER="HisComplaintsPicker",e.TT_RADIOLOGY_PICKER="HisRadiologyPicker",e.TT_IP_ADDRESS="HisIPAddress",e.TT_TEXT_BANNER="HisTextBanner",e.TT_DRUG_DISPENSER="GeneralDrugDispenser",e.TT_CLINIC_HOLIDAY_PICKER="HisClinicHolidayPicker",e.TT_ANC_PREGNANCY_INPUT_CONFIG="AncPregnancyInfoConfig",e.TT_ANC_PREGNANCY_DETAILS_INPUT="AncPregnancyDetailsInput",e.TT_ANC_LMP_DATE_INPUT="AncLmpDateInput",e.TT_ANC_DRUGSET_INPUT="AncDrugSetInput",e.TT_DRUG_TRANSFER_IN="DrugTransferInput",e.TT_PRESCRIPTION_INPUT="HisPrescriptionInput",e.TT_INFINITE_SCROLL_MULTIPLE_SELECT="HisInfiniteScrollMultipleSelect",e))(je||{});const Ue=["LinkageCodeInput","HisMultiSelectGrid","HisAgeInput","HisBarcodeInput","HisNote","HisSelect","HisCardSelector","HisMultipleSelect","HisTextInput","HisNumberInput","HisMonthlyDays","HisArtRegimenSelection","HisNextVisitInterval","HisTableViewer","HisDosageInput","YesNoSelect","MultiYesNoSelect","HisWeightChart","HisVitalsEntry","HisAppointments","HisComplaintsPicker","HisClinicHolidayPicker","HisSummary","ArtStagingSummary","HisAdherenceInput","HisLabOrders","PersonSearchView","ProgramSelection","HisDatePicker","RelationsSelection","FilingNumberView","PersonMatchView","HisDateInput","HisBatchEntry","HisBatchVerification","HisBatchMovement","HisIPAddress","HisTextBanner","DrugDispensationSelection","HisDataTable","HisGroupSelector","AncPregnancyInfoConfig","AncPregnancyDetailsInput","AncLmpDateInput","DrugTransferInput","HisGridSelector","AncDrugSetInput","HisRadiologyPicker","HisPrescriptionInput","HisInfiniteScrollMultipleSelect","GeneralDrugDispenser"],Ye=a({name:"ToolBarMediumCard"}),qe={class:"tool-bar-medium-card"};const Ge=de(Ye,[["render",function(e,t,i,n,a,o){return m(),p("div",qe,[S(e.$slots,"default")])}]]);const ze=t("T",{convertArrayToTurples:function(e,t=2){return e.reduce((i,n,a)=>(a%t===0&&i.push(e.slice(a,a+t)),i),[])},orderObj:function(e,t){return Object.keys(e).sort((e,i)=>t(e,i)).reduce((t,i)=>(t[i]=e[i],t),{})}}),We=a({name:"HisResultCard",components:{ToolBarMediumCard:Ge,IonGrid:E,IonCol:C,IonRow:x},props:{items:{type:Object,required:!0}},computed:{rowItems(){return ze.convertArrayToTurples(this.items,2)}}});const Qe=de(We,[["render",function(e,t,i,n,a,o){const r=h("ion-col"),s=h("ion-row"),l=h("ion-grid"),u=h("tool-bar-medium-card");return m(),T(u,null,{default:P(()=>[I(l,null,{default:P(()=>[(m(!0),p(v,null,y(e.rowItems,(e,t)=>(m(),T(s,{key:t},{default:P(()=>[(m(!0),p(v,null,y(e,(e,t)=>(m(),T(r,{class:"col his-sm-text",key:t},{default:P(()=>[f("b",null,D(e.label)+":",1),w(" "+D(e.value),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})}],["__scopeId","data-v-19f0802a"]]),Je=a({name:"ViewPort",props:{showFull:{type:Boolean,default:()=>!0}}});const Ke=t("V",de(Je,[["render",function(e,t,i,n,a,o){return m(),p("div",{id:"view-port",class:b(e.showFull?"":"half")},[S(e.$slots,"default",{},void 0,!0)],2)}],["__scopeId","data-v-b4da23b3"]])),Ze=a({components:{ViewPort:Ke}});const Xe=de(Ze,[["render",function(e,t,i,n,a,o){const r=h("view-port");return m(),T(r,null,{default:P(()=>t[0]||(t[0]=[f("div",{class:"linear-background"},[f("div",{class:"inter-draw"}),f("div",{class:"inter-crop"}),f("div",{class:"inter-right--top"}),f("div",{class:"inter-right--bottom"})],-1)])),_:1,__:[0]})}],["__scopeId","data-v-e764537f"]]),et=a({components:{ViewPort:Ke}});const tt=de(et,[["render",function(e,t,i,n,a,o){const r=h("view-port");return m(),T(r,null,{default:P(()=>t[0]||(t[0]=[f("div",{class:"vertically-align"}," Error Loading form element. Exit app and try again and check your network. ",-1)])),_:1,__:[0]})}]]);const it=a({name:"TouchscreenForm",components:{InfoCard:Qe,IonButtons:$,IonPage:V,IonContent:H,IonFooter:A,IonToolbar:N,IonButton:c,IonHeader:R,IonTitle:k,IonCol:C,IonRow:x,...function(){const e={};return Ue.forEach(t=>{e[t]=j({loader:()=>Le(Object.assign({"../FormElements/BaseTextInput.vue":()=>U(()=>i.import("./BaseTextInput-legacy-lnyGfeb_.js"),void 0,i.meta.url),"../FormElements/FieldMixin.vue":()=>U(()=>i.import("./FieldMixin-legacy-NENBfoln.js"),void 0,i.meta.url),"../FormElements/FilingNumberView.vue":()=>U(()=>i.import("./FilingNumberView-legacy-DlJ4BOiC.js"),void 0,i.meta.url),"../FormElements/HisArtRegimenSelection.vue":()=>U(()=>i.import("./HisArtRegimenSelection-legacy-2VzWdsc-.js"),void 0,i.meta.url),"../FormElements/HisCardSelector.vue":()=>U(()=>i.import("./HisCardSelector-legacy-C-e6sTIh.js"),void 0,i.meta.url),"../FormElements/HisComplaintsPicker.vue":()=>U(()=>i.import("./HisComplaintsPicker-legacy-DqxpHneL.js"),void 0,i.meta.url),"../FormElements/HisDataTable.vue":()=>U(()=>i.import("./HisDataTable-legacy-BbdbOHYw.js"),void 0,i.meta.url),"../FormElements/HisDateInput.vue":()=>U(()=>i.import("./HisDateInput-legacy-B3LiJAHN.js"),void 0,i.meta.url),"../FormElements/HisInfiniteScrollMultipleSelect.vue":()=>U(()=>i.import("./HisInfiniteScrollMultipleSelect-legacy-BiPxx4QG.js"),void 0,i.meta.url),"../FormElements/HisMonthlyDays.vue":()=>U(()=>i.import("./HisMonthlyDays-legacy-CnhCGJSa.js"),void 0,i.meta.url),"../FormElements/HisMultiSelectGrid.vue":()=>U(()=>i.import("./HisMultiSelectGrid-legacy-DsNL_GXW.js"),void 0,i.meta.url),"../FormElements/HisNextVisitInterval.vue":()=>U(()=>i.import("./HisNextVisitInterval-legacy-DofQQ9fK.js"),void 0,i.meta.url),"../FormElements/HisNumberInput.vue":()=>U(()=>i.import("./HisNumberInput-legacy-pJdW51q9.js"),void 0,i.meta.url),"../FormElements/HisSelect.vue":()=>U(()=>i.import("./HisSelect-legacy-DqVClow0.js"),void 0,i.meta.url),"../FormElements/PersonMatchView.vue":()=>U(()=>i.import("./PersonMatchView-legacy-BnRfFKhm.js"),void 0,i.meta.url),"../FormElements/PersonSearchView.vue":()=>U(()=>i.import("./PersonSearchView-legacy-CyMTW4LH.js"),void 0,i.meta.url),"../FormElements/RelationsSelection.vue":()=>U(()=>i.import("./RelationsSelection-legacy-CTfV9u_7.js"),void 0,i.meta.url),"../FormElements/SelectMixin.vue":()=>U(()=>i.import("./SelectMixin-legacy-45M42H4d.js"),void 0,i.meta.url)}),`../FormElements/${t}.vue`,3),loadingComponent:Xe,errorComponent:tt,delay:150,timeout:5e4})}),e}()},emits:["onFinish","onIndex"],props:{onFinish:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String},disableAutoModalDismiss:{type:Boolean},cancelAction:{type:Function}},data:()=>({ftBtnEvent:{eventIndex:0,btnName:"",btnOutput:null},helpText:"",valueClearIndex:0,currentIndex:0,currentField:{},currentFieldContext:null,formData:{},computedFormData:{},footerBtns:[],currentFields:[],fieldsInitialisedOnce:{},state:""}),watch:{fields:{async handler(e){if(!te.isEmpty(e)){this.buildFormData(e);let t=e;this.skipSummary||(t=[...t,this.getDefaultSummaryField()]),this.currentFields=t,this.activeField?this.mountField(this.activeField):await this.onNext()}},immediate:!0,deep:!0},state:{handler(e){["onValue","onClear","next","prev","onfinish","onload","unload"].includes(e)&&(M.getTop().then(e=>e?M.dismiss():null),this.disableAutoModalDismiss||B.getTop().then(e=>e&&B.dismiss()),O.getTop().then(e=>e?O.dismiss():null),L.getTop().then(e=>e?L.dismiss():null))},immediate:!0,deep:!0},activeField:{async handler(e){e&&this.mountField(e)}}},mounted(){this.footerBtns=[this.getCancelBtn()]},methods:{clearValue(){this.valueClearIndex+=1,this.setActiveFieldValue(null)},async onFtButtonClicked(e){this.ftBtnEvent.eventIndex+=1,this.ftBtnEvent.btnName=e.name,this.ftBtnEvent.btnOutput=await e.onClick(this.formData,this.computedFormData,this.currentFieldContext),e.onClickComponentEvents?this.ftBtnEvent.onClickComponentEvents=e.onClickComponentEvents:this.ftBtnEvent.onClickComponentEvents&&delete this.ftBtnEvent.onClickComponentEvents},async mountField(e){if("_NEXT_FIELD_"===e)return await this.goNext(),this.$emit("onIndex",this.currentIndex);const t=te.findIndex(this.currentFields,{id:e});t>=0&&t<=this.currentFields.length&&(this.setActiveFieldComputedValue(),this.setActiveField(t),this.$emit("onIndex",t))},getCancelBtn(e={}){const t=e||{};return{name:t.name||"Cancel",color:t.color||"danger",onClick:async()=>{if(t.onClick)return t.onClick();if(await he("Are you sure you want to cancel?")){if("function"==typeof this.cancelAction)return this.cancelAction();this.cancelDestinationPath?this.$router.push(this.cancelDestinationPath):this.$router.back()}}}},getClearBtn(e={}){const t=e||{};return{name:t.name||"Clear",color:t.color||"warning",slot:"end",onClick:async()=>{if(t.onClick)return t.onClick();await he("Are you sure you want to clear field data?")&&this.clearValue()}}},getBackBtn(e={}){const t=e||{},i=()=>!(1===this.currentFields.length||this.currentIndex<=0);return{name:(null==t?void 0:t.name)||"Back",slot:"end",state:{disabled:{default:()=>!1,onsubmit:()=>!0},visible:{onload:()=>i(),default:()=>i()}},onClick:()=>t.onClick?t.onClick():this.goBack()}},getNextBtn(e={}){const t=e||{},i=()=>!(this.currentIndex+1>=this.currentFields.length||this.currentFields.length<=1);return{name:(null==t?void 0:t.name)||"Next",color:(null==t?void 0:t.color)||"success",slot:"end",state:(null==t?void 0:t.state)||{disabled:{onsubmit:()=>!0,default:e=>"requireNext"in e&&!e.requireNext},visible:{onsubmit:()=>!1,onfinish:()=>!1,default:()=>i(),onload:()=>i()}},onClick:()=>t.onClick?t.onClick():this.goNext()}},getFinishBtn(e={}){const t=e||{},i=()=>this.currentIndex+1>=this.currentFields.length;return{name:(null==t?void 0:t.name)||"Finish",color:(null==t?void 0:t.color)||"success",slot:"end",state:{disabled:{default:()=>!1,onsubmit:()=>!0},visible:{onfinish:()=>!0,onsubmit:()=>!0,default:()=>i(),onload:()=>i()}},onClick:()=>t.onClick?t.onClick():this.goNext()}},onVisibleBtnState(e){var t;try{var i;if(null!==(i=this.currentField)&&void 0!==i&&null!==(i=i.config)&&void 0!==i&&i.hiddenFooterBtns.includes(e.name))return!1}catch(n){}if(null!=e&&null!==(t=e.state)&&void 0!==t&&t.visible){if(this.state in e.state.visible)return e.state.visible[this.state](this.currentField,this.formData);if("default"in e.state.visible)return e.state.visible.default(this.currentField,this.formData)}return!0},onDisabledBtnState(e){var t;if(null!=e&&null!==(t=e.state)&&void 0!==t&&t.disabled){if(this.state in e.state.disabled)return e.state.disabled[this.state](this.currentField,this.formData);if("default"in e.state.disabled)return e.state.disabled.default(this.currentField,this.formData)}return!1},getDefaultSummaryField(){return{id:"__form_summary__",helpText:"Summary",type:je.TT_SUMMARY,config:{hiddenFooterBtns:["Clear"]},options:(e,t)=>{const i=[];for(const n in e){const a=this.currentFields.filter(e=>e.id===n||e.proxyID===n)[0],o=e[n];if(!o||null!=a.appearInSummary&&!a.appearInSummary(e,n))continue;(Array.isArray(o)?o:[o]).forEach(o=>{a.summaryMapValue?i.push(a.summaryMapValue(o,e,t[n])):i.push({label:a.helpText,value:o.label})})}return i}}},resolveFormValues(e){const t={};for(const i in e)null!=e[i]&&(t[i]=e[i]);return t},async onFinishAction(){const e=this.resolveFormValues(this.formData),t=this.resolveFormValues(this.computedFormData);if(this.onFinish)try{this.state="onsubmit",await this.onFinish(e,t)}catch(i){console.error(i),le(`${i}`)}this.state="onfinish",this.$emit("onFinish",e,t)},async goNext(){if(this.currentField.validation){const e=this.formData[this.currentField.id],t=this.currentField.validation(e,this.formData,this.computedFormData);if(t)return ce(t.join(", "),2e3)}this.currentField.beforeNext&&!(await this.currentField.beforeNext(this.formData[this.currentField.id],this.formData,this.computedFormData,this))||await this.onNext()},async goBack(){for(let t=this.currentIndex;t>=0;--t){const i=this.currentFields[t];if(te.isEmpty(this.currentField)||this.currentField.id!==i.id){await this.initFieldOnce(i);try{if(!(await this.checkFieldCondition(i)))continue}catch(e){continue}return void(await this.setActiveField(t,"prev"))}}},async checkFieldCondition(e){return!(e.condition&&!(await e.condition(this.formData,this.computedFormData)))||("function"==typeof e.onConditionFalse&&e.onConditionFalse(),this.formData[e.id]=e.defaultOutput?e.defaultOutput(this.formData,this.computedFormData):null,e.computedValue&&(this.computedFormData[e.id]=e.defaultComputedOutput?e.defaultComputedOutput(this.formData,this.computedFormData):null),!1)},onFieldActivated(e){this.state="onload",this.currentFieldContext=e,this.currentField.onload&&this.currentField.onload(e)},async onUnload(e=""){try{if(this.state="unload",!te.isEmpty(this.currentField)&&this.currentField.unload){const t=this.formData[this.currentField.id];await this.currentField.unload(t,e,this.formData,this.computedFormData,this)}}catch(t){console.error(t)}},buildFormData(e){this.formData={},e.forEach(e=>{e.proxyID&&(this.formData[e.proxyID]=null),this.formData[e.id]=null})},async setActiveFieldValue(e){this.state="onValue";const t=this.currentField.proxyID,i=this.currentField.id;t&&(this.formData[t]=e),this.formData[i]=e,"function"==typeof this.currentField.updateHelpTextOnValue&&(this.helpText=this.currentField.updateHelpTextOnValue(e,this.formData))},async onNext(){const e=this.currentFields.length;for(let i=this.currentIndex;i<e;++i){const e=this.currentFields[i];if(te.isEmpty(this.currentField)||this.currentField.id!==e.id){await this.initFieldOnce(e);try{if(!(await this.checkFieldCondition(e)))continue}catch(t){continue}if("function"==typeof this.currentField.exitsForm&&this.currentField.exitsForm(this.formData,this.computedFormData))break;return this.setActiveFieldComputedValue(),void this.setActiveField(i,"next")}}this.setActiveFieldComputedValue(),await this.onFinishAction()},async setActiveField(e,t=""){var i;await this.onUnload(t),this.state=t,this.currentIndex=e,this.currentField=this.currentFields[this.currentIndex],await this.initFieldOnce(this.currentField),this.helpText=this.currentField.dynamicHelpText?this.currentField.dynamicHelpText(this.formData):"function"==typeof this.currentField.updateHelpTextOnValue?this.currentField.updateHelpTextOnValue(this.formData[this.currentField.id],this.computedFormData[this.currentField.id]):this.currentField.helpText,this.footerBtns=[this.getCancelBtn()],this.currentField.config&&this.currentField.config.footerBtns&&(this.footerBtns=this.footerBtns.concat(this.currentField.config.footerBtns));const n=null===(i=this.currentField.config)||void 0===i?void 0:i.overrideDefaultFooterBtns;this.footerBtns.push(this.getClearBtn(null==n?void 0:n.clearBtn)),this.footerBtns.push(this.getBackBtn(null==n?void 0:n.backBtn)),this.footerBtns.push(this.getNextBtn(null==n?void 0:n.nextBtn)),this.footerBtns.push(this.getFinishBtn(null==n?void 0:n.finishBtn))},setActiveFieldComputedValue(){if("object"==typeof this.currentField&&"function"==typeof this.currentField.computedValue){const e=this.currentField.proxyID||this.currentField.id,t=this.formData[e];this.computedFormData[e]=null==t&&t?null:this.currentField.computedValue(t,this.formData,this.computedFormData)}},onFieldValue(e){this.setActiveFieldValue(e),"requireNext"in this.currentField&&!this.currentField.requireNext&&this.onNext()},async initFieldOnce(e){"function"==typeof e.init&&(this.fieldsInitialisedOnce[e.id]||(this.fieldsInitialisedOnce[`${e.id}`]=await e.init(this.formData,this.computedFormData)))}}});const nt=a({name:"HisStandardForm",components:{TouchScreenForm:de(it,[["render",function(e,t,i,n,a,o){const r=h("ion-title"),s=h("ion-col"),l=h("info-card"),u=h("ion-row"),d=h("ion-toolbar"),c=h("ion-header"),f=h("ion-content"),F=h("ion-button"),_=h("ion-footer"),S=h("ion-page");return m(),p(v,null,[w(D(e.currentField)+" ",1),I(S,null,{default:P(()=>[I(c,null,{default:P(()=>[I(d,null,{default:P(()=>[I(u,null,{default:P(()=>{var t;return[I(s,null,{default:P(()=>[I(r,{class:"his-lg-text"},{default:P(()=>[w(D(e.helpText),1)]),_:1})]),_:1}),null!==(t=e.currentField)&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&t.toolbarInfo?(m(),T(s,{key:0},{default:P(()=>{var t;return[I(l,{style:{height:"100%"},items:null===(t=e.currentField)||void 0===t||null===(t=t.config)||void 0===t?void 0:t.toolbarInfo},null,8,["items"])]}),_:1})):g("",!0)]}),_:1})]),_:1})]),_:1}),I(f,null,{default:P(()=>[(m(),T(Y,null,[(m(),T(q(e.currentField.type),{key:e.currentField.id,config:e.currentField.config,options:e.currentField.options,preset:e.currentField.preset,clear:e.valueClearIndex,fdata:e.formData,cdata:e.computedFormData,activationState:e.state,onValue:e.currentField.onValue,defaultValue:e.currentField.defaultValue,onValueUpdate:e.currentField.onValueUpdate,footerButtonEvent:e.ftBtnEvent,onOnValue:e.onFieldValue,onOnFieldActivated:e.onFieldActivated},null,40,["config","options","preset","clear","fdata","cdata","activationState","onValue","defaultValue","onValueUpdate","footerButtonEvent","onOnValue","onOnFieldActivated"]))],1024))]),_:1}),I(_,null,{default:P(()=>[I(d,{color:"dark"},{default:P(()=>[(m(!0),p(v,null,y(e.footerBtns,(t,i)=>G((m(),T(F,{key:i,slot:t.slot||"start",class:b(t.styleClass),onClick:i=>e.onFtButtonClicked(t),color:t.color||"primary",size:t.size||"large",disabled:e.onDisabledBtnState(t)},{default:P(()=>[w(D(t.name),1)]),_:2},1032,["slot","class","onClick","color","size","disabled"])),[[z,e.onVisibleBtnState(t)]])),128))]),_:1})]),_:1})]),_:1})],64)}]])},emits:["onFinish","onIndex"],data:()=>({formType:"touch-screen-form"}),props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish(e,t){this.$emit("onFinish",e,t)},onIndex(e){this.$emit("onIndex",e)}}});t("a",de(nt,[["render",function(e,t,i,n,a,o){return m(),T(q(e.formType),{fields:e.fields,skipSummary:e.skipSummary,activeField:e.activeField,cancelDestinationPath:e.cancelDestinationPath,onOnFinish:e.onFinish,onFinish:e.onFinishAction,onOnIndex:e.onIndex},null,40,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}]]));const at=a({name:"SingleFieldTouchForm",components:{IonPage:V,IonContent:H,IonFooter:A,IonToolbar:N,IonButton:c,IonHeader:R,IonTitle:k,...function(){const e={};return Ue.forEach(t=>{e[t]=j(()=>Le(Object.assign({"../FormElements/BaseTextInput.vue":()=>U(()=>i.import("./BaseTextInput-legacy-lnyGfeb_.js"),void 0,i.meta.url),"../FormElements/FieldMixin.vue":()=>U(()=>i.import("./FieldMixin-legacy-NENBfoln.js"),void 0,i.meta.url),"../FormElements/FilingNumberView.vue":()=>U(()=>i.import("./FilingNumberView-legacy-DlJ4BOiC.js"),void 0,i.meta.url),"../FormElements/HisArtRegimenSelection.vue":()=>U(()=>i.import("./HisArtRegimenSelection-legacy-2VzWdsc-.js"),void 0,i.meta.url),"../FormElements/HisCardSelector.vue":()=>U(()=>i.import("./HisCardSelector-legacy-C-e6sTIh.js"),void 0,i.meta.url),"../FormElements/HisComplaintsPicker.vue":()=>U(()=>i.import("./HisComplaintsPicker-legacy-DqxpHneL.js"),void 0,i.meta.url),"../FormElements/HisDataTable.vue":()=>U(()=>i.import("./HisDataTable-legacy-BbdbOHYw.js"),void 0,i.meta.url),"../FormElements/HisDateInput.vue":()=>U(()=>i.import("./HisDateInput-legacy-B3LiJAHN.js"),void 0,i.meta.url),"../FormElements/HisInfiniteScrollMultipleSelect.vue":()=>U(()=>i.import("./HisInfiniteScrollMultipleSelect-legacy-BiPxx4QG.js"),void 0,i.meta.url),"../FormElements/HisMonthlyDays.vue":()=>U(()=>i.import("./HisMonthlyDays-legacy-CnhCGJSa.js"),void 0,i.meta.url),"../FormElements/HisMultiSelectGrid.vue":()=>U(()=>i.import("./HisMultiSelectGrid-legacy-DsNL_GXW.js"),void 0,i.meta.url),"../FormElements/HisNextVisitInterval.vue":()=>U(()=>i.import("./HisNextVisitInterval-legacy-DofQQ9fK.js"),void 0,i.meta.url),"../FormElements/HisNumberInput.vue":()=>U(()=>i.import("./HisNumberInput-legacy-pJdW51q9.js"),void 0,i.meta.url),"../FormElements/HisSelect.vue":()=>U(()=>i.import("./HisSelect-legacy-DqVClow0.js"),void 0,i.meta.url),"../FormElements/PersonMatchView.vue":()=>U(()=>i.import("./PersonMatchView-legacy-BnRfFKhm.js"),void 0,i.meta.url),"../FormElements/PersonSearchView.vue":()=>U(()=>i.import("./PersonSearchView-legacy-CyMTW4LH.js"),void 0,i.meta.url),"../FormElements/RelationsSelection.vue":()=>U(()=>i.import("./RelationsSelection-legacy-CTfV9u_7.js"),void 0,i.meta.url),"../FormElements/SelectMixin.vue":()=>U(()=>i.import("./SelectMixin-legacy-45M42H4d.js"),void 0,i.meta.url)}),`../FormElements/${t}.vue`,3))}),e}()},props:{dismissType:{type:String},onFinish:{type:Function,required:!0},currentField:{type:Object,required:!0}},data:()=>({valueClearIndex:0,formData:{},computedFormData:{},state:"",value:null,disableBtn:!1}),methods:{onClose(){"modal"===this.dismissType?B.dismiss():this.$router.back()},onClear(){this.valueClearIndex+=1,this.value=null},onFieldValue(e){this.value=e},onDone(){if(this.disableBtn=!0,this.currentField.validation){const e=this.currentField.validation(this.value);if(this.disableBtn=!1,e)return ce(e.join(", "),6e4)}try{this.onFinish(this.value)}catch(e){le(`${e}`),console.error(e)}this.onClose(),this.disableBtn=!1}}});const ot=de(at,[["render",function(e,t,i,n,a,o){const r=h("ion-title"),s=h("ion-toolbar"),l=h("ion-header"),u=h("ion-content"),d=h("ion-button"),c=h("ion-footer"),p=h("ion-page");return m(),T(p,null,{default:P(()=>[I(l,null,{default:P(()=>[I(s,null,{default:P(()=>[I(r,{class:"his-lg-text ion-text-center"},{default:P(()=>[w(D(e.currentField.helpText),1)]),_:1})]),_:1})]),_:1}),I(u,null,{default:P(()=>[(m(),T(Y,null,[(m(),T(q(e.currentField.type),{key:e.currentField.id,options:e.currentField.options,preset:e.currentField.preset,clear:e.valueClearIndex,fdata:e.formData,config:e.currentField.config,cdata:e.computedFormData,activationState:e.state,onValue:e.currentField.onValue,defaultValue:e.currentField.defaultValue,onValueUpdate:e.currentField.onValueUpdate,onOnValue:e.onFieldValue},null,40,["options","preset","clear","fdata","config","cdata","activationState","onValue","defaultValue","onValueUpdate","onOnValue"]))],1024))]),_:1}),I(c,null,{default:P(()=>[I(s,{color:"light"},{default:P(()=>[I(d,{disabled:e.disableBtn,onClick:e.onClose,slot:"start",color:"danger",size:"large"},{default:P(()=>t[0]||(t[0]=[w(" Close ")])),_:1,__:[0]},8,["disabled","onClick"]),I(d,{disabled:e.disableBtn,onClick:e.onClear,slot:"end",color:"warning",size:"large"},{default:P(()=>t[1]||(t[1]=[w(" Clear ")])),_:1,__:[1]},8,["disabled","onClick"]),I(d,{disabled:e.disableBtn,onClick:e.onDone,slot:"end",color:"success",size:"large"},{default:P(()=>t[2]||(t[2]=[w(" Done ")])),_:1,__:[2]},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1})}]]),rt=a({emits:["onItemsPerPage","onSearchFilter","onItemsVLtype"],components:{IonItem:Q,IonCol:C,IonRow:x,IonInput:W,IonButton:c},props:{customFilter:{type:Function},totalRowCount:{type:Number,default:15e3},disableSearchFilter:{type:Boolean,default:!1},disablePerPageFilter:{type:Boolean,default:!1},showPerPageFilter:{type:Boolean,default:!1}},setup(e,{emit:t}){const i=J(50),n=J(""),a=J("");async function o(e,t){(await B.create({component:ot,backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:e,onFinish:t}})).present()}function r(e){t("onSearchFilter",e)}return K(i,e=>{"number"==typeof e&&t("onItemsPerPage",e)},{immediate:!0}),{reset:function(){n.value="",r("")},itemsPerPage:i,searchFilter:n,launchFilter:async function(){"function"==typeof e.customFilter&&(a.value=await e.customFilter())},launchKeyboard:o,launchSearcher:function(){o({id:"search",helpText:"Search table data",defaultValue:()=>n.value,type:je.TT_TEXT},e=>{n.value=e?e.value:"",r(n.value)})},customFilterValue:a}}}),st=["disabled"],lt=["selected"],ut=["selected"],dt=["selected"],ct=["selected"],ht=["selected"],pt=["selected"],mt=["selected","value"];const ft=t("R",de(rt,[["render",function(e,t,i,n,a,o){const r=h("ion-col"),s=h("ion-input"),l=h("ion-button"),u=h("ion-item"),d=h("ion-row");return m(),T(d,null,{default:P(()=>[e.showPerPageFilter?(m(),T(r,{key:0},{default:P(()=>[G(f("select",{class:"input_display","onUpdate:modelValue":t[0]||(t[0]=t=>e.itemsPerPage=t),disabled:e.disablePerPageFilter},[f("option",{selected:5===e.itemsPerPage,value:5},"5 rows/page",8,lt),f("option",{selected:10===e.itemsPerPage,value:10},"10 rows/page",8,ut),f("option",{selected:20===e.itemsPerPage,value:20},"20 rows/page",8,dt),f("option",{selected:50===e.itemsPerPage,value:50},"50 rows/page",8,ct),f("option",{selected:100===e.itemsPerPage,value:100},"100 rows/page",8,ht),f("option",{selected:1e3===e.itemsPerPage,value:1e3},"1000 rows/page",8,pt),f("option",{selected:e.itemsPerPage===e.totalRowCount,value:e.totalRowCount},"Show all rows("+D(e.totalRowCount)+")",9,mt)],8,st),[[Z,e.itemsPerPage]])]),_:1})):g("",!0),"function"==typeof e.customFilter?(m(),T(r,{key:1},{default:P(()=>[I(s,{class:"input_display",value:e.customFilterValue,onClick:e.launchFilter,placeholder:"Filter..."},null,8,["value","onClick"])]),_:1})):g("",!0),I(r,null,{default:P(()=>[I(u,{lines:"none"},{default:P(()=>[I(s,{disabled:e.disableSearchFilter,class:"input_display",value:e.searchFilter,onClick:e.launchSearcher,placeholder:"Search here..."},null,8,["disabled","value","onClick"]),e.searchFilter?(m(),T(l,{key:0,class:"reset_button",size:"large",onClick:t[1]||(t[1]=t=>e.reset()),color:"secondary"},{default:P(()=>t[2]||(t[2]=[w(" Reset ")])),_:1,__:[2]})):g("",!0)]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-7bf42b5b"]])),gt=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];const vt={isFloatingPointNumber:function(e){return te.isPlainObject(e)&&!/^[-+]?[0-9]*\.?[0-9]+$/.test(`${null==e?void 0:e.value}`)?["Not a valid number"]:null},validateSeries:function(e){try{for(const t in e){const i=e[t]();if(i)return i}}catch(t){return[t]}},required:function(e){return te.isEmpty(e)?["Value is required"]:null},isMWPhoneNumber:function(e){return e&&e.value.match(/^(\+?265|0)(((8[89]|9[89])\d{7})|(1\d{6})|(2\d{8})|(31\d{8}))$/)?null:["Not a valid phone number"]},isName:function(e){return e&&e.label.match(/^(?=.{2,100}$)[a-z!A-Z]+(?:['_.\-!\][a-z]+[a-z!A-Z])*$/)?null:["Invalid name Input"]},isNumber:function(e){return isNaN(parseInt(e.value))?["Value must be a number"]:null},hasLengthRangeOf:function(e,t,i){const n=e?e.label.length:0;return n>=t&&n<=i?null:[`Value length not within range of ${t} - ${i}`]},rangeOf:function(e,t,i){const n=parseInt(e.label);return n>=t&&n<=i?null:[`${n} not within range of ${t} - ${i}`]},neitherOr:function(e){return e.filter(e=>"No"===(e.value||e.other.value)).length==e.length?["All values can not be no"]:null},anyEmpty:function(e){const t=["all must be selected"];return e?e.filter(e=>""===e.value).length>0?t:null:t},notTheSame:function(e,t){return e===t?["Values can not be the same"]:null},isIPAddress:function(e){return e&&e.value.match(/\b(?:(?:2(?:[0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9])\.){3}(?:(?:2([0-4][0-9]|5[0-5])|[0-1]?[0-9]?[0-9]))\b/)?null:["Not a valid IP address"]},isMWNationalID:function(e){return te.isEmpty(e)||!e.value.toString().match(/^(?=[a-zA-Z0-9]*$)(?=\d+[a-zA-Z]|[a-zA-Z]+\d)([a-zA-Z\d]){8}$/)?["Not a valid Malawi National ID number"]:null}},yt=[["1","2","3"],["4","5","6"],["7","8","9"],["","0",""]],bt=t("c",[["1","2","3","4","5","6","7"],["8","9","10","11","12","13","14"],["15","16","17","18","19","20","21"],["22","23","24","25","26","27","28"],["29","30","31"]]),Ft=[[["1","2","3","+","-","/","*"],["4","5","6","%","=","<",">","Qwerty"],["7","8","9",".",","],["","0",""]],[["","Delete"]]],wt=(t("e",[yt,[["Delete"]]]),t("f",[yt,[["N/A"],["Delete","Unknown"]]]),[yt,[["Delete"]]]),Tt=[yt,[["Unknown","Delete"],["Qwerty","A-Z"]]],Dt=(t("d",[bt,[["Unknown"]]]),[[["a","b","c","d","e","f","g","h","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]]),It=t("Q",[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","'"],["z","x","c","v","b","n","m",",",".","A-Z"]],[["","Delete"],["?123","0-9"],["Space","Unknown"]]]);t("K",[{btn:"0-9",keyboard:Tt},{btn:"?123",keyboard:Ft},{btn:"A-Z",keyboard:Dt},{btn:"Qwerty",keyboard:It}]);function _t(e){return parseInt(e)<10?`0${e}`:e}async function Pt(e,t,i){if(t.defaultValue){const n=await t.defaultValue(e);if(n){const[e,t,a]=n.split("-");switch(i){case"Year":return e||"";case"Month":return parseInt(t)||"";case"Day":return parseInt(a)||""}}}return""}function St(e){return oe.toStandardHisDisplayFormat(e)}function xt(e,t,i,n){if(t.minDate){const a=t.minDate(i,n);if(new Date(e)<new Date(a))return[`${St(e)} is less than minimum date of ${St(a)}`]}if(t.maxDate){const a=t.maxDate(i,n);if(a&&new Date(e)>new Date(a))return[`${St(e)} is greater than max date of  ${St(a)}`]}}function Ct(e){let t="",i="",n="",a="",o=!1;const r=`year_${e.id}`,s=`month_${e.id}`,l=`day_${e.id}`,u=`age_estimate_${e.id}`,d=`duration_estimate_${e.id}`,c=function(e,t,i=!0){const n=[];return i&&n.push("UNKNOWN"),{id:e,helpText:`${t} Year`,appearInSummary:()=>!1,type:je.TT_TEXT,config:{customKeyboard:[yt,[n,["DELETE"]]]}}}(r,e.helpText,e.estimation.allowUnknown),h=(p=s,m=e.helpText,{id:p,helpText:`${m} Month`,appearInSummary:()=>!1,type:je.TT_SELECT,options:()=>gt});var p,m;const f=function(e,t){return{id:e,helpText:`${t} Day`,type:je.TT_MONTHLY_DAYS,appearInSummary:()=>!1}}(l,e.helpText),g=function(e,t){return{id:e,helpText:`${t} Age Estimate`,type:je.TT_NUMBER,appearInSummary:()=>!1,config:{keypad:wt}}}(u,e.helpText),v=function(e,t){return{id:e,helpText:`${t} Estimated period`,type:je.TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}(d,e.helpText),y="boolean"==typeof e.estimation.allowUnknownMonthDay&&e.estimation.allowUnknownMonthDay,b=t=>!(t[r]&&t[r].value&&["Unknown"].includes(t[r].value))&&(!e.condition||e.condition(t)),F=(e,t)=>[{type:"year",value:i,default:"YYYY"},{type:"month",value:n,default:"MM"},{type:"day",value:a,default:"DD"}].reduce((i,n)=>{const a=[null,void 0,"Unknown",""];return t===n.type?a.includes(e)?i.push(n.default):i.push(e):a.includes(n.value)?i.push(n.default):i.push(n.value),i},[]).join("-");"function"==typeof e.init&&(c.init=e.init),c.updateHelpTextOnValue=e=>`${c.helpText} (${F(null==e?void 0:e.label,"year")})`,c.proxyID=e.id,c.unload=e=>i=e.value.toString(),c.config={...c.config,...e.config},c.defaultValue=t=>Pt(t,e,"Year"),c.condition=t=>!e.condition||e.condition(t),c.validation=(t,i,n)=>{if(e.required&&vt.required(t))return["Year cannot be empty"];const a=t?t.value:"";if(!e.estimation.allowUnknown&&a.toString().match(/unknown/i))return["Value unknown is not permitted"];if(a&&!["Unknown"].includes(a)&&isNaN(a)||a<1900)return["Invalid Year"];if(a&&"function"==typeof e.minDate){const t=oe.getYear(e.minDate(i,n));if(parseInt(a)<t)return[`Year of ${a} is less than Minimum year of ${t}`]}if(a&&"function"==typeof e.maxDate){const t=e.maxDate(i,n);if(t&&a>oe.getYear(t))return[`Year of ${a} exceeds Maximum year of ${oe.getYear(t)}`]}return null},c.summaryMapValue=()=>({label:e.summaryLabel||e.helpText,value:t?St(t):"Unknown"}),c.appearInSummary=(t,i)=>i===e.id,c.computedValue=i=>{if(t){const[,n,a]=t.split("-");return t=`${i.value}-${n}-${a}`,e.computeValue(t,!1)}if(i&&"Unknown"===i.value)return t="",e.computeValue("Unknown",!1)},h.updateHelpTextOnValue=e=>`${h.helpText} (${F(null==e?void 0:e.label,"month")})`,h.proxyID=e.id,h.unload=e=>n=_t(e.value.toString()),h.condition=e=>b(e),h.validation=e=>vt.required(e),h.defaultValue=t=>Pt(t,e,"Month"),y&&(h.options=()=>[...gt,{label:"Unknown",value:"Unknown"}]),h.computedValue=(i,n)=>{if(`${i.value}`.match(/unknown/i))return t=`${n[r].value}-07-15`,e.computeValue(t,!0);if(t){const[n,,a]=t.split("-"),o=_t(`${i.value}`);return t=`${n}-${o}-${a}`,e.computeValue(t,!1)}},f.proxyID=e.id,f.updateHelpTextOnValue=e=>`${f.helpText} (${F(null==e?void 0:e.label,"day")})`,f.condition=e=>!`${e[s].value}`.match(/unknown/i)&&b(e),f.validation=(r,s,l)=>vt.required(r)?["Day is required for date"]:(o=!!`${r.value}`.match(/unknown/i),a=o?"15":_t(`${r.value}`),t=`${i}-${n}-${a}`,xt(t,e,s,l)),f.defaultValue=t=>Pt(t,e,"Day"),f.computedValue=()=>e.computeValue(t,o),f.unload=(t,i,n,a)=>{e.unload&&e.unload(t,i,n,a)},f.beforeNext=(i,n)=>!e.beforeNext||e.beforeNext(t,n),f.config={year:e=>e[r].value,month:e=>e[s].value},y||(f.config.keyboardActions=[]);const w=(t,i)=>["Unknown"===t[r].value,!e.condition||e.condition(t),e.estimation.estimationFieldType===i].every(Boolean);return g.proxyID=e.id,g.validation=(i,n,a)=>{if(i&&i.value>300)return["Age estimate is too high and exceeding hard limit of 300"];if(isNaN(parseInt(i.value.toString())))return["Please enter a valid number"];if(!i.value.toString().match(/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/))return["Not a valid age estimate"];const o=X(ie.getSessionDate()).subtract(i.value,"years").year();return t=`${o}-07-15`,xt(t,e,n,a)},g.condition=e=>w(e,"age-estimate-field"),g.computedValue=()=>e.computeValue(t,!0),g.beforeNext=(i,n)=>!e.beforeNext||e.beforeNext(t,n),v.proxyID=e.id,v.validation=(i,n,a)=>vt.required(i)?["Please select an estimate"]:(t=X(ie.getSessionDate()).subtract(i.value,"day").format(pe),xt(t,e,n,a)),v.condition=e=>w(e,"month-period-estimate-field"),v.computedValue=()=>e.computeValue(t,!0),v.beforeNext=(i,n)=>!e.beforeNext||e.beforeNext(t,n),[c,h,f,g,v]}const Et=a({components:{IonCol:C,IonRow:x,Pagination:fe,ReportTable:Oe,ReportFilter:ft,HisFooter:me,IonPage:V,IonHeader:R,IonContent:H,IonToolbar:N,IonChip:ee,IonFooter:A},props:{title:{type:String,required:!0},columns:{type:Array,required:!0},encryptPDF:{type:Boolean,default:!1},rows:{type:Array,default:()=>[]},rowParser:{type:Function},showFilters:{type:Boolean,default:!1},rowsPerPage:{type:Number},asyncRows:{type:Function},paginated:{type:Boolean,default:!1},customBtns:{type:Array,default:()=>[]},showReportStamp:{type:Boolean,default:!0},footerColor:{type:String,default:"dark"},customFileName:{type:String,default:""},canExport:{type:Boolean,default:!0},onFinish:{type:Function}},data:()=>({btns:[],isTableLoading:!1,searchFilter:"",itemsPerPage:50,currentPage:0,coreVersion:ie.getCoreVersion(),tableRows:[],totalPages:0,activeColumns:[],activeRows:[],date:oe.toStandardHisDisplayFormat(ie.getSessionDate()),apiVersion:ie.getApiVersion(),siteUUID:ie.getSiteUUID()}),methods:{getFileName(){return this.customFileName?this.customFileName:this.title},pdfEncryptionData(){const e=ie.getUserName();return{encryption:{userPassword:e,ownerPassword:e,userPermissions:["print"]}}}},created(){this.btns=[...this.customBtns,{name:"CSV",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:()=>{const{columns:e,rows:t}=Ie(this.activeColumns,this.activeRows,"csvMode");ye(e,[...t,[`Date Created: ${this.date}`],[`MaHIS Version: ${this.coreVersion}`],[`API Version: ${this.apiVersion}`],[`Site UUID: ${this.siteUUID}`],[`Generated by: ${ie.getUserName()}`]],this.getFileName())}},{name:"PDF",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:async()=>{let e="pdfMode";if(this.encryptPDF){e="Secure PDF"===await ge("Security warning","PDF may contain private data that will require a password to unlock","To access private data choose Secure PDF over Regular PDF",[{name:"Secure PDF",slot:"start",color:"success"},{name:"Regular PDF",slot:"start",color:"success"}],"his-danger-color")?"pdfMode":"ignorePDFColumnexport"}const{columns:t,rows:i}=Ie(this.activeColumns,this.activeRows,e);be(t,i,this.getFileName(),!1,this.encryptPDF&&"ignorePDFColumnexport"!=e?this.pdfEncryptionData():{})}},{name:"Finish",size:"large",slot:"end",color:"success",visible:!0,onClick:()=>{if("function"==typeof this.onFinish)return this.onFinish();this.$router.push({path:"/"})}}]}}),kt={class:"report-content"};const Rt=de(Et,[["render",function(e,t,i,n,a,o){const r=h("ion-col"),s=h("ion-row"),l=h("ion-toolbar"),u=h("report-filter"),d=h("ion-header"),c=h("report-table"),p=h("ion-content"),v=h("pagination"),y=h("ion-chip"),b=h("ion-footer"),F=h("his-footer"),_=h("ion-page");return m(),T(_,null,{default:P(()=>[I(d,null,{default:P(()=>[I(l,null,{default:P(()=>[I(s,null,{default:P(()=>[I(r,null,{default:P(()=>[f("h1",null,D(e.title),1)]),_:1})]),_:1})]),_:1}),I(l,null,{default:P(()=>[I(u,{showPerPageFilter:e.showFilters||e.paginated,disableSearchFilter:e.isTableLoading,disablePerPageFilter:e.isTableLoading,totalRowCount:e.tableRows.length,onOnItemsPerPage:t[0]||(t[0]=t=>e.itemsPerPage=t),onOnSearchFilter:t[1]||(t[1]=t=>e.searchFilter=t)},null,8,["showPerPageFilter","disableSearchFilter","disablePerPageFilter","totalRowCount"])]),_:1})]),_:1}),I(p,null,{default:P(()=>[f("div",kt,[I(c,{rows:e.rows,paginated:e.paginated,asyncRows:e.asyncRows,rowParser:e.rowParser,columns:e.columns,showFilters:e.showFilters,newPage:e.currentPage,searchFilter:e.searchFilter,rowsPerPage:e.itemsPerPage,onOnIsLoading:t[2]||(t[2]=t=>e.isTableLoading=t),onOnTableRows:t[3]||(t[3]=t=>e.tableRows=t),onOnPagination:t[4]||(t[4]=t=>e.totalPages=t.length),onOnActiveColumns:t[5]||(t[5]=t=>e.activeColumns=t),onOnActiveRows:t[6]||(t[6]=t=>e.activeRows=t)},null,8,["rows","paginated","asyncRows","rowParser","columns","showFilters","newPage","searchFilter","rowsPerPage"])])]),_:1}),I(b,null,{default:P(()=>[I(l,null,{default:P(()=>[!e.searchFilter&&e.paginated||!e.searchFilter&&e.totalPages>0&&e.paginated?(m(),T(v,{key:0,onClickPrevious:()=>{},onClickNext:()=>{},page:1,disableNext:!1,disablePrevious:!1,perPage:e.itemsPerPage,maxVisibleButtons:10,totalPages:e.totalPages,onOnChangePage:t[7]||(t[7]=t=>e.currentPage=t)},null,8,["perPage","totalPages"])):g("",!0)]),_:1}),e.showReportStamp?(m(),T(l,{key:0},{default:P(()=>[I(y,{color:"primary"},{default:P(()=>[t[8]||(t[8]=w("Date Created: ")),f("b",null,D(e.date),1)]),_:1,__:[8]}),I(y,{color:"primary"},{default:P(()=>[t[9]||(t[9]=w("MaHIS Version: ")),f("b",null,D(e.coreVersion),1)]),_:1,__:[9]}),I(y,{color:"primary"},{default:P(()=>[t[10]||(t[10]=w("API Version: ")),f("b",null,D(e.apiVersion),1)]),_:1,__:[10]})]),_:1})):g("",!0)]),_:1}),I(F,{color:e.footerColor,btns:e.btns},null,8,["color","btns"])]),_:1})}]]);class Nt extends Te{constructor(){super(),e(this,"regenerate",void 0),this.regenerate=!1}setRegenerate(e){this.regenerate=e}requestIDSRWeekly(){return this.getReport("generate_weekly_idsr_report",{request:"true"})}requestIDSRMonthly(){return this.getReport("generate_monthly_idsr_report",{request:"true"})}renderResults(e){const t=[];let i=1;for(const[n,a]of Object.entries(e)){const e=[],o=a,r={id:0,name:"",lessThanFiveYears:"",lessThanFiveYearsPatientIds:"",greaterThanEqualFiveYears:"",greaterThanEqualFiveYearsPatientIds:"",total:0,totalPatientIds:""};r.name=n;let s=0;r.id=i,i+=1;for(const[t,i]of Object.entries(o)){const n=i;null!=n&&(s+=n.length,r.total=s,n.length&&(e.push(...n),r.totalPatientIds=e),"<5yrs"==t&&(r.lessThanFiveYears=n.length,r.lessThanFiveYearsPatientIds=n),">=5yrs"==t&&(r.greaterThanEqualFiveYears=n.length,r.greaterThanEqualFiveYearsPatientIds=n))}t.push(r)}return t}getCSVString(e){let t="Diseases/Events/Conditions, <5 yrs, >=5 yrs, Total,\n";for(const i of e)t+=`${i.name},${i.lessThanFiveYears},${i.greaterThanEqualFiveYears},${i.total},\n`;return{CSVString:t}}static async getReportEpiWeeks(){const e=[];return(await ie.getJson("get_weeks")).reverse().forEach(t=>{const i=t[1].split(" "),n=i[0],a=i[2],o=t[0].split("W"),r=o[0]+"/W"+o[1];e.push({name:r,start:n,end:a})}),e}static async getReportMonths(){const e=[];return(await ie.getJson("get_months")).forEach(t=>{const i=t[1],n=i[0],a=i[1].split("to");e.push({name:n,start:a[0],end:a[1].trim()})}),e}}t("I",Nt);t("_",a({data:()=>({fields:[],report:{},reportReady:!1,period:"",startDate:"",endDate:"",customFileName:"",drillDownCache:{}}),methods:{toDate:e=>oe.toStandardHisDisplayFormat(e),confirmPatient(e){return this.$router.push(`/patients/confirm?person_id=${e}`)},async exportToCustomPDF(e){const t=open("","","width:1024px, height:768px"),i=document.getElementById("report-content");i&&t&&(t.document.write(`\n                    <html>\n                    <head>\n                        <title>${e}</title>\n                        <link rel="stylesheet" media="print" href="/assets/css/cohort.css" />\n                    </head>\n                    <body>\n                        ${i.innerHTML}\n                    </body>\n                    </html>\n                `),setTimeout(()=>{t.print(),t.close()},3500))},async onDrillDown(e,t){if(te.isEmpty(t))return;const i=[[Pe.thTxt("First name"),Pe.thTxt("Last name"),Pe.thTxt("Gender"),Pe.thTxt("Age"),Pe.thTxt("Phone"),Pe.thTxt("Address"),Pe.thTxt("Action")]];return this.drilldownData(e,i,t,async e=>await Promise.all(e.map(async e=>{await ve.findByID(e);const t=new ve;return[Pe.td(t.getGivenName()),Pe.td(t.getFamilyName()),Pe.td(t.getGender()),Pe.td(t.getAge()),Pe.td(t.getPhoneNumber()),Pe.td(`${t.getCurrentDistrict()}, ${t.getCurrentVillage()}, ${t.getClosestLandmark()}`),Pe.tdBtn("Select",async()=>{await B.dismiss({}),this.$router.push({path:`/patient/dashboard/${e}`})})]})))},async drilldownAsyncRows(e,t,i){(await B.create({component:Rt,cssClass:"large-modal",componentProps:{title:e,columns:t,asyncRows:i,showFilters:!0,rowsPerPage:50,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>B.dismiss()}})).present()},async drilldownData(e,t,i,n){(await B.create({component:Rt,cssClass:"large-modal",componentProps:{title:e,columns:t,rows:i,rowParser:n,rowsPerPage:50,showFilters:!0,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>B.dismiss()}})).present()},getDefaultDrillDownTable(){return{rowParser:e=>e.map(async e=>{const[t,i]=e;if(i in this.drillDownCache)return[t];const n=new(await ve.findByID(i)),a=[t,Pe.td(n.getArvNumber()),Pe.td(n.getGender()),Pe.tdDate(n.getBirthdate().toString()),Pe.tdBtn("Show",async()=>{await B.dismiss({}),this.$router.push({path:`/patient/dashboard/${i}`})})];return this.drillDownCache[i]=a,a}),columns:[[Pe.thTxt("ARV number"),Pe.thTxt("Gender"),Pe.thTxt("Birth Date"),Pe.thTxt("Actions")]]}},runTableDrill(e,t="Drilldown patients"){const{columns:i,rowParser:n}=this.getDefaultDrillDownTable();this.drilldownData(t,i,e,n)},drill(e,t="Drill table"){return e&&e.length>0?Pe.tdLink(e.length,()=>this.runTableDrill(e,t)):Pe.td(0)},getEpiweeksFields:()=>[{id:"epiweek",helpText:"Select EPI week",type:je.TT_SELECT,validation:e=>vt.required(e),options:async()=>(await Nt.getReportEpiWeeks()).map(e=>({label:e.name+" - ("+X(e.start).format("DD/MMM/YYYY")+" - "+X(e.end).format("DD/MMM/YYYY")+")",value:e.start,other:e}))}],getMonthlyFields:()=>[{id:"idsrmonth",helpText:"Select Month",type:je.TT_SELECT,validation:e=>vt.required(e),options:async()=>(await Nt.getReportMonths()).map(e=>({label:e.name+" - ("+X(e.start).format("DD/MMM/YYYY")+" - "+X(e.end).format("DD/MMM/YYYY")+")",value:e.start,other:e}))}],getDateDurationFields(e=!1,t=!1,i=5){const n=ie.getSessionDate();return[{id:"quarter",helpText:"Select Quarter",type:je.TT_SELECT,condition:()=>e,validation:e=>vt.required(e),options:()=>{let e=Te.getReportQuarters(i).map(e=>({label:e.name,value:e.start,other:e}));return t&&(e=[{label:"Set custom period",value:"custom_period",other:{}},...e]),e}},...Ct({id:"start_date",helpText:"Start",required:!0,condition:t=>t.quarter&&"custom_period"===t.quarter.value||!e,minDate:()=>"2001-01-01",maxDate:()=>n,estimation:{allowUnknown:!1},computeValue:e=>e}),...Ct({id:"end_date",helpText:"End",required:!0,condition:t=>t.quarter&&"custom_period"===t.quarter.value||!e,unload:(e,t,i,n)=>{"next"===t&&(this.endDate=n.end_date)},minDate:(e,t)=>t.start_date,maxDate:()=>n,estimation:{allowUnknown:!1},computeValue:e=>e})]}}}))}}})}();
