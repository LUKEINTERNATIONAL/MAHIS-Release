System.register(["./vendor-legacy-PwJwfeg2.js","./NavigationMenu-legacy-CzU8JfWw.js","./bottomNavBar-legacy-BUGT-Xdx.js","./index-legacy-CAqY44sk.js","./EIRreportsStore-legacy-Cd898baw.js","./lodash-legacy-C-x9g9Na.js"],(function(e,t){"use strict";var a,l,n,i,o,r,d,s,c,u,m,p,_,g,f,y,v,h,I,b,C,P,k,w,x,D,z,N,S,B,U,V,M,E,j,G,L,O,$,A,Q,F,q,H,R,J,K,T,W,X,Y,Z,ee,te,ae,le;return{setters:[e=>{a=e.d,l=e.S,n=e.V,i=e.er,o=e.es,r=e.et,d=e.b9,s=e.bJ,c=e.d8,u=e.dq,m=e.I,p=e.W,_=e.bq,g=e.aN,f=e.aO,y=e.b8,v=e.aP,h=e.aQ,I=e.D,b=e.G,C=e.ac,P=e.aL,k=e.aM,w=e.bh,x=e.ad,D=e.r,z=e.c,N=e.e4,S=e.K,B=e.eu,U=e.ev,V=e.ew,M=e.cz,E=e.ei,j=e.ex,G=e.ey,L=e.E,O=e.y,$=e.f,A=e.z,Q=e.l,F=e.e,q=e.F,H=e.L,R=e.k,J=e.m,K=e.p,T=e.B,W=e.A},e=>{X=e.N},e=>{Y=e.b},e=>{Z=e.P,ee=e.k,te=e.t,ae=e._},e=>{le=e.E},null],execute:function(){var t=document.createElement("style");t.textContent=".selected-client[data-v-4495dd33]{--background: var(--ion-color-primary-tint);--color: var(--ion-color-primary-contrast)}.selected-client ion-label h2[data-v-4495dd33]{font-weight:700}.client-container[data-v-4495dd33]{position:relative}.sticky-header[data-v-4495dd33]{position:sticky;top:0;z-index:10;background-color:var(--ion-background-color)}.client-details[data-v-4495dd33]{padding-left:16px;padding-right:16px}ion-badge[data-v-4495dd33]{margin-right:8px}ion-card-content ion-icon[data-v-4495dd33]{font-size:1.2em;margin-right:8px}h2[data-v-4495dd33]{font-size:1rem;font-weight:700;color:var(--ion-color-primary)}ion-searchbar[data-v-4495dd33]{--background: var(--ion-color-light);--border-radius: 8px;margin-bottom:1px}ion-item-sliding[data-v-4495dd33]{margin-bottom:8px}.sticky-footer[data-v-4495dd33]{margin-top:auto;position:relative;box-shadow:0 -2px 5px rgba(0,0,0,.1)}ion-footer[data-v-4495dd33]{width:100%;box-shadow:0 -2px 5px rgba(0,0,0,.1)}\n/*$vite$:1*/",document.head.appendChild(t);const ne=a({name:"ClientDeduplication",components:{IonContent:x,IonGrid:w,IonRow:k,IonCol:P,IonList:C,IonItem:b,IonLabel:I,IonCard:h,IonCardHeader:v,IonPage:y,IonCardTitle:f,IonCardContent:g,IonCheckbox:_,IonButton:p,IonIcon:m,IonAvatar:u,IonBadge:c,NavigationMenu:X,IonCardSubtitle:s,IonSearchbar:d,IonItemSliding:r,IonItemOption:o,IonItemOptions:i,IonFooter:n,bottomNavBar:Y,IonHeader:l},setup(){const e=D([]),t=D([]),a=D(null),l=D(33),n=D(""),i=D(0),o=D(1),r=D(10),d=z((()=>!0)),s=async()=>{try{le().setNavigationPayload("Client De-Duplication",!0,!1,"/","home","");const a=await Z.getCachedClientProfileDuplicates(o.value,r.value);e.value=a.results,i.value=a.count,t.value=e.value}catch(a){console.error("Error fetching duplicate clients:",a)}};return{clients:e,filteredClients:t,selectedPrimaryClient:a,toggleClientDetails:e=>{a.value===e?a.value=null:a.value=e},hasSelectedDuplicates:e=>e.duplicates.some((e=>e.selected)),mergeSelected:async e=>{const t=e.duplicates.filter((e=>e.selected)),n={primary:{patient_id:e.primary_patient_id},secondary:t.map((e=>({patient_id:e.secondary_patient_id}))),program_id:l.value};try{console.log("Merge Payload:",n),await Z.mergePatients(n),a.value=null,ee("Clients merged successfully"),await s()}catch(i){console.error("Error merging clients:",i),te("Failed to merge clients. Please try again.")}},programId:l,initNavData:s,getGenderIcon:e=>"M"===e.toUpperCase()?j:G,searchQuery:n,filterClients:()=>{n.value?t.value=e.value.filter((e=>{const t=`${e.primary_given_name} ${e.primary_family_name}`.toLowerCase(),a=n.value.toLowerCase(),l=String(e.primary_patient_id);return t.includes(a)||l.includes(a)})):t.value=e.value},viewDetails:e=>{console.log("View details for:",e)},personCircle:E,calendar:M,fingerPrint:V,location:U,linkOutline:B,chevronDown:S,chevronUp:N,showNavBar:d,totalCount:i,currentPage:o,itemsPer_Page:r,handlePaginationUpdate:async({page:e,itemsPerPage:t})=>{o.value=e,r.value=t,await s()}}},watch:{$route:{handler(e){"Deduplicateclients"===e.name&&this.initNavData()},immediate:!0}},mounted(){this.initNavData()}}),ie={class:"sticky-header"},oe={key:0,class:"client-details"};e("default",ae(ne,[["render",function(e,t,a,l,n,i){const o=L("NavigationMenu"),r=L("ion-searchbar"),d=L("ion-col"),s=L("ion-row"),c=L("ion-header"),u=L("ion-icon"),m=L("ion-avatar"),p=L("ion-label"),_=L("ion-badge"),g=L("ion-item"),f=L("ion-card-subtitle"),y=L("ion-card-header"),v=L("ion-grid"),h=L("ion-card-content"),I=L("ion-card"),b=L("ion-checkbox"),C=L("ion-item-option"),P=L("ion-item-options"),k=L("ion-item-sliding"),w=L("ion-list"),x=L("ion-button"),D=L("ion-content"),z=L("bottomNavBar"),N=L("ion-footer"),S=L("ion-page");return $(),O(S,null,{default:A((()=>[Q(o),Q(c,{style:{"background-color":"transparent"},class:"ion-no-border"},{default:A((()=>[Q(s,null,{default:A((()=>[Q(d,{size:"12","size-md":"10","size-lg":"8","offset-md":"1","offset-lg":"2"},{default:A((()=>[Q(r,{placeholder:"Search clients",modelValue:e.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchQuery=t),onIonInput:e.filterClients},null,8,["modelValue","onIonInput"])])),_:1})])),_:1})])),_:1}),Q(D,null,{default:A((()=>[Q(v,null,{default:A((()=>[Q(s,null,{default:A((()=>[Q(d,{size:"12","size-md":"10","size-lg":"8","offset-md":"1","offset-lg":"2"},{default:A((()=>[Q(I,null,{default:A((()=>[Q(h,null,{default:A((()=>[Q(w,null,{default:A((()=>[($(!0),F(q,null,H(e.filteredClients,(a=>($(),F("div",{key:a.primary_patient_id,class:"client-container"},[R("div",ie,[Q(g,{button:"",onClick:t=>e.toggleClientDetails(a),class:K({"selected-client":e.selectedPrimaryClient===a})},{default:A((()=>[Q(m,{slot:"start"},{default:A((()=>[Q(u,{icon:e.personCircle,size:"large",color:e.selectedPrimaryClient===a?"primary":"medium"},null,8,["icon","color"])])),_:2},1024),Q(p,null,{default:A((()=>[R("h2",null,T(a.primary_given_name)+" "+T(a.primary_family_name),1),R("p",null,"ID: "+T(a.primary_patient_id),1)])),_:2},1024),Q(_,{color:"warning",slot:"end"},{default:A((()=>[W(T(a.duplicates.length),1)])),_:2},1024),Q(u,{icon:e.selectedPrimaryClient===a?e.chevronUp:e.chevronDown,slot:"end"},null,8,["icon"])])),_:2},1032,["onClick","class"])]),e.selectedPrimaryClient===a?($(),F("div",oe,[Q(I,{style:{"margin-bottom":"10px","margin-top":"5px"}},{default:A((()=>[Q(y,{color:"light"},{default:A((()=>[Q(f,null,{default:A((()=>t[1]||(t[1]=[W("Primary Client Details")]))),_:1,__:[1]})])),_:1}),Q(h,null,{default:A((()=>[Q(v,null,{default:A((()=>[Q(s,null,{default:A((()=>[Q(d,{size:"12","size-md":"6"},{default:A((()=>[Q(g,{lines:"none"},{default:A((()=>[Q(u,{icon:e.calendar,slot:"start",color:"primary"},null,8,["icon"]),Q(p,null,{default:A((()=>[W("Birth Date: "+T(a.primary_birthdate),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),Q(d,{size:"12","size-md":"6"},{default:A((()=>[Q(g,{lines:"none"},{default:A((()=>[Q(u,{icon:e.getGenderIcon(a.primary_gender),slot:"start",color:"primary"},null,8,["icon"]),Q(p,null,{default:A((()=>[W("Gender: "+T(a.primary_gender),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),Q(s,null,{default:A((()=>[Q(d,{size:"12"},{default:A((()=>[Q(g,{lines:"none"},{default:A((()=>[Q(u,{icon:e.location,slot:"start",color:"primary"},null,8,["icon"]),Q(p,{class:"ion-text-wrap"},{default:A((()=>[W(" Address: "+T(a.primary_home_village)+", "+T(a.primary_home_ta)+", "+T(a.primary_home_district),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),Q(I,null,{default:A((()=>[Q(y,{color:"light"},{default:A((()=>[Q(f,null,{default:A((()=>t[2]||(t[2]=[W("Potential Duplicates")]))),_:1,__:[2]})])),_:1}),Q(h,null,{default:A((()=>[Q(w,null,{default:A((()=>[($(!0),F(q,null,H(a.duplicates,(a=>($(),O(k,{key:a.secondary_patient_id},{default:A((()=>[Q(g,null,{default:A((()=>[Q(b,{slot:"start",modelValue:a.selected,"onUpdate:modelValue":e=>a.selected=e},null,8,["modelValue","onUpdate:modelValue"]),Q(p,null,{default:A((()=>[R("h2",null,T(a.secondary_given_name)+" "+T(a.secondary_family_name),1),Q(_,{color:"primary"},{default:A((()=>[W("Match: "+T(a.match_percentage)+"%",1)])),_:2},1024),R("p",null,"ID: "+T(a.secondary_patient_id),1),R("p",null," Birth Date: "+T(a.secondary_birthdate)+" | Gender: "+T(a.secondary_gender),1),R("p",null," Address: "+T(a.secondary_home_village)+", "+T(a.secondary_home_ta)+", "+T(a.secondary_home_district),1)])),_:2},1024)])),_:2},1024),Q(P,{side:"end"},{default:A((()=>[Q(C,{color:"primary",onClick:t=>e.viewDetails(a)},{default:A((()=>t[3]||(t[3]=[W("View")]))),_:2,__:[3]},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024),Q(x,{expand:"block",onClick:t=>e.mergeSelected(a),disabled:!e.hasSelectedDuplicates(a),class:"ion-margin-top"},{default:A((()=>[Q(u,{icon:e.linkOutline,slot:"start"},null,8,["icon"]),t[4]||(t[4]=W(" Merge Selected "))])),_:2,__:[4]},1032,["onClick","disabled"])])):J("",!0)])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),Q(N,{class:"sticky-footer"},{default:A((()=>[Q(s,null,{default:A((()=>[Q(d,{size:"12",style:{"max-width":"100%"}},{default:A((()=>[e.showNavBar?($(),O(z,{key:0,totalItems:e.totalCount,currentPage:e.currentPage,itemsPerPage:e.itemsPer_Page,"onUpdate:pagination":e.handlePaginationUpdate},null,8,["totalItems","currentPage","itemsPerPage","onUpdate:pagination"])):J("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4495dd33"]]))}}}));
