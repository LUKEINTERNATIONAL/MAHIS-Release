import{dL as Ne,dM as Fe,d as te,r as w,w as P,a as ie,O as Y,f as g,u as e,bi as xe,J as r,l as a,I as Me,G as ve,E as Ee,Q as I,K as k,a_ as pe,N as V,L as F,a3 as Pe,a4 as ue,k as y,e as U,m as S,$ as T,p as b,b2 as ee,X as L,a1 as Ae,a0 as ge,bp as he,F as W,P as ne,bq as _e,bs as Be,M as be,c as ae,aS as Oe,aR as Te,dH as Re,aQ as $e,ck as De,cP as Ve,d8 as ye,bu as Le,cy as qe,cx as ze,aP as je,dN as He,dO as Ge,dP as Je,dQ as Qe,dR as Ye,dS as Ke,dT as Xe,dU as Ze,ao as We,ci as Q,U as Ue,a6 as re,bz as ea,dV as aa,a5 as we,d1 as ta,d2 as oe,cu as sa,a7 as la}from"./vendor-BgCOLJ26.js";import{N as ra}from"./NavigationMenu-mjE1zW1S.js";import{E as oa}from"./EIRreportsStore-DQSDCNX1.js";import{B as na}from"./bottomNavBar-Bb3USMpq.js";import{a8 as ia,av as Se,U as ke,aw as ua,J as da,H as ca,s as Z,_ as de,ax as Ie}from"./index-zKIUFVbm.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-2AIekHyJ.js";function ma(){const C=()=>{const p="0123456789ABCDEF";let u="";for(let m=0;m<6;m++)u+=p[Math.floor(Math.random()*16)];return u};return{getAvatarUrl:(p,u=128)=>{const m="".concat(p),_=Ne(Fe,{seed:m,size:u,backgroundColor:[C()]}).toString(),E=unescape(encodeURIComponent(_));return"data:image/svg+xml;base64,".concat(btoa(E))}}}const fa=()=>{const C="programs",A=Se;async function p(m){const v=await A.getAll(C,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve programs.")}async function u(){const m=await ia.getAllPrograms(),v=[];return m.forEach(_=>{v.push({name:_.name,other:_,selected:!1})}),m}return{getPrograms:p,getEMRPrograms:u}},va=fa(),pa=()=>{const C="roles",A=Se;async function p(m){const v=await A.getAll(C,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve user roles.")}async function u(){return await ke.getAllRoles()}return{getUserRoles:p,getEMRUserRoles:u}},ga=pa(),ha={key:0,class:"error-message"},_a={key:1,class:"error-message"},ya={key:2,class:"error-message"},Ua={key:3,class:"error-message"},wa={key:5,class:"error-message"},Ia={key:0,class:"error-message"},Ca={style:{display:"flex",gap:"20px","margin-top":"8px"}},ba={key:6,class:"error-message"},Sa={key:7,class:"error-message"},ka={key:8,class:"error-message"},Na={class:"form_el"},Ce=36,Fa=te({__name:"UserFormModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["save","close"],setup(C,{emit:A}){const p=C,u=A,m=w(!1),v=w(null),_=w([]),E=w({}),x=w(),s=w({name:!1,firstName:!1,lastName:!1,password:!1,dateOfBirth:!1,gender:!1,roles:!1,programs:!1,usernameExists:!1}),n=w({name:"",firstName:"",lastName:"",password:"",gender:"",roles:[],programs:[]}),M=w([]),O=w([]);function q(o){const i=o.value.formattedDate;x.value=ca.toStandardHisFormat(i),s.value.dateOfBirth=!1}function B(){v.value?m.value=!1:m.value=!0}const z=o=>{v.value=o.selected_location,B()},R=()=>{n.value={name:"",firstName:"",lastName:"",password:"",dateOfBirth:"",gender:"",facility:null,roles:[],programs:[]},x.value=null,v.value=null,E.value={},m.value=!1,Object.keys(s.value).forEach(o=>{s.value[o]=!1})},$=()=>{var i;s.value.name=!1,s.value.firstName=!1,s.value.lastName=!1,s.value.password=!1,s.value.dateOfBirth=!1,s.value.gender=!1,s.value.roles=!1,s.value.programs=!1;let o=!0;return n.value.name.trim()||(s.value.name=!0,o=!1),n.value.firstName.trim()||(s.value.firstName=!0,o=!1),n.value.lastName.trim()||(s.value.lastName=!0,o=!1),!p.editingUser&&!((i=n.value.password)!=null&&i.trim())&&(s.value.password=!0,o=!1),x.value||(s.value.dateOfBirth=!0,o=!1),n.value.gender||(s.value.gender=!0,o=!1),n.value.roles.length||(s.value.roles=!0,o=!1),n.value.programs.length||(s.value.programs=!0,o=!1),o},D=()=>{if(!p.editingUser){const o=M.value.find(i=>i.program_id===Ce);o&&(n.value.programs=[o.name],s.value.programs=!1)}},K=async()=>{try{const f=(await va.getEMRPrograms()).filter(N=>N.program_id===Ce);M.value=f.map(N=>({program_id:N.program_id,name:N.name})),D()}catch(o){console.error("Failed to fetch programs:",o),Z("Failed to load programs.")}},j=async()=>{try{const i=await ga.getUserRoles();O.value=i.map(f=>f.name)}catch(o){Z("Failed to load roles.")}},H=async o=>{const i=p.editingUser?p.editingUser.name!==o:!0;if(!o.trim()||!i)return s.value.usernameExists=!1,!0;try{const N=(await ke.doesUsernameExist(o)).exists===!0;return s.value.usernameExists=N,!N}catch(f){return console.error("Error checking username existence:",f),Z("Failed to verify username availability. Proceeding with caution."),s.value.usernameExists=!1,!0}};P(()=>n.value.name,async o=>{o.trim()?(s.value.name=!1,await H(o)):(s.value.name=!0,s.value.usernameExists=!1)}),P(()=>n.value.firstName,()=>{n.value.firstName.trim()&&(s.value.firstName=!1)}),P(()=>n.value.lastName,()=>{n.value.lastName.trim()&&(s.value.lastName=!1)}),P(()=>n.value.password,()=>{var o;(o=n.value.password)!=null&&o.trim()&&(s.value.password=!1)}),P(()=>n.value.gender,()=>{n.value.gender&&(s.value.gender=!1)}),P(()=>n.value.roles,()=>{n.value.roles.length>0&&(s.value.roles=!1)}),P(()=>n.value.programs,()=>{n.value.programs.length>0&&(s.value.programs=!1)}),P(()=>p.editingUser,o=>{if(o){const i=o.name.split(" "),f=i[0]||"",N=i.length>1?i.slice(1).join(" "):"";n.value={name:o.name,firstName:f,lastName:N,dateOfBirth:o.dateOfBirth||"",gender:o.gender||"",facility:o.facility||null,roles:o.roles,programs:o.programs},o.dateOfBirth&&(x.value=o.dateOfBirth),o.facility&&(v.value=o.facility,E.value=o.facility)}else R(),D()},{immediate:!0}),P(()=>p.isOpen,o=>{o&&!p.editingUser&&(R(),D())});const d=async()=>{const o=$();B();const i=await H(n.value.name);if(!o||m.value||!i){!o||m.value?Z("Please fill out all required fields."):i||Z("The chosen username is already taken.");return}const f=n.value.programs.map(X=>{const se=M.value.find(t=>t.name===X);return se?se.program_id:null}).filter(X=>X!==null),N={...n.value,dateOfBirth:x.value,facility:v.value,programIDs:f};u("save",N)},G=()=>{u("close")};return ie(()=>{R(),K(),j()}),(o,i)=>(g(),Y(e(xe),{"is-open":C.isOpen,onDidDismiss:G},{default:r(()=>[a(e(Me),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(Ee),null,{default:r(()=>[I(k(C.editingUser?"Edit User":"Add New User"),1)]),_:1}),a(e(pe),{slot:"end"},{default:r(()=>[a(e(V),{onClick:G,fill:"clear"},{default:r(()=>[a(e(F),{style:{"font-size":"35px"},icon:e(Pe)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ue),{class:"ion-padding"},{default:r(()=>[y("form",{id:"user-form",onSubmit:Be(d,["prevent"])},[a(e(T),{class:b({"error-item":s.value.name||s.value.usernameExists})},{default:r(()=>[a(e(ee),{modelValue:n.value.name,"onUpdate:modelValue":i[0]||(i[0]=f=>n.value.name=f),label:"Username","label-placement":"stacked",placeholder:"Enter username",required:"",class:b({"error-input":s.value.name||s.value.usernameExists})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.name?(g(),U("div",ha," Username is required ")):s.value.usernameExists?(g(),U("div",_a," This username is already taken. ")):S("",!0),a(e(T),{class:b({"error-item":s.value.firstName})},{default:r(()=>[a(e(ee),{modelValue:n.value.firstName,"onUpdate:modelValue":i[1]||(i[1]=f=>n.value.firstName=f),label:"First Name","label-placement":"stacked",placeholder:"Enter first name",required:"",class:b({"error-input":s.value.firstName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.firstName?(g(),U("div",ya," First name is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.lastName})},{default:r(()=>[a(e(ee),{modelValue:n.value.lastName,"onUpdate:modelValue":i[2]||(i[2]=f=>n.value.lastName=f),label:"Last Name","label-placement":"stacked",placeholder:"Enter last name",required:"",class:b({"error-input":s.value.lastName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.lastName?(g(),U("div",Ua," Last name is required ")):S("",!0),C.editingUser?S("",!0):(g(),Y(e(T),{key:4,class:b({"error-item":s.value.password})},{default:r(()=>[a(e(ee),{modelValue:n.value.password,"onUpdate:modelValue":i[3]||(i[3]=f=>n.value.password=f),label:"Password","label-placement":"stacked",placeholder:"Enter password",type:"password",required:"",class:b({"error-input":s.value.password})},null,8,["modelValue","class"])]),_:1},8,["class"])),s.value.password&&!C.editingUser?(g(),U("div",wa," Password is required ")):S("",!0),y("div",{class:b(["form_el",{"error-section":s.value.dateOfBirth}])},[y("h6",{style:{"font-size":"16px","font-weight":"400"},class:b({"error-label":s.value.dateOfBirth})}," Date Of Birth ",2),a(ua,{place_holder:"Date Of Birth",onDateUpDated:q,date_prop:""}),s.value.dateOfBirth?(g(),U("div",Ia," Date of birth is required ")):S("",!0)],2),a(e(T),{class:b({"error-item":s.value.gender})},{default:r(()=>[a(e(L),{position:"stacked",class:b({"error-label":s.value.gender})},{default:r(()=>[...i[7]||(i[7]=[I("Gender",-1)])]),_:1},8,["class"]),a(e(Ae),{modelValue:n.value.gender,"onUpdate:modelValue":i[4]||(i[4]=f=>n.value.gender=f)},{default:r(()=>[y("div",Ca,[a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"male"}),a(e(L),null,{default:r(()=>[...i[8]||(i[8]=[I("Male",-1)])]),_:1})]),_:1}),a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"female"}),a(e(L),null,{default:r(()=>[...i[9]||(i[9]=[I("Female",-1)])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["class"]),s.value.gender?(g(),U("div",ba," Gender is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.roles})},{default:r(()=>[a(e(he),{modelValue:n.value.roles,"onUpdate:modelValue":i[5]||(i[5]=f=>n.value.roles=f),label:"Roles","label-placement":"stacked",placeholder:"Select roles",multiple:"",class:b({"error-input":s.value.roles})},{default:r(()=>[(g(!0),U(W,null,ne(O.value,f=>(g(),Y(e(_e),{key:f,value:f},{default:r(()=>[I(k(f),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.roles?(g(),U("div",Sa," At least one role is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.programs})},{default:r(()=>[a(e(he),{modelValue:n.value.programs,"onUpdate:modelValue":i[6]||(i[6]=f=>n.value.programs=f),label:"Programs","label-placement":"stacked",placeholder:"Select programs",multiple:"",class:b({"error-input":s.value.programs})},{default:r(()=>[(g(!0),U(W,null,ne(M.value,f=>(g(),Y(e(_e),{key:f.id,value:f.name},{default:r(()=>[I(k(f.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.programs?(g(),U("div",ka," At least one program is required ")):S("",!0),y("div",Na,[i[10]||(i[10]=y("h6",{style:{"font-size":"16px","font-weight":"400"}},"Facility",-1)),a(da,{show_error:m.value,onFacilitySelected:z,selected_district_ids:_.value,selected_location:E.value},null,8,["show_error","selected_district_ids","selected_location"])])],32)]),_:1}),a(e(be),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(pe),{slot:"end"},{default:r(()=>[y("div",null,[a(e(V),{onClick:G,fill:"solid"},{default:r(()=>[...i[11]||(i[11]=[I(" Cancel ",-1)])]),_:1}),a(e(V),{onClick:d,fill:"solid",style:{"margin-left":"10px","margin-right":"10px"}},{default:r(()=>[I(k(C.editingUser?"Update":"Create")+" User ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]))}}),xa=de(Fa,[["__scopeId","data-v-1e565356"]]),Ma={class:"users-grid"},Ea={class:"user-header"},Pa=["src","alt"],Aa={class:"user-info"},Ba={key:0,class:"user-meta"},Oa={key:0,class:"meta-item"},Ta={key:1,class:"meta-item"},Ra={class:"user-details"},$a={key:0,class:"detail-item"},Da={key:1,class:"detail-item"},Va={key:2,class:"detail-item"},La={class:"detail-item"},qa={class:"detail-item"},za={class:"action-buttons"},ja={key:0,class:"empty-state"},Ha=te({__name:"miUsersTemplate",props:{initialSearchTerm:{default:""},initialStatusFilter:{default:"all"},initialItemsPerPage:{default:6},enableSearch:{type:Boolean,default:!0},enableStatusFilter:{type:Boolean,default:!0},enablePagination:{type:Boolean,default:!0},searchPlaceholder:{default:"Search users..."},searchDebounceTime:{default:300}},emits:["search-changed","status-filter-changed","users-filtered","user-edited","user-deleted","user-status-changed","user-created"],setup(C,{expose:A,emit:p}){const u=C,m=p,v=w([]),_=w(u.initialSearchTerm),E=w(u.initialStatusFilter),x=w(1),s=w(u.initialItemsPerPage),n=w(!1),M=w(null);let O=null;const q=t=>{var l,h,J,ce,me,fe;const{getAvatarUrl:c}=ma();return{id:t.id,name:t.username,email:t.username,dateOfBirth:(l=t.profile)==null?void 0:l.dateOfBirth,gender:(h=t.profile)==null?void 0:h.gender,facility:(ce=(J=t.facilities)==null?void 0:J[0])!=null&&ce.facility?{name:t.facilities[0].facility.facility_name,code:t.facilities[0].facility.facility_code}:null,roles:((me=t.roles)==null?void 0:me.map(le=>le.role.name))||[],programs:((fe=t.programs)==null?void 0:fe.map(le=>le.program.name))||[],status:"active",avatar:c(t.username),createdAt:new Date(t.createdAt),lastActive:new Date(t.updatedAt)}},B=ae(()=>{let t=v.value;if(u.enableSearch&&_.value){const c=_.value.toLowerCase();t=t.filter(l=>l.name.toLowerCase().includes(c)||l.email.toLowerCase().includes(c)||l.roles&&l.roles.some(h=>h.toLowerCase().includes(c))||l.programs&&l.programs.some(h=>h.toLowerCase().includes(c))||l.gender&&l.gender.toLowerCase().includes(c)||l.facility&&l.facility.name&&l.facility.name.toLowerCase().includes(c))}return u.enableStatusFilter&&E.value!=="all"&&(t=t.filter(c=>c.status===E.value)),t}),z=ae(()=>{if(!u.enablePagination)return B.value;const t=(x.value-1)*s.value,c=t+s.value;return B.value.slice(t,c)});P(()=>_.value,t=>{O&&clearTimeout(O),O=setTimeout(()=>{m("search-changed",t),x.value=1},u.searchDebounceTime)},{immediate:!1}),P(()=>E.value,t=>{m("status-filter-changed",t),x.value=1},{immediate:!1}),P(()=>B.value,t=>{m("users-filtered",t)},{deep:!0,immediate:!0});const R=t=>{x.value=t.page,s.value=t.itemsPerPage},$=t=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t),D=t=>{const c=new Date,l=new Date(t);let h=c.getFullYear()-l.getFullYear();const J=c.getMonth()-l.getMonth();return(J<0||J===0&&c.getDate()<l.getDate())&&h--,h},K=t=>{M.value=t,n.value=!0},j=()=>{n.value=!1,M.value=null},H=async t=>{try{if(M.value){const c=v.value.findIndex(h=>h.id===M.value.id);if(c!==-1){const h={...v.value[c],...t};v.value[c]=h,m("user-edited",h)}(await Q.create({message:"User updated successfully",duration:2e3,color:"success"})).present()}else{const c=await d(t),l=await Ie.register(c),h=q(l);h&&(v.value.push(h),m("user-created",h),(await Q.create({message:"User created successfully",duration:2e3,color:"success"})).present())}j()}catch(c){(await Q.create({message:"Error saving user: ".concat(c),duration:2e3,color:"danger"})).present()}},d=async t=>{if(!t||!t.facility)throw new Error("Invalid user data. 'facility' is required.");return{username:t.name,password:t.password,roles:t.roles,programs:t.programs,programIds:t.programIDs,facilities:[t.facility.code],profile:{firstName:t.firstName,lastName:t.lastName,gender:t.gender,dateOfBirth:"1990-01-01T00:00:00.000Z"}}},G=async t=>{(await Ue.create({header:"Confirm Status Change",message:"Are you sure you want to ".concat(t.status==="active"?"deactivate":"activate"," ").concat(t.name,"?"),buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:()=>{t.status=t.status==="active"?"inactive":"active",m("user-status-changed",t),Q.create({message:"User ".concat(t.status==="active"?"activated":"deactivated"," successfully"),duration:2e3,color:"success"}).then(l=>l.present())}}]})).present()},o=async t=>{(await Ue.create({header:"Confirm Delete",message:"Are you sure you want to delete ".concat(t.name,"? This action cannot be undone."),buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{const l=v.value.findIndex(h=>h.id===t.id);l!==-1&&(v.value.splice(l,1),m("user-deleted",t.id),Q.create({message:"User deleted successfully",duration:2e3,color:"success"}).then(h=>h.present()))}}]})).present()},i=t=>{_.value=t},f=t=>{E.value=t},N=async()=>{try{const t=await Ie.getUsers();v.value=t.map(q)}catch(t){console.error("Failed to fetch MIUM users:",t),Q.create({message:"Failed to load users.",duration:2e3,color:"danger"}).then(c=>c.present())}},X=()=>{M.value=null,n.value=!0};return ie(async()=>{await N()}),A({setSearchTerm:i,setStatusFilter:f,refreshUsers:N,cleanup:()=>{O&&clearTimeout(O)},openAddUserModal:X,users:v.value,filteredUsers:B,paginatedUsers:z}),(t,c)=>(g(),U(W,null,[a(e(ue),{class:"ion-padding",style:{height:"80vh"}},{default:r(()=>[y("div",Ma,[(g(!0),U(W,null,ne(z.value,l=>(g(),Y(e(Oe),{key:l.id,class:"user-card"},{default:r(()=>[a(e(Te),null,{default:r(()=>[y("div",Ea,[a(e(Re),null,{default:r(()=>[y("img",{src:l.avatar,alt:l.name},null,8,Pa)]),_:2},1024),y("div",Aa,[a(e($e),null,{default:r(()=>[I(k(l.name),1)]),_:2},1024),a(e(De),null,{default:r(()=>[I(k(l.email),1)]),_:2},1024),l.gender||l.dateOfBirth?(g(),U("div",Ba,[l.gender?(g(),U("span",Oa,[a(e(F),{icon:e(Ve),class:"meta-icon"},null,8,["icon"]),I(" "+k(l.gender),1)])):S("",!0),l.dateOfBirth?(g(),U("span",Ta,[a(e(F),{icon:e(ye),class:"meta-icon"},null,8,["icon"]),I(" "+k(D(l.dateOfBirth))+" years old ",1)])):S("",!0)])):S("",!0)]),a(e(Le),{color:l.status==="active"?"success":"medium",class:"status-chip"},{default:r(()=>[a(e(F),{icon:l.status==="active"?e(qe):e(ze),slot:"start"},null,8,["icon"]),a(e(L),null,{default:r(()=>[I(k(l.status),1)]),_:2},1024)]),_:2},1032,["color"])])]),_:2},1024),a(e(je),null,{default:r(()=>[y("div",Ra,[l.roles&&l.roles.length?(g(),U("div",$a,[a(e(F),{icon:e(He),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.roles.join(", ")),1)])):S("",!0),l.programs&&l.programs.length?(g(),U("div",Da,[a(e(F),{icon:e(Ge),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.programs.join(", ")),1)])):S("",!0),l.facility?(g(),U("div",Va,[a(e(F),{icon:e(Je),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.facility.name||"Assigned Facility"),1)])):S("",!0),y("div",La,[a(e(F),{icon:e(ye),class:"detail-icon"},null,8,["icon"]),y("span",null,"Joined "+k($(l.createdAt)),1)]),y("div",qa,[a(e(F),{icon:e(Qe),class:"detail-icon"},null,8,["icon"]),y("span",null,"Last active "+k($(l.lastActive)),1)])]),y("div",za,[a(e(V),{onClick:h=>K(l),fill:"outline",size:"small",color:"primary"},{default:r(()=>[a(e(F),{icon:e(Ye),slot:"start"},null,8,["icon"]),c[0]||(c[0]=I(" Edit ",-1))]),_:1},8,["onClick"]),a(e(V),{onClick:h=>G(l),fill:"outline",size:"small",color:l.status==="active"?"warning":"success"},{default:r(()=>[a(e(F),{icon:l.status==="active"?e(Ke):e(Xe),slot:"start"},null,8,["icon"]),I(" "+k(l.status==="active"?"Deactivate":"Activate"),1)]),_:2},1032,["onClick","color"]),a(e(V),{onClick:h=>o(l),fill:"outline",size:"small",color:"danger"},{default:r(()=>[a(e(F),{icon:e(Ze),slot:"start"},null,8,["icon"]),c[1]||(c[1]=I(" Delete ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),B.value.length===0?(g(),U("div",ja,[a(e(F),{icon:e(We),class:"empty-icon"},null,8,["icon"]),c[2]||(c[2]=y("h3",null,"No users found",-1)),c[3]||(c[3]=y("p",null,"Try adjusting your search or filter criteria",-1))])):S("",!0)]),_:1}),a(e(be),null,{default:r(()=>[a(na,{"total-items":B.value.length,"current-page":x.value,"items-per-page":s.value,"onUpdate:pagination":R},null,8,["total-items","current-page","items-per-page"])]),_:1}),a(xa,{"is-open":n.value,"editing-user":M.value,onSave:H,onClose:j},null,8,["is-open","editing-user"])],64))}}),Ga=de(Ha,[["__scopeId","data-v-8f4430d8"]]),Ja=te({__name:"UserNav",props:{searchTerm:{type:String,required:!0},statusFilter:{type:String,required:!0}},emits:["update:searchTerm","update:statusFilter","openAddUserModal"],setup(C,{emit:A}){return(p,u)=>(g(),U(W,null,[a(e(we),{class:"ion-align-items-center"},{default:r(()=>[a(e(re),{size:"8"},{default:r(()=>[a(e(ea),{value:C.searchTerm,onIonInput:u[0]||(u[0]=m=>p.$emit("update:searchTerm",m.detail.value)),placeholder:"Search users...","show-clear-button":"focus",debounce:"300"},null,8,["value"])]),_:1}),a(e(re),{size:"4",class:"ion-text-right"},{default:r(()=>[a(e(V),{onClick:u[1]||(u[1]=m=>p.$emit("openAddUserModal")),fill:"solid"},{default:r(()=>[a(e(F),{icon:e(aa),slot:"start"},null,8,["icon"]),u[3]||(u[3]=I(" Add User ",-1))]),_:1})]),_:1})]),_:1}),a(e(we),{class:"ion-padding-start ion-padding-end"},{default:r(()=>[a(e(re),{size:"12"},{default:r(()=>[a(e(ta),{value:C.statusFilter,onIonChange:u[2]||(u[2]=m=>p.$emit("update:statusFilter",m.detail.value))},{default:r(()=>[a(e(oe),{value:"all"},{default:r(()=>[a(e(L),null,{default:r(()=>[...u[4]||(u[4]=[I("All",-1)])]),_:1})]),_:1}),a(e(oe),{value:"active"},{default:r(()=>[a(e(L),null,{default:r(()=>[...u[5]||(u[5]=[I("Active",-1)])]),_:1})]),_:1}),a(e(oe),{value:"inactive"},{default:r(()=>[a(e(L),null,{default:r(()=>[...u[6]||(u[6]=[I("Inactive",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})],64))}}),Qa={class:"sticky-user-nav"},Ya=te({__name:"miusers",setup(C,{expose:A}){const p=w(""),u=w("all"),m=w([]),v=w(0),_=w();ae(()=>p.value),ae(()=>u.value);const E=d=>{p.value=d,console.log("Search term updated:",d)},x=d=>{u.value=d,console.log("Status filter updated:",d)},s=d=>{p.value!==d&&(p.value=d),console.log("Internal search changed:",d)},n=d=>{u.value!==d&&(u.value=d),console.log("Internal filter changed:",d)},M=d=>{v.value=d.length},O=d=>{console.log("User created:",d)},q=d=>{console.log("User edited:",d)},B=d=>{console.log("User deleted:",d)},z=d=>{console.log("User status changed:",d)},R=()=>{_.value?_.value.openAddUserModal():console.log("usersTemplateRef is not yet available.")},$=async()=>{try{console.log("Loading users...")}catch(d){console.error("Error loading users:",d)}},D=async()=>{oa().setNavigationPayload("Manage Integrated Users",!0,!1,"/","home","")},K=()=>{_.value&&_.value.refreshUsers(),$()},j=d=>{p.value=d,_.value&&_.value.setSearchTerm(d)},H=d=>{u.value=d,_.value&&_.value.setStatusFilter(d)};return ie(async()=>{await D(),await $()}),sa(()=>{_.value&&typeof _.value.cleanup=="function"&&_.value.cleanup()}),A({refreshUsers:K,setSearch:j,setFilter:H,searchTerm:p,statusFilter:u,usersList:m,filteredUsersCount:v}),(d,G)=>(g(),Y(e(la),null,{default:r(()=>[a(ra),a(e(ue),{fullscreen:!0},{default:r(()=>[y("div",Qa,[a(Ja,{fullscreen:!0,searchTerm:p.value,statusFilter:u.value,"onUpdate:searchTerm":E,"onUpdate:statusFilter":x,onOpenAddUserModal:R},null,8,["searchTerm","statusFilter"])]),a(Ga,{ref_key:"usersTemplateRef",ref:_,"initial-users":m.value,"initial-search-term":p.value,"initial-status-filter":u.value,"search-debounce-time":500,"enable-search":!0,"enable-status-filter":!0,"enable-pagination":!0,onSearchChanged:s,onStatusFilterChanged:n,onUsersFiltered:M,onUserCreated:O,onUserEdited:q,onUserDeleted:B,onUserStatusChanged:z},null,8,["initial-users","initial-search-term","initial-status-filter"])]),_:1})]),_:1}))}}),st=de(Ya,[["__scopeId","data-v-5071b8a1"]]);export{st as default};
