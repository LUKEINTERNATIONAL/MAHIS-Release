System.register(["./vendor-legacy-phTeNEOA.js","./index-legacy-41CLX9DW.js","./DemographicBar-legacy-CO--ifUW.js","./TreatmentPlan-legacy-B4f075iG.js","./NextAppointment-legacy-T0gtBDTY.js","./RiskAssessment.vue_vue_type_script_setup_true_lang-legacy-BiHfbkjR.js","./Vitals.vue_vue_type_script_setup_true_lang-legacy-P5O2Idsl.js","./useFormWizard-legacy-CLMa9Z-w.js","./lodash-legacy-C-x9g9Na.js","./formatServerData-legacy-DrpzsaNI.js","./Registration-legacy-Ws1ppGLL.js","./usePatientProfile-legacy-DZRclJI-.js","./apexcharts-legacy-Daa5aA7l.js","./DashBox-legacy-Lr-hc1GH.js","./BasicForm-legacy-DDqkmuHZ.js","./DateInputField-legacy-CEEmuE6F.js","./previousDiagnosis-legacy-B-Z-CTuv.js","./group_validation-legacy-jeYnQFSq.js","./drug_service-legacy-CNo40btO.js","./lab_order-legacy-Bs9jgfpU.js","./drug_prescription_service-legacy-CG6zaMra.js","./ncd_appointment_service-legacy-BmLFMxOU.js","./useLocation-legacy-_cd7egdC.js","./vaccines_service-legacy-CPGusTe9.js","./sms_service-legacy-BaEnSKfs.js","./EIRreportsStore-legacy-B6AukLGs.js","./Export-legacy-CtVwsayK.js","./Outcome-legacy-DhzV4M8D.js"],(function(e,a){"use strict";var t,n,l,s,i,o,c,u,r,v,g,d,p,m,y,f,h,_,b,D,w,S,j,C,x,k,A,I,P,T,R,N,V,B,F,L,z,M,O,E,H,$,J,W,G,Y,q,K,U,X,Z,Q,ee,ae,te,ne,le,se,ie,oe,ce,ue,re,ve,ge,de;return{setters:[e=>{t=e.d,n=e.aI,l=e.ct,s=e.r,i=e.c,o=e.aS,c=e.w,u=e.a,r=e.O,v=e.f,g=e.J,d=e.l,p=e.u,m=e.a7,y=e.k,f=e.m,h=e.i,_=e.bD,b=e.v,D=e.aa,w=e.b7},e=>{S=e.aE,j=e.u,C=e.aF,x=e.aG,k=e.aH,A=e.c,I=e.aI,P=e.f,T=e.Y,R=e.d,N=e.T,V=e.J,B=e.M,F=e.H,L=e.aJ,z=e.aK,M=e.aL,O=e.t,E=e.l,H=e.aM,$=e.G,J=e.aN,W=e.$,G=e.S},e=>{Y=e.D},e=>{q=e.u,K=e.D,U=e.C,X=e.T},e=>{Z=e.u,Q=e.I,ee=e.N,ae=e.M,te=e.s,ne=e.c,le=e.a},e=>{se=e._},e=>{ie=e._},e=>{oe=e.u,ce=e._},e=>{ue=e.l},e=>{re=e.a,ve=e.b},e=>{ge=e.C},e=>{de=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const a={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},pe={class:"back_profile"};e("default",t({__name:"ConsultationPlan",setup(e,{expose:t}){const{onTabBeforeChange:me,currentTabIndex:ye}=oe("Consultation Plan"),{printVisitSummary:fe}=de(),he=n(),_e=l();s([]),s([]),s(!1);const be=s(!0),De=s(!1),we=s(!1),Se=i((()=>({text:we.value?"Saving...":"Finish",icon:we.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:De.value||we.value}))),je=S(),Ce=j(),xe=C(),ke=x();k();const Ae=Z(),Ie=A();I();const Pe=P(),Te=q(),Re=T(),{patient:Ne}=o(Ce),{vitals:Ve}=o(je),{investigations:Be}=o(xe),{diagnosis:Fe}=o(ke),{substance:Le}=o(Pe),{selectedNCDMedicationList:ze}=o(Ae),{FootScreening:Me,visualScreening:Oe,cvScreening:Ee}=o(Te),{sessionDate:He}=o(Re),{apiStatus:$e}=o(R());c(Se,((e,a)=>{console.log("Done button options changed:",{from:a,to:e,currentStep:ye.value,tabsLength:Ye.value.length}),e.disabled!==(null==a?void 0:a.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==a?void 0:a.text)&&console.log(`Done button text changed from "${null==a?void 0:a.text}" to "${e.text}"`)}),{deep:!0}),c(we,((e,a)=>{e!==a&&(console.log(`Saving state changed: ${a} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))}));const Je=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},We=()=>{let e=!1;return aa(),we.value&&(e=!0),De.value=e,!e},Ge=()=>Ie.NCDActivities.map((e=>({title:e,icon:""}))),Ye=s(Ge()),qe=s(null),Ke=s(null),Ue=s(null),Xe=s(null),Ze=s(null),Qe=s(null),ea=s(null),aa=()=>{var e;if(!Ye.value||0===Ye.value.length)return console.log("Tabs not yet initialized"),null;const a=ye.value>=0&&ye.value<Ye.value.length?ye.value:0;switch(null===(e=Ye.value[a])||void 0===e?void 0:e.title){case"Vital Signs":return"Vitals";case"Risk Assessment":return"RiskAssessment";case"Investigations":return"Investigations";case"Diagnosis":return"DiagnosisComponent";case"Complications Screening":return"ComplicationsScreening";case"Treatment Plan":return"TreatmentPlan";case"Next Appointment":return"NextAppointment";default:if(Ie.NCDActivities.length>0)switch(Ie.NCDActivities[0]){case"Vital Signs":return"Vitals";case"Risk Assessment":return"RiskAssessment";case"Investigations":return"Investigations";case"Diagnosis":return"DiagnosisComponent";case"Complications Screening":return"ComplicationsScreening";case"Treatment Plan":return"TreatmentPlan";case"Next Appointment":return"NextAppointment"}return null}},ta=()=>{be.value=!1,setTimeout((()=>{ye.value=0,be.value=!0}),0)},na=()=>{const e=S();e.setVitals(e.getInitialVitals(Ne.value.ID))},la=async()=>{const e=B(He.value,"sessionDate","value")||F.sessionDate(),a=L("vitals");for(let n=0;n<Ye.value.length;n++){const l=Ye.value[n];if("Vital Signs"===l.title)Ye.value[n].icon=sa(e,a)?w:"";else if("Risk Assessment"===l.title){const a=L("substanceAbuse");Ye.value[n].icon=sa(e,a)?w:""}else if("Investigations"===l.title){var t;const a=null==Ne||null===(t=Ne.value)||void 0===t||null===(t=t.labOrders)||void 0===t?void 0:t.saved,l=null==a?void 0:a.filter((a=>F.toStandardHisFormat(e)===F.toStandardHisFormat(a.order_date)));Ye.value[n].icon=(null==l?void 0:l.length)>0?w:""}else if("Diagnosis"===l.title){const a=L("diagnosis");Ye.value[n].icon=sa(e,a)?w:""}else if("Complications Screening"===l.title){const a=L("screening");Ye.value[n].icon=sa(e,a)?w:""}else"Treatment Plan"===l.title&&(ze.value.length>0?Ye.value[n].icon=ae()?w:"":Ye.value[n].icon="")}We()},sa=(e,a)=>{const t=new Date(e);return t.setHours(0,0,0,0),a.some((e=>{const a=new Date(e.obs_datetime);return a.setHours(0,0,0,0),a.getTime()===t.getTime()}))},ia=async(e,a)=>{var t,n;e%1==0&&(ye.value=e),0==a&&(null===(t=qe.value)||void 0===t||t.onSubmit()),1==a&&(null===(n=Ke.value)||void 0===n||n.onSubmit()),4==a&&await(async()=>{const e=[],a=await re(Oe.value),t=await ve(Me.value),n=await re(Ee.value);var l,s,i,o;a.length>0&&e.push({concept_id:await H.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:H.getSessionDate(),child:a}),t.length>0&&e.push({concept_id:await H.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:H.getSessionDate(),child:t}),n.length>0&&e.push(...n),e.length>0?(null!==(s=(l=null!==(o=(i=Ne.value).screening)&&void 0!==o?o:i.screening={}).unsaved)&&void 0!==s||(l.unsaved=[]),Ne.value.screening.unsaved.push(...e),$("Complications saved successfully")):O("No complications data to save")})(),5==a&&await(async()=>{const e=J();if(!ue.isEmpty(e.selectedMedicalAllergiesList)){const a=W(),t=e.selectedMedicalAllergiesList.map((e=>({concept_id:e.concept_id,obs_datetime:G.getSessionDate(),value_coded:e.concept_id,location_id:a.facilityLocation.code,value_text:e.name}))),n=await te(t);Ne.value=Object.assign(Ne.value,n),console.log("Allergies staged successfully:",Ne.value),e.clearSelectedMedicalAllergiesList()}const a=await ne();Ne.value=Object.assign(Ne.value,a);const t=await le().saveNonPharmaTherapyPatientData();Ne.value=Object.assign(Ne.value,t)})(),await z(Ne.value)},oa=async()=>{we.value=!0;try{await M(),await z(Ne.value),await ca(),he.push("patientProfile")}catch(e){console.error("Error saving data:",e),O("Error occurred while saving data. Please try again.")}finally{we.value=!1}},ca=async()=>{"dismiss"!==await E(ge,{class:"small-confirm-modal "})&&await fe()};return u((async()=>{0!==Ie.NCDActivities.length?(q().resetScreening(),Ye.value=Ge(),await la(),(void 0===ye.value||ye.value<0)&&(ye.value=0,console.log("Setting initial tab index to 0")),De.value=!1,we.value=!1,We()):he.push("patientProfile")})),c(ye,(async()=>{await We()})),c(Ve,(async()=>{await la()}),{deep:!0}),c(Ne,(async()=>{q().resetScreening(),await la()}),{deep:!0}),c(He,(async()=>{await la()}),{deep:!0}),c(Be,(async()=>{await la()}),{deep:!0}),c(Fe,(async()=>{await la()}),{deep:!0}),c(Le,(async()=>{await la()}),{deep:!0}),c(ze,(async()=>{await la()}),{deep:!0}),c(_e,(async e=>{ta(),na(),Ye.value=Ge()}),{deep:!0}),c(Ne,(async(e,a)=>{e.ID!=a.ID&&(ta(),na())}),{deep:!0}),t({saveData:oa,markWizard:la,refreshWizard:ta,validateDoneButtonState:We}),(e,t)=>(v(),r(p(D),null,{default:g((()=>[d(N),d(p(m),{fullscreen:!0},{default:g((()=>[d(Y),y("div",a,[be.value?(v(),r(ce,{key:0,ref:"wizard","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:Se.value,"custom-tabs":Ye.value,beforeChange:p(me),onChange:ia,"onComplete:wizard":t[1]||(t[1]=e=>oa()),onDoneButtonChanged:Je},{default:g((()=>[y("div",null,[y("div",pe,[d(V,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:p(_),"font-weight":"600",onClick:t[0]||(t[0]=e=>{he.push("patientProfile")})},null,8,["icon"])])]),h(y("div",null,[d(ie,{ref_key:"vitalsRef",ref:qe},null,512)],512),[[b,"Vitals"==aa()]]),h(y("div",null,[d(se,{ref_key:"riskAssessmentRef",ref:Ke},null,512)],512),[[b,"RiskAssessment"==aa()]]),h(y("div",null,[d(Q,{ref_key:"investigationsRef",ref:Ue},null,512)],512),[[b,"Investigations"==aa()]]),h(y("div",null,[d(K,{ref_key:"diagnosisRef",ref:Xe},null,512)],512),[[b,"DiagnosisComponent"==aa()]]),h(y("div",null,[d(U,{ref_key:"complicationsRef",ref:Ze},null,512)],512),[[b,"ComplicationsScreening"==aa()]]),h(y("div",null,[d(X,{ref_key:"treatmentPlanRef",ref:Qe},null,512)],512),[[b,"TreatmentPlan"==aa()]]),h(y("div",null,[d(ee,{ref_key:"nextAppointmentRef",ref:ea},null,512)],512),[[b,"NextAppointment"==aa()]])])),_:1},8,["doneButton","custom-tabs","beforeChange"])):f("",!0)])])),_:1})])),_:1}))}}))}}}));
