import{d as Z,au as Ye,r as T,c as X,e as V,f as w,by as Be,p as oe,bt as Qe,k as a,l as t,F as ce,P as pe,V as Ze,J as n,u as e,a5 as L,L as _e,W as z,K as b,a4 as J,H as ie,bI as et,Q as d,R as ze,aV as ge,a as Ke,O as K,m as G,bc as ue,N as W,aZ as tt,bv as Pe,_ as A,cX as st,bi as Ne,I as Ee,G as Ue,E as Ae,a_ as Le,a3 as We,M as nt,an as at,w as qe,cW as lt,dL as ot,al as it,ak as ae,aj as rt,dk as fe,b5 as ut}from"./vendor-BeyhA3v1.js";import{l as dt}from"./lodash-Dt8AsbQm.js";import{_ as ee,S as se,J as de,aB as Y,l as he,aC as me,m as j,u as xe,t as ye,aQ as ve,bp as te,O as je,K as ct,j as pt,ag as vt,aW as mt,H as le,P as ft}from"./index-BvO-zzaj.js";import{u as _t}from"./usePatientProfile-Cz9yP2Ut.js";import yt from"./WeightHeightChart-Cnp_ABda.js";import{O as gt,w as ht}from"./weightAndHeight-BR6rEQL_.js";import"./apexcharts-7NjVVO2K.js";import"./Registration-YTafagwv.js";import"./useLocation-B_Z8K33N.js";import"./vaccines_service-BVtyXB0S.js";import"./sms_service-JF7nSAhx.js";import"./EIRreportsStore-BO21Il1P.js";import"./Export-DymHMX4i.js";import"./Outcome-PFd59U0r.js";import"./chartjs-CVspqMSP.js";import"./BasicForm-DleCXnSY.js";import"./DateInputField-FIZEe19Y.js";import"./customDatePicker-CVQFd61A.js";import"./VitalsMixin.vue_vue_type_script_lang-DmsgwzBm.js";import"./formatServerData-CKmrhu8v.js";const xt=["onKeydown"],wt={class:"ripple-container"},bt=["onAnimationend"],Ct={class:"status-badge"},kt={class:"ion-text-wrap"},Tt=Z({__name:"ReferralCard",props:{icon:{type:String,default:Ye},status:{type:String,default:"Referred OPD"},title:{type:String,required:!0},type:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},emits:["pressed","click"],setup(N,{emit:C}){const x=N,D=C,c=T(!1),I=T(null),i=T([]);let v=0;const F=X(()=>{if(x.disabled)return"timeline-item-disabled";switch(x.type){case"hiv":return"timeline-item-hiv";case"hepatitis":return"timeline-item-hepatitis";default:return"timeline-item-default"}}),O=X(()=>{if(x.disabled)return"icon-container-disabled";switch(x.type){case"hiv":return"icon-container-hiv";case"hepatitis":return"icon-container-hepatitis";default:return"icon-container-default"}}),H=l=>{if(x.disabled||!I.value)return;const p=I.value.getBoundingClientRect(),h=Math.max(p.width,p.height)*2;let u,o;if(l.type==="keydown")u=p.width/2-h/2,o=p.height/2-h/2;else{const R=l.type.includes("touch")?l.touches[0].clientX:l.clientX,M=l.type.includes("touch")?l.touches[0].clientY:l.clientY;u=R-p.left-h/2,o=M-p.top-h/2}const y={id:v++,x:u,y:o,size:h,duration:600};i.value.push(y)},m=l=>{const p=i.value.findIndex(h=>h.id===l);p>-1&&i.value.splice(p,1)},g=l=>{x.disabled||(H(l),D("pressed",{type:x.type,title:x.title,status:x.status,event:l}),D("click",l))},$=l=>{x.disabled||(c.value=!0,H(l))},B=()=>{c.value=!1},P=()=>{c.value=!1},r=l=>{x.disabled||(c.value=!0,H(l))},k=()=>{c.value=!1};return(l,p)=>(w(),V("div",{class:oe(["timeline-item",F.value,{"timeline-item-pressed":c.value}]),onClick:g,onMousedown:$,onMouseup:B,onMouseleave:P,onTouchstart:r,onTouchend:k,role:"button",tabindex:"0",onKeydown:[Be(g,["enter"]),Be(Qe(g,["prevent"]),["space"])],ref_key:"timelineElement",ref:I},[a("div",wt,[(w(!0),V(ce,null,pe(i.value,h=>(w(),V("div",{key:h.id,class:"ripple",style:Ze({left:h.x+"px",top:h.y+"px",width:h.size+"px",height:h.size+"px",animationDuration:h.duration+"ms"}),onAnimationend:u=>m(h.id)},null,44,bt))),128))]),t(e(J),null,{default:n(()=>[t(e(L),{class:"ion-text-center"},{default:n(()=>[a("div",null,[t(e(_e),{class:oe(["icon-container",O.value]),icon:N.icon,"aria-hidden":"true"},null,8,["class","icon"])])]),_:1}),t(e(L),{class:"ion-text-center"},{default:n(()=>[t(e(z),null,{default:n(()=>[a("span",Ct,b(N.status),1)]),_:1})]),_:1}),t(e(L),{class:"ion-text-center"},{default:n(()=>[t(e(z),null,{default:n(()=>[a("h2",kt,b(N.title),1)]),_:1})]),_:1})]),_:1})],42,xt))}}),It=ee(Tt,[["__scopeId","data-v-897e90a9"]]),Rt={style:{"padding-left":"10px","padding-right":"10px"}},St={class:"content"},$t={style:{"margin-top":"10px"}},Dt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Ht=Z({__name:"OutcomeSummaryModal",setup(N){T("Detremin");const C=()=>se.getSessionDate();T(null);const x=async()=>{await ze.dismiss(),de("Outcome summary saved successfully.")};return(D,c)=>{const I=ie("ion-button");return w(),V("div",Rt,[a("div",St,[c[2]||(c[2]=a("h4",null,"Outcome Summary",-1)),a("div",null,[c[1]||(c[1]=a("span",null,"Todays Date : ",-1)),a("span",null,b(C()),1)])]),a("div",$t,[t(e(et),{name:"outcome_summary",fill:"outline",placeholder:"Outcome Summary","auto-grow":!0,style:{"min-height":"150px"}})]),a("div",Dt,[t(I,{onClick:c[0]||(c[0]=i=>x())},{default:n(()=>c[3]||(c[3]=[d("Complete")])),_:1,__:[3]})])])}}}),Je=ee(Ht,[["__scopeId","data-v-3b844e45"]]),Mt={style:{"padding-left":"10px","padding-right":"10px"}},Ft={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Vt=Z({__name:"RiskCategoryFollowUpModal",setup(N){const C=T("Detremin"),x=X(()=>[{componentType:"multiSelectInputField",header:"Risk Category",name:"risk_category",obsValueType:"value_text",trackBy:"id",validation:Y.required,onChange:i=>{c()},options:[{id:"1",name:"Sex worker"},{id:"2",name:"MSM"},{id:"3",name:"AGYW"},{id:"4",name:"Client of sex workers"},{id:"5",name:"Female sex workers"},{id:"6",name:"Risk age group"},{id:"7",name:"None"}]},{componentType:"dateInputField",name:"next_appointment",header:"Next Appointment",obsValueType:"value_text",icon:he.scanner,onChange:i=>{c()},validation:Y.required}]),D=T(null),c=()=>{var v,F,O,H,m,g,$;const i=(v=D.value)==null?void 0:v.getFormValues();((F=i==null?void 0:i.test_results)==null?void 0:F.name)=="Reactive"&&((O=i==null?void 0:i.test_type)==null?void 0:O.name)=="Detremin"?C.value="Unigold":((H=i==null?void 0:i.test_results)==null?void 0:H.name)=="Reactive"&&((m=i==null?void 0:i.test_type)==null?void 0:m.name)=="Unigold"?C.value="Bioline":((g=i==null?void 0:i.test_results)==null?void 0:g.name)=="Reactive"&&(($=i==null?void 0:i.test_type)==null?void 0:$.name)=="Bioline"?C.value="Summary":C.value="Detremin"},I=async()=>{await ze.dismiss(),await j(Je,{class:"mediumAutoHeightModal"})};return(i,v)=>{const F=ie("ion-button");return w(),V("div",Mt,[v[3]||(v[3]=a("div",{class:"content"},[a("h4",null,"Risk Category & Follow-up")],-1)),a("div",null,[t(me,{formData:x.value,ref_key:"formRef",ref:D},null,8,["formData"])]),a("div",Ft,[t(F,{color:"danger"},{default:n(()=>v[1]||(v[1]=[d("Cancel")])),_:1,__:[1]}),t(F,{onClick:v[0]||(v[0]=O=>I())},{default:n(()=>v[2]||(v[2]=[d("Save")])),_:1,__:[2]})])])}}}),Ot=ee(Vt,[["__scopeId","data-v-d24f2c34"]]),Bt={style:{"padding-left":"10px","padding-right":"10px"}},Pt={class:"content"},Nt={style:{"text-align":"center",padding:"15px"}},Et={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Ut=Z({__name:"HIVTestingModal",props:{order:{}},setup(N){const C=T(null),x=xe(),{patient:D}=ge(x),c=T([]),I=T(""),i=T(""),v=T(""),F=N,O=X(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:Y.required,type:"inline",onChange:u=>{m()},options:[{label:"Reactive",value:"Reactive"},{label:"Non reactive",value:"Non reactive"}]},{componentType:"radioButtonField",header:"Test Type",name:"test_type",obsValueType:"value_text",type:"inline",validation:Y.required,onChange:u=>{m()},options:[{label:"Detremin",value:"Detremin"},{label:"Unigold",value:"Unigold"},{label:"Bioline",value:"Bioline"}]},{componentType:"inputField",header:"Test Kit Serial Number",name:"test_kit_serial_number",obsValueType:"value_text",icon:he.scanner,onChange:u=>{m()},validation:Y.required}]),H=()=>se.getSessionDate(),m=()=>{var R;const u=(R=C.value)==null?void 0:R.getFormValues();if(!(u!=null&&u.test_results)){i.value="",v.value="";return}const o=u.test_type,y=u.test_results;o==="Detremin"?y==="Non reactive"?(i.value="risk_category",v.value="Continue to Risk Category"):y==="Reactive"&&(i.value="unigold",v.value="Continue to Unigold"):o==="Unigold"?y==="Non reactive"?(i.value="repeat_determine",v.value="Repeat Determine Test"):y==="Reactive"&&(i.value="bioline",v.value="Continue to Bioline"):o==="Bioline"&&(y==="Non reactive"?(i.value="inconclusive",v.value="Schedule Inconclusive Follow-up"):y==="Reactive"&&(i.value="summary",v.value="Continue to Summary"))},g=async()=>{var E,Q;if(((E=C.value)==null?void 0:E.validateForm())!=null){ye("Please fill in all required fields");return}const u=(Q=C.value)==null?void 0:Q.getFormValues(),o=u.test_type;c.value.push({type:o,result:u.test_results});let y=F.order,R="";const M=await ve.getConceptID(y.value_text,!0);y!=null&&y.new_order&&(R=await h(M,y.value_text,"Blood"));const S=await te.buildResults([{name:"HIV test",concept_id:M,value:"".concat(o,"-").concat(u.test_results)}]);await te.saveResults(D.value,S,y.order_obs_id,R,I.value),P(o,u.test_results)?await r(o,u.test_results):de("Test result saved")},$=async()=>{var u,o;if(((u=C.value)==null?void 0:u.validateForm())!=null){ye("Please fill in all required fields");return}switch(await g(),i.value){case"risk_category":await ue.dismiss(),await j(Ot,{class:"mediumAutoHeightModal"});break;case"unigold":case"repeat_determine":case"bioline":(o=C.value)==null||o.resetForm(),m();break;case"inconclusive":await l();break;case"summary":await B();break}},B=async()=>{await ue.dismiss(),await j(Je,{class:"mediumAutoHeightModal"})},P=(u,o)=>u==="Detremin"&&o==="Non reactive"?!1:[...c.value].length>=3,r=async(u,o)=>{const y=c.value,R=y.find(E=>E.type==="Detremin"),M=y.find(E=>E.type==="Unigold"),S=y.find(E=>E.type==="Bioline");(R==null?void 0:R.result)==="Reactive"&&(M==null?void 0:M.result)==="Reactive"&&(S==null?void 0:S.result)==="Reactive"?await k():(S==null?void 0:S.result)==="Non reactive"&&await l()},k=async()=>{await ue.dismiss(),de("Positive result confirmed. Proceeding to ART enrollment.")},l=async()=>{await B(),de("Scheduled 2-week follow-up appointment.")},p=async()=>{var u;try{const o=await te.getLabResults(D.value);if((u=o==null?void 0:o.latestTest)!=null&&u.value){const R=o.latestTest.value.split("-");R.length===2&&(c.value=[{type:R[0],result:R[1]}])}}catch(o){console.error("Error loading previous tests:",o)}},h=async(u,o,y)=>{var E,Q,re,f,s,q;const R=[{concept_id:u,name:o,specimen:y,reason:"Routine",specimenConcept:await ve.getConceptID(y,!0)}],M=await je.buildLabOrders("",R,I.value),S=JSON.parse(JSON.stringify(D.value));return(re=(Q=(E=S.labOrders)!=null?E:S.labOrders={}).unsaved)!=null||(Q.unsaved=[]),(q=(s=(f=S.labOrders)!=null?f:S.labOrders={}).saved)!=null||(s.saved=[]),S.labOrders.unsaved.push(...M),D.value=S,M[0].offline_id};return Ke(async()=>{var u;I.value=(u=F.order)==null?void 0:u.past_date,await p(),m()}),(u,o)=>{const y=ie("ion-button");return w(),V("div",Bt,[a("div",Pt,[o[3]||(o[3]=a("h4",null,"HIV Testing",-1)),a("div",null,[o[2]||(o[2]=a("span",null,"Todays Date : ",-1)),a("span",null,b(H()),1)])]),a("div",null,[t(me,{formData:O.value,ref_key:"formRef",ref:C},null,8,["formData"])]),a("div",Nt,[o[4]||(o[4]=a("span",null,"Reported by: ",-1)),a("span",null,b(e(se).getUserName()),1)]),a("div",Et,[t(y,{onClick:o[0]||(o[0]=R=>g())},{default:n(()=>o[5]||(o[5]=[d("Complete")])),_:1,__:[5]}),i.value?(w(),K(y,{key:0,onClick:o[1]||(o[1]=R=>$())},{default:n(()=>[d(b(v.value),1)]),_:1})):G("",!0)])])}}}),Ge=ee(Ut,[["__scopeId","data-v-266560f4"]]),At={style:{"padding-left":"10px","padding-right":"10px"}},Lt={class:"content"},Wt={style:{"text-align":"center",padding:"15px"}},qt={style:{display:"flex","justify-content":"center",padding:"10px"}},zt=Z({__name:"HepatitisModal",props:{order:{}},setup(N){const C=T(null);let x=T({});const D=xe(),{patient:c}=ge(D),I=T(""),i=N,v=X(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:Y.required,type:"inline",options:[{label:"Positive",value:"Positive"},{label:"Negative",value:"Negative"},{label:"Inconclusive",value:"Inconclusive"}]}]),F=()=>se.getSessionDate(),O=async()=>{var P,r;if(((P=C.value)==null?void 0:P.validateForm())!=null){ye("Please fill in all required fields");return}let m=i.order;I.value=m.past_date;let g="";const $=await ve.getConceptID(m.value_text,!0);x.value=(r=C.value)==null?void 0:r.getFormValues(),m!=null&&m.new_order&&(g=await H($,m.value_text,"Blood"));const B=await te.buildResults([{name:m.value_text,concept_id:$,value:x.value.test_results}]);await te.saveResults(c.value,B,m.order_obs_id,g,I.value),await ue.dismiss()},H=async(m,g,$)=>{var k,l,p,h,u,o;const B=[{concept_id:m,name:g,specimen:$,reason:"Routine",specimenConcept:await ve.getConceptID($,!0)}],P=await je.buildLabOrders("",B,I.value),r=JSON.parse(JSON.stringify(c.value));return(p=(l=(k=r.labOrders)!=null?k:r.labOrders={}).unsaved)!=null||(l.unsaved=[]),(o=(u=(h=r.labOrders)!=null?h:r.labOrders={}).saved)!=null||(u.saved=[]),r.labOrders.unsaved.push(...P),c.value=r,P[0].offline_id};return(m,g)=>{const $=ie("ion-button");return w(),V("div",At,[a("div",Lt,[a("h4",null,b(m.order.value_text)+" Testing",1),a("div",null,[g[1]||(g[1]=a("span",null,"Todays Date : ",-1)),a("span",null,b(F()),1)])]),a("div",null,[t(me,{formData:v.value,ref_key:"formRef",ref:C},null,8,["formData"])]),a("div",Wt,[g[2]||(g[2]=a("span",null,"Reported by: ",-1)),a("span",null,b(e(se).getUserName()),1)]),a("div",qt,[t($,{onClick:g[0]||(g[0]=B=>O())},{default:n(()=>g[3]||(g[3]=[d("Complete")])),_:1,__:[3]})])])}}}),Xe=ee(zt,[["__scopeId","data-v-8a252bcf"]]),Kt={class:"past-test-results"},jt={class:"header"},Jt={class:"test-results-list"},Gt={class:"test-info"},Xt={class:"test-name"},Yt={class:"test-date"},Qt={class:"add-results-section"},Zt={class:"modal-test-results-list"},es={class:"test-info"},ts={class:"test-name"},ss={class:"test-date"},ns=Z({__name:"PastTestResults",props:{results:{default:()=>[]}},emits:["seeFullHistory","enterKnownResults"],setup(N,{emit:C}){const x=N,D=C,c=T(!1),I=T(!1),i=T(null),v=X(()=>x.results||[]),F=X(()=>v.value.slice(0,3)),O=X(()=>[{componentType:"radioButtonField",header:"Select test",name:"test",obsValueType:"value_text",validation:Y.required,type:"standard",options:[{label:"Hepatitis B Test",value:"Hepatitis B Test"},{label:"Hepatitis C Test",value:"Hepatitis C Test"},{label:"HIV test",value:"HIV test"},{label:"Syphilis",value:"Syphilis"}]},{componentType:"dateInputField",header:"Past Date",name:"past_date",validation:Y.required}]),H=k=>{const l=k.toLowerCase();return l.includes("reactive")&&!l.includes("non reactive")?"reactive":l.includes("non reactive")||l.includes("negative")?"non-reactive":(l.includes("inconclusive"),"default")},m=async()=>{var p;const k=(p=i.value)==null?void 0:p.getFormValues(),l={value_text:k.test,new_order:!0,past_date:k.past_date};r(),await g(l)},g=async k=>{k.value_text=="HIV test"&&await j(Ge,{class:"otherVitalsModal"},!0,{order:k}),(k.value_text=="Syphilis"||k.value_text=="Hepatitis B Test"||k.value_text=="Hepatitis C Test")&&await j(Xe,{class:"otherVitalsModal"},!0,{order:k})},$=()=>{I.value=!0},B=()=>{c.value=!0,D("seeFullHistory")},P=()=>{c.value=!1},r=()=>{I.value=!1};return(k,l)=>(w(),V("div",Kt,[a("div",jt,[l[2]||(l[2]=a("h2",{class:"header-title"},"PAST TEST RESULTS",-1)),t(e(W),{fill:"clear",size:"small",class:"see-history-btn",onClick:B},{default:n(()=>[l[1]||(l[1]=d(" See full History ")),t(e(_e),{icon:e(tt),slot:"end"},null,8,["icon"])]),_:1,__:[1]})]),a("div",Jt,[(w(!0),V(ce,null,pe(F.value,(p,h)=>(w(),K(e(A),{key:h,class:"test-result-item",lines:"none"},{default:n(()=>[a("div",Gt,[a("h3",Xt,b(p.name),1),a("p",Yt,b(p.date),1)]),t(e(Pe),{class:oe(["result-chip",H(p.value)]),slot:"end"},{default:n(()=>[d(b(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),a("div",Qt,[t(e(W),{fill:"clear",size:"default",class:"add-results-btn",onClick:l[0]||(l[0]=p=>$())},{default:n(()=>[t(e(_e),{icon:e(st),slot:"start"},null,8,["icon"]),l[3]||(l[3]=d(" Enter Known Past Results "))]),_:1,__:[3]})]),t(e(Ne),{"is-open":c.value,onDidDismiss:P,class:"history-modal"},{default:n(()=>[t(e(Ee),null,{default:n(()=>[t(e(Ue),null,{default:n(()=>[t(e(Ae),null,{default:n(()=>[d("Full Test History ("+b(v.value.length)+")",1)]),_:1}),t(e(Le),{slot:"end"},{default:n(()=>[t(e(W),{onClick:P},{default:n(()=>l[4]||(l[4]=[d("Close")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1}),t(e(We),{class:"modal-content"},{default:n(()=>[a("div",Zt,[(w(!0),V(ce,null,pe(v.value,(p,h)=>(w(),K(e(A),{key:"modal-".concat(h),class:"test-result-item",lines:"none"},{default:n(()=>[a("div",es,[a("h3",ts,b(p.name),1),a("p",ss,b(p.date),1)]),t(e(Pe),{class:oe(["result-chip",H(p.value)]),slot:"end"},{default:n(()=>[d(b(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))])]),_:1})]),_:1},8,["is-open"]),t(e(Ne),{"is-open":I.value,onDidDismiss:r,class:"history-modal"},{default:n(()=>[t(e(Ee),null,{default:n(()=>[t(e(Ue),null,{default:n(()=>[t(e(Ae),null,{default:n(()=>l[5]||(l[5]=[d("Select Test and Date")])),_:1,__:[5]}),t(e(Le),{slot:"end"},{default:n(()=>[t(e(W),{onClick:r},{default:n(()=>l[6]||(l[6]=[d("Close")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1}),t(e(We),{class:"modal-content"},{default:n(()=>[t(me,{formData:O.value,ref_key:"formRef",ref:i},null,8,["formData"])]),_:1}),t(e(nt),{style:{padding:"10px"}},{default:n(()=>[t(ct,{style:{float:"right"},name:"Cont.",onClick:m})]),_:1})]),_:1},8,["is-open"])]))}}),as=ee(ns,[["__scopeId","data-v-29352a6b"]]),ls={style:{"max-width":"900px",margin:"auto"}},os={style:{"--background":"#fff"}},is={class:"demographics"},rs={style:{"text-overflow":"ellipsis"}},us={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},ds={style:{"margin-right":"5px"}},cs={style:{"margin-top":"5px"}},ps={class:"demographicsFirstRow"},vs={class:"name custom-name-container"},ms={class:"demographicsOtherRow",style:{"margin-top":"10px"}},fs={class:"demographicsText",style:{display:"flex","flex-wrap":"wrap"}},_s={style:{"flex-shrink":"0"}},ys={style:{"flex-shrink":"0"}},gs={key:0,class:"demographicsOtherRow"},hs={class:"demographicsText mediumFontColor"},xs={key:1,class:"demographicsOtherRow"},ws={class:"demographicsText mediumFontColor"},bs={class:"demographicsOtherRow"},Cs={class:"demographicsText smallFont"},ks={class:"mediumFontColor"},Ts={style:{background:"transparent"}},Is={class:"graphSection"},Rs={class:"graphBtn",style:{"margin-bottom":"5px"}},Ss={class:"weightHeightGraphBtns"},$s={key:0},Ds={key:1},Hs={class:"test-results-container"},Ms={class:"test-buttons-container"},Fs={style:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},Vs={class:"ion-padding",slot:"content"},Os=Z({__name:"HTSPatientProfile",setup(N){const{event:C,popoverOpen:x,openPopover:D,openPIM:c,printVisitSummary:I,printID:i,formatCurrentAddress:v}=_t(),F=at(),O=he,H=T(!1),m=T(7),g=T([]),$=T([]),B=T([]),P=xe(),{patient:r}=ge(P),k=async f=>{m.value=f},l=async()=>{const f=te.getLabResults(r.value);B.value=f.results},p=async()=>{var f;$.value=await se.getJson("/hts_referral_orders",{patient_id:(f=r.value)==null?void 0:f.patientID,filter_by_lab_result:!0})},h=async()=>{var s;const f=await vt.getObsByEncounterId(mt.REFERRAL);g.value=((s=f[0])==null?void 0:s.obs)||[]},u=f=>le.calculateDisplayAge(le.toStandardHisFormat(f)),o=()=>{var f,s,q,ne;dt.isEmpty((s=(f=r.value)==null?void 0:f.personInformation)==null?void 0:s.birthdate)||(H.value=le.dateDiffInDays(le.sessionDate(),(ne=(q=r.value)==null?void 0:q.personInformation)==null?void 0:ne.birthdate)<42)},y=()=>{j(gt,{class:"otherVitalsModal"})},R=()=>{j(ht,{class:"otherVitalsModal"})},M=async f=>{f.value_text=="HIV test"&&await j(Ge,{class:"otherVitalsModal"},!0,{order:f}),(f.value_text=="Syphilis"||f.value_text=="Hepatitis B Test"||f.value_text=="Hepatitis C Test")&&await j(Xe,{class:"otherVitalsModal"},!0,{order:f})},S=()=>!!new ft().isUnderFive(),E=()=>{console.log("Navigate to full history")},Q=()=>{console.log("Enter known results")},re=()=>{var f,s;return le.toStandardHisDisplayFormat((s=(f=r.value)==null?void 0:f.personInformation)==null?void 0:s.birthdate)};return qe(()=>F.currentRoute.value,async f=>{f.name=="patientProfile"&&r.value.patientID}),qe(r,async()=>{r&&(o(),await l(),await p())}),Ke(async()=>{o(),await h(),await p(),await l()}),(f,s)=>{var ne,we,be,Ce,ke,Te,Ie,Re,Se,$e,De,He,Me,Fe,Ve,Oe;const q=ie("ion-icon");return w(),V("div",ls,[a("div",os,[a("div",is,[a("div",rs,[a("div",us,[a("div",ds,[t(e(J),null,{default:n(()=>[t(e(L),null,{default:n(()=>{var _,U;return[a("div",{class:oe(((U=(_=e(r))==null?void 0:_.personInformation)==null?void 0:U.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor"),style:{display:"flex","flex-direction":"column","align-items":"center"}},[t(q,{style:{color:"#fff","font-size":"100px"},icon:e(lt)},null,8,["icon"])],2)]}),_:1})]),_:1}),t(e(J),null,{default:n(()=>[t(e(L),null,{default:n(()=>s[15]||(s[15]=[a("span",{class:"pill-text"},"Returning Client",-1)])),_:1,__:[15]})]),_:1})]),a("div",cs,[a("div",ps,[a("div",vs,[(we=(ne=e(r))==null?void 0:ne.personInformation)!=null&&we.given_name?(w(),K(e(J),{key:0,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var _,U;return[d(b((U=(_=e(r))==null?void 0:_.personInformation)==null?void 0:U.given_name),1)]}),_:1})]),_:1})):G("",!0),(Ce=(be=e(r))==null?void 0:be.personInformation)!=null&&Ce.middle_name?(w(),K(e(J),{key:1,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var _,U;return[d(b((U=(_=e(r))==null?void 0:_.personInformation)==null?void 0:U.middle_name),1)]}),_:1})]),_:1})):G("",!0),(Te=(ke=e(r))==null?void 0:ke.personInformation)!=null&&Te.family_name?(w(),K(e(J),{key:2,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var _,U;return[d(b((U=(_=e(r))==null?void 0:_.personInformation)==null?void 0:U.family_name),1)]}),_:1})]),_:1})):G("",!0)])]),a("div",ms,[a("div",fs,[a("span",_s,b(((Re=(Ie=e(r))==null?void 0:Ie.personInformation)==null?void 0:Re.gender)=="M"?"Male":"Female"),1),s[16]||(s[16]=a("span",{style:{"flex-shrink":"0"}},".",-1)),a("span",ys,b(u(($e=(Se=e(r))==null?void 0:Se.personInformation)==null?void 0:$e.birthdate))+" ("+b(re())+")",1)])]),(He=(De=e(r))==null?void 0:De.personInformation)!=null&&He.current_district?(w(),V("div",gs,[s[17]||(s[17]=a("div",{class:"demographicsText"},"Current Address:",-1)),a("div",hs,b(e(v)(e(r))),1)])):G("",!0),(Fe=(Me=e(r))==null?void 0:Me.personInformation)!=null&&Fe.country?(w(),V("div",xs,[s[18]||(s[18]=a("div",{class:"demographicsText"},"Country:",-1)),a("div",ws,b((Oe=(Ve=e(r))==null?void 0:Ve.personInformation)==null?void 0:Oe.country),1)])):G("",!0),a("div",bs,[a("div",Cs,[s[19]||(s[19]=d(" MRN: ")),a("span",ks,b(e(r).ID),1)])])])])]),a("div",Ts,[t(e(J),{class:"no-wrap-row",style:{"align-items":"center"}},{default:n(()=>[t(e(L),{style:{flex:"1","min-width":"0"}},{default:n(()=>[t(e(W),{class:"deactivate-button",fill:"solid",shape:"round"},{default:n(()=>s[20]||(s[20]=[d(" Deactivate Visit ")])),_:1,__:[20]})]),_:1}),t(e(L),{size:"auto",style:{"flex-shrink":"0"}},{default:n(()=>[a("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:s[0]||(s[0]=_=>e(D)(_))},[t(q,{icon:e(ot)},null,8,["icon"])])]),_:1})]),_:1})])]),a("div",Is,[a("div",null,[S()?(w(),K(yt,{key:0,checkUnderSixWeeks:H.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):G("",!0),S()?G("",!0):(w(),K(pt,{key:1}))]),a("div",Rs,[a("div",Ss,[a("div",null,[t(e(W),{class:"btnText",fill:"solid",onClick:s[1]||(s[1]=_=>R())},{default:n(()=>[H.value?(w(),V("span",Ds," Enter Weight")):(w(),V("span",$s," Enter Weight/Height")),t(q,{slot:"end",size:"small",icon:e(O).whiteHeightWeight},null,8,["icon"])]),_:1})]),a("div",null,[t(e(W),{class:"btnText",fill:"solid",onClick:s[2]||(s[2]=_=>y())},{default:n(()=>[s[21]||(s[21]=d(" Enter Other Vitals ")),t(q,{slot:"end",size:"small",icon:e(O).whiteVitals},null,8,["icon"])]),_:1,__:[21]})])])])]),a("div",null,[t(e(A),{class:"new-orders-header"},{default:n(()=>[t(e(z),{class:"new-orders-label"},{default:n(()=>s[22]||(s[22]=[d(" NEW ORDERS ")])),_:1,__:[22]})]),_:1}),a("div",Hs,[a("div",Ms,[t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[3]||(s[3]=_=>M({value_text:"HIV test",new_order:!0}))},{default:n(()=>s[23]||(s[23]=[d(" HIV ")])),_:1,__:[23]}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[4]||(s[4]=_=>M({value_text:"Syphilis",new_order:!0}))},{default:n(()=>s[24]||(s[24]=[d(" Syphilis ")])),_:1,__:[24]}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[5]||(s[5]=_=>M({value_text:"Hepatitis B Test",new_order:!0}))},{default:n(()=>s[25]||(s[25]=[d(" Hepatitis B ")])),_:1,__:[25]}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[6]||(s[6]=_=>M({value_text:"Hepatitis C Test",new_order:!0}))},{default:n(()=>s[26]||(s[26]=[d(" Hepatitis C ")])),_:1,__:[26]})]),t(as,{results:B.value,onSeeFullHistory:E,onEnterKnownResults:Q},null,8,["results"])]),t(e(A),{class:"new-orders-header",style:{"margin-top":"10px"}},{default:n(()=>[t(e(z),{class:"new-orders-label"},{default:n(()=>s[27]||(s[27]=[d(" ORDERS FROM OTHER CLINICS ")])),_:1,__:[27]})]),_:1}),a("div",Fs,[(w(!0),V(ce,null,pe($.value,(_,U)=>(w(),K(e(J),{key:U,style:{"margin-bottom":"10px"}},{default:n(()=>[t(e(L),null,{default:n(()=>[t(It,{title:_.value_text,status:"Referred ".concat(_.program_name),type:"hiv",onPressed:Bs=>M(_)},null,8,["title","status","onPressed"])]),_:2},1024)]),_:2},1024))),128))])])]),t(e(ut),{style:{"--offset-x":"-10px"},"is-open":e(x),"show-backdrop":!1,event:e(C),onDidDismiss:s[14]||(s[14]=_=>x.value=!1)},{default:n(()=>[a("div",null,[t(e(it),{multiple:!0},{default:n(()=>[t(e(ae),{value:"first","toggle-icon":"",onClick:s[7]||(s[7]=_=>e(c)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>s[28]||(s[28]=[d("Update demographics")])),_:1,__:[28]})]),_:1})]),_:1}),t(e(ae),{value:"first","toggle-icon":"",onClick:s[8]||(s[8]=()=>{})},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>s[29]||(s[29]=[d("Follow up visits")])),_:1,__:[29]})]),_:1})]),_:1}),t(e(ae),{value:"second","toggle-icon":"",onClick:s[9]||(s[9]=_=>e(I)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>s[30]||(s[30]=[d("Print visit summary")])),_:1,__:[30]})]),_:1})]),_:1}),t(e(ae),{value:"third","toggle-icon":"",onClick:s[10]||(s[10]=_=>e(i)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>s[31]||(s[31]=[d("Print client identifier")])),_:1,__:[31]})]),_:1})]),_:1}),t(e(ae),{value:"fourth"},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>s[32]||(s[32]=[d("Update outcome")])),_:1,__:[32]})]),_:1}),a("div",Vs,[t(e(rt),null,{default:n(()=>[t(e(A),null,{default:n(()=>[t(e(fe),{checked:m.value==7,value:"active",onIonChange:s[11]||(s[11]=_=>k(7))},{default:n(()=>s[33]||(s[33]=[d(" Active ")])),_:1,__:[33]},8,["checked"])]),_:1}),t(e(A),null,{default:n(()=>[t(e(fe),{checked:m.value==6,value:"inactive",onIonChange:s[12]||(s[12]=_=>k(6))},{default:n(()=>s[34]||(s[34]=[d(" Inactive ")])),_:1,__:[34]},8,["checked"])]),_:1}),t(e(A),null,{default:n(()=>[t(e(fe),{checked:m.value==3,value:"died",onIonChange:s[13]||(s[13]=_=>k(3))},{default:n(()=>s[35]||(s[35]=[d(" Died ")])),_:1,__:[35]},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])}}}),nn=ee(Os,[["__scopeId","data-v-90989646"]]);export{nn as default};
