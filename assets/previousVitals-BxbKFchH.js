import{d as W,al as f,U as A,T as G,am as S,an as L,G as O,S as N,ao as M,X as z,ap as V,ai as F,E as y,e as c,f as p,k as g,m as w,p as d,y as H,l as C,F as j}from"./vendor-DowD5zKn.js";import{m as Q}from"./apexcharts-DlRg9dVi.js";import{L as P,a as u,i as v}from"./SvgDynamicColor-D1P211nD.js";import{H as b,Q as m,a0 as U,u as T,_ as E}from"./index-53w8xEQj.js";const X=W({name:"Menu",components:{IonContent:M,IonHeader:N,IonItem:O,IonList:L,IonMenu:S,IonTitle:G,IonToolbar:A,List:P},computed:{...f(T,["patient"]),...f(U,["vitalsWeightHeight"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:u(["#006401"]),listIcon:v(["#636363"]),displayGraph:!0,weight:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[]}},props:{propsContent:{default:{}}},setup(){return{checkmark:F,pulseOutline:V}},methods:{async openVoidPopover(t){await m.voidObs(t.id.weightObsId),await m.voidObs(t.id.heightObsId),await this.updateData()},processObservations(){var i,e;if(!this.weight&&!this.height)return[];const t=new Set([...((i=this.weight)==null?void 0:i.map(a=>a.obs_datetime))||[],...((e=this.height)==null?void 0:e.map(a=>a.obs_datetime))||[]]);return Array.from(t).map(a=>{var n,h,o,l,s,D,I,k,_,B;return{ids:{weightObsId:(h=(n=this.weight)==null?void 0:n.find(r=>r.obs_datetime===a))==null?void 0:h.obs_id,heightObsId:(l=(o=this.height)==null?void 0:o.find(r=>r.obs_datetime===a))==null?void 0:l.obs_id},obs_datetime:a,weight:(I=(D=(s=this.weight)==null?void 0:s.find(r=>r.obs_datetime===a))==null?void 0:D.value_numeric)!=null?I:null,height:(B=(_=(k=this.height)==null?void 0:k.find(r=>r.obs_datetime===a))==null?void 0:_.value_numeric)!=null?B:null}})},async updateData(){var t,i,e,a;try{if(this.patient){const n=[...(i=(t=this.patient)==null?void 0:t.vitals)==null?void 0:i.saved,...(a=(e=this.patient)==null?void 0:e.vitals)==null?void 0:a.unsaved];this.weight=this.formatData(n,5089),this.height=this.formatData(n,5090)}else throw"No offline record found"}catch(n){try{const h=await m.getAll(this.patient.patientID,"Height"),o=await m.getAll(this.patient.patientID,"weight");this.weight=this.formatData(o,5089),this.height=this.formatData(h,5090)}catch(h){}}this.setListData(this.processObservations()),this.$emit("click:weight","")},formatData(t,i){return t.filter(e=>e.concept_id==i).map(e=>({concept_id:i,obs_datetime:e.obs_datetime,value_numeric:e.value_numeric,obs_id:e.obs_id}))},dismiss(){z.dismiss()},toggleDisplay(){this.displayGraph=!this.displayGraph,this.displayGraph?(this.graphIcon=u(["#006401"]),this.listIcon=v(["#636363"]),this.iconBg.graph="iconBg",this.iconBg.list=""):(this.graphIcon=u(["#636363"]),this.listIcon=v(["#006401"]),this.iconBg.graph="",this.iconBg.list="iconBg")},setActiveClass(t){this.activeHeight="",this.activeBMI="",this.activeWeight="",t=="height"?this.activeHeight="_active":t=="weight"?this.activeWeight="_active":t=="BMI"&&(this.activeBMI="_active")},setListData(t){try{this.list=[],this.list.push({containSize:2.6,actionBtn:!1,class:"col_background display_center",header:!0,minHeight:"--min-height: 25px;",display:["Date","Height(cm)","Weight(kg)","Action"]}),t.forEach(i=>{this.list.push({id:i.ids,actionBtn:!0,minHeight:"--min-height: 25px;",class:"col_background",display:[b.toStandardHisDisplayFormat(i.obs_datetime),i.height,i.weight],btn:["void"],name:"height: ".concat(i.height," and weight: ").concat(i.weight," captured on ").concat(b.toStandardHisDisplayFormat(i.obs_datetime)," ")})})}catch(i){}}}}),q={style:{width:"100%",display:"flex","justify-content":"space-between",padding:"10px"}},J={key:0,class:"diplay_space_between bmi_blood"},K={class:"diplay_space_between"},R={key:0};function Y(t,i,e,a,n,h){const o=y("ion-icon"),l=y("list");return p(),c(j,null,[g("div",q,[g("div",null,[t.propsContent.displayGraph&&t.propsContent.weight.length>0?(p(),c("div",J,[g("div",{style:{cursor:"pointer"},class:d(t.propsContent.activeWeight),onClick:i[0]||(i[0]=s=>t.$emit("click:weight",s))},"Weight",2),g("div",{style:{cursor:"pointer"},class:d(t.propsContent.activeHeight),onClick:i[1]||(i[1]=s=>t.$emit("click:height",s))},"Height",2)])):w("",!0)]),g("div",null,[g("div",K,[t.propsContent.displayGraph?(p(),H(o,{key:0,style:{"font-size":"x-large",cursor:"pointer"},class:d(t.propsContent.iconBg.graph),icon:t.propsContent.graphIcon,onClick:i[2]||(i[2]=s=>t.$emit("click:toggleDisplay",s))},null,8,["class","icon"])):(p(),H(o,{key:1,style:{"font-size":"x-large",cursor:"pointer"},class:d(t.propsContent.iconBg.list),icon:t.propsContent.listIcon,onClick:i[3]||(i[3]=s=>t.$emit("click:toggleDisplay",s))},null,8,["class","icon"]))])])]),t.propsContent.displayGraph?w("",!0):(p(),c("div",R,[C(l,{listData:t.propsContent.list,"onClicked:void":i[4]||(i[4]=s=>t.$emit("click:void",s))},null,8,["listData"])]))],64)}const $=E(X,[["render",Y],["__scopeId","data-v-0133bf5b"]]),Z=W({mixins:[$],name:"Menu",components:{IonContent:M,IonHeader:N,IonItem:O,IonList:L,IonMenu:S,IonTitle:G,IonToolbar:A,ApexChart:Q,List:P,ListHeightWeight:$},computed:{...f(T,["patient"])},data(){return{valueNumericArray:[],propsContent:{activeWeight:[],activeHeight:[],graphIcon:u(["#006401"]),listIcon:v(["#636363"]),displayGraph:!0,iconBg:{},weight:[],height:[],list:[]},obsDatetime:[],options:{chart:{id:"vuechart-example"},fill:{colors:["#006401"],type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,90,100]}},stroke:{curve:"straight",colors:["#006401"],width:2},markers:{size:3,colors:["#006401"],strokeColors:["#006401"],hover:{size:5,sizeOffset:3}},dataLabels:{enabled:!1},grid:{show:!0,borderColor:"#B3B3B3",strokeDashArray:4,position:"front",xaxis:{lines:{show:!0}},yaxis:{lines:{show:!0}},row:{colors:"",opacity:.5},column:{colors:"",opacity:.5},padding:{top:0,right:0,bottom:0,left:0}},yaxis:{min:0,forceNiceScale:!0}},series:[{name:"",data:[]}]}},async mounted(){await this.updateGraphData()},watch:{patient:{async handler(){await this.updateGraphData()},deep:!0},vitalsWeightHeight:{async handler(){this.vitalsWeightHeight[0].validationStatus=="success"&&await this.updateGraphData()},deep:!0},list:{async handler(){this.propsContent.list=this.list},deep:!0}},setup(){return{checkmark:F,pulseOutline:V}},methods:{async updateGraphData(){await this.updateData(),this.setWeight(),this.iconBg.graph="iconBg"},dismiss(){z.dismiss()},handleIcon(){},toggleDisplays(){this.toggleDisplay(),this.propsContent.displayGraph=this.displayGraph,this.propsContent.graphIcon=this.graphIcon,this.propsContent.listIcon=this.listIcon,this.propsContent.iconBg.graph=this.iconBg.graph,this.propsContent.iconBg.graph=this.iconBg.graph},async setWeight(){this.propsContent.list=this.list,this.weight&&await this.setData(this.weight,"weight")},async setHeight(){this.height&&await this.setData(this.height,"height")},setActive(t){this.setActiveClass(t),this.propsContent.activeWeight=this.activeWeight,this.propsContent.activeHeight=this.activeHeight},async setData(t,i){this.setActive(i),this.propsContent.weight=this.weight,this.propsContent.height=this.height,this.valueNumericArray=t.map(e=>e.value_numeric),this.obsDatetime=t.map(e=>b.toStandardHisFormat(e.obs_datetime)),this.series[0].data=this.valueNumericArray,this.series[0].name=i,this.options={...this.options,xaxis:{categories:this.obsDatetime}}}}}),x={class:"modal_wrapper"},tt={key:0};function it(t,i,e,a,n,h){const o=y("ListHeightWeight"),l=y("ApexChart");return p(),c("div",x,[C(o,{"onClick:height":i[0]||(i[0]=s=>t.setHeight()),"onClick:weight":i[1]||(i[1]=s=>t.setWeight()),"onClick:toggleDisplay":i[2]||(i[2]=s=>t.toggleDisplays()),"onClick:void":i[3]||(i[3]=s=>t.openVoidPopover(s)),propsContent:t.propsContent},null,8,["propsContent"]),t.displayGraph?(p(),c("div",tt,[C(l,{width:"100%",height:"390px",type:"area",options:t.options,series:t.series},null,8,["options","series"])])):w("",!0)])}const nt=E(Z,[["render",it],["__scopeId","data-v-7f069df7"]]);export{$ as L,nt as P};
