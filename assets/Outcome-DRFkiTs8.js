var jt=Object.defineProperty;var Gt=(e,t,n)=>t in e?jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var he=(e,t,n)=>Gt(e,typeof t!="symbol"?t+"":t,n);import{d as E,G as W,S as ue,a9 as ie,E as f,y as F,m as B,f as g,z as s,k as h,B as P,R as Me,ar as Q,U as pe,T as fe,as as $e,ac as Z,X as Te,a1 as at,a2 as We,e as k,l as a,c4 as ze,a0 as nt,a3 as Oe,A as $,F as J,b1 as ve,r as v,bV as Mt,w as re,a as me,n as $t,L as G,u as _,c7 as Yt,au as Qt,V as je,af as Ve,D as R,d0 as Ot,dr as kt,bd as st,W as ke,bc as ot,I as _e,aa as j,ab as Y,a8 as Ge,db as Kt,bf as Xt,aI as Zt,p as ae,a$ as Ae,cR as ea,bO as it,aY as Ye,aZ as At,a_ as Qe,c as le,aQ as ta,dl as aa,aB as Pt,dA as na,dV as sa,dW as oa,dX as ia,cc as lt,br as rt,M as Ee,J as He,cn as la,d8 as ra,dn as Ze,dm as da,da as ca,a6 as Lt,aS as ua,dY as pa,du as Ft,bu as dt}from"./vendor-BsZAuWFl.js";import{_ as z,i as de,H as U,Q as Se,u as K,D as ce,B as Pe,O as Tt,w as te,a0 as we,j as Ce,z as Fe,R as ma,f as ct,A as ut,Y as Re,aB as _a,S as ee,aw as Le,t as ne,l as Vt,W as fa,a4 as Bt,P as Et,a2 as ha,a6 as Ne,a as ga,T as va,az as Da,cl as ya,cm as ba,ap as Sa,I as wa,aG as ye,cn as Ca,b as Ia,q as Na,o as ht,af as Ma,a5 as Ke,a8 as pt,L as $a}from"./index-7oXXhM88.js";import{L as mt,i as Oa,a as ka}from"./SvgDynamicColor-DJbURSnW.js";import{B as Ie}from"./BasicForm-sBDzgrXz.js";import{l as ge}from"./lodash-Dt8AsbQm.js";import{f as Aa}from"./formatServerData-CdorF03M.js";import{v as tt}from"./group_validation-0cs4-tNG.js";import{A as qe}from"./app_encounter_service-d1pbNlwk.js";import{b as Pa,D as Ht,a as be}from"./drug_prescription_service-5ZEpX2AL.js";import{D as _t}from"./drug_service-1kSwmJnN.js";import{A as xe}from"./appointment_service-CTgFpZK5.js";import{u as et,s as La}from"./clinicalDaysStore-BpsTssB-.js";import{A as Fa}from"./ncd_appointment_service-LHlCaSHr.js";import{D as Ta}from"./DateInputField-Z8nNCC8K.js";import{S as Va}from"./SelectFacility-CzxGXjdP.js";const Ba=E({name:"Menu",components:{IonContent:ie,IonHeader:ue,IonItem:W},data(){return{}},props:{status:{type:Boolean,default:!0},content:{type:String,default:""}},methods:{}}),Ea={class:"dash_box"};function Ha(e,t,n,o,l,r){const i=f("ion-row");return e.status?(g(),F(i,{key:0},{default:s(()=>[h("span",Ea,P(e.content),1)]),_:1})):B("",!0)}const Rt=z(Ba,[["render",Ha]]),gt=Me("NCDDiagnosisStore",{state:()=>({diagnosis:[{selectedData:[],isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Diagnosis",icon:de.search,value:"",name:"diagnosis",eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",valueType:"coded",multiSelectData:[],id:"",validationFunctionName:"required"}]}]}}]}),actions:{setDiagnosis(e){this.diagnosis=e}}}),Ra=E({name:"Menu",components:{IonContent:ie,IonHeader:ue,IonItem:W,IonList:Z,IonMenu:$e,IonTitle:fe,IonToolbar:pe,List:mt},computed:{...Q(K,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:ka(["#006401"]),listIcon:Oa(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:We,pulseOutline:at}},async mounted(){const e=await Se.getAll(this.patient.patientID,"Primary diagnosis"),t=await Se.getAll(this.patient.patientID,"Secondary diagnosis"),n=await Se.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),o=[...e||[],...t||[],...n||[]],l=ge.isEmpty(o)?[]:Promise.all(o.map(async r=>({name:await Se.getConceptName(r.value_coded),obs_date:r.obs_datetime})));this.setListData(await l)},methods:{dismiss(){Te.dismiss()},handleIcon(){},setActivClass(e){this.activeHeight="",this.activeBMI="",this.activeWeight="",e=="height"?this.activeHeight="_active":e=="weight"?this.activeWeight="_active":e=="BMI"&&(this.activeBMI="_active")},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),e.forEach(t=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[U.toStandardHisFormat(t.obs_date),t.name,""]})})}}}),xa={class:"modal_wrapper"};function Ua(e,t,n,o,l,r){const i=f("list");return g(),k("div",xa,[h("div",null,[a(i,{listData:e.list},null,8,["listData"])])])}const za=z(Ra,[["render",Ua],["__scopeId","data-v-5665ae64"]]),qa=E({name:"Menu",components:{IonContent:ie,IonHeader:ue,IonItem:W,IonList:Z,IonMenu:$e,IonTitle:fe,IonToolbar:pe,IonInput:Oe,IonPopover:nt,DashBox:Rt,SelectionPopover:Tt,BasicInputField:Pe,List:mt,BasicForm:Ie,DynamicButton:ce,previousDiagnosis:za,DataTable:ze},data(){return{iconsContent:de,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",conditionStatus:"",data:[],diagnosisData:[],popoverOpen:!1,event:"",selectedCondition:""}},setup(){return{checkmark:We,pulseOutline:at}},computed:{...Q(gt,["diagnosis"]),...Q(K,["patient"])},async mounted(){await this.getDiagnosis("")},methods:{async getDiagnosis(e){const t=await Fe("diagnosis",{likeClause:e?{name:"%".concat(e,"%")}:"",currentPage:1,itemsPerPage:5}).then(n=>n.records);te(this.diagnosis,"diagnosis","multiSelectData",t)},dismiss(){Te.dismiss()},async addNewRow(){var e,t,n;if(await tt(this.diagnosis)){te(this.diagnosis,"diagnosis","alertsErrorMassage","");const o=await Aa(this.diagnosis),l=JSON.parse(JSON.stringify(this.patient));(n=(t=(e=l.diagnosis)!=null?e:l.diagnosis={}).unsaved)!=null||(t.unsaved=[]),l.diagnosis.unsaved.push(...o),await we(l),Ce("Diagnosis successfully saved"),this.dismiss()}else te(this.diagnosis,"diagnosis","alertsErrorMassage","Please select diagnosis from the list")},updateDiagnosisStores(){gt().setDiagnosis(this.diagnosis)},async handleInputData(e){te(this.diagnosis,"diagnosis","alertsErrorMassage","")}}}),Ja={class:"modal_wrapper"},Wa={class:""};function ja(e,t,n,o,l,r){const i=f("ion-title"),d=f("ion-icon"),m=f("ion-header"),p=f("basic-form"),u=f("ion-content"),c=f("DynamicButton"),D=f("ion-col"),C=f("ion-row"),S=f("ion-footer");return g(),k(J,null,[a(m,{style:{display:"flex","justify-content":"space-between"}},{default:s(()=>[a(i,{class:"modalTitle"},{default:s(()=>t[2]||(t[2]=[$("Add Diagnosis")])),_:1,__:[2]}),a(d,{onClick:t[0]||(t[0]=I=>e.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:e.iconsContent.cancel},null,8,["icon"])]),_:1}),a(u,{fullscreen:!0,style:{"--background":"#fff"}},{default:s(()=>[h("div",Ja,[h("div",Wa,[a(p,{contentData:e.diagnosis,onSearchChange:e.getDiagnosis,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","onSearchChange","onUpdate:inputValue"])])])]),_:1}),a(S,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[a(C,null,{default:s(()=>[a(D,null,{default:s(()=>[a(c,{onClick:t[1]||(t[1]=I=>e.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const Ga=z(qa,[["render",ja],["__scopeId","data-v-d1f1c034"]]),Ya={class:"table-responsive"},Qa=E({__name:"Diagnosis",setup(e){const t=ma(),n=K(),{diagnosis:o}=ve(t),{patient:l}=ve(n),r=v(null),i=v([]),d=v(de),m=["Diagnosis","Date","Action"],p={responsive:!0,select:!1,layout:{topStart:"buttons",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1,buttons:[{text:" <b>+ Add diagnosis </b>",className:"add-test text-white",action:async()=>{await u()}}]},u=async()=>{await ct(Ga,{class:"lab-results-modal"},!0),await C()},c=async I=>I.length>0?await Promise.all(I.map(async L=>{const M=await Se.getConceptName(L.value_coded),w=L.obs_datetime;return[M,U.toStandardHisFormat(w),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify({id:L.obs_id,value_coded:L.value_coded,name:M,obs_date:w}),"'>").concat(d.value.delete2,"</button>")]})):[],D=async(I,L)=>{var w;if(await ut("Do you want to delete ".concat(I.name," ?"),L)){const y=JSON.parse(JSON.stringify(l.value)),N=y.diagnosis;I!=null&&I.id?(N.saved=N.saved.filter(O=>!(O.value_coded===I.value_coded&&O.obs_datetime===I.obs_date)),(w=N.voided)!=null||(N.voided=[]),N.voided.push(I)):N.unsaved=N.unsaved.filter(O=>!(O.value_coded===I.value_coded&&O.obs_datetime===I.obs_date)),await we(y)}},C=async()=>{var M,w;const I=JSON.parse(JSON.stringify(l.value)),L=[...((M=I==null?void 0:I.diagnosis)==null?void 0:M.unsaved)||[],...((w=I==null?void 0:I.diagnosis)==null?void 0:w.saved)||[]];i.value=await c(L),ze.use(Yt)},S=Mt();return re(()=>S,async()=>{await C()},{deep:!0}),re(()=>l,async()=>{await C()},{deep:!0}),me(async()=>{await C(),$t(()=>{const I=r.value.dt;I.columns.adjust().draw(),I.on("click",".delete-btn",L=>{const M=L.target.getAttribute("data-id");D(JSON.parse(M),L)})})}),(I,L)=>(g(),k("div",Ya,[a(_(ze),{ref_key:"dataTableRef",ref:r,options:p,data:i.value,class:"display nowrap",width:"100%"},{default:s(()=>[h("thead",null,[h("tr",null,[(g(),k(J,null,G(m,M=>h("th",{key:M},P(M),1)),64))])])]),_:1},8,["data"])]))}}),oi=z(Qa,[["__scopeId","data-v-a9f02349"]]),vt=[{isFinishBtn:!1,validationStatus:"",sectionHeader:"Visual acuity test",data:{rowData:[{colData:[{inputHeader:"Left Eye",value:"",name:"Left eye visual acuity",required:!0,eventType:"input",alertsErrorMassage:"",disabled:!1,validationFunctionName:"",valueType:"text"},{inputHeader:"Right Eye",value:"",name:"Right eye visual acuity",required:!0,eventType:"input",alertsErrorMassage:"",disabled:!1,validationFunctionName:"",valueType:"text"}]}]}}],Dt=[{selectedData:[],classDash:"dashed_bottom_border",groupedRadioBtnContent:{groupedData:[{header:{selectedValue:"",name:"Peripheral neuropathy"},data:[{name:"Neuropathy/PVO",labelPlacement:"start",colSize:"3",justify:"space-between",header:!0,headClassName:"bold"},{name:"Yes",value:"Yes",checked:!1,colSize:"3",justify:"end"},{name:"No",value:"No",checked:!1,colSize:"3",justify:"end"}]}]}},{selectedData:[],classDash:"dashed_bottom_border",groupedRadioBtnContent:{groupedData:[{header:{selectedValue:"",name:"Deformity"},data:[{name:"Deformities",labelPlacement:"start",colSize:"3",justify:"space-between",header:!0,headClassName:"bold"},{name:"Yes",value:"Yes",checked:!1,colSize:"3",justify:"end"},{name:"No",value:"No",checked:!1,colSize:"3",justify:"end"}]}]}},{selectedData:[],classDash:"dashed_bottom_border",groupedRadioBtnContent:{groupedData:[{header:{selectedValue:"",name:"Ulcers"},data:[{name:"Ulcers",labelPlacement:"start",colSize:"3",justify:"space-between",header:!0,headClassName:"bold"},{name:"Yes",value:"Yes",checked:!1,colSize:"3",justify:"end"},{name:"No",value:"No",checked:!1,colSize:"3",justify:"end"}]}]}}],yt=[{isFinishBtn:!1,validationStatus:"",sectionHeader:"CV Risk %",data:{rowData:[{colData:[{inputHeader:"",value:"",name:"CVD",required:!0,eventType:"input",alertsErrorMassage:"",disabled:!1,valueType:"text",validationFunctionName:"isNumber"}]}]}}],Ka=Me("complicationsStore",{state:()=>({visualScreening:[...vt],FootScreening:[...Dt],cvScreening:[...yt]}),actions:{setCvScreening(e){this.cvScreening=e},setVisualScreening(e){this.visualScreening=e},setFootScreening(e){this.FootScreening=e},getInitialCvScreening(){return[...ge.cloneDeep(yt)]},getInitialVisualScreening(){return[...ge.cloneDeep(vt)]},getInitialFootScreening(){return[...ge.cloneDeep(Dt)]},resetScreening(){this.setCvScreening(this.getInitialCvScreening()),this.setFootScreening(this.getInitialFootScreening()),this.setVisualScreening(this.getInitialVisualScreening())}},persist:!0}),Xa={class:"sub_item_body"},Za={class:"ion-padding",slot:"content"},en={class:"table-responsive"},tn=E({__name:"ComplicationsScreening",setup(e){Qt();const t=Ka(),{FootScreening:n,visualScreening:o,cvScreening:l}=ve(t),r=K(),{patient:i}=ve(r);Mt();const d=v(null),m=v([]);v(!1),v(!1),v("");const p=v("");v({btnColor:"secondary",btnName:"No risk"});const u=v(de),c=["Condition","Result","Date","Action"],D={responsive:!0,select:!1,layout:{topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},C=async()=>{var w,y;const L=JSON.parse(JSON.stringify(i.value)),M=[...((w=L==null?void 0:L.screening)==null?void 0:w.unsaved)||[],...((y=L==null?void 0:L.screening)==null?void 0:y.saved)||[]];m.value=await S(M)},S=async L=>L.length===0?[]:(await Promise.all(L.map(async w=>w.concept_name==="Visual acuity"?w.children.map(y=>[y.concept_name,y.value_text,U.toStandardHisFormat(y.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(y),"'>\n                        ").concat(u.value.delete2,"</button>")]):w.concept_name==="Foot check"?Promise.all(w.children.map(async y=>[y.concept_name,await Re.getConceptName(y.value_coded),U.toStandardHisFormat(y.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(y),"'>\n                            ").concat(u.value.delete2,"</button>")])):w.concept_name==="Cardiovascular disease"?[["CVD %",w.value_text,U.toStandardHisFormat(w.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(w),"'>\n                            ").concat(u.value.delete2,"</button>")]]:[]))).flat(),I=L=>{console.log("🚀 ~ voidScreening ~ data:",L)};return me(async()=>{await C(),$t(()=>{const L=d.value.dt;L.columns.adjust().draw(),L.on("click",".delete-btn",M=>{const w=M.target.getAttribute("data-id");I(JSON.parse(w))})})}),(L,M)=>{const w=f("ion-label"),y=f("ion-accordion"),N=f("ion-accordion-group"),O=f("ion-row");return g(),k(J,null,[a(Ie,{contentData:_(o)},null,8,["contentData"]),a(_(Z),null,{default:s(()=>[a(_(W),{lines:p.value,class:"dashed_bottom_border textSectionFormat"},{default:s(()=>M[0]||(M[0]=[h("span",{style:{display:"flex","align-items":"center",gap:"10px"}}," Foot screening ",-1)])),_:1,__:[0]},8,["lines"]),h("div",Xa,[a(Ie,{contentData:_(n)},null,8,["contentData"])])]),_:1}),a(Ie,{contentData:_(l)},null,8,["contentData"]),a(O,null,{default:s(()=>[a(N,{ref:"accordionGroup",class:"previousView"},{default:s(()=>[a(y,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(_(W),{slot:"header",color:"light"},{default:s(()=>[a(w,{class:"previousLabel"},{default:s(()=>M[1]||(M[1]=[$("Previous Visits")])),_:1,__:[1]})]),_:1}),h("div",Za,[h("div",en,[a(_(ze),{ref_key:"dataTableRef",ref:d,options:D,data:m.value,class:"display nowrap",width:"100%"},{default:s(()=>[h("thead",null,[h("tr",null,[(g(),k(J,null,G(c,T=>h("th",{key:T},P(T),1)),64))])])]),_:1},8,["data"])])])]),_:1})]),_:1},512)]),_:1})],64)}}}),ii=z(tn,[["__scopeId","data-v-127f623c"]]),bt=Me("labResultsStore",{state:()=>({labResults:[]}),actions:{setLabResults(e){this.labResults=e}},persist:!0}),an=E({components:{IonButtons:ot,IonButton:ke,IonModal:st,IonHeader:ue,IonContent:ie,IonToolbar:pe,IonTitle:fe,IonItem:W,IonList:Z,IonAvatar:kt,IonImg:Ot,IonLabel:R,IonPage:Ve,IonMenu:$e,BasicForm:Ie,IonFooter:je,DynamicButton:ce},data(){return{popoverStatus:null}},props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{type:Object,default:{}},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},computed:{...Q(K,["patient"]),...Q(bt,["labResults"])},mounted(){},methods:{dismiss(){Te.dismiss()},async saveResults(){const e=await this.buildResults();this.patient.labOrders.results=[{encounter_id:"",date:U.sessionDate(),measures:e,test_id:this.labResults[0].id}];let t=!1;for(let n=0;n<this.patient.labOrders.unsaved.length;n++)if(this.patient.labOrders.unsaved[n].tests[0].id===this.labResults[0].id&&this.patient.labOrders.unsaved[n].tests&&this.patient.labOrders.unsaved[n].tests.length>0){this.patient.labOrders.unsaved[n].tests[0].result=e,t=!0;break}if(!t){for(let n=0;n<this.patient.labOrders.saved.length;n++)if(this.patient.labOrders.saved[n].tests[0].id===this.labResults[0].id&&this.patient.labOrders.saved[n].tests&&this.patient.labOrders.saved[n].tests.length>0){this.patient.labOrders.saved[n].tests[0].result=e;break}}await we(this.patient),Ce("Saved successfully"),this.$emit("saved")},async buildResults(){let e=[];return await Promise.all(this.labResults[1].data.rowData[0].colData.map(async t=>{var o;const n=await Fe("testResultIndicators",{whereClause:{concept_id:t.id}});e.push({indicator:{name:(o=n[0])==null?void 0:o.name,concept_id:t.id},value:t.value.name||t.value||"not done",value_modifier:"",value_type:"text"})})),e},async nav(e,t){const n=bt();t=="not_save"?(await _a(),n.setLabResults(!1)):n.setLabResults(!0),this.dismiss(),this.$router.push(e)}}}),nn={class:"modal_wrapper"},sn={class:"center text_12"};function on(e,t,n,o,l,r){const i=f("ion-title"),d=f("ion-button"),m=f("ion-buttons"),p=f("ion-toolbar"),u=f("ion-header"),c=f("basic-form"),D=f("ion-row"),C=f("ion-content"),S=f("DynamicButton"),I=f("ion-footer"),L=f("ion-modal");return g(),F(L,{"is-open":e.popoverOpen,"show-backdrop":!0,onDidDismiss:t[2]||(t[2]=M=>e.$emit("closePopoover",!1)),"keyboard-close":e.keyboardClose},{default:s(()=>[a(u,null,{default:s(()=>[a(p,null,{default:s(()=>[a(i,null,{default:s(()=>[h("b",null,"Enter lab results for ("+P(e.labResults[0].name)+") test",1)]),_:1}),a(m,{slot:"end"},{default:s(()=>[a(d,{onClick:t[0]||(t[0]=M=>e.$emit("closeModal"))},{default:s(()=>t[3]||(t[3]=[$("Close")])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),a(C,{class:"ion-padding"},{default:s(()=>[h("div",nn,[h("div",sn,[a(D,null,{default:s(()=>[a(c,{contentData:e.labResults},null,8,["contentData"])]),_:1})])])]),_:1}),a(I,{translucent:!0},{default:s(()=>[a(p,null,{default:s(()=>[a(S,{onClick:t[1]||(t[1]=M=>e.saveResults()),name:"Save",fill:"clear",iconSlot:"icon-only",style:{float:"right"}})]),_:1})]),_:1})]),_:1},8,["is-open","keyboard-close"])}const li=z(an,[["render",on],["__scopeId","data-v-52d5f2cf"]]),ln=E({components:{IonButtons:ot,IonButton:ke,IonModal:st,IonHeader:ue,IonContent:ie,IonToolbar:pe,IonTitle:fe,IonItem:W,IonList:Z,IonAvatar:kt,IonImg:Ot,IonLabel:R,IonPage:Ve,IonMenu:$e,BasicForm:Ie,IonFooter:je,DynamicButton:ce},data(){return{popoverStatus:null}},props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:[]},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},methods:{dismiss(){Te.dismiss()},nav(e,t){this.dismiss(),this.$router.push(e)}}}),rn={class:"modal_wrapper"},dn={class:"center text_12"};function cn(e,t,n,o,l,r){const i=f("ion-title"),d=f("ion-button"),m=f("ion-buttons"),p=f("ion-toolbar"),u=f("ion-header"),c=f("ion-col"),D=f("ion-row"),C=f("ion-content"),S=f("ion-modal");return g(),F(S,{"is-open":e.popoverOpen,"show-backdrop":!0,onDidDismiss:t[1]||(t[1]=I=>e.$emit("closePopoover",!1)),"keyboard-close":e.keyboardClose},{default:s(()=>[a(u,null,{default:s(()=>[a(p,null,{default:s(()=>[a(i,null,{default:s(()=>[h("b",null,"Lab results for ("+P(e.content.name)+") test",1)]),_:1}),a(m,{slot:"end"},{default:s(()=>[a(d,{onClick:t[0]||(t[0]=I=>e.$emit("closeModal"))},{default:s(()=>t[2]||(t[2]=[$("Close")])),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),a(C,{class:"ion-padding"},{default:s(()=>[h("div",rn,[h("div",dn,[a(D,null,{default:s(()=>[(g(!0),k(J,null,G(e.content.result,(I,L)=>(g(),F(c,{size:"4",key:L},{default:s(()=>[a(D,null,{default:s(()=>[a(c,{size:"8"},{default:s(()=>[$(P(I.indicator.name),1)]),_:2},1024),a(c,{class:"bold",size:"0.5"},{default:s(()=>t[3]||(t[3]=[$(":")])),_:1,__:[3]}),a(c,{class:"bold",size:"2"},{default:s(()=>[$(P(I.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),_:1})]),_:1},8,["is-open","keyboard-close"])}const ri=z(ln,[["render",cn],["__scopeId","data-v-5d6713fe"]]),St=Me("investigationNCDStore",{state:()=>({investigations:[{db_data:[],isFinishBtn:!1,selectedData:[],displayData:[],data:{rowData:[{colData:[{inputHeader:"Test",icon:de.search,value:"",name:"test",popOver:!0,eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"test_id",validationFunctionName:"required"},{inputHeader:"Specimen",icon:de.search,value:"",name:"specimen",eventType:"input",required:!0,alertsErrorMassage:"",disabled:!0,isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"specimen_id",validationFunctionName:"required"}]}]}}]}),actions:{setInvestigations(e){this.investigations=e}}}),un=E({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(e){this.userRole=ee.getUserRoles();const t=ee.getProgramID(),n=ee.getProgramName();this.userRole=="Lab"&&t==14&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),t==14&&this.userRole!="Lab"&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),t==12&&(this.userRoleSettings={url:"contact",btnName:"Back"}),n=="LABOUR AND DELIVERY PROGRAM"&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),n=="PNC PROGRAM"&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}}),pn=E({name:"Menu",mixins:[un],components:{IonContent:ie,IonHeader:ue,IonItem:W,IonList:Z,IonMenu:$e,IonTitle:fe,IonToolbar:pe,IonInput:Oe,IonPopover:nt,DashBox:Rt,SelectionPopover:Tt,BasicInputField:Pe,BasicForm:Ie,List:mt,DynamicButton:ce},data(){return{segmentContent:"Lab Investigations",iconsContent:de,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}},setup(){return{checkmark:We,pulseOutline:at}},computed:{...Q(St,["investigations"]),...Q(K,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{dismiss(){Te.dismiss()},setSegmentContent(e){this.segmentContent=e},async getTests(){const e=await Fe("testTypes");te(this.investigations,"test","multiSelectData",e)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const e=await this.labOrders.filter(t=>U.toStandardHisFormat(U.sessionDate())===U.toStandardHisFormat(t.order_date));e.length>0?this.investigations[0].selectedData=e:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard(),St().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return tt(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(te(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(te(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){tt(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard(),this.dismiss()},isNameInData(e,t){for(let n of t)for(let o of n.tests)if(o.name===e)return!0;return!1},async saveTest(){var l,r,i,d,m,p;const e=[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await Re.getConceptID(this.inputFields[1].value.name,!0)}];let n=(await Le.buildLabOrders("",e))[0];n.order_date=n.date,n.specimen.name=this.inputFields[1].value.name,n.tests[0].name=this.inputFields[0].value.name;const o=JSON.parse(JSON.stringify(this.patient));(i=(r=(l=o.labOrders)!=null?l:o.labOrders={}).unsaved)!=null||(r.unsaved=[]),(p=(m=(d=o.labOrders)!=null?d:o.labOrders={}).saved)!=null||(m.saved=[]),o.labOrders.unsaved.push(n),await we(o),te(this.investigations,"specimen","disabled",!0),this.labOrders=[...o.labOrders.saved,...o.labOrders.unsaved]},async handleInputData(e){if(e.inputHeader=="Test"&&this.checkTest(),te(this.investigations,"specimen","alertsErrorMassage",""),e.inputHeader=="Test"&&e.value){const t=await Fe("specimens");this.specimen=await Re.getConceptSet(e.value.name,"",{names:t.map(n=>n.name)}),this.specimen.length==1?(te(this.investigations,"specimen","value",this.specimen[0]),te(this.investigations,"specimen","disabled",!0)):(te(this.investigations,"specimen","value",""),te(this.investigations,"specimen","disabled",!1)),te(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(e){return await this.labOrders.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))},async filterSpecimen(e){var t;return(t=this.specimen[0])!=null&&t.name&&e?await this.specimen.filter(n=>n==null?void 0:n.name.toLowerCase().includes(e.toLowerCase())):[]},setTest(e){this.selectedText=e.name,this.inputFields[1].inputHeader=="Test"?this.investigations[0].data.rowData[0].colData[0].value=e.name:this.investigations[0].data.rowData[0].colData[1].value=e.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),mn={class:"modal_wrapper"},_n={class:""};function fn(e,t,n,o,l,r){const i=f("ion-title"),d=f("ion-icon"),m=f("ion-header"),p=f("basic-form"),u=f("ion-content"),c=f("DynamicButton"),D=f("ion-col"),C=f("ion-row"),S=f("ion-footer");return g(),k(J,null,[a(m,{style:{display:"flex","justify-content":"space-between"}},{default:s(()=>[a(i,{class:"modalTitle"},{default:s(()=>t[2]||(t[2]=[$("Add Lab Test")])),_:1,__:[2]}),a(d,{onClick:t[0]||(t[0]=I=>e.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:e.iconsContent.cancel},null,8,["icon"])]),_:1}),a(u,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:s(()=>[h("div",mn,[h("div",_n,[a(p,{contentData:e.investigations,"onUpdate:selected":e.handleInputData,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","onUpdate:selected","onUpdate:inputValue"])])])]),_:1}),a(S,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[a(C,null,{default:s(()=>[a(D,null,{default:s(()=>[a(c,{onClick:t[1]||(t[1]=I=>e.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const di=z(pn,[["render",fn],["__scopeId","data-v-97b2e51e"]]),hn=E({name:"CheckInConfirmationModal",components:{IonCol:Y,IonRow:j,IonFooter:je,DynamicButton:ce,IonModal:st,IonHeader:ue,IonToolbar:pe,IonTitle:fe,IonButtons:ot,IonButton:ke,IonContent:ie,IonIcon:_e},props:{isOpen:{type:Boolean,required:!0,default:!1},closeModalFunc:{type:Function,required:!0},onYes:{type:Function,required:!0},onNo:{type:Function,required:!0},title:{type:String,required:!0}},computed:{},methods:{closeOutline(){return Ge},closeModal(){this.closeModalFunc()},confirm(e){this.closeModal()}}}),gn={style:{display:"flex"}};function vn(e,t,n,o,l,r){const i=f("ion-title"),d=f("ion-icon"),m=f("ion-button"),p=f("ion-buttons"),u=f("ion-col"),c=f("DynamicButton"),D=f("ion-row"),C=f("ion-footer"),S=f("ion-content"),I=f("ion-modal");return g(),F(I,{"is-open":e.isOpen,"show-backdrop":!0,onDidDismiss:e.closeModal},{default:s(()=>[a(p,{slot:"start"},{default:s(()=>[a(i,{style:{color:"#0c0c0c"}},{default:s(()=>[$(P(e.title),1)]),_:1}),a(m,{onClick:e.closeModal},{default:s(()=>[a(d,{slot:"icon-only",icon:e.closeOutline(),style:{color:"#b02a37"}},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),a(S,null,{default:s(()=>[h("div",gn,[a(C,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[a(D,null,{default:s(()=>[a(u,null,{default:s(()=>[a(m,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e.onNo},{default:s(()=>t[1]||(t[1]=[$(" Cancel ")])),_:1,__:[1]},8,["onClick"])]),_:1}),a(u,null,{default:s(()=>[a(c,{name:"Send",onClick:t[0]||(t[0]=L=>e.onYes()),fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["is-open","onDidDismiss"])}const ci=z(hn,[["render",vn],["__scopeId","data-v-be6bf3e1"]]);class Dn extends qe{constructor(t,n,o){super(t,57,n,o)}createLabResult(t,n,o){return qe.postJson("lab/tests/".concat(n,"/results"),{encounter_id:this.encounterID,date:o,measures:t})}getTestsWithoutResults(){return Le.getOrders(this.patientID,{status:"drawn"})}getTestIndicators(t){return Le.getJson("lab/test_result_indicators",{test_type_id:t})}}class ui extends Le{constructor(){super()}async postActivities(t,n){const o=n.location_id,r=await new Dn(parseInt(t),-1,o).createEncounter();if(r){const i=await Le.buildLabOrders(r,n.orders||n);if(!await Le.saveOrdersArray(r.encounter_id,i))return ne("Unable to save lab orders")}}}const xt=(e,t,n,o={})=>({drug_id:e,name:t,category:n,...o}),Je=Me("OtherNCDMedicationsStore",{state:()=>({otherNCDMedications:[],selectedOtherNCDMedicationList:[]}),actions:{setSelectedNCDMedicationList(e){this.selectedOtherNCDMedicationList.push(e)},getSelectedNCDMedicationList(){return this.selectedOtherNCDMedicationList},addSearchedDrug(e){const t=xt(e.drug_id,e.name,"Other",e);if(t.units=e.units,!this.otherNCDMedications.some(o=>o.drug_id===t.drug_id)){this.otherNCDMedications.unshift(t);const o={dosage:{morning:null,afternoon:null,evening:null},duration:null,...t};this.setSelectedNCDMedicationList(o)}},clearOtherNCDMedications(){this.otherNCDMedications=[],this.selectedOtherNCDMedicationList=[]}},persist:!0}),se=Me("NCDmedicationsStore",{state:()=>({medications:[],filteredMedications:[],selectedNCDMedicationList:[],frequency_selections:v({}),currentPatientID:""}),actions:{setMedications(e){this.medications=e,this.filteredMedications=e},setFilteredMedications(e){this.filteredMedications=e},initMedications(){},setSelectedNCDMedicationList(e){this.selectedNCDMedicationList.push(e)},getSelectedNCDMedicationList(){return this.selectedNCDMedicationList},clearMedicationDataStores(){this.medications=[],this.filteredMedications=[],this.selectedNCDMedicationList=[],this.frequency_selections=[]},setCurrentPatientID(e){this.currentPatientID=e}},persist:!0});function yn(){try{const e=se(),t=Je();e.medications=[...t.otherNCDMedications,...e.medications],e.medications=e.medications.reduce((n,o)=>(n.some(l=>l.drug_id===o.drug_id)||n.push(o),n),[]),e.selectedNCDMedicationList=[...t.selectedOtherNCDMedicationList,...e.selectedNCDMedicationList],e.filteredMedications=e.medications,Ce("Medication added successfully")}catch(e){}}const bn={name:"DiabetesMedication",ids:[337,336,280,410,729,263,812,265,264,240,266,726,728,223]},wt={name:"AntiHypertensivesMedication",ids:[]},Sn={ids:[274,168,648,289,286,164,287,288,672,257,1233,671]},wn={ids:[559,1236,1234,558,1235,1211,276,277,278,279]},Cn={ids:[556,653,557,652,943,1238,1240,1237,942,1239,946,1503,944,1504,945,1505]},In={ids:[116,85,117,1232,936,1364,937,1365,1366]};async function Ut(e){const t=se(),n=e.ids.map(async o=>{try{const l=await _t.getOfflineDrugById(o);if(l){const r=t.medications.findIndex(d=>d.drug_id===l.drug_id),i=xt(l.drug_id,l.name,e.name,l);r!==-1?t.medications[r]=i:t.medications.push(i)}}catch(l){console.error("Error fetching drug ID ".concat(o,":"),l)}});return t.filteredMedications=t.medications,Promise.all(n)}async function Nn(e){try{const t=await _t.getOfflineDrugById(e);return{drug_id:e,dosage:{morning:null,afternoon:null,evening:null},duration:null,...t}}catch(t){Vt("Error fetching drug details. Please try again."),console.error("Error fetching drug details:",t)}}function Ct(){return Ut(bn)}function It(){return wt.ids=[...Sn.ids,...wn.ids,...Cn.ids,...In.ids],Ut(wt)}function Ue(){se().clearMedicationDataStores()}function zt(e){se().setCurrentPatientID(e)}function Mn(e){se().currentPatientID!=e&&(Ue(),zt(e))}function pi(){return se().selectedNCDMedicationList.some(t=>{const{morning:n,afternoon:o,evening:l}=t.dosage,r=typeof n=="string"?Number(n):n,i=typeof o=="string"?Number(o):o,d=typeof l=="string"?Number(l):l;return typeof r=="number"&&r>0||typeof i=="number"&&i>0||typeof d=="number"&&d>0})}class $n extends qe{constructor(t,n){super(t,105,n)}}class On extends qe{constructor(t,n){super(t,25,n)}static async get_____(t="",n=1,o=10){}}async function mi(e){var t,n,o;try{const l=K(),{patient:r}=ve(l),i=JSON.parse(JSON.stringify(r.value));(o=(n=(t=i.allergies)!=null?t:i.allergies={}).unsaved)!=null||(n.unsaved=[]),i.allergies.unsaved.push(...e),await we(i),Ce("Allergies saved successfully")}catch(l){ne("Unable to save Allegies!")}}class _i{async onSubmitNotes(t,n,o){const l=new $n(t,n);await l.createEncounter(),await l.saveObservationList(o)}async onSubmitAllergies(t,n,o){try{const l=new On(t,n);await l.createEncounter(),await l.saveObservationList(o),Ce("Allergies saved successfully")}catch(l){console.error("Error saving allergies:",l),ne("Failed to save allergies")}}}class ft{constructor(){he(this,"programID");he(this,"providerID");he(this,"patientID");he(this,"date");he(this,"demographics");he(this,"previousDrugPrescriptions",[]);he(this,"previousClinicalNotes");he(this,"previousDrugAllergies");const t=K();this.demographics=t.patient,this.patientID=this.demographics.patientID,this.date=Se.getSessionDate(),this.providerID=ee.getUserID(),this.programID=Se.getProgramID(),this.previousClinicalNotes={},this.previousDrugAllergies={}}async getPatientEncounters(){const t=await this.getPatientVisitDates(),n=t.map(async l=>{const r=l.value,i=await fa.getEncounters(this.patientID,{date:r});await Promise.all(i.map(async d=>{var m;if(d.type.name=="NOTES"){const{observations:p}=d;ge.isEmpty(p)||p.forEach(u=>{if(u.concept_id=="2688"){const c=U.toStandardHisDisplayFormat(u.obs_datetime);ge.isEmpty(this.previousClinicalNotes.hasOwnProperty(c))&&(this.previousClinicalNotes[c]=[]),this.previousClinicalNotes[c].push({date:c,notes:u.value_text})}})}if(d.type.name=="TREATMENT"){const{observations:p}=d;if(!ge.isEmpty(p))for(const u in p){let c="<UNKNOWN CONCEPT>";const D=p[u];try{(m=D==null?void 0:D.concept)!=null&&m.concept_names?c=D.concept.concept_names[0].name:c=await Re.getConceptName(D.concept_id)}catch(I){console.error(D,I)}const C=await Se.resolvePrimaryValue(D),S=U.toStandardHisDisplayFormat(D.date_created);c=="Allergic"&&(this.previousDrugAllergies.hasOwnProperty(S)||(this.previousDrugAllergies[S]=[]),this.previousDrugAllergies[S].push({date:S,value:C}))}}}))});await Promise.all(n);const o=t.map(async l=>{const r=await Bt.getOrderByPatient(this.patientID,{start_date:l.value});if(!ge.isEmpty(r)){const i=r.map(d=>({drugName:d.drug.name,value:U.toStandardHisTimeFormat(d.order.start_date),dose:d.dose,frequency:Pa(d.frequency),prescription:U.toStandardHisFormat(d.order.auto_expire_date),duration:kn(d.order.instructions),other:d}));this.previousDrugPrescriptions.push({prescriptionDate:U.toStandardHisDisplayFormat(l.value),previousPrescriptions:i})}});return await Promise.all(o),{previousDrugPrescriptions:this.previousDrugPrescriptions,previousClinicalNotes:this.previousClinicalNotes,previousDrugAllergies:this.previousDrugAllergies}}async getPatientVisitDates(){return(await Et.getPatientVisits(this.patientID,!1)).map(t=>({label:U.toStandardHisDisplayFormat(t),value:t,other:{isActive:t===ha.getSessionDate()}}))}}function kn(e){const t=/(\d+)\s+days/i,n=e.match(t);return n&&n.length>1?parseInt(n[1]):null}async function An(){const e=K(),{patient:t}=ve(e),n=t.value,o=[8809,903,6410,6409],r=(await Fe("diagnosis",{likeClause:"",currentPage:1,itemsPerPage:2e3}).then(c=>c.records)).filter(c=>o.includes(c.concept_id)),i=n.diagnosis.saved.map(c=>c.value_coded),d=n.diagnosis.unsaved.map(c=>c.value_coded),m=[...i,...d];return r.filter(c=>m.includes(c.concept_id)).map(c=>c.name)}const Pn=E({name:"Home",components:{IonContent:ie,IonHeader:ue,IonMenuButton:Xt,IonPage:Ve,IonTitle:fe,IonToolbar:pe,IonRow:j,IonCol:Y,IonChip:Kt,IonLabel:R,IonIcon:_e},computed:{...Q(K,["patient"])},data(){const e=v([]),t=v([]),n=async()=>{try{const r=this.patient;zt(r.ID);const i=v(!1),d=u=>{i.value=u};e.value=await An();const m=e.value.some(u=>u.toLowerCase().includes("hypertension")),p=e.value.some(u=>u.toLowerCase().includes("diabetes"));m&&(d(!0),It()),p&&(d(!0),Ct()),i.value==!1}catch(r){}},o=async()=>{const r=t.value.some(d=>d.toLowerCase().includes("hypertension")),i=t.value.some(d=>d.toLowerCase().includes("diabetes"));r&&await It(),i&&await Ct()};return{diagnoses:e,selectedDiagnoses:t,medkitOutline:Zt,initC:n,toggleDiagnosisSelection:r=>{const i=t.value.indexOf(r);i===-1?(t.value.push(r),Ue(),o()):(t.value.splice(i,1),Ue(),o()),t.value.length===0&&(Ue(),n())}}},async mounted(){this.initC()},watch:{patient:{handler(){Mn(this.patient.ID),this.initC()},deep:!0}}}),Ln={key:0,class:"diagnosis-container"},Fn={class:"heading"},Tn={class:"diagnosis-list"};function Vn(e,t,n,o,l,r){const i=f("ion-icon"),d=f("ion-label"),m=f("ion-chip"),p=f("ion-col"),u=f("ion-row");return e.diagnoses.length>0?(g(),k("div",Ln,[h("div",Fn,[a(i,{icon:e.medkitOutline,class:"diagnosis-icon"},null,8,["icon"]),t[0]||(t[0]=h("h2",null,"Diagnosis",-1))]),a(u,null,{default:s(()=>[a(p,null,{default:s(()=>[h("div",Tn,[(g(!0),k(J,null,G(e.diagnoses,(c,D)=>(g(),F(m,{key:D,class:ae({"diagnosis-chip-selected":e.selectedDiagnoses.includes(c)}),onClick:C=>e.toggleDiagnosisSelection(c)},{default:s(()=>[a(d,null,{default:s(()=>[$(P(c),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),_:1})])):B("",!0)}const Bn=z(Pn,[["render",Vn],["__scopeId","data-v-2bd0f8ca"]]),En=E({name:"MedicationSearch",components:{IonContent:ie,IonPage:Ve,IonItem:W,IonLabel:R,IonInput:Oe,IonIcon:_e,BasicInputField:Pe,IonCard:Ae},setup(){const e=v(""),t=se();return{searchText:e,searchTextUpdated:o=>{const l=o.target;e.value=l.value;const r=t.medications.filter(i=>i.name.toLowerCase().includes(e.value.toLowerCase()));t.setFilteredMedications(r)},searchOutline:ea}}});function Hn(e,t,n,o,l,r){const i=f("BasicInputField"),d=f("ion-card");return g(),k("div",null,[h("div",null,[a(d,null,{default:s(()=>[a(i,{placeholder:"Filter medication list by name",icon:e.searchOutline,inputValue:e.searchText,"onUpdate:inputValue":e.searchTextUpdated,minHeight:50},null,8,["icon","inputValue","onUpdate:inputValue"])]),_:1})])])}const Rn=z(En,[["render",Hn]]),xn=E({name:"medication",components:{IonCard:Ae,IonCardHeader:Qe,IonButton:ke,IonCardTitle:At,IonCardContent:Ye,IonInput:Oe,IonIcon:_e,IonCol:Y,IonRow:j,IonCheckbox:it,PreviousNCDDiagnosis:Bn,MedicationSearchInput:Rn},computed:{...Q(se,["medications","filteredMedications"]),...Q(Je,["otherNCDMedications"]),activeMedications(){return this.useDefaultStores?this.filteredMedications:this.otherNCDMedications}},props:{useDefaultStores:{type:Boolean,default:!0}},setup(e){const t=se();t.initMedications();const n=le(()=>t.selectedNCDMedicationList),o=Je(),l=le(()=>o.selectedOtherNCDMedicationList),r=le(()=>e.useDefaultStores?n.value:l.value),i=v(!1),d=v({});let m=null;const p=()=>{i.value=!1,m&&(clearTimeout(m),m=null)},u=y=>{d.value={...d.value,[y]:!0},i.value=!0,m&&clearTimeout(m),m=window.setTimeout(()=>{i.value=!1,m=null},3e3),window.setTimeout(()=>{const N={...d.value};delete N[y],d.value=N},3e3)},c=y=>/^\d*$/.test(y),D=(y,N,O)=>{let T=O.target.value;const A="".concat(y,"-").concat(N);if(T!==""&&!c(T)){u(A);const q=r.value.find(X=>X.drug_id===y);T=(q==null?void 0:q.dosage[N])||"",setTimeout(()=>{const X=O.target;X&&(X.value=T)},0);return}if(T!==""){const q=parseInt(T);isNaN(q)||q<0?T="0":T=Math.floor(q).toString()}const H=r.value.findIndex(q=>q.drug_id===y);if(H>-1){const q={...r.value[H]};q.dosage={...q.dosage,[N]:T},r.value[H]=q}},C=(y,N)=>{let O=N.target.value;const T="".concat(y,"-duration");if(O!==""&&!c(O)){u(T);const H=r.value.find(q=>q.drug_id===y);O=(H==null?void 0:H.duration)||"",setTimeout(()=>{const q=N.target;q&&(q.value=O)},0);return}if(O!==""){const H=parseInt(O);isNaN(H)||H<1?O="1":O=Math.floor(H).toString()}const A=r.value.findIndex(H=>H.drug_id===y);if(A>-1){const H={...r.value[A]};H.duration=O,r.value[A]=H}},S=y=>r.value.some(N=>N.drug_id===y);return{medkit:lt,sunny:ia,partlySunny:oa,moon:sa,timeOutline:na,alertCircleOutline:Pt,closeCircleOutline:aa,updateDosage:D,updateDuration:C,getDosage:(y,N)=>{const O=r.value.find(T=>T.drug_id===y);return(O==null?void 0:O.dosage[N])||""},getDuration:y=>{const N=r.value.find(O=>O.drug_id===y);return(N==null?void 0:N.duration)||""},calculateQuantity:y=>{const N=r.value.find(A=>A.drug_id===y);if(!N||!N.dosage||!N.duration)return"";const O=["morning","afternoon","evening"].reduce((A,H)=>{const q=parseInt(N.dosage[H])||0;return A+q},0),T=parseInt(N.duration)||0;return(O*T).toString()},isActive:S,toggleMedication:async y=>{try{if(S(y)){const N=r.value.findIndex(O=>O.drug_id===y);N>-1&&r.value.splice(N,1)}else{const N=await Nn(y);e.useDefaultStores==!1?o.setSelectedNCDMedicationList(N):t.setSelectedNCDMedicationList(N)}}catch(N){Vt("Error toggling medication: "+N)}},cubeOutline:ta,showErrorMessage:i,errorFields:d,hideErrorMessage:p}}}),Un={key:0},zn={key:0,class:"error-message"},qn={class:"table-container"},Jn={class:"prescription-table"},Wn={class:"checkbox-col"},jn={style:{cursor:"pointer"}},Gn=["onClick"];function Yn(e,t,n,o,l,r){const i=f("PreviousNCDDiagnosis"),d=f("ion-col"),m=f("MedicationSearchInput"),p=f("ion-row"),u=f("ion-icon"),c=f("ion-button"),D=f("ion-checkbox"),C=f("ion-input");return g(),k(J,null,[a(p,null,{default:s(()=>[a(d,{size:"5"},{default:s(()=>[e.useDefaultStores?(g(),F(i,{key:0})):B("",!0)]),_:1}),a(d,null,{default:s(()=>[e.useDefaultStores&&e.medications.length>0?(g(),F(m,{key:0,style:{"margin-top":"0px","font-weight":"600","font-size":"16px"}})):B("",!0)]),_:1})]),_:1}),e.activeMedications.length>0?(g(),k("div",Un,[e.showErrorMessage?(g(),k("div",zn,[a(u,{icon:e.alertCircleOutline,color:"danger"},null,8,["icon"]),t[0]||(t[0]=h("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),a(c,{fill:"clear",size:"small",onClick:e.hideErrorMessage},{default:s(()=>[a(u,{icon:e.closeCircleOutline},null,8,["icon"])]),_:1},8,["onClick"])])):B("",!0),h("div",qn,[h("table",Jn,[h("thead",null,[h("tr",null,[t[6]||(t[6]=h("th",{class:"checkbox-col"},"Select",-1)),t[7]||(t[7]=h("th",null,"Medication",-1)),h("th",null,[a(u,{icon:e.partlySunny},null,8,["icon"]),t[1]||(t[1]=$(" Morning"))]),h("th",null,[a(u,{icon:e.sunny},null,8,["icon"]),t[2]||(t[2]=$(" Noon"))]),h("th",null,[a(u,{icon:e.moon},null,8,["icon"]),t[3]||(t[3]=$(" Night"))]),h("th",null,[a(u,{icon:e.timeOutline},null,8,["icon"]),t[4]||(t[4]=$(" Duration"))]),h("th",null,[a(u,{icon:e.cubeOutline},null,8,["icon"]),t[5]||(t[5]=$(" Quantity"))])])]),h("tbody",null,[(g(!0),k(J,null,G(e.activeMedications,S=>(g(),k("tr",{key:S.id,class:ae({"active-row":e.isActive(S.drug_id)})},[h("td",Wn,[a(D,{checked:e.isActive(S.drug_id),onIonChange:I=>e.toggleMedication(S.drug_id)},null,8,["checked","onIonChange"])]),h("td",jn,[h("span",{class:"med-kit-font",onClick:I=>e.toggleMedication(S.drug_id)},P(S.name),9,Gn)]),h("td",null,[a(C,{type:"text",class:ae(["dose-input bordered-input med-kit-font",{"error-input":e.errorFields["".concat(S.drug_id,"-morning")]}]),disabled:!e.isActive(S.drug_id),value:e.getDosage(S.drug_id,"morning"),onIonInput:I=>e.updateDosage(S.drug_id,"morning",I),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),h("td",null,[a(C,{type:"text",class:ae(["dose-input bordered-input med-kit-font",{"error-input":e.errorFields["".concat(S.drug_id,"-afternoon")]}]),disabled:!e.isActive(S.drug_id),value:e.getDosage(S.drug_id,"afternoon"),onIonInput:I=>e.updateDosage(S.drug_id,"afternoon",I),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),h("td",null,[a(C,{type:"text",class:ae(["dose-input bordered-input med-kit-font",{"error-input":e.errorFields["".concat(S.drug_id,"-evening")]}]),disabled:!e.isActive(S.drug_id),value:e.getDosage(S.drug_id,"evening"),onIonInput:I=>e.updateDosage(S.drug_id,"evening",I),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),h("td",null,[a(C,{type:"text",class:ae(["dose-input bordered-input med-kit-font",{"error-input":e.errorFields["".concat(S.drug_id,"-duration")]}]),disabled:!e.isActive(S.drug_id),value:e.getDuration(S.drug_id),onIonInput:I=>e.updateDuration(S.drug_id,I),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),h("td",null,[a(C,{type:"text",class:"dose-input bordered-input med-kit-font",readonly:"",value:e.calculateQuantity(S.drug_id),placeholder:"0"},null,8,["value"])])],2))),128))])])])])):B("",!0)],64)}const qt=z(xn,[["render",Yn],["__scopeId","data-v-601894a0"]]),Qn=E({name:"DrugSelector",components:{IonContent:ie,IonHeader:ue,IonItem:W,IonList:Z,IonMenu:$e,IonTitle:fe,IonToolbar:pe,IonInput:Oe,IonPopover:nt,VueMultiselect:rt,IonLabel:R,IonCol:Y,IonRow:j},emits:["drug-selected"],data(){const e=l=>{this.$emit("drug-selected",l)},t=async l=>{const r=Ne(),i=l,u=(await _t.getOfflineOPDDrugs({name:i,page:1,page_size:20})).map(c=>({label:c.name,value:c.name,other:c,...c}));r.setPartialOPDdrugList(u)},n=le(()=>this.partialOPDdrugList);return{selected_drug:v(null),selectedDrugName:e,FindDrugName:t,OPDDrugList:n}},computed:{...Q(Ne,["partialOPDdrugList"])}});function Kn(e,t,n,o,l,r){const i=f("VueMultiselect"),d=f("ion-col"),m=f("ion-row");return g(),k("div",null,[a(m,null,{default:s(()=>[a(d,null,{default:s(()=>[a(i,{modelValue:e.selected_drug,"onUpdate:modelValue":[t[0]||(t[0]=p=>e.selected_drug=p),e.selectedDrugName],multiple:!1,taggable:!1,"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Select medication",placeholder:"Select medication",selectLabel:"",label:"name",searchable:!0,onSearchChange:e.FindDrugName,"track-by":"uuid",options:e.OPDDrugList},null,8,["modelValue","onUpdate:modelValue","onSearchChange","options"])]),_:1})]),_:1})])}const Xn=z(Qn,[["render",Kn],["__scopeId","data-v-e4d309dd"]]),Zn=E({name:"Home",mixins:[ga],components:{IonContent:ie,IonHeader:ue,IonPage:Ve,IonToolbar:pe,IonRow:j,IonTitle:fe,IonIcon:_e,IonFooter:je,OPDMedications:Xn,Medication:qt,IonCol:Y,IonButton:ke},data(){const e=Je(),t=()=>{Te.dismiss()};return{iconsContent:de,dismiss:t,addSearchedDrug:l=>{e.addSearchedDrug(l)},medkit:lt,checkmark:We,onAdd:()=>{yn(),e.clearOtherNCDMedications(),t()}}},computed:{},$route:{async handler(){},deep:!0},watch:{},async mounted(){},methods:{}}),es={class:"medication-list"},ts={class:"modal_wrapper"},as={class:""};function ns(e,t,n,o,l,r){const i=f("ion-icon"),d=f("ion-title"),m=f("ion-header"),p=f("OPDMedications"),u=f("Medication"),c=f("ion-content"),D=f("ion-button"),C=f("ion-col"),S=f("ion-row"),I=f("ion-footer");return g(),k(J,null,[a(m,{style:{display:"flex","justify-content":"space-between"}},{default:s(()=>[a(d,{class:"modalTitle"},{default:s(()=>[h("div",es,[a(i,{icon:e.medkit,class:"ion-margin-end"},null,8,["icon"]),t[1]||(t[1]=h("span",null,"Add Other Medication",-1))])]),_:1}),a(i,{onClick:t[0]||(t[0]=L=>e.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:e.iconsContent.cancel},null,8,["icon"])]),_:1}),a(c,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:s(()=>[h("div",ts,[h("div",as,[a(p,{onDrugSelected:e.addSearchedDrug},null,8,["onDrugSelected"]),a(u,{"use-default-stores":!1})])])]),_:1}),a(I,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[a(S,null,{default:s(()=>[a(C,null,{default:s(()=>[a(D,{onClick:e.onAdd,color:"primary",style:{float:"right","margin-bottom":"20px","margin-right":"20px"}},{default:s(()=>[a(i,{icon:e.checkmark,slot:"start"},null,8,["icon"]),t[2]||(t[2]=$(" Add "))]),_:1,__:[2]},8,["onClick"])]),_:1})]),_:1})]),_:1})],64)}const ss=z(Zn,[["render",ns],["__scopeId","data-v-dee50533"]]),os=E({created(){},components:{IonItem:W,IonCol:Y,IonLabel:R,IonIcon:_e},data(){return{iconsContent:de,localMedicalDrugsList:[...this.$props._selectedMedicalDrugsList]}},props:{_selectedMedicalDrugsList:{type:Array,default:[]},show_actions_buttons:{type:Boolean,default:!0},highLightBackground:{type:String,default:"item-native"}},watch:{},methods:{highlightItem(e){const t=document.getElementById(e+"_lbl");t&&(t.style.color="#006401"),this.highlightActionBtns(e)},undoHighlightItem(e){const t=document.getElementById(e+"_lbl");t&&(t.style.color="#636363"),this.undohighlightActionBtns(e)},highlightActionBtns(e){const t=document.getElementsByClassName(e+"_spanlbl");for(let n=0;n<t.length;n++)t[n].style.display="inline-block"},undohighlightActionBtns(e){const t=document.getElementsByClassName(e+"_spanlbl");for(let n=0;n<t.length;n++)t[n].style.display="none"},asignLblID(e){return e+"_lbl"},asignSpanLblID(e){return e+"_spanlbl"},async removeItemAtIndex(e,t){await ut("Do you want to delete it?",t)&&this.$emit("remove-item",e)},editItemAtIndex(e){this.$emit("edit-item",e)},highLightBnd(e){if(e){if(e.highlightbackground!==void 0&&e.highlightbackground==!0)return this.$props.highLightBackground}else return!1}}}),is=["onMousemove","onMouseout"],ls={class:"route-label"};function rs(e,t,n,o,l,r){const i=f("ion-label"),d=f("ion-col"),m=f("ion-row"),p=f("ion-icon");return g(!0),k(J,null,G(e.localMedicalDrugsList,(u,c)=>(g(),k("div",{id:"df",class:"medication-item",key:c,onMousemove:D=>e.highlightItem(c),onMouseout:D=>e.undoHighlightItem(c)},[a(m,{class:"medication-header"},{default:s(()=>[a(d,{class:ae(["ion-text-wrap",e.highLightBnd(u)])},{default:s(()=>[a(i,{id:e.asignLblID(c),class:"medication-name"},{default:s(()=>[$(P(u.drugName),1)]),_:2},1032,["id"])]),_:2},1032,["class"])]),_:2},1024),a(m,{class:"medication-details"},{default:s(()=>[a(d,{size:"10",class:ae(["ion-text-wrap details-col",e.highLightBnd(u)])},{default:s(()=>[a(i,{class:"details-text"},{default:s(()=>[$(P(u.dose)+" / "+P(u.frequency)+" / daily / "+P(u.duration)+" / until "+P(u.prescription)+" ",1),h("span",ls,P(u.route_name),1)]),_:2},1024)]),_:2},1032,["class"]),e.show_actions_buttons?(g(),F(d,{key:0,class:ae([e.highLightBnd(u),"actions-col"]),size:"2"},{default:s(()=>[a(i,{class:ae(["action-button",e.asignSpanLblID(c)]),onClick:D=>e.editItemAtIndex(c)},{default:s(()=>[a(p,{icon:e.iconsContent.edit},null,8,["icon"])]),_:2},1032,["class","onClick"]),a(i,{class:ae(["action-button",e.asignSpanLblID(c)]),onClick:D=>e.removeItemAtIndex(c,D)},{default:s(()=>[a(p,{icon:e.iconsContent.delete},null,8,["icon"])]),_:2},1032,["class","onClick"])]),_:2},1032,["class"])):B("",!0)]),_:2},1024)],40,is))),128)}const ds=z(os,[["render",rs],["__scopeId","data-v-01c693a3"]]),cs=E({name:"Home",components:{IonContent:ie,IonHeader:ue,IonPage:Ve,IonToolbar:pe,Toolbar:va,IonRow:j,IonAccordion:He,IonAccordionGroup:Ee,IonItem:W,IonLabel:R,DynamicList:ds,IonCard:Ae},data(){const e=v(0),t=v("Show more medications"),n=v(!1),o=v();return{componentKey:e,accordionGroupChange:d=>{const m=d.detail.value;m!==void 0?m=="second"&&(t.value="Show less medications",n.value=!n.value):(t.value="Show more medications",n.value=!n.value)},showMoreMedicationsMsg:t,itemWasExpanded:n,accordionGroupChangeFn1:d=>{},PreviuosSelectedMedicalDrugsList:o,loadPreviousMedications:async()=>{const d=new ft,{previousDrugPrescriptions:m}=await d.getPatientEncounters();o.value=m}}},computed:{...Q(K,["patient"]),...Q(se,["selectedNCDMedicationList"])},$route:{async handler(){},deep:!0},watch:{patient:{handler(){this.loadPreviousMedications()},deep:!0},selectedNCDMedicationList:{handler(){this.loadPreviousMedications()},deep:!0}},async mounted(){this.loadPreviousMedications()}}),us={style:{}},ps={class:"ion-padding",slot:"content"},ms={key:0},_s={class:"previousSecDrgs"},fs={class:"ion-padding",slot:"content"},hs={key:0},gs={class:"previousSecDrgs"};function vs(e,t,n,o,l,r){const i=f("ion-label"),d=f("ion-item"),m=f("dynamic-list"),p=f("ion-accordion"),u=f("ion-accordion-group"),c=f("ion-card");return g(),F(c,null,{default:s(()=>[h("div",us,[a(u,{ref:"accordionGroup",class:"previousView",onIonChange:e.accordionGroupChangeFn1},{default:s(()=>[a(p,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(d,{slot:"header",color:"light"},{default:s(()=>[a(i,{class:"previousLabel"},{default:s(()=>t[0]||(t[0]=[$("Documented medications timeline")])),_:1,__:[0]})]),_:1}),h("div",ps,[(g(!0),k(J,null,G(e.PreviuosSelectedMedicalDrugsList,(D,C)=>(g(),k("div",{class:"ionLbltp",key:C},[C==0?(g(),k("div",ms,[h("div",null,[a(i,{class:"previousLabelDate"},{default:s(()=>[$(P(D.prescriptionDate),1)]),_:2},1024)]),h("div",_s,[(g(),F(m,{_selectedMedicalDrugsList:D.previousPrescriptions,show_actions_buttons:!1,key:e.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):B("",!0)]))),128)),a(u,{onIonChange:e.accordionGroupChange},{default:s(()=>[a(p,{value:"second","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(d,{slot:"header",color:"light"},{default:s(()=>[a(i,{class:"",color:"primary"},{default:s(()=>[$(P(e.showMoreMedicationsMsg),1)]),_:1})]),_:1}),h("div",fs,[(g(!0),k(J,null,G(e.PreviuosSelectedMedicalDrugsList,(D,C)=>(g(),k("div",{class:"ionLbltp",key:C},[e.itemWasExpanded&&C>0?(g(),k("div",hs,[h("div",null,[a(i,{class:"previousLabelDate"},{default:s(()=>[$(P(D.prescriptionDate),1)]),_:2},1024)]),h("div",gs,[(g(),F(m,{_selectedMedicalDrugsList:D.previousPrescriptions,show_actions_buttons:!1,key:e.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):B("",!0)]))),128))])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})}const Ds=z(cs,[["render",vs],["__scopeId","data-v-1db96250"]]),ys=E({name:"PrescriptionTable",components:{IonCard:Ae,IonCardHeader:Qe,IonButton:ke,IonCardTitle:At,IonCardContent:Ye,IonInput:Oe,IonIcon:_e,IonCol:Y,IonRow:j,IonCheckbox:it,Medication:qt,MedicationHistory:Ds},setup(){return{openAddOtherOPDMedicationModal:async()=>{await ct(ss,{class:"large-modal"},!0,{})},medkit:lt}}});function bs(e,t,n,o,l,r){const i=f("Medication"),d=f("ion-icon"),m=f("ion-button"),p=f("ion-col"),u=f("ion-row"),c=f("MedicationHistory"),D=f("IonCol"),C=f("ion-card-content"),S=f("ion-card");return g(),F(S,null,{default:s(()=>[a(C,null,{default:s(()=>[a(i),a(u,null,{default:s(()=>[a(p,null,{default:s(()=>[a(m,{onClick:e.openAddOtherOPDMedicationModal,color:"primary",style:{float:"right"}},{default:s(()=>[a(d,{icon:e.medkit,slot:"start"},null,8,["icon"]),t[0]||(t[0]=h("span",{style:{"margin-left":"10px","font-size":"16px","font-weight":"600"}}," ADD Other Medication",-1))]),_:1,__:[0]},8,["onClick"])]),_:1})]),_:1}),a(u,null,{default:s(()=>[a(D,null,{default:s(()=>[a(c)]),_:1})]),_:1})]),_:1})]),_:1})}const Ss=z(ys,[["render",bs],["__scopeId","data-v-a4ad7088"]]),ws={key:0,class:"custom-allergy-container"},Cs=E({watch:{},name:"AllergiesComponent"}),Is=E({...Cs,setup(e){const t=Da(),n=K(),o=le(()=>t.selectedMedicalAllergiesList),l=le(()=>n.patient),r=le(()=>t.medicalAllergiesList),i=v(I(8,"item-")),d=v(),m=v(!1),p=[{multi_Selection:!0,show_list_label:!0,unqueId:i.value,name_of_list:"Add/Remove allergies",placeHolder:"Search for an allergy",items:[],listUpdatedFN:D,listFilteredFN:()=>{},searchTextFN:C,use_internal_filter:!0,show_error:v(!1),error_message:"please select a User",disabled:v(!1)}],u=v(!1);me(async()=>{c()});const c=()=>{t.current_patient.ID!=l.value.ID&&(t.clearSelectedMedicalAllergiesList(),t.setCurrentPatient(l.value))};function D(M){M.forEach(w=>{w.selected==!0&&w.name==="Other"&&(m.value=w.name==="Other")}),t.setSelectedMedicalAllergiesList(M),S()}async function C(M){const w=M,y=await Re.getConceptSet("OPD Medication",w);y.map(A=>({label:A.name,value:A.name,other:A}));const N=ya(w),T=ba(N,y).sort((A,H)=>A.name.localeCompare(H.name));t.setMedicalAllergiesList(T),S()}function S(){const M=r.value;o.value.forEach(y=>{let N=!1;M.forEach((O,T)=>{O.concept_id==y.concept_id&&y.selected===!0&&(M[T]=y,N=!0)}),!N&&y.selected===!0&&M.push(y)});const w=M.filter((y,N,O)=>N===O.findIndex(T=>T.concept_id===y.concept_id));t.setMedicalAllergiesList(w)}function I(M=8,w=""){const y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let N=w;for(let O=0;O<M;O++)N+=y.charAt(Math.floor(Math.random()*y.length));return N+="-".concat(Date.now()),N}async function L(M){try{const w=M.trim();if(w){const y={name:w,selected:!0};t.setMedicalAllergiesList([...r.value,y]),t.setSelectedMedicalAllergiesList(y),m.value=!1,u.value=!0,d.value="";const N=t.findSelectedAllergyByName("Other");t.removeSelectedAllergy(N)}}catch(w){console.error(w)}}return(M,w)=>(g(),F(_(Ae),null,{default:s(()=>[a(_(Qe),null,{default:s(()=>[a(_(R),{class:"header-container"},{default:s(()=>[a(_(_e),{icon:_(Pt),class:"allergy-icon"},null,8,["icon"]),w[2]||(w[2]=h("span",{style:{"font-size":"16px","font-weight":"600"}}," Allergies (Medication, Healthcare items, Environment and Food) ",-1))]),_:1,__:[2]})]),_:1}),a(_(Ye),null,{default:s(()=>[a(Sa,{multiSelection:p[0].multi_Selection,show_label:p[0].show_list_label,uniqueId:p[0].unqueId,name_of_list:p[0].name_of_list,choose_place_holder:p[0].placeHolder,"items_-list":r.value,use_internal_filter:p[0].use_internal_filter,disabled:p[0].disabled.value,onItemListUpDated:p[0].listUpdatedFN,onItemListFiltered:p[0].listFilteredFN,onItemSearchText:p[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),m.value?(g(),k("div",ws,[a(_(Oe),{modelValue:d.value,"onUpdate:modelValue":w[0]||(w[0]=y=>d.value=y),placeholder:"Please specify the allergy",fill:"outline",class:"custom-input"},null,8,["modelValue"]),a(_(ke),{onClick:w[1]||(w[1]=y=>L(d.value)),class:"addCustomAllergyBtn"},{default:s(()=>w[3]||(w[3]=[$(" Add Allergy ")])),_:1,__:[3]})])):B("",!0)]),_:1})]),_:1}))}}),Ns=z(Is,[["__scopeId","data-v-8aa98f55"]]),Ms=Me("nonPharmaTherapyStore",{state:()=>({items:[{id:"wound-dressing",label:"Wound dressing",checked:!1},{id:"patient-education",label:"Patient education",checked:!1},{id:"counseling",label:"Counseling",checked:!1},{id:"minor-surgery",label:"Minor Surgery",checked:!1}],current_patient:{}}),actions:{async saveNonPharmaTherapyPatientData(){const e=wa(),t=[];this.items.forEach(n=>{n.checked==!0&&t.push({concept_id:11023,value_coded:2592,value_text:JSON.stringify(n),obs_datetime:U.toStandardHisFormat(ee.getSessionDate()),location_id:e.facilityLocation.code})});try{t.length>0&&$s(t)}catch(n){ne("Unable to update Non Pharma Therapy!")}this.clearSelectednonPharmaTherapyStore()},clearSelectednonPharmaTherapyStore(){this.items.forEach(e=>{e.checked=!1})},setCurrentPatient(e){this.current_patient=e}},persist:!0});async function $s(e){var t,n,o;try{const l=K(),{patient:r}=ve(l),i=JSON.parse(JSON.stringify(r.value));(o=(n=(t=i.notes)!=null?t:i.notes={}).unsaved)!=null||(n.unsaved=[]),i.notes.unsaved.push(...e),await we(i),Ce("Non Pharma Therapy has been saved")}catch(l){ne("Unable to create non pharmalogical notes!")}}const Os={class:"checklist-container"},ks=E({watch:{},name:"xxxComponent"}),As=E({...ks,setup(e){const t=K(),n=le(()=>t.patient),o=Ms(),l=o.items;me(async()=>{r()});const r=()=>{o.current_patient.ID!=n.value.ID&&(o.clearSelectednonPharmaTherapyStore(),o.setCurrentPatient(n.value))};return re(()=>n.value,async i=>{}),(i,d)=>(g(),k("div",Os,[(g(!0),k(J,null,G(_(l),m=>(g(),F(_(W),{key:m.id,class:"no-border"},{default:s(()=>[a(_(it),{id:m.id,modelValue:m.checked,"onUpdate:modelValue":p=>m.checked=p,slot:"start"},null,8,["id","modelValue","onUpdate:modelValue"]),a(_(R),{style:{"font-size":"16px","font-weight":"600"}},{default:s(()=>[$(P(m.label),1)]),_:2},1024)]),_:2},1024))),128))]))}}),Ps=z(As,[["__scopeId","data-v-371e920f"]]),Ls={style:{"margin-top":"14px","margin-left":"10px"}},Fs={class:"ion-padding",slot:"content"},Ts={key:0},Vs={class:"previousSecDrgs"},Bs={class:"ion-padding",slot:"content"},Es={class:"previousSecDrgs"},Hs=E({watch:{},name:"xxxComponent"}),Rs=E({...Hs,setup(e){const t=v(),n=v(),o=v(!1),l=v(!1),r=v("Show more notes");me(async()=>{const m=new ft,{previousClinicalNotes:p}=await m.getPatientEncounters();t.value=Object.entries(p)[0];const[,...u]=Object.entries(p);n.value=u});function i(m){const p=m.detail.value;p!==void 0?p=="third"&&(r.value="Show less notes",l.value=!o.value):(r.value="Show more notes",l.value=!o.value)}function d(m){return m[1]}return(m,p)=>(g(),F(_(Ae),null,{default:s(()=>[h("div",Ls,[a(_(Ee),{ref:"accordionGroup",class:"previousView"},{default:s(()=>[a(_(He),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(_(W),{slot:"header",color:"light"},{default:s(()=>[a(_(R),{class:"previousLabel"},{default:s(()=>p[0]||(p[0]=[$("Previous visits notes")])),_:1,__:[0]})]),_:1}),h("div",Fs,[(g(!0),k(J,null,G(t.value,(u,c)=>(g(),k("div",{class:"ionLbltp",key:c},[c==1?(g(),k("div",Ts,[(g(!0),k(J,null,G(u,(D,C)=>(g(),k("div",{key:C},[h("div",null,[a(_(R),{class:"previousLabelDate"},{default:s(()=>[$(P(D.date),1)]),_:2},1024)]),h("div",Vs,[a(_(Z),null,{default:s(()=>[a(_(R),{class:"notes_p"},{default:s(()=>[$(P(D.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))])):B("",!0)]))),128)),a(_(Ee),{onIonChange:i},{default:s(()=>[a(_(He),{value:"third","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(_(W),{slot:"header",color:"light"},{default:s(()=>[a(_(R),{class:"",color:"primary"},{default:s(()=>[$(P(r.value),1)]),_:1})]),_:1}),h("div",Bs,[(g(!0),k(J,null,G(n.value,(u,c)=>(g(),k("div",{class:"ionLbltp",key:c},[(g(!0),k(J,null,G(d(u),(D,C)=>(g(),k("div",{key:C},[h("div",null,[a(_(R),{class:"previousLabelDate"},{default:s(()=>[$(P(D.date),1)]),_:2},1024)]),h("div",Es,[a(_(Z),null,{default:s(()=>[a(_(R),{class:"notes_p"},{default:s(()=>[$(P(D.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)])]),_:1}))}}),xs=z(Rs,[["__scopeId","data-v-994df42d"]]),Us={style:{"margin-top":"14px","margin-left":"10px"}},zs=E({watch:{},name:"xxxComponent"}),qs=E({...zs,setup(e){const t=Ne(),n=de,o=le(()=>t.nonPharmalogicalTherapyAndOtherNotes);function l(i){let d=i.target.value;r(d)}function r(i){Ne().setNonPharmalogicalTherapyAndOtherNotes(i)}return(i,d)=>(g(),F(_(Ae),null,{default:s(()=>[a(_(Qe),null,{default:s(()=>[a(_(R),{class:"tpStndCls"},{default:s(()=>[a(_(_e),{icon:_(la),class:"header-icon","aria-hidden":"true"},null,8,["icon"]),d[1]||(d[1]=$(" Non-pharmalogical therapy and other notes "))]),_:1,__:[1]})]),_:1}),a(_(Ye),null,{default:s(()=>[h("div",null,[a(Ps),a(_(W),{class:"input_item",style:{"min-height":"120px","margin-top":"14px"}},{default:s(()=>[a(_(R),null,{default:s(()=>[a(_(_e),{slot:"start",icon:_(n).editPen,"aria-hidden":"true"},null,8,["icon"])]),_:1}),a(_(ra),{onIonInput:l,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=m=>o.value=m),style:{"min-height":"120px"},class:"inputTpln","auto-grow":!0,fill:"outline"},null,8,["modelValue"])]),_:1})]),h("div",Us,[a(xs)])]),_:1})]),_:1}))}}),Js=z(qs,[["__scopeId","data-v-fd19ec21"]]),Ws={class:"ion-padding",slot:"content"},js={key:0},Gs={class:"previousSecDrgs"},Ys={class:"ion-padding",slot:"content"},Qs={class:"previousSecDrgs"},Ks=E({watch:{},name:"xxxComponent"}),Xs=E({...Ks,setup(e){const t=v(!1),n=v(!1),o=v("Show more allergies"),l=v(),r=v();me(async()=>{const m=new ft,{previousDrugAllergies:p}=await m.getPatientEncounters();l.value=Object.entries(p)[0];const[,...u]=Object.entries(p);r.value=u});function i(m){const p=m.detail.value;p!==void 0?p=="fith"&&(o.value="Show less allegies",n.value=!t.value):(o.value="Show more allegies",n.value=!t.value)}function d(m){return m[1]}return(m,p)=>{const u=f("ion-card");return g(),F(u,null,{default:s(()=>[a(_(Ee),{ref:"accordionGroup",class:"previousView"},{default:s(()=>[a(_(He),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(_(W),{slot:"header",color:"light"},{default:s(()=>[a(_(R),{class:"previousLabel"},{default:s(()=>p[0]||(p[0]=[$("Documented allergies timeline")])),_:1,__:[0]})]),_:1}),h("div",Ws,[(g(!0),k(J,null,G(l.value,(c,D)=>(g(),k("div",{class:"ionLbltp",key:D},[D==1?(g(),k("div",js,[h("div",null,[a(_(R),{class:"previousLabelDate"},{default:s(()=>[$(P(c[0].date),1)]),_:2},1024)]),(g(!0),k(J,null,G(c,(C,S)=>(g(),k("div",{key:S},[h("div",Gs,[a(_(Z),null,{default:s(()=>[a(_(R),{class:"notes_p"},{default:s(()=>[$(P(C.value),1)]),_:2},1024)]),_:2},1024)])]))),128))])):B("",!0)]))),128)),a(_(Ee),{onIonChange:i},{default:s(()=>[a(_(He),{value:"fith","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:s(()=>[a(_(W),{slot:"header",color:"light"},{default:s(()=>[a(_(R),{class:"",color:"primary"},{default:s(()=>[$(P(o.value),1)]),_:1})]),_:1}),h("div",Ys,[(g(!0),k(J,null,G(r.value,(c,D)=>(g(),k("div",{class:"ionLbltp",key:D},[h("div",null,[a(_(R),{class:"previousLabelDate"},{default:s(()=>[$(P(c[0]),1)]),_:2},1024)]),(g(!0),k(J,null,G(d(c),(C,S)=>(g(),k("div",{key:S},[h("div",Qs,[a(_(Z),null,{default:s(()=>[a(_(R),{class:"notes_p"},{default:s(()=>[$(P(C.value),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)]),_:1})}}}),Zs=z(Xs,[["__scopeId","data-v-358c5959"]]),eo={class:"background"},to={key:0},ao={style:{margin:"10px"}},no={key:1},so={style:{margin:"10px"}},oo={key:2},io={style:{margin:"10px"}},lo=E({__name:"TreatmentPlan",setup(e){const t=v(["medications","allergies","other_notes"]),n=v(t.value[0]);me(()=>{o(t.value[0])});function o(l){n.value=l}return(l,r)=>(g(),k("div",eo,[a(_(da),{value:n.value,style:{"margin-top":"5px"}},{default:s(()=>[a(_(Ze),{value:"medications",onClick:r[0]||(r[0]=i=>o(t.value[0]))},{default:s(()=>[a(_(R),null,{default:s(()=>r[3]||(r[3]=[$("Medications")])),_:1,__:[3]})]),_:1}),a(_(Ze),{value:"allergies",onClick:r[1]||(r[1]=i=>o(t.value[1]))},{default:s(()=>[a(_(R),null,{default:s(()=>r[4]||(r[4]=[$("Allergies")])),_:1,__:[4]})]),_:1}),a(_(Ze),{value:"other_notes",onClick:r[2]||(r[2]=i=>o(t.value[2]))},{default:s(()=>[a(_(R),null,{default:s(()=>r[5]||(r[5]=[$("Non-pharmalogical therapy and other notes")])),_:1,__:[5]})]),_:1})]),_:1},8,["value"]),n.value===t.value[0]?(g(),k("div",to,[h("div",ao,[a(Ss)])])):B("",!0),n.value===t.value[1]?(g(),k("div",no,[h("div",so,[a(Ns),a(Zs,{style:{"margin-top":"10px"}})])])):B("",!0),n.value===t.value[2]?(g(),k("div",oo,[h("div",io,[a(Js)])])):B("",!0)]))}}),fi=z(lo,[["__scopeId","data-v-d844be41"]]);async function hi(){var e,t,n;try{const o=K(),{patient:l}=ve(o),r=co(),i=JSON.parse(JSON.stringify(l.value));if(r.length>0){(n=(t=(e=i.MedicationOrder)!=null?e:i.MedicationOrder={}).unsaved)!=null||(t.unsaved=[]);const d=i.MedicationOrder.unsaved.findIndex(p=>p.NCD_Drug_Orders);if(d>=0)i.MedicationOrder.unsaved[d].NCD_Drug_Orders=[...i.MedicationOrder.unsaved[d].NCD_Drug_Orders,...r];else{const p={NCD_Drug_Orders:r};i.MedicationOrder.unsaved.push(p)}await we(i),se().clearMedicationDataStores(),Ce("Drug order(s) has been created")}else ne("Unable to create drug orders!")}catch(o){ne("Unable to create drug orders!")}}function Nt(){try{const e=new Date(ee.getSessionDate()),n=Ne().selectedMedicalDrugsList;let o=0;if(n.forEach(p=>{const u=parseInt(p.duration,10);!isNaN(u)&&u>o&&(o=u)}),o<=0)return{date:null,formattedDate:null};const l=new Date(e);l.setDate(e.getDate()+o);const r=String(l.getDate()).padStart(2,"0"),i=String(l.getMonth()+1).padStart(2,"0"),d=l.getFullYear(),m="".concat(r,"/").concat(i,"/").concat(d);return{date:l,formattedDate:m}}catch(e){return console.error("Error calculating OPD medication run out date:",e),{date:null,formattedDate:null}}}function ro(){try{const e=new Date(ee.getSessionDate()),n=se().selectedNCDMedicationList;let o=0;if(n.forEach(p=>{const u=parseInt(p.duration,10);!isNaN(u)&&u>o&&(o=u)}),o<=0)return{date:null,formattedDate:null};const l=new Date(e);l.setDate(e.getDate()+o);const r=String(l.getDate()).padStart(2,"0"),i=String(l.getMonth()+1).padStart(2,"0"),d=l.getFullYear(),m="".concat(r,"/").concat(i,"/").concat(d);return{date:l,formattedDate:m}}catch(e){return console.error("Error calculating medication run out date:",e),{date:null,formattedDate:null}}}const co=()=>{const e=se();return e.selectedNCDMedicationList.map(t=>{t.frequency=e.frequency_selections[t.drug_id]||"",t.totalDosage=Object.values(t.dosage).reduce((l,r)=>l+Number(r),0);const n=Ht.getSessionDate(),o=mo(t.drug_id);return{drug_inventory_id:t.drug_id,equivalent_daily_dose:t.totalDosage=="Unknown"?0:t.totalDosage*(o==null?void 0:o.value)||0,start_date:n,auto_expire_date:Jt(n,t.duration),units:t.units,instructions:"".concat(t.name," ").concat(t.totalDosage," ").concat(t.units," ").concat((o==null?void 0:o.code)||""," for ").concat(t.duration," days"),dose:uo(t),frequency:(o==null?void 0:o.code)||""}})},uo=e=>e.dose_strength!=null&&e.dose_strength?Math.trunc(e.dose_strength):1;async function gi(){var e,t,n;try{const o=K(),{patient:l}=ve(o),r=po(),i=JSON.parse(JSON.stringify(l.value));if(r.length>0){(n=(t=(e=i.MedicationOrder)!=null?e:i.MedicationOrder={}).unsaved)!=null||(t.unsaved=[]);const d=i.MedicationOrder.unsaved.findIndex(p=>p.NCD_Drug_Orders);if(d>=0)i.MedicationOrder.unsaved[d].NCD_Drug_Orders=[...i.MedicationOrder.unsaved[d].NCD_Drug_Orders,...r];else{const p={NCD_Drug_Orders:r};i.MedicationOrder.unsaved.push(p)}await we(i),Ne().clearSelectedMedicalDrugsList(),Ce("Drug order(s) has been created")}else ne("Unable to create drug orders!")}catch(o){ne("Unable to create drug orders!")}}const po=()=>Ne().selectedMedicalDrugsList.map(t=>{const n=Ht.getSessionDate(),o=be.find(l=>l.label===t.frequency)||{};return{drug_inventory_id:t.drug_id,equivalent_daily_dose:t.dose=="Unknown"?0:t.dose*(o==null?void 0:o.value)||0,start_date:n,auto_expire_date:Jt(n,t.duration),units:t.units,instructions:"".concat(t.drugName,": ").concat(t.dose," ").concat(t.units," ").concat((o==null?void 0:o.code)||""," for ").concat(t.duration," days"),dose:t.dose,frequency:(o==null?void 0:o.code)||""}}),mo=e=>{const n=se().selectedNCDMedicationList.find(l=>l.drug_id===e);if(!n||!n.dosage)return null;switch(["morning","afternoon","evening"].reduce((l,r)=>l+(n.dosage[r]?1:0),0)){case 1:return n.dosage.morning?be.find(l=>l.code==="QAM"):n.dosage.afternoon?be.find(l=>l.code==="QNOON"):n.dosage.evening?be.find(l=>l.code==="QPM"):be.find(l=>l.code==="OD");case 2:return be.find(l=>l.code==="BD");case 3:return be.find(l=>l.code==="TDS");default:return be.find(l=>l.code==="Unknown")}},Jt=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+parseInt(t)),U.toStandardHisFormat(n)},_o=E({components:{IonContent:ie,IonHeader:ue,IonItem:W,IonList:Z,IonMenu:$e,IonTitle:fe,IonToolbar:pe,BasicInputField:Pe,IonDatetime:Lt,IonBadge:ca,DateInputField:Ta,DynamicButton:ce},setup(){const e=et(),t=v(0),n=le(()=>e.getDisabledDates()),o=le(()=>e.getAssignedAppointments()),l=v();return{disabledDates:n,datesCounts:o,appointment_count:t,calendarOutline:ua,inputPRDate:l}},data(){return ye(),ht(),{iconsContent:de,date:new Date(ee.getSessionDate()),tomorrow:new Date(ee.getSessionDate()).getDate()+1,appointment:"",drugRunoutDate:"",nextAppointmentDate:"",minDate:new Date(ee.getSessionDate())}},computed:{...Q(ye,["nextAppointment","appointmentCountsCache","currentSelectedNextAppointmentDate"]),...Q(et,["maximumNumberOfDaysForEachDay","assignedAppointmentsDates"]),...Q(K,["patient"]),...Q(ht,["activeProgram"]),calendarDate(){const e=ye();return e.currentSelectedNextAppointmentDate?U.toStandardHisDisplayFormat(e.currentSelectedNextAppointmentDate):""},runOutDate(){var e;return((e=this.activeProgram)==null?void 0:e.program_id)===14?Nt():ro()}},watch:{calendarDate:{handler(){this.updateNextAppointment()},deep:!0},"$service.sessionDate":{handler(){this.updateMinDate()},immediate:!0},"patient.ID":{async handler(e,t){e!==t&&(this.cleanCurrentNextAppointmentDate(),this.checkIfSamePatientInContext())}}},async mounted(){this.checkIfSamePatientInContext(),await this.getAppointmentMents(this.runOutDate.date),await Na().loadGlobalProperty(),this.validateAppointmentCountsCache(),await this.preloadAppointmentCounts(),La();const e=ee.getUserID(),t=new Et;this.appointment=new xe(t.getID(),e),this.nextAppointmentDate=this.appointment.date,this.supposedRunOutDate(),window.addEventListener("storage",this.handleStorageChange),Nt()},beforeUnmount(){window.removeEventListener("storage",this.handleStorageChange)},methods:{handleStorageChange(e){e.key==="sessionDate"&&this.updateMinDate()},updateMinDate(){this.date=new Date(ee.getSessionDate()),this.minDate=new Date(ee.getSessionDate())},updateNextAppointment(){ye().setNextAppointment(this.calendarDate)},async handleDateUpdate(e){e&&(et().setsssignedAppointmentsDates(e,!0),this.calendarDate=U.toStandardHisDisplayFormat(e),await this.save(),await this.getAppointmentMents(e),await this.updateAppointmentCache(e),ye().setCurrentSelectedNextAppointmentDate(e,this.patient.ID))},async getAppointmentMents(e){if(Ia().apiStatus)try{const n=await xe.getDailiyAppointments(U.toStandardHisFormat(e),U.toStandardHisFormat(e));this.appointment_count=n.length}catch(n){}},getCounter(e){const t=U.toStandardHisFormat(e);return this.appointmentCountsCache[t]||""},async save(){if(this.assignedAppointmentsDates.length>0)try{const t=await new Fa().createOfflineAppointment()}catch(e){}},async openCornfirmModal(e){this.calendarDate=U.toStandardHisDisplayFormat(e),await this.getAppointmentMents(e),ct(Ca,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Appointment?"},{cancel:l=>{},confirm:async l=>{l.detail==!0&&await this.handleDateUpdate(e)}})},async handleInput(e){this.inputPRDate=U.toStandardHisDisplayFormat(e),await this.openCornfirmModal(e)},async supposedRunOutDate(){await Bt.getLastDrugsReceived(this.patient.patientID)},async preloadAppointmentCounts(){try{const e=new Date(ee.getSessionDate());e.setDate(1);const t=new Date(ee.getSessionDate());t.setMonth(t.getMonth()+2),t.setDate(0);const n=this.generateDateRange(e,t);for(const o of n)try{const l=await xe.getDailiyAppointments(U.toStandardHisFormat(o),U.toStandardHisFormat(o)),r=U.toStandardHisFormat(o);this.appointmentCountsCache[r]=l.length}catch(l){console.error("Error fetching appointments for ".concat(o,":"),l);const r=U.toStandardHisFormat(o);this.appointmentCountsCache[r]=0}}catch(e){console.error("Error in preload process:",e)}},generateDateRange(e,t){const n=[],o=new Date(e);for(;o<=t;)n.push(new Date(o)),o.setDate(o.getDate()+1);return n},async updateAppointmentCache(e){try{const t=U.toStandardHisFormat(e),n=await xe.getDailiyAppointments(U.toStandardHisFormat(e),U.toStandardHisFormat(e));this.appointmentCountsCache[t]=n.length}catch(t){console.error("Error updating appointment cache:",t)}},validateAppointmentCountsCache(){ye().checkCurrentLocationIfInContext()},isRunOutDate(e){return!this.runOutDate||!this.runOutDate.date?!1:U.toStandardHisFormat(e)===U.toStandardHisFormat(this.runOutDate.date)},cleanCurrentNextAppointmentDate(){ye().cleanCurrentSelectedNextAppointmentDate()},checkIfSamePatientInContext(){const e=ye();e.current_patient.ID!=this.patient.ID&&(this.cleanCurrentNextAppointmentDate(),e.setCurrentPatient(this.patient))}}}),fo={class:"card_content"},ho={class:"count-badge"},go={class:"dates_title"},vo={class:"sub_data"},Do={class:"dates_title"},yo={class:"sub_data"},bo={class:"dates_title"},So={class:"sub_data"},wo={class:"dates_title"},Co={class:"sub_data"};function Io(e,t,n,o,l,r){const i=f("VueDatePicker"),d=f("ion-col"),m=f("DynamicButton"),p=f("ion-item"),u=f("ion-row"),c=f("DateInputField");return g(),k("div",fo,[a(u,null,{default:s(()=>[a(d,{"size-sm":"12","size-md":"12","size-lg":"12","size-xl":"8"},{default:s(()=>[a(i,{class:"calender",onDateUpdate:e.openCornfirmModal,inline:"","auto-apply":"","enable-time-picker":!1,"disabled-dates":e.disabledDates,"min-date":e.minDate,modelValue:e.runOutDate.date,"onUpdate:modelValue":t[0]||(t[0]=D=>e.runOutDate.date=D)},{day:s(({day:D,date:C})=>[(g(),k("p",{key:0,class:ae({"run-out-date":e.isRunOutDate(C)}),style:{"font-weight":"600","font-size":"20px"}},[h("span",null,[$(P(D),1),h("sup",ho,P(e.getCounter(C)),1)])],2))]),_:1},8,["onDateUpdate","disabled-dates","min-date","modelValue"])]),_:1}),a(d,null,{default:s(()=>[a(p,null,{default:s(()=>[h("div",go,[t[3]||(t[3]=h("div",null,[$("Suggested Next Appointment Date "),h("span",{style:{"font-size":"16px"}},"(Medication run out date)")],-1)),h("div",vo,[$(P(e.runOutDate.formattedDate||"No run out date available")+" ",1),e.runOutDate.formattedDate?(g(),F(m,{key:0,onClick:t[1]||(t[1]=D=>e.handleDateUpdate(e.runOutDate.date)),name:"Set Next Appt.",fill:"solid",iconSlot:"icon-only",style:{float:"right"}})):B("",!0)])])]),_:1}),a(p,null,{default:s(()=>[h("div",Do,[t[4]||(t[4]=h("div",null,"User set appointment date",-1)),h("div",yo,P(e.calendarDate),1)])]),_:1}),a(p,null,{default:s(()=>[h("div",bo,[t[5]||(t[5]=h("div",null,"Appointments",-1)),h("div",So,P(e.appointment_count),1)])]),_:1}),a(p,null,{default:s(()=>[h("div",wo,[t[6]||(t[6]=h("div",null,"Appointment limit (per/day)",-1)),h("div",Co,P(e.appointment_count)+"/"+P(e.maximumNumberOfDaysForEachDay),1)])]),_:1})]),_:1})]),_:1}),a(u,null,{default:s(()=>[a(d,{size:"4"},{default:s(()=>[a(c,{inputHeader:"Preferred Next Appointment Date",bold:"600",fontSize:"17px",placeholderFontSize:"17px",placeholderFontWeight:"600",unit:"",icon:e.calendarOutline,placeholder:"press to select date",iconRight:"",inputWidth:"100%",inputValue:e.inputPRDate,eventType:"",minDate:e.minDate,maxDate:"",disabled:!1,"onUpdate:rawDateValue":t[2]||(t[2]=D=>e.handleInput(D))},null,8,["icon","inputValue","minDate"])]),_:1})]),_:1})])}const vi=z(_o,[["render",Io],["__scopeId","data-v-b92d422a"]]),No=E({components:{IonItem:W,IonCol:Y,IonLabel:R},data(){return{iconsContent:de}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(e){const t=document.getElementById(e+"_lbl");t&&(t.style.color="#006401"),this.highlightActionBtns(e)},undoHighlightItem(e){const t=document.getElementById(e+"_lbl");t&&(t.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(e)},highlightActionBtns(e){const t=document.getElementsByClassName(e+"_spanlbl");for(let n=0;n<t.length;n++)t[n].style.display="block"},undohighlightActionBtns(e){const t=document.getElementsByClassName(e+"_spanlbl");for(let n=0;n<t.length;n++)t[n].style.display="none"},asignLblID(e){return e+"_lbl"},asignSpanLblID(e){return e+"_spanlbl"},async removeItemAtIndex(e,t){await ut("Do you want to delete it?",t)&&this.$emit("update:removeItem",e)},async editItemAtIndex(e,t,n){await Ma("Do you want to edit it?",n)&&this.$emit("update:editItem",{index:e,item:t})},fomartDate(e){const t=e.year,n=(e.month<10?"0":"")+e.month,o=(e.day<10?"0":"")+e.day;return t+"-"+n+"-"+o}}});function Mo(e,t,n,o,l,r){const i=f("ion-label"),d=f("ion-col"),m=f("ion-icon"),p=f("ion-item");return g(!0),k(J,null,G(e.displayData,(u,c)=>(g(),F(p,{displayData:e.displayData,class:"ionLbltp",key:c,onMousemove:D=>e.highlightItem(c),onMouseout:D=>e.undoHighlightItem(c)},{default:s(()=>[a(d,{class:"col-st1"},{default:s(()=>[a(i,{id:e.asignLblID(c),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:s(()=>[$(P(u.type),1)]),_:2},1032,["id"])]),_:2},1024),a(d,{class:"col-st2"},{default:s(()=>[a(i,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:s(()=>[t[0]||(t[0]=h("span",{class:"spaceBetween"},null,-1)),$(" "+P(u.name)+" ",1),t[1]||(t[1]=h("span",{class:"spaceBetween"},null,-1)),$(P(u.reason),1),t[2]||(t[2]=h("span",{class:"spaceBetween"},null,-1)),$(P(e.fomartDate(u.date)),1)]),_:2,__:[0,1,2]},1024)]),_:2},1024),a(d,{class:"action_buttons"},{default:s(()=>[a(i,{class:ae(e.asignSpanLblID(c)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:D=>e.editItemAtIndex(c,u,D)},{default:s(()=>[a(m,{icon:e.iconsContent.edit},null,8,["icon"])]),_:2},1032,["class","onClick"]),a(i,{class:ae(e.asignSpanLblID(c)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:D=>e.removeItemAtIndex(c,D)},{default:s(()=>[a(m,{icon:e.iconsContent.delete},null,8,["icon"])]),_:2},1032,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const $o=z(No,[["render",Mo],["__scopeId","data-v-4346bf77"]]),Wt=E({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(e,{emit:t}){const n=v(),o=v({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),l=v(),r={name:"Now",show:!0,fn:L},i=v(!0),d=v(!1),m=v(0),p=e;re(()=>p.time_prop,M=>{M&&(n.value=M.time)},{immediate:!0,deep:!0});const u=t;function c(){u("timeUpDated",l.value)}function D(M){d.value==!0?(i.value=!1,d.value=!1):i.value=!0,o.value.isOpen=!0,o.value.event=M}function C(M){n.value=M.detail.value;const w=I(n.value);if(S(w)==!0){L();return}n.value=w}function S(M){return M.indexOf("NaN")!==-1}function I(M){let w=new Date(M),y=w.getHours(),N=w.getMinutes(),O=y>=12?"PM":"AM";y=y%12,y=y||12;let T=y.toString().padStart(2,"0")+":"+N.toString().padStart(2,"0")+" "+O;return l.value={time:T,meridian:O},c(),T}function L(){d.value=!0,n.value=I(new Date),i.value=!1,m.value++}return(M,w)=>{const y=f("ion-popover");return g(),k(J,null,[(g(),F(Pe,{placeholder:p.place_holder.default,inputValue:n.value,icon:_(pa),"-inner-action-btn-propeties":r,"onClicked:inputValue":D,"onUpdate:InnerActionBtnPropetiesAction":r.fn,key:m.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),a(y,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":o.value.isOpen,event:o.value.event,side:"top",onDidDismiss:w[0]||(w[0]=N=>o.value.isOpen=!1)},{default:s(()=>[i.value?(g(),F(_(Lt),{key:0,onIonChange:C,id:"datetime",presentation:"time","show-default-buttons":!0})):B("",!0)]),_:1},8,["is-open","event"])],64)}}});async function Oo(e={}){try{const{name:t="",page:n=1,page_size:o=10}=e,l=t?{name:"%".concat(t,"%")}:{};return(await Fe("wards",{likeClause:l,currentPage:n,itemsPerPage:o}).then(i=>i.records)).map(i=>({name:i.name,value:i.name,other:i}))}catch(t){throw console.error("Error fetching offline wards:",t.message),t}}const ko=E({name:"xxxComponent"}),Ao=E({...ko,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(e,{emit:t}){const n=v([]),o=Ke(),l=v(NaN),r=v(!1),i=v(),d=v(!1);me(async()=>{w(),C()});const m=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:y},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:q}],p=[{placeHolder:"Reason",dataHandler:L,dataValue:v(),show_error:v(!1),error_message:"please provide a reason"}],u=[{placeHolder:{default:"Enter date"},dataHandler:I,dataValue:v(),show_error:v(!1),error_message:"please provide date"}],c=[{placeHolder:{default:"Enter time of admission"},dataHandler:S,dataValue:v(),show_error:v(!1),error_message:"error"}],D=e;re(()=>D.selected_ward_prop,V=>{V&&(i.value=V)},{immediate:!0,deep:!0}),re(()=>D.admitted_other_props,V=>{V&&(p[0].dataValue.value=V.reason,c[0].dataValue.value=V.time,u[0].dataValue.value=V.date)},{immediate:!0,deep:!0});function C(V=!0){d.value=V}function S(V){c[0].dataValue.value=V,y(!1)}function I(V){const b={day:V.value.day,month:V.value.month,year:V.value.year,formattedDate:V.value.formattedDate};u[0].dataValue.value=b,y(!1)}function L(V){const b=V.target.value;p[0].dataValue.value=b,M(),C(!1)}function M(){d.value==!0&&ne("Remember to press the SAVE button",1e4)}async function w(V){(await Oo({name:"",page:1,page_size:1e3})).forEach(x=>{const oe={name:x.name,selected:!1,other:x,location_ward_id:x.other.location_id};n.value.push(oe)})}function y(V=!0){N(),O(),X(),Be(),u[0].show_error.value==!1&&c[0].show_error.value==!1&&p[0].show_error.value==!1&&r.value==!1?T():V&&ne("Please enter correct data values",4e3)}function N(){i.value===void 0||i.value==""?r.value=!0:r.value=!1}function O(){p[0].dataValue.value==""||p[0].dataValue.value===void 0?p[0].show_error.value=!0:p[0].show_error.value=!1}async function T(){const V={name:i.value.name,type:"Admitted for short stay",date:u[0].dataValue,time:c[0].dataValue,reason:p[0].dataValue,other:i.value,selected:!0};await o.addOutcomeData(V,l.value)&&H({dataSaved:!1})}const A=t;function H(V={dataSaved:!0}){A("dataSaved",V)}function q(){H()}function X(){u[0].dataValue.value===void 0||u[0].dataValue.value==""?u[0].show_error.value=!0:u[0].show_error.value=!1}function Be(){c[0].dataValue.value===void 0||u[0].dataValue.value==""?c[0].show_error.value=!0:c[0].show_error.value=!1}const De=V=>{i.value=V,C(),y(!1)};return(V,b)=>(g(),F(_(Z),null,{default:s(()=>[a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[a(_(rt),{modelValue:i.value,"onUpdate:modelValue":[b[0]||(b[0]=x=>i.value=x),b[1]||(b[1]=x=>De(x))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:b[2]||(b[2]=x=>x={}),"track-by":"location_ward_id",options:n.value},null,8,["modelValue","options"]),h("div",null,[r.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>b[3]||(b[3]=[$(P("Please select a ward"))])),_:1,__:[3]})):B("",!0)])]),_:1})]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[h("div",null,[a(pt,{place_holder:u[0].placeHolder,onDateUpDated:u[0].dataHandler,date_prop:u[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),h("div",null,[u[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(u[0].error_message),1)]),_:1})):B("",!0)])])]),_:1})]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[h("div",null,[a(Wt,{place_holder:c[0].placeHolder,onTimeUpDated:c[0].dataHandler,time_prop:c[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),h("div",null,[c[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(c[0].error_message),1)]),_:1})):B("",!0)])])]),_:1})]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[a(Pe,{placeholder:p[0].placeHolder,icon:_(Ft),inputValue:p[0].dataValue.value,"onUpdate:inputValue":p[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),h("div",null,[p[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(p[0].error_message),1)]),_:1})):B("",!0)])]),_:1})]),_:1}),m[0].showAddItemButton?(g(),F(_(j),{key:0,class:"spc_btwn"},{default:s(()=>[m[0].addItemButton?(g(),F(ce,{key:0,name:m[0].name,fill:m[0].btnFill,icon:_(dt),"onClicked:btn":m[0].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0),m[1].addItemButton?(g(),F(ce,{key:1,name:m[1].name,fill:m[1].btnFill,icon:_(Ge),"onClicked:btn":m[1].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0)]),_:1})):B("",!0)]),_:1}))}}),Po=z(Ao,[["__scopeId","data-v-3f54ed58"]]),Lo=E({name:"xxxComponent"}),Fo=E({...Lo,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(e,{emit:t}){const n=v(NaN),o=v(null),l=Ke(),r=v(!1),i=v([]),d=v({}),m=v(!0),p={location_data:{}},u=[{placeHolder:"Reason",dataHandler:I,dataValue:v(),show_error:v(!1),error_message:"please provide a reason"}],c=[{placeHolder:{default:"Enter date"},dataHandler:S,dataValue:v(),show_error:v(!1),error_message:"please provide date"}],D=[{placeHolder:{default:"Enter time of referral"},dataHandler:M,dataValue:v(),show_error:v(!1),error_message:"error"}],C=e;re(()=>C.selected_other_referral_data,b=>{b&&(u[0].dataValue.value=b.reason,c[0].dataValue.value=b.date,D[0].dataValue.value=b.time)},{immediate:!0,deep:!0}),re(()=>C.selected_referral_data,b=>{if(!b)return;o.value=b.selected_location,p.location_data=b;const x=Array.isArray(b.selected_district_ids)?[...b.selected_district_ids]:[],oe=b.selected_location?{...b.selected_location}:null;i.value=x,d.value=oe},{immediate:!0,deep:!0}),me(()=>{A()});function S(b){const x={day:b.value.day,month:b.value.month,year:b.value.year,formattedDate:b.value.formattedDate};c[0].dataValue.value=x,w(!1)}function I(b){const x=b.target.value;u[0].dataValue.value=x,L(),A(!1)}function L(){m.value==!0&&ne("Remember to press the SAVE button",1e4)}function M(b){D[0].dataValue.value=b,w(!1)}function w(b=!0){T(),y(),N(),O(),c[0].show_error.value==!1&&D[0].show_error.value==!1&&u[0].show_error.value==!1&&r.value==!1?q():b&&ne("Please enter correct data values",4e3)}function y(){u[0].dataValue.value==""||u[0].dataValue.value===void 0?u[0].show_error.value=!0:u[0].show_error.value=!1}function N(){c[0].dataValue.value===void 0||c[0].dataValue.value==""?c[0].show_error.value=!0:c[0].show_error.value=!1}function O(){D[0].dataValue.value===void 0||c[0].dataValue.value==""?D[0].show_error.value=!0:D[0].show_error.value=!1}function T(){o.value?r.value=!1:r.value=!0}function A(b=!0){m.value=b}const H=b=>{o.value=b.selected_location,T(),p.location_data=b,A(),w(!1)},q=async()=>{const b={name:o.value.name,type:"Referred out",selected:!0,date:c[0].dataValue,time:D[0].dataValue,reason:u[0].dataValue},x={...b,other:{ref_data:b,location_data:p.location_data}};await l.addOutcomeData(x,n.value)&&De({dataSaved:!1})},X=()=>{De()},Be=t;function De(b={dataSaved:!0}){Be("dataSaved",b)}const V=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:w},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:X}];return(b,x)=>(g(),F(_(Z),null,{default:s(()=>[a(_(j),null,{default:s(()=>[a(Va,{show_error:r.value,onFacilitySelected:H,selected_district_ids:i.value,selected_location:d.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[h("div",null,[a(pt,{place_holder:c[0].placeHolder,onDateUpDated:c[0].dataHandler,date_prop:c[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),h("div",null,[c[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(c[0].error_message),1)]),_:1})):B("",!0)])])]),_:1})]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[h("div",null,[a(Wt,{place_holder:D[0].placeHolder,onTimeUpDated:D[0].dataHandler,time_prop:D[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),h("div",null,[D[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(D[0].error_message),1)]),_:1})):B("",!0)])])]),_:1})]),_:1}),a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[a(Pe,{placeholder:u[0].placeHolder,icon:_(Ft),inputValue:u[0].dataValue.value,"onUpdate:inputValue":u[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),h("div",null,[u[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(u[0].error_message),1)]),_:1})):B("",!0)])]),_:1})]),_:1}),V[0].showAddItemButton?(g(),F(_(j),{key:0,class:"spc_btwn"},{default:s(()=>[V[0].addItemButton?(g(),F(ce,{key:0,name:V[0].name,fill:V[0].btnFill,icon:_(dt),"onClicked:btn":V[0].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0),V[1].addItemButton?(g(),F(ce,{key:1,name:V[1].name,fill:V[1].btnFill,icon:_(Ge),"onClicked:btn":V[1].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0)]),_:1})):B("",!0)]),_:1}))}}),To=z(Fo,[["__scopeId","data-v-aa5f466b"]]),Vo=E({name:"xxxComponent"}),Bo=E({...Vo,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(e,{emit:t}){const n=v(NaN),o=v([]),l=Ke(),r=v();me(async()=>{S("")});const i=[{placeHolder:"Reason",dataHandler:u,dataValue:v(),show_error:v(!1),error_message:"please provide a reason"}],d=[{placeHolder:{default:"Enter date"},dataHandler:p,dataValue:v(),show_error:v(!1),error_message:"please provide date"}],m=e;re(()=>m.selected_discharged_prop,A=>{A&&(r.value=A)},{immediate:!0,deep:!0}),re(()=>m.selected_discharged_data,A=>{A&&(d[0].dataValue.value=A.date||"",A.reason&&(i[0].dataValue.value=A.reason))},{immediate:!0,deep:!0});function p(A){const H={day:A.value.day,month:A.value.month,year:A.value.year,formattedDate:A.value.formattedDate};d[0].dataValue.value=H,L(!1)}function u(A){const H=A.target.value;i[0].dataValue.value=H}o.value,v(!1),v(!1);const c=[{placeHolder:{default:"Enter time of referral"},dataHandler:D,dataValue:v(),show_error:v(!1),error_message:"error"}];function D(A){c[0].dataValue.value=A}const C=new Set;async function S(A){const H=A;(await $a.getFacilities({name:H})).forEach(X=>{C.has(X.location_id)||(C.add(X.location_id),ge.isEmpty(X.name)==!1&&o.value.push({name:X.name,selected:!1,other:X}))})}function I(A){o.value=A}function L(A=!0){M(),d[0].show_error.value?A&&ne("Please enter a valid date",4e3):w()}function M(){d[0].dataValue.value===void 0||d[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}async function w(){const A={type:"Discharged Home",date:d[0].dataValue,reason:i[0].dataValue.value};await l.addOutcomeData(A,n.value)&&O({dataSaved:!1})}function y(){O()}const N=t;function O(A={dataSaved:!0}){N("dataSaved",A)}const T=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:L},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:y}];return(A,H)=>(g(),F(_(Z),null,{default:s(()=>[a(_(j),null,{default:s(()=>[a(_(Y),null,{default:s(()=>[h("div",null,[a(pt,{place_holder:d[0].placeHolder,onDateUpDated:d[0].dataHandler,date_prop:d[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),h("div",null,[d[0].show_error.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>[$(P(d[0].error_message),1)]),_:1})):B("",!0)])])]),_:1})]),_:1}),T[0].showAddItemButton?(g(),F(_(j),{key:0,class:"spc_btwn"},{default:s(()=>[T[0].addItemButton?(g(),F(ce,{key:0,name:T[0].name,fill:T[0].btnFill,icon:_(dt),"onClicked:btn":T[0].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0),T[1].addItemButton?(g(),F(ce,{key:1,name:T[1].name,fill:T[1].btnFill,icon:_(Ge),"onClicked:btn":T[1].fn},null,8,["name","fill","icon","onClicked:btn"])):B("",!0)]),_:1})):B("",!0)]),_:1}))}}),Eo=z(Bo,[["__scopeId","data-v-c99ccb0e"]]),Ho={class:"dash_box"},Ro={key:0,style:{"margin-top":"100px"}},xo=E({name:"xxxComponent"}),Uo=E({...xo,setup(e){const t=v("No outcome created yet"),n=v(!1),o=v(!0),l=v(""),r=v(!0),i=v(!1),d=Ke(),m=le(()=>d.outcomes),p=v(!1),u=v(!1),c=v(!1),D=v(!1),C=v(!1),S=v(),I=v(null),L=v(null),M=v(null),w=v(null),y=v(null),N=v(null),O=v([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]);function T(b){O.value.forEach(x=>{b.selected==!0&&(b.name==x.name||b.type==x.name)&&(l.value=x.name)})}me(async()=>{H()}),re(()=>l.value,async b=>{p.value==!0?p.value=!1:Be()}),re(()=>m.value.length,async b=>{H()});function A(){O.value.forEach(b=>{b.selected=!1}),l.value=""}function H(){m.value.length>0?r.value=!1:m.value.length==0&&i.value==!1&&(r.value=!0)}function q(b){m.value.splice(b,1)}const X=b=>{q(b.index),T(b.item),I.value=b.item.other.location_data,L.value={reason:b.item.reason,date:b.item.date,time:b.item.time},M.value=b.item.other,w.value=b.item,b.item.type==="Discharged Home"&&(y.value=b.item,N.value={reason:b.item.reason,date:b.item.date})};async function Be(b=!0){const x=l.value;l.value=x;const oe=l.value;oe==O.value[0].name?c.value=!0:c.value=!1,oe==O.value[1].name?D.value=!0:D.value=!1,oe==O.value[2].name?C.value=!0:C.value=!1}function De(){u.value=!1,c.value=!1,C.value=!1,D.value=!1,A()}const V=b=>{O.value.forEach(x=>{x.selected=!1}),S.value=b,S.value.selected=!0,T(S.value)};return(b,x)=>{const oe=f("ion-row");return g(),F(_(Z),null,{default:s(()=>[a(oe,null,{default:s(()=>[a(_(Y),null,{default:s(()=>[(g(),F($o,{key:0,"onUpdate:removeItem":q,"onUpdate:editItem":X,displayData:m.value},null,8,["displayData"]))]),_:1})]),_:1}),r.value?(g(),F(oe,{key:0},{default:s(()=>[h("span",Ho,P(t.value),1)]),_:1})):B("",!0),a(oe,null,{default:s(()=>[a(_(Y),null,{default:s(()=>[o.value?(g(),k("div",Ro,[a(oe,null,{default:s(()=>[a(_(rt),{modelValue:S.value,"onUpdate:modelValue":[x[0]||(x[0]=Xe=>S.value=Xe),x[1]||(x[1]=Xe=>V(Xe))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:O.value},null,8,["modelValue","options"]),h("div",null,[n.value?(g(),F(_(R),{key:0,class:"error-label"},{default:s(()=>x[2]||(x[2]=[$(P("please select a type"))])),_:1,__:[2]})):B("",!0)])]),_:1})])):B("",!0)]),_:1})]),_:1}),c.value?(g(),F(Po,{key:1,onDataSaved:De,selected_ward_prop:M.value,admitted_other_props:w.value},null,8,["selected_ward_prop","admitted_other_props"])):B("",!0),D.value?(g(),F(To,{key:2,onDataSaved:De,selected_referral_data:I.value,selected_other_referral_data:L.value},null,8,["selected_referral_data","selected_other_referral_data"])):B("",!0),C.value?(g(),F(Eo,{key:3,onDataSaved:De,selected_discharged_prop:y.value,selected_discharged_data:N.value},null,8,["selected_discharged_prop","selected_discharged_data"])):B("",!0)]),_:1})}}}),Di=z(Uo,[["__scopeId","data-v-6e592042"]]);export{Ns as A,ii as C,Rt as D,di as E,Dn as L,pi as M,vi as N,Di as O,ft as P,To as R,ci as S,_i as T,un as _,ri as a,li as b,ui as c,se as d,Ka as e,oi as f,fi as g,$s as h,hi as i,Ms as j,gi as k,ds as l,Ps as m,Wt as n,$o as o,za as p,Po as q,Eo as r,mi as s,bt as u};
