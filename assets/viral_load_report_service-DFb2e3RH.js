import{A as l}from"./age_groups-BkW1n_F5.js";import{R as d}from"./regimens-Dknk55PA.js";import{R as u}from"./index-DPw89-8N.js";import{l as _}from"./lodash-NJiRuGo9.js";const V={tx_curr:"TX_CURR",due_for_vl:"Due for VL",drawn_routine:"Routine (Sample Drawn)",drawn_targeted:"Targeted (Sample Drawn)",high_vl_routine:"Routine (High VL (>=1000 copies))",high_vl_targeted:"Targeted (High VL (>=1000 copies))",low_vl_routine:"Routine (Low VL (<1000 copies))",low_vl_targeted:"Targeted (Low VL (<1000 copies))"};class f extends u{constructor(){super()}getVlCollection(){return this.getReport("programs/".concat(this.programId,"/reports/vl_collection"))}async getTxPVLS(t={}){const e=await this.getReport("programs/".concat(this.programId,"/reports/viral_load_coverage"),{rebuild_outcomes:!0,...t});if(!e)return[];const r=this.txPVLSBuilder(e),o=await this.buildMaternityAgreggateRows(r.F.aggregate);return[...r.F.rows,...r.M.rows,{...r.M.aggregate,ageGroup:"All",gender:"M"},...o]}async getViralLoad(t={}){const e=await this.getReport("programs/".concat(this.programId,"/reports/vl_disaggregated"),t);return this.vlReportBuilder(e)}flattenTxPVLSData(t){return Object.entries(t).reduce((e,[r,o])=>(Array.isArray(o)?e[r]=o:(e["".concat(r,"_routine")]=o.routine,e["".concat(r,"_targeted")]=o.targeted),e),{})}txPVLSBuilder(t){return Object.entries(t!=null?t:{}).reduce((e,[r,o])=>(r!=="Unknown"&&Object.entries(o).forEach(([c,p])=>{const a=c,i=this.flattenTxPVLSData(p);e[a].rows.push({ageGroup:r,gender:a,...i}),Object.entries(i).forEach(([s,g])=>{var n;e[a].aggregate[s]=[...(n=e[a].aggregate[s])!=null?n:[],...g!=null?g:[]]})}),e),{M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}})}vlReportBuilder(t){return l.map(e=>[...d,"N/A"].reduce((r,o)=>(r[o]=_.get(t,"".concat(e.replace("-"," - "),".").concat(o),0),r),{ageGroup:e}))}}export{V as T,f as V};
