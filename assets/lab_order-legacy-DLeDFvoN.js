!function(){function t(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var s=a.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}System.register(["./vendor-legacy-Hbu-Y7YT.js","./index-legacy-CBurBhXr.js","./BasicForm-legacy-BN-ZWGVE.js","./DashBox-legacy-Kf_zT89k.js","./group_validation-legacy-B7REf52b.js"],function(e,a){"use strict";var s,n,i,o,l,r,d,u,c,p,h,m,b,v,g,f,y,_,I,D,w,x,S,O,T,k,B,R,C,F,L,M,N,P,E,z,H,U,$,j,A,q,W,J,G,V,Y,X,K,Q,Z,tt,et,at,st,nt,it,ot,lt,rt;return{setters:[t=>{s=t.R,n=t.d,i=t.ar,o=t.V,l=t.as,r=t.af,d=t.D,u=t.dk,c=t.dv,p=t.ac,h=t.G,m=t.T,b=t.U,v=t.a9,g=t.S,f=t.b8,y=t.W,_=t.aU,I=t.X,D=t.E,w=t.y,x=t.f,S=t.z,O=t.l,T=t.k,k=t.B,B=t.A,R=t.e,C=t.F,F=t.L,L=t.a0,M=t.a3,N=t.a1,P=t.a2,E=t.I,z=t.aa,H=t.ab,U=t.a8},t=>{$=t.aP,j=t.az,A=t.D,q=t.aO,W=t.S,J=t.C,G=t.H,V=t.ax,Y=t.k,X=t.u,K=t._,Q=t.i,Z=t.aE,tt=t.B,et=t.aF,at=t.x,st=t.ay,nt=t.bm,it=t.t},t=>{ot=t.B},t=>{lt=t.D},t=>{rt=t.v}],execute:function(){var a=document.createElement("style");a.textContent="ion-footer[data-v-a9001ab2]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-a9001ab2]{--width: 90%;--height: 94%}ion-footer[data-v-5d6713fe]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-5d6713fe]{--width: 90%;--height: 94%}.ion-padding[data-v-bae5aa39]{--padding-start: var(--ion-padding, 0px);--padding-end: var(--ion-padding, 0px);--padding-top: var(--ion-padding, 0px);--padding-bottom: var(--ion-padding, 16px)}#container[data-v-bae5aa39]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-bae5aa39]{font-size:20px;line-height:26px}#container p[data-v-bae5aa39]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-bae5aa39]{text-decoration:none}.action_buttons[data-v-bae5aa39]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-bae5aa39]{padding-left:20px}.item_no_border[data-v-bae5aa39]{--border-color: transparent}.search_result[data-v-bae5aa39]{padding:10px}.action_buttons[data-v-bae5aa39]{opacity:0;transition:opacity .3s}.dashed_bottom_border:hover .action_buttons[data-v-bae5aa39]{opacity:1}.dashed_bottom_border[data-v-bae5aa39]{font-weight:700}.sub_item_body[data-v-bae5aa39]{margin-left:45px}ion-segment-button[data-v-bae5aa39]{background:#fff;margin-right:1px;font-size:12px;text-transform:unset}.bottomSummary[data-v-bae5aa39]{margin-top:20px;max-width:600px}.bottomSummary .segment-button-checked[data-v-bae5aa39]{background:#fff!important;--indicator-color: none}.bottomSummary ion-segment-button[data-v-bae5aa39]{background:#e6e6e6;margin-right:5px;border-top-right-radius:10px;border-top-left-radius:10px;text-transform:unset;font-style:normal;font-weight:700;font-size:12px}ion-modal[data-v-be6bf3e1]{--background: rgba(0, 0, 0, .9);--width: 90%;--height: 20%;--max-width: 550px;--max-height: 100px}ion-header[data-v-be6bf3e1]{--background: var(--ion-color-primary)}ion-title[data-v-be6bf3e1]{color:var(--ion-color-light)}ion-content[data-v-be6bf3e1]{display:flex}ion-footer[data-v-be6bf3e1]{--ion-toolbar-background: #fff}\n/*$vite$:1*/",document.head.appendChild(a);const dt=e("u",s("labResultsStore",{state:()=>({labResults:[]}),actions:{setLabResults(t){this.labResults=t}},persist:!0}));class ut extends ${constructor(e){super(e,32),t(this,"patientID",void 0),t(this,"testTypeID",void 0),t(this,"resultDate",void 0),t(this,"testID",void 0),this.patientID=e,this.testTypeID=-1,this.resultDate="",this.testID=-1}createLabResult(t){return $.postJson(`lab/tests/${this.testID}/results`,{encounter_id:this.encounterID,date:this.resultDate,measures:t})}getTestID(){return this.testID}getTestTypeID(){return this.testTypeID}setTestTypeID(t){this.testTypeID=t}setResultDate(t){this.resultDate=t}setTestID(t){this.testID=t}getTestsWithoutResults(){return j.getOrders(this.patientID,{status:"drawn"})}getTestIndicators(){return j.getJson("lab/test_result_indicators",{test_type_id:this.testTypeID})}static getTestIndicatorsWithID(t){return j.getJson("lab/test_result_indicators",{test_type_id:t})}}e("P",ut);const ct=n({components:{IonButtons:_,IonButton:y,IonModal:f,IonHeader:g,IonContent:v,IonToolbar:b,IonTitle:m,IonItem:h,IonList:p,IonAvatar:c,IonImg:u,IonLabel:d,IonPage:r,IonMenu:l,BasicForm:ot,IonFooter:o,DynamicButton:A},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{type:Object,default:{}},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},computed:{...i(X,["patient"]),...i(dt,["labResults"])},mounted(){},methods:{dismiss(){I.dismiss()},async saveResults(){const t=await this.buildResults();this.patient.labOrders.results=[{encounter_id:"",date:G.sessionDate(),measures:t,test_id:this.labResults[0].id}];let e=!1;for(let a=0;a<this.patient.labOrders.unsaved.length;a++)if(this.patient.labOrders.unsaved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.unsaved[a].tests&&this.patient.labOrders.unsaved[a].tests.length>0){this.patient.labOrders.unsaved[a].tests[0].result=t,e=!0;break}if(!e)for(let a=0;a<this.patient.labOrders.saved.length;a++)if(this.patient.labOrders.saved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.saved[a].tests&&this.patient.labOrders.saved[a].tests.length>0){this.patient.labOrders.saved[a].tests[0].result=t;break}await V(this.patient),Y("Saved successfully"),this.$emit("saved")},async buildResults(){let t=[];return await Promise.all(this.labResults[1].data.rowData[0].colData.map(async e=>{var a;let s;s=W.getUseIndexDBStatus()||W.getModsStatus()?await J("testResultIndicators",{whereClause:{test_type_id:e.id}}):await ut.getTestIndicatorsWithID(e.id),t.push({indicator:{name:null===(a=s[0])||void 0===a?void 0:a.name,concept_id:e.id},value:e.value.name||e.value||"not done",value_modifier:"",value_type:"text"})})),t},async nav(t,e){const a=dt();"not_save"==e?(await q(),a.setLabResults(!1)):a.setLabResults(!0),this.dismiss(),this.$router.push(t)}}}),pt={class:"modal_wrapper"},ht={class:"center text_12"};e("a",K(ct,[["render",function(t,e,a,s,n,i){const o=D("ion-title"),l=D("ion-button"),r=D("ion-buttons"),d=D("ion-toolbar"),u=D("ion-header"),c=D("basic-form"),p=D("ion-row"),h=D("ion-content"),m=D("DynamicButton"),b=D("ion-footer"),v=D("ion-modal");return x(),w(v,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[2]||(e[2]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:S(()=>[O(u,null,{default:S(()=>[O(d,null,{default:S(()=>[O(o,null,{default:S(()=>[T("b",null,"Enter lab results for ("+k(t.labResults[0].name)+") test",1)]),_:1}),O(r,{slot:"end"},{default:S(()=>[O(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:S(()=>e[3]||(e[3]=[B("Close")])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),O(h,{class:"ion-padding"},{default:S(()=>[T("div",pt,[T("div",ht,[O(p,null,{default:S(()=>[O(c,{contentData:t.labResults},null,8,["contentData"])]),_:1})])])]),_:1}),O(b,{translucent:!0},{default:S(()=>[O(d,null,{default:S(()=>[O(m,{onClick:e[1]||(e[1]=e=>t.saveResults()),name:"Save",fill:"clear",iconSlot:"icon-only",style:{float:"right"}})]),_:1})]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-a9001ab2"]]));const mt=n({components:{IonButtons:_,IonButton:y,IonModal:f,IonHeader:g,IonContent:v,IonToolbar:b,IonTitle:m,IonItem:h,IonList:p,IonAvatar:c,IonImg:u,IonLabel:d,IonPage:r,IonMenu:l,BasicForm:ot,IonFooter:o,DynamicButton:A},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:[]},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},methods:{dismiss(){I.dismiss()},nav(t,e){this.dismiss(),this.$router.push(t)}}}),bt={class:"modal_wrapper"},vt={class:"center text_12"};e("L",K(mt,[["render",function(t,e,a,s,n,i){const o=D("ion-title"),l=D("ion-button"),r=D("ion-buttons"),d=D("ion-toolbar"),u=D("ion-header"),c=D("ion-col"),p=D("ion-row"),h=D("ion-content"),m=D("ion-modal");return x(),w(m,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[1]||(e[1]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:S(()=>[O(u,null,{default:S(()=>[O(d,null,{default:S(()=>[O(o,null,{default:S(()=>[T("b",null,"Lab results for ("+k(t.content.name)+") test",1)]),_:1}),O(r,{slot:"end"},{default:S(()=>[O(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:S(()=>e[2]||(e[2]=[B("Close")])),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),O(h,{class:"ion-padding"},{default:S(()=>[T("div",bt,[T("div",vt,[O(p,null,{default:S(()=>[(x(!0),R(C,null,F(t.content.result,(t,a)=>(x(),w(c,{size:"4",key:a},{default:S(()=>[O(p,null,{default:S(()=>[O(c,{size:"8"},{default:S(()=>[B(k(t.indicator.name),1)]),_:2},1024),O(c,{class:"bold",size:"0.5"},{default:S(()=>e[3]||(e[3]=[B(":")])),_:1,__:[3]}),O(c,{class:"bold",size:"2"},{default:S(()=>[B(k(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-5d6713fe"]]));const gt=s("investigationNCDStore",{state:()=>({investigations:[{db_data:[],isFinishBtn:!1,selectedData:[],displayData:[],data:{rowData:[{colData:[{inputHeader:"Test",icon:Q.search,value:"",name:"test",popOver:!0,eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"test_id",validationFunctionName:"required"},{inputHeader:"Specimen",icon:Q.search,value:"",name:"specimen",eventType:"input",required:!0,alertsErrorMassage:"",disabled:!0,isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"specimen_id",validationFunctionName:"required"}]}]}}]}),actions:{setInvestigations(t){this.investigations=t}}}),ft=e("_",n({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(t){this.userRole=W.getUserRoles();const e=W.getProgramID(),a=W.getProgramName();"Lab"==this.userRole&&14==e&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),14==e&&"Lab"!=this.userRole&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),12==e&&(this.userRoleSettings={url:"contact",btnName:"Back"}),"LABOUR AND DELIVERY PROGRAM"==a&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),"PNC PROGRAM"==a&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}})),yt=n({name:"Menu",mixins:[ft],components:{IonContent:v,IonHeader:g,IonItem:h,IonList:p,IonMenu:l,IonTitle:m,IonToolbar:b,IonInput:M,IonPopover:L,DashBox:lt,SelectionPopover:et,BasicInputField:tt,BasicForm:ot,List:Z,DynamicButton:A},data:()=>({segmentContent:"Lab Investigations",iconsContent:Q,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}),setup:()=>({checkmark:P,pulseOutline:N}),computed:{...i(gt,["investigations"]),...i(X,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{dismiss(){I.dismiss()},setSegmentContent(t){this.segmentContent=t},async getTests(){let t;t=W.getUseIndexDBStatus()&&W.getModsStatus()?await J("testTypes"):await j.getTestTypes(),at(this.investigations,"test","multiSelectData",t)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const t=await this.labOrders.filter(t=>G.toStandardHisFormat(G.sessionDate())===G.toStandardHisFormat(t.order_date));t.length>0?this.investigations[0].selectedData=t:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard();gt().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return rt(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(at(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(at(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){rt(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard(),this.dismiss()},isNameInData(t,e){for(let a of e)for(let e of a.tests)if(e.name===t)return!0;return!1},async saveTest(){var t,e,a,s,n,i;const o=[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await st.getConceptID(this.inputFields[1].value.name,!0)}];let l=(await j.buildLabOrders("",o))[0];l.order_date=l.date,l.specimen.name=this.inputFields[1].value.name,l.tests[0].name=this.inputFields[0].value.name;const r=JSON.parse(JSON.stringify(this.patient));null!==(e=(t=null!==(a=r.labOrders)&&void 0!==a?a:r.labOrders={}).unsaved)&&void 0!==e||(t.unsaved=[]),null!==(n=(s=null!==(i=r.labOrders)&&void 0!==i?i:r.labOrders={}).saved)&&void 0!==n||(s.saved=[]),r.labOrders.unsaved.push(l),await V(r),at(this.investigations,"specimen","disabled",!0),this.labOrders=[...r.labOrders.saved,...r.labOrders.unsaved]},async handleInputData(t){if("Test"==t.inputHeader&&this.checkTest(),at(this.investigations,"specimen","alertsErrorMassage",""),"Test"==t.inputHeader&&t.value){let e;e=W.getUseIndexDBStatus()&&W.getModsStatus()?await J("specimens"):await j.getSpecimens("",1e3),this.specimen=await st.getConceptSet(t.value.name,"",{names:e.map(t=>t.name)}),1==this.specimen.length?(at(this.investigations,"specimen","value",this.specimen[0]),at(this.investigations,"specimen","disabled",!0)):(at(this.investigations,"specimen","value",""),at(this.investigations,"specimen","disabled",!1)),at(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(t){return await this.labOrders.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))},async filterSpecimen(t){var e;return null!==(e=this.specimen[0])&&void 0!==e&&e.name&&t?await this.specimen.filter(e=>null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())):[]},setTest(t){this.selectedText=t.name,"Test"==this.inputFields[1].inputHeader?this.investigations[0].data.rowData[0].colData[0].value=t.name:this.investigations[0].data.rowData[0].colData[1].value=t.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),_t={class:"modal_wrapper"},It={class:""};e("E",K(yt,[["render",function(t,e,a,s,n,i){const o=D("ion-title"),l=D("ion-icon"),r=D("ion-header"),d=D("basic-form"),u=D("ion-content"),c=D("DynamicButton"),p=D("ion-col"),h=D("ion-row"),m=D("ion-footer");return x(),R(C,null,[O(r,{style:{display:"flex","justify-content":"space-between"}},{default:S(()=>[O(o,{class:"modalTitle"},{default:S(()=>e[2]||(e[2]=[B("Add Lab Test")])),_:1,__:[2]}),O(l,{onClick:e[0]||(e[0]=e=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),O(u,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:S(()=>[T("div",_t,[T("div",It,[O(d,{contentData:t.investigations,"onUpdate:selected":t.handleInputData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:selected","onUpdate:inputValue"])])])]),_:1}),O(m,{collapse:"fade",class:"ion-no-border"},{default:S(()=>[O(h,null,{default:S(()=>[O(p,null,{default:S(()=>[O(c,{onClick:e[1]||(e[1]=e=>t.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}],["__scopeId","data-v-bae5aa39"]]));const Dt=n({name:"CheckInConfirmationModal",components:{IonCol:H,IonRow:z,IonFooter:o,DynamicButton:A,IonModal:f,IonHeader:g,IonToolbar:b,IonTitle:m,IonButtons:_,IonButton:y,IonContent:v,IonIcon:E},props:{isOpen:{type:Boolean,required:!0,default:!1},closeModalFunc:{type:Function,required:!0},onYes:{type:Function,required:!0},onNo:{type:Function,required:!0},title:{type:String,required:!0}},computed:{},methods:{closeOutline:()=>U,closeModal(){this.closeModalFunc()},confirm(t){this.closeModal()}}}),wt={style:{display:"flex"}};e("S",K(Dt,[["render",function(t,e,a,s,n,i){const o=D("ion-title"),l=D("ion-icon"),r=D("ion-button"),d=D("ion-buttons"),u=D("ion-col"),c=D("DynamicButton"),p=D("ion-row"),h=D("ion-footer"),m=D("ion-content"),b=D("ion-modal");return x(),w(b,{"is-open":t.isOpen,"show-backdrop":!0,onDidDismiss:t.closeModal},{default:S(()=>[O(d,{slot:"start"},{default:S(()=>[O(o,{style:{color:"#0c0c0c"}},{default:S(()=>[B(k(t.title),1)]),_:1}),O(r,{onClick:t.closeModal},{default:S(()=>[O(l,{slot:"icon-only",icon:t.closeOutline(),style:{color:"#b02a37"}},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),O(m,null,{default:S(()=>[T("div",wt,[O(h,{collapse:"fade",class:"ion-no-border"},{default:S(()=>[O(p,null,{default:S(()=>[O(u,null,{default:S(()=>[O(r,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:t.onNo},{default:S(()=>e[1]||(e[1]=[B(" Cancel ")])),_:1,__:[1]},8,["onClick"])]),_:1}),O(u,null,{default:S(()=>[O(c,{name:"Send",onClick:e[0]||(e[0]=e=>t.onYes()),fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["is-open","onDidDismiss"])}],["__scopeId","data-v-be6bf3e1"]]));e("b",class extends j{constructor(){super()}async postActivities(t,e){const a=e.location_id,s=new nt(parseInt(t),-1,a),n=await s.createEncounter();if(n){const t=await j.buildLabOrders(n,e.orders||e);if(!(await j.saveOrdersArray(n.encounter_id,t)))return it("Unable to save lab orders")}}})}}})}();
