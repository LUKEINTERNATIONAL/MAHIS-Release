System.register(["./vendor-legacy-Cd1x6k36.js","./index-legacy-7oXqeObQ.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-B5iNB82A.js"],function(e,a){"use strict";var t,l,i,n,s,d,u,r,o,c,v,g,p,m,y,_,b,N,f,h,C,E,A,M,S,H,I,L,P,T,R,V,w,D,k,x,O,$,U,B,F,G,j,z;return{setters:[e=>{t=e.d,l=e.r,i=e.a,n=e.w,s=e.e,d=e.f,u=e.k,r=e.F,o=e.L,c=e.l,v=e.z,g=e.A,p=e.B,m=e.u,y=e.bw,_=e.ex,b=e.c_,N=e.ey,f=e.ec,h=e.c$,C=e.ez,E=e.eA,A=e.y,M=e.ah,S=e.aZ,H=e.aW,I=e.M,L=e.J,P=e.G,T=e.m,R=e.I,V=e.D,w=e.bN,D=e.ak,k=e.d4,x=e.bs,O=e.ab,$=e.bo,U=e.an},e=>{B=e._,F=e.N,G=e.bM,j=e.T,z=e.bN},null,null],execute:function(){var a=document.createElement("style");a.textContent=".clinic-days-selector[data-v-95b0e034]{width:100%}.days-container[data-v-95b0e034]{display:flex;flex-wrap:wrap;gap:10px}.day-checkbox[data-v-95b0e034]{min-width:120px}\n/*$vite$:1*/",document.head.appendChild(a);const J={class:"clinic-days-selector"},W={class:"days-container"},X=B(t({__name:"ClinicDaysSelector",props:{modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:a}){const t=e,_=a,b=[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],N=l([]);return i(()=>{if(t.modelValue)try{try{const e=JSON.parse(t.modelValue);Array.isArray(e)?N.value=e:N.value=t.modelValue.split(",").map(e=>e.trim())}catch{N.value=t.modelValue.split(",").map(e=>e.trim())}}catch(e){console.error("Error parsing clinic days:",e),N.value=[]}}),n(()=>t.modelValue,e=>{if(e)try{try{const a=JSON.parse(e);Array.isArray(a)?N.value=a:N.value=e.split(",").map(e=>e.trim())}catch{N.value=e.split(",").map(e=>e.trim())}}catch(a){console.error("Error parsing clinic days:",a),N.value=[]}else N.value=[]}),(e,a)=>(d(),s("div",J,[u("div",W,[(d(),s(r,null,o(b,e=>u("div",{key:e.value,class:"day-checkbox"},[c(m(y),{value:e.value,checked:N.value.includes(e.value),onIonChange:a=>(e=>{const a=N.value.indexOf(e);-1===a?N.value.push(e):N.value.splice(a,1);const t=N.value.join(",");_("update:modelValue",t),_("change",t)})(e.value),labelPlacement:"end"},{default:v(()=>[g(p(e.label),1)]),_:2},1032,["value","checked","onIonChange"])])),64))])]))}}),[["__scopeId","data-v-95b0e034"]]),Y={class:"ion-padding",slot:"content"},K={key:0},Z={key:1},q={key:2},Q={class:"ion-padding"},ee={key:3},ae={class:"ion-padding"};e("default",t({__name:"ARTPreferences",setup(e){const a=l({}),t=l([]),i=l(!1),n=async(e="")=>{i.value=!0;try{const a=await z(e);t.value=a}catch(a){}finally{i.value=!1}},y=async(e,t,l)=>{if(a.value[l]){const n=Boolean(e);a.value[l].data[t]=n,a.value[l].isLoading=!0,a.value[l].statusMessage=void 0;try{await F.set(t,n?"true":"false"),console.log(`Successfully saved ${t} with value: ${n}`)}catch(i){console.error(`Error saving ${t}:`,i),a.value[l].statusMessage=`Failed to save: ${i instanceof Error?i.message:"Unknown error"}`}finally{a.value[l].isLoading=!1}}},B=async(e,t,l,i=!1)=>{if(a.value[l]){a.value[l].data[t]=e,a.value[l].isLoading=!0,a.value[l].statusMessage=void 0;try{let n=e;if(e&&"object"==typeof e&&"value"in e&&(n=e.label),i&&"string"==typeof n){const e=Number(n);if(isNaN(e))return a.value[l].statusMessage="Please enter a valid number",void(a.value[l].isLoading=!1)}await F.set(t,n)}catch(n){console.error(`Error saving ${t}:`,n),a.value[l].statusMessage=`Failed to save: ${n instanceof Error?n.message:"Unknown error"}`}finally{a.value[l].isLoading=!1}}},J=[{icon:_,title:"Filing Numbers",options:[{id:G.FILING_NUMBERS,title:"Enabled Filing Number",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.FILING_NUMBER_LIMIT,title:"Filing Number Limit",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<1||i>1e3?a.value[l].statusMessage="Filing number limit should be between 1 and 1000":B(e,t,l,!0)}}]},{icon:b,title:"Appointments",options:[{id:G.APPOINTMENT_LIMIT,title:"Appointment Limit",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<1||i>500?a.value[l].statusMessage="Appointment limit should be between 1 and 500":B(e,t,l,!0)}},{id:G.ADULT_CLINIC_DAYS,title:"Clinic days (adults: 18 yrs and over)",type:"clinic-days",get:e=>F.get(e)||"",dataHandler:(e,a,t)=>B(e,a,t,!1)},{id:G.PEADS_CLINIC_DAYS,title:"Clinic days (children: Under 18 yrs)",type:"clinic-days",get:e=>F.get(e)||"",dataHandler:(e,a,t)=>B(e,a,t,!1)}]},{icon:N,title:"Clinic Preferences",options:[{id:G.IS_DIC_SITE,title:"Is Military Site",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)}]},{icon:f,title:"Viral load Preferences",options:[{id:G.VL_ROUTINE_CHECK,title:"Activate VL routine check",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.CAN_SCAN_DBS_BARCODE,title:"Scan DBS barcode",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)}]},{icon:h,title:"Lab preferences",options:[{id:G.EXTENDED_LABS,title:"Activate Extended Labs",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.TARGET_LAB,title:"Target lab",type:"facility",get:e=>F.get(e)||"",dataHandler:(e,a,t)=>B(e,a,t,!1)},{id:G.LAB_ORDER_PRINT_COPIES,title:"Specify number of copies to print after an order",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<1||i>10?a.value[l].statusMessage="Number of copies should be between 1 and 10":B(e,t,l,!0)}}]},{icon:C,title:"Hypertension Preferences",options:[{id:G.HTN_ENHANCEMENT,title:"Activate Hypertension screening",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.HTN_DIASTOLIC_THRESHOLD,title:"Set diastolic blood pressure minimum threshold",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<40||i>120?a.value[l].statusMessage="Diastolic BP should be between 40 and 120 mmHg":B(e,t,l,!0)}},{id:G.HTN_SYSTOLIC_THRESHOLD,title:"Set systolic blood pressure minimum threshold",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<70||i>220?a.value[l].statusMessage="Systolic BP should be between 70 and 220 mmHg":B(e,t,l,!0)}},{id:G.HTN_SCREENING_AGE_THRESHOLD,title:"Set HTN Age",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<10||i>100?a.value[l].statusMessage="Age threshold should be between 10 and 100 years":B(e,t,l,!0)}}]},{icon:E,title:"Cervical Cancer Preferences",onOpen:async()=>{var e;a.value["Cervical Cancer Preferences"].data={[G.CERVICAL_CANCER_AGE_BOUNDS]:await F.get(G.CERVICAL_CANCER_AGE_BOUNDS)||""};const[t,l]=(null!==(e=a.value["Cervical Cancer Preferences"].data[G.CERVICAL_CANCER_AGE_BOUNDS])&&void 0!==e?e:"0:0").split(":").map(Number);a.value["Cervical Cancer Preferences"].data.min_cervical_age=t,a.value["Cervical Cancer Preferences"].data.max_cervical_age=l},options:[{id:G.CERVICAL_CANCER_SCREENING,title:"Activate Cervical Cancer Screening",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:"min_cervical_age",title:"Starting screening age",type:"input",get:()=>a.value["Cervical Cancer Preferences"].data.min_cervical_age||"",dataHandler:(e,t,l)=>{const i=Number(e);if(isNaN(i))return void(a.value[l].statusMessage="Please enter valid min age");if(i<10||i>100)return void(a.value[l].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age");const n=a.value[l].data.max_cervical_age;n&&i>=Number(n)?a.value[l].statusMessage="Minimum age should be less than the maximum age":B(`${i}:${n}`,G.CERVICAL_CANCER_AGE_BOUNDS,l,!1)}},{id:"max_cervical_age",title:"Maximum screening age",type:"input",get:()=>a.value["Cervical Cancer Preferences"].data.max_cervical_age||"",dataHandler:(e,t,l)=>{const i=Number(e);if(isNaN(i))return void(a.value[l].statusMessage="Please enter valid max age");if(i<10||i>100)return void(a.value[l].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age");const n=a.value[l].data.min_cervical_age;n&&i<Number(n)?a.value[l].statusMessage="Maximum age should be less than the minimum age":B(`${n}:${i}`,G.CERVICAL_CANCER_AGE_BOUNDS,l,!1)}}]},{icon:N,title:"Other Preferences",options:[{id:G.PILLS_REMAINING,title:"Ask pills remaining at home",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.FAST_TRACK,title:"Activate fast track",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.THREE_HP_AUTO_SELECT,title:"Activate 3HP auto select",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.EXCLUDE_EXTERNAL_AND_DRUG_REFILLS,title:"(DATA CLEANING) Exclude External and Emergency supply",type:"toggle",get:e=>F.isProp(`${e}=true`),dataHandler:(e,a,t)=>y(e,a,t)},{id:G.NOTIFICATION_PERIOD,title:"Set Auto Cleaning Alert Days",type:"input",get:e=>F.get(e)||"",dataHandler:(e,t,l)=>{const i=Number(e);isNaN(i)?a.value[l].statusMessage="Please enter a valid number":i<1||i>365?a.value[l].statusMessage="Notification period should be between 1 and 365 days":B(e,t,l,!0)}}]}];return(e,l)=>(d(),A(m(U),null,{default:v(()=>[c(j),c(m(M),{class:"ion-padding"},{default:v(()=>[c(m(S),{style:{margin:"0px auto",width:"70%"}},{default:v(()=>[c(m(H),null,{default:v(()=>[c(m(I),{onIonChange:l[0]||(l[0]=e=>async function(e){const t=J.find(a=>a.title===e);if(t){a.value[t.title]||(a.value[t.title]={isLoading:!1,data:{},statusMessage:void 0}),a.value[t.title].isLoading=!0,t.onOpen&&await t.onOpen().catch(e=>{console.error(`Error loading ${t.title} settings:`,e),a.value[t.title].statusMessage=`Failed to load settings: ${e instanceof Error?e.message:"Unknown error"}`});const e=await Promise.all(t.options.map(async e=>({[e.id]:await e.get(e.id)})));a.value[t.title].data={...a.value[t.title].data,...e.reduce((e,a)=>({...e,...a}),{})},a.value[t.title].isLoading=!1}}(e.detail.value))},{default:v(()=>[(d(),s(r,null,o(J,(e,l)=>c(m(L),{key:l,class:"ion-padding",value:e.title},{default:v(()=>[c(m(P),{slot:"header"},{default:v(()=>{var t,l;return[c(m(R),{size:"large",icon:e.icon},null,8,["icon"]),c(m(V),{style:{padding:"10px"}},{default:v(()=>[g(p(e.title),1)]),_:2},1024),null!==(t=null===(l=a.value)||void 0===l||null===(l=l[e.title])||void 0===l?void 0:l.isLoading)&&void 0!==t&&t?(d(),A(m(w),{key:0,name:"dots",size:"small",slot:"end"})):T("",!0)]}),_:2},1024),u("div",Y,[c(m(S),null,{default:v(()=>[c(m(H),null,{default:v(()=>{var l;return[null!==(l=a.value)&&void 0!==l&&null!==(l=l[e.title])&&void 0!==l&&l.data?(d(),A(m(D),{key:0,style:{background:"white"}},{default:v(()=>[(d(!0),s(r,null,o(e.options,l=>{var r,o,y,_;return d(),s("div",{key:l.id},["toggle"===l.type?(d(),s("div",K,[c(m(P),{color:"light"},{default:v(()=>[c(m(V),null,{default:v(()=>[g(p(l.title),1)]),_:2},1024),c(m(k),{"onUpdate:modelValue":[a=>l.dataHandler(a,l.id,e.title),t=>a.value[e.title].data[l.id]=t],modelValue:a.value[e.title].data[l.id],size:"large",slot:"end","enable-on-off-labels":!0},null,8,["onUpdate:modelValue","modelValue"])]),_:2},1024),null!==(r=a.value[e.title])&&void 0!==r&&r.statusMessage?(d(),A(m(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(p(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])):T("",!0),"input"===l.type?(d(),s("div",Z,[c(m(O),{"label-placement":"stacked",onIonChange:a=>l.dataHandler(a.detail.value,l.id,e.title),modelValue:a.value[e.title].data[l.id],"onUpdate:modelValue":t=>a.value[e.title].data[l.id]=t,style:{"margin-top":"20px"},label:l.title,fill:"outline",placeholder:"Enter value",slot:"end"},null,8,["onIonChange","modelValue","onUpdate:modelValue","label"]),null!==(o=a.value[e.title])&&void 0!==o&&o.statusMessage?(d(),A(m(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(p(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])):T("",!0),"clinic-days"===l.type?(d(),s("div",q,[c(m(P),{color:"light"},{default:v(()=>[c(m(V),null,{default:v(()=>[g(p(l.title),1)]),_:2},1024)]),_:2},1024),u("div",Q,[c(X,{modelValue:a.value[e.title].data[l.id],"onUpdate:modelValue":t=>a.value[e.title].data[l.id]=t,onChange:a=>l.dataHandler(a,l.id,e.title)},null,8,["modelValue","onUpdate:modelValue","onChange"]),null!==(y=a.value[e.title])&&void 0!==y&&y.statusMessage?(d(),A(m(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(p(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])])):T("",!0),"facility"===l.type?(d(),s("div",ee,[c(m(P),{color:"light"},{default:v(()=>{var t,i;return[c(m(V),null,{default:v(()=>[g(p(l.title),1)]),_:2},1024),g(" "+p(null!==(t=null===(i=a.value[e.title].data[l.id])||void 0===i?void 0:i.label)&&void 0!==t?t:a.value[e.title].data[l.id]),1)]}),_:2},1024),u("div",ae,[c(m($),{modelValue:a.value[e.title].data[l.id],"onUpdate:modelValue":[t=>a.value[e.title].data[l.id]=t,a=>l.dataHandler(a,l.id,e.title)],multiple:!1,taggable:!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select facility",placeholder:"Select target lab facility",selectLabel:"",label:"label",searchable:!0,loading:i.value,onSearchChange:n,"track-by":"label",options:t.value},null,8,["modelValue","onUpdate:modelValue","loading","options"]),null!==(_=a.value[e.title])&&void 0!==_&&_.statusMessage?(d(),A(m(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(p(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])])):T("",!0)])}),128))]),_:2},1024)):T("",!0)]}),_:2},1024)]),_:2},1024)])]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}))}}});
