import{dM as Ne,dN as Fe,d as te,r as I,w as A,a as ie,O as Y,f as g,u as e,bi as Me,J as r,l as a,I as xe,G as ve,E as Ee,Q as w,K as k,a_ as pe,N as V,L as F,a3 as Ae,a4 as ue,k as y,e as U,m as S,$ as T,p as b,b2 as ee,X as q,a1 as Pe,a0 as ge,bq as he,F as Z,P as ne,br as _e,bt as Be,M as be,c as ae,aS as Oe,aR as Te,dI as Re,aQ as $e,cl as De,cQ as Ve,d9 as ye,bv as qe,cz as Le,cy as ze,aP as je,dO as Ge,dP as He,dQ as Qe,dR as Je,dS as Ye,dT as Ke,dU as We,dV as Xe,ao as Ze,cj as J,U as Ue,a6 as re,bA as ea,dW as aa,a5 as Ie,d2 as ta,d3 as oe,cv as sa,a7 as la}from"./vendor-B45YKAfe.js";import{N as ra}from"./NavigationMenu-B-qSMMFe.js";import{E as oa}from"./EIRreportsStore-DG7Fzi5G.js";import{B as na}from"./bottomNavBar-_OrN8vBX.js";import{a8 as ia,av as Se,U as ke,aw as ua,J as da,H as ca,v as X,_ as de,ax as we}from"./index-HINYBbFK.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-T5qsywHO.js";function ma(){const C=()=>{const p="0123456789ABCDEF";let u="";for(let m=0;m<6;m++)u+=p[Math.floor(Math.random()*16)];return u};return{getAvatarUrl:(p,u=128)=>{const m="".concat(p),_=Ne(Fe,{seed:m,size:u,backgroundColor:[C()]}).toString(),E=unescape(encodeURIComponent(_));return"data:image/svg+xml;base64,".concat(btoa(E))}}}const fa=()=>{const C="programs",P=Se;async function p(m){const v=await P.getAll(C,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve programs.")}async function u(){const m=await ia.getAllPrograms(),v=[];return m.forEach(_=>{v.push({name:_.name,other:_,selected:!1})}),m}return{getPrograms:p,getEMRPrograms:u}},va=fa(),pa=()=>{const C="roles",P=Se;async function p(m){const v=await P.getAll(C,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve user roles.")}async function u(){return await ke.getAllRoles()}return{getUserRoles:p,getEMRUserRoles:u}},ga=pa(),ha={key:0,class:"error-message"},_a={key:1,class:"error-message"},ya={key:2,class:"error-message"},Ua={key:3,class:"error-message"},Ia={key:5,class:"error-message"},wa={key:0,class:"error-message"},Ca={style:{display:"flex",gap:"20px","margin-top":"8px"}},ba={key:6,class:"error-message"},Sa={key:7,class:"error-message"},ka={key:8,class:"error-message"},Na={class:"form_el"},Ce=36,Fa=te({__name:"UserFormModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["save","close"],setup(C,{emit:P}){const p=C,u=P,m=I(!1),v=I(null),_=I([]),E=I({}),M=I(),s=I({name:!1,firstName:!1,lastName:!1,password:!1,dateOfBirth:!1,gender:!1,roles:!1,programs:!1,usernameExists:!1}),n=I({name:"",firstName:"",lastName:"",password:"",gender:"",roles:[],programs:[]}),x=I([]),O=I([]);function L(o){const i=o.value.formattedDate;M.value=ca.toStandardHisFormat(i),s.value.dateOfBirth=!1}function B(){v.value?m.value=!1:m.value=!0}const z=o=>{v.value=o.selected_location,B()},R=()=>{n.value={name:"",firstName:"",lastName:"",password:"",dateOfBirth:"",gender:"",facility:null,roles:[],programs:[]},M.value=null,v.value=null,E.value={},m.value=!1,Object.keys(s.value).forEach(o=>{s.value[o]=!1})},$=()=>{var i;s.value.name=!1,s.value.firstName=!1,s.value.lastName=!1,s.value.password=!1,s.value.dateOfBirth=!1,s.value.gender=!1,s.value.roles=!1,s.value.programs=!1;let o=!0;return n.value.name.trim()||(s.value.name=!0,o=!1),n.value.firstName.trim()||(s.value.firstName=!0,o=!1),n.value.lastName.trim()||(s.value.lastName=!0,o=!1),!p.editingUser&&!((i=n.value.password)!=null&&i.trim())&&(s.value.password=!0,o=!1),M.value||(s.value.dateOfBirth=!0,o=!1),n.value.gender||(s.value.gender=!0,o=!1),n.value.roles.length||(s.value.roles=!0,o=!1),n.value.programs.length||(s.value.programs=!0,o=!1),o},D=()=>{if(!p.editingUser){const o=x.value.find(i=>i.program_id===Ce);o&&(n.value.programs=[o.name],s.value.programs=!1)}},K=async()=>{try{const f=(await va.getEMRPrograms()).filter(N=>N.program_id===Ce);x.value=f.map(N=>({program_id:N.program_id,name:N.name})),D()}catch(o){console.error("Failed to fetch programs:",o),X("Failed to load programs.")}},j=async()=>{try{const i=await ga.getUserRoles();O.value=i.map(f=>f.name)}catch(o){X("Failed to load roles.")}},G=async o=>{const i=p.editingUser?p.editingUser.name!==o:!0;if(!o.trim()||!i)return s.value.usernameExists=!1,!0;try{const N=(await ke.doesUsernameExist(o)).exists===!0;return s.value.usernameExists=N,!N}catch(f){return console.error("Error checking username existence:",f),X("Failed to verify username availability. Proceeding with caution."),s.value.usernameExists=!1,!0}};A(()=>n.value.name,async o=>{o.trim()?(s.value.name=!1,await G(o)):(s.value.name=!0,s.value.usernameExists=!1)}),A(()=>n.value.firstName,()=>{n.value.firstName.trim()&&(s.value.firstName=!1)}),A(()=>n.value.lastName,()=>{n.value.lastName.trim()&&(s.value.lastName=!1)}),A(()=>n.value.password,()=>{var o;(o=n.value.password)!=null&&o.trim()&&(s.value.password=!1)}),A(()=>n.value.gender,()=>{n.value.gender&&(s.value.gender=!1)}),A(()=>n.value.roles,()=>{n.value.roles.length>0&&(s.value.roles=!1)}),A(()=>n.value.programs,()=>{n.value.programs.length>0&&(s.value.programs=!1)}),A(()=>p.editingUser,o=>{if(o){const i=o.name.split(" "),f=i[0]||"",N=i.length>1?i.slice(1).join(" "):"";n.value={name:o.name,firstName:f,lastName:N,dateOfBirth:o.dateOfBirth||"",gender:o.gender||"",facility:o.facility||null,roles:o.roles,programs:o.programs},o.dateOfBirth&&(M.value=o.dateOfBirth),o.facility&&(v.value=o.facility,E.value=o.facility)}else R(),D()},{immediate:!0}),A(()=>p.isOpen,o=>{o&&!p.editingUser&&(R(),D())});const d=async()=>{const o=$();B();const i=await G(n.value.name);if(!o||m.value||!i){!o||m.value?X("Please fill out all required fields."):i||X("The chosen username is already taken.");return}const f=n.value.programs.map(W=>{const se=x.value.find(t=>t.name===W);return se?se.program_id:null}).filter(W=>W!==null),N={...n.value,dateOfBirth:M.value,facility:v.value,programIDs:f};u("save",N)},H=()=>{u("close")};return ie(()=>{R(),K(),j()}),(o,i)=>(g(),Y(e(Me),{"is-open":C.isOpen,onDidDismiss:H},{default:r(()=>[a(e(xe),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(Ee),null,{default:r(()=>[w(k(C.editingUser?"Edit User":"Add New User"),1)]),_:1}),a(e(pe),{slot:"end"},{default:r(()=>[a(e(V),{onClick:H,fill:"clear"},{default:r(()=>[a(e(F),{style:{"font-size":"35px"},icon:e(Ae)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ue),{class:"ion-padding"},{default:r(()=>[y("form",{id:"user-form",onSubmit:Be(d,["prevent"])},[a(e(T),{class:b({"error-item":s.value.name||s.value.usernameExists})},{default:r(()=>[a(e(ee),{modelValue:n.value.name,"onUpdate:modelValue":i[0]||(i[0]=f=>n.value.name=f),label:"Username","label-placement":"stacked",placeholder:"Enter username",required:"",class:b({"error-input":s.value.name||s.value.usernameExists})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.name?(g(),U("div",ha," Username is required ")):s.value.usernameExists?(g(),U("div",_a," This username is already taken. ")):S("",!0),a(e(T),{class:b({"error-item":s.value.firstName})},{default:r(()=>[a(e(ee),{modelValue:n.value.firstName,"onUpdate:modelValue":i[1]||(i[1]=f=>n.value.firstName=f),label:"First Name","label-placement":"stacked",placeholder:"Enter first name",required:"",class:b({"error-input":s.value.firstName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.firstName?(g(),U("div",ya," First name is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.lastName})},{default:r(()=>[a(e(ee),{modelValue:n.value.lastName,"onUpdate:modelValue":i[2]||(i[2]=f=>n.value.lastName=f),label:"Last Name","label-placement":"stacked",placeholder:"Enter last name",required:"",class:b({"error-input":s.value.lastName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.lastName?(g(),U("div",Ua," Last name is required ")):S("",!0),C.editingUser?S("",!0):(g(),Y(e(T),{key:4,class:b({"error-item":s.value.password})},{default:r(()=>[a(e(ee),{modelValue:n.value.password,"onUpdate:modelValue":i[3]||(i[3]=f=>n.value.password=f),label:"Password","label-placement":"stacked",placeholder:"Enter password",type:"password",required:"",class:b({"error-input":s.value.password})},null,8,["modelValue","class"])]),_:1},8,["class"])),s.value.password&&!C.editingUser?(g(),U("div",Ia," Password is required ")):S("",!0),y("div",{class:b(["form_el",{"error-section":s.value.dateOfBirth}])},[y("h6",{style:{"font-size":"16px","font-weight":"400"},class:b({"error-label":s.value.dateOfBirth})}," Date Of Birth ",2),a(ua,{place_holder:"Date Of Birth",onDateUpDated:L,date_prop:""}),s.value.dateOfBirth?(g(),U("div",wa," Date of birth is required ")):S("",!0)],2),a(e(T),{class:b({"error-item":s.value.gender})},{default:r(()=>[a(e(q),{position:"stacked",class:b({"error-label":s.value.gender})},{default:r(()=>[...i[7]||(i[7]=[w("Gender",-1)])]),_:1},8,["class"]),a(e(Pe),{modelValue:n.value.gender,"onUpdate:modelValue":i[4]||(i[4]=f=>n.value.gender=f)},{default:r(()=>[y("div",Ca,[a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"male"}),a(e(q),null,{default:r(()=>[...i[8]||(i[8]=[w("Male",-1)])]),_:1})]),_:1}),a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"female"}),a(e(q),null,{default:r(()=>[...i[9]||(i[9]=[w("Female",-1)])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["class"]),s.value.gender?(g(),U("div",ba," Gender is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.roles})},{default:r(()=>[a(e(he),{modelValue:n.value.roles,"onUpdate:modelValue":i[5]||(i[5]=f=>n.value.roles=f),label:"Roles","label-placement":"stacked",placeholder:"Select roles",multiple:"",class:b({"error-input":s.value.roles})},{default:r(()=>[(g(!0),U(Z,null,ne(O.value,f=>(g(),Y(e(_e),{key:f,value:f},{default:r(()=>[w(k(f),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.roles?(g(),U("div",Sa," At least one role is required ")):S("",!0),a(e(T),{class:b({"error-item":s.value.programs})},{default:r(()=>[a(e(he),{modelValue:n.value.programs,"onUpdate:modelValue":i[6]||(i[6]=f=>n.value.programs=f),label:"Programs","label-placement":"stacked",placeholder:"Select programs",multiple:"",class:b({"error-input":s.value.programs})},{default:r(()=>[(g(!0),U(Z,null,ne(x.value,f=>(g(),Y(e(_e),{key:f.id,value:f.name},{default:r(()=>[w(k(f.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.programs?(g(),U("div",ka," At least one program is required ")):S("",!0),y("div",Na,[i[10]||(i[10]=y("h6",{style:{"font-size":"16px","font-weight":"400"}},"Facility",-1)),a(da,{show_error:m.value,onFacilitySelected:z,selected_district_ids:_.value,selected_location:E.value},null,8,["show_error","selected_district_ids","selected_location"])])],32)]),_:1}),a(e(be),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(pe),{slot:"end"},{default:r(()=>[y("div",null,[a(e(V),{onClick:H,fill:"solid"},{default:r(()=>[...i[11]||(i[11]=[w(" Cancel ",-1)])]),_:1}),a(e(V),{onClick:d,fill:"solid",style:{"margin-left":"10px","margin-right":"10px"}},{default:r(()=>[w(k(C.editingUser?"Update":"Create")+" User ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]))}}),Ma=de(Fa,[["__scopeId","data-v-1e565356"]]),xa={class:"users-grid"},Ea={class:"user-header"},Aa=["src","alt"],Pa={class:"user-info"},Ba={key:0,class:"user-meta"},Oa={key:0,class:"meta-item"},Ta={key:1,class:"meta-item"},Ra={class:"user-details"},$a={key:0,class:"detail-item"},Da={key:1,class:"detail-item"},Va={key:2,class:"detail-item"},qa={class:"detail-item"},La={class:"detail-item"},za={class:"action-buttons"},ja={key:0,class:"empty-state"},Ga=te({__name:"miUsersTemplate",props:{initialSearchTerm:{default:""},initialStatusFilter:{default:"all"},initialItemsPerPage:{default:6},enableSearch:{type:Boolean,default:!0},enableStatusFilter:{type:Boolean,default:!0},enablePagination:{type:Boolean,default:!0},searchPlaceholder:{default:"Search users..."},searchDebounceTime:{default:300}},emits:["search-changed","status-filter-changed","users-filtered","user-edited","user-deleted","user-status-changed","user-created"],setup(C,{expose:P,emit:p}){const u=C,m=p,v=I([]),_=I(u.initialSearchTerm),E=I(u.initialStatusFilter),M=I(1),s=I(u.initialItemsPerPage),n=I(!1),x=I(null);let O=null;const L=t=>{var l,h,Q,ce,me,fe;const{getAvatarUrl:c}=ma();return{id:t.id,name:t.username,email:t.username,dateOfBirth:(l=t.profile)==null?void 0:l.dateOfBirth,gender:(h=t.profile)==null?void 0:h.gender,facility:(ce=(Q=t.facilities)==null?void 0:Q[0])!=null&&ce.facility?{name:t.facilities[0].facility.facility_name,code:t.facilities[0].facility.facility_code}:null,roles:((me=t.roles)==null?void 0:me.map(le=>le.role.name))||[],programs:((fe=t.programs)==null?void 0:fe.map(le=>le.program.name))||[],status:"active",avatar:c(t.username),createdAt:new Date(t.createdAt),lastActive:new Date(t.updatedAt)}},B=ae(()=>{let t=v.value;if(u.enableSearch&&_.value){const c=_.value.toLowerCase();t=t.filter(l=>l.name.toLowerCase().includes(c)||l.email.toLowerCase().includes(c)||l.roles&&l.roles.some(h=>h.toLowerCase().includes(c))||l.programs&&l.programs.some(h=>h.toLowerCase().includes(c))||l.gender&&l.gender.toLowerCase().includes(c)||l.facility&&l.facility.name&&l.facility.name.toLowerCase().includes(c))}return u.enableStatusFilter&&E.value!=="all"&&(t=t.filter(c=>c.status===E.value)),t}),z=ae(()=>{if(!u.enablePagination)return B.value;const t=(M.value-1)*s.value,c=t+s.value;return B.value.slice(t,c)});A(()=>_.value,t=>{O&&clearTimeout(O),O=setTimeout(()=>{m("search-changed",t),M.value=1},u.searchDebounceTime)},{immediate:!1}),A(()=>E.value,t=>{m("status-filter-changed",t),M.value=1},{immediate:!1}),A(()=>B.value,t=>{m("users-filtered",t)},{deep:!0,immediate:!0});const R=t=>{M.value=t.page,s.value=t.itemsPerPage},$=t=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t),D=t=>{const c=new Date,l=new Date(t);let h=c.getFullYear()-l.getFullYear();const Q=c.getMonth()-l.getMonth();return(Q<0||Q===0&&c.getDate()<l.getDate())&&h--,h},K=t=>{x.value=t,n.value=!0},j=()=>{n.value=!1,x.value=null},G=async t=>{try{if(x.value){const c=v.value.findIndex(h=>h.id===x.value.id);if(c!==-1){const h={...v.value[c],...t};v.value[c]=h,m("user-edited",h)}(await J.create({message:"User updated successfully",duration:2e3,color:"success"})).present()}else{const c=await d(t),l=await we.register(c),h=L(l);h&&(v.value.push(h),m("user-created",h),(await J.create({message:"User created successfully",duration:2e3,color:"success"})).present())}j()}catch(c){(await J.create({message:"Error saving user: ".concat(c),duration:2e3,color:"danger"})).present()}},d=async t=>{if(!t||!t.facility)throw new Error("Invalid user data. 'facility' is required.");return{username:t.name,password:t.password,roles:t.roles,programs:t.programs,programIds:t.programIDs,facilities:[t.facility.code],profile:{firstName:t.firstName,lastName:t.lastName,gender:t.gender,dateOfBirth:"1990-01-01T00:00:00.000Z"}}},H=async t=>{(await Ue.create({header:"Confirm Status Change",message:"Are you sure you want to ".concat(t.status==="active"?"deactivate":"activate"," ").concat(t.name,"?"),buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:()=>{t.status=t.status==="active"?"inactive":"active",m("user-status-changed",t),J.create({message:"User ".concat(t.status==="active"?"activated":"deactivated"," successfully"),duration:2e3,color:"success"}).then(l=>l.present())}}]})).present()},o=async t=>{(await Ue.create({header:"Confirm Delete",message:"Are you sure you want to delete ".concat(t.name,"? This action cannot be undone."),buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{const l=v.value.findIndex(h=>h.id===t.id);l!==-1&&(v.value.splice(l,1),m("user-deleted",t.id),J.create({message:"User deleted successfully",duration:2e3,color:"success"}).then(h=>h.present()))}}]})).present()},i=t=>{_.value=t},f=t=>{E.value=t},N=async()=>{try{const t=await we.getUsers();v.value=t.map(L)}catch(t){console.error("Failed to fetch MIUM users:",t),J.create({message:"Failed to load users.",duration:2e3,color:"danger"}).then(c=>c.present())}},W=()=>{x.value=null,n.value=!0};return ie(async()=>{await N()}),P({setSearchTerm:i,setStatusFilter:f,refreshUsers:N,cleanup:()=>{O&&clearTimeout(O)},openAddUserModal:W,users:v.value,filteredUsers:B,paginatedUsers:z}),(t,c)=>(g(),U(Z,null,[a(e(ue),{class:"ion-padding",style:{height:"80vh"}},{default:r(()=>[y("div",xa,[(g(!0),U(Z,null,ne(z.value,l=>(g(),Y(e(Oe),{key:l.id,class:"user-card"},{default:r(()=>[a(e(Te),null,{default:r(()=>[y("div",Ea,[a(e(Re),null,{default:r(()=>[y("img",{src:l.avatar,alt:l.name},null,8,Aa)]),_:2},1024),y("div",Pa,[a(e($e),null,{default:r(()=>[w(k(l.name),1)]),_:2},1024),a(e(De),null,{default:r(()=>[w(k(l.email),1)]),_:2},1024),l.gender||l.dateOfBirth?(g(),U("div",Ba,[l.gender?(g(),U("span",Oa,[a(e(F),{icon:e(Ve),class:"meta-icon"},null,8,["icon"]),w(" "+k(l.gender),1)])):S("",!0),l.dateOfBirth?(g(),U("span",Ta,[a(e(F),{icon:e(ye),class:"meta-icon"},null,8,["icon"]),w(" "+k(D(l.dateOfBirth))+" years old ",1)])):S("",!0)])):S("",!0)]),a(e(qe),{color:l.status==="active"?"success":"medium",class:"status-chip"},{default:r(()=>[a(e(F),{icon:l.status==="active"?e(Le):e(ze),slot:"start"},null,8,["icon"]),a(e(q),null,{default:r(()=>[w(k(l.status),1)]),_:2},1024)]),_:2},1032,["color"])])]),_:2},1024),a(e(je),null,{default:r(()=>[y("div",Ra,[l.roles&&l.roles.length?(g(),U("div",$a,[a(e(F),{icon:e(Ge),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.roles.join(", ")),1)])):S("",!0),l.programs&&l.programs.length?(g(),U("div",Da,[a(e(F),{icon:e(He),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.programs.join(", ")),1)])):S("",!0),l.facility?(g(),U("div",Va,[a(e(F),{icon:e(Qe),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.facility.name||"Assigned Facility"),1)])):S("",!0),y("div",qa,[a(e(F),{icon:e(ye),class:"detail-icon"},null,8,["icon"]),y("span",null,"Joined "+k($(l.createdAt)),1)]),y("div",La,[a(e(F),{icon:e(Je),class:"detail-icon"},null,8,["icon"]),y("span",null,"Last active "+k($(l.lastActive)),1)])]),y("div",za,[a(e(V),{onClick:h=>K(l),fill:"outline",size:"small",color:"primary"},{default:r(()=>[a(e(F),{icon:e(Ye),slot:"start"},null,8,["icon"]),c[0]||(c[0]=w(" Edit ",-1))]),_:1},8,["onClick"]),a(e(V),{onClick:h=>H(l),fill:"outline",size:"small",color:l.status==="active"?"warning":"success"},{default:r(()=>[a(e(F),{icon:l.status==="active"?e(Ke):e(We),slot:"start"},null,8,["icon"]),w(" "+k(l.status==="active"?"Deactivate":"Activate"),1)]),_:2},1032,["onClick","color"]),a(e(V),{onClick:h=>o(l),fill:"outline",size:"small",color:"danger"},{default:r(()=>[a(e(F),{icon:e(Xe),slot:"start"},null,8,["icon"]),c[1]||(c[1]=w(" Delete ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),B.value.length===0?(g(),U("div",ja,[a(e(F),{icon:e(Ze),class:"empty-icon"},null,8,["icon"]),c[2]||(c[2]=y("h3",null,"No users found",-1)),c[3]||(c[3]=y("p",null,"Try adjusting your search or filter criteria",-1))])):S("",!0)]),_:1}),a(e(be),null,{default:r(()=>[a(na,{"total-items":B.value.length,"current-page":M.value,"items-per-page":s.value,"onUpdate:pagination":R},null,8,["total-items","current-page","items-per-page"])]),_:1}),a(Ma,{"is-open":n.value,"editing-user":x.value,onSave:G,onClose:j},null,8,["is-open","editing-user"])],64))}}),Ha=de(Ga,[["__scopeId","data-v-8f4430d8"]]),Qa=te({__name:"UserNav",props:{searchTerm:{type:String,required:!0},statusFilter:{type:String,required:!0}},emits:["update:searchTerm","update:statusFilter","openAddUserModal"],setup(C,{emit:P}){return(p,u)=>(g(),U(Z,null,[a(e(Ie),{class:"ion-align-items-center"},{default:r(()=>[a(e(re),{size:"8"},{default:r(()=>[a(e(ea),{value:C.searchTerm,onIonInput:u[0]||(u[0]=m=>p.$emit("update:searchTerm",m.detail.value)),placeholder:"Search users...","show-clear-button":"focus",debounce:"300"},null,8,["value"])]),_:1}),a(e(re),{size:"4",class:"ion-text-right"},{default:r(()=>[a(e(V),{onClick:u[1]||(u[1]=m=>p.$emit("openAddUserModal")),fill:"solid"},{default:r(()=>[a(e(F),{icon:e(aa),slot:"start"},null,8,["icon"]),u[3]||(u[3]=w(" Add User ",-1))]),_:1})]),_:1})]),_:1}),a(e(Ie),{class:"ion-padding-start ion-padding-end"},{default:r(()=>[a(e(re),{size:"12"},{default:r(()=>[a(e(ta),{value:C.statusFilter,onIonChange:u[2]||(u[2]=m=>p.$emit("update:statusFilter",m.detail.value))},{default:r(()=>[a(e(oe),{value:"all"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[4]||(u[4]=[w("All",-1)])]),_:1})]),_:1}),a(e(oe),{value:"active"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[5]||(u[5]=[w("Active",-1)])]),_:1})]),_:1}),a(e(oe),{value:"inactive"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[6]||(u[6]=[w("Inactive",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})],64))}}),Ja={class:"sticky-user-nav"},Ya=te({__name:"miusers",setup(C,{expose:P}){const p=I(""),u=I("all"),m=I([]),v=I(0),_=I();ae(()=>p.value),ae(()=>u.value);const E=d=>{p.value=d,console.log("Search term updated:",d)},M=d=>{u.value=d,console.log("Status filter updated:",d)},s=d=>{p.value!==d&&(p.value=d),console.log("Internal search changed:",d)},n=d=>{u.value!==d&&(u.value=d),console.log("Internal filter changed:",d)},x=d=>{v.value=d.length},O=d=>{console.log("User created:",d)},L=d=>{console.log("User edited:",d)},B=d=>{console.log("User deleted:",d)},z=d=>{console.log("User status changed:",d)},R=()=>{_.value?_.value.openAddUserModal():console.log("usersTemplateRef is not yet available.")},$=async()=>{try{console.log("Loading users...")}catch(d){console.error("Error loading users:",d)}},D=async()=>{oa().setNavigationPayload("Manage Integrated Users",!0,!1,"/","home","")},K=()=>{_.value&&_.value.refreshUsers(),$()},j=d=>{p.value=d,_.value&&_.value.setSearchTerm(d)},G=d=>{u.value=d,_.value&&_.value.setStatusFilter(d)};return ie(async()=>{await D(),await $()}),sa(()=>{_.value&&typeof _.value.cleanup=="function"&&_.value.cleanup()}),P({refreshUsers:K,setSearch:j,setFilter:G,searchTerm:p,statusFilter:u,usersList:m,filteredUsersCount:v}),(d,H)=>(g(),Y(e(la),null,{default:r(()=>[a(ra),a(e(ue),{fullscreen:!0},{default:r(()=>[y("div",Ja,[a(Qa,{fullscreen:!0,searchTerm:p.value,statusFilter:u.value,"onUpdate:searchTerm":E,"onUpdate:statusFilter":M,onOpenAddUserModal:R},null,8,["searchTerm","statusFilter"])]),a(Ha,{ref_key:"usersTemplateRef",ref:_,"initial-users":m.value,"initial-search-term":p.value,"initial-status-filter":u.value,"search-debounce-time":500,"enable-search":!0,"enable-status-filter":!0,"enable-pagination":!0,onSearchChanged:s,onStatusFilterChanged:n,onUsersFiltered:x,onUserCreated:O,onUserEdited:L,onUserDeleted:B,onUserStatusChanged:z},null,8,["initial-users","initial-search-term","initial-status-filter"])]),_:1})]),_:1}))}}),st=de(Ya,[["__scopeId","data-v-5071b8a1"]]);export{st as default};
