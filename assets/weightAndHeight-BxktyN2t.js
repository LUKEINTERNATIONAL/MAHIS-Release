import{D as bt,d as V,af as $,a2 as ot,G as L,E as O,ag as rt,ab as U,a1 as A,I as W,a8 as F,Q as B,aj as yt,_ as Dt,$ as Ct,H as r,e as y,m as I,f as v,k as a,N,P as _,K as S,l as s,J as i,a as wt,r as x,u as j,b1 as lt,b8 as kt,M as J,F as M,eI as It,ad as ct,ac as dt,O as Q,i as tt,v as et,a9 as K,aa as ut,be as St,ai as Vt,ah as $t,aP as Bt,cb as Nt,aQ as Ht,aO as Pt,aR as Tt,ae as ht,c0 as Mt,L as Ot,a0 as At,b7 as Wt,a7 as Ft}from"./vendor-Bn90Jqlj.js";import{l as w,j as mt,B as pt,aH as gt,M as D,u as z,H as C,_ as H,k as b,t as Z,$ as Rt,S as T,o as P,N as _t,s as Et,bi as st,K as k,bA as nt,cc as xt}from"./index-Cd9f91c4.js";import{l as R}from"./lodash-NJiRuGo9.js";import{B as vt}from"./BasicForm-Dvk3Ngdc.js";import{_ as X}from"./customDatePicker.vue_vue_type_style_index_0_lang-iBWO16D_.js";import{_ as Lt}from"./VitalsMixin.vue_vue_type_script_lang-B_gdpfD8.js";import{a as ft}from"./formatServerData-CP_AN2uK.js";import{i as Y,s as Ut,j as zt}from"./vaccines_service-DFhhOI_d.js";import{I as jt}from"./barcode-qrcode-reader-mL5STAt1.js";import{S as qt}from"./stock_service-DuYu8qsO.js";const it=[{data:{rowData:[{colData:[{inputHeader:"Systolic Pressure",unit:"mmHg",icon:w.systolicPressure,value:"",name:"Systolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsSystolic"},{inputHeader:"Diastolic pressure",unit:"mmHg",icon:w.diastolicPressure,value:"",name:"Diastolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsDiastolic"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"bp",index:""}],previousView:{name:"vitals"}},{data:{rowData:[{colData:[{inputHeader:"Temperature",unit:"C",icon:w.temprature,value:"",name:"Temperature",eventType:"input",validationFunctionName:"vitalsTemperature",valueType:"number"},{inputHeader:"Pulse rate",unit:"BMP",icon:w.pulse,value:"",name:"Pulse",eventType:"input",validationFunctionName:"vitalsPulseRate",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"temp",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"pulse",index:""}]},{data:{rowData:[{colData:[{inputHeader:"Respiratory rate",unit:"BMP",icon:w.respiratory,value:"",name:"Respiratory rate",eventType:"input",validationFunctionName:"vitalsRespiratoryRate",valueType:"number"},{inputHeader:"Oxygen saturation",unit:"%",icon:w.oxgenStaturation,value:"",name:"SAO2",eventType:"input",validationFunctionName:"vitalsOxygenSaturation",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"respiratory",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"oxygen",index:""}]}],q=bt("immunizationVitalsStore",{state:()=>({vitals:[...it]}),actions:{setVitals(t){this.vitals=t},getInitialVitals(){return[...R.cloneDeep(it)]}},persist:!0}),Gt=V({mixins:[Lt],components:{IonContent:F,IonHeader:W,IonItem:A,IonList:U,IonMenu:rt,IonTitle:O,IonToolbar:L,IonInput:ot,BasicInputField:pt,BasicForm:vt,PreviousVitals:mt,customDatePicker:X},data(){return{iconsContent:w,vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1,pulseRate:!1},showPD:!1,todays_date:C.sessionDate(),formOpen:!0}},computed:{...$(z,["patient"]),...$(q,["vitals"])},async serverPrefetch(){this.updateVitalsStores()},async mounted(){this.cleanVitalForm(),this.vitalsData=this.vitals,await this.setTodayVitals(),await this.validateRowData()},watch:{vitals:{handler(){this.vitalsData=this.vitals},deep:!0},$route:{handler(){this.cleanVitalForm(),this.vitalsData=this.vitals}}},setup(){return{checkmark:Ct,pulseOutline:Dt}},methods:{cleanVitalForm(){const t=q();t.setVitals(t.getInitialVitals())},navigationMenu(t){yt.close(),this.$router.push(t)},updateVitalsStores(){q().setVitals(this.vitals)},async validateRowData(){const t=D(this.vitals,"Height (cm)","value"),e=D(this.vitals,"Weight","value"),n=D(this.vitals,"Systolic","value"),l=D(this.vitals,"Diastolic","value"),d=D(this.vitals,"Temperature","value"),g=D(this.vitals,"Pulse","value"),o=D(this.vitals,"Respiratory rate","value"),c=D(this.vitals,"SAO2","value");await this.setBMI(t,e),await this.updateBP(n,l);const u=this.getPulseRateStatus(g);await this.updateRate("pulse",g," BMP",u,4);const f=this.getTemperatureStatus(d);this.updateRate("temp",d,"Â°C",f,4);const h=this.getRespiratoryRateStatus(o);this.updateRate("respiratory",o,"BMP",h,6);const m=this.getOxygenSaturationStatus(c);this.updateRate("oxygen",c,"%",m,6)},showCPD(){this.showPD=!0},closeForm(){this.formOpen=!1},async saveVitals(){var e;B.dismiss();const t=await ft(this.vitals);if(t.length>0){let n=(e=this.patient)==null?void 0:e.vitals;n.unsaved=[...n.unsaved,...t],await gt(this.patient)}}}}),Jt={key:0,class:"modal_wrapper"},Qt={class:"OtherVitalsHeading"},Kt={class:"TodaysDate"},Zt={class:""},Xt={class:"btnContent"},Yt={class:"saveBtn"};function te(t,e,n,l,d,g){const o=r("basic-form"),c=r("customDatePicker"),u=r("ion-icon"),f=r("ion-button");return t.formOpen?(v(),y("div",Jt,[a("div",Qt,[e[3]||(e[3]=a("div",{class:"OtherVitalsTitle"},"OTHER VITALS",-1)),a("div",Kt,[e[1]||(e[1]=_("Todays Date: ",-1)),e[2]||(e[2]=a("span",null,null,-1)),_(" "+S(t.todays_date),1)])]),a("div",Zt,[s(o,{contentData:t.vitals,"onUpdate:inputValue":e[0]||(e[0]=h=>t.validateRowData())},null,8,["contentData"])]),t.showPD?(v(),N(c,{key:0})):I("",!0),a("div",Xt,[a("div",Yt,[a("div",null,[s(f,{class:"btnText",fill:"solid",onClick:t.saveVitals},{default:i(()=>[e[4]||(e[4]=_(" Done today ",-1)),s(u,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=a("div",null,null,-1)),a("div",null,[s(f,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:i(()=>[e[5]||(e[5]=_(" Done earlier ",-1)),s(u,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])])])):I("",!0)}const Je=H(Gt,[["render",te],["__scopeId","data-v-d7374316"]]),ee={class:"flex flex-col items-center justify-center mt-6"},se={class:"phone mt-6"},ne={class:"content"},ie={class:"overlay"},ae={style:{"margin-top":"20px"}},oe=V({__name:"QRCodeReader",emits:["scanresult"],setup(t,{emit:e}){wt(async()=>{c()});const n=x(void 0),l=x(!1);function d(m){n.value=m,n.value!=null&&(b().setTempScannedBatchNumber(n.value),h(n.value))}function g(m){l.value=m}const o=x(null);function c(){var m;(m=o.value)==null||m.onCanPlay()}function u(){B.dismiss()}const f=e;function h(m){f("scanresult",m),u()}return(m,p)=>(v(),y(M,null,[a("div",ee,[a("div",se,[s(j(lt),null,{default:i(()=>[_(S(n.value),1)]),_:1}),a("div",ne,[a("div",ie,[s(j(jt),{ref_key:"refCamera",ref:o,capture:"shoot","show-on-stream":"",onOnloading:g,onResult:d},null,512),p[0]||(p[0]=kt('<div class="focus-frame"></div><div class="dark-overlay top"></div><div class="dark-overlay bottom"></div><div class="dark-overlay left"></div><div class="dark-overlay right"></div>',5))])])])]),a("div",ae,[s(j(J),{onClick:u,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"99%"}},{default:i(()=>p[1]||(p[1]=[_(" Cancel ",-1)])),_:1,__:[1]})])],64))}}),re=V({name:"MyComponent",components:{IonAlert:It},data(){return{isOpen:!1,alertButtons:[{text:"Close",role:"cancel",cssClass:"alert-danger-button"}],messageContent:"No available batches/lot numbers"}},methods:{setOpen(t){this.isOpen=t},handleDismiss(){this.setOpen(!1),this.$emit("alertClosed"),this.dismiss()},dismiss(){B.dismiss()}},mounted(){this.setOpen(!0)}});function le(t,e,n,l,d,g){const o=r("ion-alert");return v(),N(o,{"is-open":t.isOpen,header:"Please update stock","sub-header":"",message:t.messageContent,buttons:t.alertButtons,"css-class":"my-custom-alert",onDidDismiss:t.handleDismiss},null,8,["is-open","message","buttons","onDidDismiss"])}const G=H(re,[["render",le],["__scopeId","data-v-cf655518"]]),ce=V({components:{IonRadioGroup:dt,IonRadio:ct,IonItem:A,IonList:U},props:{action:{type:Function,required:!0},retro:{type:Boolean,required:!0}},async mounted(){this.loadCurrentSelectedDrug()},watch:{retro:{handler(){this.checkToShow()},deep:!0}},data(){return{lotNumbers:[],selectedOption:{}}},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},checkIfSelected(){return R.has(this.selectedOption,"lotNumber")||this.checkDrugNameInt()==!0?!0:(Z("Select a batch number!"),!1)},performAction(){this.checkIfSelected()==!0&&this.$emit("actionTriggered",this.selectedOption)},async loadCurrentSelectedDrug(){try{const e=b().getCurrentSelectedDrug();await this.formBatchList(e.drug.drug_id)}catch(t){}},async formBatchList(t){try{const n=b().getLotNumberData();n.length==0&&this.$emit("emptyList",""),n.forEach(l=>{const d={id:l.id,lotNumber:l.batch_number};this.lotNumbers.push(d)}),this.checkToShow()}catch(e){}},addUnkownLotNumberOption(){const e=b().getCurrentSelectedDrug();this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"})},checkToShow(){this.$props.retro==!0&&this.addUnkownLotNumberOption(),this.checkDrugNameInt()},checkDrugNameInt(){const e=b().getCurrentSelectedDrug();return Y(e.drug)==!0?(this.lotNumbers=[],this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"}),!0):!1}}});function de(t,e,n,l,d,g){const o=r("ion-radio"),c=r("ion-item"),u=r("ion-radio-group"),f=r("ion-list"),h=r("ion-card"),m=r("ion-row");return v(),N(m,null,{default:i(()=>[s(h,{class:"shadowless-card",style:{width:"100%",padding:"0"}},{default:i(()=>[s(f,null,{default:i(()=>[s(u,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=p=>t.handleChange(p)),value:"start"},{default:i(()=>[(v(!0),y(M,null,Q(t.lotNumbers,p=>(v(),N(c,{key:p.id},{default:i(()=>[s(o,{value:p},{default:i(()=>[_(S(p.lotNumber),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1},8,["compareWith"])]),_:1})]),_:1})]),_:1})}const ue=H(ce,[["render",de],["__scopeId","data-v-039b66ba"]]),he=V({components:{IonContent:F,IonHeader:W,IonItem:A,IonList:U,IonMenu:rt,IonTitle:O,IonToolbar:L,IonInput:ot,BasicInputField:pt,PreviousVitals:mt,customDatePicker:X,lotNumberList:ue,alert:G},data(){return{iconsContent:w,showPD:!1,showDateBtns:!0,vaccineDate:"",batchNumber:"",drugName:"",currentDrug:"",is_batch_number_valid:!1,batch_number_error_message:"Enter a valid batch number",full_name:"",sessionDate:C.toStandardHisDisplayFormat(T.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{P(oe,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},selected_date_:"",is_a_vaccine:!0}},computed:{...$(b,["tempScannedBatchNumber"]),...$(z,["patient"])},setup(){const t=x(null);return{childComponentRef:t,triggerChildAction:()=>{t.value&&t.value.performAction()}}},async mounted(){this.loadCurrentSelectedDrug(),this.displayUserNames();const t=b();this.showPD=t.isVaccinePassed(),this.showDateBtns=!this.showPD},props:{customSchedule:{type:[],default:[]}},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}}},methods:{loadCurrentSelectedDrug(){const t=b();this.currentDrug=t.getCurrentSelectedDrug(),this.drugName=this.currentDrug.drug.drug_name,this.batchNumber=this.currentDrug.drug.vaccine_batch_number?this.currentDrug.drug.vaccine_batch_number:"",Y(this.currentDrug.drug)==!0&&(this.is_a_vaccine=!1,this.batchNumber="unknown")},showCPD(){this.showPD=!0,this.showDateBtns=!1},dismiss(){B.dismiss()},updateDate(t){this.vaccineDate=C.toStandardHisFormat(t)},saveBatchWithTodayDate(){let t=T.getSessionDate();this.saveDta(t)},saveBatch(){let t;R.isEmpty(this.vaccineDate)==!0?t=T.getSessionDate():t=this.vaccineDate,this.saveDta(t)},updateBatchNumber(t){var n;const e=t.target.value;this.batchNumber=e||((n=this.tempScannedBatchNumber)==null?void 0:n.text)||""},async ActionTriggered(t){const e={batch_number:t.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrug.drug.drug_id,drug_:this.currentDrug},n=b();n.setAdministeredVaccine(e),await Ut(this.patient),n.setTempScannedBatchNumber(null),this.dismiss()},saveDta(t){this.selected_date_=t,this.triggerChildAction()},isAlphaNumeric(t){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(t)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(t){this.batchNumber=t},displayUserNames(){const e=Rt().getUser(),n=e.person.names[0].given_name,l=e.person.names[0].family_name;this.full_name=n+" "+l},childAction(){},ShowAlert(){}}}),me={class:"modal_wrapper"},pe={class:"lbl-ct"},ge={class:"client_admi"},_e={class:"client_admin_sub_x"},ve={class:"btnContent"},fe={key:0,class:"saveBtn"},be={key:1,class:"saveBtn"};function ye(t,e,n,l,d,g){const o=r("ion-col"),c=r("ion-label"),u=r("ion-row"),f=r("lotNumberList"),h=r("customDatePicker"),m=r("ion-icon"),p=r("ion-button");return v(),y("div",me,[s(u,{style:{"margin-top":"10px"}},{default:i(()=>[s(o,{style:{"margin-left":"-3px"}},{default:i(()=>e[0]||(e[0]=[a("div",{class:"om"},"Administer Vaccine",-1)])),_:1,__:[0]}),s(o,{size:"6",style:{"text-align":"right"}},{default:i(()=>[s(c,{class:"lbl-tl",style:{"font-size":"13"}},{default:i(()=>[e[1]||(e[1]=_(" Todays Date: ",-1)),a("span",pe,S(t.sessionDate),1)]),_:1,__:[1]})]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(c,{style:{"font-weight":"600px","font-size":"20px",margin:"10px","margin-left":"0px"}},{default:i(()=>[_(S(t.drugName),1)]),_:1})]),_:1}),tt(s(u,null,{default:i(()=>[s(c,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:i(()=>e[2]||(e[2]=[_("Select Batch number",-1),a("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[2]})]),_:1},512),[[et,t.is_a_vaccine]]),tt(a("div",null,[s(f,{action:t.childAction,retro:t.showPD,ref:"childComponentRef",onActionTriggered:t.ActionTriggered,onEmptyList:t.ShowAlert},null,8,["action","retro","onActionTriggered","onEmptyList"])],512),[[et,t.is_a_vaccine]]),a("div",ge,[e[3]||(e[3]=a("span",{class:"client_admi_sub"},"Vaccination done by: ",-1)),a("span",_e,S(t.full_name),1)]),t.showPD?(v(),N(h,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):I("",!0),a("div",ve,[t.showDateBtns?(v(),y("div",fe,[a("div",null,[s(p,{onClick:t.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:i(()=>[e[4]||(e[4]=_(" Done today ",-1)),s(m,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=a("div",{style:{"margin-bottom":"20px"}},null,-1)),a("div",null,[s(p,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:i(()=>[e[5]||(e[5]=_(" Done earlier ",-1)),s(m,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])):I("",!0),t.showDateBtns?I("",!0):(v(),y("div",be,[s(u,{"justify-content-between":""},{default:i(()=>[s(o,{size:"auto"},{default:i(()=>[s(p,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>e[7]||(e[7]=[_(" Cancel ",-1)])),_:1,__:[7]},8,["onClick"])]),_:1}),s(o,{size:"auto",class:"ion-text-end",style:{"margin-left":"auto"}},{default:i(()=>[s(p,{onClick:t.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>e[8]||(e[8]=[_(" Save ",-1)])),_:1,__:[8]},8,["onClick"])]),_:1})]),_:1})]))])])}const at=H(he,[["render",ye],["__scopeId","data-v-58aa351e"]]),De=V({components:{IonRow:K,IonItem:A,IonList:U,IonRadio:ct,IonRadioGroup:dt},data(){return{reasons:[{id:1,name:"Mistake/ Wrong Entry",type:"Mistake/ Wrong Entry"},{id:2,name:"Duplicate",type:"Duplicate"},{id:3,name:"System Error",type:"System Error"}],selectedOption:{}}},computed:{...$(z,["patient"])},async mounted(){},props:{},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},dismiss(){try{B.dismiss()}catch(t){}},checkIfSelected(){return R.has(this.selectedOption,"name")==!0?!0:(Z("Select a reason!"),!1)},async voidVaccine1(){if(this.checkIfSelected()==!0)try{const t=b(),e=t.getVaccineToBeVoided();await zt(this.patient,e,this.selectedOption.name),_t("Vaccine was successfully voided!"),t.setVaccineReload(!t.getVaccineReload()),B.dismiss({voided:!0})}catch(t){}}}}),Ce={class:"saveBtn"};function we(t,e,n,l,d,g){const o=r("ion-row"),c=r("ion-radio"),u=r("ion-item"),f=r("ion-radio-group"),h=r("ion-list"),m=r("ion-button"),p=r("ion-col");return v(),y(M,null,[s(o,{class:"centered-content"},{default:i(()=>e[1]||(e[1]=[a("div",{class:"text-container"},[a("div",null,"Do you want to void this vaccine?"),a("div",null,"Please specify reason for voiding this administered vaccine?")],-1)])),_:1,__:[1]}),s(o,null,{default:i(()=>[s(h,{style:{width:"100%"}},{default:i(()=>[s(f,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=E=>t.handleChange(E)),value:"start"},{default:i(()=>[(v(!0),y(M,null,Q(t.reasons,E=>(v(),N(u,null,{default:i(()=>[s(c,{value:E},{default:i(()=>[_(S(E.name),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1},8,["compareWith"])]),_:1})]),_:1}),a("div",Ce,[s(o,{class:"ion-justify-content-between"},{default:i(()=>[s(p,{size:"auto"},{default:i(()=>[s(m,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>e[2]||(e[2]=[_(" Cancel ",-1)])),_:1,__:[2]},8,["onClick"])]),_:1}),s(p,{size:"auto"},{default:i(()=>[s(m,{onClick:t.voidVaccine1,class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>e[3]||(e[3]=[_(" Void ",-1)])),_:1,__:[3]},8,["onClick"])]),_:1})]),_:1})])],64)}const ke=H(De,[["render",we],["__scopeId","data-v-ea212a62"]]),Ie=V({name:"Home",components:{IonContent:F,IonHeader:W,IonMenuButton:Mt,IonPage:ht,IonTitle:O,IonToolbar:L,IonButton:J,IonCard:Tt,IonCardContent:Pt,IonCardHeader:Ht,IonCardSubtitle:Nt,IonCardTitle:Bt,IonAccordion:$t,IonAccordionGroup:Vt,IonItem:A,IonLabel:lt,IonModal:St,IonCol:ut,IonRow:K,alert:G},data(){return{iconsContent:w,fowardData:{}}},computed:{},created(){},mounted(){},props:{vaccines:{type:{},default:{}},milestone_status:{type:String,default:0}},watch:{},setup(){let t=!1;return{isModalOpening:t,cleanupModal:()=>{t=!1;const n=document.querySelector(".pr_o");n&&n.remove()}}},methods:{covertToDate(t){return C.toStandardHisDisplayFormat(t)},getColorForVaccine(t){if(t.status=="administered")return"success";if(t.status!="administered")return this.milestone_status=="upcoming"?"medium":this.milestone_status=="current"?"success":"danger"},getInjectSignForVaccine(t){if(t.status=="administered")return this.iconsContent.greenInjection;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.fadedGreenIjection},getCheckBoxForVaccine(t){if(t.status=="administered")return this.iconsContent.improvedGreenTick;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.whiteCheckbox},async openAdministerVaccineModal(t){const e=document.querySelector(".pr_o");if(this.isModalOpening||e){console.log("Modal already open or opening, current state:",{isModalOpening:this.isModalOpening,modalExists:!!e});return}try{this.isModalOpening=!0;const n=b();n.setCurrentSelectedDrug(t);const l=new qt,d=await Et("stock",{whereClause:{drug_id:t.drug_id}});n.setLotNumberData(d),this.checkIfAdminstredAndAskToVoid()||(d.length===0?Y(t)?P(at,{class:"otherVitalsModal pr_o"}):P(G,{class:"otherVitalsModal pr_o"}):P(at,{class:"otherVitalsModal pr_o"}))}catch(n){throw console.error("Error opening modal:",n),n}finally{this.isModalOpening=!1,console.log("Modal open process completed")}},disableVaccine(t){if(t.status!=null&&t.status=="administered")return!1;if(t.can_administer!=null&&t.can_administer==!1)return!0;if(t.can_administer!=null&&t.can_administer==!0)return!1},checkVaccineName(t){return t.replace(/Pentavalent/g,"Penta")},checkIfAdminstredAndAskToVoid(){const t=b(),e=t.getCurrentSelectedDrug();return e.drug.status=="administered"?(t.setVaccineToBeVoided(e),P(ke,{class:"otherVitalsModal"},!1),!0):!1}}}),Se={class:"vaccinesList"},Ve={class:"button-content"},$e={style:{"margin-top":"20px"}};function Be(t,e,n,l,d,g){const o=r("ion-icon"),c=r("ion-button"),u=r("ion-col"),f=r("ion-row");return v(),y("div",Se,[s(f,null,{default:i(()=>[s(u,null,{default:i(()=>[(v(!0),y(M,null,Q(t.vaccines,h=>(v(),N(c,{disabled:t.disableVaccine(h),class:"administerVac",key:h,onClick:m=>t.openAdministerVaccineModal(h),fill:"solid",color:t.getColorForVaccine(h),style:{background:"#ddeedd","border-radius":"8px",color:"#636363"}},{default:i(()=>[s(o,{slot:"start",icon:t.getInjectSignForVaccine(h)},null,8,["icon"]),a("div",Ve,[a("div",$e,S(t.checkVaccineName(h.drug_name)),1),a("div",null,S(t.covertToDate(h.date_administered)),1)]),s(o,{slot:"end",icon:t.getCheckBoxForVaccine(h)},null,8,["icon"])]),_:2},1032,["disabled","onClick","color"]))),128))]),_:1})]),_:1})])}const Ne=H(Ie,[["render",Be],["__scopeId","data-v-90bda1b0"]]),Qe=V({name:"Home",components:{IonIcon:At,IonButton:J,customVaccine:Ne,IonHeader:W,IonTitle:O,IonFooter:Ot,IonCol:ut,IonRow:K,IonContent:F},data(){return{iconsContent:w,vaccineHistory:[]}},setup(){return{closeCircleOutline:Ft,checkmarkOutline:Wt}},computed:{...$(b,["vaccineReload","vaccineSchedule"])},methods:{vaccinesGivenCount(t){const e=[];return t.antigens.forEach(n=>{n.status=="administered"&&e.push(n)}),e.length},dismiss(){B.dismiss()}}}),He=V({name:"Home",components:{IonContent:F,IonHeader:W,IonPage:ht,IonTitle:O,IonToolbar:L,BasicForm:vt,customDatePicker:X},data(){return{popoverOpen:!1,iconContent:w,event:null,BMI:"",showPD:!1,vitals_date:C.toStandardHisFormat(C.sessionDate()),formOpen:!0,checkUnderSixWeeks:!1,showDateBtns:!0}},computed:{...$(z,["patient"]),...$(xt,["vitalsWeightHeight"])},watch:{patient:{async handler(){this.checkAge()}}},mounted(){this.checkAge()},setup(){},methods:{checkAge(){var t,e,n,l;R.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=C.dateDiffInDays(C.sessionDate(),(l=(n=this.patient)==null?void 0:n.personInformation)==null?void 0:l.birthdate)<42,this.controlHeight())},nav(t){this.$router.push(t)},formatBirthdate(){var t,e;return C.getBirthdateAge((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},controlHeight(){this.checkUnderSixWeeks?(k(this.vitalsWeightHeight,"Height (cm)","inputHeader","Height"),k(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!0)):k(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!1)},async validaterowData(t){const e=T.getUserID(),n=new nt(this.patient.patientID,e),l=D(this.vitalsWeightHeight,"weight","value"),d=D(this.vitalsWeightHeight,"Height (cm)","value"),g=n.validator({inputHeader:"Height*",value:d}),o=n.validator({inputHeader:"Weight*",value:l});g&&d?k(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",g.flat(1/0)[0]):k(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",""),o&&l?k(this.vitalsWeightHeight,"weight","alertsErrorMassage",o.flat(1/0)[0]):k(this.vitalsWeightHeight,"weight","alertsErrorMassage",""),this.setBMI(l,d)},async saveVitals(){const t=T.getUserID(),e=new nt(this.patient.patientID,t),n=D(this.vitalsWeightHeight,"weight","value"),l=D(this.vitalsWeightHeight,"Height (cm)","value");let d=null;this.checkUnderSixWeeks||(d=e.validator({inputHeader:"Height*",value:l}));const g=e.validator({inputHeader:"Weight*",value:n}),o=await ft(this.vitalsWeightHeight);if(o.length>0&&g==null&&d==null){const c=JSON.parse(JSON.stringify(this.patient));let u=c==null?void 0:c.vitals;u.unsaved=[...u.unsaved,...o],await gt(c),_t("Vitals saved successful"),this.cleanInputFields()}else Z("Please complete the form")},cleanInputFields(){k(this.vitalsWeightHeight,"weight","value",""),k(this.vitalsWeightHeight,"Height (cm)","value",""),this.dismiss()},dismiss(){B.dismiss()},async setBMI(t,e){var n,l,d,g,o,c,u,f;(l=(n=this.patient)==null?void 0:n.personInformation)!=null&&l.gender&&((g=(d=this.patient)==null?void 0:d.personInformation)!=null&&g.birthdate)&&(this.BMI=await st.getBMI(parseInt(t),parseInt(e),(c=(o=this.patient)==null?void 0:o.personInformation)==null?void 0:c.gender,C.calculateAge((f=(u=this.patient)==null?void 0:u.personInformation)==null?void 0:f.birthdate,C.sessionDate()))),this.updateBMI()},async updateBMI(){var n,l,d,g,o,c;const t=(l=(n=this.BMI)==null?void 0:n.color)!=null?l:[],e=this.vitalsWeightHeight[0].alerts[0];e.icon=st.iconBMI(t),e.backgroundColor=t[0],e.textColor=t[1],e.index="BMI "+((g=(d=this.BMI)==null?void 0:d.index)!=null?g:""),e.value=(c=(o=this.BMI)==null?void 0:o.result)!=null?c:""},showCPD(){this.showPD=!0,this.showDateBtns=!1},updateDate(t){this.vitals_date=C.toStandardHisFormat(t)}}}),Pe={key:0,class:"pim-cls-1 modal_wrapper"},Te={class:"center text_12"},Me={class:"btnContent"},Oe={key:0,class:"saveBtn"},Ae={key:1,class:"saveBtn"};function We(t,e,n,l,d,g){const o=r("BasicForm"),c=r("ion-row"),u=r("customDatePicker"),f=r("ion-icon"),h=r("ion-button"),m=r("ion-col");return t.formOpen?(v(),y("div",Pe,[e[7]||(e[7]=a("div",{class:"OtherVitalsHeading"},[a("div",{class:"OtherVitalsTitle"},"Add Weight/Height")],-1)),a("div",null,[a("div",Te,[s(c,null,{default:i(()=>[s(o,{contentData:t.vitalsWeightHeight,"onUpdate:inputValue":e[0]||(e[0]=p=>t.validaterowData(p))},null,8,["contentData"])]),_:1})])]),t.showPD?(v(),N(u,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):I("",!0),a("div",Me,[t.showDateBtns?(v(),y("div",Oe,[a("div",null,[s(h,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=p=>t.saveVitals())},{default:i(()=>[e[3]||(e[3]=_(" Done today ",-1)),s(f,{slot:"end",size:"small",icon:t.iconContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[3]})]),a("div",null,[s(h,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:i(()=>[e[4]||(e[4]=_(" Done earlier ",-1)),s(f,{slot:"end",size:"small",icon:t.iconContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])])])):I("",!0),t.showDateBtns?I("",!0):(v(),y("div",Ae,[s(c,null,{default:i(()=>[s(m,null,{default:i(()=>[s(h,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>e[5]||(e[5]=[_(" Cancel ",-1)])),_:1,__:[5]},8,["onClick"])]),_:1}),s(m,null,{default:i(()=>[s(h,{onClick:e[2]||(e[2]=p=>t.saveVitals()),class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>e[6]||(e[6]=[_(" save ",-1)])),_:1,__:[6]})]),_:1})]),_:1})]))])])):I("",!0)}const Ke=H(He,[["render",We],["__scopeId","data-v-7b242731"]]);export{Je as O,Qe as _,G as a,oe as b,Ne as c,at as d,ue as l,Ke as w};
