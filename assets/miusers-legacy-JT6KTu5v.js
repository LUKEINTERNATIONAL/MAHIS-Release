System.register(["./vendor-legacy-D91hwdTu.js","./NavigationMenu-legacy-BACdH27t.js","./EIRreportsStore-legacy-BF2Be4sz.js","./bottomNavBar-legacy-CjdFkeaJ.js","./index-legacy-BLtlT-se.js","./lodash-legacy-C-x9g9Na.js","./apexcharts-legacy-CtmrvmGp.js"],(function(e,a){"use strict";var l,t,s,r,i,n,o,u,d,c,m,v,p,f,g,h,y,x,_,w,b,U,k,N,F,C,S,E,A,B,O,T,D,I,V,P,M,z,q,j,R,$,L,G,Y,W,H,J,Q,Z,K,X,ee,ae,le,te,se,re,ie,ne,oe,ue,de,ce,me,ve,pe,fe,ge,he,ye,xe,_e,we,be,Ue,ke,Ne,Fe,Ce;return{setters:[e=>{l=e.dR,t=e.dS,s=e.d,r=e.r,i=e.w,n=e.a,o=e.O,u=e.f,d=e.u,c=e.bi,m=e.J,v=e.l,p=e.I,f=e.G,g=e.E,h=e.Q,y=e.K,x=e.a_,_=e.N,w=e.L,b=e.a2,U=e.a3,k=e.k,N=e.e,F=e.m,C=e._,S=e.p,E=e.b2,A=e.W,B=e.a0,O=e.$,T=e.bq,D=e.F,I=e.P,V=e.br,P=e.bt,M=e.M,z=e.c,q=e.aS,j=e.aR,R=e.dN,$=e.aQ,L=e.ct,G=e.cW,Y=e.df,W=e.bv,H=e.cf,J=e.cF,Q=e.aP,Z=e.dT,K=e.dU,X=e.dV,ee=e.dW,ae=e.dX,le=e.dY,te=e.dZ,se=e.d_,re=e.ap,ie=e.cr,ne=e.U,oe=e.a5,ue=e.bA,de=e.d$,ce=e.a4,me=e.d8,ve=e.d9,pe=e.cD,fe=e.a6},e=>{ge=e.N},e=>{he=e.E},e=>{ye=e.B},e=>{xe=e.a8,_e=e.av,we=e.U,be=e.aw,Ue=e.G,ke=e.H,Ne=e.v,Fe=e._,Ce=e.ax},null,null],execute:function(){var a=document.createElement("style");a.textContent="ion-modal[data-v-1e565356]{--width: 90%;--height: 94%;--border-radius: 12px;--box-shadow: 0 28px 48px rgba(0, 0, 0, .4);--backdrop-opacity: var(--ion-backdrop-opacity, .32);--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1)}ion-radio-group[data-v-1e565356]{width:100%}.form_el[data-v-1e565356]{margin-right:10px;margin-left:10px;max-width:600px}.error-item[data-v-1e565356]{--border-color: #ff4444 !important;--highlight-color: #ff4444 !important}.error-input[data-v-1e565356]{--border-color: #ff4444 !important;--color: #ff4444 !important}.error-label[data-v-1e565356]{color:#f44!important}.error-section[data-v-1e565356]{border:1px solid #ff4444;border-radius:8px;padding:8px;margin-bottom:16px}.error-message[data-v-1e565356]{color:#f44;font-size:14px;margin-left:16px;margin-top:4px;margin-bottom:12px}ion-item[data-v-1e565356]{margin-bottom:8px}.search-section[data-v-8f4430d8]{margin-bottom:16px}.search-section ion-segment[data-v-8f4430d8]{margin-top:12px}.users-grid[data-v-8f4430d8]{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:16px;margin-bottom:20px}.user-card[data-v-8f4430d8]{margin:0;box-shadow:0 2px 8px rgba(0,0,0,.1);transition:transform .2s ease,box-shadow .2s ease}.user-card[data-v-8f4430d8]:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.15)}.user-header[data-v-8f4430d8]{display:flex;align-items:flex-start;gap:12px}.user-info[data-v-8f4430d8]{flex:1}.user-meta[data-v-8f4430d8]{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px;font-size:12px}.meta-item[data-v-8f4430d8]{display:flex;align-items:center;gap:4px}.meta-icon[data-v-8f4430d8]{font-size:14px}.status-chip[data-v-8f4430d8]{margin:4px 0 0}.user-details[data-v-8f4430d8]{margin:16px 0;display:flex;flex-direction:column;gap:8px}.detail-item[data-v-8f4430d8]{display:flex;align-items:flex-start;gap:8px;font-size:14px;line-height:1.4}.detail-icon[data-v-8f4430d8]{font-size:16px;color:var(--ion-color-primary);margin-top:2px;flex-shrink:0}.action-buttons[data-v-8f4430d8]{display:flex;gap:8px;flex-wrap:wrap;margin-top:16px}.action-buttons ion-button[data-v-8f4430d8]{flex:1;min-width:80px}.empty-state[data-v-8f4430d8]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px 32px;text-align:center}.empty-icon[data-v-8f4430d8]{font-size:64px;margin-bottom:16px;opacity:.5}@media (max-width: 768px){.users-grid[data-v-8f4430d8]{grid-template-columns:1fr;gap:12px}.action-buttons[data-v-8f4430d8]{flex-direction:column}.action-buttons ion-button[data-v-8f4430d8]{width:100%}.user-header[data-v-8f4430d8]{flex-direction:column;align-items:flex-start;gap:8px}.status-chip[data-v-8f4430d8]{align-self:flex-end}.user-meta[data-v-8f4430d8]{flex-direction:column;gap:4px}}.sticky-user-nav[data-v-5071b8a1]{position:sticky;top:0;z-index:1000;background:var(--ion-background-color, #ffffff);box-shadow:0 2px 4px rgba(0,0,0,.1);border-bottom:1px solid var(--ion-color-light, #e0e0e0)}\n/*$vite$:1*/",document.head.appendChild(a);const Se=(()=>{const e=_e;return{getPrograms:async function(a){const l=await e.getAll("programs",a);if(null!=l&&l.ok)return await l.json();throw new Error("Failed to retrieve programs.")},getEMRPrograms:async function(){const e=await xe.getAllPrograms(),a=[];return e.forEach((e=>{a.push({name:e.name,other:e,selected:!1})})),e}}})(),Ee=(()=>{const e=_e;return{getUserRoles:async function(a){const l=await e.getAll("roles",a);if(null!=l&&l.ok)return await l.json();throw new Error("Failed to retrieve user roles.")},getEMRUserRoles:async function(){return await we.getAllRoles()}}})(),Ae={key:0,class:"error-message"},Be={key:1,class:"error-message"},Oe={key:2,class:"error-message"},Te={key:3,class:"error-message"},De={key:5,class:"error-message"},Ie={key:0,class:"error-message"},Ve={style:{display:"flex",gap:"20px","margin-top":"8px"}},Pe={key:6,class:"error-message"},Me={key:7,class:"error-message"},ze={key:8,class:"error-message"},qe={class:"form_el"},je=s({__name:"UserFormModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["save","close"],setup(e,{emit:a}){const l=e,t=a,s=r(!1),z=r(null),q=r([]),j=r({}),R=r(),$=r({name:!1,firstName:!1,lastName:!1,password:!1,dateOfBirth:!1,gender:!1,roles:!1,programs:!1,usernameExists:!1}),L=r({name:"",firstName:"",lastName:"",password:"",gender:"",roles:[],programs:[]}),G=r([]),Y=r([]);function W(e){const a=e.value.formattedDate;R.value=ke.toStandardHisFormat(a),$.value.dateOfBirth=!1}function H(){z.value?s.value=!1:s.value=!0}const J=e=>{z.value=e.selected_location,H()},Q=()=>{L.value={name:"",firstName:"",lastName:"",password:"",dateOfBirth:"",gender:"",facility:null,roles:[],programs:[]},R.value=null,z.value=null,j.value={},s.value=!1,Object.keys($.value).forEach((e=>{$.value[e]=!1}))},Z=()=>{if(!l.editingUser){const e=G.value.find((e=>36===e.program_id));e&&(L.value.programs=[e.name],$.value.programs=!1)}},K=async e=>{const a=!l.editingUser||l.editingUser.name!==e;if(!e.trim()||!a)return $.value.usernameExists=!1,!0;try{const a=!0===(await we.doesUsernameExist(e)).exists;return $.value.usernameExists=a,!a}catch(t){return console.error("Error checking username existence:",t),Ne("Failed to verify username availability. Proceeding with caution."),$.value.usernameExists=!1,!0}};i((()=>L.value.name),(async e=>{e.trim()?($.value.name=!1,await K(e)):($.value.name=!0,$.value.usernameExists=!1)})),i((()=>L.value.firstName),(()=>{L.value.firstName.trim()&&($.value.firstName=!1)})),i((()=>L.value.lastName),(()=>{L.value.lastName.trim()&&($.value.lastName=!1)})),i((()=>L.value.password),(()=>{var e;null!==(e=L.value.password)&&void 0!==e&&e.trim()&&($.value.password=!1)})),i((()=>L.value.gender),(()=>{L.value.gender&&($.value.gender=!1)})),i((()=>L.value.roles),(()=>{L.value.roles.length>0&&($.value.roles=!1)})),i((()=>L.value.programs),(()=>{L.value.programs.length>0&&($.value.programs=!1)})),i((()=>l.editingUser),(e=>{if(e){const a=e.name.split(" "),l=a[0]||"",t=a.length>1?a.slice(1).join(" "):"";L.value={name:e.name,firstName:l,lastName:t,dateOfBirth:e.dateOfBirth||"",gender:e.gender||"",facility:e.facility||null,roles:e.roles,programs:e.programs},e.dateOfBirth&&(R.value=e.dateOfBirth),e.facility&&(z.value=e.facility,j.value=e.facility)}else Q(),Z()}),{immediate:!0}),i((()=>l.isOpen),(e=>{e&&!l.editingUser&&(Q(),Z())}));const X=async()=>{const e=(()=>{var e;$.value.name=!1,$.value.firstName=!1,$.value.lastName=!1,$.value.password=!1,$.value.dateOfBirth=!1,$.value.gender=!1,$.value.roles=!1,$.value.programs=!1;let a=!0;return L.value.name.trim()||($.value.name=!0,a=!1),L.value.firstName.trim()||($.value.firstName=!0,a=!1),L.value.lastName.trim()||($.value.lastName=!0,a=!1),l.editingUser||null!==(e=L.value.password)&&void 0!==e&&e.trim()||($.value.password=!0,a=!1),R.value||($.value.dateOfBirth=!0,a=!1),L.value.gender||($.value.gender=!0,a=!1),L.value.roles.length||($.value.roles=!0,a=!1),L.value.programs.length||($.value.programs=!0,a=!1),a})();H();const a=await K(L.value.name);if(!e||s.value||!a)return void(!e||s.value?Ne("Please fill out all required fields."):a||Ne("The chosen username is already taken."));const r=L.value.programs.map((e=>{const a=G.value.find((a=>a.name===e));return a?a.program_id:null})).filter((e=>null!==e)),i={...L.value,dateOfBirth:R.value,facility:z.value,programIDs:r};t("save",i)},ee=()=>{t("close")};return n((()=>{Q(),(async()=>{try{const e=Se,a=(await e.getEMRPrograms()).filter((e=>36===e.program_id));G.value=a.map((e=>({program_id:e.program_id,name:e.name}))),Z()}catch(e){console.error("Failed to fetch programs:",e),Ne("Failed to load programs.")}})(),(async()=>{try{const e=Ee,a=await e.getUserRoles();Y.value=a.map((e=>e.name))}catch(e){Ne("Failed to load roles.")}})()})),(e,a)=>(u(),o(d(c),{"is-open":e.isOpen,onDidDismiss:ee},{default:m((()=>[v(d(p),null,{default:m((()=>[v(d(f),null,{default:m((()=>[v(d(g),null,{default:m((()=>[h(y(e.editingUser?"Edit User":"Add New User"),1)])),_:1}),v(d(x),{slot:"end"},{default:m((()=>[v(d(_),{onClick:ee,fill:"clear"},{default:m((()=>[v(d(w),{style:{"font-size":"35px"},icon:d(b)},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),v(d(U),{class:"ion-padding"},{default:m((()=>[k("form",{id:"user-form",onSubmit:P(X,["prevent"])},[v(d(C),{class:S({"error-item":$.value.name||$.value.usernameExists})},{default:m((()=>[v(d(E),{modelValue:L.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value.name=e),label:"Username","label-placement":"stacked",placeholder:"Enter username",required:"",class:S({"error-input":$.value.name||$.value.usernameExists})},null,8,["modelValue","class"])])),_:1},8,["class"]),$.value.name?(u(),N("div",Ae," Username is required ")):$.value.usernameExists?(u(),N("div",Be," This username is already taken. ")):F("",!0),v(d(C),{class:S({"error-item":$.value.firstName})},{default:m((()=>[v(d(E),{modelValue:L.value.firstName,"onUpdate:modelValue":a[1]||(a[1]=e=>L.value.firstName=e),label:"First Name","label-placement":"stacked",placeholder:"Enter first name",required:"",class:S({"error-input":$.value.firstName})},null,8,["modelValue","class"])])),_:1},8,["class"]),$.value.firstName?(u(),N("div",Oe," First name is required ")):F("",!0),v(d(C),{class:S({"error-item":$.value.lastName})},{default:m((()=>[v(d(E),{modelValue:L.value.lastName,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value.lastName=e),label:"Last Name","label-placement":"stacked",placeholder:"Enter last name",required:"",class:S({"error-input":$.value.lastName})},null,8,["modelValue","class"])])),_:1},8,["class"]),$.value.lastName?(u(),N("div",Te," Last name is required ")):F("",!0),e.editingUser?F("",!0):(u(),o(d(C),{key:4,class:S({"error-item":$.value.password})},{default:m((()=>[v(d(E),{modelValue:L.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>L.value.password=e),label:"Password","label-placement":"stacked",placeholder:"Enter password",type:"password",required:"",class:S({"error-input":$.value.password})},null,8,["modelValue","class"])])),_:1},8,["class"])),$.value.password&&!e.editingUser?(u(),N("div",De," Password is required ")):F("",!0),k("div",{class:S(["form_el",{"error-section":$.value.dateOfBirth}])},[k("h6",{style:{"font-size":"16px","font-weight":"400"},class:S({"error-label":$.value.dateOfBirth})}," Date Of Birth ",2),v(be,{place_holder:"Date Of Birth",onDateUpDated:W,date_prop:""}),$.value.dateOfBirth?(u(),N("div",Ie," Date of birth is required ")):F("",!0)],2),v(d(C),{class:S({"error-item":$.value.gender})},{default:m((()=>[v(d(A),{position:"stacked",class:S({"error-label":$.value.gender})},{default:m((()=>a[7]||(a[7]=[h("Gender")]))),_:1,__:[7]},8,["class"]),v(d(B),{modelValue:L.value.gender,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value.gender=e)},{default:m((()=>[k("div",Ve,[v(d(C),{lines:"none",style:{"--padding-start":"0"}},{default:m((()=>[v(d(O),{slot:"start",value:"male"}),v(d(A),null,{default:m((()=>a[8]||(a[8]=[h("Male")]))),_:1,__:[8]})])),_:1}),v(d(C),{lines:"none",style:{"--padding-start":"0"}},{default:m((()=>[v(d(O),{slot:"start",value:"female"}),v(d(A),null,{default:m((()=>a[9]||(a[9]=[h("Female")]))),_:1,__:[9]})])),_:1})])])),_:1},8,["modelValue"])])),_:1},8,["class"]),$.value.gender?(u(),N("div",Pe," Gender is required ")):F("",!0),v(d(C),{class:S({"error-item":$.value.roles})},{default:m((()=>[v(d(T),{modelValue:L.value.roles,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value.roles=e),label:"Roles","label-placement":"stacked",placeholder:"Select roles",multiple:"",class:S({"error-input":$.value.roles})},{default:m((()=>[(u(!0),N(D,null,I(Y.value,(e=>(u(),o(d(V),{key:e,value:e},{default:m((()=>[h(y(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","class"])])),_:1},8,["class"]),$.value.roles?(u(),N("div",Me," At least one role is required ")):F("",!0),v(d(C),{class:S({"error-item":$.value.programs})},{default:m((()=>[v(d(T),{modelValue:L.value.programs,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value.programs=e),label:"Programs","label-placement":"stacked",placeholder:"Select programs",multiple:"",class:S({"error-input":$.value.programs})},{default:m((()=>[(u(!0),N(D,null,I(G.value,(e=>(u(),o(d(V),{key:e.id,value:e.name},{default:m((()=>[h(y(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","class"])])),_:1},8,["class"]),$.value.programs?(u(),N("div",ze," At least one program is required ")):F("",!0),k("div",qe,[a[10]||(a[10]=k("h6",{style:{"font-size":"16px","font-weight":"400"}},"Facility",-1)),v(Ue,{show_error:s.value,onFacilitySelected:J,selected_district_ids:q.value,selected_location:j.value},null,8,["show_error","selected_district_ids","selected_location"])])],32)])),_:1}),v(d(M),null,{default:m((()=>[v(d(f),null,{default:m((()=>[v(d(x),{slot:"end"},{default:m((()=>[k("div",null,[v(d(_),{onClick:ee,fill:"solid"},{default:m((()=>a[11]||(a[11]=[h(" Cancel ")]))),_:1,__:[11]}),v(d(_),{onClick:X,fill:"solid",style:{"margin-left":"10px","margin-right":"10px"}},{default:m((()=>[h(y(e.editingUser?"Update":"Create")+" User ",1)])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1},8,["is-open"]))}}),Re=Fe(je,[["__scopeId","data-v-1e565356"]]),$e={class:"users-grid"},Le={class:"user-header"},Ge=["src","alt"],Ye={class:"user-info"},We={key:0,class:"user-meta"},He={key:0,class:"meta-item"},Je={key:1,class:"meta-item"},Qe={class:"user-details"},Ze={key:0,class:"detail-item"},Ke={key:1,class:"detail-item"},Xe={key:2,class:"detail-item"},ea={class:"detail-item"},aa={class:"detail-item"},la={class:"action-buttons"},ta={key:0,class:"empty-state"},sa=s({__name:"miUsersTemplate",props:{initialSearchTerm:{default:""},initialStatusFilter:{default:"all"},initialItemsPerPage:{default:6},enableSearch:{type:Boolean,default:!0},enableStatusFilter:{type:Boolean,default:!0},enablePagination:{type:Boolean,default:!0},searchPlaceholder:{default:"Search users..."},searchDebounceTime:{default:300}},emits:["search-changed","status-filter-changed","users-filtered","user-edited","user-deleted","user-status-changed","user-created"],setup(e,{expose:a,emit:s}){const c=e,p=s,f=r([]),g=r(c.initialSearchTerm),x=r(c.initialStatusFilter),b=r(1),C=r(c.initialItemsPerPage),S=r(!1),E=r(null);let B=null;const O=e=>{var a,s,r,i,n;const{getAvatarUrl:o}=function(){const e=()=>{let e="";for(let a=0;a<6;a++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e};return{getAvatarUrl:(a,s=128)=>{const r=l(t,{seed:`${a}`,size:s,backgroundColor:[e()]}).toString(),i=unescape(encodeURIComponent(r));return`data:image/svg+xml;base64,${btoa(i)}`}}}();return{id:e.id,name:e.username,email:e.username,dateOfBirth:null===(a=e.profile)||void 0===a?void 0:a.dateOfBirth,gender:null===(s=e.profile)||void 0===s?void 0:s.gender,facility:null!==(r=e.facilities)&&void 0!==r&&null!==(r=r[0])&&void 0!==r&&r.facility?{name:e.facilities[0].facility.facility_name,code:e.facilities[0].facility.facility_code}:null,roles:(null===(i=e.roles)||void 0===i?void 0:i.map((e=>e.role.name)))||[],programs:(null===(n=e.programs)||void 0===n?void 0:n.map((e=>e.program.name)))||[],status:"active",avatar:o(e.username),createdAt:new Date(e.createdAt),lastActive:new Date(e.updatedAt)}},T=z((()=>{let e=f.value;if(c.enableSearch&&g.value){const a=g.value.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.roles&&e.roles.some((e=>e.toLowerCase().includes(a)))||e.programs&&e.programs.some((e=>e.toLowerCase().includes(a)))||e.gender&&e.gender.toLowerCase().includes(a)||e.facility&&e.facility.name&&e.facility.name.toLowerCase().includes(a)))}return c.enableStatusFilter&&"all"!==x.value&&(e=e.filter((e=>e.status===x.value))),e})),V=z((()=>{if(!c.enablePagination)return T.value;const e=(b.value-1)*C.value,a=e+C.value;return T.value.slice(e,a)}));i((()=>g.value),(e=>{B&&clearTimeout(B),B=setTimeout((()=>{p("search-changed",e),b.value=1}),c.searchDebounceTime)}),{immediate:!1}),i((()=>x.value),(e=>{p("status-filter-changed",e),b.value=1}),{immediate:!1}),i((()=>T.value),(e=>{p("users-filtered",e)}),{deep:!0,immediate:!0});const P=e=>{b.value=e.page,C.value=e.itemsPerPage},oe=e=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(e),ue=e=>{const a=new Date,l=new Date(e);let t=a.getFullYear()-l.getFullYear();const s=a.getMonth()-l.getMonth();return(s<0||0===s&&a.getDate()<l.getDate())&&t--,t},de=()=>{S.value=!1,E.value=null},ce=async e=>{try{if(E.value){const a=f.value.findIndex((e=>e.id===E.value.id));if(-1!==a){const l={...f.value[a],...e};f.value[a]=l,p("user-edited",l)}(await ie.create({message:"User updated successfully",duration:2e3,color:"success"})).present()}else{const a=await me(e),l=await Ce.register(a),t=O(l);t&&(f.value.push(t),p("user-created",t),(await ie.create({message:"User created successfully",duration:2e3,color:"success"})).present())}de()}catch(a){(await ie.create({message:`Error saving user: ${a}`,duration:2e3,color:"danger"})).present()}},me=async e=>{if(!e||!e.facility)throw new Error("Invalid user data. 'facility' is required.");return{username:e.name,password:e.password,roles:e.roles,programs:e.programs,programIds:e.programIDs,facilities:[e.facility.code],profile:{firstName:e.firstName,lastName:e.lastName,gender:e.gender,dateOfBirth:"1990-01-01T00:00:00.000Z"}}},ve=async()=>{try{const e=await Ce.getUsers();f.value=e.map(O)}catch(e){console.error("Failed to fetch MIUM users:",e),ie.create({message:"Failed to load users.",duration:2e3,color:"danger"}).then((e=>e.present()))}};return n((async()=>{await ve()})),a({setSearchTerm:e=>{g.value=e},setStatusFilter:e=>{x.value=e},refreshUsers:ve,cleanup:()=>{B&&clearTimeout(B)},openAddUserModal:()=>{E.value=null,S.value=!0},users:f.value,filteredUsers:T,paginatedUsers:V}),(e,a)=>(u(),N(D,null,[v(d(U),{class:"ion-padding",style:{height:"80vh"}},{default:m((()=>[k("div",$e,[(u(!0),N(D,null,I(V.value,(e=>(u(),o(d(q),{key:e.id,class:"user-card"},{default:m((()=>[v(d(j),null,{default:m((()=>[k("div",Le,[v(d(R),null,{default:m((()=>[k("img",{src:e.avatar,alt:e.name},null,8,Ge)])),_:2},1024),k("div",Ye,[v(d($),null,{default:m((()=>[h(y(e.name),1)])),_:2},1024),v(d(L),null,{default:m((()=>[h(y(e.email),1)])),_:2},1024),e.gender||e.dateOfBirth?(u(),N("div",We,[e.gender?(u(),N("span",He,[v(d(w),{icon:d(G),class:"meta-icon"},null,8,["icon"]),h(" "+y(e.gender),1)])):F("",!0),e.dateOfBirth?(u(),N("span",Je,[v(d(w),{icon:d(Y),class:"meta-icon"},null,8,["icon"]),h(" "+y(ue(e.dateOfBirth))+" years old ",1)])):F("",!0)])):F("",!0)]),v(d(W),{color:"active"===e.status?"success":"medium",class:"status-chip"},{default:m((()=>[v(d(w),{icon:"active"===e.status?d(H):d(J),slot:"start"},null,8,["icon"]),v(d(A),null,{default:m((()=>[h(y(e.status),1)])),_:2},1024)])),_:2},1032,["color"])])])),_:2},1024),v(d(Q),null,{default:m((()=>[k("div",Qe,[e.roles&&e.roles.length?(u(),N("div",Ze,[v(d(w),{icon:d(Z),class:"detail-icon"},null,8,["icon"]),k("span",null,y(e.roles.join(", ")),1)])):F("",!0),e.programs&&e.programs.length?(u(),N("div",Ke,[v(d(w),{icon:d(K),class:"detail-icon"},null,8,["icon"]),k("span",null,y(e.programs.join(", ")),1)])):F("",!0),e.facility?(u(),N("div",Xe,[v(d(w),{icon:d(X),class:"detail-icon"},null,8,["icon"]),k("span",null,y(e.facility.name||"Assigned Facility"),1)])):F("",!0),k("div",ea,[v(d(w),{icon:d(Y),class:"detail-icon"},null,8,["icon"]),k("span",null,"Joined "+y(oe(e.createdAt)),1)]),k("div",aa,[v(d(w),{icon:d(ee),class:"detail-icon"},null,8,["icon"]),k("span",null,"Last active "+y(oe(e.lastActive)),1)])]),k("div",la,[v(d(_),{onClick:a=>(e=>{E.value=e,S.value=!0})(e),fill:"outline",size:"small",color:"primary"},{default:m((()=>[v(d(w),{icon:d(ae),slot:"start"},null,8,["icon"]),a[0]||(a[0]=h(" Edit "))])),_:2,__:[0]},1032,["onClick"]),v(d(_),{onClick:a=>(async e=>{(await ne.create({header:"Confirm Status Change",message:`Are you sure you want to ${"active"===e.status?"deactivate":"activate"} ${e.name}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:()=>{e.status="active"===e.status?"inactive":"active",p("user-status-changed",e),ie.create({message:`User ${"active"===e.status?"activated":"deactivated"} successfully`,duration:2e3,color:"success"}).then((e=>e.present()))}}]})).present()})(e),fill:"outline",size:"small",color:"active"===e.status?"warning":"success"},{default:m((()=>[v(d(w),{icon:"active"===e.status?d(le):d(te),slot:"start"},null,8,["icon"]),h(" "+y("active"===e.status?"Deactivate":"Activate"),1)])),_:2},1032,["onClick","color"]),v(d(_),{onClick:a=>(async e=>{(await ne.create({header:"Confirm Delete",message:`Are you sure you want to delete ${e.name}? This action cannot be undone.`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{const a=f.value.findIndex((a=>a.id===e.id));-1!==a&&(f.value.splice(a,1),p("user-deleted",e.id),ie.create({message:"User deleted successfully",duration:2e3,color:"success"}).then((e=>e.present())))}}]})).present()})(e),fill:"outline",size:"small",color:"danger"},{default:m((()=>[v(d(w),{icon:d(se),slot:"start"},null,8,["icon"]),a[1]||(a[1]=h(" Delete "))])),_:2,__:[1]},1032,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))]),0===T.value.length?(u(),N("div",ta,[v(d(w),{icon:d(re),class:"empty-icon"},null,8,["icon"]),a[2]||(a[2]=k("h3",null,"No users found",-1)),a[3]||(a[3]=k("p",null,"Try adjusting your search or filter criteria",-1))])):F("",!0)])),_:1}),v(d(M),null,{default:m((()=>[v(ye,{"total-items":T.value.length,"current-page":b.value,"items-per-page":C.value,"onUpdate:pagination":P},null,8,["total-items","current-page","items-per-page"])])),_:1}),v(Re,{"is-open":S.value,"editing-user":E.value,onSave:ce,onClose:de},null,8,["is-open","editing-user"])],64))}}),ra=Fe(sa,[["__scopeId","data-v-8f4430d8"]]),ia=s({__name:"UserNav",props:{searchTerm:{type:String,required:!0},statusFilter:{type:String,required:!0}},emits:["update:searchTerm","update:statusFilter","openAddUserModal"],setup:(e,{emit:a})=>(a,l)=>(u(),N(D,null,[v(d(ce),{class:"ion-align-items-center"},{default:m((()=>[v(d(oe),{size:"8"},{default:m((()=>[v(d(ue),{value:e.searchTerm,onIonInput:l[0]||(l[0]=e=>a.$emit("update:searchTerm",e.detail.value)),placeholder:"Search users...","show-clear-button":"focus",debounce:"300"},null,8,["value"])])),_:1}),v(d(oe),{size:"4",class:"ion-text-right"},{default:m((()=>[v(d(_),{onClick:l[1]||(l[1]=e=>a.$emit("openAddUserModal")),fill:"solid"},{default:m((()=>[v(d(w),{icon:d(de),slot:"start"},null,8,["icon"]),l[3]||(l[3]=h(" Add User "))])),_:1,__:[3]})])),_:1})])),_:1}),v(d(ce),{class:"ion-padding-start ion-padding-end"},{default:m((()=>[v(d(oe),{size:"12"},{default:m((()=>[v(d(me),{value:e.statusFilter,onIonChange:l[2]||(l[2]=e=>a.$emit("update:statusFilter",e.detail.value))},{default:m((()=>[v(d(ve),{value:"all"},{default:m((()=>[v(d(A),null,{default:m((()=>l[4]||(l[4]=[h("All")]))),_:1,__:[4]})])),_:1}),v(d(ve),{value:"active"},{default:m((()=>[v(d(A),null,{default:m((()=>l[5]||(l[5]=[h("Active")]))),_:1,__:[5]})])),_:1}),v(d(ve),{value:"inactive"},{default:m((()=>[v(d(A),null,{default:m((()=>l[6]||(l[6]=[h("Inactive")]))),_:1,__:[6]})])),_:1})])),_:1},8,["value"])])),_:1})])),_:1})],64))}),na={class:"sticky-user-nav"};e("default",Fe(s({__name:"miusers",setup(e,{expose:a}){const l=r(""),t=r("all"),s=r([]),i=r(0),c=r();z((()=>l.value)),z((()=>t.value));const p=e=>{l.value=e,console.log("Search term updated:",e)},f=e=>{t.value=e,console.log("Status filter updated:",e)},g=e=>{l.value!==e&&(l.value=e),console.log("Internal search changed:",e)},h=e=>{t.value!==e&&(t.value=e),console.log("Internal filter changed:",e)},y=e=>{i.value=e.length},x=e=>{console.log("User created:",e)},_=e=>{console.log("User edited:",e)},w=e=>{console.log("User deleted:",e)},b=e=>{console.log("User status changed:",e)},N=()=>{c.value?c.value.openAddUserModal():console.log("usersTemplateRef is not yet available.")},F=async()=>{try{console.log("Loading users...")}catch(e){console.error("Error loading users:",e)}};return n((async()=>{await(async()=>{he().setNavigationPayload("Manage Integrated Users",!0,!1,"/","home","")})(),await F()})),pe((()=>{c.value&&"function"==typeof c.value.cleanup&&c.value.cleanup()})),a({refreshUsers:()=>{c.value&&c.value.refreshUsers(),F()},setSearch:e=>{l.value=e,c.value&&c.value.setSearchTerm(e)},setFilter:e=>{t.value=e,c.value&&c.value.setStatusFilter(e)},searchTerm:l,statusFilter:t,usersList:s,filteredUsersCount:i}),(e,a)=>(u(),o(d(fe),null,{default:m((()=>[v(ge),v(d(U),{fullscreen:!0},{default:m((()=>[k("div",na,[v(ia,{fullscreen:!0,searchTerm:l.value,statusFilter:t.value,"onUpdate:searchTerm":p,"onUpdate:statusFilter":f,onOpenAddUserModal:N},null,8,["searchTerm","statusFilter"])]),v(ra,{ref_key:"usersTemplateRef",ref:c,"initial-users":s.value,"initial-search-term":l.value,"initial-status-filter":t.value,"search-debounce-time":500,"enable-search":!0,"enable-status-filter":!0,"enable-pagination":!0,onSearchChanged:g,onStatusFilterChanged:h,onUsersFiltered:y,onUserCreated:x,onUserEdited:_,onUserDeleted:w,onUserStatusChanged:b},null,8,["initial-users","initial-search-term","initial-status-filter"])])),_:1})])),_:1}))}}),[["__scopeId","data-v-5071b8a1"]]))}}}));
