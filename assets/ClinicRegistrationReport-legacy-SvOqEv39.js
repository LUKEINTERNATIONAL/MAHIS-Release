System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-BKgnMbFt.js","./BaseTableReport-legacy-D19ADln6.js","./index-legacy-BUiyYzvd.js","./vendor-legacy-LYGlphH7.js","./lodash-legacy-pOOc9Efu.js","./Export-legacy-DYPzdL1a.js"],function(t,e){"use strict";var l,i,n,a,s,o,r,u,d,c,p,_,f,h,g,m,y,v,R,w,D;return{setters:[t=>{l=t.t,i=t._,n=t.O},t=>{a=t.R},t=>{s=t._,o=t.H,r=t.S},t=>{u=t.d,d=t.dG,c=t.E,p=t.e,_=t.f,f=t.l,h=t.z,g=t.A,m=t.k,y=t.F,v=t.L,R=t.y,w=t.B,D=t.af},null,null],execute:function(){const e=u({props:{list:Object},setup:()=>({closeModal:async()=>await d.dismiss()})}),B=s(e,[["render",function(t,e,l,i,n,a){const s=c("ion-title"),o=c("ion-button"),r=c("ion-toolbar"),u=c("ion-header"),d=c("ion-col"),D=c("ion-row"),B=c("ion-item"),b=c("ion-list"),x=c("ion-grid"),T=c("ion-content");return _(),p(y,null,[f(u,null,{default:h(()=>[f(r,null,{default:h(()=>[f(s,null,{default:h(()=>e[1]||(e[1]=[g("Clinic Registration Report Summary")])),_:1,__:[1]}),f(o,{color:"danger",slot:"end",onClick:e[0]||(e[0]=e=>t.closeModal())},{default:h(()=>e[2]||(e[2]=[g("X")])),_:1,__:[2]})]),_:1})]),_:1}),f(T,{class:"ion-padding"},{default:h(()=>[f(x,null,{default:h(()=>[f(D,null,{default:h(()=>[f(d,null,{default:h(()=>e[3]||(e[3]=[m("h3",null,"Type of Visit",-1)])),_:1,__:[3]}),f(d,null,{default:h(()=>e[4]||(e[4]=[m("h3",null," < 5yrs ",-1)])),_:1,__:[4]}),f(d,null,{default:h(()=>e[5]||(e[5]=[m("h3",null," > 5yrs",-1)])),_:1,__:[5]}),f(d,null,{default:h(()=>e[6]||(e[6]=[m("h3",null,"Total",-1)])),_:1,__:[6]})]),_:1}),f(b,null,{default:h(()=>[(_(!0),p(y,null,v(t.list,t=>(_(),R(B,{key:t},{default:h(()=>[f(d,null,{default:h(()=>[g(w(t.label),1)]),_:2},1024),f(d,null,{default:h(()=>[g(w(t.under5),1)]),_:2},1024),f(d,null,{default:h(()=>[g(w(t.over5),1)]),_:2},1024),f(d,null,{default:h(()=>[g(w(t.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})],64)}]]),b=u({components:{ReportTemplate:a,IonPage:D},mixins:[i],data:()=>({title:"Clinic Registration",rows:[],reportData:[],columns:[[l.thTxt("Reg"),l.thTxt("First Name"),l.thTxt("Last Name"),l.thTxt("Gender"),l.thTxt("DOB"),l.thTxt("Date reg.")]],customBtns:[]}),created(){this.fields=this.getDateDurationFields(),this.customBtns.push({name:"High level view",size:"large",slot:"start",color:"primary",visible:!0,onClick:async()=>this.showModal()})},methods:{async init(t,e){const l=new n;l.setStartDate(e.start_date),l.setEndDate(e.end_date),this.period=l.getDateIntervalPeriod();const i=await l.getClinicRegistrations();this.reportData=i.sort((t,e)=>t.visit_type>e.visit_type?1:t.visit_type<e.visit_type?-1:0),this.rows=this.buildRows(this.reportData)},buildRows:t=>t.length?t.map(t=>[l.td(t.visit_type),l.td(t.given_name),l.td(t.family_name),l.td(t.gender),l.td(o.toStandardHisDisplayFormat(t.birthdate)),l.td(o.toStandardHisDisplayFormat(t.visit_date))]):[],filterBy(t,e){return this.reportData.filter(l=>{const i=o.calculateAge(l.birthdate,r.getSessionDate());return l.visit_type===t&&("under5"===e?i<=5:i>6)})},modalData(){const t=[...this.filterBy("New patient","under5")].length,e=[...this.filterBy("New patient","over5")].length,l=t+e,i=[...this.filterBy("Referral","under5")].length,n=[...this.filterBy("Referral","over5")].length,a=i+n,s=[...this.filterBy("Revisiting","under5")].length,o=[...this.filterBy("Revisiting","over5")].length;return[{label:"New patient",under5:t,over5:e,value:l},{label:"Referral",under5:i,over5:n,value:a},{label:"Revisiting",under5:s,over5:o,value:s+o}]},async showModal(){const t=[...this.modalData()];(await d.create({component:B,backdropDismiss:!0,cssClass:"action-sheet-modal",componentProps:{list:t}})).present()}}});t("default",s(b,[["render",function(t,e,l,i,n,a){const s=c("report-template"),o=c("ion-page");return _(),R(o,null,{default:h(()=>[f(s,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,itemsPerPage:10,period:t.period,reportPrefix:"Clinic",onReportConfiguration:t.init,customBtns:t.customBtns,paginated:""},null,8,["title","rows","fields","columns","period","onReportConfiguration","customBtns"])]),_:1})}]]))}}});
