import{d as nt,af as k,a9 as at,be as rt,b1 as lt,a1 as dt,ai as ct,ah as pt,aP as ut,cb as mt,aQ as ht,aO as gt,aR as vt,M as ft,G as _t,E as St,ae as yt,c0 as Dt,I as kt,a8 as wt,cM as Vt,dA as It,$ as Ct,bC as bt,H as l,e as d,f as a,k as s,l as o,p as Mt,m as u,K as c,P as r,N as y,J as i,F as Tt}from"./vendor-BTD4y0_l.js";import{j as Pt,J as At,Q as Ot,T as Ht,H as v,k as b,o as f,S as D,t as Q,N as Ft,bB as $t,P as Et,aR as Rt,a6 as Ut,aE as Bt,aD as Nt,aN as Wt,l as Gt,_ as Lt}from"./index-CHQBF5A7.js";import{D as zt}from"./DemographicBar-CKr44tpw.js";import{S as jt}from"./SaveProgressModal-DSG6WsTg.js";import{S as xt}from"./Stepper-0ZPVa7Oj.js";import{T as Qt}from"./NextAppointment-OuMC4Got.js";import{l as w}from"./lodash-Dt8AsbQm.js";import{a as J,D as Jt}from"./drug_prescription_service-_c334Bul.js";import Kt from"./WeightHeightChart-dHwBtW3Z.js";import{c as Yt,a as Xt,_ as Zt,m as qt,b as te,d as ee,f as se,v as oe,w as ie,O as ne}from"./PatientProfile.vue_vue_type_script_lang-D1iqbkrH.js";import"./apexcharts-DR6FmxCR.js";import"./OPDOutcome-Cask0stK.js";import"./patient_complaints_service-BljgviWD.js";import"./DashBox-DNuC-Ys-.js";import"./useExposeFromStandardForm-C6-IUGrn.js";import"./BasicForm-Ci9c4wUc.js";import"./DateInputField-BbxdSCBF.js";import"./formatServerData-DiKnOMkf.js";import"./drug_service-CutpIS0x.js";import"./Outcome-Uh7Bgbps.js";import"./TreatmentPlan-t5v_HNZI.js";import"./previousDiagnosis-rq28d-xB.js";import"./group_validation-DaCgJLGE.js";import"./FeatusModal-N2G2FP2Q.js";import"./BasicCard-DliH5qJI.js";import"./PastObstreticHistoryStore-CAY1zW-h.js";import"./lab_order-BSZ_94cY.js";import"./UpcomingFeature-CsCQFy74.js";import"./ncd_appointment_service-ydQDmE4f.js";import"./chartjs-nzlBkdg_.js";import"./customDatePicker.vue_vue_type_style_index_0_lang-m9q6nkqi.js";import"./SetRelationship.vue_vue_type_script_lang-DDK0Bnho.js";import"./relationship_service-DaY3PhmL.js";import"./AdministerOtherVaccinesStore-B9OcBTMD.js";import"./vaccines_service-CwQdyUM0.js";import"./sms_service-DeAP1w1q.js";import"./EIRreportsStore-BQ6HmNCJ.js";import"./Export-B3JOLFnC.js";import"./stock_service-jTxAh0py.js";import"./barcode-qrcode-reader-CrlC_VHh.js";import"./usePatientProfile-BLyj5mcx.js";import"./Registration-vCAT4YiW.js";import"./useLocation-Cvz5BLCL.js";const ae=nt({mixins:[Zt],name:"Home",components:{IonContent:wt,IonHeader:kt,IonMenuButton:Dt,IonPage:yt,IonTitle:St,IonToolbar:_t,Toolbar:Ht,ToolbarSearch:Ot,DemographicBar:zt,IonButton:ft,IonCard:vt,IonCardContent:gt,IonCardHeader:ht,IonCardSubtitle:mt,IonCardTitle:ut,IonAccordion:pt,IonAccordionGroup:ct,IonItem:dt,IonLabel:lt,IonModal:rt,Stepper:xt,DynamicButton:At,WeightHeightChart:Kt,PreviousVitals:Pt,customSlider:Xt,IonRow:at,customVaccine:Yt},data(){return{wizardData:[],StepperData:[],isOpen:!1,iconsContent:Gt,current_milestone:"",checkUnderSixWeeks:!1,unprotected_at_birth:"",protectedStatus:"",todays_date:v.toStandardHisDisplayFormat(D.getSessionDate()),lastVaccine:[],visits:[],selectedStatus:7}},computed:{...k(Wt,["vitals"]),...k(Nt,["selectedMedicalDrugsList","nonPharmalogicalTherapyAndOtherNotes","selectedMedicalAllergiesList"]),...k(Bt,["outcomes"]),...k(b,["currentMilestone","missedVaccineSchedules","overDueVaccinesCount","lastVaccinesGiven","lastVaccineGievenDate","nextAppointMentDate"])},async mounted(){this.loadCurrentMilestone(),this.checkAge(),await this.checkProtectedStatus(),await this.openFollowModal(),await this.programEnrollment()},watch:{currentMilestone:{handler(){this.loadCurrentMilestone()}},$route:{async handler(t){t.name=="patientProfile"&&this.patient.patientID&&(await this.checkProtectedStatus(),await this.programEnrollment())}},patient:{async handler(){this.patient&&(await this.checkProtectedStatus(),await this.programEnrollment(),this.checkAge(),this.setMilestoneReload())}}},setup(){return{chevronBackOutline:bt,checkmark:Ct,ellipsisVerticalSharp:It,person:Vt}},methods:{handleChange(t){this.selectedStatus=t},async programEnrollment(){if(this.patient.patientID){this.program=new Ut(this.patient.patientID);const t=await this.program.getProgramCurrentStates();if(t)this.selectedStatus=t.state;else{try{await this.program.enrollProgram(),await this.program.setStateId(7)}catch(e){await this.program.setStateId(7)}await this.program.updateState(),this.selectedStatus=7}}},async updateState(t){this.selectedStatus=t,await this.program.setStateId(t),await this.program.updateState()},getAge(t){return v.calculateDisplayAge(v.toStandardHisFormat(t))},async checkProtectedStatus(){this.protectedStatus=this.getData(this.patient.birthRegistration,11759)[0]},getData(t,e){return t?t.filter(n=>n.concept_id==e).map(n=>n.value_text):""},checkAge(){var t,e,n,m;w.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=v.dateDiffInDays(v.sessionDate(),(m=(n=this.patient)==null?void 0:n.personInformation)==null?void 0:m.birthdate)<42)},openVitalsModal(){f(ne,{class:"otherVitalsModal"})},openWH(){f(ie,{class:"otherVitalsModal"})},openVH(){f(oe,{class:"otherVitalsModal vaccineHistoryModal"})},async openFollowModal(){var t;if((t=this.patient)!=null&&t.patientID){this.lastVaccine=await Rt.getLastDrugsReceived(this.patient.patientID);const e={protectedStatus:this.protectedStatus,lastVaccinesGiven:this.lastVaccinesGiven};this.lastVaccinesGiven.length>0&&f(se,{class:"fullScreenModal"},!0,e)}},openAdministerVaccineModal(){f(ee,{class:"otherVitalsModal"})},openAdministerOtherVaccineModal(){f(te,{class:"otherVitalsModal"})},isChild(){return!!new Et().isUnderFive()},getFormatedData(t){return t.map(e=>e==null?void 0:e.data)},async saveVitals(){if(this.vitals.validationStatus){const t=D.getUserID();new $t(this.patient.patientID,t).onFinish(this.vitals)}},async saveTreatmentPlan(){const t=D.getUserID(),e=this.patient.patientID,n=new Qt;if(!w.isEmpty(this.selectedMedicalAllergiesList)){const m=this.mapToAllergies();n.onSubmitAllergies(e,t,m)}if(!w.isEmpty(this.nonPharmalogicalTherapyAndOtherNotes)){const m=[{concept_id:2688,obs_datetime:D.getSessionDate(),value_text:this.nonPharmalogicalTherapyAndOtherNotes}];n.onSubmitNotes(e,t,m)}if(!w.isEmpty(this.selectedMedicalDrugsList)){const m=this.mapToOrders(),V=new J(e,t);if(!await V.createEncounter())return Q("Unable to create treatment encounter");if(!await V.createDrugOrder(m))return Q("Unable to create drug orders!");Ft("Drug order has been created")}},openModal(){f(jt)},mapToOrders(){return this.selectedMedicalDrugsList.map(t=>{const e=J.getSessionDate(),n=Jt.find(m=>m.label===t.frequency)||{};return{drug_inventory_id:t.drug_id,equivalent_daily_dose:t.dose=="Unknown"?0:t.dose*(n==null?void 0:n.value)||0,start_date:e,auto_expire_date:this.calculateExpireDate(e,t.duration),units:t.units,instructions:"".concat(t.drugName,": ").concat(t.dose," ").concat(t.units," ").concat((n==null?void 0:n.code)||""," for ").concat(t.duration," days"),dose:t.dose,frequency:(n==null?void 0:n.code)||""}})},formatBirthdate(){var t,e;return v.toStandardHisDisplayFormat((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},calculateExpireDate(t,e){const n=new Date(t);return n.setDate(n.getDate()+parseInt(e)),v.toStandardHisFormat(n)},mapToAllergies(){return this.selectedMedicalAllergiesList.map(t=>({concept_id:985,obs_datetime:D.getSessionDate(),value_coded:t.concept_id}))},loadCurrentMilestone(){const t=b();this.current_milestone=t.getCurrentMilestone()},showMissedVaccines(){this.missedVaccineSchedules.length>0&&f(qt,{class:"otherVitalsModal vaccineHistoryModal"})},setMilestoneReload(){const t=b();t.setVaccineReload(!t.getVaccineReload())},getLastVaccinesGivenDisplayDate(){return v.toStandardHisDisplayFormat(this.lastVaccineGievenDate)}}}),re={fullscreen:!0,style:{"--background":"#fff"}},le={class:"demographics"},de={style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},ce={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},pe={style:{"margin-right":"5px"}},ue={class:"demographicsFirstRow"},me={class:"name"},he={class:"demographicsOtherRow",style:{"margin-top":"10px"}},ge={class:"demographicsText"},ve={key:0,class:"demographicsOtherRow"},fe={class:"demographicsText mediumFontColor"},_e={key:1,class:"demographicsOtherRow"},Se={class:"demographicsText mediumFontColor"},ye={class:"demographicsOtherRow"},De={class:"demographicsText smallFont"},ke={class:"mediumFontColor"},we={class:"demographicsOtherRow"},Ve={key:0,class:"demographicsText smallFont"},Ie={key:1,class:"demographicsText smallFont"},Ce={key:2,class:"demographicsText smallFont"},be={class:"demographicsOtherRow",style:{"margin-bottom":"10px"}},Me={class:"demographicsText smallFont"},Te={key:0,style:{background:"#fedf89",color:"#b54708"},class:"protectedStatus"},Pe={key:1,style:{background:"#ddeedd"},class:"protectedStatus"},Ae={key:2,class:"protectedStatus",style:{background:"#fecdca",color:"#b42318"}},Oe={class:"graphSection"},He={class:"graphBtn",style:{"margin-bottom":"5px"}},Fe={class:"weightHeightGraphBtns"},$e={key:0},Ee={key:1},Re={key:0,class:"graphBtn"},Ue={class:"dueAlert"},Be={class:"missed_vaccine_alert"},Ne={style:{"margin-right":"5px"}},We={class:"vaccinesTitle"},Ge={style:{width:"100%",display:"flex","justify-content":"space-between","align-content":"center"}},Le={class:"vaccinesTitleDate"},ze={class:"milestone"},je={style:{display:"flex","justify-content":"space-between","align-content":"center"}},xe={style:{color:"#636363","margin-left":"5px","margin-top":"-4px"}},Qe={style:{color:"#636363","font-weight":"bold","font-size":"14px"}},Je={class:"lastVaccine"},Ke={class:"lastVaccineTitle"},Ye={key:0,class:"lastVaccineText"},Xe={class:"seeFullList"},Ze={style:{color:"#316cba","margin-left":"1%"}},qe={class:"ion-padding",slot:"content"};function ts(t,e,n,m,V,K){var T,P,A,O,H,F,$,E,R,U,B,N,W,G,L,z,j,x;const h=l("ion-icon"),Y=l("WeightHeightChart"),X=l("PreviousVitals"),I=l("ion-button"),Z=l("ion-col"),q=l("ion-row"),tt=l("customSlider"),M=l("row"),et=l("customVaccine"),_=l("ion-label"),g=l("ion-item"),S=l("ion-accordion"),C=l("ion-toggle"),st=l("ion-list"),ot=l("ion-accordion-group"),it=l("ion-popover");return a(),d(Tt,null,[s("div",re,[s("div",le,[s("div",de,[s("div",ce,[s("div",pe,[s("div",{class:Mt(((P=(T=t.patient)==null?void 0:T.personInformation)==null?void 0:P.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor")},[o(h,{style:{color:"#fff","font-size":"100px"},icon:t.person},null,8,["icon"])],2)]),s("div",null,[s("div",ue,[s("div",me,c((O=(A=t.patient)==null?void 0:A.personInformation)==null?void 0:O.given_name)+" "+c((F=(H=t.patient)==null?void 0:H.personInformation)==null?void 0:F.middle_name)+" "+c((E=($=t.patient)==null?void 0:$.personInformation)==null?void 0:E.family_name),1)]),s("div",he,[s("div",ge,[r(c(((U=(R=t.patient)==null?void 0:R.personInformation)==null?void 0:U.gender)=="M"?"Male":"Female")+" ",1),e[12]||(e[12]=s("span",{class:"dot"},".",-1)),r(" "+c(t.getAge((N=(B=t.patient)==null?void 0:B.personInformation)==null?void 0:N.birthdate))+" ("+c(t.formatBirthdate())+") ",1)])]),(G=(W=t.patient)==null?void 0:W.personInformation)!=null&&G.current_district?(a(),d("div",ve,[e[13]||(e[13]=s("div",{class:"demographicsText"},"Current Address:",-1)),s("div",fe,c(t.formatCurrentAddress(t.patient)),1)])):u("",!0),(z=(L=t.patient)==null?void 0:L.personInformation)!=null&&z.country?(a(),d("div",_e,[e[14]||(e[14]=s("div",{class:"demographicsText"},"Country:",-1)),s("div",Se,c((x=(j=t.patient)==null?void 0:j.personInformation)==null?void 0:x.country),1)])):u("",!0),s("div",ye,[s("div",De,[e[15]||(e[15]=r(" MRN: ",-1)),s("span",ke,c(t.patient.ID),1)])]),s("div",we,[t.selectedStatus==7?(a(),d("div",Ve,e[16]||(e[16]=[r(" Outcome: ",-1),s("span",{class:"outcomeStatus"}," Active",-1)]))):u("",!0),t.selectedStatus==6?(a(),d("div",Ie,e[17]||(e[17]=[r(" Outcome: ",-1),s("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Inactive",-1)]))):u("",!0),t.selectedStatus==3?(a(),d("div",Ce,e[18]||(e[18]=[r(" Outcome: ",-1),s("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Died",-1)]))):u("",!0)]),s("div",be,[s("div",Me,[e[19]||(e[19]=r(" Status: ",-1)),t.protectedStatus=="No"?(a(),d("span",Te,"Unprotected at birth")):t.protectedStatus=="Yes"?(a(),d("span",Pe,"Protected at birth")):(a(),d("span",Ae,"Unknown protection at birth"))])])])])]),s("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:e[0]||(e[0]=p=>t.openPopover(p))},[o(h,{icon:t.ellipsisVerticalSharp},null,8,["icon"])])]),s("div",Oe,[s("div",null,[t.isChild()?(a(),y(Y,{key:0,checkUnderSixWeeks:t.checkUnderSixWeeks,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):u("",!0),t.isChild()?u("",!0):(a(),y(X,{key:1}))]),s("div",He,[s("div",Fe,[s("div",null,[o(I,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=p=>t.openWH())},{default:i(()=>[t.checkUnderSixWeeks?(a(),d("span",Ee," Enter Weight")):(a(),d("span",$e," Enter Weight/Height")),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteHeightWeight},null,8,["icon"])]),_:1})]),s("div",null,[o(I,{class:"btnText",fill:"solid",onClick:e[2]||(e[2]=p=>t.openVitalsModal())},{default:i(()=>[e[20]||(e[20]=r(" Enter Other Vitals ",-1)),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[20]})])])])]),s("div",null,[t.overDueVaccinesCount>0?(a(),d("div",Re,[s("div",Ue,[o(q,null,{default:i(()=>[t.overDueVaccinesCount>0?(a(),y(Z,{key:0,style:{display:"flex","justify-content":"center",cursor:"pointer"},onClick:t.showMissedVaccines},{default:i(()=>[s("div",Be,[o(h,{slot:"start",icon:t.iconsContent.alertDangerRed},null,8,["icon"]),s("span",Ne,c(t.overDueVaccinesCount)+" vaccine(s) overdue",1)])]),_:1},8,["onClick"])):u("",!0)]),_:1})])])):u("",!0),s("div",We,[s("div",Ge,[e[22]||(e[22]=s("div",{class:"vaccinesTitleText"},"Administer Vaccines",-1)),s("div",Le,[e[21]||(e[21]=s("span",{style:{"font-size":"13px"}},"Next Appt. Date: ",-1)),s("b",null,c(t.nextAppointMentDate),1)])])]),s("div",ze,[s("div",je,[o(h,{size:"small",icon:t.iconsContent.greenCalender},null,8,["icon"]),s("div",xe,[e[23]||(e[23]=r(" at ",-1)),s("span",Qe,c(t.current_milestone),1)])]),e[24]||(e[24]=s("div",{class:"vaccinesTitleDate"},"(Swipe left or right for other milestones)",-1))]),o(tt),s("div",Je,[s("div",Ke,[t.lastVaccinesGiven.length>0?(a(),d("div",Ye,"Last vaccines given")):u("",!0),s("div",Xe,[o(I,{onClick:e[3]||(e[3]=p=>t.openVH()),style:{color:"#016302"},class:"btnText btnTextWeight",size:"small",fill:"clear"},{default:i(()=>e[25]||(e[25]=[s("span",null,"See full History",-1)])),_:1,__:[25]})])]),t.lastVaccinesGiven.length>0?(a(),y(M,{key:0},{default:i(()=>[o(h,{size:"medium",style:{"margin-bottom":"-6px"},icon:t.iconsContent.calendar},null,8,["icon"]),s("span",Ze,c(t.getLastVaccinesGivenDisplayDate()),1)]),_:1})):u("",!0),t.lastVaccinesGiven.length>0?(a(),y(M,{key:1},{default:i(()=>[o(et,{vaccines:t.lastVaccinesGiven,milestone_status:""},null,8,["vaccines"])]),_:1})):u("",!0)])])]),o(it,{style:{"--offset-x":"-10px"},"is-open":t.popoverOpen,"show-backdrop":!1,event:t.event,onDidDismiss:e[11]||(e[11]=p=>t.popoverOpen=!1)},{default:i(()=>[s("div",null,[o(ot,{multiple:!0},{default:i(()=>[o(S,{value:"first","toggle-icon":"",onClick:e[4]||(e[4]=p=>t.openPIM())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(_,null,{default:i(()=>e[26]||(e[26]=[r("Update demographics",-1)])),_:1,__:[26]})]),_:1})]),_:1}),o(S,{value:"first","toggle-icon":"",onClick:e[5]||(e[5]=p=>t.openFollowModal())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(_,null,{default:i(()=>e[27]||(e[27]=[r("Follow up visits",-1)])),_:1,__:[27]})]),_:1})]),_:1}),o(S,{value:"second","toggle-icon":"",onClick:e[6]||(e[6]=p=>t.printVisitSummary())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(_,null,{default:i(()=>e[28]||(e[28]=[r("Print visit summary",-1)])),_:1,__:[28]})]),_:1})]),_:1}),o(S,{value:"third","toggle-icon":"",onClick:e[7]||(e[7]=p=>t.printID())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(_,null,{default:i(()=>e[29]||(e[29]=[r("Print client identifier",-1)])),_:1,__:[29]})]),_:1})]),_:1}),o(S,{value:"fourth"},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(_,null,{default:i(()=>e[30]||(e[30]=[r("Update outcome",-1)])),_:1,__:[30]})]),_:1}),s("div",qe,[o(st,null,{default:i(()=>[o(g,null,{default:i(()=>[o(C,{checked:t.selectedStatus==7,value:"active",onIonChange:e[8]||(e[8]=p=>t.updateState(7))},{default:i(()=>e[31]||(e[31]=[r(" Active ",-1)])),_:1,__:[31]},8,["checked"])]),_:1}),o(g,null,{default:i(()=>[o(C,{checked:t.selectedStatus==6,value:"inactive",onIonChange:e[9]||(e[9]=p=>t.updateState(6))},{default:i(()=>e[32]||(e[32]=[r(" Inactive ",-1)])),_:1,__:[32]},8,["checked"])]),_:1}),o(g,null,{default:i(()=>[o(C,{checked:t.selectedStatus==3,value:"died",onIonChange:e[10]||(e[10]=p=>t.updateState(3))},{default:i(()=>e[33]||(e[33]=[r(" Died ",-1)])),_:1,__:[33]},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])],64)}const zs=Lt(ae,[["render",ts],["__scopeId","data-v-029f1008"]]);export{zs as default};
