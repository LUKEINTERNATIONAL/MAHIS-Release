System.register(["./vendor-legacy-CCRc-I5f.js","./index-legacy-CPVrS3n3.js","./patient_registration_service-legacy-Bqy9aeCp.js","./relationship_service-legacy-Cd9hikrK.js","./relations_service-legacy-xtBCzRuX.js","./FollowUpStore-legacy-DVzzGvUs.js","./BirthRegistration-legacy-PCgP7Zax.js","./Stepper-legacy-pyUjhakX.js","./index-legacy-Ksed7qo4.js","./lodash-legacy-pOOc9Efu.js"],function(e,t){"use strict";var a,n,i,l,o,r,s,d,u,c,p,v,m,f,g,h,b,_,y,x,w,I,D,k,C,P,N,L,S,O,j,z,R,B,V,G,H,T,F,E,M,A,U,q,$,K,Q,W,X,J,Y,Z,ee,te,ae,ne,ie,le,oe,re,se,de,ue,ce,pe,ve,me,fe,ge,he,be,_e,ye,xe,we,Ie,De,ke,Ce,Pe,Ne,Le,Se,Oe,je,ze,Re,Be,Ve,Ge,He;return{setters:[e=>{a=e.d,n=e.al,i=e.av,l=e.c2,o=e.V,r=e.cv,s=e.cu,d=e.aA,u=e.ar,c=e.D,p=e.ab,v=e.ac,m=e.aq,f=e.I,g=e.U,h=e.T,b=e.au,_=e.bi,y=e.bj,x=e.S,w=e.ao,I=e.X,D=e.a$,k=e.cn,C=e.ds,P=e.br,N=e.dE,L=e.E,S=e.e,O=e.f,j=e.l,z=e.z,R=e.A,B=e.k,V=e.F,G=e.r,H=e.u,T=e.bf,F=e.W,E=e.bh,M=e.b1,A=e.aj,U=e.c,q=e.a,$=e.w,K=e.a8,Q=e.an,W=e.m,X=e.G,J=e.B,Y=e.aK,Z=e.aB,ee=e.aa,te=e.aT,ae=e.bv,ne=e.L,ie=e.dF,le=e.bc},e=>{oe=e.B,re=e.D,se=e.e,de=e.w,ue=e.z,ce=e.P,pe=e.u,ve=e.ax,me=e.y,fe=e.aa,ge=e.L,he=e.k,be=e.t,_e=e.ah,ye=e._,xe=e.a2,we=e.a0,Ie=e.g,De=e.a3,ke=e.S},e=>{Ce=e.P},e=>{Pe=e.R},e=>{Ne=e.R},e=>{Le=e.u},e=>{Se=e.B,Oe=e.S,je=e.H,ze=e.C,Re=e.G,Be=e.P},e=>{Ve=e.O},e=>{Ge=e.c,He=e.b},null],execute:function(){var t=document.createElement("style");t.textContent=".custom-dropdown .vs__selected-options[data-v-a10cb2a3],.custom-dropdown .vs__dropdown-option[data-v-a10cb2a3]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.custom-dropdown .vs__dropdown-menu[data-v-a10cb2a3]{max-height:150px;overflow-y:auto;background-color:red}.PI-cls-1[data-v-a10cb2a3]{cursor:pointer}.lbl-tl[data-v-a10cb2a3]{min-width:20px;color:#b3b3b3!important;white-space:nowrap}.form-row[data-v-a10cb2a3]{display:flex;align-items:center}.lbl-ct[data-v-a10cb2a3]{white-space:nowrap;color:#636363;flex:1}pim-cls-1[data-v-a10cb2a3]{--background: #ffff}.custom-toolbar-cls[data-v-a10cb2a3]{--background: #ffff}ion-footer[data-v-a10cb2a3]{--ion-toolbar-background: #fff}ion-modal[data-v-a10cb2a3]{--width: 94%;--height: 70%;--border-radius: 10px}.dashed-hr[data-v-a10cb2a3]{border:none;border-top:1px dashed #b3b3b3;margin:20px 0}.modal_wrapper[data-v-a10cb2a3]{padding:0 1px;background:#fff}.PI-cls-1[data-v-a10cb2a3]{color:rgba(31,34,33,.83)}.OtherVitalsTitle[data-v-a10cb2a3]{font-style:normal;font-weight:600;font-size:20px;color:#00190e}.OtherVitalsHeading[data-v-a10cb2a3]{display:flex;justify-content:center;margin:10px}ion-accordion[data-v-a10cb2a3]{margin-bottom:15px}ion-card[data-v-d3b9b80f]{margin:16px 0;border-radius:12px}.sub-menu-icon[data-v-d3b9b80f]{font-size:1.2rem}ion-item[data-v-d3b9b80f]{--padding-start: 8px;margin:8px 0}.current-ncd-item[data-v-d3b9b80f]{--background: var(--ion-color-success-tint);border-radius:8px;margin:8px 0;border-left:4px solid var(--ion-color-primary)}.current-ncd-item ion-label h2[data-v-d3b9b80f]{font-weight:600;color:var(--ion-color-primary)}.current-ncd-item ion-label p[data-v-d3b9b80f]{font-size:1.1em;margin-top:4px;color:var(--ion-color-dark)}.custom-input[data-v-d3b9b80f]{--padding-start: 0;font-size:1.5em}.prefix-container[data-v-d3b9b80f]{display:flex;align-items:center;height:100%}.prefix-part[data-v-d3b9b80f]{border:none;background:#f0f0f0;padding:0 8px;border-right:1px solid #ccc;color:var(--ion-color-dark);font-weight:600}.error-message[data-v-d3b9b80f]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;margin-top:8px;background-color:rgba(255,0,0,.1);border-radius:4px}.error-content[data-v-d3b9b80f]{display:flex;align-items:center;gap:8px}.close-button[data-v-d3b9b80f]{margin-left:auto}#container[data-v-777d67d0]{font-family:monospace;font-size:24px;overflow:hidden;padding:15px;width:594px}ul[data-v-777d67d0],ol[data-v-777d67d0]{list-style-type:none;padding-left:0;margin:0}\n/*$vite$:1*/",document.head.appendChild(t),e("u",function(){const e=G(le.isNativePlatform()),t=G([]),a=G(null),n=G(!1),i=G(null),l=pe().patient;return{isMobile:e,visits:t,event:a,popoverOpen:n,program:i,patient:l,openPopover:e=>{a.value=e,n.value=!0},openPIM:()=>{Ie($e,{class:"otherVitalsModal largeModal"})},openOutCome:()=>{Ie(Ye,{class:"large-modal-x10"})},printVisitSummary:async()=>{1==ke.getProgramID()?await He():32==ke.getProgramID()?await async function(){await Ge(Rt,{copies:1})}():(new De).printData("visit")},printID:()=>{(new De).printData("barcode")},formatCurrentAddress:e=>{var t,a,n;return[null==e||null===(t=e.personInformation)||void 0===t?void 0:t.current_district,null==e||null===(a=e.personInformation)||void 0===a?void 0:a.current_traditional_authority,null==e||null===(n=e.personInformation)||void 0===n?void 0:n.current_village].filter(Boolean).join(",")},openUpdateNCDNUmbers:()=>{Ie(ht,{class:"large-modal-x10"})}}});const Te=a({name:"Home",username:"",components:{IonContent:w,IonHeader:x,IonMenuButton:y,IonSearchbar:_,IonPage:b,IonTitle:h,IonToolbar:g,ToolbarSearch:ue,IonIcon:f,IonPopover:m,IonRow:v,IonCol:p,IonLabel:c,IonInput:u,IonDatetime:d,IonSelect:s,IonSelectOption:r,IonFooter:o,DynamicButton:de,BasicInputField:se,vSelect:l,VueMultiselect:i,DateInputField:re,BasicForm:oe,PersonalInformation:Be,GuardianInformation:Re,CurrentLocation:ze,HomeLocation:je,SocialHistory:Oe,BirthRegistration:Se},data:()=>({popoverOpen:!1}),computed:{...n(Le,["changeGuardianInfo","vaccineAdverseEffects","protectedAtBirth"]),...n(pe,["patient"]),...n(_e,["personInformation","socialHistory","homeLocation","currentLocation","guardianInformation"])},watch:{patient:{handler(){},immediate:!0}},setup:()=>({notificationsOutline:N,personCircleOutline:P,createOutline:C,clipboardOutline:k,calendarOutline:D}),methods:{handleCancel(){I.dismiss()},async saveDetails(){try{await this.updateDemographics(),await this.updateGuardian(),await this.updatePatientDemographics(),he("Successfully Updated Patient"),this.handleCancel()}catch(e){be("Failed to save details")}},async getRegion(e){let t=[];for(let a of[1,2,3]){if((a=1)&&(t=await ge.getDistricts(a)),t.some(t=>t.name.trim()===e))return"Central Region";if((a=2)&&(t=await ge.getDistricts(a)),t.some(t=>t.name.trim()===e))return"Northern Region";if((a=3)&&(t=await ge.getDistricts(a)),t.some(t=>t.name.trim()===e))return"Southern Region";if((a=4)&&(t=await ge.getDistricts(a)),t.some(t=>t.name.trim()===e))return"Foreign"}},async updateDemographics(){var e,t,a,n,i,l,o,r,s,d;const u={person_id:this.patient.patientID,given_name:me(this.personInformation,"firstname","value"),family_name:me(this.personInformation,"lastname","value"),middle_name:me(this.personInformation,"middleName","value"),gender:fe(this.personInformation,"gender"),birthdate:me(this.personInformation,"birthdate","value"),cell_phone_number:me(this.personInformation,"phoneNumber","value"),birthdate_estimated:!1,home_region:await this.getRegion(null===(e=me(this.homeLocation,"home_district","value"))||void 0===e?void 0:e.name),home_district:null===(t=me(this.homeLocation,"home_district","value"))||void 0===t?void 0:t.name,home_traditional_authority:null===(a=me(this.homeLocation,"home_traditional_authority","value"))||void 0===a?void 0:a.name,home_village:null===(n=me(this.homeLocation,"home_village","value"))||void 0===n?void 0:n.name,current_region:await this.getRegion(null===(i=me(this.currentLocation,"current_district","value"))||void 0===i?void 0:i.name),current_district:null===(l=me(this.currentLocation,"current_district","value"))||void 0===l?void 0:l.name,current_traditional_authority:null===(o=me(this.currentLocation,"current_traditional_authority","value"))||void 0===o?void 0:o.name,current_village:null===(r=me(this.currentLocation,"current_village","value"))||void 0===r?void 0:r.name,landmark:null===(s=me(this.currentLocation,"current_village","value"))||void 0===s?void 0:s.name,occupation:fe(this.socialHistory,"occupation"),religion:null===(d=me(this.socialHistory,"religion","value"))||void 0===d?void 0:d.name,marital_status:fe(this.socialHistory,"maritalStatus"),education_level:fe(this.socialHistory,"highestLevelOfEducation"),facility_name:"",patient_type:""};await this.updatePerson(this.patient.patientID,u)},async updateGuardian(){var e;let t={given_name:me(this.guardianInformation,"guardianFirstname","value"),family_name:me(this.guardianInformation,"guardianLastname","value"),middle_name:me(this.guardianInformation,"guardianMiddleName","value"),cell_phone_number:me(this.guardianInformation,"guardianPhoneNumber","value"),gender:"",birthdate:"",birthdate_estimated:!1,home_district:"",home_traditional_authority:"",home_village:"",current_district:"",current_traditional_authority:"",current_village:"",landmark:"",occupation:"",religion:"",marital_status:"",education_level:"",facility_name:"",patient_type:"",national_id:""},a=await Pe.getRelationships(this.patient.patientID);const n=null===(e=me(this.guardianInformation,"relationship","value"))||void 0===e?void 0:e.id;if(n)if(a.length>0){var i;const e=await Pe.getRelationships(this.patient.patientID);await Ne.amendRelation(this.patient.patientID,a[0].person_b,a[0].relationship_id,n),await this.updatePerson(null===(i=e[0])||void 0===i?void 0:i.person_b,t)}else{const e=new Ce;await e.registerGuardian(t);const a=e.getPersonID();await Ne.createRelation(this.patient.patientID,a,n)}},async updatePerson(e,t){const a=new ve(t);await a.update(e)},async updatePatientDemographics(){const e=await ce.findByID(this.patient.patientID);pe().setPatientRecord(e)},patientIdentifier(e){const t=e.patient_identifiers.length-1;return t>=0?e.patient_identifiers[t].identifier:""}}}),Fe={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},Ee={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},Me={class:""},Ae={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},Ue={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},qe={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},$e=e("p",ye(Te,[["render",function(e,t,a,n,i,l){const o=L("ion-title"),r=L("ion-header"),s=L("ion-label"),d=L("ion-item"),u=L("PersonalInformation"),c=L("ion-accordion"),p=L("GuardianInformation"),v=L("SocialHistory"),m=L("CurrentLocation"),f=L("HomeLocation"),g=L("ion-accordion-group"),h=L("ion-content"),b=L("ion-button"),_=L("ion-col"),y=L("DynamicButton"),x=L("ion-row"),w=L("ion-footer");return O(),S(V,null,[j(r,null,{default:z(()=>[j(o,{class:"modalTitle"},{default:z(()=>t[1]||(t[1]=[R("Edit Patient Demographics")])),_:1,__:[1]})]),_:1}),j(h,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:z(()=>[j(g,{ref:"accordionGroup",class:"previousView"},{default:z(()=>[j(c,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:z(()=>[j(d,{slot:"header",color:"light"},{default:z(()=>[j(s,{class:"previousLabel"},{default:z(()=>t[2]||(t[2]=[R("Personal information")])),_:1,__:[2]})]),_:1}),B("div",Fe,[j(u,{editable:!0})])]),_:1}),j(c,{value:"second","toggle-icon-slot":"start",class:"custom_card"},{default:z(()=>[j(d,{slot:"header",color:"light"},{default:z(()=>[j(s,{class:"previousLabel"},{default:z(()=>t[3]||(t[3]=[R("Guardian")])),_:1,__:[3]})]),_:1}),B("div",Ee,[B("div",Me,[j(p,{editable:!0})])])]),_:1}),j(c,{value:"third","toggle-icon-slot":"start",class:"custom_card"},{default:z(()=>[j(d,{slot:"header",color:"light"},{default:z(()=>[j(s,{class:"previousLabel"},{default:z(()=>t[4]||(t[4]=[R("Social history")])),_:1,__:[4]})]),_:1}),B("div",Ae,[j(v,{editable:!0})])]),_:1}),j(c,{value:"four","toggle-icon-slot":"start",class:"custom_card"},{default:z(()=>[j(d,{slot:"header",color:"light"},{default:z(()=>[j(s,{class:"previousLabel"},{default:z(()=>t[5]||(t[5]=[R("Current location")])),_:1,__:[5]})]),_:1}),B("div",Ue,[j(m,{editable:!0})])]),_:1}),j(c,{value:"five","toggle-icon-slot":"start",class:"custom_card"},{default:z(()=>[j(d,{slot:"header",color:"light"},{default:z(()=>[j(s,{class:"previousLabel"},{default:z(()=>t[6]||(t[6]=[R("Home location")])),_:1,__:[6]})]),_:1}),B("div",qe,[j(f,{editable:!0})])]),_:1})]),_:1},512),t[7]||(t[7]=B("hr",{class:"dashed-hr",style:{"margin-bottom":"0px !important"}},null,-1))]),_:1,__:[7]}),j(w,{collapse:"fade",class:"ion-no-border"},{default:z(()=>[j(x,null,{default:z(()=>[j(_,null,{default:z(()=>[j(b,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e.handleCancel},{default:z(()=>t[8]||(t[8]=[R(" Cancel ")])),_:1,__:[8]},8,["onClick"])]),_:1}),j(_,null,{default:z(()=>[j(y,{onClick:t[0]||(t[0]=t=>e.saveDetails()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}],["__scopeId","data-v-a10cb2a3"]])),Ke={style:{"font-weight":"400","font-size":"19px"}},Qe={style:{display:"flex","align-items":"center"}},We={class:""},Xe={class:"center text_12"},Je=a({watch:{},name:"xxxComponent"}),Ye=a({...Je,props:{is_open:{},user_id:{}},emits:["closePopoover","save"],setup(e,{emit:t}){G("");const a=t;return(e,t)=>(O(),S(V,null,[j(H(x),null,{default:z(()=>[j(H(g),null,{default:z(()=>[j(H(h),null,{default:z(()=>t[1]||(t[1]=[B("div",{style:{display:"flex","align-items":"center"}},[B("b",{style:{"margin-left":"6px"}},"Patient Outcome")],-1)])),_:1,__:[1]}),j(H(T),{slot:"end"},{default:z(()=>[j(H(h),null,{default:z(()=>[j(H(F),{onClick:t[0]||(t[0]=e=>(a("closePopoover",!1),void I.dismiss())),fill:"solid"},{default:z(()=>[B("span",Ke,[B("div",Qe,[j(H(f),{icon:H(E),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[2]||(t[2]=B("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),j(H(w),{class:"ion-padding"},{default:z(()=>[B("div",We,[B("div",Xe,[j(H(v),null,{default:z(()=>[j(H(p),null,{default:z(()=>[j(Ve)]),_:1})]),_:1})])])]),_:1}),j(H(o),null,{default:z(()=>[j(H(g))]),_:1})],64))}}),Ze={style:{display:"flex","align-items":"center"}},et={style:{"font-weight":"400","font-size":"19px"}},tt={style:{display:"flex","align-items":"center"}},at={style:{"font-weight":"600","font-size":"17px"}},nt={style:{"margin-top":"15px",width:"100%"}},it={key:0,class:"error-message"},lt={key:1},ot={slot:"start",class:"prefix-container"},rt=["value"],st={key:0,class:"error-message"},dt={style:{"font-size":"16px","font-weight":"600px",color:"red"}},ut={key:1},ct={style:{"font-weight":"400","font-size":"19px"}},pt={style:{display:"flex","align-items":"center"}},vt={style:{"font-weight":"400","font-size":"20px"}},mt={style:{display:"flex","align-items":"center"}},ft=a({name:"UpdateNCDNumberModal"}),gt=a({...ft,emits:["closePopoover","save"],setup(e,{emit:t}){const a=M(),n=pe(),{patient:i}=A(n),l=G(""),r=G(""),s=G(""),d=G(!1),p=new ce;let v=null;const m=e=>{const t=e.target.value.replace(/[^0-9]/g,"");t!==e.target.value&&(d.value=!0,v&&clearTimeout(v),v=window.setTimeout(()=>{d.value=!1,v=null},3e3),l.value=t)},b=()=>{d.value=!1,v&&(clearTimeout(v),v=null)},_=U(()=>l.value&&""!==l.value.trim()),y=async()=>{try{const e=await xe.getNextSuggestedNCDNumber(),t=e.ncd_number.replace(/^\D+|\s/g,""),a=e.ncd_number.replace(/\d+/g,"")+"-NCD-";l.value=t,r.value=a}catch(e){console.error("Error fetching suggested NCD number:",e),s.value="Failed to fetch suggested NCD number (missing SITE Prefix)"}};q(()=>{y()}),$(()=>i.value.ID,()=>{y()},{deep:!0});const D=t;function k(){D("closePopoover",!1),I.dismiss()}async function C(){try{if(s.value="",!_.value)return void(s.value="Please enter a valid NCD number");const e=`${r.value}${l.value}`,t=await ce.findByID(i.value.patientID);for(const a of t.patient_identifiers)31===a.identifier_type&&(await p.updateNCDNumber(a.patient_identifier_id,e),D("save",{newNcdId:e}));await we(i.value),k()}catch(e){console.error(e)}}return(e,t)=>(O(),S(V,null,[j(H(x),null,{default:z(()=>[j(H(g),null,{default:z(()=>[j(H(h),null,{default:z(()=>[B("div",Ze,[j(H(f),{icon:H(K),class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),t[3]||(t[3]=B("b",{style:{"margin-left":"6px"}},"Update NCD Number",-1))])]),_:1}),j(H(T),{slot:"end"},{default:z(()=>[j(H(h),null,{default:z(()=>[j(H(F),{onClick:t[0]||(t[0]=e=>k()),fill:"solid"},{default:z(()=>[B("span",et,[B("div",tt,[j(H(f),{icon:H(E),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[4]||(t[4]=B("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),j(H(w),{class:"ion-padding"},{default:z(()=>[j(H(Q),null,{default:z(()=>[j(H(X),{class:"current-ncd-item"},{default:z(()=>[j(H(c),null,{default:z(()=>[t[5]||(t[5]=B("h2",null,"Current NCD Number",-1)),B("p",at,J(H(i).NcdID||"Not assigned"),1)]),_:1,__:[5]})]),_:1}),j(H(X),null,{default:z(()=>[B("div",nt,[d.value?(O(),S("div",it,[j(H(f),{icon:H(Y),color:"danger"},null,8,["icon"]),t[6]||(t[6]=B("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),j(H(F),{fill:"clear",size:"small",onClick:b},{default:z(()=>[j(H(f),{icon:H(Z)},null,8,["icon"])]),_:1})])):W("",!0),s.value?W("",!0):(O(),S("div",lt,[t[7]||(t[7]=B("span",{style:{"font-weight":"600","font-size":"17px",color:"grey"}},"New NCD Number",-1)),j(H(u),{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),placeholder:"Enter number",inputmode:"numeric",pattern:"[0-9]*",onInput:m,class:"custom-input"},{default:z(()=>[B("div",ot,[B("input",{value:r.value,readonly:"",class:"prefix-part",type:"text"},null,8,rt)])]),_:1},8,["modelValue"])]))])]),_:1}),s.value?(O(),S("div",st,[j(H(ee),{color:"danger"},{default:z(()=>[B("span",dt,J(s.value),1)]),_:1})])):W("",!0),s.value?(O(),S("div",ut,[j(H(F),{onClick:t[2]||(t[2]=e=>function(e){try{console.log(e),a.push(e)}catch(t){console.error(t)}}("setSitePrefix")),fill:"solid",style:{margin:"14px"}},{default:z(()=>[B("span",ct,[B("div",pt,[j(H(f),{icon:H(te),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[8]||(t[8]=B("span",{style:{"margin-left":"6px"}},"set Site Prefix",-1))])])]),_:1})])):W("",!0)]),_:1})]),_:1}),j(H(o),null,{default:z(()=>[j(H(g),null,{default:z(()=>[j(H(T),{slot:"end"},{default:z(()=>[j(H(h),null,{default:z(()=>[j(H(F),{onClick:C,fill:"solid",disabled:!_.value},{default:z(()=>[B("span",vt,[B("div",mt,[j(H(f),{icon:H(ae),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[9]||(t[9]=B("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}}),ht=ye(gt,[["__scopeId","data-v-d3b9b80f"]]),bt={key:0,style:{display:"flex","justify-content":"space-between",width:"100%"}},_t={key:0},yt={key:1,style:{"font-weight":"bold",padding:"1.7px"}},xt={key:1,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},wt={key:0},It={key:1},Dt={key:2},kt={key:2},Ct={style:{display:"flex","flex-wrap":"wrap",gap:"8px",width:"100%"}},Pt={key:3,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},Nt={key:0},Lt={key:1},St={key:2},Ot={key:3},jt={key:4,style:{width:"100%","text-align":"center"}},zt={key:0},Rt=ye(a({__name:"ArtVisitLbl",props:{imageOut:{type:Object},patient:{type:Object}},emits:["label-out"],setup(e,{emit:t}){const a=t,n=G(null),i=G(0),l=e,o=U(()=>{var e;return null!==(e=l.patient)&&void 0!==e&&e.medications?l.patient.medications.filter(e=>e&&(e.name||e.dose||e.frequency||e.quantity)):[]}),r=U(()=>{var e,t;const a=null===(e=l.patient)||void 0===e?void 0:e.vitals;return a&&(a.height||a.weight||a.bloodPressure||(null===(t=l.patient)||void 0===t?void 0:t.bloodGlucose))}),s=U(()=>{const e=o.value;if(0===e.length)return[];if(0===i.value)return e.slice(0,2);{const t=2+4*(i.value-1);return e.slice(t,t+4)}});U(()=>{const e=o.value.length;if(e<=2)return!0;const t=e-2,a=Math.ceil(t/4);return i.value===a});const d=U(()=>{const e=o.value.length;if(e<=2)return 1;const t=e-2;return 1+Math.ceil(t/4)});return q(async()=>{try{const e=await(async()=>{const e=[];for(let a=0;a<d.value;a++){i.value=a,await new Promise(e=>setTimeout(e,100));try{const t=await ie.toPng(n.value,{height:300,width:594});e.push(t)}catch(t){console.error("Error generating image for page",a,t)}}return e})();a("label-out",e),"function"==typeof l.imageOut&&l.imageOut(e)}catch(e){console.error("Error generating patient labels:",e)}}),(t,a)=>{var l,o,d,u,c,p,v,m,f,g,h,b,_,y,x,w,I,D;return O(),S("div",{ref_key:"lblComponent",ref:n,id:"container"},[0===i.value&&(null!==(l=e.patient)&&void 0!==l&&l.latestVisitDate||null!==(o=e.patient)&&void 0!==o&&o.patientID)?(O(),S("div",bt,[null!==(d=e.patient)&&void 0!==d&&d.latestVisitDate?(O(),S("span",_t,[a[0]||(a[0]=B("b",null,"Visit:",-1)),R(" "+J(e.patient.latestVisitDate),1)])):W("",!0),null!==(u=e.patient)&&void 0!==u&&u.patientID?(O(),S("span",yt,J(e.patient.patientID),1)):W("",!0)])):W("",!0),0===i.value&&(null!==(c=e.patient)&&void 0!==c&&c.patientName||null!==(p=e.patient)&&void 0!==p&&p.gender||null!==(v=e.patient)&&void 0!==v&&v.diagnoses&&e.patient.diagnoses.length>0)?(O(),S("div",xt,[null!==(m=e.patient)&&void 0!==m&&m.patientName||null!==(f=e.patient)&&void 0!==f&&f.gender?(O(),S("span",wt,[B("b",null,J(null===(g=e.patient)||void 0===g?void 0:g.patientName)+J(null!==(h=e.patient)&&void 0!==h&&h.gender?`(${e.patient.gender})`:""),1)])):W("",!0),null!==(b=e.patient)&&void 0!==b&&b.prescriber?(O(),S("span",It,[a[1]||(a[1]=B("b",null,"Seen by:",-1)),R(J(e.patient.prescriber),1)])):W("",!0),null!==(_=e.patient)&&void 0!==_&&_.nextAppointment?(O(),S("span",Dt,[a[2]||(a[2]=B("b",null,"Nxt App:",-1)),R(" "+J(e.patient.nextAppointment),1)])):W("",!0)])):W("",!0),0===i.value&&null!==(y=e.patient)&&void 0!==y&&y.diagnoses&&e.patient.diagnoses.length>0?(O(),S("div",kt,[B("span",Ct,[a[3]||(a[3]=B("b",null,"Diagnoses:",-1)),R(" "+J(e.patient.diagnoses.filter(e=>e).join(", ")),1)])])):W("",!0),0===i.value&&r.value?(O(),S("div",Pt,[null!==(x=e.patient)&&void 0!==x&&null!==(x=x.vitals)&&void 0!==x&&x.height?(O(),S("span",Nt,J(e.patient.vitals.height),1)):W("",!0),null!==(w=e.patient)&&void 0!==w&&null!==(w=w.vitals)&&void 0!==w&&w.weight?(O(),S("span",Lt,J(e.patient.vitals.weight),1)):W("",!0),null!==(I=e.patient)&&void 0!==I&&null!==(I=I.vitals)&&void 0!==I&&I.bloodPressure?(O(),S("span",St,J(e.patient.vitals.bloodPressure),1)):W("",!0),null!==(D=e.patient)&&void 0!==D&&D.bloodGlucose?(O(),S("span",Ot,J(e.patient.bloodGlucose),1)):W("",!0)])):W("",!0),s.value.length>0?(O(),S("table",jt,[0===i.value?(O(),S("thead",zt,a[4]||(a[4]=[B("tr",null,[B("th",null,"Drug"),B("th",null,"Dose"),B("th",null,"Freq"),B("th",null,"Qty")],-1)]))):W("",!0),B("tbody",null,[(O(!0),S(V,null,ne(s.value,(e,t)=>(O(),S("tr",{key:t},[B("td",null,J((null==e?void 0:e.name)||""),1),B("td",null,J((null==e?void 0:e.dose)||""),1),B("td",null,J((null==e?void 0:e.frequency)||""),1),B("td",null,J((null==e?void 0:e.quantity)||""),1)]))),128))])])):W("",!0)],512)}}}),[["__scopeId","data-v-777d67d0"]])}}});
