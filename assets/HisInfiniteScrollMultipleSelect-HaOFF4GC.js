import{Q as v,V as F}from"./ReportMixin.vue_vue_type_script_lang-CxIxjtmR.js";import{H as T,k as E}from"./KbHandler-BuFiDxS2.js";import P from"./BaseTextInput-C52zEpw5.js";import{_ as M}from"./FieldMixin.vue_vue_type_script_lang-Bl-OspwT.js";import{d as O,eL as Q,eM as U,b1 as q,a1 as z,ab as A,a8 as J,br as R,aN as W,bo as Y,H as s,e as k,f as a,l,N as r,m as b,J as n,F as _,O as w,P as y,K as g,k as I,p as D}from"./vendor-f_p5GZUu.js";import{cd as j,_ as G}from"./index-CDuiH1EP.js";import"./lodash-NJiRuGo9.js";import"./Export-CaNsT9FT.js";import"./apexcharts-Db13O_GS.js";const X=O({name:"HisInfiniteScrollMultipleSelect",mixins:[M],components:{IonCheckbox:Y,IonText:W,IonChip:R,ViewPort:F,HisTextInput:P,IonContent:J,IonList:A,IonItem:z,IonLabel:q,HisKeyboard:T,IonInfiniteScroll:U,IonInfiniteScrollContent:Q},data:()=>({showKeyboard:!1,keyboard:v,listData:[],checkedItems:[],disableScroll:!1,filter:"",selected:"",page:1,limit:10}),watch:{clear(){this.checkedItems=[],this.filter="",this.selected=""},checkedItems:{handler(e){this.listData.forEach(t=>{e.find(o=>o.value===t.value)?t.isChecked=!0:t.isChecked=!1}),this.$emit("onValue",e)},deep:!0,immediate:!0},filter:{async handler(){this.page=1,this.disableScroll=!1;const e=await this.getListData();[...this.checkedItems].forEach(t=>{const o=e.findIndex(c=>c.value===t.value);o===-1?e.push(t):e[o].isChecked=!0}),this.listData=e}}},mounted(){this.init()},activated(){this.init()},methods:{async init(){this.$emit("onFieldActivated",this),this.listData=await this.getListData()},async getListData(){return await this.options(this.fdata,this.filter,this.page,this.limit)},async keypress(e){this.filter||(this.selected=""),this.filter=E(e,this.selected),this.selected=this.filter},async onKBValue(e){!this.listData||this.selected===e||(this.filter=e,this.selected=this.filter)},async pushData(e){this.page++;const t=await this.getListData();t.length>0?this.listData=j([...this.listData,...t.filter(o=>!this.listData.find(c=>c.value===o.value))],"label"):this.disableScroll=!0,e.target.complete()},onSelect(e){this.$nextTick(async()=>{e.isChecked?this.checkedItems.findIndex(t=>t.value===e.value)===-1&&this.checkedItems.push(e):this.unCheck(e)})},unCheck(e){this.checkedItems=this.checkedItems.filter(t=>t.value!==e.value)}},created(){var e,t,o,c,m,p,h,u;this.showKeyboard=(t=(e=this.config)==null?void 0:e.showKeyboard)!=null?t:!1,this.keyboard=(c=(o=this.config)==null?void 0:o.keyboard)!=null?c:v,this.page=(p=(m=this.config)==null?void 0:m.page)!=null?p:1,this.limit=(u=(h=this.config)==null?void 0:h.limit)!=null?u:10}});function Z(e,t,o,c,m,p){const h=s("his-text-input"),u=s("ion-chip"),C=s("ion-text"),S=s("ion-label"),V=s("ion-checkbox"),K=s("ion-item"),$=s("ion-list"),L=s("ion-infinite-scroll-content"),x=s("ion-infinite-scroll"),B=s("ion-content"),H=s("view-port"),N=s("his-keyboard");return a(),k(_,null,[l(H,{showFull:!e.showKeyboard},{default:n(()=>[e.showKeyboard?(a(),r(h,{key:0,value:e.selected,onOnValue:e.onKBValue},null,8,["value","onOnValue"])):b("",!0),(a(!0),k(_,null,w(e.checkedItems,(i,f)=>(a(),r(u,{color:"danger",key:f,onClick:d=>e.unCheck(i)},{default:n(()=>[y(g(i.label),1)]),_:2},1032,["onClick"]))),128)),l(B,{style:{width:"100%"},class:"ion-padding-bottom"},{default:n(()=>[I("div",{class:D(["ion-content-scroll-host",{"ion-margin-bottom ion-padding-bottom":e.disableScroll}])},[l($,{class:D(["view-port-content",{"ion-margin-bottom":e.disableScroll}])},{default:n(()=>[(a(!0),k(_,null,w(e.listData,(i,f)=>(a(),r(K,{key:f,color:i.isChecked?"lightblue":"",lines:i.isChecked?"none":""},{default:n(()=>[l(S,null,{default:n(()=>{var d;return[l(C,{class:"his-md-text"},{default:n(()=>[y(g(i.label),1)]),_:2},1024),i.description&&i.isChecked?(a(),r(C,{key:0,color:(d=i.description)==null?void 0:d.color},{default:n(()=>[I("p",null,[I("i",null,g(i.description.text),1)])]),_:2},1032,["color"])):b("",!0)]}),_:2},1024),l(V,{slot:"start",modelValue:i.isChecked,"onUpdate:modelValue":d=>i.isChecked=d,onIonChange:d=>e.onSelect(i),disabled:i.disabled},null,8,["modelValue","onUpdate:modelValue","onIonChange","disabled"])]),_:2},1032,["color","lines"]))),128))]),_:1},8,["class"]),l(x,{onIonInfinite:t[0]||(t[0]=i=>e.pushData(i)),threshold:"100px",disabled:e.disableScroll},{default:n(()=>[l(L,{"loading-spinner":"crescent","loading-text":"Loading more data..."})]),_:1},8,["disabled"])],2)]),_:1})]),_:1},8,["showFull"]),e.showKeyboard?(a(),r(N,{key:0,kbConfig:e.keyboard,onKeyPress:e.keypress},null,8,["kbConfig","onKeyPress"])):b("",!0)],64)}const de=G(X,[["render",Z]]);export{de as default};
