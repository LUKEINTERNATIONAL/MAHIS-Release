import{d as Z,af as Te,G as ot,E as it,ag as lt,ab as Be,a1 as Q,I as rt,a8 as ct,_ as Ye,$ as ut,H as J,e as i,f as a,k as t,l as o,aT as xe,r as l,c as Y,a as De,m as S,N as F,J as h,u as m,P as B,F as q,M as ae,a0 as Le,e6 as an,b5 as dt,e7 as sn,cX as on,e8 as ln,e9 as rn,ea as cn,eb as un,d0 as dn,ec as mn,bM as pn,ap as mt,at as vn,bU as fn,ar as pt,aI as hn,K as E,O as z,w as ce,ai as ze,ah as fe,b1 as le,bp as ie,a9 as gn,Q as _n,p as Ne,bg as We,a2 as yn,bi as bn,a7 as Dn,bS as Sn,bE as wn,aa as nt}from"./vendor-BgyWXnfw.js";import{bd as Re,H as be,ad as j,bf as vt,be as ft,aW as ht,u as Ie,_ as ue,k as Ee,au as $e,av as Fe,G as ke,J as we,S as ye,aN as X,t as re,M as Pe,aH as se,aI as gt,bB as kn,bC as xn,a_ as In,ba as ge,a$ as _e,bD as Cn,aK as An,P as En,aO as at,aU as Pn,s as On,aC as Ae,aD as Nn,ao as $n}from"./index-CxGHJaHZ.js";import{l as he}from"./lodash-NJiRuGo9.js";import{P as Mn}from"./patient_complaints_service-R_GlMQ8P.js";import{D as _t}from"./DashBox-1zKTdqIP.js";import{u as Ln}from"./useExposeFromStandardForm-_YqfZlCM.js";import{B as je}from"./BasicForm-nb0Mbnpk.js";import{f as Ke,c as yt,a as bt}from"./formatServerData-ydELwKJW.js";import{A as Tn,P as Fn,D as Bn,m as Rn}from"./NextAppointment-B_gMrwsl.js";import{D as Vn,b as Hn}from"./drug_prescription_service-Bq6rpi9v.js";import{D as st}from"./drug_service-CzW2ci1N.js";import{D as Un,A as qn,R as Gn,a as Wn}from"./Outcome-BWxf5kxD.js";const zn=Z({name:"Menu",components:{IonContent:ct,IonHeader:rt,IonItem:Q,IonList:Be,IonMenu:lt,IonTitle:it,IonToolbar:ot,List:Re},computed:{...Te(Ie,["patient"]),...Te(ht,["presentingComplaints"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:ft(["#006401"]),listIcon:vt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:ut,pulseOutline:Ye}},watch:{$router:{async handler(){await this.updateList()},immediate:!0,deep:!0},patient:{async handler(){await this.updateList()},deep:!0}},async mounted(){await this.updateList()},methods:{async updateList(){const e=await j.getAll(this.patient.patientID,"Presenting complaint"),n=he.isEmpty(e)?[]:Promise.all(e.map(async c=>c.value_coded?{name:await j.getConceptName(c.value_coded),obs_date:c.obs_datetime,duration:c.children[0].value_text}:[]));this.setListData(await n)},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 20px;",containSize:4,display:["Date","Presenting Complains","Duration"]}),e.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height:20px;",class:"col_background",containSize:4,display:[be.toStandardHisFormat(n.obs_date),n.name,n.duration]})})}}}),Yn={class:"modal_wrapper"};function jn(e,n,c,p,b,x){const v=J("list");return a(),i("div",Yn,[t("div",null,[o(v,{listData:e.list},null,8,["listData"])])])}const Kn=ue(zn,[["render",jn],["__scopeId","data-v-30434e22"]]),Xn={key:0},Jn={style:{"align-content":"center"}},Qn={class:"ion-padding",slot:"content"},Zn=Z({__name:"PresentingComplaints",setup(e,{expose:n}){const c=ht(),{presentingComplaints:p}=xe(c),b=l(Ee),x=l(!0),v=l(!1),g=l(!0),w=l(!1),u=l([]),y=l([]),d=l(),R=Y(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:Ee.search,hideSelected:!0,validation:I=>L(I==null?void 0:I.name,u.value)?"Presenting complaint already added":$e.required(I),options:y.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:Ee.time,validation:I=>$e.isNotEmptyandNumber(I),grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:I=>!I||I===""?"Please select a unit.":null},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:Ee.editPen,validation:I=>L(I,u.value)?"Presenting complaint already added":$e.required(I),condition:I=>{var M;return((M=I==null?void 0:I.PresentingComplaints)==null?void 0:M.name)==="Other"}},{componentType:"Alert",condition:I=>{var M;return $e.required((M=I==null?void 0:I.PresentingComplaints)==null?void 0:M.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:r}=Ln(),k=async()=>{y.value=await Mn.getComplaintsList("Presenting complaint"),we(p.value,"PresentingComplaints","multiSelectData",y.value)},A=()=>{x.value=!1,g.value=!1,v.value=!0},P=async()=>{var N,s;const I=(N=r.value)==null?void 0:N.getFormValues();((s=r.value)==null?void 0:s.validateForm())==null&&(O(I),v.value=!1,g.value=!0)},O=I=>{var D;const M=I.duration+" "+I.duration_unit,N=I.PresentingComplaints,s=N.name==="Other"?I["Other (specify)"]:N.name;u.value.push({actionBtn:!0,btn:["delete"],name:s,concept_id:N.concept_id,duration:N.duration,durationUnits:N.duration_unit,display:[s,M],data:[{concept_id:8578,value_coded:N.concept_id,obs_datetime:ye.getSessionDate(),child:[{concept_id:N.concept_id,value_text:M,obs_datetime:ye.getSessionDate()}]}]}),(D=r.value)==null||D.resetForm(),w.value=!0},L=(I,M)=>M.some(N=>N.name===I),$=I=>{u.value=u.value.filter(M=>M.display[0]!==I.name)},H=async()=>{const I=await j.getObsByEncounterIdAndDate(X.PRESENTING_COMPLAINTS),M=u.value.flatMap(N=>N.data);if(M.length<=0&&I.length<=0)return re("Presenting complaints is required");M.length<=0||(await j.addObsToEncounterPatient(M,X.PRESENTING_COMPLAINTS),Pe("Presenting complaints saved successful"),u.value=[])};return De(async()=>{await k()}),n({onSubmit:H}),(I,M)=>{const N=J("ion-row"),s=J("ion-label"),D=J("ion-accordion"),T=J("ion-accordion-group");return a(),i(q,null,[o(_t,{status:x.value,content:"No presenting complaints added"},null,8,["status"]),w.value?(a(),i("span",Xn,[o(Re,{listData:u.value,"onClicked:delete":$},null,8,["listData"])])):S("",!0),v.value?(a(),F(N,{key:1},{default:h(()=>[o(Fe,{formData:R.value,ref_key:"formRef",ref:r},null,8,["formData"]),t("div",Jn,[o(ke,{fill:"clear",icon:b.value.plus,iconSlot:"icon-only","onClicked:btn":M[0]||(M[0]=G=>P()),name:"Save"},null,8,["icon"])])]),_:1})):S("",!0),g.value?(a(),F(N,{key:2,style:{"margin-top":"10px"}},{default:h(()=>[o(ke,{fill:"clear",icon:b.value.plus,iconSlot:"icon-only","onClicked:btn":M[1]||(M[1]=G=>A()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):S("",!0),o(N,null,{default:h(()=>[o(T,{ref_key:"accordionGroup",ref:d,class:"previousView"},{default:h(()=>[o(D,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(s,{class:"previousLabel"},{default:h(()=>M[2]||(M[2]=[B("Previous presenting complaints",-1)])),_:1,__:[2]})]),_:1}),t("div",Qn,[o(Kn)])]),_:1})]),_:1},512)]),_:1})],64)}}}),ea=ue(Zn,[["__scopeId","data-v-a95bcc0f"]]),ta=Y(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Spontaneously",value:"Spontaneously"},{label:"To speech",value:"To speech"},{label:"To pain",value:"To pain"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Oriented to time, place and person",value:"Oriented to time, place and person"},{label:"Confused",value:"Confused"},{label:"Inappropriate words",value:"Inappropriate words"},{label:"Incomprehensible sounds",value:"Incomprehensible sounds"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Obeys commands",value:"Obeys commands"},{label:"Moves to localised pain",value:"Moves to localised pain"},{label:"Flexion withdrawal from pain",value:"Flexion withdrawal from pain"},{label:"Abnormal flexion (decorticate)",value:"Abnormal flexion (decorticate)"},{label:"Abnormal extension (decerebrate)",value:"Abnormal extension (decerebrate)"},{label:"No response",value:"No response"}]}]),na=Y(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Directed eye movements",value:"Directed eye movements"},{label:"Not directed",value:"Not directed"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Appropriate cry",value:"Appropriate cry"},{label:"Inappropriate cry or moan",value:"Inappropriate cry or moan"},{label:"No cry",value:"No cry"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Localizes pain",value:"Localizes pain"},{label:"Withdraws from pain",value:"Withdraws from pain"},{label:"Non specific or no response",value:"Non specific or no response"}]}]),Dt={Spontaneously:4,"To speech":3,"To pain":2,"No response":1},St={"Oriented to time, place and person":5,Confused:4,"Inappropriate words":3,"Incomprehensible sounds":2,"No response":1},wt={"Obeys commands":6,"Moves to localised pain":5,"Flexion withdrawal from pain":4,"Abnormal flexion (decorticate)":3,"Abnormal extension (decerebrate)":2,"No response":1},kt={"Not directed":0,"Directed eye movements":1},xt={"Non specific or no response":0,"Withdraws from pain":1,"Localizes pain":2},It={"No cry":0,"Inappropriate cry or moan":1,"Appropriate cry":2},aa=Z({name:"VisitHistory",components:{IonIcon:Le,IonButton:ae},setup(){const e=gt();return{selectedAllergiesList2:Y(()=>e.selectedMedicalAllergiesList),calendarOutline:hn,alertCircleOutline:pt,documentTextOutline:fn,femaleOutline:vn,medicalOutline:mt,warningOutline:pn,bodyOutline:mn,eyeOutline:dn,nutritionOutline:un,fitnessOutline:cn,pulseOutline:Ye,earOutline:rn,happyOutline:ln,manOutline:on,moveOutline:sn,addOutline:dt,scanOutline:an}},data(){return{visits:[],visitDate:null,presentingComplaint:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},eyesAbnormal:[],mouthAbnormal:[],earsAbnormal:[],faceAbnormal:[],neckAbnormal:[],chestAbnormal:[],chestMovementAbnormal:[],heartSoundsAbnormal:[],breathSoundsAbnormal:[],addedBreathSoundsAbnormal:[],abdominalInspectionAbnormal:[],eyesExamined:!1,mouthExamined:!1,earsExamined:!1,faceExamined:!1,neckExamined:!1,chestExamined:!1,chestMovementExamined:!1,heartSoundsExamined:!1,breathSoundsExamined:!1,addedBreathSoundsExamined:!1,abdominalInspectionExamined:!1}},computed:{...Te(Ie,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var e;return((e=this.uniquePresentingComplaints)==null?void 0:e.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var e;return((e=this.uniquePastMedicalHistory)==null?void 0:e.length)>0},hasAllergies(){var e,n;return((n=(e=this.selectedAllergiesList2)==null?void 0:e.filter(c=>c.selected))==null?void 0:n.length)>0},hasPhysicalExam(){var e,n,c,p,b,x,v,g,w,u,y;return((e=this.eyesAbnormal)==null?void 0:e.length)>0||this.eyesExamined||((n=this.mouthAbnormal)==null?void 0:n.length)>0||this.mouthExamined||((c=this.earsAbnormal)==null?void 0:c.length)>0||this.earsExamined||((p=this.faceAbnormal)==null?void 0:p.length)>0||this.faceExamined||((b=this.neckAbnormal)==null?void 0:b.length)>0||this.neckExamined||((x=this.chestAbnormal)==null?void 0:x.length)>0||this.chestExamined||((v=this.chestMovementAbnormal)==null?void 0:v.length)>0||this.chestMovementExamined||((g=this.heartSoundsAbnormal)==null?void 0:g.length)>0||this.heartSoundsExamined||((w=this.breathSoundsAbnormal)==null?void 0:w.length)>0||this.breathSoundsExamined||((u=this.addedBreathSoundsAbnormal)==null?void 0:u.length)>0||this.addedBreathSoundsExamined||((y=this.abdominalInspectionAbnormal)==null?void 0:y.length)>0||this.abdominalInspectionExamined},uniquePastMedicalHistory(){return[...new Map(this.pastMedicalHistory.map(e=>[e,e])).values()]},uniquePresentingComplaints(){return[...new Map(this.presentingComplaint.map(e=>[e,e])).values()]},isMinor(){var e,n;return be.getAgeInYears((n=(e=this.patient)==null?void 0:e.personInformation)==null?void 0:n.birthdate)<18},gcsScore(){var g,w,u;if(!this.hasLevelOfConsciousness)return null;const e=this.levelOfConsciousness.eyeResponse,n=this.levelOfConsciousness.motorResponse,c=this.levelOfConsciousness.verbalResponse,p=(g=(this.isMinor?kt:Dt)[e])!=null?g:0,b=(w=(this.isMinor?xt:wt)[n])!=null?w:0,x=(u=(this.isMinor?It:St)[c])!=null?u:0,v=p+b+x;return"(M ".concat(b," V ").concat(x," E ").concat(p,") ").concat(v,"/").concat(this.isMinor?5:15)}},methods:{formatVisitDate(e){return e?be.toStandardHisDisplayFormat(e):"No visit date"},async updateData(){var e;(e=this.patient)!=null&&e.patientID&&(await this.loadPresentingComplaints(),await this.loadPastMedicalHistory(),await this.loadLevelOfConsciousness(),await this.loadPregnancyStatus(),await this.loadPhysicalExam())},async loadPresentingComplaints(){try{const e=await j.getObsByEncounterIdAndDate(X.PRESENTING_COMPLAINTS);this.presentingComplaint=await this.getConceptValues(this.filterObs(e,"Presenting complaint"),"coded")}catch(e){console.error("Error loading presenting complaints:",e)}},async loadPastMedicalHistory(){try{const e=await j.getObsByEncounterIdAndDate(X.PAST_MEDICAL_HISTORY);this.pastMedicalHistory=await this.getConceptValues(this.filterObs(e,"Chronic disease"),"coded")}catch(e){console.error("Error loading past medical history:",e)}},async loadLevelOfConsciousness(){try{const e=await j.getObsByEncounterIdAndDate(X.ASSESSMENT);if(e&&Array.isArray(e)){const n=this.filterObs(e,"Eye opening response");this.levelOfConsciousness.eyeResponse=n.length>0?await se.getConceptName(n[0].value_coded):null;const c=this.filterObs(e,"Best verbal response");this.levelOfConsciousness.verbalResponse=c.length>0?await se.getConceptName(c[0].value_coded):null;const p=this.filterObs(e,"Best motor response");this.levelOfConsciousness.motorResponse=p.length>0?await se.getConceptName(p[0].value_coded):null}}catch(e){console.error("Error loading level of consciousness:",e)}},async loadPregnancyStatus(){try{const e=await j.getObsByEncounterIdAndDate(X.PREGNANCY_STATUS);if(e&&Array.isArray(e)){const n=this.filterObs(e,"Patient pregnant");this.pregnancy.patientPregnant=n.length>0?await se.getConceptName(n[0].value_coded):null;const c=this.filterObs(e,"Is patient breast feeding?");this.pregnancy.breastFeeding=c.length>0?await se.getConceptName(c[0].value_coded):null}}catch(e){console.error("Error loading pregnancy status:",e)}},async loadPhysicalExam(){try{const e=await j.getObsByEncounterIdAndDate(X.PHYSICAL_EXAMINATION);await this.processPhysicalExamObservations(e)}catch(e){console.error("Error loading physical exam:",e)}},filterObs(e,n){return e?e.filter(c=>{var p,b;return((b=(p=c.concept)==null?void 0:p.concept_names)==null?void 0:b.some(x=>x.name===n))||c.concept_name===n}):[]},async getConceptValues(e,n){return e?await Promise.all(e.map(async c=>c.value_coded?await se.getConceptName(c.value_coded):c.concept_name||c.name)):[]},async processPhysicalExamObservations(e){var n,c,p,b,x,v,g,w;if(!(!e||!Array.isArray(e))){this.eyesAbnormal=[],this.mouthAbnormal=[],this.earsAbnormal=[],this.faceAbnormal=[],this.neckAbnormal=[],this.chestAbnormal=[],this.chestMovementAbnormal=[],this.heartSoundsAbnormal=[],this.breathSoundsAbnormal=[],this.addedBreathSoundsAbnormal=[],this.abdominalInspectionAbnormal=[],this.eyesExamined=!1,this.mouthExamined=!1,this.earsExamined=!1,this.faceExamined=!1,this.neckExamined=!1,this.chestExamined=!1,this.chestMovementExamined=!1,this.heartSoundsExamined=!1,this.breathSoundsExamined=!1,this.addedBreathSoundsExamined=!1,this.abdominalInspectionExamined=!1;for(const u of e){if(!u.concept_name&&!((n=u.concept)!=null&&n.concept_names))continue;const y=u.concept_name||((b=(p=(c=u.concept)==null?void 0:c.concept_names)==null?void 0:p.find(d=>d.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:b.name);y&&(y.includes("normal")||y.includes("Normal"))&&u.value_coded===1065&&(y.includes("Eyes normal")?this.eyesExamined=!0:y.includes("Mouth normal")?this.mouthExamined=!0:y.includes("Ears normal")?this.earsExamined=!0:y.includes("Face normal")?this.faceExamined=!0:y.includes("Neck normal")?this.neckExamined=!0:y.includes("Chest inspection normal")?this.chestExamined=!0:y.includes("Heart sounds normal")?this.heartSoundsExamined=!0:y.includes("Breath sounds normal")?this.breathSoundsExamined=!0:y.includes("Abdominal inspection normal")&&(this.abdominalInspectionExamined=!0))}for(const u of e){if(!u.concept_name&&!((x=u.concept)!=null&&x.concept_names))continue;const y=u.concept_name||((w=(g=(v=u.concept)==null?void 0:v.concept_names)==null?void 0:g.find(d=>d.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:w.name);if(y&&!(y.includes("normal")||y.includes("Normal"))){if(y.includes("Abnormality for eyes"))if(this.eyesExamined=!0,u.value_coded){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.eyesAbnormal.push(d)}else u.value_text&&this.eyesAbnormal.push(u.value_text);else if(y.includes("Abnormality for mouth"))if(this.mouthExamined=!0,u.value_coded){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.mouthAbnormal.push(d)}else u.value_text&&this.mouthAbnormal.push(u.value_text);else if(y.includes("Abnormality for ears"))if(this.earsExamined=!0,u.value_coded){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.earsAbnormal.push(d)}else u.value_text&&this.earsAbnormal.push(u.value_text);else if(y.includes("Abnormality for face"))if(this.faceExamined=!0,u.value_coded){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.faceAbnormal.push(d)}else u.value_text&&this.faceAbnormal.push(u.value_text);else if(y.includes("Abnormality for neck"))if(this.neckExamined=!0,u.value_coded){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.neckAbnormal.push(d)}else u.value_text&&this.neckAbnormal.push(u.value_text);else if(y.includes("Abnormality for chest")&&(this.chestExamined=!0,u.value_coded)){const d=await se.getConceptName(u.value_coded);d&&d.toLowerCase()!=="no"&&d.toLowerCase()!=="normal"&&this.chestAbnormal.push(d)}}}}}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),sa={class:"visit-container"},oa={class:"visit-sections"},ia={key:0,class:"visit-section"},la={class:"section-header"},ra={class:"section-content"},ca={key:0,class:"info-item"},ua={class:"info-value"},da={key:1,class:"info-item"},ma={class:"info-value"},pa={key:2,class:"info-item"},va={class:"info-value"},fa={key:3,class:"info-item"},ha={class:"info-value highlight"},ga={key:1,class:"visit-section"},_a={class:"section-header"},ya={class:"tags-container"},ba={key:2,class:"visit-section"},Da={class:"section-header"},Sa={class:"section-content"},wa={key:0,class:"info-item"},ka={class:"info-value highlight"},xa={key:1,class:"info-item"},Ia={class:"info-value highlight"},Ca={key:3,class:"visit-section"},Aa={class:"section-header"},Ea={class:"tags-container"},Pa={key:4,class:"visit-section"},Oa={class:"section-header"},Na={class:"tags-container"},$a={key:0,class:"allergy-tag"},Ma={key:5,class:"visit-section"},La={class:"section-header"},Ta={class:"exam-section"},Fa={key:0,class:"exam-category"},Ba={class:"exam-category-header"},Ra={class:"exam-items"},Va={key:1,class:"exam-category normal"},Ha={class:"exam-category-header"},Ua={key:2,class:"exam-category"},qa={class:"exam-category-header"},Ga={class:"exam-items"},Wa={key:3,class:"exam-category normal"},za={class:"exam-category-header"},Ya={key:4,class:"exam-category"},ja={class:"exam-category-header"},Ka={class:"exam-items"},Xa={key:5,class:"exam-category normal"},Ja={class:"exam-category-header"},Qa={key:6,class:"exam-category"},Za={class:"exam-category-header"},es={class:"exam-items"},ts={key:7,class:"exam-category normal"},ns={class:"exam-category-header"},as={key:8,class:"exam-category"},ss={class:"exam-category-header"},os={class:"exam-items"},is={key:9,class:"exam-category normal"},ls={class:"exam-category-header"},rs={key:10,class:"exam-category"},cs={class:"exam-category-header"},us={class:"exam-items"},ds={key:11,class:"exam-category normal"},ms={class:"exam-category-header"},ps={key:12,class:"exam-category"},vs={class:"exam-category-header"},fs={class:"exam-items"},hs={key:13,class:"exam-category normal"},gs={class:"exam-category-header"},_s={key:14,class:"exam-category"},ys={class:"exam-category-header"},bs={class:"exam-items"},Ds={key:15,class:"exam-category normal"},Ss={class:"exam-category-header"},ws={key:16,class:"exam-category"},ks={class:"exam-items"},xs={key:17,class:"exam-category normal"},Is={key:18,class:"exam-category"},Cs={class:"exam-category-header"},As={class:"exam-items"},Es={key:19,class:"exam-category normal"},Ps={class:"exam-category-header"},Os={key:20,class:"exam-category"},Ns={class:"exam-category-header"},$s={class:"exam-items"},Ms={key:21,class:"exam-category normal"},Ls={class:"exam-category-header"};function Ts(e,n,c,p,b,x){const v=J("ion-icon");return a(),i("div",sa,[n[44]||(n[44]=t("div",{class:"visit-header"},[t("h5",null,"Patient's Clinical Assessment Summary")],-1)),t("div",oa,[e.hasLevelOfConsciousness?(a(),i("div",ia,[t("div",la,[o(v,{icon:e.alertCircleOutline,class:"section-icon"},null,8,["icon"]),n[0]||(n[0]=t("h3",null,"Level of Consciousness",-1))]),t("div",ra,[e.levelOfConsciousness.eyeResponse?(a(),i("div",ca,[n[1]||(n[1]=t("span",{class:"info-label"},"Eye Response:",-1)),t("span",ua,E(e.levelOfConsciousness.eyeResponse),1)])):S("",!0),e.levelOfConsciousness.verbalResponse?(a(),i("div",da,[n[2]||(n[2]=t("span",{class:"info-label"},"Verbal Response:",-1)),t("span",ma,E(e.levelOfConsciousness.verbalResponse),1)])):S("",!0),e.levelOfConsciousness.motorResponse?(a(),i("div",pa,[n[3]||(n[3]=t("span",{class:"info-label"},"Motor Response:",-1)),t("span",va,E(e.levelOfConsciousness.motorResponse),1)])):S("",!0),e.gcsScore?(a(),i("div",fa,[n[4]||(n[4]=t("span",{class:"info-label"},"Score:",-1)),t("span",ha,E(e.gcsScore),1)])):S("",!0)])])):S("",!0),e.hasPresentingComplaints?(a(),i("div",ga,[t("div",_a,[o(v,{icon:e.documentTextOutline,class:"section-icon"},null,8,["icon"]),n[5]||(n[5]=t("h3",null,"Presenting Complaints",-1))]),t("div",ya,[(a(!0),i(q,null,z(e.uniquePresentingComplaints,(g,w)=>(a(),i("div",{class:"complaint-tag",key:w},E(g),1))),128))])])):S("",!0),e.hasPregnancyData?(a(),i("div",ba,[t("div",Da,[o(v,{icon:e.femaleOutline,class:"section-icon"},null,8,["icon"]),n[6]||(n[6]=t("h3",null,"Pregnancy Status",-1))]),t("div",Sa,[e.pregnancy.patientPregnant?(a(),i("div",wa,[n[7]||(n[7]=t("span",{class:"info-label"},"Pregnant:",-1)),t("span",ka,E(e.pregnancy.patientPregnant),1)])):S("",!0),e.pregnancy.breastFeeding?(a(),i("div",xa,[n[8]||(n[8]=t("span",{class:"info-label"},"Breastfeeding:",-1)),t("span",Ia,E(e.pregnancy.breastFeeding),1)])):S("",!0)])])):S("",!0),e.hasPastMedicalHistory?(a(),i("div",Ca,[t("div",Aa,[o(v,{icon:e.medicalOutline,class:"section-icon"},null,8,["icon"]),n[9]||(n[9]=t("h3",null,"Medical History",-1))]),t("div",Ea,[(a(!0),i(q,null,z(e.uniquePastMedicalHistory,(g,w)=>(a(),i("div",{class:"medical-tag",key:w},E(g),1))),128))])])):S("",!0),e.hasAllergies?(a(),i("div",Pa,[t("div",Oa,[o(v,{icon:e.warningOutline,class:"section-icon"},null,8,["icon"]),n[10]||(n[10]=t("h3",null,"Allergies",-1))]),t("div",Na,[(a(!0),i(q,null,z(e.selectedAllergiesList2,(g,w)=>(a(),i(q,{key:w},[g.selected?(a(),i("div",$a,E(g.name),1)):S("",!0)],64))),128))])])):S("",!0),e.hasPhysicalExam?(a(),i("div",Ma,[t("div",La,[o(v,{icon:e.bodyOutline,class:"section-icon"},null,8,["icon"]),n[11]||(n[11]=t("h3",null,"Physical Examination",-1))]),t("div",Ta,[e.eyesAbnormal.length?(a(),i("div",Fa,[t("div",Ba,[o(v,{icon:e.eyeOutline},null,8,["icon"]),n[12]||(n[12]=t("h4",null,"Eyes",-1))]),t("div",Ra,[(a(!0),i(q,null,z(e.eyesAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"eyes-"+w},E(g),1))),128))])])):e.eyesExamined?(a(),i("div",Va,[t("div",Ha,[o(v,{icon:e.eyeOutline},null,8,["icon"]),n[13]||(n[13]=t("h4",null,"Eyes",-1))]),n[14]||(n[14]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.mouthAbnormal.length?(a(),i("div",Ua,[t("div",qa,[o(v,{icon:e.nutritionOutline},null,8,["icon"]),n[15]||(n[15]=t("h4",null,"Mouth",-1))]),t("div",Ga,[(a(!0),i(q,null,z(e.mouthAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"mouth-"+w},E(g),1))),128))])])):e.mouthExamined?(a(),i("div",Wa,[t("div",za,[o(v,{icon:e.nutritionOutline},null,8,["icon"]),n[16]||(n[16]=t("h4",null,"Mouth",-1))]),n[17]||(n[17]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.earsAbnormal.length?(a(),i("div",Ya,[t("div",ja,[o(v,{icon:e.earOutline},null,8,["icon"]),n[18]||(n[18]=t("h4",null,"Ears",-1))]),t("div",Ka,[(a(!0),i(q,null,z(e.earsAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"ears-"+w},E(g),1))),128))])])):e.earsExamined?(a(),i("div",Xa,[t("div",Ja,[o(v,{icon:e.earOutline},null,8,["icon"]),n[19]||(n[19]=t("h4",null,"Ears",-1))]),n[20]||(n[20]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.faceAbnormal.length?(a(),i("div",Qa,[t("div",Za,[o(v,{icon:e.happyOutline},null,8,["icon"]),n[21]||(n[21]=t("h4",null,"Face",-1))]),t("div",es,[(a(!0),i(q,null,z(e.faceAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"face-"+w},E(g),1))),128))])])):e.faceExamined?(a(),i("div",ts,[t("div",ns,[o(v,{icon:e.happyOutline},null,8,["icon"]),n[22]||(n[22]=t("h4",null,"Face",-1))]),n[23]||(n[23]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.neckAbnormal.length?(a(),i("div",as,[t("div",ss,[o(v,{icon:e.manOutline},null,8,["icon"]),n[24]||(n[24]=t("h4",null,"Neck",-1))]),t("div",os,[(a(!0),i(q,null,z(e.neckAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"neck-"+w},E(g),1))),128))])])):e.neckExamined?(a(),i("div",is,[t("div",ls,[o(v,{icon:e.manOutline},null,8,["icon"]),n[25]||(n[25]=t("h4",null,"Neck",-1))]),n[26]||(n[26]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.chestAbnormal.length?(a(),i("div",rs,[t("div",cs,[o(v,{icon:e.fitnessOutline},null,8,["icon"]),n[27]||(n[27]=t("h4",null,"Chest",-1))]),t("div",us,[(a(!0),i(q,null,z(e.chestAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"chest-"+w},E(g),1))),128))])])):e.chestExamined?(a(),i("div",ds,[t("div",ms,[o(v,{icon:e.fitnessOutline},null,8,["icon"]),n[28]||(n[28]=t("h4",null,"Chest",-1))]),n[29]||(n[29]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),e.chestMovementAbnormal.length?(a(),i("div",ps,[t("div",vs,[o(v,{icon:e.moveOutline},null,8,["icon"]),n[30]||(n[30]=t("h4",null,"Chest Movement",-1))]),t("div",fs,[(a(!0),i(q,null,z(e.chestMovementAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"chest-move-"+w},E(g),1))),128))])])):e.chestMovementExamined?(a(),i("div",hs,[t("div",gs,[o(v,{icon:e.moveOutline},null,8,["icon"]),n[31]||(n[31]=t("h4",null,"Chest Movement",-1))]),n[32]||(n[32]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal movement ")],-1))])):S("",!0),e.heartSoundsAbnormal.length?(a(),i("div",_s,[t("div",ys,[o(v,{icon:e.pulseOutline},null,8,["icon"]),n[33]||(n[33]=t("h4",null,"Heart Sounds",-1))]),t("div",bs,[(a(!0),i(q,null,z(e.heartSoundsAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"heart-"+w},E(g),1))),128))])])):e.heartSoundsExamined?(a(),i("div",Ds,[t("div",Ss,[o(v,{icon:e.pulseOutline},null,8,["icon"]),n[34]||(n[34]=t("h4",null,"Heart Sounds",-1))]),n[35]||(n[35]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal heart sounds ")],-1))])):S("",!0),e.breathSoundsAbnormal.length?(a(),i("div",ws,[n[36]||(n[36]=t("div",{class:"exam-category-header"},[t("h4",null,"Breath Sounds")],-1)),t("div",ks,[(a(!0),i(q,null,z(e.breathSoundsAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"breath-"+w},E(g),1))),128))])])):e.breathSoundsExamined?(a(),i("div",xs,n[37]||(n[37]=[t("div",{class:"exam-category-header"},[t("h4",null,"Breath Sounds")],-1),t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal breath sounds ")],-1)]))):S("",!0),e.addedBreathSoundsAbnormal.length?(a(),i("div",Is,[t("div",Cs,[o(v,{icon:e.addOutline},null,8,["icon"]),n[38]||(n[38]=t("h4",null,"Added Breath Sounds",-1))]),t("div",As,[(a(!0),i(q,null,z(e.addedBreathSoundsAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"added-breath-"+w},E(g),1))),128))])])):e.addedBreathSoundsExamined?(a(),i("div",Es,[t("div",Ps,[o(v,{icon:e.addOutline},null,8,["icon"]),n[39]||(n[39]=t("h4",null,"Added Breath Sounds",-1))]),n[40]||(n[40]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," No abnormal added sounds ")],-1))])):S("",!0),e.abdominalInspectionAbnormal.length?(a(),i("div",Os,[t("div",Ns,[o(v,{icon:e.scanOutline},null,8,["icon"]),n[41]||(n[41]=t("h4",null,"Abdominal Inspection",-1))]),t("div",$s,[(a(!0),i(q,null,z(e.abdominalInspectionAbnormal,(g,w)=>(a(),i("div",{class:"exam-item",key:"abdomen-"+w},E(g),1))),128))])])):e.abdominalInspectionExamined?(a(),i("div",Ms,[t("div",Ls,[o(v,{icon:e.scanOutline},null,8,["icon"]),n[42]||(n[42]=t("h4",null,"Abdominal Inspection",-1))]),n[43]||(n[43]=t("div",{class:"exam-items"},[t("div",{class:"exam-item normal"}," Normal abdominal inspection ")],-1))])):S("",!0)])])):S("",!0)])])}const Fs=ue(aa,[["render",Ts],["__scopeId","data-v-374c46fb"]]),Bs={class:"modal_wrapper"},Rs=Z({__name:"LevelOfConsciousness",setup(e,{expose:n}){var w,u;const c=Ie(),{patient:p}=xe(c),b=l(be.getAgeInYears((u=(w=p==null?void 0:p.value)==null?void 0:w.personInformation)==null?void 0:u.birthdate)),x=l(null),v=Y(()=>{var $,H,I,M;const y=(($=x.value)==null?void 0:$.getFormValues())||{},d=y["Eye opening response"]||"",R=y["Best motor response"]||"",r=y["Best verbal response"]||"",k=b.value<18,A=(H=(k?kt:Dt)[d])!=null?H:0,P=(I=(k?xt:wt)[R])!=null?I:0,O=(M=(k?It:St)[r])!=null?M:0,L=A+P+O;return"(M ".concat(P," V ").concat(O," E ").concat(A,") ").concat(L,"/").concat(k?5:15)});return n({onSubmit:async()=>{var d;if(!x.value){console.error("Form reference is not available");return}const y=((d=x.value)==null?void 0:d.getFormValues())||{};y["Eye opening response"]||y["Best motor response"]||y["Best verbal response"]?(await j.buildAddObsToEncounterPatient(y,X.ASSESSMENT),x.value.resetForm(),Pe("Level of Consciousness saved successfully")):re(" No level of consciousness data to save ")}}),(y,d)=>(a(),i("div",Bs,[b.value<18?(a(),F(Fe,{key:0,formData:m(na),ref_key:"formRef",ref:x},null,8,["formData"])):(a(),F(Fe,{key:1,formData:m(ta),ref_key:"formRef",ref:x},null,8,["formData"])),t("h5",null,E(v.value),1)]))}}),Vs={class:"modal_wrapper"},Hs=Z({__name:"PregnancyBreastfeeding",setup(e,{expose:n}){const c=kn(),{pregnancy:p}=xe(c),b=()=>{};return n({onSubmit:async()=>{const v=await Ke(p.value);v.length>0?(await j.addObsToEncounterPatient(v,X.PREGNANCY_STATUS),Pe("Pregnancy status saved successfully")):re("No pregnancy status data to save ")}}),(v,g)=>(a(),i("div",Vs,[o(je,{contentData:m(p),"onUpdate:inputValue":b},null,8,["contentData"])]))}}),Us={class:"modal_wrapper"},qs={class:"uniform_columns"},Gs=Z({__name:"PastMedicalHistory",setup(e,{expose:n}){const c=xn(),{pastMedicalHistory:p}=xe(c),b=l([]);De(()=>{b.value=c.getInitial(),x()}),ce(p,()=>{x()},{deep:!0});const x=()=>{var y;const u=["TB","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Epilepsy","Previous stroke","Peptic Ulcer Disease (PUD)","Mental disorder","Bleeding disorders","Hypertension","HIV Positive","Diabetes Mellitus"];(y=In(p.value,"None"))!=null&&y.checked?u.forEach(d=>{ge(p.value,"TB treatment","displayNone",!0),we(p.value,"TB drugs","displayNone",!0),we(p.value,"TB drug start date","displayNone",!0),ge(p.value,"Hypertension medication","displayNone",!0),we(p.value,"Current hypertension treatment regimen","displayNone",!0),ge(p.value,"HIV status","displayNone",!0),we(p.value,"ARV start date","displayNone",!0),ge(p.value,"Diabetes","displayNone",!0),ge(p.value,"Controlled by","displayNone",!0),_e(p.value,d,"checked",!1),_e(p.value,d,"disabled",!0)}):u.forEach(d=>{_e(p.value,d,"disabled",!1)})},v=u=>{we(p.value,"TB drugs","popOverData",{filterData:!0,data:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"},{name:"Cycloserine 125mg"},{name:"Cycloserine 250mg"},{name:"Delamanid 50mg"},{name:"Ethambutol 100mg"},{name:"Ethambutol 400mg"},{name:"Ethionamide 250mg"},{name:"Isoniazid 100mg "},{name:"Isoniazid 300mg"},{name:"Isoniazid / Rifapentine 300mg / 300mg"},{name:"Levofloxacin 100mg"},{name:"Levofloxacin 250mg"},{name:"Linezolid 600mg"},{name:"Moxifloxacin 400mg"},{name:"Pyrazinamide 400mg"},{name:"Rifabutin 150mg Capsules"},{name:"Rifampicin 150mg/isoniazid 75mg"},{name:"Rifampicin 75mg+INH 50mg dispersible"},{name:"Rifampicin 75mg+INH 50mg+Pyrazinamide 150mg dispersible"},{name:"Rifampicin150mg/Isoniazid75mg/Pyrazinamide 400mg/Ethambutol"}]}),we(p.value,"Current hypertension treatment regimen","popOverData",{filterData:!0,data:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}]})},g=async()=>[...await yt(p.value),...await Ke(p.value),...await bt(p.value)];return n({onSubmit:async()=>{const u=await g();if(u.length===0){re("No past medical history data to save");return}await j.addObsToEncounterPatient(u,X.PAST_MEDICAL_HISTORY),Pe("Past medical history saved successful")}}),(u,y)=>(a(),i("div",Us,[t("div",qs,[o(je,{contentData:m(p),initialData:b.value,"onUpdate:inputValue":v,"onUpdate:selected":v},null,8,["contentData","initialData"])])]))}}),Ws=ue(Gs,[["__scopeId","data-v-49fdce72"]]),zs={class:"container"},Ys=Z({__name:"PhysicalExamination",setup(e,{expose:n}){const c=Cn(),p=Ie(),{physicalExam:b}=xe(c),{patient:x}=xe(p),v=l([]);De(()=>{v.value=c.getInitial(),g(),w()}),ce(b,()=>{g(),w()},{deep:!0});const g=()=>{An(b.value,"Physical examination")=="No"?ge(b.value,"Reason why physical examination not done","displayNone",!1):(ge(b.value,"Reason why physical examination not done","displayNone",!0),ge(b.value,"Reason why physical examination not done","selectedValue",""))},w=()=>{var R,r;const d=(r=(R=x.value)==null?void 0:R.personInformation)==null?void 0:r.gender;d=="M"&&(_e(b.value,"Vulva examination","disabled",!0),_e(b.value,"Visible bleeding","disabled",!0)),d=="F"&&(_e(b.value,"Urethral meatus abnormal","disabled",!0),_e(b.value,"Scrotal swelling","disabled",!0),_e(b.value,"Tastes swelling","disabled",!0))},u=async()=>[...await yt(b.value),...await Ke(b.value),...await bt(b.value)];return n({onSubmit:async()=>{const d=await u();if(d.length===0){re("No physical examination data to save");return}await j.addObsToEncounterPatient(d,X.PHYSICAL_EXAMINATION),Pe("Physical examination saved successful")}}),(d,R)=>{const r=J("ion-card-content"),k=J("ion-card");return a(),i("div",zs,[o(k,{class:"section"},{default:h(()=>[o(r,null,{default:h(()=>[o(je,{contentData:m(b),initialData:v.value},null,8,["contentData","initialData"])]),_:1})]),_:1})])}}}),js=ue(Ys,[["__scopeId","data-v-96d0ce9f"]]),Ks={key:0},Xs={class:"ion-padding",slot:"content"},Js={class:"nav-buttons"},Qs={class:"ion-padding",slot:"content"},Zs={class:"nav-buttons"},eo={class:"ion-padding",slot:"content"},to={class:"nav-buttons"},no={class:"ion-padding",slot:"content"},ao={class:"nav-buttons"},so={class:"ion-padding",slot:"content"},oo={class:"nav-buttons"},io={class:"ion-padding",slot:"content"},lo={class:"nav-buttons"},ro=Z({__name:"ClinicalAssessment",setup(e,{expose:n}){const c=l("loc"),p=l(0),b=l(!1),x=new En,v=Ie(),g=()=>{p.value++},w=l(null),u=l(null),y=l(null),d=l(null),R=l(null),r=l(null),k=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>x.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}];async function A(){const N=ye.getSessionDate(),s=[X.ASSESSMENT,X.PRESENTING_COMPLAINTS,X.PAST_MEDICAL_HISTORY,X.PHYSICAL_EXAMINATION,X.PREGNANCY_STATUS];let D=!1;for(const T of s)try{const G=await j.getObsByEncounterIdAndDate(T);if(G&&G.some(ee=>ee.obs_datetime?be.toStandardHisFormat(ee.obs_datetime)===be.toStandardHisFormat(N):!1)){D=!0;break}}catch(G){console.error("Error checking observations for encounter type ".concat(T,":"),G)}b.value=D}De(A),ce(()=>v.patient,A);const P=Y(()=>b.value),O=Y(()=>k.filter(N=>typeof N.show=="function"?N.show():N.show)),L=N=>{const s=k.find(D=>D.id===N);return s?typeof s.show=="function"?s.show():s.show:!1},$=N=>O.value.findIndex(s=>s.id===N),H=N=>{const s=$(N);s>0&&(c.value=O.value[s-1].id)},I=N=>{const D=$(N)+1;D<O.value.length?c.value=O.value[D].id:(c.value="",g())};return n({onSubmit:async()=>{const N=[{ref:w,name:"PresentingComplaints"},{ref:u,name:"LevelOfConsciousness"},{ref:y,name:"PastMedicalHistory"},{ref:R,name:"PregnancyBreastfeeding"},{ref:r,name:"PhysicalExamination"}];for(const s of N)if(s.ref.value&&typeof s.ref.value.onSubmit=="function")try{await s.ref.value.onSubmit()}catch(D){console.error("Error calling ".concat(s.name," onSubmit:"),D)}else console.log("".concat(s.name," component ref not available or no onSubmit method"))}}),(N,s)=>P.value?(a(),i("div",Ks,[(a(),F(Fs,{key:p.value}))])):(a(),F(m(gn),{key:1,style:{width:"100%"}},{default:h(()=>[o(m(ze),{value:c.value,"onUpdate:value":s[12]||(s[12]=D=>c.value=D),ref:"accordionGroup",class:"previousView"},{default:h(()=>[L("loc")?(a(),F(m(fe),{key:0,value:"loc",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[13]||(s[13]=[B("Level of consciousness",-1)])),_:1,__:[13]})]),_:1}),t("div",Xs,[o(Rs,{"is-active":c.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:u,onDataSaved:g},null,8,["is-active"]),t("div",Js,[$("loc")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[0]||(s[0]=ie(D=>H("loc"),["stop"]))},{default:h(()=>s[14]||(s[14]=[B(" Back ",-1)])),_:1,__:[14]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[1]||(s[1]=ie(D=>I("loc"),["stop"]))},{default:h(()=>[B(E($("loc")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pc")?(a(),F(m(fe),{key:1,value:"pc",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[15]||(s[15]=[B("Presenting complaints",-1)])),_:1,__:[15]})]),_:1}),t("div",Qs,[o(ea,{"is-active":c.value==="pc",onDataSaved:g,ref_key:"presentingComplaintsFormRef",ref:w},null,8,["is-active"]),t("div",Zs,[$("pc")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[2]||(s[2]=ie(D=>H("pc"),["stop"]))},{default:h(()=>s[16]||(s[16]=[B(" Back ",-1)])),_:1,__:[16]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[3]||(s[3]=ie(D=>I("pc"),["stop"]))},{default:h(()=>[B(E($("pc")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pbs")?(a(),F(m(fe),{key:2,value:"pbs",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[17]||(s[17]=[B("Pregnancy and breastfeeding status",-1)])),_:1,__:[17]})]),_:1}),t("div",eo,[o(Hs,{"is-active":c.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:R,onDataSaved:g},null,8,["is-active"]),t("div",to,[$("pbs")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[4]||(s[4]=ie(D=>H("pbs"),["stop"]))},{default:h(()=>s[18]||(s[18]=[B(" Back ",-1)])),_:1,__:[18]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[5]||(s[5]=ie(D=>I("pbs"),["stop"]))},{default:h(()=>[B(E($("pbs")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pmh")?(a(),F(m(fe),{key:3,value:"pmh",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[19]||(s[19]=[B("Past medical history",-1)])),_:1,__:[19]})]),_:1}),t("div",no,[o(Ws,{"is-active":c.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:y,onDataSaved:g},null,8,["is-active"]),t("div",ao,[$("pmh")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[6]||(s[6]=ie(D=>H("pmh"),["stop"]))},{default:h(()=>s[20]||(s[20]=[B(" Back ",-1)])),_:1,__:[20]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[7]||(s[7]=ie(D=>I("pmh"),["stop"]))},{default:h(()=>[B(E($("pmh")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("al")?(a(),F(m(fe),{key:4,value:"al",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[21]||(s[21]=[B("Allergies",-1)])),_:1,__:[21]})]),_:1}),t("div",so,[o(Tn,{"is-active":c.value==="al",ref_key:"allergiesFormRef",ref:d,onDataSaved:g},null,8,["is-active"]),t("div",oo,[$("al")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[8]||(s[8]=ie(D=>H("al"),["stop"]))},{default:h(()=>s[22]||(s[22]=[B(" Back ",-1)])),_:1,__:[22]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[9]||(s[9]=ie(D=>I("al"),["stop"]))},{default:h(()=>[B(E($("al")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pe")?(a(),F(m(fe),{key:5,value:"pe",class:"_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(m(le),{class:"previousLabel"},{default:h(()=>s[23]||(s[23]=[B("Physical examination",-1)])),_:1,__:[23]})]),_:1}),t("div",io,[o(js,{"is-active":c.value==="pe",ref_key:"physicalExaminationFormRef",ref:r,onDataSaved:g},null,8,["is-active"]),t("div",lo,[$("pe")>0?(a(),F(m(ae),{key:0,fill:"outline",onClick:s[10]||(s[10]=ie(D=>H("pe"),["stop"]))},{default:h(()=>s[24]||(s[24]=[B(" Back ",-1)])),_:1,__:[24]})):S("",!0),o(m(ae),{fill:"outline",onClick:s[11]||(s[11]=ie(D=>I("pe"),["stop"]))},{default:h(()=>[B(E($("pe")<O.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0)]),_:1},8,["value"])]),_:1}))}}),xi=ue(ro,[["__scopeId","data-v-9966d812"]]);class co extends at{constructor(n,c){super(n,8,c)}static async getDiagnosis(n="",c=1,p=10){const b=await se.getConceptID("Qech outpatient diagnosis list");return at.getJson("diagnosis",{id:b,name:n,page:c,page_size:p})}}const uo=Z({name:"Menu",components:{IonContent:ct,IonHeader:rt,IonItem:Q,IonList:Be,IonMenu:lt,IonTitle:it,IonToolbar:ot,List:Re},computed:{...Te(Ie,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:ft(["#006401"]),listIcon:vt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:ut,pulseOutline:Ye}},async mounted(){const e=await j.getAll(this.patient.patientID,"Primary diagnosis"),n=await j.getAll(this.patient.patientID,"Secondary diagnosis"),c=await j.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),p=[...e||[],...n||[],...c||[]],b=he.isEmpty(p)?[]:Promise.all(p.map(async x=>({name:await j.getConceptName(x.value_coded),obs_date:x.obs_datetime})));this.setListData(await b)},methods:{dismiss(){_n.dismiss()},handleIcon(){},setActivClass(e){this.activeHeight="",this.activeBMI="",this.activeWeight="",e=="height"?this.activeHeight="_active":e=="weight"?this.activeWeight="_active":e=="BMI"&&(this.activeBMI="_active")},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),e.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[be.toStandardHisFormat(n.obs_date),n.name,""]})})}}}),mo={class:"modal_wrapper"};function po(e,n,c,p,b,x){const v=J("list");return a(),i("div",mo,[t("div",null,[o(v,{listData:e.list},null,8,["listData"])])])}const vo=ue(uo,[["render",po],["__scopeId","data-v-88580898"]]),fo={class:"custom_card",style:{padding:"10px"}},ho={key:0},go={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},_o={class:"ion-padding",slot:"content"},yo=Z({__name:"OPDDiagnosis",setup(e,{expose:n}){const c=Ee,p=l(!0),b=l(!1),x=l(!0),v=l(!1),g=l(!0),w=l(""),u=l(""),y=l([]),d=l([]),R=l(),r=l(null);Pn();const k=Y(()=>d.value.some(s=>s.data.concept_id===6542));ce(d,()=>{M()},{deep:!0});const A=Y(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:y.value,icon:c.search,onSearchChange:H,validation:$e.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:y.value,icon:c.search,condition:s=>s==null?void 0:s.secondaryDiagnosisCheckbox,onSearchChange:H,validation:(s,D)=>P(D,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:y.value,icon:c.search,isMultiple:!0,condition:s=>s==null?void 0:s.differentialDiagnosisCheckbox,onSearchChange:H,validation:(s,D)=>P(D,"differentialDiagnosis")}]),P=(s,D)=>{var oe,W,Se;if(!s)return null;const T=(oe=s.primaryDiagnosis)==null?void 0:oe.name,G=((W=s.secondaryDiagnosis)==null?void 0:W.map(me=>me.name))||[],ee=((Se=s.differentialDiagnosis)==null?void 0:Se.map(me=>me.name))||[];if(D==="secondaryDiagnosis"&&G.includes(T)||D==="differentialDiagnosis"&&ee.includes(T))return"".concat(T," is already the primary diagnosis");const de=G.find(me=>ee.includes(me));return de?"".concat(de," cannot be both secondary and differential"):null},O=()=>{u.value="",w.value="",p.value=!1,g.value=!1,b.value=!0},L=async()=>{var s;((s=r.value)==null?void 0:s.validateForm())==null&&($(),b.value=!1,v.value=!0,g.value=!0,x.value=!1)},$=()=>{var oe;const s=[],D=d.value.map(W=>W.name),T=((oe=r.value)==null?void 0:oe.getFormValues())||{},G=T.primaryDiagnosis||[],ee=T.secondaryDiagnosis||[],de=T.differentialDiagnosis||[];if(G.name&&!D.includes(G.name))if(!d.value.some(Se=>Se.data.concept_id===6542))s.push({actionBtn:!0,btn:["delete"],name:G.name,id:G.concept_id,display:[G.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:G.concept_id,obs_datetime:ye.getSessionDate()}});else return On("Only one primary diagnosis is allowed"),!1;return ee&&ee.forEach(W=>{D.includes(W.name)||s.push({actionBtn:!0,btn:["delete"],name:W.name,id:W.concept_id,display:[W.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:W.concept_id,obs_datetime:ye.getSessionDate()}})}),de&&de.forEach(W=>{D.includes(W.name)||s.push({actionBtn:!0,btn:["delete"],name:W.name,id:W.concept_id,display:[W.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:W.concept_id,obs_datetime:ye.getSessionDate()}})}),s.length>0&&(d.value=[...d.value,...s]),!0},H=async s=>{const D=s.trim().toLowerCase()||"";return y.value=await co.getDiagnosis(D,1,15),y.value},I=s=>{const D=d.value,T=s.name,G=D.filter(ee=>ee.display[0]!==T);d.value=G},M=()=>{d.value.length>0?(v.value=!0,p.value=!1):b.value||(p.value=!0),g.value=!k.value},N=async()=>{if(d.value.length<=0){re("Diagnosis not saved");return}const s=d.value.flatMap(T=>T.data);if(s.length<=0)return re("Diagnosis not saved");const D=await j.addObsToEncounter(s,X.DIAGNOSIS);await j.mergeObsToPatient(D),Pe("Diagnosis saved successful"),d.value=[]};return De(async()=>{M(),await H("")}),n({onSubmit:N}),(s,D)=>{const T=J("ion-row"),G=J("ion-label"),ee=J("ion-accordion"),de=J("ion-accordion-group");return a(),i(q,null,[t("div",fo,[o(_t,{status:p.value,content:"No Diagnosis added"},null,8,["status"]),v.value?(a(),i("span",ho,[o(Re,{listData:d.value,"onClicked:delete":I},null,8,["listData"]),k.value?(a(),i("div",go," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):S("",!0)])):S("",!0),b.value?(a(),F(T,{key:1},{default:h(()=>{var oe;return[t("div",null,[o(Fe,{formData:A.value,ref_key:"formRef",ref:r},null,8,["formData"])]),t("div",null,[o(ke,{fill:"clear",icon:m(c).plus,iconSlot:"icon-only","onClicked:btn":D[0]||(D[0]=W=>L()),name:"Save",disabled:(oe=r.value)==null?void 0:oe.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):S("",!0),g.value?(a(),F(T,{key:2,style:{"margin-top":"10px"}},{default:h(()=>[o(ke,{fill:"clear",icon:m(c).plus,iconSlot:"icon-only","onClicked:btn":D[1]||(D[1]=oe=>O()),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):S("",!0)]),o(T,null,{default:h(()=>[o(de,{ref_key:"accordionGroup",ref:R,class:"previousView"},{default:h(()=>[o(ee,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:h(()=>[o(m(Q),{slot:"header",color:"light"},{default:h(()=>[o(G,{class:"previousLabel"},{default:h(()=>D[2]||(D[2]=[B("Previous Diagnosis",-1)])),_:1,__:[2]})]),_:1}),t("div",_o,[o(vo)])]),_:1})]),_:1},512)]),_:1})],64)}}}),Ii=ue(yo,[["__scopeId","data-v-a440f286"]]),bo={class:"allergies-container"},Do={key:0,class:"no-allergies"},So={key:1,class:"date-groups"},wo=["onClick"],ko={class:"date-info"},xo={class:"date-text"},Io={class:"allergy-count"},Co={class:"card-header"},Ao={class:"allergy-type"},Eo={class:"card-content"},Po={class:"metadata"},Oo={key:0,class:"provider"},No={key:1,class:"encounter"},$o=Z({__name:"AllergiesListing",setup(e){const n=Ie(),{patient:c}=xe(n),p=l({}),b={antiviral:/abacavir|lamivudine|lopinavir|ritonavir|zidovudine|efavirenz|tenofovir/i,antibiotic:/penicillin|amoxicillin|cephalexin|azithromycin|ciprofloxacin|doxycycline/i,analgesic:/aspirin|ibuprofen|acetaminophen|morphine|codeine|tramadol/i,cardiac:/metoprolol|lisinopril|amlodipine|atorvastatin|warfarin/i,activated:/activated\s+charcoal/i},x={985:{name:"Drug Allergy",icon:"medical-outline",severity:"danger"},7759:{name:"Location/Environmental",icon:"location-outline",severity:"info"},7579:{name:"Medical Condition",icon:"heart-outline",severity:"warning"},drug:{name:"Drug Allergy",icon:"medical-outline",severity:"danger"},food:{name:"Food Allergy",icon:"restaurant-outline",severity:"danger"},environmental:{name:"Environmental",icon:"leaf-outline",severity:"warning"},contact:{name:"Contact Allergy",icon:"hand-left-outline",severity:"warning"},unknown:{name:"Unknown Allergy",icon:"help-circle-outline",severity:"info"}},v=r=>{const k=r.toLowerCase();return b.antiviral.test(k)?{type:"Antiviral Medication",icon:"shield-outline"}:b.antibiotic.test(k)?{type:"Antibiotic",icon:"bandage-outline"}:b.analgesic.test(k)?{type:"Pain Medication",icon:"fitness-outline"}:b.cardiac.test(k)?{type:"Cardiac Medication",icon:"heart-outline"}:b.activated.test(k)?{type:"Detoxification Agent",icon:"flask-outline"}:{type:"Medication",icon:"medical-outline"}},g=Y(()=>{var r,k,A;return((A=(k=(r=c.value)==null?void 0:r.allergies)==null?void 0:k.saved)==null?void 0:A.length)>0}),w=Y(()=>g.value?c.value.allergies.saved.map(r=>{var $;const k=(($=r.concept_id)==null?void 0:$.toString())||"unknown",A=x[k]||x.unknown;let P="Unknown",O=null;return r.value_text&&r.value_text!=="Unknown"&&r.value_text!==""?(P=r.value_text,k==="985"&&(O=v(r.value_text))):r.concept_name&&(P=r.concept_name),{...O?{...A,name:O.type,icon:O.icon}:A,displayValue:P,conceptId:r.concept_id,date:r.obs_datetime||r.encounter_datetime,providerId:r.provider_id,locationId:r.location_id,encounterId:r.encounter_id,isDrug:k==="985",raw:r}}):[]),u=Y(()=>{const r={};w.value.forEach(P=>{const O=P.date?d(P.date):"Unknown Date";r[O]||(r[O]=[]),r[O].push(P)});const k={};return Object.keys(r).sort((P,O)=>P==="Unknown Date"?1:O==="Unknown Date"?-1:new Date(O).getTime()-new Date(P).getTime()).forEach(P=>{k[P]=r[P]}),k}),y=r=>{p.value[r]=!p.value[r]},d=r=>{if(!r)return"Unknown Date";try{return new Date(r).toISOString().split("T")[0]}catch(k){return"Unknown Date"}},R=r=>{if(r==="Unknown Date")return"Unknown Date";try{const k=new Date(r),A=be.sessionDate(),P=new Date(A),O=new Date(P);O.setDate(O.getDate()-1);const L=k.toDateString(),$=P.toDateString(),H=O.toDateString();return L===$?"Today":L===H?"Yesterday":k.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(k){return r}};return ce(()=>u.value,r=>{const k=Object.keys(r);k.length>0&&(p.value[k[0]]=!0)},{immediate:!0}),ce(()=>{var r;return(r=c.value)==null?void 0:r.allergies},r=>{console.log("Allergies updated:",r)},{deep:!0}),De(()=>{var r;console.log("Allergies component mounted",(r=c.value)==null?void 0:r.allergies)}),(r,k)=>{const A=J("ion-icon"),P=J("ion-label");return a(),i("div",bo,[o(P,{class:"section-title"},{default:h(()=>[o(A,{icon:m(pt),class:"alert-icon"},null,8,["icon"]),o(P,null,{default:h(()=>k[0]||(k[0]=[B("Allergies (Medication, Healthcare items, Environment and Food)",-1)])),_:1,__:[0]})]),_:1}),g.value?(a(),i("div",So,[(a(!0),i(q,null,z(u.value,(O,L)=>(a(),i("div",{key:L,class:"date-group"},[t("div",{class:Ne(["date-header",{expanded:p.value[L]}]),onClick:$=>y(L)},[t("div",ko,[o(A,{name:"calendar-outline",class:"date-icon"}),t("span",xo,E(R(L)),1),t("span",Io,"("+E(O.length)+" "+E(O.length===1?"allergy":"allergies")+")",1)]),o(A,{name:"chevron-down-outline",class:Ne(["expand-icon",{rotated:p.value[L]}])},null,8,["class"])],10,wo),t("div",{class:Ne(["allergies-grid",{collapsed:!p.value[L]}])},[(a(!0),i(q,null,z(O,($,H)=>(a(),i("div",{key:H,class:Ne(["allergy-card",$.severity])},[t("div",Co,[o(A,{name:$.icon,class:"allergy-icon"},null,8,["name"]),t("span",Ao,E($.name),1)]),t("div",Eo,[t("div",{class:Ne(["allergy-value",{"drug-name":$.isDrug}])},E($.displayValue),3),t("div",Po,[$.providerId?(a(),i("div",Oo,[o(A,{name:"person-outline",class:"meta-icon"}),t("span",null,"Provider "+E($.providerId),1)])):S("",!0),$.encounterId?(a(),i("div",No,[o(A,{name:"document-text-outline",class:"meta-icon"}),t("span",null,"Encounter "+E($.encounterId),1)])):S("",!0)])])],2))),128))],2)]))),128))])):(a(),i("div",Do,[o(A,{name:"checkmark-circle-outline",class:"no-allergies-icon"}),k[1]||(k[1]=t("p",null,"No known allergies",-1))]))])}}}),Mo=ue($o,[["__scopeId","data-v-f5ba0bab"]]),Lo={class:"allergies-section"},To={class:"allergies-container"},Fo={class:"medication-section"},Bo={class:"medication-content"},Ro={key:0,class:"add-medication-form"},Vo={class:"form-group"},Ho={class:"option-label"},Uo={key:0,class:"error-message"},qo={class:"form-row"},Go={class:"form-group"},Wo={key:0,class:"error-message"},zo={class:"form-group"},Yo={key:0,class:"error-message"},jo={class:"form-group"},Ko={key:0,class:"error-message"},Xo={class:"action-buttons"},Jo={class:"notes-section"},Qo={class:"notes-content"},Zo={class:"notes-input-container"},ei={class:"ion-padding",slot:"content"},ti={class:"notes-timeline"},ni={class:"note-date"},ai={class:"note-content"},si={class:"ion-padding",slot:"content"},oi={class:"note-date"},ii={class:"note-content"},li=Z({watch:{},name:"xxxComponent"}),ri=Z({...li,setup(e){const n=Ee,c=Vn,p=l(!1),b=l(!1),x=l(!0),v=l(0),g=l(""),w=l(!1),u=l(""),y=l(!1),d=l(),R=l(!1),r=l(""),k=l(""),A=l(""),P=l(""),O=l(""),L=l("");l(!1);const $="Add new medication",H="clear";l("Show more medications");const I=Ae(),M=gt(),N=Y(()=>M.selectedMedicalAllergiesList),s=Y(()=>I.selectedMedicalDrugsList),D=Y(()=>I.partialOPDdrugList),T=Y(()=>I.nonPharmalogicalTherapyAndOtherNotes),G=["first","second","third"],ee=l(),de=l(),oe=l(),W=l(!1),Se=l(!1);l(!1);const me=l("Show more notes");l("Show more allergies");const Ct=l(),At=l(),Ce=l(),Me=Y(()=>I.editingDrugItem),Et=l("Select a route"),Ve=l(!1),Pt=l("Select frequency"),He=l(!1),Ot=l("Select drug"),Ue=l(!1),te=l(),ne=l(),pe=l(),Oe=l([]),Nt=l([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),$t=Y(()=>Oe.value.length?Oe.value:Nt.value);function Mt(_){te.value=_}async function Lt(){return await Hn()}async function Tt(_=5,f=1e3){let C=0;for(;C<_&&(Oe.value=await Lt(),!(Oe.value.length>0));)C++,await new Promise(U=>setTimeout(U,f));Oe.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}De(async()=>{const _=new Fn,{previousDrugPrescriptions:f,previousClinicalNotes:C,previousDrugAllergies:U}=await _.getPatientEncounters();ee.value=f,de.value=Object.entries(C)[0];const[,...V]=Object.entries(C);oe.value=V,Ct.value=Object.entries(U)[0];const[,...K]=Object.entries(U);At.value=K,await Tt()}),ce(()=>r.value,async _=>{Xe()}),ce(()=>k.value,async _=>{Ht()}),ce(()=>A.value,async _=>{Je()});function Ft(){if(he.isEmpty(te.value)==!0)return Ve.value=!0,!1;if(he.isEmpty(te.value)==!1)return Ve.value=!1,!0}function Bt(){if(he.isEmpty(ne.value)==!0)return He.value=!0,!1;if(he.isEmpty(ne.value)==!1)return He.value=!1,!0}function Rt(){if(he.isEmpty(pe.value)==!0)return Ue.value=!0,!1;if(he.isEmpty(pe.value)==!1)return Ue.value=!1,!0}function Vt(){x.value=!x.value,p.value=!0,y.value=!1,R.value=!1}async function Xe(){const _=await Wt();return console.log({drugNameExists:_}),_?w.value=!1:(g.value="please select a valid drug name",w.value=!0),w.value}async function Ht(){return et(k.value)?y.value=!1:(u.value="please enter a number",y.value=!0),y.value}async function Je(){return et(A.value)?R.value=!1:(d.value="please enter a number",R.value=!0),R.value}async function Qe(){const _=await Xe(),f=await Je(),C=Bt(),U=Rt(),V=Ft();return!_&&!f&&C==!0&&U==!0&&V==!0}function Ut(_){ne.value=_}async function Ze(){const _=()=>Ce.value.dose_strength!=null&&Ce.value.dose_strength?Math.trunc(Ce.value.dose_strength):1;if(Me.value!==null){if(!await Qe()){re("Please enter correct data values",4e3);return}const C=ye.getSessionDate(),U=tt(C,parseInt(A.value));let V=!1;qe(Ce.value)==!0&&(V=!0);const K={drugName:r.value,dose:_(),frequency:ne.value.label,frequency_code:ne.value.code,duration:A.value,prescription:U,drug_id:L.value,units:O.value,route_concept_id:te.value.concept_id,route_name:te.value.name,highlightbackground:V},Ge=Ae();console.log(Ge.setSelectedMedicalDrugsList([K])),Ge.editingDrugItem=null,x.value=!0}else{if(!await Qe()){re("Please enter correct data values",4e3);return}Zt();const C=ye.getSessionDate(),U=tt(C,parseInt(A.value));let V=!1;qe(Ce.value)==!0&&(V=!0);const K={drugName:r.value,dose:_(),frequency:ne.value.label,frequency_code:ne.value.code,duration:A.value,prescription:U,drug_id:L.value,units:O.value,route_concept_id:te.value.concept_id,route_name:te.value.name,highlightbackground:V};Ae().setSelectedMedicalDrugsList([K])}L.value="",r.value="",k.value="",ne.value=null,A.value="",P.value="",v.value++,pe.value=null,te.value=null}async function qt(_){const f=_,V=await st.getOfflineOPDDrugs({name:f,page:1,page_size:10});V.map(K=>({label:K.name,value:K.name,other:K})),I.setPartialOPDdrugList(V)}async function Gt(_){let f;_.target===void 0?f=_:f=_.target.value;const V=await st.getOPDDrugs({name:encodeURIComponent(f),page:1,page_size:10});return V.map(K=>({label:K.name,value:K.name,other:K})),V}function qe(_){const f=[];return N.value.forEach(U=>{U.selected&&f.push(U.concept_id)}),zt([_],f)==!0?(re("Client is allergic to the selected medication",4e6),!0):!1}async function Wt(){return(await Gt(r.value)).length>0?r.value.length!=0:!1}function zt(_,f){try{return _.some(C=>f.includes(C.concept_id))}catch(C){return!1}}function Yt(_){_&&(r.value=_.name,L.value=_.drug_id,O.value=_.units,Ce.value=_,qe(_))}function jt(_){const f=s.value[_],C=Ae();C.removeDrugById(f.drug_id),C.editingDrugItem=f,L.value="",r.value="",k.value="",ne.value=null,A.value="",P.value="",pe.value=null,te.value=null,L.value=f.drug_id,r.value=f.drugName,k.value=f.dose,ne.value={label:f.frequency,code:f.frequency_code},A.value=f.duration,P.value=f.prescription;const U=D.value.find(V=>V.name===f.drugName);U&&(pe.value=U),te.value={concept_id:f.route_concept_id,name:f.route_name},x.value=!1,v.value++}function Kt(){if(Me.value!==null){L.value="",r.value="",k.value="",ne.value=null,A.value="",P.value="",pe.value=null,te.value=null;const _=Ae();_.setSelectedMedicalDrugsList([Me.value]),_.editingDrugItem=null}x.value=!0,v.value++}function Xt(_){s.value.splice(_,1),v.value++,re("you have removed a drug from list",6e3)}function Jt(_){let f=_.target.value;Qt(f)}function Qt(_){Ae().setNonPharmalogicalTherapyAndOtherNotes(_)}function et(_){return/^[0-9]+$/.test(_)}function tt(_,f){const C=new Date(_);C.setDate(C.getDate()+f);const U=C.getFullYear(),V=String(C.getMonth()+1).padStart(2,"0"),K=String(C.getDate()).padStart(2,"0");return"".concat(U,"-").concat(V,"-").concat(K)}function Zt(){p.value=!1,b.value=!0,x.value=!0}function en(_){G.filter(C=>C!==_.detail.value);const f=_.detail.value;f!==void 0?f=="third"&&(me.value="Show less notes",Se.value=!W.value):(me.value="Show more notes",Se.value=!W.value)}function tn(_){return _[1]}function nn(_){(_.key==="Enter"||_.key==="ArrowDown")&&(_.preventDefault(),Ze())}const ve=Y(()=>[{showAddItemButton:!0,addItemButton:!0,name:Me.value!==null?"Update":"ADD",btnFill:"clear",fn:Ze},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",btnFill:"clear",fn:Kt}]);return(_,f)=>(a(),F(m(Be),null,{default:h(()=>[t("div",Lo,[t("div",To,[o(Mo)])]),t("div",Fo,[o(m(Q),{lines:"none",class:"section-header"},{default:h(()=>[o(m(Le),{icon:m(mt),class:"section-icon"},null,8,["icon"]),o(m(le),{class:"section-title",style:{"margin-top":"12px"}},{default:h(()=>f[9]||(f[9]=[B("Medication",-1)])),_:1,__:[9]})]),_:1}),t("div",Bo,[(a(),F(Bn,{_selectedMedicalDrugsList:s.value,onEditItem:jt,onRemoveItem:Xt,key:v.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),x.value?S("",!0):(a(),i("div",Ro,[t("div",Vo,[f[10]||(f[10]=t("label",{class:"input-label"},"Medication",-1)),o(m(We),{modelValue:pe.value,"onUpdate:modelValue":[f[0]||(f[0]=C=>pe.value=C),f[1]||(f[1]=C=>Yt(C))],options:D.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:f[2]||(f[2]=C=>qt(C))},{option:h(C=>[t("div",Ho,E(C.option.name),1)]),_:1},8,["modelValue","options"]),Ue.value?(a(),i("div",Uo,E(Ot.value),1)):S("",!0)]),t("div",qo,[t("div",Go,[f[11]||(f[11]=t("label",{class:"input-label"},"Route",-1)),o(m(We),{modelValue:te.value,"onUpdate:modelValue":[f[3]||(f[3]=C=>te.value=C),f[4]||(f[4]=C=>Mt(C))],options:$t.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id"},null,8,["modelValue","options"]),Ve.value?(a(),i("div",Wo,E(Et.value),1)):S("",!0)]),t("div",zo,[f[12]||(f[12]=t("label",{class:"input-label"},"Frequency",-1)),o(m(We),{modelValue:ne.value,"onUpdate:modelValue":[f[5]||(f[5]=C=>ne.value=C),f[6]||(f[6]=C=>Ut(C))],options:m(c),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),He.value?(a(),i("div",Yo,E(Pt.value),1)):S("",!0)]),t("div",jo,[f[13]||(f[13]=t("label",{class:"input-label"},"Duration (days)",-1)),o(m(yn),{modelValue:A.value,"onUpdate:modelValue":f[7]||(f[7]=C=>A.value=C),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:nn},null,8,["modelValue"]),R.value?(a(),i("div",Ko,E(d.value),1)):S("",!0)])]),t("div",Xo,[ve.value[0].addItemButton?(a(),F(ke,{key:0,name:ve.value[0].name,fill:ve.value[0].btnFill,icon:m(bn),"onClicked:btn":ve.value[0].fn,class:"save-button"},null,8,["name","fill","icon","onClicked:btn"])):S("",!0),ve.value[1].addItemButton?(a(),F(ke,{key:1,name:ve.value[1].name,fill:ve.value[1].btnFill,icon:m(Dn),"onClicked:btn":ve.value[1].fn,class:"cancel-button"},null,8,["name","fill","icon","onClicked:btn"])):S("",!0)])])),x.value?(a(),F(ke,{key:1,name:$,fill:H,icon:m(dt),"onClicked:btn":Vt,class:"add-new-button"},null,8,["icon"])):S("",!0)])]),t("div",Jo,[o(m(Q),{lines:"none",class:"section-header"},{default:h(()=>[o(m(Le),{icon:m(Sn),class:"section-icon"},null,8,["icon"]),o(m(le),{class:"section-title"},{default:h(()=>f[14]||(f[14]=[B("Non-pharmacological therapy and other notes",-1)])),_:1,__:[14]})]),_:1}),t("div",Qo,[o(Rn,{class:"intervention-component"}),t("div",Zo,[o(m(Q),{class:"notes-input-item"},{default:h(()=>[o(m(Le),{slot:"start",icon:m(n).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),o(m(wn),{modelValue:T.value,"onUpdate:modelValue":f[8]||(f[8]=C=>T.value=C),onIonInput:Jt,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),o(m(ze),{ref:"accordionGroup",class:"previous-notes"},{default:h(()=>[o(m(fe),{value:"fourth","toggle-icon-slot":"start"},{default:h(()=>[o(m(Q),{slot:"header",color:"light",class:"previous-notes-header"},{default:h(()=>[o(m(le),null,{default:h(()=>f[15]||(f[15]=[B("Previous visit notes",-1)])),_:1,__:[15]})]),_:1}),t("div",ei,[t("div",ti,[_.index===1?(a(!0),i(q,{key:0},z(de.value,(C,U)=>(a(),i("div",{key:U,class:"note-entry"},[(a(!0),i(q,null,z(C,(V,K)=>(a(),i("div",{key:K},[t("div",ni,E(V.date),1),t("div",ai,E(V.notes),1)]))),128))]))),128)):S("",!0),o(m(ze),{onIonChange:en},{default:h(()=>[o(m(fe),{value:"third","toggle-icon-slot":"start"},{default:h(()=>[o(m(Q),{slot:"header",color:"light",class:"show-more-header"},{default:h(()=>[o(m(le),{color:"primary"},{default:h(()=>[B(E(me.value),1)]),_:1})]),_:1}),t("div",si,[(a(!0),i(q,null,z(oe.value,(C,U)=>(a(),i("div",{key:U,class:"note-entry"},[(a(!0),i(q,null,z(tn(C),(V,K)=>(a(),i("div",{key:K},[t("div",oi,E(V.date),1),t("div",ii,E(V.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1}))}}),Ci=ue(ri,[["__scopeId","data-v-334d9f69"]]),ci={class:"dash_box"},ui={key:1},di=Z({name:"xxxComponent"}),mi=Z({...di,setup(e){const n=l("No outcome created yet"),c=l(!1),p=l("please select a type");l("Add new outcome"),l(!0);const b=l(!0),x=l(""),v=l(!0),g=l(!1),w=Nn(),u=Y(()=>w.outcomes),y=l(!1),d=l(!1),R=l(!1),r=l(!1),k=l(!1);l(null),l(null);const A=l([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]),P=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:A.value,listUpdatedFN:O,listFilteredFN:()=>{},use_internal_filter:!0,disabled:l(!1)}];function O(s){A.value=s,A.value.forEach(D=>{D.selected==!0&&(x.value=D.name)})}De(async()=>{$()}),ce(()=>x.value,async s=>{y.value==!0?y.value=!1:M()}),ce(()=>u.value.length,async s=>{$()});function L(){A.value.forEach(s=>{s.selected=!1}),x.value=""}function $(){u.value.length>0?v.value=!1:u.value.length==0&&g.value==!1&&(v.value=!0)}function H(s){u.value.splice(s,1)}const I=s=>{};async function M(s=!0){const D=x.value;console.log(D),x.value=D;const T=x.value;T==A.value[0].name?R.value=!0:R.value=!1,T==A.value[1].name?(r.value=!0,console.log("show_discharged_options is set to true")):r.value=!1,T==A.value[2].name?(k.value=!0,console.log("show_discharged_options is set to true")):k.value=!1}function N(){d.value=!1,R.value=!1,r.value=!1,k.value=!1,L()}return(s,D)=>{const T=J("ion-row");return a(),F(m(Be),null,{default:h(()=>[o(T,null,{default:h(()=>[o(m(nt),null,{default:h(()=>[(a(),F(Un,{key:0,"onUpdate:removeItem":H,"onUpdate:editItem":I,displayData:u.value},null,8,["displayData"]))]),_:1})]),_:1}),v.value?(a(),F(T,{key:0},{default:h(()=>[t("span",ci,E(n.value),1)]),_:1})):S("",!0),b.value?(a(),i("div",ui,[o(T,null,{default:h(()=>[o(m(nt),null,{default:h(()=>[o($n,{multiSelection:P[0].multi_Selection,show_label:P[0].show_list_label,uniqueId:P[0].unqueId,name_of_list:P[0].name_of_list,choose_place_holder:P[0].placeHolder,"items_-list":P[0].items,use_internal_filter:P[0].use_internal_filter,disabled:P[0].disabled.value,onItemListUpDated:P[0].listUpdatedFN,onItemListFiltered:P[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),t("div",null,[c.value?(a(),F(m(le),{key:0,class:"error-label"},{default:h(()=>[B(E(p.value),1)]),_:1})):S("",!0)])]),_:1})]),_:1})])):S("",!0),R.value?(a(),F(qn,{key:2,onDataSaved:N,selected_ward_prop:"",admitted_other_props:""})):S("",!0),r.value?(a(),F(Gn,{key:3,onDataSaved:N,selected_referral_data:"",selected_other_referral_data:""})):S("",!0),k.value?(a(),F(Wn,{key:4,onDataSaved:N,selected_discharged_prop:"",selected_discharged_data:""})):S("",!0)]),_:1})}}}),Ai=ue(mi,[["__scopeId","data-v-b6576c18"]]);export{xi as C,Ii as O,co as P,Hs as _,Ci as a,Ai as b,ea as c,js as d,Rs as e};
