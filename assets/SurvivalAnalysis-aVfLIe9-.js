var R=Object.defineProperty;var y=(t,a,e)=>a in t?R(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var d=(t,a,e)=>y(t,typeof a!="symbol"?a+"":a,e);import{bT as G,bR as S,av as f,au as w}from"./index-w0bp8tHE.js";import{l as u}from"./lodash-Dt8AsbQm.js";import{d as q,r as h,c as A,y as O,f as _}from"./vendor-CDoWWVkO.js";import"./apexcharts-BHjAlFBS.js";var b=(t=>(t.GENERAL="General",t.CHILDREN="Children",t.WOMEN="Women",t))(b||{});class C extends G{constructor(){super();d(this,"ageGroup");d(this,"quarter");d(this,"regenerate");this.quarter="",this.regenerate=!1,this.ageGroup="General"}setRegenerate(e){this.regenerate=e}getAgeGroup(){return this.ageGroup}setQuarter(e){this.quarter=e}setAgeGroup(e){this.ageGroup=e}async generateReport(){return this.reportBuilder(await this.getReport("cohort_survival_analysis",{quarter:this.quarter,regenerate:this.regenerate,age_group:this.ageGroup}))}getOutcomeInterval(e){const n=Object.values(e)[0];if(!n)return null;const i=Object.keys(n)[0];return parseInt(i,10)}reportBuilder(e){return Object.entries(e!=null?e:{}).reduce((n,[i,s])=>{if(!u.isEmpty(s)){const o=this.getOutcomeInterval(s),c=u.get(s,"On antiretrovirals.".concat(o),0),r=u.get(s,"Patient died.".concat(o),0),p=u.get(s,"Defaulted.".concat(o),0),v=u.get(s,"Treatment stopped.".concat(o),0),l=u.get(s,"Patient transferred out.".concat(o),0),g=u.get(s,"N/A.".concat(o),0),m=c+r+p+v+l+g;n.push({totalConfirmed:"",subGroup:this.ageGroup,quarter:i,interval:o,alive:c,died:r,defaulted:p,stopped:v,transferred:l,unknown:g,total:m})}return n},[])}}const x=q({__name:"SurvivalAnalysis",setup(t){const a=h(),e=h(),n=h([]),i=h("MoH Survival Analysis Report"),s=[{path:"quarter",label:"Reg Cohort",initialSort:!0,initialSortOrder:"asc",preSort:r=>parseInt(r.split(" ")[1])},{path:"interval",label:"Interval (Months)"},{path:"subGroup",label:"Sub group"},{path:"total",label:"Total Reg (database)"},{path:"totalConfirmed",label:"Total Reg (Confirmed)"},{path:"alive",label:"Alive"},{path:"died",label:"Died"},{path:"defaulted",label:"Defaulted"},{path:"stopped",label:"Stopped"},{path:"transferred",label:"Transferred out"},{path:"unknown",label:"Unknown"}],o=A(()=>[{id:"ageGroup",type:"select",label:"Sub Group:",value:e.value,options:Object.values(b).map(r=>({label:r.match(/Women/i)?"Option B+":r,value:r}))}]);async function c({quarter:r,ageGroup:p},v=!1){await f.show();try{const l=new C;l.setRegenerate(v),l.setQuarter(r.value),l.setAgeGroup(p.value),n.value=await l.generateReport(),i.value="MoH Survival Analysis (".concat(p.value,") Report")}catch(l){w("Unable to load report data"),console.error(l)}await f.hide()}return(r,p)=>(_(),O(S,{title:"MoH Survival Analysis Report","report-type":"MoH",columns:s,rows:n.value,quarter:a.value,useQuarterFilter:"","use-secure-export":"","custom-filters":o.value,filename:i.value,onGenerate:c},null,8,["rows","quarter","custom-filters","filename"]))}});export{x as default};
