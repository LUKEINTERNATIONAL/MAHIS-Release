import{D as je,d as P,af as k,a2 as le,G as q,E as W,ag as re,ab as J,a1 as G,I as U,a8 as L,Q as M,aj as xe,_ as Se,$ as Ve,H as a,e as y,m as I,f as v,k as o,N as A,P as g,K as S,l as n,J as i,a as qe,r as x,u as he,b1 as ee,b8 as Ke,M as te,F as T,eI as Je,ad as Ie,ac as ke,O as Q,i as ie,v as ae,a9 as Z,aa as ne,be as $e,ai as Be,ah as Ne,aP as Ae,cb as Pe,aQ as Me,aO as Te,aR as Oe,ae as _e,c0 as He,L as fe,a0 as Qe,b7 as Ze,a7 as Ye,bg as Xe,d1 as et,d2 as tt,d3 as nt,d4 as st}from"./vendor-BTD4y0_l.js";import{l as N,j as ce,B as de,aH as Ee,M as D,u as z,H as V,_ as O,k as b,t as K,$ as it,S as E,o as H,N as ge,s as at,aI as j,J as ot,cb as lt,b6 as rt,K as w,bi as be,bB as ye,ca as ct,v as dt,cc as De,P as ut}from"./index-CHQBF5A7.js";import{l as R}from"./lodash-Dt8AsbQm.js";import{B as ue}from"./BasicForm-Ci9c4wUc.js";import{_ as se}from"./customDatePicker.vue_vue_type_style_index_0_lang-m9q6nkqi.js";import{az as ht}from"./Stepper-0ZPVa7Oj.js";import{a as Fe}from"./formatServerData-DiKnOMkf.js";import{_ as mt,u as me}from"./SetRelationship.vue_vue_type_script_lang-DDK0Bnho.js";import{v as pt}from"./group_validation-DaCgJLGE.js";import{R as _t}from"./relationship_service-DaY3PhmL.js";import{u as ft}from"./AdministerOtherVaccinesStore-B9OcBTMD.js";import{i as X,s as Re,j as gt,A as vt,n as bt}from"./vaccines_service-CwQdyUM0.js";import{S as We}from"./stock_service-jTxAh0py.js";import{I as yt}from"./barcode-qrcode-reader-CrlC_VHh.js";import{_ as Dt}from"./usePatientProfile-BLyj5mcx.js";import{O as Ct}from"./Outcome-Uh7Bgbps.js";const Ce=[{data:{rowData:[{colData:[{inputHeader:"Systolic Pressure",unit:"mmHg",icon:N.systolicPressure,value:"",name:"Systolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsSystolic"},{inputHeader:"Diastolic pressure",unit:"mmHg",icon:N.diastolicPressure,value:"",name:"Diastolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsDiastolic"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"bp",index:""}],previousView:{name:"vitals"}},{data:{rowData:[{colData:[{inputHeader:"Temperature",unit:"C",icon:N.temprature,value:"",name:"Temperature",eventType:"input",validationFunctionName:"vitalsTemperature",valueType:"number"},{inputHeader:"Pulse rate",unit:"BMP",icon:N.pulse,value:"",name:"Pulse",eventType:"input",validationFunctionName:"vitalsPulseRate",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"temp",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"pulse",index:""}]},{data:{rowData:[{colData:[{inputHeader:"Respiratory rate",unit:"BMP",icon:N.respiratory,value:"",name:"Respiratory rate",eventType:"input",validationFunctionName:"vitalsRespiratoryRate",valueType:"number"},{inputHeader:"Oxygen saturation",unit:"%",icon:N.oxgenStaturation,value:"",name:"SAO2",eventType:"input",validationFunctionName:"vitalsOxygenSaturation",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"respiratory",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"oxygen",index:""}]}],pe=je("immunizationVitalsStore",{state:()=>({vitals:[...Ce]}),actions:{setVitals(e){this.vitals=e},getInitialVitals(){return[...R.cloneDeep(Ce)]}},persist:!0}),wt=P({mixins:[ht],components:{IonContent:L,IonHeader:U,IonItem:G,IonList:J,IonMenu:re,IonTitle:W,IonToolbar:q,IonInput:le,BasicInputField:de,BasicForm:ue,PreviousVitals:ce,customDatePicker:se},data(){return{iconsContent:N,vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1,pulseRate:!1},showPD:!1,todays_date:V.sessionDate(),formOpen:!0}},computed:{...k(z,["patient"]),...k(pe,["vitals"])},async serverPrefetch(){this.updateVitalsStores()},async mounted(){this.cleanVitalForm(),this.vitalsData=this.vitals,await this.setTodayVitals(),await this.validateRowData()},watch:{vitals:{handler(){this.vitalsData=this.vitals},deep:!0},$route:{handler(){this.cleanVitalForm(),this.vitalsData=this.vitals}}},setup(){return{checkmark:Ve,pulseOutline:Se}},methods:{cleanVitalForm(){const e=pe();e.setVitals(e.getInitialVitals())},navigationMenu(e){xe.close(),this.$router.push(e)},updateVitalsStores(){pe().setVitals(this.vitals)},async validateRowData(){const e=D(this.vitals,"Height (cm)","value"),t=D(this.vitals,"Weight","value"),s=D(this.vitals,"Systolic","value"),l=D(this.vitals,"Diastolic","value"),r=D(this.vitals,"Temperature","value"),f=D(this.vitals,"Pulse","value"),c=D(this.vitals,"Respiratory rate","value"),u=D(this.vitals,"SAO2","value");await this.setBMI(e,t),await this.updateBP(s,l);const d=this.getPulseRateStatus(f);await this.updateRate("pulse",f," BMP",d,4);const h=this.getTemperatureStatus(r);this.updateRate("temp",r,"Â°C",h,4);const p=this.getRespiratoryRateStatus(c);this.updateRate("respiratory",c,"BMP",p,6);const _=this.getOxygenSaturationStatus(u);this.updateRate("oxygen",u,"%",_,6)},showCPD(){this.showPD=!0},closeForm(){this.formOpen=!1},async saveVitals(){var t;M.dismiss();const e=await Fe(this.vitals);if(e.length>0){let s=(t=this.patient)==null?void 0:t.vitals;s.unsaved=[...s.unsaved,...e],await Ee(this.patient)}}}}),St={key:0,class:"modal_wrapper"},Vt={class:"OtherVitalsHeading"},It={class:"TodaysDate"},kt={class:""},$t={class:"btnContent"},Bt={class:"saveBtn"};function Nt(e,t,s,l,r,f){const c=a("basic-form"),u=a("customDatePicker"),d=a("ion-icon"),h=a("ion-button");return e.formOpen?(v(),y("div",St,[o("div",Vt,[t[3]||(t[3]=o("div",{class:"OtherVitalsTitle"},"OTHER VITALS",-1)),o("div",It,[t[1]||(t[1]=g("Todays Date: ",-1)),t[2]||(t[2]=o("span",null,null,-1)),g(" "+S(e.todays_date),1)])]),o("div",kt,[n(c,{contentData:e.vitals,"onUpdate:inputValue":t[0]||(t[0]=p=>e.validateRowData())},null,8,["contentData"])]),e.showPD?(v(),A(u,{key:0})):I("",!0),o("div",$t,[o("div",Bt,[o("div",null,[n(h,{class:"btnText",fill:"solid",onClick:e.saveVitals},{default:i(()=>[t[4]||(t[4]=g(" Done today ",-1)),n(d,{slot:"end",size:"small",icon:e.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),t[6]||(t[6]=o("div",null,null,-1)),o("div",null,[n(h,{class:"btnText",fill:"solid",onClick:e.showCPD},{default:i(()=>[t[5]||(t[5]=g(" Done earlier ",-1)),n(d,{slot:"end",size:"small",icon:e.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])])])):I("",!0)}const us=O(wt,[["render",Nt],["__scopeId","data-v-d7374316"]]),At={class:"flex flex-col items-center justify-center mt-6"},Pt={class:"phone mt-6"},Mt={class:"content"},Tt={class:"overlay"},Ot={style:{"margin-top":"20px"}},Ge=P({__name:"QRCodeReader",emits:["scanresult"],setup(e,{emit:t}){qe(async()=>{u()});const s=x(void 0),l=x(!1);function r(_){s.value=_,s.value!=null&&(b().setTempScannedBatchNumber(s.value),p(s.value))}function f(_){l.value=_}const c=x(null);function u(){var _;(_=c.value)==null||_.onCanPlay()}function d(){M.dismiss()}const h=t;function p(_){h("scanresult",_),d()}return(_,m)=>(v(),y(T,null,[o("div",At,[o("div",Pt,[n(he(ee),null,{default:i(()=>[g(S(s.value),1)]),_:1}),o("div",Mt,[o("div",Tt,[n(he(yt),{ref_key:"refCamera",ref:c,capture:"shoot","show-on-stream":"",onOnloading:f,onResult:r},null,512),m[0]||(m[0]=Ke('<div class="focus-frame"></div><div class="dark-overlay top"></div><div class="dark-overlay bottom"></div><div class="dark-overlay left"></div><div class="dark-overlay right"></div>',5))])])])]),o("div",Ot,[n(he(te),{onClick:d,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"99%"}},{default:i(()=>m[1]||(m[1]=[g(" Cancel ",-1)])),_:1,__:[1]})])],64))}}),Ht=P({name:"MyComponent",components:{IonAlert:Je},data(){return{isOpen:!1,alertButtons:[{text:"Close",role:"cancel",cssClass:"alert-danger-button"}],messageContent:"No available batches/lot numbers"}},methods:{setOpen(e){this.isOpen=e},handleDismiss(){this.setOpen(!1),this.$emit("alertClosed"),this.dismiss()},dismiss(){M.dismiss()}},mounted(){this.setOpen(!0)}});function Et(e,t,s,l,r,f){const c=a("ion-alert");return v(),A(c,{"is-open":e.isOpen,header:"Please update stock","sub-header":"",message:e.messageContent,buttons:e.alertButtons,"css-class":"my-custom-alert",onDidDismiss:e.handleDismiss},null,8,["is-open","message","buttons","onDidDismiss"])}const oe=O(Ht,[["render",Et],["__scopeId","data-v-cf655518"]]),Ft=P({components:{IonRadioGroup:ke,IonRadio:Ie,IonItem:G,IonList:J},props:{action:{type:Function,required:!0},retro:{type:Boolean,required:!0}},async mounted(){this.loadCurrentSelectedDrug()},watch:{retro:{handler(){this.checkToShow()},deep:!0}},data(){return{lotNumbers:[],selectedOption:{}}},methods:{compareWith(e,t){return e.id===t.id},handleChange(e){this.selectedOption=e.detail.value},checkIfSelected(){return R.has(this.selectedOption,"lotNumber")||this.checkDrugNameInt()==!0?!0:(K("Select a batch number!"),!1)},performAction(){this.checkIfSelected()==!0&&this.$emit("actionTriggered",this.selectedOption)},async loadCurrentSelectedDrug(){try{const t=b().getCurrentSelectedDrug();await this.formBatchList(t.drug.drug_id)}catch(e){}},async formBatchList(e){try{const s=b().getLotNumberData();s.length==0&&this.$emit("emptyList",""),s.forEach(l=>{const r={id:l.id,lotNumber:l.batch_number};this.lotNumbers.push(r)}),this.checkToShow()}catch(t){}},addUnkownLotNumberOption(){const t=b().getCurrentSelectedDrug();this.lotNumbers.push({id:t.drug.drug_id,lotNumber:"Unknown"})},checkToShow(){this.$props.retro==!0&&this.addUnkownLotNumberOption(),this.checkDrugNameInt()},checkDrugNameInt(){const t=b().getCurrentSelectedDrug();return X(t.drug)==!0?(this.lotNumbers=[],this.lotNumbers.push({id:t.drug.drug_id,lotNumber:"Unknown"}),!0):!1}}});function Rt(e,t,s,l,r,f){const c=a("ion-radio"),u=a("ion-item"),d=a("ion-radio-group"),h=a("ion-list"),p=a("ion-card"),_=a("ion-row");return v(),A(_,null,{default:i(()=>[n(p,{class:"shadowless-card",style:{width:"100%",padding:"0"}},{default:i(()=>[n(h,null,{default:i(()=>[n(d,{compareWith:e.compareWith,onIonChange:t[0]||(t[0]=m=>e.handleChange(m)),value:"start"},{default:i(()=>[(v(!0),y(T,null,Q(e.lotNumbers,m=>(v(),A(u,{key:m.id},{default:i(()=>[n(c,{value:m},{default:i(()=>[g(S(m.lotNumber),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1},8,["compareWith"])]),_:1})]),_:1})]),_:1})}const Ue=O(Ft,[["render",Rt],["__scopeId","data-v-039b66ba"]]),Wt=P({components:{IonContent:L,IonHeader:U,IonItem:G,IonList:J,IonMenu:re,IonTitle:W,IonToolbar:q,IonInput:le,BasicInputField:de,PreviousVitals:ce,customDatePicker:se,lotNumberList:Ue,alert:oe},data(){return{iconsContent:N,showPD:!1,showDateBtns:!0,vaccineDate:"",batchNumber:"",drugName:"",currentDrug:"",is_batch_number_valid:!1,batch_number_error_message:"Enter a valid batch number",full_name:"",sessionDate:V.toStandardHisDisplayFormat(E.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{H(Ge,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},selected_date_:"",is_a_vaccine:!0}},computed:{...k(b,["tempScannedBatchNumber"]),...k(z,["patient"])},setup(){const e=x(null);return{childComponentRef:e,triggerChildAction:()=>{e.value&&e.value.performAction()}}},async mounted(){this.loadCurrentSelectedDrug(),this.displayUserNames();const e=b();this.showPD=e.isVaccinePassed(),this.showDateBtns=!this.showPD},props:{customSchedule:{type:[],default:[]}},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}}},methods:{loadCurrentSelectedDrug(){const e=b();this.currentDrug=e.getCurrentSelectedDrug(),this.drugName=this.currentDrug.drug.drug_name,this.batchNumber=this.currentDrug.drug.vaccine_batch_number?this.currentDrug.drug.vaccine_batch_number:"",X(this.currentDrug.drug)==!0&&(this.is_a_vaccine=!1,this.batchNumber="unknown")},showCPD(){this.showPD=!0,this.showDateBtns=!1},dismiss(){M.dismiss()},updateDate(e){this.vaccineDate=V.toStandardHisFormat(e)},saveBatchWithTodayDate(){let e=E.getSessionDate();this.saveDta(e)},saveBatch(){let e;R.isEmpty(this.vaccineDate)==!0?e=E.getSessionDate():e=this.vaccineDate,this.saveDta(e)},updateBatchNumber(e){var s;const t=e.target.value;this.batchNumber=t||((s=this.tempScannedBatchNumber)==null?void 0:s.text)||""},async ActionTriggered(e){const t={batch_number:e.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrug.drug.drug_id,drug_:this.currentDrug},s=b();s.setAdministeredVaccine(t),await Re(this.patient),s.setTempScannedBatchNumber(null),this.dismiss()},saveDta(e){this.selected_date_=e,this.triggerChildAction()},isAlphaNumeric(e){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(e)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(e){this.batchNumber=e},displayUserNames(){const t=it().getUser(),s=t.person.names[0].given_name,l=t.person.names[0].family_name;this.full_name=s+" "+l},childAction(){},ShowAlert(){}}}),Gt={class:"modal_wrapper"},Ut={class:"lbl-ct"},Lt={class:"client_admi"},zt={class:"client_admin_sub_x"},jt={class:"btnContent"},xt={key:0,class:"saveBtn"},qt={key:1,class:"saveBtn"};function Kt(e,t,s,l,r,f){const c=a("ion-col"),u=a("ion-label"),d=a("ion-row"),h=a("lotNumberList"),p=a("customDatePicker"),_=a("ion-icon"),m=a("ion-button");return v(),y("div",Gt,[n(d,{style:{"margin-top":"10px"}},{default:i(()=>[n(c,{style:{"margin-left":"-3px"}},{default:i(()=>t[0]||(t[0]=[o("div",{class:"om"},"Administer Vaccine",-1)])),_:1,__:[0]}),n(c,{size:"6",style:{"text-align":"right"}},{default:i(()=>[n(u,{class:"lbl-tl",style:{"font-size":"13"}},{default:i(()=>[t[1]||(t[1]=g(" Todays Date: ",-1)),o("span",Ut,S(e.sessionDate),1)]),_:1,__:[1]})]),_:1})]),_:1}),n(d,null,{default:i(()=>[n(u,{style:{"font-weight":"600px","font-size":"20px",margin:"10px","margin-left":"0px"}},{default:i(()=>[g(S(e.drugName),1)]),_:1})]),_:1}),ie(n(d,null,{default:i(()=>[n(u,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:i(()=>t[2]||(t[2]=[g("Select Batch number",-1),o("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[2]})]),_:1},512),[[ae,e.is_a_vaccine]]),ie(o("div",null,[n(h,{action:e.childAction,retro:e.showPD,ref:"childComponentRef",onActionTriggered:e.ActionTriggered,onEmptyList:e.ShowAlert},null,8,["action","retro","onActionTriggered","onEmptyList"])],512),[[ae,e.is_a_vaccine]]),o("div",Lt,[t[3]||(t[3]=o("span",{class:"client_admi_sub"},"Vaccination done by: ",-1)),o("span",zt,S(e.full_name),1)]),e.showPD?(v(),A(p,{key:0,onDateChange:e.updateDate},null,8,["onDateChange"])):I("",!0),o("div",jt,[e.showDateBtns?(v(),y("div",xt,[o("div",null,[n(m,{onClick:e.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:i(()=>[t[4]||(t[4]=g(" Done today ",-1)),n(_,{slot:"end",size:"small",icon:e.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),t[6]||(t[6]=o("div",{style:{"margin-bottom":"20px"}},null,-1)),o("div",null,[n(m,{class:"btnText",fill:"solid",onClick:e.showCPD},{default:i(()=>[t[5]||(t[5]=g(" Done earlier ",-1)),n(_,{slot:"end",size:"small",icon:e.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])):I("",!0),e.showDateBtns?I("",!0):(v(),y("div",qt,[n(d,{"justify-content-between":""},{default:i(()=>[n(c,{size:"auto"},{default:i(()=>[n(m,{onClick:e.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>t[7]||(t[7]=[g(" Cancel ",-1)])),_:1,__:[7]},8,["onClick"])]),_:1}),n(c,{size:"auto",class:"ion-text-end",style:{"margin-left":"auto"}},{default:i(()=>[n(m,{onClick:e.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>t[8]||(t[8]=[g(" Save ",-1)])),_:1,__:[8]},8,["onClick"])]),_:1})]),_:1})]))])])}const we=O(Wt,[["render",Kt],["__scopeId","data-v-58aa351e"]]),Jt=P({components:{IonRow:Z,IonItem:G,IonList:J,IonRadio:Ie,IonRadioGroup:ke},data(){return{reasons:[{id:1,name:"Mistake/ Wrong Entry",type:"Mistake/ Wrong Entry"},{id:2,name:"Duplicate",type:"Duplicate"},{id:3,name:"System Error",type:"System Error"}],selectedOption:{}}},computed:{...k(z,["patient"])},async mounted(){},props:{},methods:{compareWith(e,t){return e.id===t.id},handleChange(e){this.selectedOption=e.detail.value},dismiss(){try{M.dismiss()}catch(e){}},checkIfSelected(){return R.has(this.selectedOption,"name")==!0?!0:(K("Select a reason!"),!1)},async voidVaccine1(){if(this.checkIfSelected()==!0)try{const e=b(),t=e.getVaccineToBeVoided();await gt(this.patient,t,this.selectedOption.name),ge("Vaccine was successfully voided!"),e.setVaccineReload(!e.getVaccineReload()),M.dismiss({voided:!0})}catch(e){}}}}),Qt={class:"saveBtn"};function Zt(e,t,s,l,r,f){const c=a("ion-row"),u=a("ion-radio"),d=a("ion-item"),h=a("ion-radio-group"),p=a("ion-list"),_=a("ion-button"),m=a("ion-col");return v(),y(T,null,[n(c,{class:"centered-content"},{default:i(()=>t[1]||(t[1]=[o("div",{class:"text-container"},[o("div",null,"Do you want to void this vaccine?"),o("div",null,"Please specify reason for voiding this administered vaccine?")],-1)])),_:1,__:[1]}),n(c,null,{default:i(()=>[n(p,{style:{width:"100%"}},{default:i(()=>[n(h,{compareWith:e.compareWith,onIonChange:t[0]||(t[0]=C=>e.handleChange(C)),value:"start"},{default:i(()=>[(v(!0),y(T,null,Q(e.reasons,C=>(v(),A(d,null,{default:i(()=>[n(u,{value:C},{default:i(()=>[g(S(C.name),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1},8,["compareWith"])]),_:1})]),_:1}),o("div",Qt,[n(c,{class:"ion-justify-content-between"},{default:i(()=>[n(m,{size:"auto"},{default:i(()=>[n(_,{onClick:e.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>t[2]||(t[2]=[g(" Cancel ",-1)])),_:1,__:[2]},8,["onClick"])]),_:1}),n(m,{size:"auto"},{default:i(()=>[n(_,{onClick:e.voidVaccine1,class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>t[3]||(t[3]=[g(" Void ",-1)])),_:1,__:[3]},8,["onClick"])]),_:1})]),_:1})])],64)}const Yt=O(Jt,[["render",Zt],["__scopeId","data-v-ea212a62"]]),Xt=P({name:"Home",components:{IonContent:L,IonHeader:U,IonMenuButton:He,IonPage:_e,IonTitle:W,IonToolbar:q,IonButton:te,IonCard:Oe,IonCardContent:Te,IonCardHeader:Me,IonCardSubtitle:Pe,IonCardTitle:Ae,IonAccordion:Ne,IonAccordionGroup:Be,IonItem:G,IonLabel:ee,IonModal:$e,IonCol:ne,IonRow:Z,alert:oe},data(){return{iconsContent:N,fowardData:{}}},computed:{},created(){},mounted(){},props:{vaccines:{type:{},default:{}},milestone_status:{type:String,default:0}},watch:{},setup(){let e=!1;return{isModalOpening:e,cleanupModal:()=>{e=!1;const s=document.querySelector(".pr_o");s&&s.remove()}}},methods:{covertToDate(e){return V.toStandardHisDisplayFormat(e)},getColorForVaccine(e){if(e.status=="administered")return"success";if(e.status!="administered")return this.milestone_status=="upcoming"?"medium":this.milestone_status=="current"?"success":"danger"},getInjectSignForVaccine(e){if(e.status=="administered")return this.iconsContent.greenInjection;if(e.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.fadedGreenIjection},getCheckBoxForVaccine(e){if(e.status=="administered")return this.iconsContent.improvedGreenTick;if(e.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.whiteCheckbox},async openAdministerVaccineModal(e){const t=document.querySelector(".pr_o");if(this.isModalOpening||t){console.log("Modal already open or opening, current state:",{isModalOpening:this.isModalOpening,modalExists:!!t});return}try{this.isModalOpening=!0;const s=b();s.setCurrentSelectedDrug(e);const l=new We,r=await at("stock",{whereClause:{drug_id:e.drug_id}});s.setLotNumberData(r),this.checkIfAdminstredAndAskToVoid()||(r.length===0?X(e)?H(we,{class:"otherVitalsModal pr_o"}):H(oe,{class:"otherVitalsModal pr_o"}):H(we,{class:"otherVitalsModal pr_o"}))}catch(s){throw console.error("Error opening modal:",s),s}finally{this.isModalOpening=!1,console.log("Modal open process completed")}},disableVaccine(e){if(e.status!=null&&e.status=="administered")return!1;if(e.can_administer!=null&&e.can_administer==!1)return!0;if(e.can_administer!=null&&e.can_administer==!0)return!1},checkVaccineName(e){return e.replace(/Pentavalent/g,"Penta")},checkIfAdminstredAndAskToVoid(){const e=b(),t=e.getCurrentSelectedDrug();return t.drug.status=="administered"?(e.setVaccineToBeVoided(t),H(Yt,{class:"otherVitalsModal"},!1),!0):!1}}}),en={class:"vaccinesList"},tn={class:"button-content"},nn={style:{"margin-top":"20px"}};function sn(e,t,s,l,r,f){const c=a("ion-icon"),u=a("ion-button"),d=a("ion-col"),h=a("ion-row");return v(),y("div",en,[n(h,null,{default:i(()=>[n(d,null,{default:i(()=>[(v(!0),y(T,null,Q(e.vaccines,p=>(v(),A(u,{disabled:e.disableVaccine(p),class:"administerVac",key:p,onClick:_=>e.openAdministerVaccineModal(p),fill:"solid",color:e.getColorForVaccine(p),style:{background:"#ddeedd","border-radius":"8px",color:"#636363"}},{default:i(()=>[n(c,{slot:"start",icon:e.getInjectSignForVaccine(p)},null,8,["icon"]),o("div",tn,[o("div",nn,S(e.checkVaccineName(p.drug_name)),1),o("div",null,S(e.covertToDate(p.date_administered)),1)]),n(c,{slot:"end",icon:e.getCheckBoxForVaccine(p)},null,8,["icon"])]),_:2},1032,["disabled","onClick","color"]))),128))]),_:1})]),_:1})])}const ve=O(Xt,[["render",sn],["__scopeId","data-v-90bda1b0"]]),an=P({name:"Home",components:{IonIcon:Qe,IonButton:te,customVaccine:ve,IonHeader:U,IonTitle:W,IonFooter:fe,IonCol:ne,IonRow:Z,IonContent:L},data(){return{iconsContent:N,vaccineHistory:[]}},setup(){return{closeCircleOutline:Ye,checkmarkOutline:Ze}},computed:{...k(b,["vaccineReload","vaccineSchedule"])},methods:{vaccinesGivenCount(e){const t=[];return e.antigens.forEach(s=>{s.status=="administered"&&t.push(s)}),t.length},dismiss(){M.dismiss()}}}),on={style:{color:"#016302"}},ln={style:{color:"#316CBA","margin-left":"10%"}};function rn(e,t,s,l,r,f){const c=a("ion-title"),u=a("ion-header"),d=a("ion-icon"),h=a("row"),p=a("customVaccine"),_=a("ion-content"),m=a("ion-button"),C=a("ion-col"),B=a("ion-row"),F=a("ion-footer");return v(),y(T,null,[n(u,null,{default:i(()=>[n(c,{style:{"margin-bottom":"20px"},class:"modalTitle OtherVitalsTitle"},{default:i(()=>t[1]||(t[1]=[g("Vaccination History",-1)])),_:1,__:[1]})]),_:1}),n(_,{fullscreen:!0,class:"ion-padding"},{default:i(()=>[(v(!0),y(T,null,Q(e.vaccineSchedule.vaccine_schedule,($,Y)=>(v(),y("div",{class:"mod-ls",key:Y},[n(h,null,{default:i(()=>[n(d,{size:"medium",style:{"margin-bottom":"-6px"},icon:e.iconsContent.calendar},null,8,["icon"]),o("span",null,[t[2]||(t[2]=g(" at ",-1)),o("span",on,S($.age),1)]),o("span",ln,S(e.vaccinesGivenCount($))+"/"+S($.antigens.length)+" vaccine(s) given",1)]),_:2},1024),n(h,null,{default:i(()=>[n(p,{vaccines:$.antigens,milestone_status:$.milestone_status},null,8,["vaccines","milestone_status"])]),_:2},1024)]))),128))]),_:1}),n(F,{collapse:"fade",class:"ion-no-border"},{default:i(()=>[n(B,null,{default:i(()=>[n(C,null,{default:i(()=>[n(m,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:t[0]||(t[0]=$=>e.dismiss())},{default:i(()=>t[3]||(t[3]=[g(" Cancel ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1})],64)}const hs=O(an,[["render",rn],["__scopeId","data-v-59edb4e4"]]),cn=P({mixins:[mt],components:{IonContent:L,IonHeader:U,IonItem:G,IonList:J,IonMenu:re,IonTitle:W,IonToolbar:q,IonInput:le,BasicInputField:de,BasicForm:ue,PreviousVitals:ce,customDatePicker:se,DynamicButton:ot,IonFooter:fe},data(){return{iconsContent:N,BMI:{},BPStatus:{},vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1},showPD:!1,initialSeriousData:[],initialFirstDecisionData:[],initialOutcomeData:[]}},props:{protectedStatus:String,lastVaccinesGiven:Array},watch:{personInformation:{async handler(){await this.setRelationShip()},deep:!0}},computed:{...k(z,["patient"]),...k(me,["changeGuardianInfo","vaccineAdverseEffects","protectedAtBirth","serious","outcome","firstDecision"]),guardianFirstname(){return D(this.changeGuardianInfo,"guardianFirstname","value")},guardianLastname(){return D(this.changeGuardianInfo,"guardianLastname","value")},guardianMiddleName(){return D(this.changeGuardianInfo,"guardianMiddleName","value")},guardianPhoneNumber(){return D(this.changeGuardianInfo,"guardianPhoneNumber","value")},relationship(){return D(this.changeGuardianInfo,"relationship","value")}},async mounted(){await this.setupData()},setup(){return{checkmark:Ve,pulseOutline:Se}},methods:{async setupData(){var s,l,r,f,c,u,d,h,p,_;const e=me();this.initialSeriousData=e.getInitialSerious(),this.initialFirstDecisionData=e.getInitialFirstDecision(),this.initialOutcomeData=e.getInitialOutcome();const t=await _t.getRelationships(this.patient.patientID);(t==null?void 0:t.length)>0&&(w(this.changeGuardianInfo,"guardianNationalID","value",this.setAttribute("Regiment ID",(s=t[0])==null?void 0:s.relation)),w(this.changeGuardianInfo,"guardianFirstname","value",(r=(l=t[0])==null?void 0:l.relation.names[0])==null?void 0:r.given_name),w(this.changeGuardianInfo,"guardianLastname","value",(c=(f=t[0])==null?void 0:f.relation.names[0])==null?void 0:c.family_name),w(this.changeGuardianInfo,"guardianMiddleName","value",(d=(u=t[0])==null?void 0:u.relation.names[0])==null?void 0:d.middle_name),w(this.changeGuardianInfo,"guardianPhoneNumber","value",this.setAttribute("Cell Phone Number",(h=t[0])==null?void 0:h.relation)),w(this.changeGuardianInfo,"relationship","value",{id:(p=t[0])==null?void 0:p.type.relationship_type_id,name:(_=t[0])==null?void 0:_.type.b_is_to_a}),await this.setRelationShip()),this.resetData()},async setRelationShip(){this.gender?(await this.getRelationships(),w(this.changeGuardianInfo,"relationship","displayNone",!1),w(this.changeGuardianInfo,"relationship","multiSelectData",this.relationships)):w(this.changeGuardianInfo,"relationship","displayNone",!0)},setAttribute(e,t){if(!t||Object.keys(t).length===0)return;let s=t.person_attributes.find(l=>l.type.name==e);if(s!=null)return s.value},resetData(){const e=me();e.setProtectedAtBirth(e.getInitialProtectedAtBirth()),e.setVaccineAdverseEffects(e.getInitialVaccineAdverseEffects())},async createGuardian(){const e=await this.guardianData();if(pt(this.changeGuardianInfo)){const t=new lt;await t.registerGuardian(e);const s=t.getPersonID(),l=D(this.changeGuardianInfo,"relationship","value").id;return l&&await rt.createRelation(this.patient.patientID,s,l),ge("Guarding information save successfully",3e3),!0}else return K("Guarding Information not save",3e3),!1},async saveData(){const e=await this.createGuardian(),t=await this.saveVaccineAdverseEffects();e&&t&&M.dismiss()},async saveVaccineAdverseEffects(){if(this.patient.patientID){const e=D(this.outcome,"Date of death","value")||V.sessionDate(),t=await this.formatCheckBoxData(this.serious,V.sessionDate(),this.lastVaccinesGiven),s=await this.formatRadioButtonData(this.outcome,e,this.lastVaccinesGiven),l=await this.formatCheckBoxData(this.vaccineAdverseEffects,V.sessionDate(),this.lastVaccinesGiven),r=D(this.firstDecision,"Investigation needed","value");let f=[];return r&&(f=[{concept_id:11887,value_text:r,obs_datetime:V.sessionDate()}]),[...t,...s,...l,...f].filter(c=>c!==void 0),E.getUserID(),l.length>0?!0:(K("Vaccine adverse effects not saved",1500),!1)}},async formatCheckBoxData(e,t=j.getSessionDate(),s){return Array.isArray(e)?(await Promise.all(e.map(async r=>{var c,u;if(!((u=(c=r==null?void 0:r.checkboxBtnContent)==null?void 0:c.data)!=null&&u.length))return[];const f=r.checkboxBtnContent.data.map(async d=>{if(!(d!=null&&d.checked)||d!=null&&d.buildConceptIgnore)return null;try{const h=await j.getConceptID(d.value,!0),p=await j.getConceptID(r.checkboxBtnContent.header.name,!0);if(t=D(e,d.name+" date","value")||t,!h||!p)return null;const m={concept_id:p,value_coded:h,obs_datetime:t};if(s.length>0){const C=s.map(B=>({concept_id:h,value_coded:B.drug_id,obs_datetime:t}));return{...m,child:C}}return m}catch(h){return console.error("Error processing checkbox data:",h),null}});return(await Promise.all(f)).filter(Boolean)}))).flat().filter(Boolean):[]},async formatRadioButtonData(e,t=j.getSessionDate(),s){const l=e.map(async r=>{if(r&&r.radioBtnContent&&r.radioBtnContent.header&&r.radioBtnContent.header.selectedValue){const f=await j.getConceptID(r.radioBtnContent.header.selectedValue,!0),c=await j.getConceptID(r.radioBtnContent.header.name,!0),u=t||j.getSessionDate(),d=s.map(h=>({concept_id:f,value_coded:h.drug_id,obs_datetime:u}));return s?{concept_id:c,value_coded:f,obs_datetime:u,child:d}:{concept_id:c,value_coded:f,obs_datetime:u}}else return null});return(await Promise.all(l)).filter(r=>r!==null)},async guardianData(){return{person_id:this.patient.patientID,given_name:this.guardianFirstname,family_name:this.guardianLastname,middle_name:this.guardianMiddleName,gender:"",birthdate:"",cell_phone_number:this.guardianPhoneNumber,birthdate_estimated:!1,home_district:"",home_traditional_authority:"",home_village:"",current_district:"",current_traditional_authority:"",current_village:"",landmark:"",occupation:"",facility_name:"",patient_type:"",national_id:D(this.changeGuardianInfo,"guardianNationalID","value")}},async handleInputData(e){},dismiss(){M.dismiss()}}}),dn={class:""},un={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},hn={class:""},mn={class:"ion-padding",slot:"content"},pn={slot:"content"},_n={slot:"content"},fn={slot:"content"},gn={slot:"content"},vn={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}};function bn(e,t,s,l,r,f){const c=a("ion-title"),u=a("ion-icon"),d=a("ion-header"),h=a("ion-label"),p=a("ion-item"),_=a("basic-form"),m=a("ion-accordion"),C=a("ion-accordion-group"),B=a("ion-content"),F=a("DynamicButton"),$=a("ion-col"),Y=a("ion-row"),Le=a("ion-footer");return v(),y(T,null,[n(d,{style:{display:"flex","justify-content":"space-between"}},{default:i(()=>[n(c,{class:"modalTitle"},{default:i(()=>t[2]||(t[2]=[g("Follow up visits",-1)])),_:1,__:[2]}),n(u,{onClick:t[0]||(t[0]=ze=>e.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:e.iconsContent.cancel},null,8,["icon"])]),_:1}),n(B,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:i(()=>[o("div",dn,[n(C,{ref:"accordionGroup",class:""},{default:i(()=>[n(m,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:i(()=>[n(p,{slot:"header",color:"light"},{default:i(()=>[n(h,{class:"previousLabel"},{default:i(()=>t[3]||(t[3]=[g("Change Guardian",-1)])),_:1,__:[3]})]),_:1}),o("div",un,[o("div",hn,[n(_,{contentData:e.changeGuardianInfo,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","onUpdate:inputValue"])])])]),_:1}),n(m,{value:"second","toggle-icon-slot":"start",class:"custom_card"},{default:i(()=>[n(p,{slot:"header",color:"light"},{default:i(()=>[n(h,{class:"previousLabel"},{default:i(()=>t[4]||(t[4]=[g("Vaccine adverse effects",-1)])),_:1,__:[4]})]),_:1}),o("div",mn,[o("div",null,[o("div",pn,[n(_,{contentData:e.vaccineAdverseEffects,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","onUpdate:inputValue"])])]),o("div",null,[o("div",_n,[n(_,{contentData:e.serious,initialData:e.initialSeriousData,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])]),o("div",null,[o("div",fn,[n(_,{contentData:e.outcome,initialData:e.initialOutcomeData,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])]),o("div",null,[o("div",gn,[n(_,{contentData:e.firstDecision,initialData:e.initialFirstDecisionData,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])])])]),_:1}),e.protectedStatus!="Yes"?(v(),A(m,{key:0,value:"third","toggle-icon-slot":"start",class:"custom_card"},{default:i(()=>[n(p,{slot:"header",color:"light"},{default:i(()=>[n(h,{class:"previousLabel"},{default:i(()=>t[5]||(t[5]=[g("Child protected at birth",-1)])),_:1,__:[5]})]),_:1}),o("div",vn,[n(_,{contentData:e.protectedAtBirth,"onUpdate:inputValue":e.handleInputData},null,8,["contentData","onUpdate:inputValue"])])]),_:1})):I("",!0)]),_:1},512)])]),_:1}),n(Le,{collapse:"fade",class:"ion-no-border"},{default:i(()=>[n(Y,null,{default:i(()=>[n($,null,{default:i(()=>[n(F,{onClick:t[1]||(t[1]=ze=>e.saveData()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const ms=O(cn,[["render",bn],["__scopeId","data-v-4497bb3f"]]),yn=P({name:"Home",components:{IonContent:L,IonHeader:U,IonPage:_e,IonTitle:W,IonToolbar:q,BasicForm:ue,customDatePicker:se},data(){return{popoverOpen:!1,iconContent:N,event:null,BMI:"",showPD:!1,vitals_date:V.toStandardHisFormat(V.sessionDate()),formOpen:!0,checkUnderSixWeeks:!1,showDateBtns:!0}},computed:{...k(z,["patient"]),...k(ct,["vitalsWeightHeight"])},watch:{patient:{async handler(){this.checkAge()}}},mounted(){this.checkAge()},setup(){},methods:{checkAge(){var e,t,s,l;R.isEmpty((t=(e=this.patient)==null?void 0:e.personInformation)==null?void 0:t.birthdate)||(this.checkUnderSixWeeks=V.dateDiffInDays(V.sessionDate(),(l=(s=this.patient)==null?void 0:s.personInformation)==null?void 0:l.birthdate)<42,this.controlHeight())},nav(e){this.$router.push(e)},formatBirthdate(){var e,t;return V.getBirthdateAge((t=(e=this.patient)==null?void 0:e.personInformation)==null?void 0:t.birthdate)},controlHeight(){this.checkUnderSixWeeks?(w(this.vitalsWeightHeight,"Height (cm)","inputHeader","Height"),w(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!0)):w(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!1)},async validaterowData(e){const t=E.getUserID(),s=new ye(this.patient.patientID,t),l=D(this.vitalsWeightHeight,"weight","value"),r=D(this.vitalsWeightHeight,"Height (cm)","value"),f=s.validator({inputHeader:"Height*",value:r}),c=s.validator({inputHeader:"Weight*",value:l});f&&r?w(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",f.flat(1/0)[0]):w(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",""),c&&l?w(this.vitalsWeightHeight,"weight","alertsErrorMassage",c.flat(1/0)[0]):w(this.vitalsWeightHeight,"weight","alertsErrorMassage",""),this.setBMI(l,r)},async saveVitals(){const e=E.getUserID(),t=new ye(this.patient.patientID,e),s=D(this.vitalsWeightHeight,"weight","value"),l=D(this.vitalsWeightHeight,"Height (cm)","value");let r=null;this.checkUnderSixWeeks||(r=t.validator({inputHeader:"Height*",value:l}));const f=t.validator({inputHeader:"Weight*",value:s}),c=await Fe(this.vitalsWeightHeight);if(c.length>0&&f==null&&r==null){const u=JSON.parse(JSON.stringify(this.patient));let d=u==null?void 0:u.vitals;d.unsaved=[...d.unsaved,...c],await Ee(u),ge("Vitals saved successful"),this.cleanInputFields()}else K("Please complete the form")},cleanInputFields(){w(this.vitalsWeightHeight,"weight","value",""),w(this.vitalsWeightHeight,"Height (cm)","value",""),this.dismiss()},dismiss(){M.dismiss()},async setBMI(e,t){var s,l,r,f,c,u,d,h;(l=(s=this.patient)==null?void 0:s.personInformation)!=null&&l.gender&&((f=(r=this.patient)==null?void 0:r.personInformation)!=null&&f.birthdate)&&(this.BMI=await be.getBMI(parseInt(e),parseInt(t),(u=(c=this.patient)==null?void 0:c.personInformation)==null?void 0:u.gender,V.calculateAge((h=(d=this.patient)==null?void 0:d.personInformation)==null?void 0:h.birthdate,V.sessionDate()))),this.updateBMI()},async updateBMI(){var s,l,r,f,c,u;const e=(l=(s=this.BMI)==null?void 0:s.color)!=null?l:[],t=this.vitalsWeightHeight[0].alerts[0];t.icon=be.iconBMI(e),t.backgroundColor=e[0],t.textColor=e[1],t.index="BMI "+((f=(r=this.BMI)==null?void 0:r.index)!=null?f:""),t.value=(u=(c=this.BMI)==null?void 0:c.result)!=null?u:""},showCPD(){this.showPD=!0,this.showDateBtns=!1},updateDate(e){this.vitals_date=V.toStandardHisFormat(e)}}}),Dn={key:0,class:"pim-cls-1 modal_wrapper"},Cn={class:"center text_12"},wn={class:"btnContent"},Sn={key:0,class:"saveBtn"},Vn={key:1,class:"saveBtn"};function In(e,t,s,l,r,f){const c=a("BasicForm"),u=a("ion-row"),d=a("customDatePicker"),h=a("ion-icon"),p=a("ion-button"),_=a("ion-col");return e.formOpen?(v(),y("div",Dn,[t[7]||(t[7]=o("div",{class:"OtherVitalsHeading"},[o("div",{class:"OtherVitalsTitle"},"Add Weight/Height")],-1)),o("div",null,[o("div",Cn,[n(u,null,{default:i(()=>[n(c,{contentData:e.vitalsWeightHeight,"onUpdate:inputValue":t[0]||(t[0]=m=>e.validaterowData(m))},null,8,["contentData"])]),_:1})])]),e.showPD?(v(),A(d,{key:0,onDateChange:e.updateDate},null,8,["onDateChange"])):I("",!0),o("div",wn,[e.showDateBtns?(v(),y("div",Sn,[o("div",null,[n(p,{class:"btnText",fill:"solid",onClick:t[1]||(t[1]=m=>e.saveVitals())},{default:i(()=>[t[3]||(t[3]=g(" Done today ",-1)),n(h,{slot:"end",size:"small",icon:e.iconContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[3]})]),o("div",null,[n(p,{class:"btnText",fill:"solid",onClick:e.showCPD},{default:i(()=>[t[4]||(t[4]=g(" Done earlier ",-1)),n(h,{slot:"end",size:"small",icon:e.iconContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])])])):I("",!0),e.showDateBtns?I("",!0):(v(),y("div",Vn,[n(u,null,{default:i(()=>[n(_,null,{default:i(()=>[n(p,{onClick:e.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>t[5]||(t[5]=[g(" Cancel ",-1)])),_:1,__:[5]},8,["onClick"])]),_:1}),n(_,null,{default:i(()=>[n(p,{onClick:t[2]||(t[2]=m=>e.saveVitals()),class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>t[6]||(t[6]=[g(" save ",-1)])),_:1,__:[6]})]),_:1})]),_:1})]))])])):I("",!0)}const ps=O(yn,[["render",In],["__scopeId","data-v-7b242731"]]),kn=P({components:{IonContent:L,IonHeader:U,IonItem:G,IonList:J,IonMenu:re,IonTitle:W,IonToolbar:q,IonInput:le,BasicInputField:de,BasicForm:ue,PreviousVitals:ce,customDatePicker:se,IonCol:ne,IonRow:Z,VueMultiselect:Xe,IonLabel:ee,lotNumberList:Ue},data(){const e=x(0),t=x([]);return{iconsContent:N,showPD:!1,batchNumber:"",vaccineName:"",currentDrugOb:{},comp_key:e,otherVaccinesList:t,is_batch_number_valid:!1,vaccineDate:"",is_vaccine_name_valid:!1,drugErrMsg:"",batch_number_error_message:"Enter a valid batch number",vaccine_name_error_message:"Enter a valid valid vaccine name",sessionDate:V.toStandardHisDisplayFormat(E.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{H(Ge,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},showDateBtns:!0,selected_date_:"",show_select_batch:!1,skip_validation:!1,antigens:t}},computed:{...k(ft,["administerOtherVaccine"]),...k(b,["tempScannedBatchNumber","vaccineSchedule"]),...k(z,["patient"])},async mounted(){this.vaccineSchedule.vaccine_schedule.forEach(e=>{this.antigens.push(...e.antigens)})},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}},vaccineName:{handler(){this.validateVaccineName()}}},setup(){const e=x(null);return{childComponentRef:e,triggerChildAction:()=>{e.value&&e.value.performAction()}}},methods:{showCPD(){this.showPD=!0,this.showDateBtns=!1},updateBatchNumber(e){var s;const t=e.target.value;this.batchNumber=t||((s=this.tempScannedBatchNumber)==null?void 0:s.text)||""},saveBatchWithTodayDate(){let e=E.getSessionDate();this.saveDta(e)},dismiss(){M.dismiss()},saveBatch(){let e;R.isEmpty(this.vaccineDate)==!0?e=E.getSessionDate():e=this.vaccineDate,this.saveDta(e)},validateVaccineName(){if(R.isEmpty(this.vaccineName)==!0)return this.is_vaccine_name_valid=!0,!1;if(R.isEmpty(this.vaccineName)==!1)return this.is_vaccine_name_valid=!1,!0},updateVaccineName(e){this.currentDrugOb=e,console.log(this.currentDrugOb),b().setCurrentSelectedDrug(e),this.pullLotNumbersForVaccine(this.currentDrugOb)},async pullLotNumbersForVaccine(e){this.show_select_batch=!1;const t=b(),l=await new We().getDrugBatches(e.drug_id);t.setLotNumberData(l),l.length==0&&(X(e)==!1&&H(oe,{class:"otherVitalsModal"}),X(e)==!0&&(this.show_select_batch=!1,this.skip_validation=!0)),l.length>0&&(this.comp_key=this.comp_key+1,this.show_select_batch=!0)},isAlphaNumeric(e){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(e)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(e){this.batchNumber=e},ActionTriggered(e){const t={batch_number:e.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrugOb.drug_id,drug_:this.currentDrugOb},s=b();s.setAdministeredVaccine(t),Re(this.patient),s.setTempScannedBatchNumber(null),this.dismiss()},saveDta(e){this.validateVaccineName()==!0&&(this.selected_date_=e,this.triggerChildAction(),this.show_select_batch==!1&&this.skip_validation==!1&&dt("Please Update Stock for Selected Vaccine"))},childAction(){}}}),$n={class:"modal_wrapper"},Bn={class:"lbl-ct"},Nn={style:{"margin-top":"30px"}},An={class:"btnContent"},Pn={key:0,class:"saveBtn"},Mn={key:1,class:"saveBtn"};function Tn(e,t,s,l,r,f){const c=a("ion-col"),u=a("ion-label"),d=a("ion-row"),h=a("VueMultiselect"),p=a("lotNumberList"),_=a("customDatePicker"),m=a("ion-icon"),C=a("ion-button");return v(),y("div",$n,[n(d,{style:{"margin-top":"10px"}},{default:i(()=>[n(c,{style:{"margin-left":"-3px"}},{default:i(()=>t[3]||(t[3]=[o("div",{class:"om"},"Add Other Vaccine",-1)])),_:1,__:[3]}),n(c,{size:"6",style:{"text-align":"right"}},{default:i(()=>[n(u,{class:"lbl-tl",style:{"font-size":"13"}},{default:i(()=>[t[4]||(t[4]=g(" Todays Date: ",-1)),o("span",Bn,S(e.sessionDate),1)]),_:1,__:[4]})]),_:1})]),_:1}),o("div",Nn,[n(d,null,{default:i(()=>[n(u,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:i(()=>t[5]||(t[5]=[g("Vaccine name",-1),o("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[5]})]),_:1}),n(h,{modelValue:e.vaccineName,"onUpdate:modelValue":[t[0]||(t[0]=B=>e.vaccineName=B),t[1]||(t[1]=B=>e.updateVaccineName(B))],multiple:!1,taggable:!1,"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"select vaccine",placeholder:"select vaccine",selectLabel:"",label:"drug_name",searchable:!0,onSearchChange:t[2]||(t[2]=B=>e.$emit("search-change",B)),"track-by":"drug_id",options:e.otherVaccinesList},null,8,["modelValue","options"]),o("div",null,[e.is_vaccine_name_valid?(v(),A(u,{key:0,style:{padding:"3%"},class:"error-label"},{default:i(()=>[g(S(e.vaccine_name_error_message),1)]),_:1})):I("",!0)])]),ie(n(d,null,{default:i(()=>[n(u,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:i(()=>t[6]||(t[6]=[g("Batch numbers",-1),o("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[6]})]),_:1},512),[[ae,e.show_select_batch]]),ie(o("div",null,[(v(),A(p,{action:e.childAction,retro:e.showPD,ref:"childComponentRef",onActionTriggered:e.ActionTriggered,key:e.comp_key},null,8,["action","retro","onActionTriggered"]))],512),[[ae,e.show_select_batch]]),e.showPD?(v(),A(_,{key:0})):I("",!0),o("div",An,[e.showDateBtns?(v(),y("div",Pn,[o("div",null,[n(C,{onClick:e.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:i(()=>[t[7]||(t[7]=g(" Done today ",-1)),n(m,{slot:"end",size:"small",icon:e.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[7]},8,["onClick"])]),t[9]||(t[9]=o("div",{style:{"margin-bottom":"20px"}},null,-1)),o("div",null,[n(C,{class:"btnText",fill:"solid",onClick:e.showCPD},{default:i(()=>[t[8]||(t[8]=g(" Done earlier ",-1)),n(m,{slot:"end",size:"small",icon:e.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[8]},8,["onClick"])])])):I("",!0),e.showDateBtns?I("",!0):(v(),y("div",Mn,[n(d,{class:"ion-justify-content-between"},{default:i(()=>[n(c,{size:"auto"},{default:i(()=>[n(C,{onClick:e.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:i(()=>t[10]||(t[10]=[g(" Cancel ",-1)])),_:1,__:[10]},8,["onClick"])]),_:1}),n(c,{size:"auto"},{default:i(()=>[n(C,{onClick:e.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:i(()=>t[11]||(t[11]=[g(" Save ",-1)])),_:1,__:[11]},8,["onClick"])]),_:1})]),_:1})]))])])}const On=O(kn,[["render",Tn],["__scopeId","data-v-eb04f444"]]),Hn=P({name:"xxxComponent",components:{Carousel:st,Slide:nt,Pagination:tt,Navigation:et,customVaccine:ve,IonButton:te,IonCol:ne,IonRow:Z,IonLabel:ee},data(){return{vaccine_schArray:[],vaccineSchudulesCount:0,milestones:[],iconsContent:N,showCurrentMilestoneAlert:!1,landingSlide:0,msg:"Upcoming Vaccines",current_milestone:"",componentKey:0}},computed:{...k(b,["vaccineReload"]),...k(z,["patient"])},async mounted(){await this.loadVaccineSchedule()},watch:{vaccineReload:{async handler(){await this.loadVaccineSchedule()},deep:!0},patient:{async handler(){await this.loadVaccineSchedule()},deep:!0},vaccine_schArray:{handler(){this.reloadVaccines()}}},methods:{openAdministerOtherVaccineModal(){H(On,{class:"otherVitalsModal"})},async loadVaccineSchedule(){var l,r,f,c,u,d,h,p,_;await this.setAppointmentDate();const e=this.patient.vaccineSchedule,t=b();t.setVaccineSchedule(e),t.setLastVaccinesGiven([]),this.vaccineSchudulesCount=(r=(l=t.getVaccineSchedule())==null?void 0:l.vaccine_schedule)==null?void 0:r.length,t.resetMissedVaccineSchedules(),this.vaccine_schArray=[],this.vaccine_schArray.push((f=t.getVaccineSchedule())==null?void 0:f.vaccine_schedule),(u=(c=t.getVaccineSchedule())==null?void 0:c.vaccine_schedule)==null||u.forEach(m=>{this.findMissingVaccines(m),this.findPreviouslyAdministeredVaccineSchedule(m),this.handleSchedule(m);const C={visit:m.visit,age:m.age};this.milestones=this.appendUniqueObject(this.milestones,C)});let s=!1;(h=(d=t.getVaccineSchedule())==null?void 0:d.vaccine_schedule)==null||h.forEach(m=>{if(!s&&this.findSingleUpcomingMilestone(m)==!0){s=!0;return}}),(_=(p=t.getVaccineSchedule())==null?void 0:p.vaccine_schedule)==null||_.forEach(m=>{this.findCurrentMilestone(m)})},setSB(e){const t=b();t.setCurrentMilestoneToAdminister({currentMilestone:e.age}),this.landingSlide=e.visit-1,this.current_milestone=e.age,t.setCurrentMilestone(e.age)},handleSchedule(e){e.milestone_status=="upcoming"?(b().setCurrentSchedFound(!1),this.msg="Upcoming Vaccines",this.showCurrentMilestoneAlert=!0,this.setSB(e)):(this.setSB(e),b().setCurrentSchedFound(!1))},findSingleUpcomingMilestone(e){return e.milestone_status=="upcoming"?(this.setSB(e),!0):!1},findCurrentMilestone(e){e.milestone_status=="current"&&(this.msg="Vaccines due today",b().setCurrentSchedFound(!0),this.showCurrentMilestoneAlert=!0,this.setSB(e))},slideEvent(e){const t=b(),s=t.getCurrentMilestoneToAdminister();this.milestones.forEach(r=>{r.visit-1==e.currentSlideIndex&&(t.setCurrentMilestone(r.age),this.current_milestone=r.age)});const l=t.getCurrentMilestone();if(l==s.currentMilestone){t.getCurrentSchedFound()==!1&&(this.msg="Upcoming Vaccines"),t.getCurrentSchedFound()==!0&&(this.msg="Vaccines due today"),this.showCurrentMilestoneAlert=!0;return}l.age!=s.currentMilestone&&(this.showCurrentMilestoneAlert=!1)},appendUniqueObject(e,t){return e.some(l=>l.visit===t.visit&&l.age===t.age)||e.push(t),e},isListEmpty(e){if(e.length>0)return!0;if(e.length==0)return!1},findMissingVaccines(e){const t={age:e.age,antigens:[]};e.milestone_status=="passed"&&e.antigens.forEach(l=>{l.status=="pending"&&t.antigens.push(l)});const s=b();t.antigens.length>0&&s.setMissedVaccineSchedules(t)},findPreviouslyAdministeredVaccineSchedule(e){const t=[];e.antigens.forEach(s=>{s.status=="administered"&&t.push(s)}),t.length>0&&b().setLastVaccinesGiven(t)},reloadVaccines(){this.componentKey+=1},openNextVaccineAppoinment(){H(bt,{class:"otherVitalsModal"},!1)},async setAppointmentDate(){const e=b(),s=await new vt().getNextAppointment();s!=null&&s.next_appointment_date&&e.setNextAppointMentDate(s.next_appointment_date)}}}),En={key:0,class:"alert_banner"},Fn={key:1,class:"alert_banner",style:{background:"inherit"}},Rn={class:"container"},Wn={class:"center-content"},Gn={class:"centerBtns"},Un={class:"otherVaccine center-content"},Ln={class:"centerBtns"};function zn(e,t,s,l,r,f){const c=a("apan"),u=a("customVaccine"),d=a("ion-button"),h=a("ion-row"),p=a("slide"),_=a("navigation"),m=a("pagination"),C=a("carousel");return v(),y(T,null,[e.showCurrentMilestoneAlert?(v(),y("div",En,[n(c,null,{default:i(()=>[g(S(e.msg),1)]),_:1})])):I("",!0),e.showCurrentMilestoneAlert?I("",!0):(v(),y("div",Fn)),e.vaccineSchudulesCount>0?(v(),A(C,{key:2,"items-to-show":1,modelValue:e.landingSlide,onSlideEnd:e.slideEvent},{addons:i(()=>[n(_),n(m)]),default:i(()=>[(v(!0),y(T,null,Q(e.vaccineSchudulesCount,(B,F)=>(v(),A(p,{key:B},{default:i(()=>[n(h,{class:""},{default:i(()=>[o("div",Rn,[(v(),A(u,{vaccines:e.vaccine_schArray[0][F].antigens,milestone_status:e.vaccine_schArray[0][F].milestone_status,key:e.componentKey},null,8,["vaccines","milestone_status"]))]),n(h,{class:"bottom-row"},{default:i(()=>[o("div",Wn,[o("div",Gn,[n(d,{onClick:t[0]||(t[0]=$=>e.openNextVaccineAppoinment()),class:"btnText",fill:"solid"},{default:i(()=>t[1]||(t[1]=[g("Set Next Appointment Date",-1)])),_:1,__:[1]})])])]),_:1})]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue","onSlideEnd"])):I("",!0),n(h,{class:"bottom-row"},{default:i(()=>[o("div",Un,[o("div",Ln,[n(d,{onClick:e.openAdministerOtherVaccineModal,class:"btnText",fill:"solid"},{default:i(()=>t[2]||(t[2]=[g(" Add Other Vaccines ",-1)])),_:1,__:[2]},8,["onClick"])])])]),_:1})],64)}const _s=O(Hn,[["render",zn]]),jn=P({name:"Home",components:{IonHeader:U,IonMenuButton:He,IonPage:_e,IonTitle:W,IonToolbar:q,IonButton:te,IonCard:Oe,IonCardContent:Te,IonCardHeader:Me,IonCardSubtitle:Pe,IonCardTitle:Ae,IonAccordion:Ne,IonAccordionGroup:Be,IonItem:G,IonLabel:ee,IonModal:$e,IonRow:Z,customVaccine:ve,IonCol:ne,IonFooter:fe,IonContent:L},data(){return{iconsContent:N}},computed:{...k(b,["currentMilestone","missedVaccineSchedules"])},methods:{vaccinesGivenCount(e){const t=[];return e.antigens.forEach(s=>{s.status=="administered"&&t.push(s)}),t.length},dismiss(){M.dismiss()}}}),xn={style:{color:"#016302"}},qn={style:{color:"#316CBA","margin-left":"10%"}};function Kn(e,t,s,l,r,f){const c=a("ion-title"),u=a("ion-header"),d=a("ion-icon"),h=a("row"),p=a("customVaccine"),_=a("ion-content"),m=a("ion-button"),C=a("ion-col"),B=a("ion-row"),F=a("ion-footer");return v(),y(T,null,[n(u,null,{default:i(()=>[n(c,{style:{"margin-bottom":"20px"},class:"modalTitle"},{default:i(()=>t[1]||(t[1]=[g("Missed Vaccines",-1)])),_:1,__:[1]})]),_:1}),n(_,{fullscreen:!0,class:"ion-padding"},{default:i(()=>[(v(!0),y(T,null,Q(e.missedVaccineSchedules,($,Y)=>(v(),y("div",{key:Y},[n(h,{style:{width:"90%"}},{default:i(()=>[n(d,{size:"medium",style:{"margin-bottom":"-6px"},icon:e.iconsContent.calendar},null,8,["icon"]),o("span",null,[t[2]||(t[2]=g(" at ",-1)),o("span",xn,S($.age),1)]),o("span",qn,S(e.vaccinesGivenCount($))+"/"+S($.antigens.length)+" vaccine(s) given",1)]),_:2},1024),n(h,{style:{"text-align":"center"},class:"mod-ls"},{default:i(()=>[n(p,{vaccines:$.antigens,milestone_status:$.milestone_status},null,8,["vaccines","milestone_status"])]),_:2},1024)]))),128))]),_:1}),n(F,{collapse:"fade",class:"ion-no-border"},{default:i(()=>[n(B,null,{default:i(()=>[n(C,null,{default:i(()=>[n(m,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:t[0]||(t[0]=$=>e.dismiss())},{default:i(()=>t[3]||(t[3]=[g(" Cancel ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1})],64)}const fs=O(jn,[["render",Kn],["__scopeId","data-v-3ba5e9df"]]),gs=P({name:"Menu",data(){return{isMobile:!1,visits:[],event:null,popoverOpen:!1,program:null}},mounted(){},computed:{...k(z,["patient"])},methods:{openPopover(e){this.event=e,this.popoverOpen=!0},openPIM(){H(Dt,{class:"otherVitalsModal largeModal"})},openOutCome(){H(Ct,{class:"otherVitalsModal largeModal"})},async printVisitSummary(){if(this.visits=await ut.getPatientVisits(this.patient.patientID,!1),this.visits.length)return new De(this.patient.patientID).printVisitSummaryLbl(this.visits[0]);K("No visits available")},printID(){new De(this.patient.patientID).printNidLbl()},formatCurrentAddress(e){var s,l,r;return[(s=e==null?void 0:e.personInformation)==null?void 0:s.current_district,(l=e==null?void 0:e.personInformation)==null?void 0:l.current_traditional_authority,(r=e==null?void 0:e.personInformation)==null?void 0:r.current_village].filter(Boolean).join(",")}}});export{us as O,gs as _,_s as a,On as b,ve as c,we as d,ms as f,fs as m,hs as v,ps as w};
