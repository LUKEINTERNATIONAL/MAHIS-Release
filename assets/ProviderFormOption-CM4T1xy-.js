import{S as F,H as M,U,t as N,_ as H}from"./index-BvWP6-de.js";import{d as J,r as f,c as j,a as z,e as g,f as m,k as p,l as a,A as x,B as y,u as e,z as n,W as B,I as S,be as R,D as T,G as $,S as W,U as D,T as G,aU as q,a8 as K,b9 as Q,a9 as X,ac as Y,F as L,L as Z,y as A,p as ee,m as te,bg as ae,b8 as se}from"./vendor-nmnlhkKn.js";import"./lodash-Dt8AsbQm.js";const _e=async r=>{const i=await ne();return i.length?i.some(o=>o.toLowerCase()==="".concat(r).toLowerCase()):!0},fe=async r=>{const i=await oe();return i.length?i.some(o=>o.toLowerCase()==="".concat(r).toLowerCase()):!0},ne=async()=>{try{return(await F.getJson("user_properties",{property:"ART_Admin_assigned_activities"})).property_value.split(",")}catch(r){return[]}},oe=async()=>{try{return(await F.getJson("user_properties",{property:"activities"})).property_value.split(",")}catch(r){return[]}},le={style:{border:"1px dashed #ccc"}},re={class:"ion-padding"},ie={key:0},ce={key:1},de=J({__name:"ProviderFormOption",setup(r,{expose:i}){const o=f(""),c=f(null),v=f([]),k=f(!1),O=j(()=>{if(o.value.trim()==="")return v.value;const l=o.value.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),t=new RegExp(l.split("\\s+").join(".*"),"i");return v.value.filter(s=>{const d="".concat(s.name," ").concat(s.role).toLowerCase();return t.test(d)})}),I=()=>{k.value=!0,v.value.length===0&&U.getUsers().then(l=>{v.value=l.results.map(t=>{var s,d,u,h,b,P,C,w;return{id:t.person_id,name:"".concat((h=(u=(d=(s=t==null?void 0:t.person)==null?void 0:s.names)==null?void 0:d[0])==null?void 0:u.given_name)!=null?h:"Unknown"," ").concat((w=(C=(P=(b=t==null?void 0:t.person)==null?void 0:b.names)==null?void 0:P[0])==null?void 0:C.family_name)!=null?w:"Unknown"," (").concat(t.username,")"),role:t.roles.map(E=>E.role).join(", ")}})}).catch(l=>{N("Failed to fetch providers. Please try again later."),console.error("Error fetching providers:",l)})},_=()=>{k.value=!1},V=l=>{c.value=l,o.value="",sessionStorage.setItem("selectedBDEProvider",JSON.stringify(l)),_()};return i({selectedProvider:c,isProviderSelected:()=>c.value!==null,openModal:I,closeModal:_}),z(()=>{sessionStorage.removeItem("selectedBDEProvider")}),(l,t)=>(m(),g(L,null,[p("div",le,[p("span",re,[t[1]||(t[1]=x("Backdata date: ")),p("b",null,y(e(M).toStandardHisDisplayFormat(e(U).getSessionDate())),1)]),a(e($),{lines:"none"},{default:n(()=>[a(e(B),{onClick:I},{default:n(()=>[a(e(S),{icon:e(R)},null,8,["icon"]),t[2]||(t[2]=p("b",null,"Select provider",-1))]),_:1,__:[2]}),a(e(T),{slot:"end"},{default:n(()=>[c.value?(m(),g("b",ce,y(c.value.name),1)):(m(),g("b",ie,"Provider not selected"))]),_:1})]),_:1})]),a(e(se),{class:"full-modal","is-open":k.value,onDidDismiss:_},{default:n(()=>[a(e(W),null,{default:n(()=>[a(e(D),null,{default:n(()=>[a(e(G),null,{default:n(()=>t[3]||(t[3]=[x("Select Provider")])),_:1,__:[3]}),a(e(q),{slot:"end"},{default:n(()=>[a(e(B),{onClick:_},{default:n(()=>[a(e(S),{icon:e(K)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),a(e(D),{color:"light"},{default:n(()=>[a(e(Q),{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),placeholder:"Search providers...",debounce:300},null,8,["modelValue"])]),_:1})]),_:1}),a(e(X),{class:"ion-padding"},{default:n(()=>[a(e(Y),null,{default:n(()=>[(m(!0),g(L,null,Z(O.value,s=>{var d;return m(),A(e($),{key:s.id,button:"",onClick:u=>V(s),class:ee({"selected-provider":((d=c.value)==null?void 0:d.name)===s.name})},{default:n(()=>{var u;return[a(e(T),null,{default:n(()=>[p("h3",null,y(s.name),1),p("p",null,y(s.role),1)]),_:2},1024),((u=c.value)==null?void 0:u.name)===s.name?(m(),A(e(S),{key:0,icon:e(ae),slot:"end",color:"primary"},null,8,["icon"])):te("",!0)]}),_:2},1032,["onClick","class"])}),128))]),_:1})]),_:1})]),_:1},8,["is-open"])],64))}}),ge=H(de,[["__scopeId","data-v-1c797ade"]]);export{ge as P,fe as a,_e as i};
