import{r as p,e6 as E,w as D,ch as P,ci as T,e7 as x,e8 as v,e9 as M,ea as _}from"./vendor-DAXCTcTD.js";import{l as B}from"./lodash-NJiRuGo9.js";import{t as y,v as b,M as m}from"./index-CU_yUvdq.js";var n=(t=>(t.WEB="WEB",t.FILE_SYSTEM="FILE_SYSTEM",t))(n||{});const d={Desktop:{profileName:"Desktop",fileExport:"WEB",scanner:"BARCODE_SCANNER",printer:"WEB",keyboard:"NATIVE_AND_HIS_KEYBOARD"},Mobile:{profileName:"Mobile",fileExport:"FILE_SYSTEM",scanner:"CAMERA_SCANNER",printer:"BLUETOOTH",keyboard:"HIS_KEYBOARD_ONLY"}};function S(){const t=p(d.Desktop),e=p({}),r=localStorage.getItem("active_profile"),o=localStorage.getItem("platformProfiles");return typeof o=="string"?e.value=JSON.parse(o):e.value=d,typeof r=="string"&&"".concat(r).match(/\{.*\}/)?t.value=JSON.parse(r):B.isEmpty(e.value)||(E("mobile")&&"Mobile"in e.value?t.value=e.value.Mobile:E("desktop")&&"Desktop"in e.value&&(t.value=e.value.Desktop)),D(()=>t.value,a=>{localStorage.setItem("active_profile",JSON.stringify(a))}),{activePlatformProfile:t,platformProfiles:e}}function k(t){return t.reduce((e,r)=>e+r.map(o=>'"'.concat(o,'"')).join(",")+"\n","")}function g(t,e,r){let o=null;const a="MaHIS/".concat(t.replaceAll("/","_"));m('Exporting file to "Documents/'.concat(a,'"...')),r==="blob"?o=x({path:a,blob:e,directory:v.Documents,recursive:!0}):o=M.writeFile({path:a,data:e,directory:v.Documents,encoding:_.UTF8,recursive:!0}),o!=null&&o.then(()=>m('File exported to "Documents/'.concat(a,'"!'),3e3)).catch(l=>b(l))}function F(t,e,r="document"){e=h(e);const o=k(t.concat(e)),{activePlatformProfile:a}=S(),l="".concat(r,".csv");if(a.value.fileExport===n.WEB){const i=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.setAttribute("id","csv"),s.href=window.URL.createObjectURL(i),s.setAttribute("download","".concat(r,".csv")),document.body.appendChild(s),s.click(),s.remove()}else a.value.fileExport===n.FILE_SYSTEM?g(l,o,"text"):y("Platform not supported")}function L(t,e,r="document",o=!1,a={}){e=h(e);const l=new P({...a}),i=l.splitTextToSize(r,180),s=i.length<=1?20:i.length*10;l.text(i,14,10);const c={startY:s,head:[t[t.length-1]],body:e};o&&(c.tableWidth="wrap",c.horizontalPageBreak=!0,c.horizontalPageBreakRepeat=0),T(l,c);const{activePlatformProfile:f}=S(),u="".concat(r,".pdf");f.value.fileExport===n.WEB?l.save(u):f.value.fileExport===n.FILE_SYSTEM?g(u,l.output(),"blob"):b("Platform not supported")}function h(t){return t.map(r=>r.map(o=>typeof o=="string"?o.replace(/&lt;/g,"<"):o))}export{n as F,L as a,g as e,F as t,S as u};
