import{d as L,r as l,b1 as P,a as U,E as A,y as F,f as m,z as s,l as o,u as t,ao as N,k as n,ag as M,ad as R,d0 as D,T as K,e as I,A as p,B as g,ar as w,D as k,cb as T,d1 as V,bG as H,d2 as O,W,au as q}from"./vendor-DowD5zKn.js";import{n as b,K as G,m as x,t as $,J as j,M as J,p as Q,N as X,_ as Y}from"./index-Cu2JEMub.js";import{i as Z}from"./Img-CJEgX1Vr.js";import"./lodash-Dt8AsbQm.js";const ee={class:"login-container"},te={key:0,style:{"justify-content":"center",display:"block"}},ae={style:{"font-size":"15px"}},oe={style:{"font-size":"12px",color:"#34af4d"}},se={key:1},ne={style:{"font-size":"15px"}},le={style:{"text-align":"left"}},ie=L({__name:"Login",setup(re){const i=l(""),r=l(""),f=l(""),u=l(!1),v=l("test"),c=l(new X),C=P(),S=b(),h=async()=>{S.terminate(),await b().postData("SET_OFFLINE_PROGRAMS")},z=()=>{f.value=localStorage.getItem("core_version")||""},B=async()=>{const a=j(),e=await J();e&&(a.setUserFacilityName(e.name),a.setFacilityLocation(e),localStorage.setItem("facility_code",e.code))},E=async()=>{const a=await c.value.checkUserPrograms(void 0);a!=null&&a.programs&&Q().setAuthorizedPrograms(a==null?void 0:a.programs)},_=async()=>{if(i.value&&r.value){c.value.setUsername(i.value);try{await c.value.login(r.value),await B(),await E(),C.push("/home")}catch(a){a instanceof G?x("Invalid username or password"):x("".concat(a),5e4)}}else $("Complete form to log in")};return U(async()=>{localStorage.setItem("apiKey",""),await c.value.loadConfig(),z(),await h()}),(a,e)=>{const y=A("ion-icon");return m(),F(t(q),null,{default:s(()=>[o(t(N),{class:"ion-padding login-page"},{default:s(()=>[n("div",ee,[o(t(M),{style:{"background-color":"#fff"}},{default:s(()=>[o(t(R),null,{default:s(()=>[o(t(D),{class:"login_img",src:t(Z)("mw.png"),id:"logo"},null,8,["src"]),o(t(K),{class:"login-title"},{default:s(()=>[v.value==="development"||v.value==="test"?(m(),I("span",te,[n("div",null,[e[3]||(e[3]=p(" MaHIS ")),n("small",ae,"(v"+g(f.value)+")",1)]),n("div",oe,"("+g(v.value)+")",1)])):(m(),I("span",se,[e[4]||(e[4]=p(" MaHIS ")),n("small",ne,"(v"+g(f.value)+")",1)]))]),_:1}),n("span",le,[o(t(w),{value:i.value,onIonInput:e[0]||(e[0]=d=>i.value=d.target.value||""),type:"text",label:"Username",ref:"usernameRef","label-placement":"floating",fill:"outline",placeholder:"Enter Username",class:"input-fields",required:""},{default:s(()=>[o(t(k),{slot:"end"},{default:s(()=>[o(y,{icon:t(T)},null,8,["icon"])]),_:1})]),_:1},8,["value"]),o(t(w),{value:r.value,onIonInput:e[2]||(e[2]=d=>r.value=d.target.value||""),type:u.value?"text":"password",label:"Password",ref:"passwordRef","label-placement":"floating",fill:"outline",placeholder:"Enter Password",class:"input-fields",required:"",onKeydown:V(_,["enter"])},{default:s(()=>[o(t(k),{slot:"end"},{default:s(()=>[o(y,{icon:u.value?t(H):t(O),onClick:e[1]||(e[1]=d=>u.value=!u.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type"])]),o(t(W),{expand:"block",style:{"--background":"var(--ion-color-primary)","font-size":"var(--ion-button-font)"},onClick:_,class:"login-button"},{default:s(()=>e[5]||(e[5]=[p(" Login ")])),_:1,__:[5]}),e[6]||(e[6]=n("p",{class:"signup-link"},[p("For help click "),n("a",{href:"#"},"Here")],-1))]),_:1,__:[6]})]),_:1})])]),_:1})]),_:1})}}}),fe=Y(ie,[["__scopeId","data-v-6ed0b483"]]);export{fe as default};
