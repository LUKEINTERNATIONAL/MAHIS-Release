System.register(["./vendor-legacy-DG-htyL-.js","./index-legacy-CgRFaIIG.js","./identifier_service-legacy-06Y1GnzR.js","./lodash-legacy-C-x9g9Na.js"],(function(e,a){"use strict";var t,l,n,i,d,u,o,r,s,c,f,p,v,m,b,_,h,g,y,w,k,x,D,C,I,z,A,N,T,V,F,L,P,j,E,R,$,B,G,M,S,U,O,Q;return{setters:[e=>{t=e.d,l=e.ae,n=e.y,i=e.f,d=e.z,u=e.l,o=e.u,r=e.U,s=e.T,c=e.A,f=e.B,p=e.b3,v=e.W,m=e.bh,b=e.aM,_=e.aL,h=e.aQ,g=e.aN,y=e.k,w=e.e,k=e.F,x=e.L,D=e.ad,C=e.X,I=e.r,z=e.a,A=e.w,N=e.aP,T=e.aO,V=e.m,F=e.ac,L=e.G,P=e.D,j=e.cr,E=e.cs,R=e.b8},e=>{$=e.ai,B=e.u,G=e._,M=e.ay,S=e.ax,U=e.T,O=e.cu},e=>{Q=e.I},null],execute:function(){var a=document.createElement("style");a.textContent=".table-responsive[data-v-0a1b5e58]{overflow-x:auto}.appointments-table[data-v-0a1b5e58]{width:100%;border-collapse:collapse;margin-bottom:1rem;font-size:.9rem}.appointments-table th[data-v-0a1b5e58],.appointments-table td[data-v-0a1b5e58]{padding:.75rem;text-align:left;border-bottom:1px solid #ccc;white-space:nowrap}.appointments-table th[data-v-0a1b5e58]{background-color:#f1f1f1;font-weight:600}ion-toolbar[data-v-0a1b5e58]{--padding-start: 16px;--padding-end: 16px}ion-card[data-v-0a1b5e58]{margin:16px 0}ion-card[data-v-f930c1ab]{margin:16px}.table-responsive[data-v-f930c1ab]{overflow-x:auto}.appointments-table[data-v-f930c1ab]{width:100%;border-collapse:collapse;margin-bottom:1rem}.appointments-table th[data-v-f930c1ab],.appointments-table td[data-v-f930c1ab]{padding:.75rem;text-align:left;border-bottom:1px solid #dee2e6}.appointments-table th[data-v-f930c1ab]{font-weight:600;background-color:#f8f9fa}.appointments-table tr[data-v-f930c1ab]:hover{background-color:rgba(0,0,0,.03)}\n/*$vite$:1*/",document.head.appendChild(a);const W={class:"appointments-table"},X=G(t({__name:"DuplicateDetailsModal",props:{patients:{},identifierLabel:{}},setup(e){const a=l();function t(){C.dismiss()}return(e,l)=>(i(),n(o(D),null,{default:d((()=>[u(o(r),null,{default:d((()=>[u(o(s),null,{default:d((()=>[c("Duplicate Details for "+f(e.identifierLabel),1)])),_:1}),u(o(p),{slot:"end"},{default:d((()=>[u(o(v),{onClick:t},{default:d((()=>l[0]||(l[0]=[c("Close")]))),_:1,__:[0]})])),_:1})])),_:1}),u(o(m),null,{default:d((()=>[u(o(b),null,{default:d((()=>[u(o(_),{size:"12","size-md":"10","offset-md":"1"},{default:d((()=>[u(o(h),null,{default:d((()=>[u(o(g),{class:"table-responsive"},{default:d((()=>[y("table",W,[l[2]||(l[2]=y("thead",null,[y("tr",null,[y("th",null,"Given Name"),y("th",null,"Family Name"),y("th",null,"Gender"),y("th",null,"Birth Date"),y("th",null,"Action")])],-1)),y("tbody",null,[(i(!0),w(k,null,x(e.patients,(e=>(i(),w("tr",{key:e.person_id},[y("td",null,f(e.given_name),1),y("td",null,f(e.family_name),1),y("td",null,f(e.gender),1),y("td",null,f(e.birthdate),1),y("td",null,[u(o(v),{size:"small",fill:"clear",onClick:l=>async function(e){await $(),await B().setPatientRecord(e),a.replace({path:"/patientProfile"}),t()}(e.patient)},{default:d((()=>l[1]||(l[1]=[c(" View Details ")]))),_:2,__:[1]},1032,["onClick"])])])))),128))])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-0a1b5e58"]]),q={key:0,class:"table-responsive"},H={class:"appointments-table"},J={key:1,class:"ion-text-center ion-padding"};e("default",G(t({__name:"ARTDuplicates",setup(e){const a=l(),t=I("Duplicate Identifiers"),r=I([]),s=I(null),p=I([]),$=I(!1),B=I(new Q);return z((async()=>{await M.show();try{const e=await Q.getIdentifierTypes();r.value=e.map((e=>({label:e.name,value:e.patient_identifier_type_id}))),r.value.length>0&&(s.value=r.value[0].value)}catch(e){console.error("Error initializing:",e),S("Failed to load identifier types")}finally{await M.hide()}})),A(s,(async e=>{e&&await async function(){if(s.value){await M.show();try{const e=r.value.find((e=>e.value===s.value));t.value=e?`${e.label} Duplicates`:"Duplicate Identifiers",B.value.setIdentifierType(s.value);const a=await B.value.getDuplicateIndentifiers();p.value=Array.isArray(a)?a:[],$.value=!0}catch(e){console.error("Error fetching duplicates:",e),S("Failed to fetch duplicate identifiers"),p.value=[]}finally{await M.hide()}}}()})),(e,l)=>(i(),n(o(R),null,{default:d((()=>[u(U,{title:"Duplicate Identifiers"}),u(o(D),null,{default:d((()=>[u(o(m),null,{default:d((()=>[u(o(b),null,{default:d((()=>[u(o(_),{size:"12","size-md":"10","size-lg":"8","offset-md":"1","offset-lg":"2"},{default:d((()=>[u(o(h),null,{default:d((()=>[u(o(N),null,{default:d((()=>[u(o(T),null,{default:d((()=>[c(f(t.value),1)])),_:1})])),_:1}),u(o(g),null,{default:d((()=>[u(o(F),null,{default:d((()=>[u(o(L),null,{default:d((()=>[u(o(P),{position:"stacked"},{default:d((()=>l[1]||(l[1]=[c("Select Identifier Type")]))),_:1,__:[1]}),u(o(j),{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e)},{default:d((()=>[(i(!0),w(k,null,x(r.value,(e=>(i(),n(o(E),{key:e.value,value:e.value},{default:d((()=>[c(f(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),p.value.length>0?(i(),w("div",q,[y("table",H,[l[4]||(l[4]=y("thead",null,[y("tr",null,[y("th",null,"Identifier"),y("th",null,"Count"),y("th",null,"View"),y("th",null,"Resolve")])],-1)),y("tbody",null,[(i(!0),w(k,null,x(p.value,(e=>(i(),w("tr",{key:e.identifier},[y("td",null,f(e.identifier),1),y("td",null,f(e.count),1),y("td",null,[u(o(v),{size:"small",fill:"outline",onClick:a=>async function(e){await M.show();try{const a=(await B.value.getPatientsByIdentifier(e)).map((e=>{try{return{person_id:e.patient_id,given_name:e.person.names[0].given_name,family_name:e.person.names[0].family_name,gender:e.person.gender,birthdate:O(e.person.birthdate),patient:e}}catch(a){return{person_id:0,given_name:"N/A",family_name:"N/A",gender:"N/A",birthdate:"N/A",patient:{}}}})),t=await C.create({component:X,componentProps:{patients:a,identifierLabel:e},cssClass:"large-modal"});await t.present()}catch(a){console.error("Error viewing duplicate details:",a),S("Failed to load patient details")}finally{await M.hide()}}(e.identifier)},{default:d((()=>l[2]||(l[2]=[c(" View ")]))),_:2,__:[2]},1032,["onClick"])]),y("td",null,[u(o(v),{size:"small",color:"danger",fill:"outline",onClick:t=>{return l=e.identifier,void a.push(`/npid/duplicates/${l}`);var l},disabled:3!==s.value},{default:d((()=>l[3]||(l[3]=[c(" Resolve ")]))),_:2,__:[3]},1032,["onClick","disabled"])])])))),128))])])])):0===p.value.length&&$.value?(i(),w("div",J,l[5]||(l[5]=[y("p",null,"No duplicate identifiers found",-1)]))):V("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-f930c1ab"]]))}}}));
