System.register(["./vendor-legacy-BH_DPLXA.js","./report_service-legacy-DssYG6bu.js","./index-legacy-BKn2OBE1.js","./lodash-legacy-C-x9g9Na.js"],(function(e,t){"use strict";var a,l,r,o,n,i,d,s,u,p,c,f,v,b,m,y,h,g,x,w,D,k,B,C,R,_,A,F,S,E,M,P,T,j,I,q,$,V,z,H,N,L,U,O,Q,G,W,J,K;return{setters:[e=>{a=e.ae,l=e.cL,r=e.d,o=e.r,n=e.c,i=e.eB,d=e.y,s=e.f,u=e.u,p=e.aQ,c=e.z,f=e.l,v=e.aP,b=e.m,m=e.aO,y=e.c9,h=e.A,g=e.k,x=e.B,w=e.aN,D=e.e,k=e.F,B=e.L,C=e.i,R=e.c$,_=e.cC,A=e.W,F=e.eC,S=e.eD,E=e.j,M=e.eE},e=>{P=e.g,T=e.a,j=e.D},e=>{I=e.f,q=e.r,$=e.u,V=e.s,z=e.g,H=e.h,N=e.p,L=e.e,U=e.d,O=e.a,Q=e.i,G=e.m,W=e.j,J=e._},e=>{K=e.l}],execute:function(){var t=document.createElement("style");function X(e="person_id",t=a()){return{label:"view client",icon:l,color:"light",action:async a=>{const l=await I.findByID(a[e]);return await q(),await $().setPatientRecord(l),t.replace({path:"/patientProfile"})}}}t.textContent=".report-card[data-v-8fabd17f]{margin:16px 0;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);overflow-x:auto;width:100%}@media (max-width: 768px){.table-container[data-v-8fabd17f]{overflow-x:scroll;-webkit-overflow-scrolling:touch}.table-container[data-v-8fabd17f] table{min-width:600px}}.report-header[data-v-8fabd17f]{padding:20px 24px 16px;border-bottom:1px solid #e0e0e0;background-color:#fafafa}.report-header ion-card-title[data-v-8fabd17f]{font-weight:600;color:#2c2c2c;margin-bottom:8px;font-size:1.25rem}.report-subtitle[data-v-8fabd17f]{color:#666;font-size:.9rem;margin-bottom:4px}.total-clients[data-v-8fabd17f]{color:#666;font-size:.9rem;margin-top:8px}.total-clients a[data-v-8fabd17f]{color:#3880ff;text-decoration:none;font-weight:500}.total-clients a[data-v-8fabd17f]:hover{text-decoration:underline}.report-content[data-v-8fabd17f]{padding:20px 24px;overflow-x:auto}.filters-container[data-v-8fabd17f]{display:flex;align-items:center;gap:16px;margin-bottom:20px;padding:16px;background-color:#f8f9fa;border-radius:8px;flex-wrap:wrap}.date-picker[data-v-8fabd17f]{min-width:160px;max-width:200px}.filter-select[data-v-8fabd17f]{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;min-width:120px;background-color:#fff;font-size:.9rem;transition:border-color .2s ease}.filter-select[data-v-8fabd17f]:focus{outline:none;border-color:#3880ff;box-shadow:0 0 0 2px rgba(56,128,255,.1)}.client-type-group[data-v-8fabd17f]{display:flex;align-items:center;gap:8px}.client-type-label[data-v-8fabd17f]{font-weight:500;color:#4a5568;font-size:.9rem;white-space:nowrap}.submit-btn[data-v-8fabd17f]{--border-radius: 6px;--padding-start: 16px;--padding-end: 16px;height:36px;font-weight:500}.table-container[data-v-8fabd17f]{background-color:#fff;border-radius:8px;overflow-x:auto;overflow-y:visible;border:1px solid #e2e8f0;width:100%}.table-container[data-v-8fabd17f] table{min-width:100%;width:max-content}.table-container[data-v-8fabd17f] .vtable-wrapper{overflow-x:auto;width:100%}@media (max-width: 768px){.report-card[data-v-8fabd17f]{margin:8px 0}.report-header[data-v-8fabd17f]{padding:16px 20px 12px}.report-content[data-v-8fabd17f]{padding:16px 20px}.filters-container[data-v-8fabd17f]{flex-direction:column;align-items:stretch;gap:12px}.client-type-group[data-v-8fabd17f]{flex-direction:column;align-items:stretch;gap:4px}.date-picker[data-v-8fabd17f],.filter-select[data-v-8fabd17f]{min-width:100%}}[data-v-8fabd17f] .no-data-table{min-height:400px!important;height:auto!important}\n/*$vite$:1*/",document.head.appendChild(t),e({g:X,t:function(e,t={}){return Array.isArray(e)?e.map((e=>({label:e,path:e,drillable:!0,sortable:!0,...t}))):Object.entries(e).map((([e,a])=>({path:e,label:a,drillable:!0,sortable:!1,...t})))}});const Y={class:"filters-container"},Z=["onUpdate:modelValue"],ee=["value"],te={class:"client-type-group"},ae={class:"table-container"},le=r({__name:"ReportTable",props:{title:{type:String,default:"Report"},subtitle:{type:String,default:""},period:{type:String,default:""},date:{type:String,default:""},quarter:{type:Object,default:()=>({})},totalClients:{type:Array},columns:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},asyncRows:{type:Function},actionButtons:{type:Array,default:()=>[]},rowActionButtons:{type:Array,default:()=>[]},canExportCsv:{type:Boolean,default:!0},canExportPDF:{type:Boolean,default:!0},useSecureExport:{type:Boolean,default:!1},showRefreshButton:{type:Boolean,default:!0},useDateRangeFilter:{type:Boolean,default:!1},useQuarterFilter:{type:Boolean,default:!1},useDateFilter:{type:Boolean,default:!1},customFilters:{type:Array,default:()=>[]},showIndices:{type:Boolean,default:!1},filename:{type:String,default:""},reportType:{type:String,default:""},drillTitle:{type:Function,default:()=>"Drill-down table"},customDrillColumns:{type:Array},drillRowParser:{type:Function},customDrillHandler:{type:Function},showDrillSelectButton:{type:Boolean,default:!0}},emits:["generate"],setup(e,{emit:t}){const a=t,l=e,r=o({}),I=o({}),q=o("all"),$=n((()=>V(`\n  ${l.reportType} \n  ${z().facilityName} \n  ${(l.filename||l.title).replace(l.reportType,"")} \n  ${l.period?l.period:l.date}\n`))),J=n((()=>{const e=[...l.customFilters];return l.useDateRangeFilter?(e.push({id:"startDate",label:"Start Date",type:"date",placeholder:"Start Date",slotName:"datePicker",value:l.period.split("-")[0]}),e.push({id:"endDate",label:"End Date",placeholder:"End Date",type:"date",slotName:"datePicker",value:l.period.split("-")[1]})):l.useQuarterFilter?e.push({id:"quarter",label:"Quarter:",type:"select",value:l.quarter,options:H(10).map((e=>({label:e.name,value:e.name,other:e})))}):l.useDateFilter&&e.push({id:"date",label:"Date",type:"date",slotName:"datePicker",value:l.date}),e})),le=n((()=>{var e,t;const r=[...l.actionButtons];return l.canExportCsv&&r.push(P($.value,null===(e=l.quarter)||void 0===e?void 0:e.label,l.period)),l.canExportPDF&&r.push(T($.value,l.useSecureExport,null===(t=l.quarter)||void 0===t?void 0:t.label,l.period)),l.showRefreshButton&&r.push({label:"Refresh/Rebuild",icon:i,color:"primary",action:()=>{if(K.isEmpty(I.value))return O("Invalid filters");a("generate",I.value,!0)}}),r})),re=n((()=>{var e;return null!==(e=l.customDrillColumns)&&void 0!==e?e:[{path:"identifier",label:"ARV Number",preSort:N,initialSort:!0},{path:"birthdate",label:"Date of Birth",formatter:L},{path:"gender",label:"Gender",formatter:U}]}));function oe(e){if(e.occupation=q.value,r.value.date&&(e.date=r.value.date),"startDate"in e&&"endDate"in e){const{startDate:t,endDate:a}=r.value;if(!Q(t,a))return O("Invalid date range");e.startDate=t,e.endDate=a,e.dateRange={startDate:t,endDate:a}}if("date"in e){if(K.isEmpty(r.value.date))return O("Invalid date");e.date=r.value.date}if(l.useDateRangeFilter){const t=r.value.startDate,a=r.value.endDate;if(!t||!a)return O("Please select both start and end dates");if(!Q(t,a))return O("Invalid date range");e.startDate=t,e.endDate=a,e.dateRange={startDate:t,endDate:a}}if(function(e){const t=J.value.filter((e=>!1!==e.required));return 0===t.length||t.every((t=>{const a=e[t.id];return!1===t.required||!K.isEmpty(a)&&("object"!=typeof a||null===a||Object.values(a).every(Boolean))}))}(e))return I.value=e,a("generate",e,!1);O("Invalid filters")}function ne(e){return e.preventDefault(),ie({row:{clients:l.totalClients},column:{path:"clients",label:"Total Clients"}})}async function ie(e){var t,a;if("function"==typeof l.customDrillHandler)return l.customDrillHandler(e);const r=l.drillTitle(e),n=o([]);return async function(e,t){if("function"==typeof l.drillRowParser)t.push(...await l.drillRowParser(e));else{const l=K.get(e.row,e.column.path,[]);for(const e of K.chunk(l,100)){var a,r;const l=await M.getAll(e);if(!l.ok)return O(null!==(a=l.errorMessage)&&void 0!==a?a:"Unable to load patient data");t.push(...null!==(r=l.data)&&void 0!==r?r:[])}}}(e,n.value),G.show(j,{title:r,columns:re.value,rows:n.value,rowActionButtons:l.showDrillSelectButton?[X("person_id",W)]:[],actionButtons:[P(r,null===(t=l.quarter)||void 0===t?void 0:t.label,l.period),T(r,!1,null===(a=l.quarter)||void 0===a?void 0:a.label,l.period)]})}return(t,a)=>(s(),d(u(p),{class:"report-card"},{default:c((()=>[f(u(v),{class:"report-header"},{default:c((()=>{var t;return[f(u(m),{innerHTML:e.title},null,8,["innerHTML"]),e.subtitle?(s(),d(u(y),{key:0,innerHTML:e.subtitle,class:"report-subtitle"},null,8,["innerHTML"])):b("",!0),null!==(t=e.totalClients)&&void 0!==t&&t.length?(s(),d(u(y),{key:1,class:"total-clients"},{default:c((()=>[a[2]||(a[2]=h(" Total Clients: ")),g("a",{href:"#",onClick:ne},x(e.totalClients.length),1)])),_:1,__:[2]})):b("",!0)]})),_:1}),f(u(w),{class:"report-content"},{default:c((()=>[g("div",Y,[(s(!0),D(k,null,B(J.value,(e=>{var t,a;return s(),D(k,{key:e.id},["date"===e.type&&"datePicker"===e.slotName?(s(),d(u(R),{key:0,modelValue:r.value[e.id],"onUpdate:modelValue":t=>r.value[e.id]=t,"enable-time-picker":!1,"model-type":"dd/MMM/yyyy",format:"dd/MMM/yyyy",placeholder:null!==(t=null!==(a=e.placeholder)&&void 0!==a?a:e.label)&&void 0!==t?t:"Select Date","auto-apply":"","text-input":"",class:"date-picker"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):"select"===e.type?C((s(),D("select",{key:1,"onUpdate:modelValue":t=>I.value[e.id]=t,class:"filter-select"},[(s(!0),D(k,null,B(e.options,(e=>(s(),D("option",{key:e.value,value:e.value},x(e.label),9,ee)))),128))],8,Z)),[[_,I.value[e.id]]]):b("",!0)],64)})),128)),g("div",te,[a[4]||(a[4]=g("label",{for:"occupation",class:"client-type-label"},"Occupation:",-1)),C(g("select",{id:"occupation","onUpdate:modelValue":a[0]||(a[0]=e=>q.value=e),class:"filter-select"},a[3]||(a[3]=[g("option",{value:"All"},"All",-1),g("option",{value:"Military"},"Military",-1),g("option",{value:"Civilian"},"Civilian",-1)]),512),[[_,q.value]])]),f(u(A),{size:"small",onClick:a[1]||(a[1]=e=>oe({...I.value})),class:"submit-btn"},{default:c((()=>a[5]||(a[5]=[h(" Submit ")]))),_:1,__:[5]})]),g("div",ae,[f(u(F),{rows:e.rows,"async-rows":e.asyncRows,columns:e.columns,"actions-buttons":le.value,"row-actions-buttons":e.rowActionButtons,"custom-filters":[],config:{showIndices:e.showIndices},onCustomFilter:oe,onDrilldown:ie,color:"light"},S({_:2},[B(t.$slots,((e,a)=>({name:a,fn:c((({filter:e})=>[E(t.$slots,a,{filter:{filter:e}},void 0,!0)]))})))]),1032,["rows","async-rows","columns","actions-buttons","row-actions-buttons","config"])])])),_:3})])),_:3}))}});e("R",J(le,[["__scopeId","data-v-8fabd17f"]]))}}}));
