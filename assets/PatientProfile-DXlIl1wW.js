import{R as ge,d as P,ao as I,ab as dt,U as q,T as G,ap as ut,ak as X,G as L,S as z,ah as j,X as W,aq as fe,a9 as ne,aa as wt,E as o,e as b,m as S,f as u,k as a,y as $,A as m,B as y,l as n,z as s,a as ve,r as Z,u as vt,D as Y,bh as be,W as tt,F as H,eD as ye,am as se,al as ie,L as et,i as lt,v as rt,ai as Q,aj as it,b8 as Ct,M as Vt,J as kt,a_ as It,cf as $t,a$ as At,aZ as Bt,b0 as Mt,an as pt,ba as Nt,V as Pt,I as De,bg as Se,ag as we,bo as Ce,d2 as Ve,d3 as ke,d4 as Ie,d5 as $e,cO as Ae,dC as Be,bJ as Me,p as Ne}from"./vendor-DL4WTsfb.js";import{j as N,h as at,B as mt,aI as ae,J as k,u as J,H as C,_ as F,i as D,t as x,X as Pe,S as O,m as A,K as ht,p as Te,aJ as K,F as oe,cb as Oe,b4 as He,G as B,bg as Xt,bz as Dt,cc as Fe,q as Ee,cd as Yt,P as le,M as Re,T as We,aP as Ue,a5 as Ge,aF as Le,a8 as ze,a9 as je}from"./index-DjbhwxKm.js";import{D as xe}from"./DemographicBar-pbjVU6Vu.js";import{S as qe}from"./SaveProgressModal-OTbieWqZ.js";import{az as Je,S as Ke}from"./Stepper-DtLmWQrL.js";import{T as Ze}from"./NextAppointment-Cu9a5-Kn.js";import{l as R}from"./lodash-Dt8AsbQm.js";import{a as te,D as Qe}from"./drug_prescription_service-Cr-sgyyk.js";import Xe from"./WeightHeightChart-DdeZZCi-.js";import{B as _t}from"./BasicForm-CMlpXm6J.js";import{_ as ot}from"./customDatePicker.vue_vue_type_style_index_0_lang-BXLipXvc.js";import{a as re}from"./formatServerData-D-3s9rQK.js";import{i as st,s as ce,j as Ye,A as tn,n as en}from"./vaccines_service-D7vhUZSV.js";import{I as nn}from"./barcode-qrcode-reader-B6ZkQH0V.js";import{S as de}from"./stock_service-CbeC-vX4.js";import{_ as sn,u as bt}from"./SetRelationship.vue_vue_type_script_lang-CIJQvm-B.js";import{v as an}from"./group_validation-rEWcpaVk.js";import{R as on}from"./relationship_service-P0sR8OGD.js";import{u as ln}from"./AdministerOtherVaccinesStore-Da8KdvnB.js";import{_ as rn}from"./usePatientProfile-DnCG5FUv.js";import{O as cn}from"./Outcome-D1_Ri2pW.js";import"./apexcharts-a8xXIU8b.js";import"./OPDOutcome-6cGNgmUA.js";import"./patient_complaints_service-BRgDEJoo.js";import"./DashBox-ClFuiTxM.js";import"./useExposeFromStandardForm-BsKKp0ZQ.js";import"./drug_service-DZlHL1vm.js";import"./TreatmentPlan-CjoQd-WW.js";import"./previousDiagnosis-BCJdQ0mw.js";import"./FeatusModal-DTFEUxCc.js";import"./BasicCard-fNZzs0UP.js";import"./PastObstreticHistoryStore-Di46bfzD.js";import"./lab_order-BaQBEHQC.js";import"./UpcomingFeature-dyOOBUZV.js";import"./stages-CXCKfb-j.js";import"./ncd_appointment_service-DTuR8jMr.js";import"./DateInputField-CXGl0lQj.js";import"./chartjs-CwNFB66L.js";import"./sms_service-Did_L7Mm.js";import"./EIRreportsStore-BDcZ7Wfn.js";import"./Export-DpU5N5LQ.js";import"./Registration-OZ55GDtF.js";import"./useLocation-BqRokJ70.js";const ee=[{data:{rowData:[{colData:[{inputHeader:"Systolic Pressure",unit:"mmHg",icon:N.systolicPressure,value:"",name:"Systolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsSystolic"},{inputHeader:"Diastolic pressure",unit:"mmHg",icon:N.diastolicPressure,value:"",name:"Diastolic",required:!0,eventType:"input",disabled:!1,valueType:"number",validationFunctionName:"vitalsDiastolic"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"bp",index:""}],previousView:{name:"vitals"}},{data:{rowData:[{colData:[{inputHeader:"Temperature",unit:"C",icon:N.temprature,value:"",name:"Temperature",eventType:"input",validationFunctionName:"vitalsTemperature",valueType:"number"},{inputHeader:"Pulse rate",unit:"BMP",icon:N.pulse,value:"",name:"Pulse",eventType:"input",validationFunctionName:"vitalsPulseRate",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"temp",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"pulse",index:""}]},{data:{rowData:[{colData:[{inputHeader:"Respiratory rate",unit:"BMP",icon:N.respiratory,value:"",name:"Respiratory rate",eventType:"input",validationFunctionName:"vitalsRespiratoryRate",valueType:"number"},{inputHeader:"Oxygen saturation",unit:"%",icon:N.oxgenStaturation,value:"",name:"SAO2",eventType:"input",validationFunctionName:"vitalsOxygenSaturation",valueType:"number"}]}]},alerts:[{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"respiratory",index:""},{backgroundColor:"",status:"",icon:"",textColor:"",value:"",name:"oxygen",index:""}]}],yt=ge("immunizationVitalsStore",{state:()=>({vitals:[...ee]}),actions:{setVitals(t){this.vitals=t},getInitialVitals(){return[...R.cloneDeep(ee)]}},persist:!0}),dn=P({mixins:[Je],components:{IonContent:j,IonHeader:z,IonItem:L,IonList:X,IonMenu:ut,IonTitle:G,IonToolbar:q,IonInput:dt,BasicInputField:mt,BasicForm:_t,PreviousVitals:at,customDatePicker:ot},data(){return{iconsContent:N,vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1,pulseRate:!1},showPD:!1,todays_date:C.sessionDate(),formOpen:!0}},computed:{...I(J,["patient"]),...I(yt,["vitals"])},async serverPrefetch(){this.updateVitalsStores()},async mounted(){this.cleanVitalForm(),this.vitalsData=this.vitals,await this.setTodayVitals(),await this.validateRowData()},watch:{vitals:{handler(){this.vitalsData=this.vitals},deep:!0},$route:{handler(){this.cleanVitalForm(),this.vitalsData=this.vitals}}},setup(){return{checkmark:wt,pulseOutline:ne}},methods:{cleanVitalForm(){const t=yt();t.setVitals(t.getInitialVitals())},navigationMenu(t){fe.close(),this.$router.push(t)},updateVitalsStores(){yt().setVitals(this.vitals)},async validateRowData(){const t=k(this.vitals,"Height (cm)","value"),e=k(this.vitals,"Weight","value"),i=k(this.vitals,"Systolic","value"),l=k(this.vitals,"Diastolic","value"),c=k(this.vitals,"Temperature","value"),v=k(this.vitals,"Pulse","value"),r=k(this.vitals,"Respiratory rate","value"),d=k(this.vitals,"SAO2","value");await this.setBMI(t,e),await this.updateBP(i,l);const p=this.getPulseRateStatus(v);await this.updateRate("pulse",v," BMP",p,4);const h=this.getTemperatureStatus(c);this.updateRate("temp",c,"Â°C",h,4);const g=this.getRespiratoryRateStatus(r);this.updateRate("respiratory",r,"BMP",g,6);const f=this.getOxygenSaturationStatus(d);this.updateRate("oxygen",d,"%",f,6)},showCPD(){this.showPD=!0},closeForm(){this.formOpen=!1},async saveVitals(){var e;W.dismiss();const t=await re(this.vitals);if(t.length>0){let i=(e=this.patient)==null?void 0:e.vitals;i.unsaved=[...i.unsaved,...t],await ae(this.patient)}}}}),un={key:0,class:"modal_wrapper"},pn={class:"OtherVitalsHeading"},mn={class:"TodaysDate"},hn={class:""},_n={class:"btnContent"},gn={class:"saveBtn"};function fn(t,e,i,l,c,v){const r=o("basic-form"),d=o("customDatePicker"),p=o("ion-icon"),h=o("ion-button");return t.formOpen?(u(),b("div",un,[a("div",pn,[e[3]||(e[3]=a("div",{class:"OtherVitalsTitle"},"OTHER VITALS",-1)),a("div",mn,[e[1]||(e[1]=m("Todays Date: ",-1)),e[2]||(e[2]=a("span",null,null,-1)),m(" "+y(t.todays_date),1)])]),a("div",hn,[n(r,{contentData:t.vitals,"onUpdate:inputValue":e[0]||(e[0]=g=>t.validateRowData())},null,8,["contentData"])]),t.showPD?(u(),$(d,{key:0})):S("",!0),a("div",_n,[a("div",gn,[a("div",null,[n(h,{class:"btnText",fill:"solid",onClick:t.saveVitals},{default:s(()=>[e[4]||(e[4]=m(" Done today ",-1)),n(p,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=a("div",null,null,-1)),a("div",null,[n(h,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:s(()=>[e[5]||(e[5]=m(" Done earlier ",-1)),n(p,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])])])):S("",!0)}const vn=F(dn,[["render",fn],["__scopeId","data-v-d7374316"]]),bn={class:"flex flex-col items-center justify-center mt-6"},yn={class:"phone mt-6"},Dn={class:"content"},Sn={class:"overlay"},wn={style:{"margin-top":"20px"}},ue=P({__name:"QRCodeReader",emits:["scanresult"],setup(t,{emit:e}){ve(async()=>{d()});const i=Z(void 0),l=Z(!1);function c(f){i.value=f,i.value!=null&&(D().setTempScannedBatchNumber(i.value),g(i.value))}function v(f){l.value=f}const r=Z(null);function d(){var f;(f=r.value)==null||f.onCanPlay()}function p(){W.dismiss()}const h=e;function g(f){h("scanresult",f),p()}return(f,_)=>(u(),b(H,null,[a("div",bn,[a("div",yn,[n(vt(Y),null,{default:s(()=>[m(y(i.value),1)]),_:1}),a("div",Dn,[a("div",Sn,[n(vt(nn),{ref_key:"refCamera",ref:r,capture:"shoot","show-on-stream":"",onOnloading:v,onResult:c},null,512),_[0]||(_[0]=be('<div class="focus-frame"></div><div class="dark-overlay top"></div><div class="dark-overlay bottom"></div><div class="dark-overlay left"></div><div class="dark-overlay right"></div>',5))])])])]),a("div",wn,[n(vt(tt),{onClick:p,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"99%"}},{default:s(()=>_[1]||(_[1]=[m(" Cancel ",-1)])),_:1,__:[1]})])],64))}}),Cn=P({name:"MyComponent",components:{IonAlert:ye},data(){return{isOpen:!1,alertButtons:[{text:"Close",role:"cancel",cssClass:"alert-danger-button"}],messageContent:"No available batches/lot numbers"}},methods:{setOpen(t){this.isOpen=t},handleDismiss(){this.setOpen(!1),this.$emit("alertClosed"),this.dismiss()},dismiss(){W.dismiss()}},mounted(){this.setOpen(!0)}});function Vn(t,e,i,l,c,v){const r=o("ion-alert");return u(),$(r,{"is-open":t.isOpen,header:"Please update stock","sub-header":"",message:t.messageContent,buttons:t.alertButtons,"css-class":"my-custom-alert",onDidDismiss:t.handleDismiss},null,8,["is-open","message","buttons","onDidDismiss"])}const ct=F(Cn,[["render",Vn],["__scopeId","data-v-cf655518"]]),kn=P({components:{IonRadioGroup:ie,IonRadio:se,IonItem:L,IonList:X},props:{action:{type:Function,required:!0},retro:{type:Boolean,required:!0}},async mounted(){this.loadCurrentSelectedDrug()},watch:{retro:{handler(){this.checkToShow()},deep:!0}},data(){return{lotNumbers:[],selectedOption:{}}},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},checkIfSelected(){return R.has(this.selectedOption,"lotNumber")||this.checkDrugNameInt()==!0?!0:(x("Select a batch number!"),!1)},performAction(){this.checkIfSelected()==!0&&this.$emit("actionTriggered",this.selectedOption)},async loadCurrentSelectedDrug(){try{const e=D().getCurrentSelectedDrug();await this.formBatchList(e.drug.drug_id)}catch(t){}},async formBatchList(t){try{const i=D().getLotNumberData();i.length==0&&this.$emit("emptyList",""),i.forEach(l=>{const c={id:l.id,lotNumber:l.batch_number};this.lotNumbers.push(c)}),this.checkToShow()}catch(e){}},addUnkownLotNumberOption(){const e=D().getCurrentSelectedDrug();this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"})},checkToShow(){this.$props.retro==!0&&this.addUnkownLotNumberOption(),this.checkDrugNameInt()},checkDrugNameInt(){const e=D().getCurrentSelectedDrug();return st(e.drug)==!0?(this.lotNumbers=[],this.lotNumbers.push({id:e.drug.drug_id,lotNumber:"Unknown"}),!0):!1}}});function In(t,e,i,l,c,v){const r=o("ion-radio"),d=o("ion-item"),p=o("ion-radio-group"),h=o("ion-list"),g=o("ion-card"),f=o("ion-row");return u(),$(f,null,{default:s(()=>[n(g,{class:"shadowless-card",style:{width:"100%",padding:"0"}},{default:s(()=>[n(h,null,{default:s(()=>[n(p,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=_=>t.handleChange(_)),value:"start"},{default:s(()=>[(u(!0),b(H,null,et(t.lotNumbers,_=>(u(),$(d,{key:_.id},{default:s(()=>[n(r,{value:_},{default:s(()=>[m(y(_.lotNumber),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1},8,["compareWith"])]),_:1})]),_:1})]),_:1})}const pe=F(kn,[["render",In],["__scopeId","data-v-039b66ba"]]),$n=P({components:{IonContent:j,IonHeader:z,IonItem:L,IonList:X,IonMenu:ut,IonTitle:G,IonToolbar:q,IonInput:dt,BasicInputField:mt,PreviousVitals:at,customDatePicker:ot,lotNumberList:pe,alert:ct},data(){return{iconsContent:N,showPD:!1,showDateBtns:!0,vaccineDate:"",batchNumber:"",drugName:"",currentDrug:"",is_batch_number_valid:!1,batch_number_error_message:"Enter a valid batch number",full_name:"",sessionDate:C.toStandardHisDisplayFormat(O.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{A(ue,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},selected_date_:"",is_a_vaccine:!0}},computed:{...I(D,["tempScannedBatchNumber"]),...I(J,["patient"])},setup(){const t=Z(null);return{childComponentRef:t,triggerChildAction:()=>{t.value&&t.value.performAction()}}},async mounted(){this.loadCurrentSelectedDrug(),this.displayUserNames();const t=D();this.showPD=t.isVaccinePassed(),this.showDateBtns=!this.showPD},props:{customSchedule:{type:[],default:[]}},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}}},methods:{loadCurrentSelectedDrug(){const t=D();this.currentDrug=t.getCurrentSelectedDrug(),this.drugName=this.currentDrug.drug.drug_name,this.batchNumber=this.currentDrug.drug.vaccine_batch_number?this.currentDrug.drug.vaccine_batch_number:"",st(this.currentDrug.drug)==!0&&(this.is_a_vaccine=!1,this.batchNumber="unknown")},showCPD(){this.showPD=!0,this.showDateBtns=!1},dismiss(){W.dismiss()},updateDate(t){this.vaccineDate=C.toStandardHisFormat(t)},saveBatchWithTodayDate(){let t=O.getSessionDate();this.saveDta(t)},saveBatch(){let t;R.isEmpty(this.vaccineDate)==!0?t=O.getSessionDate():t=this.vaccineDate,this.saveDta(t)},updateBatchNumber(t){var i;const e=t.target.value;this.batchNumber=e||((i=this.tempScannedBatchNumber)==null?void 0:i.text)||""},async ActionTriggered(t){const e={batch_number:t.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrug.drug.drug_id,drug_:this.currentDrug},i=D();i.setAdministeredVaccine(e),await ce(this.patient),i.setTempScannedBatchNumber(null),this.dismiss()},saveDta(t){this.selected_date_=t,this.triggerChildAction()},isAlphaNumeric(t){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(t)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(t){this.batchNumber=t},displayUserNames(){const e=Pe().getUser(),i=e.person.names[0].given_name,l=e.person.names[0].family_name;this.full_name=i+" "+l},childAction(){},ShowAlert(){}}}),An={class:"modal_wrapper"},Bn={class:"lbl-ct"},Mn={class:"client_admi"},Nn={class:"client_admin_sub_x"},Pn={class:"btnContent"},Tn={key:0,class:"saveBtn"},On={key:1,class:"saveBtn"};function Hn(t,e,i,l,c,v){const r=o("ion-col"),d=o("ion-label"),p=o("ion-row"),h=o("lotNumberList"),g=o("customDatePicker"),f=o("ion-icon"),_=o("ion-button");return u(),b("div",An,[n(p,{style:{"margin-top":"10px"}},{default:s(()=>[n(r,{style:{"margin-left":"-3px"}},{default:s(()=>e[0]||(e[0]=[a("div",{class:"om"},"Administer Vaccine",-1)])),_:1,__:[0]}),n(r,{size:"6",style:{"text-align":"right"}},{default:s(()=>[n(d,{class:"lbl-tl",style:{"font-size":"13"}},{default:s(()=>[e[1]||(e[1]=m(" Todays Date: ",-1)),a("span",Bn,y(t.sessionDate),1)]),_:1,__:[1]})]),_:1})]),_:1}),n(p,null,{default:s(()=>[n(d,{style:{"font-weight":"600px","font-size":"20px",margin:"10px","margin-left":"0px"}},{default:s(()=>[m(y(t.drugName),1)]),_:1})]),_:1}),lt(n(p,null,{default:s(()=>[n(d,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:s(()=>e[2]||(e[2]=[m("Select Batch number",-1),a("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[2]})]),_:1},512),[[rt,t.is_a_vaccine]]),lt(a("div",null,[n(h,{action:t.childAction,retro:t.showPD,ref:"childComponentRef",onActionTriggered:t.ActionTriggered,onEmptyList:t.ShowAlert},null,8,["action","retro","onActionTriggered","onEmptyList"])],512),[[rt,t.is_a_vaccine]]),a("div",Mn,[e[3]||(e[3]=a("span",{class:"client_admi_sub"},"Vaccination done by: ",-1)),a("span",Nn,y(t.full_name),1)]),t.showPD?(u(),$(g,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):S("",!0),a("div",Pn,[t.showDateBtns?(u(),b("div",Tn,[a("div",null,[n(_,{onClick:t.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:s(()=>[e[4]||(e[4]=m(" Done today ",-1)),n(f,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])]),e[6]||(e[6]=a("div",{style:{"margin-bottom":"20px"}},null,-1)),a("div",null,[n(_,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:s(()=>[e[5]||(e[5]=m(" Done earlier ",-1)),n(f,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[5]},8,["onClick"])])])):S("",!0),t.showDateBtns?S("",!0):(u(),b("div",On,[n(p,{"justify-content-between":""},{default:s(()=>[n(r,{size:"auto"},{default:s(()=>[n(_,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:s(()=>e[7]||(e[7]=[m(" Cancel ",-1)])),_:1,__:[7]},8,["onClick"])]),_:1}),n(r,{size:"auto",class:"ion-text-end",style:{"margin-left":"auto"}},{default:s(()=>[n(_,{onClick:t.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:s(()=>e[8]||(e[8]=[m(" Save ",-1)])),_:1,__:[8]},8,["onClick"])]),_:1})]),_:1})]))])])}const St=F($n,[["render",Hn],["__scopeId","data-v-58aa351e"]]),Fn=P({components:{IonRow:Q,IonItem:L,IonList:X,IonRadio:se,IonRadioGroup:ie},data(){return{reasons:[{id:1,name:"Mistake/ Wrong Entry",type:"Mistake/ Wrong Entry"},{id:2,name:"Duplicate",type:"Duplicate"},{id:3,name:"System Error",type:"System Error"}],selectedOption:{}}},computed:{...I(J,["patient"])},async mounted(){},props:{},methods:{compareWith(t,e){return t.id===e.id},handleChange(t){this.selectedOption=t.detail.value},dismiss(){try{W.dismiss()}catch(t){}},checkIfSelected(){return R.has(this.selectedOption,"name")==!0?!0:(x("Select a reason!"),!1)},async voidVaccine1(){if(this.checkIfSelected()==!0)try{const t=D(),e=t.getVaccineToBeVoided();await Ye(this.patient,e,this.selectedOption.name),ht("Vaccine was successfully voided!"),t.setVaccineReload(!t.getVaccineReload()),W.dismiss({voided:!0})}catch(t){}}}}),En={class:"saveBtn"};function Rn(t,e,i,l,c,v){const r=o("ion-row"),d=o("ion-radio"),p=o("ion-item"),h=o("ion-radio-group"),g=o("ion-list"),f=o("ion-button"),_=o("ion-col");return u(),b(H,null,[n(r,{class:"centered-content"},{default:s(()=>e[1]||(e[1]=[a("div",{class:"text-container"},[a("div",null,"Do you want to void this vaccine?"),a("div",null,"Please specify reason for voiding this administered vaccine?")],-1)])),_:1,__:[1]}),n(r,null,{default:s(()=>[n(g,{style:{width:"100%"}},{default:s(()=>[n(h,{compareWith:t.compareWith,onIonChange:e[0]||(e[0]=V=>t.handleChange(V)),value:"start"},{default:s(()=>[(u(!0),b(H,null,et(t.reasons,V=>(u(),$(p,null,{default:s(()=>[n(d,{value:V},{default:s(()=>[m(y(V.name),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1},8,["compareWith"])]),_:1})]),_:1}),a("div",En,[n(r,{class:"ion-justify-content-between"},{default:s(()=>[n(_,{size:"auto"},{default:s(()=>[n(f,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:s(()=>e[2]||(e[2]=[m(" Cancel ",-1)])),_:1,__:[2]},8,["onClick"])]),_:1}),n(_,{size:"auto"},{default:s(()=>[n(f,{onClick:t.voidVaccine1,class:"btnText",fill:"solid",style:{width:"130px"}},{default:s(()=>e[3]||(e[3]=[m(" Void ",-1)])),_:1,__:[3]},8,["onClick"])]),_:1})]),_:1})])],64)}const Wn=F(Fn,[["render",Rn],["__scopeId","data-v-ea212a62"]]),Un=P({name:"Home",components:{IonContent:j,IonHeader:z,IonMenuButton:Nt,IonPage:pt,IonTitle:G,IonToolbar:q,IonButton:tt,IonCard:Mt,IonCardContent:Bt,IonCardHeader:At,IonCardSubtitle:$t,IonCardTitle:It,IonAccordion:kt,IonAccordionGroup:Vt,IonItem:L,IonLabel:Y,IonModal:Ct,IonCol:it,IonRow:Q,alert:ct},data(){return{iconsContent:N,fowardData:{}}},computed:{},created(){},mounted(){},props:{vaccines:{type:{},default:{}},milestone_status:{type:String,default:0}},watch:{},setup(){let t=!1;return{isModalOpening:t,cleanupModal:()=>{t=!1;const i=document.querySelector(".pr_o");i&&i.remove()}}},methods:{covertToDate(t){return C.toStandardHisDisplayFormat(t)},getColorForVaccine(t){if(t.status=="administered")return"success";if(t.status!="administered")return this.milestone_status=="upcoming"?"medium":this.milestone_status=="current"?"success":"danger"},getInjectSignForVaccine(t){if(t.status=="administered")return this.iconsContent.greenInjection;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.fadedGreenIjection},getCheckBoxForVaccine(t){if(t.status=="administered")return this.iconsContent.improvedGreenTick;if(t.status!="administered")return this.milestone_status=="upcoming"?"":this.iconsContent.whiteCheckbox},async openAdministerVaccineModal(t){const e=document.querySelector(".pr_o");if(this.isModalOpening||e){console.log("Modal already open or opening, current state:",{isModalOpening:this.isModalOpening,modalExists:!!e});return}try{this.isModalOpening=!0;const i=D();i.setCurrentSelectedDrug(t);const l=new de,c=await Te("stock",{whereClause:{drug_id:t.drug_id}});i.setLotNumberData(c),this.checkIfAdminstredAndAskToVoid()||(c.length===0?st(t)?A(St,{class:"otherVitalsModal pr_o"}):A(ct,{class:"otherVitalsModal pr_o"}):A(St,{class:"otherVitalsModal pr_o"}))}catch(i){throw console.error("Error opening modal:",i),i}finally{this.isModalOpening=!1,console.log("Modal open process completed")}},disableVaccine(t){if(t.status!=null&&t.status=="administered")return!1;if(t.can_administer!=null&&t.can_administer==!1)return!0;if(t.can_administer!=null&&t.can_administer==!0)return!1},checkVaccineName(t){return t.replace(/Pentavalent/g,"Penta")},checkIfAdminstredAndAskToVoid(){const t=D(),e=t.getCurrentSelectedDrug();return e.drug.status=="administered"?(t.setVaccineToBeVoided(e),A(Wn,{class:"otherVitalsModal"},!1),!0):!1}}}),Gn={class:"vaccinesList"},Ln={class:"button-content"},zn={style:{"margin-top":"20px"}};function jn(t,e,i,l,c,v){const r=o("ion-icon"),d=o("ion-button"),p=o("ion-col"),h=o("ion-row");return u(),b("div",Gn,[n(h,null,{default:s(()=>[n(p,null,{default:s(()=>[(u(!0),b(H,null,et(t.vaccines,g=>(u(),$(d,{disabled:t.disableVaccine(g),class:"administerVac",key:g,onClick:f=>t.openAdministerVaccineModal(g),fill:"solid",color:t.getColorForVaccine(g),style:{background:"#ddeedd","border-radius":"8px",color:"#636363"}},{default:s(()=>[n(r,{slot:"start",icon:t.getInjectSignForVaccine(g)},null,8,["icon"]),a("div",Ln,[a("div",zn,y(t.checkVaccineName(g.drug_name)),1),a("div",null,y(t.covertToDate(g.date_administered)),1)]),n(r,{slot:"end",icon:t.getCheckBoxForVaccine(g)},null,8,["icon"])]),_:2},1032,["disabled","onClick","color"]))),128))]),_:1})]),_:1})])}const gt=F(Un,[["render",jn],["__scopeId","data-v-90bda1b0"]]),xn=P({name:"Home",components:{IonIcon:De,IonButton:tt,customVaccine:gt,IonHeader:z,IonTitle:G,IonFooter:Pt,IonCol:it,IonRow:Q,IonContent:j},data(){return{iconsContent:N,vaccineHistory:[]}},setup(){return{closeCircleOutline:we,checkmarkOutline:Se}},computed:{...I(D,["vaccineReload","vaccineSchedule"])},methods:{vaccinesGivenCount(t){const e=[];return t.antigens.forEach(i=>{i.status=="administered"&&e.push(i)}),e.length},dismiss(){W.dismiss()}}}),qn={style:{color:"#016302"}},Jn={style:{color:"#316CBA","margin-left":"10%"}};function Kn(t,e,i,l,c,v){const r=o("ion-title"),d=o("ion-header"),p=o("ion-icon"),h=o("row"),g=o("customVaccine"),f=o("ion-content"),_=o("ion-button"),V=o("ion-col"),M=o("ion-row"),T=o("ion-footer");return u(),b(H,null,[n(d,null,{default:s(()=>[n(r,{style:{"margin-bottom":"20px"},class:"modalTitle OtherVitalsTitle"},{default:s(()=>e[1]||(e[1]=[m("Vaccination History",-1)])),_:1,__:[1]})]),_:1}),n(f,{fullscreen:!0,class:"ion-padding"},{default:s(()=>[(u(!0),b(H,null,et(t.vaccineSchedule.vaccine_schedule,(w,U)=>(u(),b("div",{class:"mod-ls",key:U},[n(h,null,{default:s(()=>[n(p,{size:"medium",style:{"margin-bottom":"-6px"},icon:t.iconsContent.calendar},null,8,["icon"]),a("span",null,[e[2]||(e[2]=m(" at ",-1)),a("span",qn,y(w.age),1)]),a("span",Jn,y(t.vaccinesGivenCount(w))+"/"+y(w.antigens.length)+" vaccine(s) given",1)]),_:2},1024),n(h,null,{default:s(()=>[n(g,{vaccines:w.antigens,milestone_status:w.milestone_status},null,8,["vaccines","milestone_status"])]),_:2},1024)]))),128))]),_:1}),n(T,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[n(M,null,{default:s(()=>[n(V,null,{default:s(()=>[n(_,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e[0]||(e[0]=w=>t.dismiss())},{default:s(()=>e[3]||(e[3]=[m(" Cancel ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1})],64)}const Zn=F(xn,[["render",Kn],["__scopeId","data-v-59edb4e4"]]),Qn=P({mixins:[sn],components:{IonContent:j,IonHeader:z,IonItem:L,IonList:X,IonMenu:ut,IonTitle:G,IonToolbar:q,IonInput:dt,BasicInputField:mt,BasicForm:_t,PreviousVitals:at,customDatePicker:ot,DynamicButton:oe,IonFooter:Pt},data(){return{iconsContent:N,BMI:{},BPStatus:{},vValidations:"",hasValidationErrors:[],vitalsInstance:{},validationStatus:{heightWeight:!1,bloodPressure:!1},showPD:!1,initialSeriousData:[],initialFirstDecisionData:[],initialOutcomeData:[]}},props:{protectedStatus:String,lastVaccinesGiven:Array},watch:{personInformation:{async handler(){await this.setRelationShip()},deep:!0}},computed:{...I(J,["patient"]),...I(bt,["changeGuardianInfo","vaccineAdverseEffects","protectedAtBirth","serious","outcome","firstDecision"]),guardianFirstname(){return k(this.changeGuardianInfo,"guardianFirstname","value")},guardianLastname(){return k(this.changeGuardianInfo,"guardianLastname","value")},guardianMiddleName(){return k(this.changeGuardianInfo,"guardianMiddleName","value")},guardianPhoneNumber(){return k(this.changeGuardianInfo,"guardianPhoneNumber","value")},relationship(){return k(this.changeGuardianInfo,"relationship","value")}},async mounted(){await this.setupData()},setup(){return{checkmark:wt,pulseOutline:ne}},methods:{async setupData(){var i,l,c,v,r,d,p,h,g,f;const t=bt();this.initialSeriousData=t.getInitialSerious(),this.initialFirstDecisionData=t.getInitialFirstDecision(),this.initialOutcomeData=t.getInitialOutcome();const e=await on.getRelationships(this.patient.patientID);(e==null?void 0:e.length)>0&&(B(this.changeGuardianInfo,"guardianNationalID","value",this.setAttribute("Regiment ID",(i=e[0])==null?void 0:i.relation)),B(this.changeGuardianInfo,"guardianFirstname","value",(c=(l=e[0])==null?void 0:l.relation.names[0])==null?void 0:c.given_name),B(this.changeGuardianInfo,"guardianLastname","value",(r=(v=e[0])==null?void 0:v.relation.names[0])==null?void 0:r.family_name),B(this.changeGuardianInfo,"guardianMiddleName","value",(p=(d=e[0])==null?void 0:d.relation.names[0])==null?void 0:p.middle_name),B(this.changeGuardianInfo,"guardianPhoneNumber","value",this.setAttribute("Cell Phone Number",(h=e[0])==null?void 0:h.relation)),B(this.changeGuardianInfo,"relationship","value",{id:(g=e[0])==null?void 0:g.type.relationship_type_id,name:(f=e[0])==null?void 0:f.type.b_is_to_a}),await this.setRelationShip()),this.resetData()},async setRelationShip(){this.gender?(await this.getRelationships(),B(this.changeGuardianInfo,"relationship","displayNone",!1),B(this.changeGuardianInfo,"relationship","multiSelectData",this.relationships)):B(this.changeGuardianInfo,"relationship","displayNone",!0)},setAttribute(t,e){if(!e||Object.keys(e).length===0)return;let i=e.person_attributes.find(l=>l.type.name==t);if(i!=null)return i.value},resetData(){const t=bt();t.setProtectedAtBirth(t.getInitialProtectedAtBirth()),t.setVaccineAdverseEffects(t.getInitialVaccineAdverseEffects())},async createGuardian(){const t=await this.guardianData();if(an(this.changeGuardianInfo)){const e=new Oe;await e.registerGuardian(t);const i=e.getPersonID(),l=k(this.changeGuardianInfo,"relationship","value").id;return l&&await He.createRelation(this.patient.patientID,i,l),ht("Guarding information save successfully",3e3),!0}else return x("Guarding Information not save",3e3),!1},async saveData(){const t=await this.createGuardian(),e=await this.saveVaccineAdverseEffects();t&&e&&W.dismiss()},async saveVaccineAdverseEffects(){if(this.patient.patientID){const t=k(this.outcome,"Date of death","value")||C.sessionDate(),e=await this.formatCheckBoxData(this.serious,C.sessionDate(),this.lastVaccinesGiven),i=await this.formatRadioButtonData(this.outcome,t,this.lastVaccinesGiven),l=await this.formatCheckBoxData(this.vaccineAdverseEffects,C.sessionDate(),this.lastVaccinesGiven),c=k(this.firstDecision,"Investigation needed","value");let v=[];c&&(v=[{concept_id:11887,value_text:c,obs_datetime:C.sessionDate()}]);const r=[...e,...i,...l,...v].filter(d=>d!==void 0);return O.getUserID(),l.length>0?(console.log("ð ~ saveVaccineAdverseEffects ~ result:",r),!0):(x("Vaccine adverse effects not saved",1500),!1)}},async formatCheckBoxData(t,e=K.getSessionDate(),i){return Array.isArray(t)?(await Promise.all(t.map(async c=>{var r,d;if(!((d=(r=c==null?void 0:c.checkboxBtnContent)==null?void 0:r.data)!=null&&d.length))return[];const v=c.checkboxBtnContent.data.map(async p=>{if(!(p!=null&&p.checked)||p!=null&&p.buildConceptIgnore)return null;try{const h=await K.getConceptID(p.value,!0),g=await K.getConceptID(c.checkboxBtnContent.header.name,!0);if(e=k(t,p.name+" date","value")||e,!h||!g)return null;const _={concept_id:g,value_coded:h,obs_datetime:e};if(i.length>0){const V=i.map(M=>({concept_id:h,value_coded:M.drug_id,obs_datetime:e}));return{..._,child:V}}return _}catch(h){return console.error("Error processing checkbox data:",h),null}});return(await Promise.all(v)).filter(Boolean)}))).flat().filter(Boolean):[]},async formatRadioButtonData(t,e=K.getSessionDate(),i){const l=t.map(async c=>{if(c&&c.radioBtnContent&&c.radioBtnContent.header&&c.radioBtnContent.header.selectedValue){const v=await K.getConceptID(c.radioBtnContent.header.selectedValue,!0),r=await K.getConceptID(c.radioBtnContent.header.name,!0),d=e||K.getSessionDate(),p=i.map(h=>({concept_id:v,value_coded:h.drug_id,obs_datetime:d}));return i?{concept_id:r,value_coded:v,obs_datetime:d,child:p}:{concept_id:r,value_coded:v,obs_datetime:d}}else return null});return(await Promise.all(l)).filter(c=>c!==null)},async guardianData(){return{person_id:this.patient.patientID,given_name:this.guardianFirstname,family_name:this.guardianLastname,middle_name:this.guardianMiddleName,gender:"",birthdate:"",cell_phone_number:this.guardianPhoneNumber,birthdate_estimated:!1,home_district:"",home_traditional_authority:"",home_village:"",current_district:"",current_traditional_authority:"",current_village:"",landmark:"",occupation:"",facility_name:"",patient_type:"",national_id:k(this.changeGuardianInfo,"guardianNationalID","value")}},async handleInputData(t){},dismiss(){W.dismiss()}}}),Xn={class:""},Yn={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},ts={class:""},es={class:"ion-padding",slot:"content"},ns={slot:"content"},ss={slot:"content"},is={slot:"content"},as={slot:"content"},os={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}};function ls(t,e,i,l,c,v){const r=o("ion-title"),d=o("ion-icon"),p=o("ion-header"),h=o("ion-label"),g=o("ion-item"),f=o("basic-form"),_=o("ion-accordion"),V=o("ion-accordion-group"),M=o("ion-content"),T=o("DynamicButton"),w=o("ion-col"),U=o("ion-row"),nt=o("ion-footer");return u(),b(H,null,[n(p,{style:{display:"flex","justify-content":"space-between"}},{default:s(()=>[n(r,{class:"modalTitle"},{default:s(()=>e[2]||(e[2]=[m("Follow up visits",-1)])),_:1,__:[2]}),n(d,{onClick:e[0]||(e[0]=ft=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),n(M,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:s(()=>[a("div",Xn,[n(V,{ref:"accordionGroup",class:""},{default:s(()=>[n(_,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:s(()=>[n(g,{slot:"header",color:"light"},{default:s(()=>[n(h,{class:"previousLabel"},{default:s(()=>e[3]||(e[3]=[m("Change Guardian",-1)])),_:1,__:[3]})]),_:1}),a("div",Yn,[a("div",ts,[n(f,{contentData:t.changeGuardianInfo,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:inputValue"])])])]),_:1}),n(_,{value:"second","toggle-icon-slot":"start",class:"custom_card"},{default:s(()=>[n(g,{slot:"header",color:"light"},{default:s(()=>[n(h,{class:"previousLabel"},{default:s(()=>e[4]||(e[4]=[m("Vaccine adverse effects",-1)])),_:1,__:[4]})]),_:1}),a("div",es,[a("div",null,[a("div",ns,[n(f,{contentData:t.vaccineAdverseEffects,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:inputValue"])])]),a("div",null,[a("div",ss,[n(f,{contentData:t.serious,initialData:t.initialSeriousData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])]),a("div",null,[a("div",is,[n(f,{contentData:t.outcome,initialData:t.initialOutcomeData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])]),a("div",null,[a("div",as,[n(f,{contentData:t.firstDecision,initialData:t.initialFirstDecisionData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","initialData","onUpdate:inputValue"])])])])]),_:1}),t.protectedStatus!="Yes"?(u(),$(_,{key:0,value:"third","toggle-icon-slot":"start",class:"custom_card"},{default:s(()=>[n(g,{slot:"header",color:"light"},{default:s(()=>[n(h,{class:"previousLabel"},{default:s(()=>e[5]||(e[5]=[m("Child protected at birth",-1)])),_:1,__:[5]})]),_:1}),a("div",os,[n(f,{contentData:t.protectedAtBirth,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:inputValue"])])]),_:1})):S("",!0)]),_:1},512)])]),_:1}),n(nt,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[n(U,null,{default:s(()=>[n(w,null,{default:s(()=>[n(T,{onClick:e[1]||(e[1]=ft=>t.saveData()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const rs=F(Qn,[["render",ls],["__scopeId","data-v-b4532903"]]),cs=P({name:"Home",components:{IonContent:j,IonHeader:z,IonPage:pt,IonTitle:G,IonToolbar:q,BasicForm:_t,customDatePicker:ot},data(){return{popoverOpen:!1,iconContent:N,event:null,BMI:"",showPD:!1,vitals_date:C.toStandardHisFormat(C.sessionDate()),formOpen:!0,checkUnderSixWeeks:!1,showDateBtns:!0}},computed:{...I(J,["patient"]),...I(Fe,["vitalsWeightHeight"])},watch:{patient:{async handler(){this.checkAge()}}},mounted(){this.checkAge()},setup(){},methods:{checkAge(){var t,e,i,l;R.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=C.dateDiffInDays(C.sessionDate(),(l=(i=this.patient)==null?void 0:i.personInformation)==null?void 0:l.birthdate)<42,this.controlHeight())},nav(t){this.$router.push(t)},formatBirthdate(){var t,e;return C.getBirthdateAge((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},controlHeight(){this.checkUnderSixWeeks?(B(this.vitalsWeightHeight,"Height (cm)","inputHeader","Height"),B(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!0)):B(this.vitalsWeightHeight,"Height (cm)","inputDisplayNone",!1)},async validaterowData(t){const e=O.getUserID(),i=new Dt(this.patient.patientID,e),l=k(this.vitalsWeightHeight,"weight","value"),c=k(this.vitalsWeightHeight,"Height (cm)","value"),v=i.validator({inputHeader:"Height*",value:c}),r=i.validator({inputHeader:"Weight*",value:l});v&&c?B(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",v.flat(1/0)[0]):B(this.vitalsWeightHeight,"Height (cm)","alertsErrorMassage",""),r&&l?B(this.vitalsWeightHeight,"weight","alertsErrorMassage",r.flat(1/0)[0]):B(this.vitalsWeightHeight,"weight","alertsErrorMassage",""),this.setBMI(l,c)},async saveVitals(){const t=O.getUserID(),e=new Dt(this.patient.patientID,t),i=k(this.vitalsWeightHeight,"weight","value"),l=k(this.vitalsWeightHeight,"Height (cm)","value");let c=null;this.checkUnderSixWeeks||(c=e.validator({inputHeader:"Height*",value:l}));const v=e.validator({inputHeader:"Weight*",value:i}),r=await re(this.vitalsWeightHeight);if(r.length>0&&v==null&&c==null){const d=JSON.parse(JSON.stringify(this.patient));let p=d==null?void 0:d.vitals;p.unsaved=[...p.unsaved,...r],await ae(d),ht("Vitals saved successful"),this.cleanInputFields()}else x("Please complete the form")},cleanInputFields(){B(this.vitalsWeightHeight,"weight","value",""),B(this.vitalsWeightHeight,"Height (cm)","value",""),this.dismiss()},dismiss(){W.dismiss()},async setBMI(t,e){var i,l,c,v,r,d,p,h;(l=(i=this.patient)==null?void 0:i.personInformation)!=null&&l.gender&&((v=(c=this.patient)==null?void 0:c.personInformation)!=null&&v.birthdate)&&(this.BMI=await Xt.getBMI(parseInt(t),parseInt(e),(d=(r=this.patient)==null?void 0:r.personInformation)==null?void 0:d.gender,C.calculateAge((h=(p=this.patient)==null?void 0:p.personInformation)==null?void 0:h.birthdate,C.sessionDate()))),this.updateBMI()},async updateBMI(){var i,l,c,v,r,d;const t=(l=(i=this.BMI)==null?void 0:i.color)!=null?l:[],e=this.vitalsWeightHeight[0].alerts[0];e.icon=Xt.iconBMI(t),e.backgroundColor=t[0],e.textColor=t[1],e.index="BMI "+((v=(c=this.BMI)==null?void 0:c.index)!=null?v:""),e.value=(d=(r=this.BMI)==null?void 0:r.result)!=null?d:""},showCPD(){this.showPD=!0,this.showDateBtns=!1},updateDate(t){this.vitals_date=C.toStandardHisFormat(t)}}}),ds={key:0,class:"pim-cls-1 modal_wrapper"},us={class:"center text_12"},ps={class:"btnContent"},ms={key:0,class:"saveBtn"},hs={key:1,class:"saveBtn"};function _s(t,e,i,l,c,v){const r=o("BasicForm"),d=o("ion-row"),p=o("customDatePicker"),h=o("ion-icon"),g=o("ion-button"),f=o("ion-col");return t.formOpen?(u(),b("div",ds,[e[7]||(e[7]=a("div",{class:"OtherVitalsHeading"},[a("div",{class:"OtherVitalsTitle"},"Add Weight/Height")],-1)),a("div",null,[a("div",us,[n(d,null,{default:s(()=>[n(r,{contentData:t.vitalsWeightHeight,"onUpdate:inputValue":e[0]||(e[0]=_=>t.validaterowData(_))},null,8,["contentData"])]),_:1})])]),t.showPD?(u(),$(p,{key:0,onDateChange:t.updateDate},null,8,["onDateChange"])):S("",!0),a("div",ps,[t.showDateBtns?(u(),b("div",ms,[a("div",null,[n(g,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=_=>t.saveVitals())},{default:s(()=>[e[3]||(e[3]=m(" Done today ",-1)),n(h,{slot:"end",size:"small",icon:t.iconContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[3]})]),a("div",null,[n(g,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:s(()=>[e[4]||(e[4]=m(" Done earlier ",-1)),n(h,{slot:"end",size:"small",icon:t.iconContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[4]},8,["onClick"])])])):S("",!0),t.showDateBtns?S("",!0):(u(),b("div",hs,[n(d,null,{default:s(()=>[n(f,null,{default:s(()=>[n(g,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:s(()=>e[5]||(e[5]=[m(" Cancel ",-1)])),_:1,__:[5]},8,["onClick"])]),_:1}),n(f,null,{default:s(()=>[n(g,{onClick:e[2]||(e[2]=_=>t.saveVitals()),class:"btnText",fill:"solid",style:{width:"130px"}},{default:s(()=>e[6]||(e[6]=[m(" save ",-1)])),_:1,__:[6]})]),_:1})]),_:1})]))])])):S("",!0)}const gs=F(cs,[["render",_s],["__scopeId","data-v-7b242731"]]),fs=P({components:{IonContent:j,IonHeader:z,IonItem:L,IonList:X,IonMenu:ut,IonTitle:G,IonToolbar:q,IonInput:dt,BasicInputField:mt,BasicForm:_t,PreviousVitals:at,customDatePicker:ot,IonCol:it,IonRow:Q,VueMultiselect:Ce,IonLabel:Y,lotNumberList:pe},data(){const t=Z(0),e=Z([]);return{iconsContent:N,showPD:!1,batchNumber:"",vaccineName:"",currentDrugOb:{},comp_key:t,otherVaccinesList:e,is_batch_number_valid:!1,vaccineDate:"",is_vaccine_name_valid:!1,drugErrMsg:"",batch_number_error_message:"Enter a valid batch number",vaccine_name_error_message:"Enter a valid valid vaccine name",sessionDate:C.toStandardHisDisplayFormat(O.getSessionDate()),InnerActionBtnPropeties:{name:"Scan",show:!0,fn:()=>{A(ue,{class:"otherVitalsModal qr_code_modal"},!1)},icon:"",show_icon:!1},showDateBtns:!0,selected_date_:"",show_select_batch:!1,skip_validation:!1,antigens:e}},computed:{...I(ln,["administerOtherVaccine"]),...I(D,["tempScannedBatchNumber","vaccineSchedule"]),...I(J,["patient"])},async mounted(){this.vaccineSchedule.vaccine_schedule.forEach(t=>{this.antigens.push(...t.antigens)})},watch:{batchNumber:{handler(){this.validateBatchNumber()},deep:!0},tempScannedBatchNumber:{handler(){this.tempScannedBatchNumber!=null&&(this.batchNumber=this.tempScannedBatchNumber.text,this.validateBatchNumber())}},vaccineName:{handler(){this.validateVaccineName()}}},setup(){const t=Z(null);return{childComponentRef:t,triggerChildAction:()=>{t.value&&t.value.performAction()}}},methods:{showCPD(){this.showPD=!0,this.showDateBtns=!1},updateBatchNumber(t){var i;const e=t.target.value;this.batchNumber=e||((i=this.tempScannedBatchNumber)==null?void 0:i.text)||""},saveBatchWithTodayDate(){let t=O.getSessionDate();this.saveDta(t)},dismiss(){W.dismiss()},saveBatch(){let t;R.isEmpty(this.vaccineDate)==!0?t=O.getSessionDate():t=this.vaccineDate,this.saveDta(t)},validateVaccineName(){if(R.isEmpty(this.vaccineName)==!0)return this.is_vaccine_name_valid=!0,!1;if(R.isEmpty(this.vaccineName)==!1)return this.is_vaccine_name_valid=!1,!0},updateVaccineName(t){this.currentDrugOb=t,console.log(this.currentDrugOb),D().setCurrentSelectedDrug(t),this.pullLotNumbersForVaccine(this.currentDrugOb)},async pullLotNumbersForVaccine(t){this.show_select_batch=!1;const e=D(),l=await new de().getDrugBatches(t.drug_id);e.setLotNumberData(l),l.length==0&&(st(t)==!1&&A(ct,{class:"otherVitalsModal"}),st(t)==!0&&(this.show_select_batch=!1,this.skip_validation=!0)),l.length>0&&(this.comp_key=this.comp_key+1,this.show_select_batch=!0)},isAlphaNumeric(t){return/^[a-zA-Z0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+$/.test(t)},validateBatchNumber(){this.isAlphaNumeric(this.batchNumber)==!0&&(this.is_batch_number_valid=!1),this.isAlphaNumeric(this.batchNumber)==!1&&(this.is_batch_number_valid=!0)},updateBatchNumberByPassValue(t){this.batchNumber=t},ActionTriggered(t){const e={batch_number:t.lotNumber,date_administered:this.selected_date_,drug_id:this.currentDrugOb.drug_id,drug_:this.currentDrugOb},i=D();i.setAdministeredVaccine(e),ce(this.patient),i.setTempScannedBatchNumber(null),this.dismiss()},saveDta(t){this.validateVaccineName()==!0&&(this.selected_date_=t,this.triggerChildAction(),this.show_select_batch==!1&&this.skip_validation==!1&&Ee("Please Update Stock for Selected Vaccine"))},childAction(){}}}),vs={class:"modal_wrapper"},bs={class:"lbl-ct"},ys={style:{"margin-top":"30px"}},Ds={class:"btnContent"},Ss={key:0,class:"saveBtn"},ws={key:1,class:"saveBtn"};function Cs(t,e,i,l,c,v){const r=o("ion-col"),d=o("ion-label"),p=o("ion-row"),h=o("VueMultiselect"),g=o("lotNumberList"),f=o("customDatePicker"),_=o("ion-icon"),V=o("ion-button");return u(),b("div",vs,[n(p,{style:{"margin-top":"10px"}},{default:s(()=>[n(r,{style:{"margin-left":"-3px"}},{default:s(()=>e[3]||(e[3]=[a("div",{class:"om"},"Add Other Vaccine",-1)])),_:1,__:[3]}),n(r,{size:"6",style:{"text-align":"right"}},{default:s(()=>[n(d,{class:"lbl-tl",style:{"font-size":"13"}},{default:s(()=>[e[4]||(e[4]=m(" Todays Date: ",-1)),a("span",bs,y(t.sessionDate),1)]),_:1,__:[4]})]),_:1})]),_:1}),a("div",ys,[n(p,null,{default:s(()=>[n(d,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:s(()=>e[5]||(e[5]=[m("Vaccine name",-1),a("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[5]})]),_:1}),n(h,{modelValue:t.vaccineName,"onUpdate:modelValue":[e[0]||(e[0]=M=>t.vaccineName=M),e[1]||(e[1]=M=>t.updateVaccineName(M))],multiple:!1,taggable:!1,"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"select vaccine",placeholder:"select vaccine",selectLabel:"",label:"drug_name",searchable:!0,onSearchChange:e[2]||(e[2]=M=>t.$emit("search-change",M)),"track-by":"drug_id",options:t.otherVaccinesList},null,8,["modelValue","options"]),a("div",null,[t.is_vaccine_name_valid?(u(),$(d,{key:0,style:{padding:"3%"},class:"error-label"},{default:s(()=>[m(y(t.vaccine_name_error_message),1)]),_:1})):S("",!0)])]),lt(n(p,null,{default:s(()=>[n(d,{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:s(()=>e[6]||(e[6]=[m("Batch numbers",-1),a("span",{style:{color:"#b42318"}},"*",-1)])),_:1,__:[6]})]),_:1},512),[[rt,t.show_select_batch]]),lt(a("div",null,[(u(),$(g,{action:t.childAction,retro:t.showPD,ref:"childComponentRef",onActionTriggered:t.ActionTriggered,key:t.comp_key},null,8,["action","retro","onActionTriggered"]))],512),[[rt,t.show_select_batch]]),t.showPD?(u(),$(f,{key:0})):S("",!0),a("div",Ds,[t.showDateBtns?(u(),b("div",Ss,[a("div",null,[n(V,{onClick:t.saveBatchWithTodayDate,class:"btnText",fill:"solid"},{default:s(()=>[e[7]||(e[7]=m(" Done today ",-1)),n(_,{slot:"end",size:"small",icon:t.iconsContent.calenderwithPlus},null,8,["icon"])]),_:1,__:[7]},8,["onClick"])]),e[9]||(e[9]=a("div",{style:{"margin-bottom":"20px"}},null,-1)),a("div",null,[n(V,{class:"btnText",fill:"solid",onClick:t.showCPD},{default:s(()=>[e[8]||(e[8]=m(" Done earlier ",-1)),n(_,{slot:"end",size:"small",icon:t.iconsContent.calenderWithPenEdit},null,8,["icon"])]),_:1,__:[8]},8,["onClick"])])])):S("",!0),t.showDateBtns?S("",!0):(u(),b("div",ws,[n(p,{class:"ion-justify-content-between"},{default:s(()=>[n(r,{size:"auto"},{default:s(()=>[n(V,{onClick:t.dismiss,id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:s(()=>e[10]||(e[10]=[m(" Cancel ",-1)])),_:1,__:[10]},8,["onClick"])]),_:1}),n(r,{size:"auto"},{default:s(()=>[n(V,{onClick:t.saveBatch,class:"btnText",fill:"solid",style:{width:"130px"}},{default:s(()=>e[11]||(e[11]=[m(" Save ",-1)])),_:1,__:[11]},8,["onClick"])]),_:1})]),_:1})]))])])}const me=F(fs,[["render",Cs],["__scopeId","data-v-eb04f444"]]),Vs=P({name:"xxxComponent",components:{Carousel:$e,Slide:Ie,Pagination:ke,Navigation:Ve,customVaccine:gt,IonButton:tt,IonCol:it,IonRow:Q,IonLabel:Y},data(){return{vaccine_schArray:[],vaccineSchudulesCount:0,milestones:[],iconsContent:N,showCurrentMilestoneAlert:!1,landingSlide:0,msg:"Upcoming Vaccines",current_milestone:"",componentKey:0}},computed:{...I(D,["vaccineReload"]),...I(J,["patient"])},async mounted(){await this.loadVaccineSchedule()},watch:{vaccineReload:{async handler(){await this.loadVaccineSchedule()},deep:!0},patient:{async handler(){await this.loadVaccineSchedule()},deep:!0},vaccine_schArray:{handler(){this.reloadVaccines()}}},methods:{openAdministerOtherVaccineModal(){A(me,{class:"otherVitalsModal"})},async loadVaccineSchedule(){var l,c,v,r,d,p,h,g,f;await this.setAppointmentDate();const t=this.patient.vaccineSchedule,e=D();e.setVaccineSchedule(t),e.setLastVaccinesGiven([]),this.vaccineSchudulesCount=(c=(l=e.getVaccineSchedule())==null?void 0:l.vaccine_schedule)==null?void 0:c.length,e.resetMissedVaccineSchedules(),this.vaccine_schArray=[],this.vaccine_schArray.push((v=e.getVaccineSchedule())==null?void 0:v.vaccine_schedule),(d=(r=e.getVaccineSchedule())==null?void 0:r.vaccine_schedule)==null||d.forEach(_=>{this.findMissingVaccines(_),this.findPreviouslyAdministeredVaccineSchedule(_),this.handleSchedule(_);const V={visit:_.visit,age:_.age};this.milestones=this.appendUniqueObject(this.milestones,V)});let i=!1;(h=(p=e.getVaccineSchedule())==null?void 0:p.vaccine_schedule)==null||h.forEach(_=>{if(!i&&this.findSingleUpcomingMilestone(_)==!0){i=!0;return}}),(f=(g=e.getVaccineSchedule())==null?void 0:g.vaccine_schedule)==null||f.forEach(_=>{this.findCurrentMilestone(_)})},setSB(t){const e=D();e.setCurrentMilestoneToAdminister({currentMilestone:t.age}),this.landingSlide=t.visit-1,this.current_milestone=t.age,e.setCurrentMilestone(t.age)},handleSchedule(t){t.milestone_status=="upcoming"?(D().setCurrentSchedFound(!1),this.msg="Upcoming Vaccines",this.showCurrentMilestoneAlert=!0,this.setSB(t)):(this.setSB(t),D().setCurrentSchedFound(!1))},findSingleUpcomingMilestone(t){return t.milestone_status=="upcoming"?(this.setSB(t),!0):!1},findCurrentMilestone(t){t.milestone_status=="current"&&(this.msg="Vaccines due today",D().setCurrentSchedFound(!0),this.showCurrentMilestoneAlert=!0,this.setSB(t))},slideEvent(t){const e=D(),i=e.getCurrentMilestoneToAdminister();this.milestones.forEach(c=>{c.visit-1==t.currentSlideIndex&&(e.setCurrentMilestone(c.age),this.current_milestone=c.age)});const l=e.getCurrentMilestone();if(l==i.currentMilestone){e.getCurrentSchedFound()==!1&&(this.msg="Upcoming Vaccines"),e.getCurrentSchedFound()==!0&&(this.msg="Vaccines due today"),this.showCurrentMilestoneAlert=!0;return}l.age!=i.currentMilestone&&(this.showCurrentMilestoneAlert=!1)},appendUniqueObject(t,e){return t.some(l=>l.visit===e.visit&&l.age===e.age)||t.push(e),t},isListEmpty(t){if(t.length>0)return!0;if(t.length==0)return!1},findMissingVaccines(t){const e={age:t.age,antigens:[]};t.milestone_status=="passed"&&t.antigens.forEach(l=>{l.status=="pending"&&e.antigens.push(l)});const i=D();e.antigens.length>0&&i.setMissedVaccineSchedules(e)},findPreviouslyAdministeredVaccineSchedule(t){const e=[];t.antigens.forEach(i=>{i.status=="administered"&&e.push(i)}),e.length>0&&D().setLastVaccinesGiven(e)},reloadVaccines(){this.componentKey+=1},openNextVaccineAppoinment(){A(en,{class:"otherVitalsModal"},!1)},async setAppointmentDate(){const t=D(),i=await new tn().getNextAppointment();i!=null&&i.next_appointment_date&&t.setNextAppointMentDate(i.next_appointment_date)}}}),ks={key:0,class:"alert_banner"},Is={key:1,class:"alert_banner",style:{background:"inherit"}},$s={class:"container"},As={class:"center-content"},Bs={class:"centerBtns"},Ms={class:"otherVaccine center-content"},Ns={class:"centerBtns"};function Ps(t,e,i,l,c,v){const r=o("apan"),d=o("customVaccine"),p=o("ion-button"),h=o("ion-row"),g=o("slide"),f=o("navigation"),_=o("pagination"),V=o("carousel");return u(),b(H,null,[t.showCurrentMilestoneAlert?(u(),b("div",ks,[n(r,null,{default:s(()=>[m(y(t.msg),1)]),_:1})])):S("",!0),t.showCurrentMilestoneAlert?S("",!0):(u(),b("div",Is)),t.vaccineSchudulesCount>0?(u(),$(V,{key:2,"items-to-show":1,modelValue:t.landingSlide,onSlideEnd:t.slideEvent},{addons:s(()=>[n(f),n(_)]),default:s(()=>[(u(!0),b(H,null,et(t.vaccineSchudulesCount,(M,T)=>(u(),$(g,{key:M},{default:s(()=>[n(h,{class:""},{default:s(()=>[a("div",$s,[(u(),$(d,{vaccines:t.vaccine_schArray[0][T].antigens,milestone_status:t.vaccine_schArray[0][T].milestone_status,key:t.componentKey},null,8,["vaccines","milestone_status"]))]),n(h,{class:"bottom-row"},{default:s(()=>[a("div",As,[a("div",Bs,[n(p,{onClick:e[0]||(e[0]=w=>t.openNextVaccineAppoinment()),class:"btnText",fill:"solid"},{default:s(()=>e[1]||(e[1]=[m("Set Next Appointment Date",-1)])),_:1,__:[1]})])])]),_:1})]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue","onSlideEnd"])):S("",!0),n(h,{class:"bottom-row"},{default:s(()=>[a("div",Ms,[a("div",Ns,[n(p,{onClick:t.openAdministerOtherVaccineModal,class:"btnText",fill:"solid"},{default:s(()=>e[2]||(e[2]=[m(" Add Other Vaccines ",-1)])),_:1,__:[2]},8,["onClick"])])])]),_:1})],64)}const Ts=F(Vs,[["render",Ps]]),Os=P({name:"Home",components:{IonHeader:z,IonMenuButton:Nt,IonPage:pt,IonTitle:G,IonToolbar:q,IonButton:tt,IonCard:Mt,IonCardContent:Bt,IonCardHeader:At,IonCardSubtitle:$t,IonCardTitle:It,IonAccordion:kt,IonAccordionGroup:Vt,IonItem:L,IonLabel:Y,IonModal:Ct,IonRow:Q,customVaccine:gt,IonCol:it,IonFooter:Pt,IonContent:j},data(){return{iconsContent:N}},computed:{...I(D,["currentMilestone","missedVaccineSchedules"])},methods:{vaccinesGivenCount(t){const e=[];return t.antigens.forEach(i=>{i.status=="administered"&&e.push(i)}),e.length},dismiss(){W.dismiss()}}}),Hs={style:{color:"#016302"}},Fs={style:{color:"#316CBA","margin-left":"10%"}};function Es(t,e,i,l,c,v){const r=o("ion-title"),d=o("ion-header"),p=o("ion-icon"),h=o("row"),g=o("customVaccine"),f=o("ion-content"),_=o("ion-button"),V=o("ion-col"),M=o("ion-row"),T=o("ion-footer");return u(),b(H,null,[n(d,null,{default:s(()=>[n(r,{style:{"margin-bottom":"20px"},class:"modalTitle"},{default:s(()=>e[1]||(e[1]=[m("Missed Vaccines",-1)])),_:1,__:[1]})]),_:1}),n(f,{fullscreen:!0,class:"ion-padding"},{default:s(()=>[(u(!0),b(H,null,et(t.missedVaccineSchedules,(w,U)=>(u(),b("div",{key:U},[n(h,{style:{width:"90%"}},{default:s(()=>[n(p,{size:"medium",style:{"margin-bottom":"-6px"},icon:t.iconsContent.calendar},null,8,["icon"]),a("span",null,[e[2]||(e[2]=m(" at ",-1)),a("span",Hs,y(w.age),1)]),a("span",Fs,y(t.vaccinesGivenCount(w))+"/"+y(w.antigens.length)+" vaccine(s) given",1)]),_:2},1024),n(h,{style:{"text-align":"center"},class:"mod-ls"},{default:s(()=>[n(g,{vaccines:w.antigens,milestone_status:w.milestone_status},null,8,["vaccines","milestone_status"])]),_:2},1024)]))),128))]),_:1}),n(T,{collapse:"fade",class:"ion-no-border"},{default:s(()=>[n(M,null,{default:s(()=>[n(V,null,{default:s(()=>[n(_,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e[0]||(e[0]=w=>t.dismiss())},{default:s(()=>e[3]||(e[3]=[m(" Cancel ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1})],64)}const Rs=F(Os,[["render",Es],["__scopeId","data-v-3ba5e9df"]]),Ws=P({name:"Menu",data(){return{isMobile:!1,visits:[],event:null,popoverOpen:!1,program:null}},mounted(){},computed:{...I(J,["patient"])},methods:{openPopover(t){this.event=t,this.popoverOpen=!0},openPIM(){A(rn,{class:"otherVitalsModal largeModal"})},openOutCome(){A(cn,{class:"otherVitalsModal largeModal"})},async printVisitSummary(){if(this.visits=await le.getPatientVisits(this.patient.patientID,!1),this.visits.length)return new Yt(this.patient.patientID).printVisitSummaryLbl(this.visits[0]);x("No visits available")},printID(){new Yt(this.patient.patientID).printNidLbl()},formatCurrentAddress(t){var i,l,c;return[(i=t==null?void 0:t.personInformation)==null?void 0:i.current_district,(l=t==null?void 0:t.personInformation)==null?void 0:l.current_traditional_authority,(c=t==null?void 0:t.personInformation)==null?void 0:c.current_village].filter(Boolean).join(",")}}}),Us=P({mixins:[Ws],name:"Home",components:{IonContent:j,IonHeader:z,IonMenuButton:Nt,IonPage:pt,IonTitle:G,IonToolbar:q,Toolbar:We,ToolbarSearch:Re,DemographicBar:xe,IonButton:tt,IonCard:Mt,IonCardContent:Bt,IonCardHeader:At,IonCardSubtitle:$t,IonCardTitle:It,IonAccordion:kt,IonAccordionGroup:Vt,IonItem:L,IonLabel:Y,IonModal:Ct,Stepper:Ke,DynamicButton:oe,WeightHeightChart:Xe,PreviousVitals:at,customSlider:Ts,IonRow:Q,customVaccine:gt},data(){return{wizardData:[],StepperData:[],isOpen:!1,iconsContent:N,current_milestone:"",checkUnderSixWeeks:!1,unprotected_at_birth:"",protectedStatus:"",todays_date:C.toStandardHisDisplayFormat(O.getSessionDate()),lastVaccine:[],visits:[],selectedStatus:7}},computed:{...I(je,["vitals"]),...I(ze,["selectedMedicalDrugsList","nonPharmalogicalTherapyAndOtherNotes","selectedMedicalAllergiesList"]),...I(Le,["outcomes"]),...I(D,["currentMilestone","missedVaccineSchedules","overDueVaccinesCount","lastVaccinesGiven","lastVaccineGievenDate","nextAppointMentDate"])},async mounted(){this.loadCurrentMilestone(),this.checkAge(),await this.checkProtectedStatus(),await this.openFollowModal(),await this.programEnrollment()},watch:{currentMilestone:{handler(){this.loadCurrentMilestone()}},$route:{async handler(t){t.name=="patientProfile"&&this.patient.patientID&&(await this.checkProtectedStatus(),await this.programEnrollment())}},patient:{async handler(){this.patient&&(await this.checkProtectedStatus(),await this.programEnrollment(),this.checkAge(),this.setMilestoneReload())}}},setup(){return{chevronBackOutline:Me,checkmark:wt,ellipsisVerticalSharp:Be,person:Ae}},methods:{handleChange(t){this.selectedStatus=t},async programEnrollment(){if(this.patient.patientID){this.program=new Ge(this.patient.patientID);const t=await this.program.getProgramCurrentStates();if(t)this.selectedStatus=t.state;else{try{await this.program.enrollProgram(),await this.program.setStateId(7)}catch(e){await this.program.setStateId(7)}await this.program.updateState(),this.selectedStatus=7}}},async updateState(t){this.selectedStatus=t,await this.program.setStateId(t),await this.program.updateState()},getAge(t){return C.calculateDisplayAge(C.toStandardHisFormat(t))},async checkProtectedStatus(){this.protectedStatus=this.getData(this.patient.birthRegistration,11759)[0]},getData(t,e){return t?t.filter(i=>i.concept_id==e).map(i=>i.value_text):""},checkAge(){var t,e,i,l;R.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=C.dateDiffInDays(C.sessionDate(),(l=(i=this.patient)==null?void 0:i.personInformation)==null?void 0:l.birthdate)<42)},openVitalsModal(){A(vn,{class:"otherVitalsModal"})},openWH(){A(gs,{class:"otherVitalsModal"})},openVH(){A(Zn,{class:"otherVitalsModal vaccineHistoryModal"})},async openFollowModal(){var t;if((t=this.patient)!=null&&t.patientID){this.lastVaccine=await Ue.getLastDrugsReceived(this.patient.patientID);const e={protectedStatus:this.protectedStatus,lastVaccinesGiven:this.lastVaccinesGiven};this.lastVaccinesGiven.length>0&&A(rs,{class:"fullScreenModal"},!0,e)}},openAdministerVaccineModal(){A(St,{class:"otherVitalsModal"})},openAdministerOtherVaccineModal(){A(me,{class:"otherVitalsModal"})},isChild(){return!!new le().isUnderFive()},getFormatedData(t){return t.map(e=>e==null?void 0:e.data)},async saveVitals(){if(this.vitals.validationStatus){const t=O.getUserID();new Dt(this.patient.patientID,t).onFinish(this.vitals)}},async saveTreatmentPlan(){const t=O.getUserID(),e=this.patient.patientID,i=new Ze;if(!R.isEmpty(this.selectedMedicalAllergiesList)){const l=this.mapToAllergies();i.onSubmitAllergies(e,t,l)}if(!R.isEmpty(this.nonPharmalogicalTherapyAndOtherNotes)){const l=[{concept_id:2688,obs_datetime:O.getSessionDate(),value_text:this.nonPharmalogicalTherapyAndOtherNotes}];i.onSubmitNotes(e,t,l)}if(!R.isEmpty(this.selectedMedicalDrugsList)){const l=this.mapToOrders(),c=new te(e,t);if(!await c.createEncounter())return x("Unable to create treatment encounter");if(!await c.createDrugOrder(l))return x("Unable to create drug orders!");ht("Drug order has been created")}},openModal(){A(qe)},mapToOrders(){return this.selectedMedicalDrugsList.map(t=>{const e=te.getSessionDate(),i=Qe.find(l=>l.label===t.frequency)||{};return{drug_inventory_id:t.drug_id,equivalent_daily_dose:t.dose=="Unknown"?0:t.dose*(i==null?void 0:i.value)||0,start_date:e,auto_expire_date:this.calculateExpireDate(e,t.duration),units:t.units,instructions:"".concat(t.drugName,": ").concat(t.dose," ").concat(t.units," ").concat((i==null?void 0:i.code)||""," for ").concat(t.duration," days"),dose:t.dose,frequency:(i==null?void 0:i.code)||""}})},formatBirthdate(){var t,e;return C.toStandardHisDisplayFormat((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},calculateExpireDate(t,e){const i=new Date(t);return i.setDate(i.getDate()+parseInt(e)),C.toStandardHisFormat(i)},mapToAllergies(){return this.selectedMedicalAllergiesList.map(t=>({concept_id:985,obs_datetime:O.getSessionDate(),value_coded:t.concept_id}))},loadCurrentMilestone(){const t=D();this.current_milestone=t.getCurrentMilestone()},showMissedVaccines(){this.missedVaccineSchedules.length>0&&A(Rs,{class:"otherVitalsModal vaccineHistoryModal"})},setMilestoneReload(){const t=D();t.setVaccineReload(!t.getVaccineReload())},getLastVaccinesGivenDisplayDate(){return C.toStandardHisDisplayFormat(this.lastVaccineGievenDate)}}}),Gs={fullscreen:!0,style:{"--background":"#fff"}},Ls={class:"demographics"},zs={style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},js={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},xs={style:{"margin-right":"5px"}},qs={class:"demographicsFirstRow"},Js={class:"name"},Ks={class:"demographicsOtherRow",style:{"margin-top":"10px"}},Zs={class:"demographicsText"},Qs={key:0,class:"demographicsOtherRow"},Xs={class:"demographicsText mediumFontColor"},Ys={key:1,class:"demographicsOtherRow"},ti={class:"demographicsText mediumFontColor"},ei={class:"demographicsOtherRow"},ni={class:"demographicsText smallFont"},si={class:"mediumFontColor"},ii={class:"demographicsOtherRow"},ai={key:0,class:"demographicsText smallFont"},oi={key:1,class:"demographicsText smallFont"},li={key:2,class:"demographicsText smallFont"},ri={class:"demographicsOtherRow",style:{"margin-bottom":"10px"}},ci={class:"demographicsText smallFont"},di={key:0,style:{background:"#fedf89",color:"#b54708"},class:"protectedStatus"},ui={key:1,style:{background:"#ddeedd"},class:"protectedStatus"},pi={key:2,class:"protectedStatus",style:{background:"#fecdca",color:"#b42318"}},mi={class:"graphSection"},hi={class:"graphBtn",style:{"margin-bottom":"5px"}},_i={class:"weightHeightGraphBtns"},gi={key:0},fi={key:1},vi={key:0,class:"graphBtn"},bi={class:"dueAlert"},yi={class:"missed_vaccine_alert"},Di={style:{"margin-right":"5px"}},Si={class:"vaccinesTitle"},wi={style:{width:"100%",display:"flex","justify-content":"space-between","align-content":"center"}},Ci={class:"vaccinesTitleDate"},Vi={class:"milestone"},ki={style:{display:"flex","justify-content":"space-between","align-content":"center"}},Ii={style:{color:"#636363","margin-left":"5px","margin-top":"-4px"}},$i={style:{color:"#636363","font-weight":"bold","font-size":"14px"}},Ai={class:"lastVaccine"},Bi={class:"lastVaccineTitle"},Mi={key:0,class:"lastVaccineText"},Ni={class:"seeFullList"},Pi={style:{color:"#316cba","margin-left":"1%"}},Ti={class:"ion-padding",slot:"content"};function Oi(t,e,i,l,c,v){var Tt,Ot,Ht,Ft,Et,Rt,Wt,Ut,Gt,Lt,zt,jt,xt,qt,Jt,Kt,Zt,Qt;const r=o("ion-icon"),d=o("WeightHeightChart"),p=o("PreviousVitals"),h=o("ion-button"),g=o("ion-col"),f=o("ion-row"),_=o("customSlider"),V=o("row"),M=o("customVaccine"),T=o("ion-label"),w=o("ion-item"),U=o("ion-accordion"),nt=o("ion-toggle"),ft=o("ion-list"),he=o("ion-accordion-group"),_e=o("ion-popover");return u(),b(H,null,[a("div",Gs,[a("div",Ls,[a("div",zs,[a("div",js,[a("div",xs,[a("div",{class:Ne(((Ot=(Tt=t.patient)==null?void 0:Tt.personInformation)==null?void 0:Ot.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor")},[n(r,{style:{color:"#fff","font-size":"100px"},icon:t.person},null,8,["icon"])],2)]),a("div",null,[a("div",qs,[a("div",Js,y((Ft=(Ht=t.patient)==null?void 0:Ht.personInformation)==null?void 0:Ft.given_name)+" "+y((Rt=(Et=t.patient)==null?void 0:Et.personInformation)==null?void 0:Rt.middle_name)+" "+y((Ut=(Wt=t.patient)==null?void 0:Wt.personInformation)==null?void 0:Ut.family_name),1)]),a("div",Ks,[a("div",Zs,[m(y(((Lt=(Gt=t.patient)==null?void 0:Gt.personInformation)==null?void 0:Lt.gender)=="M"?"Male":"Female")+" ",1),e[12]||(e[12]=a("span",{class:"dot"},".",-1)),m(" "+y(t.getAge((jt=(zt=t.patient)==null?void 0:zt.personInformation)==null?void 0:jt.birthdate))+" ("+y(t.formatBirthdate())+") ",1)])]),(qt=(xt=t.patient)==null?void 0:xt.personInformation)!=null&&qt.current_district?(u(),b("div",Qs,[e[13]||(e[13]=a("div",{class:"demographicsText"},"Current Address:",-1)),a("div",Xs,y(t.formatCurrentAddress(t.patient)),1)])):S("",!0),(Kt=(Jt=t.patient)==null?void 0:Jt.personInformation)!=null&&Kt.country?(u(),b("div",Ys,[e[14]||(e[14]=a("div",{class:"demographicsText"},"Country:",-1)),a("div",ti,y((Qt=(Zt=t.patient)==null?void 0:Zt.personInformation)==null?void 0:Qt.country),1)])):S("",!0),a("div",ei,[a("div",ni,[e[15]||(e[15]=m(" MRN: ",-1)),a("span",si,y(t.patient.ID),1)])]),a("div",ii,[t.selectedStatus==7?(u(),b("div",ai,e[16]||(e[16]=[m(" Outcome: ",-1),a("span",{class:"outcomeStatus"}," Active",-1)]))):S("",!0),t.selectedStatus==6?(u(),b("div",oi,e[17]||(e[17]=[m(" Outcome: ",-1),a("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Inactive",-1)]))):S("",!0),t.selectedStatus==3?(u(),b("div",li,e[18]||(e[18]=[m(" Outcome: ",-1),a("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Died",-1)]))):S("",!0)]),a("div",ri,[a("div",ci,[e[19]||(e[19]=m(" Status: ",-1)),t.protectedStatus=="No"?(u(),b("span",di,"Unprotected at birth")):t.protectedStatus=="Yes"?(u(),b("span",ui,"Protected at birth")):(u(),b("span",pi,"Unknown protection at birth"))])])])])]),a("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:e[0]||(e[0]=E=>t.openPopover(E))},[n(r,{icon:t.ellipsisVerticalSharp},null,8,["icon"])])]),a("div",mi,[a("div",null,[t.isChild()?(u(),$(d,{key:0,checkUnderSixWeeks:t.checkUnderSixWeeks,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):S("",!0),t.isChild()?S("",!0):(u(),$(p,{key:1}))]),a("div",hi,[a("div",_i,[a("div",null,[n(h,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=E=>t.openWH())},{default:s(()=>[t.checkUnderSixWeeks?(u(),b("span",fi," Enter Weight")):(u(),b("span",gi," Enter Weight/Height")),n(r,{slot:"end",size:"small",icon:t.iconsContent.whiteHeightWeight},null,8,["icon"])]),_:1})]),a("div",null,[n(h,{class:"btnText",fill:"solid",onClick:e[2]||(e[2]=E=>t.openVitalsModal())},{default:s(()=>[e[20]||(e[20]=m(" Enter Other Vitals ",-1)),n(r,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[20]})])])])]),a("div",null,[t.overDueVaccinesCount>0?(u(),b("div",vi,[a("div",bi,[n(f,null,{default:s(()=>[t.overDueVaccinesCount>0?(u(),$(g,{key:0,style:{display:"flex","justify-content":"center",cursor:"pointer"},onClick:t.showMissedVaccines},{default:s(()=>[a("div",yi,[n(r,{slot:"start",icon:t.iconsContent.alertDangerRed},null,8,["icon"]),a("span",Di,y(t.overDueVaccinesCount)+" vaccine(s) overdue",1)])]),_:1},8,["onClick"])):S("",!0)]),_:1})])])):S("",!0),a("div",Si,[a("div",wi,[e[22]||(e[22]=a("div",{class:"vaccinesTitleText"},"Administer Vaccines",-1)),a("div",Ci,[e[21]||(e[21]=a("span",{style:{"font-size":"13px"}},"Next Appt. Date: ",-1)),a("b",null,y(t.nextAppointMentDate),1)])])]),a("div",Vi,[a("div",ki,[n(r,{size:"small",icon:t.iconsContent.greenCalender},null,8,["icon"]),a("div",Ii,[e[23]||(e[23]=m(" at ",-1)),a("span",$i,y(t.current_milestone),1)])]),e[24]||(e[24]=a("div",{class:"vaccinesTitleDate"},"(Swipe left or right for other milestones)",-1))]),n(_),a("div",Ai,[a("div",Bi,[t.lastVaccinesGiven.length>0?(u(),b("div",Mi,"Last vaccines given")):S("",!0),a("div",Ni,[n(h,{onClick:e[3]||(e[3]=E=>t.openVH()),style:{color:"#016302"},class:"btnText btnTextWeight",size:"small",fill:"clear"},{default:s(()=>e[25]||(e[25]=[a("span",null,"See full History",-1)])),_:1,__:[25]})])]),t.lastVaccinesGiven.length>0?(u(),$(V,{key:0},{default:s(()=>[n(r,{size:"medium",style:{"margin-bottom":"-6px"},icon:t.iconsContent.calendar},null,8,["icon"]),a("span",Pi,y(t.getLastVaccinesGivenDisplayDate()),1)]),_:1})):S("",!0),t.lastVaccinesGiven.length>0?(u(),$(V,{key:1},{default:s(()=>[n(M,{vaccines:t.lastVaccinesGiven,milestone_status:""},null,8,["vaccines"])]),_:1})):S("",!0)])])]),n(_e,{style:{"--offset-x":"-10px"},"is-open":t.popoverOpen,"show-backdrop":!1,event:t.event,onDidDismiss:e[11]||(e[11]=E=>t.popoverOpen=!1)},{default:s(()=>[a("div",null,[n(he,{multiple:!0},{default:s(()=>[n(U,{value:"first","toggle-icon":"",onClick:e[4]||(e[4]=E=>t.openPIM())},{default:s(()=>[n(w,{slot:"header",color:"light"},{default:s(()=>[n(T,null,{default:s(()=>e[26]||(e[26]=[m("Update demographics",-1)])),_:1,__:[26]})]),_:1})]),_:1}),n(U,{value:"first","toggle-icon":"",onClick:e[5]||(e[5]=E=>t.openFollowModal())},{default:s(()=>[n(w,{slot:"header",color:"light"},{default:s(()=>[n(T,null,{default:s(()=>e[27]||(e[27]=[m("Follow up visits",-1)])),_:1,__:[27]})]),_:1})]),_:1}),n(U,{value:"second","toggle-icon":"",onClick:e[6]||(e[6]=E=>t.printVisitSummary())},{default:s(()=>[n(w,{slot:"header",color:"light"},{default:s(()=>[n(T,null,{default:s(()=>e[28]||(e[28]=[m("Print visit summary",-1)])),_:1,__:[28]})]),_:1})]),_:1}),n(U,{value:"third","toggle-icon":"",onClick:e[7]||(e[7]=E=>t.printID())},{default:s(()=>[n(w,{slot:"header",color:"light"},{default:s(()=>[n(T,null,{default:s(()=>e[29]||(e[29]=[m("Print client identifier",-1)])),_:1,__:[29]})]),_:1})]),_:1}),n(U,{value:"fourth"},{default:s(()=>[n(w,{slot:"header",color:"light"},{default:s(()=>[n(T,null,{default:s(()=>e[30]||(e[30]=[m("Update outcome",-1)])),_:1,__:[30]})]),_:1}),a("div",Ti,[n(ft,null,{default:s(()=>[n(w,null,{default:s(()=>[n(nt,{checked:t.selectedStatus==7,value:"active",onIonChange:e[8]||(e[8]=E=>t.updateState(7))},{default:s(()=>e[31]||(e[31]=[m(" Active ",-1)])),_:1,__:[31]},8,["checked"])]),_:1}),n(w,null,{default:s(()=>[n(nt,{checked:t.selectedStatus==6,value:"inactive",onIonChange:e[9]||(e[9]=E=>t.updateState(6))},{default:s(()=>e[32]||(e[32]=[m(" Inactive ",-1)])),_:1,__:[32]},8,["checked"])]),_:1}),n(w,null,{default:s(()=>[n(nt,{checked:t.selectedStatus==3,value:"died",onIonChange:e[10]||(e[10]=E=>t.updateState(3))},{default:s(()=>e[33]||(e[33]=[m(" Died ",-1)])),_:1,__:[33]},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])],64)}const Va=F(Us,[["render",Oi],["__scopeId","data-v-029f1008"]]);export{Va as default};
