System.register(["./vendor-legacy-PwJwfeg2.js","./index-legacy-CAqY44sk.js","./patient_registration_service-legacy-DmWS8kKb.js","./relationship_service-legacy-4WXlzkf5.js","./relations_service-legacy-CPBw0Zvw.js","./FollowUpStore-legacy-uH3ggR1v.js","./BirthRegistration-legacy-DOsypJ57.js","./Stepper-legacy-B3ZFGjmf.js","./lodash-legacy-C-x9g9Na.js"],(function(e,t){"use strict";var a,n,i,o,l,r,s,d,u,c,p,m,v,g,f,h,b,_,y,w,x,D,I,k,P,C,N,S,L,O,T,B,z,j,H,G,M,R,V,E,$,A,F,U,q,W,K,Q,X,Z,J,Y,ee,te,ae,ne,ie,oe,le,re,se,de,ue,ce,pe,me,ve,ge,fe,he,be,_e,ye,we,xe,De,Ie,ke,Pe,Ce,Ne,Se,Le,Oe,Te,Be,ze,je,He,Ge,Me,Re,Ve,Ee,$e,Ae,Fe;return{setters:[e=>{a=e.d,n=e.aa,i=e.bm,o=e.b_,l=e.V,r=e.cs,s=e.cr,d=e.bs,u=e.b6,c=e.D,p=e.aL,m=e.aM,v=e.b7,g=e.I,f=e.U,h=e.T,b=e.b8,_=e.b9,y=e.ba,w=e.S,x=e.ad,D=e.X,I=e.aB,k=e.cj,P=e.dw,C=e.bk,N=e.dK,S=e.E,L=e.e,O=e.f,T=e.l,B=e.z,z=e.A,j=e.k,H=e.F,G=e.r,M=e.u,R=e.b3,V=e.W,E=e.b5,$=e.ae,A=e.aT,F=e.c,U=e.a,q=e.w,W=e.a8,K=e.ac,Q=e.m,X=e.G,Z=e.B,J=e.ak,Y=e.bt,ee=e.aK,te=e.at,ae=e.bp,ne=e.aG,ie=e.L,oe=e.dL,le=e.a$},e=>{re=e.B,se=e.D,de=e.e,ue=e.w,ce=e.z,pe=e.P,me=e.u,ve=e.aC,ge=e.y,fe=e.aa,he=e.L,be=e.k,_e=e.t,ye=e.an,we=e._,xe=e.a3,De=e.a1,Ie=e.Z,ke=e.a4,Pe=e.ah,Ce=e.ai,Ne=e.aj,Se=e.S,Le=e.ak,Oe=e.al,Te=e.g},e=>{Be=e.P},e=>{ze=e.R},e=>{je=e.R},e=>{He=e.u},e=>{Ge=e.B,Me=e.S,Re=e.H,Ve=e.C,Ee=e.G,$e=e.P},e=>{Ae=e.O},e=>{Fe=e.l}],execute:function(){var t=document.createElement("style");t.textContent=".custom-dropdown .vs__selected-options[data-v-a10cb2a3],.custom-dropdown .vs__dropdown-option[data-v-a10cb2a3]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.custom-dropdown .vs__dropdown-menu[data-v-a10cb2a3]{max-height:150px;overflow-y:auto;background-color:red}.PI-cls-1[data-v-a10cb2a3]{cursor:pointer}.lbl-tl[data-v-a10cb2a3]{min-width:20px;color:#b3b3b3!important;white-space:nowrap}.form-row[data-v-a10cb2a3]{display:flex;align-items:center}.lbl-ct[data-v-a10cb2a3]{white-space:nowrap;color:#636363;flex:1}pim-cls-1[data-v-a10cb2a3]{--background: #ffff}.custom-toolbar-cls[data-v-a10cb2a3]{--background: #ffff}ion-footer[data-v-a10cb2a3]{--ion-toolbar-background: #fff}ion-modal[data-v-a10cb2a3]{--width: 94%;--height: 70%;--border-radius: 10px}.dashed-hr[data-v-a10cb2a3]{border:none;border-top:1px dashed #b3b3b3;margin:20px 0}.modal_wrapper[data-v-a10cb2a3]{padding:0 1px;background:#fff}.PI-cls-1[data-v-a10cb2a3]{color:rgba(31,34,33,.83)}.OtherVitalsTitle[data-v-a10cb2a3]{font-style:normal;font-weight:600;font-size:20px;color:#00190e}.OtherVitalsHeading[data-v-a10cb2a3]{display:flex;justify-content:center;margin:10px}ion-accordion[data-v-a10cb2a3]{margin-bottom:15px}ion-card[data-v-d3b9b80f]{margin:16px 0;border-radius:12px}.sub-menu-icon[data-v-d3b9b80f]{font-size:1.2rem}ion-item[data-v-d3b9b80f]{--padding-start: 8px;margin:8px 0}.current-ncd-item[data-v-d3b9b80f]{--background: var(--ion-color-success-tint);border-radius:8px;margin:8px 0;border-left:4px solid var(--ion-color-primary)}.current-ncd-item ion-label h2[data-v-d3b9b80f]{font-weight:600;color:var(--ion-color-primary)}.current-ncd-item ion-label p[data-v-d3b9b80f]{font-size:1.1em;margin-top:4px;color:var(--ion-color-dark)}.custom-input[data-v-d3b9b80f]{--padding-start: 0;font-size:1.5em}.prefix-container[data-v-d3b9b80f]{display:flex;align-items:center;height:100%}.prefix-part[data-v-d3b9b80f]{border:none;background:#f0f0f0;padding:0 8px;border-right:1px solid #ccc;color:var(--ion-color-dark);font-weight:600}.error-message[data-v-d3b9b80f]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;margin-top:8px;background-color:rgba(255,0,0,.1);border-radius:4px}.error-content[data-v-d3b9b80f]{display:flex;align-items:center;gap:8px}.close-button[data-v-d3b9b80f]{margin-left:auto}#container[data-v-777d67d0]{font-family:monospace;font-size:24px;overflow:hidden;padding:15px;width:594px}ul[data-v-777d67d0],ol[data-v-777d67d0]{list-style-type:none;padding-left:0;margin:0}\n/*$vite$:1*/",document.head.appendChild(t),e("u",(function(){const e=G(le.isNativePlatform()),t=G([]),a=G(null),n=G(!1),i=G(null),o=me().patient;return{isMobile:e,visits:t,event:a,popoverOpen:n,program:i,patient:o,openPopover:e=>{a.value=e,n.value=!0},openPIM:()=>{Te(Je,{class:"otherVitalsModal largeModal"})},openOutCome:()=>{Te(it,{class:"large-modal-x10"})},printVisitSummary:async()=>{32==Se.getProgramID()?await async function(){await async function(e,t){console.log("ðŸš€ ~ printLabel ~ labelComponent:",e);const a=await async function(){const e=new ke;let t=await e.getDefaultPrinter();if(Fe.isEmpty(t)&&(t=await e.selectDefaultPrinter()),Fe.isEmpty(t))throw new Error("No printer device found");return t}();return/zebra/i.test(a.name)||/Browser/i.test(a.address)||"BT"===a.port?async function(e,t){const a=Pe.updateUrlParamString(t,{raw:!0});Ce.emit(Ne.SHOW_MODAL,"zebra-modal"),console.time(t);const n=await Se.getText(a);if(!n)throw"Unable to print Label. Try again later";if("BT"===(null==e?void 0:e.port))return(new ke).printToBluetoothDevice(e,n);ne.printLabel({eplCommands:n,name:e.name,address:e.address,url:await Le.expandPath(a)}),console.timeEnd(t),await Oe(2e3)}(a,t.lblUrl):await async function(e,t,a){if(!It.value){It.value=!0;try{const n=await async function(e){const t=e.visits.visitsDates.map((e=>new Date(e))),a=new Date(Math.max(...t)),n=a.toISOString().split("T")[0],i=`${e.personInformation.given_name} ${e.personInformation.family_name}`,o=[...e.vitals.saved||[],...e.vitals.unsaved||[]],l=[...e.diagnosis.saved||[],...e.diagnosis.unsaved||[]],r=[...e.MedicationOrder.saved||[],...e.MedicationOrder.unsaved||[]],s=[...e.labOrders.saved||[],...e.labOrders.unsaved||[]],d=o.filter((e=>new Date(e.obs_datetime).toDateString()===a.toDateString())),u=l.filter((e=>new Date(e.obs_datetime).toDateString()===a.toDateString())),c=r.filter((e=>new Date(e.encounter_date).toDateString()===a.toDateString())),p=s.filter((e=>new Date(e.order_date).toDateString()===a.toDateString())),m=p.length>0?p[0].requesting_clinician:void 0,v=e.appointments.saved.length>0?e.appointments.saved[0].value:void 0,g=await Promise.all(u.map((async e=>await Ie.getConceptName(e.value_coded)))),f=o.filter((e=>"Height (cm)"===e.concept_name)).sort(((e,t)=>new Date(t.obs_datetime).getTime()-new Date(e.obs_datetime).getTime()))[0],h=(e,t)=>{const a=d.find((t=>t.concept_name==e));return void 0!==(null==a?void 0:a.value_numeric)?`${a.value_numeric}${t}`:void 0},b=()=>{const t=(new pe).getBloodGlucose(e);if(t)return t.name+":"+t.value+t.unit};return{patientID:e.NcdID,patientName:i,latestVisitDate:n,gender:e.personInformation.gender,vitals:{height:"Ht:"+(null==f?void 0:f.value_numeric)+"cm",weight:"Wt"+h("Weight (kg)","kg"),bloodPressure:"Bp"+h("Systolic blood pressure","")+"/"+h("Diastolic blood pressure","")+"mmHg"},bloodGlucose:b(),diagnoses:g.length>0?g:void 0,medications:c.length>0?c.map((e=>({name:e.drug_name,dose:e.dose?`${e.dose} ${e.units||""}`.trim():void 0,frequency:e.frequency,quantity:e.equivalent_daily_dose,duration:e.expire_date&&e.start_date?Math.ceil((Number(new Date(e.expire_date))-Number(new Date(e.start_date)))/864e5):void 0}))):void 0,labOrders:p.length>0?p.map((e=>({test:e.tests&&e.tests.length>0?e.tests[0].name:void 0,orderDate:e.order_date?new Date(e.order_date).toISOString().split("T")[0]:void 0,accessionNumber:e.accession_number}))):void 0,prescriber:m,nextAppointment:v}}(me().patient),i=await D.create({id:"printout",component:t,backdropDismiss:!1,cssClass:"visit-modal",componentProps:{patient:n,imageOut:async t=>{var n;console.log("ðŸš€ ~ imageOut: ~ images:",t);const o=null!==(n=a.copies)&&void 0!==n?n:1;for(let a=0;a<o;++a){const a=t.map((t=>{console.log("ðŸš€ ~ res ~ image:",t),ne.printLabel({address:e.address,name:e.name,height:302,width:582,image:t})}));await Promise.all(a)}setTimeout((()=>D.getTop().then((e=>e&&i.dismiss()))),1e3),It.value=!1}}});await i.present()}catch(n){console.error(n),It.value=!1,D.getTop().then((e=>e?D.dismiss():null)),_e("An error occurred while generating label")}}}(a,e,t)}(Et,{copies:1})}():(new ke).printData("visit")},printID:()=>{(new ke).printData("barcode")},formatCurrentAddress:e=>{var t,a,n;return[null==e||null===(t=e.personInformation)||void 0===t?void 0:t.current_district,null==e||null===(a=e.personInformation)||void 0===a?void 0:a.current_traditional_authority,null==e||null===(n=e.personInformation)||void 0===n?void 0:n.current_village].filter(Boolean).join(",")},openUpdateNCDNUmbers:()=>{Te(Dt,{class:"large-modal-x10"})}}}));const Ue=a({name:"Home",username:"",components:{IonContent:x,IonHeader:w,IonMenuButton:y,IonSearchbar:_,IonPage:b,IonTitle:h,IonToolbar:f,ToolbarSearch:ce,IonIcon:g,IonPopover:v,IonRow:m,IonCol:p,IonLabel:c,IonInput:u,IonDatetime:d,IonSelect:s,IonSelectOption:r,IonFooter:l,DynamicButton:ue,BasicInputField:de,vSelect:o,VueMultiselect:i,DateInputField:se,BasicForm:re,PersonalInformation:$e,GuardianInformation:Ee,CurrentLocation:Ve,HomeLocation:Re,SocialHistory:Me,BirthRegistration:Ge},data:()=>({popoverOpen:!1}),computed:{...n(He,["changeGuardianInfo","vaccineAdverseEffects","protectedAtBirth"]),...n(me,["patient"]),...n(ye,["personInformation","socialHistory","homeLocation","currentLocation","guardianInformation"])},watch:{patient:{handler(){},immediate:!0}},setup:()=>({notificationsOutline:N,personCircleOutline:C,createOutline:P,clipboardOutline:k,calendarOutline:I}),methods:{handleCancel(){D.dismiss()},async saveDetails(){try{await this.updateDemographics(),await this.updateGuardian(),await this.updatePatientDemographics(),be("Successfully Updated Patient"),this.handleCancel()}catch(e){_e("Failed to save details")}},async getRegion(e){let t=[];for(let a of[1,2,3]){if((a=1)&&(t=await he.getDistricts(a)),t.some((t=>t.name.trim()===e)))return"Central Region";if((a=2)&&(t=await he.getDistricts(a)),t.some((t=>t.name.trim()===e)))return"Northern Region";if((a=3)&&(t=await he.getDistricts(a)),t.some((t=>t.name.trim()===e)))return"Southern Region";if((a=4)&&(t=await he.getDistricts(a)),t.some((t=>t.name.trim()===e)))return"Foreign"}},async updateDemographics(){var e,t,a,n,i,o,l,r,s,d;const u={person_id:this.patient.patientID,given_name:ge(this.personInformation,"firstname","value"),family_name:ge(this.personInformation,"lastname","value"),middle_name:ge(this.personInformation,"middleName","value"),gender:fe(this.personInformation,"gender"),birthdate:ge(this.personInformation,"birthdate","value"),cell_phone_number:ge(this.personInformation,"phoneNumber","value"),birthdate_estimated:!1,home_region:await this.getRegion(null===(e=ge(this.homeLocation,"home_district","value"))||void 0===e?void 0:e.name),home_district:null===(t=ge(this.homeLocation,"home_district","value"))||void 0===t?void 0:t.name,home_traditional_authority:null===(a=ge(this.homeLocation,"home_traditional_authority","value"))||void 0===a?void 0:a.name,home_village:null===(n=ge(this.homeLocation,"home_village","value"))||void 0===n?void 0:n.name,current_region:await this.getRegion(null===(i=ge(this.currentLocation,"current_district","value"))||void 0===i?void 0:i.name),current_district:null===(o=ge(this.currentLocation,"current_district","value"))||void 0===o?void 0:o.name,current_traditional_authority:null===(l=ge(this.currentLocation,"current_traditional_authority","value"))||void 0===l?void 0:l.name,current_village:null===(r=ge(this.currentLocation,"current_village","value"))||void 0===r?void 0:r.name,landmark:null===(s=ge(this.currentLocation,"current_village","value"))||void 0===s?void 0:s.name,occupation:fe(this.socialHistory,"occupation"),religion:null===(d=ge(this.socialHistory,"religion","value"))||void 0===d?void 0:d.name,marital_status:fe(this.socialHistory,"maritalStatus"),education_level:fe(this.socialHistory,"highestLevelOfEducation"),facility_name:"",patient_type:""};await this.updatePerson(this.patient.patientID,u)},async updateGuardian(){var e;let t={given_name:ge(this.guardianInformation,"guardianFirstname","value"),family_name:ge(this.guardianInformation,"guardianLastname","value"),middle_name:ge(this.guardianInformation,"guardianMiddleName","value"),cell_phone_number:ge(this.guardianInformation,"guardianPhoneNumber","value"),gender:"",birthdate:"",birthdate_estimated:!1,home_district:"",home_traditional_authority:"",home_village:"",current_district:"",current_traditional_authority:"",current_village:"",landmark:"",occupation:"",religion:"",marital_status:"",education_level:"",facility_name:"",patient_type:"",national_id:""},a=await ze.getRelationships(this.patient.patientID);const n=null===(e=ge(this.guardianInformation,"relationship","value"))||void 0===e?void 0:e.id;if(n)if(a.length>0){var i;const e=await ze.getRelationships(this.patient.patientID);await je.amendRelation(this.patient.patientID,a[0].person_b,a[0].relationship_id,n),await this.updatePerson(null===(i=e[0])||void 0===i?void 0:i.person_b,t)}else{const e=new Be;await e.registerGuardian(t);const a=e.getPersonID();await je.createRelation(this.patient.patientID,a,n)}},async updatePerson(e,t){const a=new ve(t);await a.update(e)},async updatePatientDemographics(){const e=await pe.findByID(this.patient.patientID);me().setPatientRecord(e)},patientIdentifier(e){const t=e.patient_identifiers.length-1;return t>=0?e.patient_identifiers[t].identifier:""}}}),qe={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},We={class:"ion-padding",slot:"content",style:{"padding-bottom":"200px"}},Ke={class:""},Qe={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},Xe={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},Ze={class:"ion-padding",slot:"content",style:{"padding-bottom":"120px"}},Je=e("p",we(Ue,[["render",function(e,t,a,n,i,o){const l=S("ion-title"),r=S("ion-header"),s=S("ion-label"),d=S("ion-item"),u=S("PersonalInformation"),c=S("ion-accordion"),p=S("GuardianInformation"),m=S("SocialHistory"),v=S("CurrentLocation"),g=S("HomeLocation"),f=S("ion-accordion-group"),h=S("ion-content"),b=S("ion-button"),_=S("ion-col"),y=S("DynamicButton"),w=S("ion-row"),x=S("ion-footer");return O(),L(H,null,[T(r,null,{default:B((()=>[T(l,{class:"modalTitle"},{default:B((()=>t[1]||(t[1]=[z("Edit Patient Demographics")]))),_:1,__:[1]})])),_:1}),T(h,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:B((()=>[T(f,{ref:"accordionGroup",class:"previousView"},{default:B((()=>[T(c,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:B((()=>[T(d,{slot:"header",color:"light"},{default:B((()=>[T(s,{class:"previousLabel"},{default:B((()=>t[2]||(t[2]=[z("Personal information")]))),_:1,__:[2]})])),_:1}),j("div",qe,[T(u,{editable:!0})])])),_:1}),T(c,{value:"second","toggle-icon-slot":"start",class:"custom_card"},{default:B((()=>[T(d,{slot:"header",color:"light"},{default:B((()=>[T(s,{class:"previousLabel"},{default:B((()=>t[3]||(t[3]=[z("Guardian")]))),_:1,__:[3]})])),_:1}),j("div",We,[j("div",Ke,[T(p,{editable:!0})])])])),_:1}),T(c,{value:"third","toggle-icon-slot":"start",class:"custom_card"},{default:B((()=>[T(d,{slot:"header",color:"light"},{default:B((()=>[T(s,{class:"previousLabel"},{default:B((()=>t[4]||(t[4]=[z("Social history")]))),_:1,__:[4]})])),_:1}),j("div",Qe,[T(m,{editable:!0})])])),_:1}),T(c,{value:"four","toggle-icon-slot":"start",class:"custom_card"},{default:B((()=>[T(d,{slot:"header",color:"light"},{default:B((()=>[T(s,{class:"previousLabel"},{default:B((()=>t[5]||(t[5]=[z("Current location")]))),_:1,__:[5]})])),_:1}),j("div",Xe,[T(v,{editable:!0})])])),_:1}),T(c,{value:"five","toggle-icon-slot":"start",class:"custom_card"},{default:B((()=>[T(d,{slot:"header",color:"light"},{default:B((()=>[T(s,{class:"previousLabel"},{default:B((()=>t[6]||(t[6]=[z("Home location")]))),_:1,__:[6]})])),_:1}),j("div",Ze,[T(g,{editable:!0})])])),_:1})])),_:1},512),t[7]||(t[7]=j("hr",{class:"dashed-hr",style:{"margin-bottom":"0px !important"}},null,-1))])),_:1,__:[7]}),T(x,{collapse:"fade",class:"ion-no-border"},{default:B((()=>[T(w,null,{default:B((()=>[T(_,null,{default:B((()=>[T(b,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e.handleCancel},{default:B((()=>t[8]||(t[8]=[z(" Cancel ")]))),_:1,__:[8]},8,["onClick"])])),_:1}),T(_,null,{default:B((()=>[T(y,{onClick:t[0]||(t[0]=t=>e.saveDetails()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})])),_:1})])),_:1})])),_:1})],64)}],["__scopeId","data-v-a10cb2a3"]])),Ye={style:{"font-weight":"400","font-size":"19px"}},et={style:{display:"flex","align-items":"center"}},tt={class:""},at={class:"center text_12"},nt=a({watch:{},name:"xxxComponent"}),it=a({...nt,props:{is_open:{},user_id:{}},emits:["closePopoover","save"],setup(e,{emit:t}){G("");const a=t;return(e,t)=>(O(),L(H,null,[T(M(w),null,{default:B((()=>[T(M(f),null,{default:B((()=>[T(M(h),null,{default:B((()=>t[1]||(t[1]=[j("div",{style:{display:"flex","align-items":"center"}},[j("b",{style:{"margin-left":"6px"}},"Patient Outcome")],-1)]))),_:1,__:[1]}),T(M(R),{slot:"end"},{default:B((()=>[T(M(h),null,{default:B((()=>[T(M(V),{onClick:t[0]||(t[0]=e=>(a("closePopoover",!1),void D.dismiss())),fill:"solid"},{default:B((()=>[j("span",Ye,[j("div",et,[T(M(g),{icon:M(E),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[2]||(t[2]=j("span",{style:{"margin-left":"6px"}},"Close",-1))])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),T(M(x),{class:"ion-padding"},{default:B((()=>[j("div",tt,[j("div",at,[T(M(m),null,{default:B((()=>[T(M(p),null,{default:B((()=>[T(Ae)])),_:1})])),_:1})])])])),_:1}),T(M(l),null,{default:B((()=>[T(M(f))])),_:1})],64))}}),ot={style:{display:"flex","align-items":"center"}},lt={style:{"font-weight":"400","font-size":"19px"}},rt={style:{display:"flex","align-items":"center"}},st={style:{"font-weight":"600","font-size":"17px"}},dt={style:{"margin-top":"15px",width:"100%"}},ut={key:0,class:"error-message"},ct={key:1},pt={slot:"start",class:"prefix-container"},mt=["value"],vt={key:0,class:"error-message"},gt={style:{"font-size":"16px","font-weight":"600px",color:"red"}},ft={key:1},ht={style:{"font-weight":"400","font-size":"19px"}},bt={style:{display:"flex","align-items":"center"}},_t={style:{"font-weight":"400","font-size":"20px"}},yt={style:{display:"flex","align-items":"center"}},wt=a({name:"UpdateNCDNumberModal"}),xt=a({...wt,emits:["closePopoover","save"],setup(e,{emit:t}){const a=$(),n=me(),{patient:i}=A(n),o=G(""),r=G(""),s=G(""),d=G(!1),p=new pe;let m=null;const v=e=>{const t=e.target.value.replace(/[^0-9]/g,"");t!==e.target.value&&(d.value=!0,m&&clearTimeout(m),m=window.setTimeout((()=>{d.value=!1,m=null}),3e3),o.value=t)},b=()=>{d.value=!1,m&&(clearTimeout(m),m=null)},_=F((()=>o.value&&""!==o.value.trim())),y=async()=>{try{const e=await xe.getNextSuggestedNCDNumber(),t=e.ncd_number.replace(/^\D+|\s/g,""),a=e.ncd_number.replace(/\d+/g,"")+"-NCD-";o.value=t,r.value=a}catch(e){console.error("Error fetching suggested NCD number:",e),s.value="Failed to fetch suggested NCD number (missing SITE Prefix)"}};U((()=>{y()})),q((()=>i.value.ID),(()=>{y()}),{deep:!0});const I=t;function k(){I("closePopoover",!1),D.dismiss()}async function P(){try{if(s.value="",!_.value)return void(s.value="Please enter a valid NCD number");const e=`${r.value}${o.value}`,t=await pe.findByID(i.value.patientID);for(const a of t.patient_identifiers)31===a.identifier_type&&(await p.updateNCDNumber(a.patient_identifier_id,e),I("save",{newNcdId:e}));await De(i.value),k()}catch(e){console.error(e)}}return(e,t)=>(O(),L(H,null,[T(M(w),null,{default:B((()=>[T(M(f),null,{default:B((()=>[T(M(h),null,{default:B((()=>[j("div",ot,[T(M(g),{icon:M(W),class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),t[3]||(t[3]=j("b",{style:{"margin-left":"6px"}},"Update NCD Number",-1))])])),_:1}),T(M(R),{slot:"end"},{default:B((()=>[T(M(h),null,{default:B((()=>[T(M(V),{onClick:t[0]||(t[0]=e=>k()),fill:"solid"},{default:B((()=>[j("span",lt,[j("div",rt,[T(M(g),{icon:M(E),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[4]||(t[4]=j("span",{style:{"margin-left":"6px"}},"Close",-1))])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),T(M(x),{class:"ion-padding"},{default:B((()=>[T(M(K),null,{default:B((()=>[T(M(X),{class:"current-ncd-item"},{default:B((()=>[T(M(c),null,{default:B((()=>[t[5]||(t[5]=j("h2",null,"Current NCD Number",-1)),j("p",st,Z(M(i).NcdID||"Not assigned"),1)])),_:1,__:[5]})])),_:1}),T(M(X),null,{default:B((()=>[j("div",dt,[d.value?(O(),L("div",ut,[T(M(g),{icon:M(J),color:"danger"},null,8,["icon"]),t[6]||(t[6]=j("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),T(M(V),{fill:"clear",size:"small",onClick:b},{default:B((()=>[T(M(g),{icon:M(Y)},null,8,["icon"])])),_:1})])):Q("",!0),s.value?Q("",!0):(O(),L("div",ct,[t[7]||(t[7]=j("span",{style:{"font-weight":"600","font-size":"17px",color:"grey"}},"New NCD Number",-1)),T(M(u),{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),placeholder:"Enter number",inputmode:"numeric",pattern:"[0-9]*",onInput:v,class:"custom-input"},{default:B((()=>[j("div",pt,[j("input",{value:r.value,readonly:"",class:"prefix-part",type:"text"},null,8,mt)])])),_:1},8,["modelValue"])]))])])),_:1}),s.value?(O(),L("div",vt,[T(M(ee),{color:"danger"},{default:B((()=>[j("span",gt,Z(s.value),1)])),_:1})])):Q("",!0),s.value?(O(),L("div",ft,[T(M(V),{onClick:t[2]||(t[2]=e=>function(e){try{console.log(e),a.push(e)}catch(t){console.error(t)}}("setSitePrefix")),fill:"solid",style:{margin:"14px"}},{default:B((()=>[j("span",ht,[j("div",bt,[T(M(g),{icon:M(te),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[8]||(t[8]=j("span",{style:{"margin-left":"6px"}},"set Site Prefix",-1))])])])),_:1})])):Q("",!0)])),_:1})])),_:1}),T(M(l),null,{default:B((()=>[T(M(f),null,{default:B((()=>[T(M(R),{slot:"end"},{default:B((()=>[T(M(h),null,{default:B((()=>[T(M(V),{onClick:P,fill:"solid",disabled:!_.value},{default:B((()=>[j("span",_t,[j("div",yt,[T(M(g),{icon:M(ae),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[9]||(t[9]=j("span",{style:{"margin-left":"6px"}},"Save",-1))])])])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})],64))}}),Dt=we(xt,[["__scopeId","data-v-d3b9b80f"]]),It=G(!1),kt={key:0,style:{display:"flex","justify-content":"space-between",width:"100%"}},Pt={key:0},Ct={key:1,style:{"font-weight":"bold",padding:"1.7px"}},Nt={key:1,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},St={key:0},Lt={key:1},Ot={key:2},Tt={key:2},Bt={style:{display:"flex","flex-wrap":"wrap",gap:"8px",width:"100%"}},zt={key:3,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},jt={key:0},Ht={key:1},Gt={key:2},Mt={key:3},Rt={key:4,style:{width:"100%","text-align":"center"}},Vt={key:0},Et=we(a({__name:"ArtVisitLbl",props:{imageOut:{type:Object},patient:{type:Object}},emits:["label-out"],setup(e,{emit:t}){const a=t,n=G(null),i=G(0),o=e,l=F((()=>{var e;return null!==(e=o.patient)&&void 0!==e&&e.medications?o.patient.medications.filter((e=>e&&(e.name||e.dose||e.frequency||e.quantity))):[]})),r=F((()=>{var e,t;const a=null===(e=o.patient)||void 0===e?void 0:e.vitals;return a&&(a.height||a.weight||a.bloodPressure||(null===(t=o.patient)||void 0===t?void 0:t.bloodGlucose))})),s=F((()=>{const e=l.value;if(0===e.length)return[];if(0===i.value)return e.slice(0,2);{const t=2+4*(i.value-1);return e.slice(t,t+4)}}));F((()=>{const e=l.value.length;if(e<=2)return!0;const t=e-2,a=Math.ceil(t/4);return i.value===a}));const d=F((()=>{const e=l.value.length;if(e<=2)return 1;const t=e-2;return 1+Math.ceil(t/4)}));return U((async()=>{try{const e=await(async()=>{const e=[];for(let a=0;a<d.value;a++){i.value=a,await new Promise((e=>setTimeout(e,100)));try{const t=await oe.toPng(n.value,{height:300,width:594});e.push(t)}catch(t){console.error("Error generating image for page",a,t)}}return e})();a("label-out",e),"function"==typeof o.imageOut&&o.imageOut(e)}catch(e){console.error("Error generating patient labels:",e)}})),(t,a)=>{var o,l,d,u,c,p,m,v,g,f,h,b,_,y,w,x,D,I;return O(),L("div",{ref_key:"lblComponent",ref:n,id:"container"},[0===i.value&&(null!==(o=e.patient)&&void 0!==o&&o.latestVisitDate||null!==(l=e.patient)&&void 0!==l&&l.patientID)?(O(),L("div",kt,[null!==(d=e.patient)&&void 0!==d&&d.latestVisitDate?(O(),L("span",Pt,[a[0]||(a[0]=j("b",null,"Visit:",-1)),z(" "+Z(e.patient.latestVisitDate),1)])):Q("",!0),null!==(u=e.patient)&&void 0!==u&&u.patientID?(O(),L("span",Ct,Z(e.patient.patientID),1)):Q("",!0)])):Q("",!0),0===i.value&&(null!==(c=e.patient)&&void 0!==c&&c.patientName||null!==(p=e.patient)&&void 0!==p&&p.gender||null!==(m=e.patient)&&void 0!==m&&m.diagnoses&&e.patient.diagnoses.length>0)?(O(),L("div",Nt,[null!==(v=e.patient)&&void 0!==v&&v.patientName||null!==(g=e.patient)&&void 0!==g&&g.gender?(O(),L("span",St,[j("b",null,Z(null===(f=e.patient)||void 0===f?void 0:f.patientName)+Z(null!==(h=e.patient)&&void 0!==h&&h.gender?`(${e.patient.gender})`:""),1)])):Q("",!0),null!==(b=e.patient)&&void 0!==b&&b.prescriber?(O(),L("span",Lt,[a[1]||(a[1]=j("b",null,"Seen by:",-1)),z(Z(e.patient.prescriber),1)])):Q("",!0),null!==(_=e.patient)&&void 0!==_&&_.nextAppointment?(O(),L("span",Ot,[a[2]||(a[2]=j("b",null,"Nxt App:",-1)),z(" "+Z(e.patient.nextAppointment),1)])):Q("",!0)])):Q("",!0),0===i.value&&null!==(y=e.patient)&&void 0!==y&&y.diagnoses&&e.patient.diagnoses.length>0?(O(),L("div",Tt,[j("span",Bt,[a[3]||(a[3]=j("b",null,"Diagnoses:",-1)),z(" "+Z(e.patient.diagnoses.filter((e=>e)).join(", ")),1)])])):Q("",!0),0===i.value&&r.value?(O(),L("div",zt,[null!==(w=e.patient)&&void 0!==w&&null!==(w=w.vitals)&&void 0!==w&&w.height?(O(),L("span",jt,Z(e.patient.vitals.height),1)):Q("",!0),null!==(x=e.patient)&&void 0!==x&&null!==(x=x.vitals)&&void 0!==x&&x.weight?(O(),L("span",Ht,Z(e.patient.vitals.weight),1)):Q("",!0),null!==(D=e.patient)&&void 0!==D&&null!==(D=D.vitals)&&void 0!==D&&D.bloodPressure?(O(),L("span",Gt,Z(e.patient.vitals.bloodPressure),1)):Q("",!0),null!==(I=e.patient)&&void 0!==I&&I.bloodGlucose?(O(),L("span",Mt,Z(e.patient.bloodGlucose),1)):Q("",!0)])):Q("",!0),s.value.length>0?(O(),L("table",Rt,[0===i.value?(O(),L("thead",Vt,a[4]||(a[4]=[j("tr",null,[j("th",null,"Drug"),j("th",null,"Dose"),j("th",null,"Freq"),j("th",null,"Qty")],-1)]))):Q("",!0),j("tbody",null,[(O(!0),L(H,null,ie(s.value,((e,t)=>(O(),L("tr",{key:t},[j("td",null,Z((null==e?void 0:e.name)||""),1),j("td",null,Z((null==e?void 0:e.dose)||""),1),j("td",null,Z((null==e?void 0:e.frequency)||""),1),j("td",null,Z((null==e?void 0:e.quantity)||""),1)])))),128))])])):Q("",!0)],512)}}}),[["__scopeId","data-v-777d67d0"]])}}}));
