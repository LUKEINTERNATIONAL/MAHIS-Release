System.register(["./vendor-legacy-Hbu-Y7YT.js","./index-legacy-Dt4cfYEV.js","./BasicForm-legacy-C271X5j3.js","./DashBox-legacy-Bw4kv_4O.js","./group_validation-legacy-DkXjUTac.js"],function(t,e){"use strict";var a,s,n,i,o,l,d,r,u,c,p,m,h,v,b,f,g,_,y,I,w,D,x,S,O,k,B,C,R,T,F,L,M,N,E,z,H,P,U,$,A,q,j,W,G,V,Y,J,X,K,Q,Z,tt,et,at,st,nt,it,ot;return{setters:[t=>{a=t.R,s=t.d,n=t.ar,i=t.V,o=t.as,l=t.af,d=t.D,r=t.dk,u=t.dv,c=t.ac,p=t.G,m=t.T,h=t.U,v=t.a9,b=t.S,f=t.b8,g=t.W,_=t.aU,y=t.X,I=t.E,w=t.y,D=t.f,x=t.z,S=t.l,O=t.k,k=t.B,B=t.A,C=t.e,R=t.F,T=t.L,F=t.a0,L=t.a3,M=t.a1,N=t.a2,E=t.I,z=t.aa,H=t.ab,P=t.a8},t=>{U=t.D,$=t.aO,A=t.C,q=t.H,j=t.ax,W=t.k,G=t.u,V=t._,Y=t.i,J=t.S,X=t.aE,K=t.B,Q=t.aF,Z=t.x,tt=t.az,et=t.ay,at=t.bm,st=t.t},t=>{nt=t.B},t=>{it=t.D},t=>{ot=t.v}],execute:function(){var e=document.createElement("style");e.textContent="ion-footer[data-v-52d5f2cf]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-52d5f2cf]{--width: 90%;--height: 94%}ion-footer[data-v-5d6713fe]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-5d6713fe]{--width: 90%;--height: 94%}.ion-padding[data-v-bae5aa39]{--padding-start: var(--ion-padding, 0px);--padding-end: var(--ion-padding, 0px);--padding-top: var(--ion-padding, 0px);--padding-bottom: var(--ion-padding, 16px)}#container[data-v-bae5aa39]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-bae5aa39]{font-size:20px;line-height:26px}#container p[data-v-bae5aa39]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-bae5aa39]{text-decoration:none}.action_buttons[data-v-bae5aa39]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-bae5aa39]{padding-left:20px}.item_no_border[data-v-bae5aa39]{--border-color: transparent}.search_result[data-v-bae5aa39]{padding:10px}.action_buttons[data-v-bae5aa39]{opacity:0;transition:opacity .3s}.dashed_bottom_border:hover .action_buttons[data-v-bae5aa39]{opacity:1}.dashed_bottom_border[data-v-bae5aa39]{font-weight:700}.sub_item_body[data-v-bae5aa39]{margin-left:45px}ion-segment-button[data-v-bae5aa39]{background:#fff;margin-right:1px;font-size:12px;text-transform:unset}.bottomSummary[data-v-bae5aa39]{margin-top:20px;max-width:600px}.bottomSummary .segment-button-checked[data-v-bae5aa39]{background:#fff!important;--indicator-color: none}.bottomSummary ion-segment-button[data-v-bae5aa39]{background:#e6e6e6;margin-right:5px;border-top-right-radius:10px;border-top-left-radius:10px;text-transform:unset;font-style:normal;font-weight:700;font-size:12px}ion-modal[data-v-be6bf3e1]{--background: rgba(0, 0, 0, .9);--width: 90%;--height: 20%;--max-width: 550px;--max-height: 100px}ion-header[data-v-be6bf3e1]{--background: var(--ion-color-primary)}ion-title[data-v-be6bf3e1]{color:var(--ion-color-light)}ion-content[data-v-be6bf3e1]{display:flex}ion-footer[data-v-be6bf3e1]{--ion-toolbar-background: #fff}\n/*$vite$:1*/",document.head.appendChild(e);const lt=t("u",a("labResultsStore",{state:()=>({labResults:[]}),actions:{setLabResults(t){this.labResults=t}},persist:!0})),dt=s({components:{IonButtons:_,IonButton:g,IonModal:f,IonHeader:b,IonContent:v,IonToolbar:h,IonTitle:m,IonItem:p,IonList:c,IonAvatar:u,IonImg:r,IonLabel:d,IonPage:l,IonMenu:o,BasicForm:nt,IonFooter:i,DynamicButton:U},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{type:Object,default:{}},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},computed:{...n(G,["patient"]),...n(lt,["labResults"])},mounted(){},methods:{dismiss(){y.dismiss()},async saveResults(){const t=await this.buildResults();this.patient.labOrders.results=[{encounter_id:"",date:q.sessionDate(),measures:t,test_id:this.labResults[0].id}];let e=!1;for(let a=0;a<this.patient.labOrders.unsaved.length;a++)if(this.patient.labOrders.unsaved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.unsaved[a].tests&&this.patient.labOrders.unsaved[a].tests.length>0){this.patient.labOrders.unsaved[a].tests[0].result=t,e=!0;break}if(!e)for(let a=0;a<this.patient.labOrders.saved.length;a++)if(this.patient.labOrders.saved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.saved[a].tests&&this.patient.labOrders.saved[a].tests.length>0){this.patient.labOrders.saved[a].tests[0].result=t;break}await j(this.patient),W("Saved successfully"),this.$emit("saved")},async buildResults(){let t=[];return await Promise.all(this.labResults[1].data.rowData[0].colData.map(async e=>{var a;const s=await A("testResultIndicators",{whereClause:{concept_id:e.id}});t.push({indicator:{name:null===(a=s[0])||void 0===a?void 0:a.name,concept_id:e.id},value:e.value.name||e.value||"not done",value_modifier:"",value_type:"text"})})),t},async nav(t,e){const a=lt();"not_save"==e?(await $(),a.setLabResults(!1)):a.setLabResults(!0),this.dismiss(),this.$router.push(t)}}}),rt={class:"modal_wrapper"},ut={class:"center text_12"};t("a",V(dt,[["render",function(t,e,a,s,n,i){const o=I("ion-title"),l=I("ion-button"),d=I("ion-buttons"),r=I("ion-toolbar"),u=I("ion-header"),c=I("basic-form"),p=I("ion-row"),m=I("ion-content"),h=I("DynamicButton"),v=I("ion-footer"),b=I("ion-modal");return D(),w(b,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[2]||(e[2]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:x(()=>[S(u,null,{default:x(()=>[S(r,null,{default:x(()=>[S(o,null,{default:x(()=>[O("b",null,"Enter lab results for ("+k(t.labResults[0].name)+") test",1)]),_:1}),S(d,{slot:"end"},{default:x(()=>[S(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:x(()=>e[3]||(e[3]=[B("Close")])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),S(m,{class:"ion-padding"},{default:x(()=>[O("div",rt,[O("div",ut,[S(p,null,{default:x(()=>[S(c,{contentData:t.labResults},null,8,["contentData"])]),_:1})])])]),_:1}),S(v,{translucent:!0},{default:x(()=>[S(r,null,{default:x(()=>[S(h,{onClick:e[1]||(e[1]=e=>t.saveResults()),name:"Save",fill:"clear",iconSlot:"icon-only",style:{float:"right"}})]),_:1})]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-52d5f2cf"]]));const ct=s({components:{IonButtons:_,IonButton:g,IonModal:f,IonHeader:b,IonContent:v,IonToolbar:h,IonTitle:m,IonItem:p,IonList:c,IonAvatar:u,IonImg:r,IonLabel:d,IonPage:l,IonMenu:o,BasicForm:nt,IonFooter:i,DynamicButton:U},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:[]},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},methods:{dismiss(){y.dismiss()},nav(t,e){this.dismiss(),this.$router.push(t)}}}),pt={class:"modal_wrapper"},mt={class:"center text_12"};t("L",V(ct,[["render",function(t,e,a,s,n,i){const o=I("ion-title"),l=I("ion-button"),d=I("ion-buttons"),r=I("ion-toolbar"),u=I("ion-header"),c=I("ion-col"),p=I("ion-row"),m=I("ion-content"),h=I("ion-modal");return D(),w(h,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[1]||(e[1]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:x(()=>[S(u,null,{default:x(()=>[S(r,null,{default:x(()=>[S(o,null,{default:x(()=>[O("b",null,"Lab results for ("+k(t.content.name)+") test",1)]),_:1}),S(d,{slot:"end"},{default:x(()=>[S(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:x(()=>e[2]||(e[2]=[B("Close")])),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),S(m,{class:"ion-padding"},{default:x(()=>[O("div",pt,[O("div",mt,[S(p,null,{default:x(()=>[(D(!0),C(R,null,T(t.content.result,(t,a)=>(D(),w(c,{size:"4",key:a},{default:x(()=>[S(p,null,{default:x(()=>[S(c,{size:"8"},{default:x(()=>[B(k(t.indicator.name),1)]),_:2},1024),S(c,{class:"bold",size:"0.5"},{default:x(()=>e[3]||(e[3]=[B(":")])),_:1,__:[3]}),S(c,{class:"bold",size:"2"},{default:x(()=>[B(k(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-5d6713fe"]]));const ht=a("investigationNCDStore",{state:()=>({investigations:[{db_data:[],isFinishBtn:!1,selectedData:[],displayData:[],data:{rowData:[{colData:[{inputHeader:"Test",icon:Y.search,value:"",name:"test",popOver:!0,eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"test_id",validationFunctionName:"required"},{inputHeader:"Specimen",icon:Y.search,value:"",name:"specimen",eventType:"input",required:!0,alertsErrorMassage:"",disabled:!0,isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"specimen_id",validationFunctionName:"required"}]}]}}]}),actions:{setInvestigations(t){this.investigations=t}}}),vt=t("_",s({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(t){this.userRole=J.getUserRoles();const e=J.getProgramID(),a=J.getProgramName();"Lab"==this.userRole&&14==e&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),14==e&&"Lab"!=this.userRole&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),12==e&&(this.userRoleSettings={url:"contact",btnName:"Back"}),"LABOUR AND DELIVERY PROGRAM"==a&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),"PNC PROGRAM"==a&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}})),bt=s({name:"Menu",mixins:[vt],components:{IonContent:v,IonHeader:b,IonItem:p,IonList:c,IonMenu:o,IonTitle:m,IonToolbar:h,IonInput:L,IonPopover:F,DashBox:it,SelectionPopover:Q,BasicInputField:K,BasicForm:nt,List:X,DynamicButton:U},data:()=>({segmentContent:"Lab Investigations",iconsContent:Y,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}),setup:()=>({checkmark:N,pulseOutline:M}),computed:{...n(ht,["investigations"]),...n(G,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{dismiss(){y.dismiss()},setSegmentContent(t){this.segmentContent=t},async getTests(){let t;t=J.getUseIndexDBStatus()&&J.getModsStatus()?await A("testTypes"):await tt.getTestTypes(),Z(this.investigations,"test","multiSelectData",t)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const t=await this.labOrders.filter(t=>q.toStandardHisFormat(q.sessionDate())===q.toStandardHisFormat(t.order_date));t.length>0?this.investigations[0].selectedData=t:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard(),ht().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return ot(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(Z(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(Z(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){ot(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard(),this.dismiss()},isNameInData(t,e){for(let a of e)for(let e of a.tests)if(e.name===t)return!0;return!1},async saveTest(){var t,e,a,s,n,i;const o=[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await et.getConceptID(this.inputFields[1].value.name,!0)}];let l=(await tt.buildLabOrders("",o))[0];l.order_date=l.date,l.specimen.name=this.inputFields[1].value.name,l.tests[0].name=this.inputFields[0].value.name;const d=JSON.parse(JSON.stringify(this.patient));null!==(e=(t=null!==(a=d.labOrders)&&void 0!==a?a:d.labOrders={}).unsaved)&&void 0!==e||(t.unsaved=[]),null!==(n=(s=null!==(i=d.labOrders)&&void 0!==i?i:d.labOrders={}).saved)&&void 0!==n||(s.saved=[]),d.labOrders.unsaved.push(l),await j(d),Z(this.investigations,"specimen","disabled",!0),this.labOrders=[...d.labOrders.saved,...d.labOrders.unsaved]},async handleInputData(t){if("Test"==t.inputHeader&&this.checkTest(),Z(this.investigations,"specimen","alertsErrorMassage",""),"Test"==t.inputHeader&&t.value){let e;e=J.getUseIndexDBStatus()&&J.getModsStatus()?await A("specimens"):await tt.getSpecimens("",1e3),this.specimen=await et.getConceptSet(t.value.name,"",{names:e.map(t=>t.name)}),1==this.specimen.length?(Z(this.investigations,"specimen","value",this.specimen[0]),Z(this.investigations,"specimen","disabled",!0)):(Z(this.investigations,"specimen","value",""),Z(this.investigations,"specimen","disabled",!1)),Z(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(t){return await this.labOrders.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))},async filterSpecimen(t){var e;return null!==(e=this.specimen[0])&&void 0!==e&&e.name&&t?await this.specimen.filter(e=>null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())):[]},setTest(t){this.selectedText=t.name,"Test"==this.inputFields[1].inputHeader?this.investigations[0].data.rowData[0].colData[0].value=t.name:this.investigations[0].data.rowData[0].colData[1].value=t.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),ft={class:"modal_wrapper"},gt={class:""};t("E",V(bt,[["render",function(t,e,a,s,n,i){const o=I("ion-title"),l=I("ion-icon"),d=I("ion-header"),r=I("basic-form"),u=I("ion-content"),c=I("DynamicButton"),p=I("ion-col"),m=I("ion-row"),h=I("ion-footer");return D(),C(R,null,[S(d,{style:{display:"flex","justify-content":"space-between"}},{default:x(()=>[S(o,{class:"modalTitle"},{default:x(()=>e[2]||(e[2]=[B("Add Lab Test")])),_:1,__:[2]}),S(l,{onClick:e[0]||(e[0]=e=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),S(u,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:x(()=>[O("div",ft,[O("div",gt,[S(r,{contentData:t.investigations,"onUpdate:selected":t.handleInputData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:selected","onUpdate:inputValue"])])])]),_:1}),S(h,{collapse:"fade",class:"ion-no-border"},{default:x(()=>[S(m,null,{default:x(()=>[S(p,null,{default:x(()=>[S(c,{onClick:e[1]||(e[1]=e=>t.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}],["__scopeId","data-v-bae5aa39"]]));const _t=s({name:"CheckInConfirmationModal",components:{IonCol:H,IonRow:z,IonFooter:i,DynamicButton:U,IonModal:f,IonHeader:b,IonToolbar:h,IonTitle:m,IonButtons:_,IonButton:g,IonContent:v,IonIcon:E},props:{isOpen:{type:Boolean,required:!0,default:!1},closeModalFunc:{type:Function,required:!0},onYes:{type:Function,required:!0},onNo:{type:Function,required:!0},title:{type:String,required:!0}},computed:{},methods:{closeOutline:()=>P,closeModal(){this.closeModalFunc()},confirm(t){this.closeModal()}}}),yt={style:{display:"flex"}};t("S",V(_t,[["render",function(t,e,a,s,n,i){const o=I("ion-title"),l=I("ion-icon"),d=I("ion-button"),r=I("ion-buttons"),u=I("ion-col"),c=I("DynamicButton"),p=I("ion-row"),m=I("ion-footer"),h=I("ion-content"),v=I("ion-modal");return D(),w(v,{"is-open":t.isOpen,"show-backdrop":!0,onDidDismiss:t.closeModal},{default:x(()=>[S(r,{slot:"start"},{default:x(()=>[S(o,{style:{color:"#0c0c0c"}},{default:x(()=>[B(k(t.title),1)]),_:1}),S(d,{onClick:t.closeModal},{default:x(()=>[S(l,{slot:"icon-only",icon:t.closeOutline(),style:{color:"#b02a37"}},null,8,["icon"])]),_:1},8,["onClick"])]),_:1}),S(h,null,{default:x(()=>[O("div",yt,[S(m,{collapse:"fade",class:"ion-no-border"},{default:x(()=>[S(p,null,{default:x(()=>[S(u,null,{default:x(()=>[S(d,{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:t.onNo},{default:x(()=>e[1]||(e[1]=[B(" Cancel ")])),_:1,__:[1]},8,["onClick"])]),_:1}),S(u,null,{default:x(()=>[S(c,{name:"Send",onClick:e[0]||(e[0]=e=>t.onYes()),fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["is-open","onDidDismiss"])}],["__scopeId","data-v-be6bf3e1"]])),t("b",class extends tt{constructor(){super()}async postActivities(t,e){const a=e.location_id,s=new at(parseInt(t),-1,a),n=await s.createEncounter();if(n){const t=await tt.buildLabOrders(n,e.orders||e);if(!(await tt.saveOrdersArray(n.encounter_id,t)))return st("Unable to save lab orders")}}})}}});
