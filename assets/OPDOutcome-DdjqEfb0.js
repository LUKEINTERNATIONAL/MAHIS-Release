import{d as te,ao as Ve,U as mt,T as pt,ap as vt,ak as Ae,G as K,S as ft,ah as ht,a9 as Je,aa as gt,E as J,e as o,f as s,k as e,l as a,a$ as Pe,r as c,c as Q,a as Oe,m as S,y as $,z as d,u as r,A as O,F as R,W as le,I as Ee,e1 as nn,be as _t,e2 as sn,cQ as an,e3 as on,e4 as ln,e5 as rn,e6 as un,c$ as cn,e7 as dn,e8 as mn,aw as yt,aA as pn,bU as vn,ay as bt,aP as fn,B as E,L as U,w as _e,M as Be,J as ce,D as G,bx as re,ai as hn,X as gn,i as _n,e9 as yn,v as bn,bo as Qe,ab as Dn,bq as wn,ag as xn,bS as Sn,bI as Cn,aj as ut}from"./vendor-D2vbv48U.js";import{b4 as qe,H as Ue,a9 as ee,b6 as Dt,b5 as wt,aQ as xt,u as Ne,_ as de,i as Ie,as as Re,at as He,D as we,w as De,S as xe,E as Se,t as ue,y as $e,aF as j,aD as Me,b7 as Fe,bu as kn,aG as St,bv as En,bw as In,aT as An,b2 as he,aU as ge,bx as Pn,a3 as On,P as Nn,aJ as ct,aO as $n,m as Ln,a1 as ke,aC as Mn,al as Fn}from"./index-BKKrZstI.js";import{l as fe}from"./lodash-Dt8AsbQm.js";import{P as Bn}from"./patient_complaints_service-DEF-B2Cv.js";import{D as Ct}from"./DashBox-CCttIs4F.js";import{u as Rn}from"./useExposeFromStandardForm-DTCBagmg.js";import{B as Xe}from"./BasicForm-JTDmQZAP.js";import{f as Ze,c as kt,a as Et}from"./formatServerData-CNQTwFLE.js";import{A as Tn,P as Vn,D as Hn,n as qn}from"./NextAppointment-DBK55drE.js";import{D as Un,b as Wn}from"./drug_prescription_service-Cdp09yhG.js";import{D as dt}from"./drug_service-enNyjps3.js";import{D as zn,A as Gn,R as Yn,a as jn}from"./Outcome-DIbldosb.js";const Kn=te({name:"Menu",components:{IonContent:ht,IonHeader:ft,IonItem:K,IonList:Ae,IonMenu:vt,IonTitle:pt,IonToolbar:mt,List:qe},computed:{...Ve(Ne,["patient"]),...Ve(xt,["presentingComplaints"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:wt(["#006401"]),listIcon:Dt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:gt,pulseOutline:Je}},watch:{$router:{async handler(){await this.updateList()},immediate:!0,deep:!0},patient:{async handler(){await this.updateList()},deep:!0}},async mounted(){await this.updateList()},methods:{async updateList(){const t=await ee.getAll(this.patient.patientID,"Presenting complaint"),n=fe.isEmpty(t)?[]:Promise.all(t.map(async v=>v.value_coded?{name:await ee.getConceptName(v.value_coded),obs_date:v.obs_datetime,duration:v.children[0].value_text}:[]));this.setListData(await n)},setListData(t){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 20px;",containSize:4,display:["Date","Presenting Complains","Duration"]}),t.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height:20px;",class:"col_background",containSize:4,display:[Ue.toStandardHisFormat(n.obs_date),n.name,n.duration]})})}}}),Qn={class:"modal_wrapper"};function Jn(t,n,v,g,w,C){const m=J("list");return s(),o("div",Qn,[e("div",null,[a(m,{listData:t.list},null,8,["listData"])])])}const Xn=de(Kn,[["render",Jn],["__scopeId","data-v-30434e22"]]),Zn={key:0},es={style:{"align-content":"center"}},ts={class:"ion-padding",slot:"content"},ns=te({__name:"PresentingComplaints",setup(t,{expose:n}){const v=xt(),{presentingComplaints:g}=Pe(v),w=c(Ie),C=c(!0),m=c(!1),y=c(!0),D=c(!1),u=c([]),h=c([]),l=c(),V=Q(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:Ie.search,hideSelected:!0,validation:_=>H(_==null?void 0:_.name,u.value)?"Presenting complaint already added":Re.required(_),options:h.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:Ie.time,validation:_=>Re.isNotEmptyandNumber(_),grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:_=>!_||_===""?"Please select a unit.":null},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:Ie.editPen,validation:_=>H(_,u.value)?"Presenting complaint already added":Re.required(_),condition:_=>{var i;return((i=_==null?void 0:_.PresentingComplaints)==null?void 0:i.name)==="Other"}},{componentType:"Alert",condition:_=>{var i;return Re.required((i=_==null?void 0:_.PresentingComplaints)==null?void 0:i.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:P}=Rn(),T=async()=>{h.value=await Bn.getComplaintsList("Presenting complaint"),De(g.value,"PresentingComplaints","multiSelectData",h.value)},A=()=>{C.value=!1,y.value=!1,m.value=!0},L=async()=>{var k,b;const _=(k=P.value)==null?void 0:k.getFormValues();((b=P.value)==null?void 0:b.validateForm())==null&&(F(_),m.value=!1,y.value=!0)},F=_=>{var I;const i=_.duration+" "+_.duration_unit,k=_.PresentingComplaints,b=k.name==="Other"?_["Other (specify)"]:k.name;u.value.push({actionBtn:!0,btn:["delete"],name:b,concept_id:k.concept_id,duration:k.duration,durationUnits:k.duration_unit,display:[b,i],data:[{concept_id:8578,value_coded:k.concept_id,obs_datetime:xe.getSessionDate(),child:[{concept_id:k.concept_id,value_text:i,obs_datetime:xe.getSessionDate()}]}]}),(I=P.value)==null||I.resetForm(),D.value=!0},H=(_,i)=>i.some(k=>k.name===_),Y=_=>{u.value=u.value.filter(i=>i.display[0]!==_.name)},X=async()=>{const _=await ee.getObsByEncounterIdAndDate(Se.PRESENTING_COMPLAINTS),i=u.value.flatMap(k=>k.data);if(i.length<=0&&_.length<=0)return ue("Presenting complaints is required");i.length<=0||(await ee.addObsToEncounterPatient(i,Se.PRESENTING_COMPLAINTS),$e("Presenting complaints saved successful"),u.value=[])};return Oe(async()=>{await T()}),n({onSubmit:X}),(_,i)=>{const k=J("ion-row"),b=J("ion-label"),I=J("ion-accordion"),M=J("ion-accordion-group");return s(),o(R,null,[a(Ct,{status:C.value,content:"No presenting complaints added"},null,8,["status"]),D.value?(s(),o("span",Zn,[a(qe,{listData:u.value,"onClicked:delete":Y},null,8,["listData"])])):S("",!0),m.value?(s(),$(k,{key:1},{default:d(()=>[a(He,{formData:V.value,ref_key:"formRef",ref:P},null,8,["formData"]),e("div",es,[a(we,{fill:"clear",icon:w.value.plus,iconSlot:"icon-only","onClicked:btn":i[0]||(i[0]=z=>L()),name:"Save"},null,8,["icon"])])]),_:1})):S("",!0),y.value?(s(),$(k,{key:2,style:{"margin-top":"10px"}},{default:d(()=>[a(we,{fill:"clear",icon:w.value.plus,iconSlot:"icon-only","onClicked:btn":i[1]||(i[1]=z=>A()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):S("",!0),a(k,null,{default:d(()=>[a(M,{ref_key:"accordionGroup",ref:l,class:"previousView"},{default:d(()=>[a(I,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(b,{class:"previousLabel"},{default:d(()=>i[2]||(i[2]=[O("Previous presenting complaints")])),_:1,__:[2]})]),_:1}),e("div",ts,[a(Xn)])]),_:1})]),_:1},512)]),_:1})],64)}}}),ss=de(ns,[["__scopeId","data-v-7ca4ad60"]]),as=te({name:"VisitHistory",components:{IonIcon:Ee,IonButton:le},setup(){const t=St();return{selectedAllergiesList2:Q(()=>t.selectedMedicalAllergiesList),calendarOutline:fn,alertCircleOutline:bt,documentTextOutline:vn,femaleOutline:pn,medicalOutline:yt,warningOutline:mn,bodyOutline:dn,eyeOutline:cn,nutritionOutline:un,fitnessOutline:rn,pulseOutline:Je,earOutline:ln,happyOutline:on,manOutline:an,moveOutline:sn,addOutline:_t,scanOutline:nn}},data(){return{visits:[],visitDate:null,presentingComplaint:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},eyesAbnormal:[],mouthAbnormal:[],earsAbnormal:[],faceAbnormal:[],neckAbnormal:[],chestAbnormal:[],chestMovementAbnormal:[],heartSoundsAbnormal:[],breathSoundsAbnormal:[],addedBreathSoundsAbnormal:[],abdominalInspectionAbnormal:[],eyesExamined:!1,mouthExamined:!1,earsExamined:!1,faceExamined:!1,neckExamined:!1,chestExamined:!1,chestMovementExamined:!1,heartSoundsExamined:!1,breathSoundsExamined:!1,addedBreathSoundsExamined:!1,abdominalInspectionExamined:!1}},computed:{...Ve(Ne,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var t;return((t=this.uniquePresentingComplaints)==null?void 0:t.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var t;return((t=this.uniquePastMedicalHistory)==null?void 0:t.length)>0},hasAllergies(){var t,n;return((n=(t=this.selectedAllergiesList2)==null?void 0:t.filter(v=>v.selected))==null?void 0:n.length)>0},hasPhysicalExam(){var t,n,v,g,w,C,m,y,D,u,h;return((t=this.eyesAbnormal)==null?void 0:t.length)>0||this.eyesExamined||((n=this.mouthAbnormal)==null?void 0:n.length)>0||this.mouthExamined||((v=this.earsAbnormal)==null?void 0:v.length)>0||this.earsExamined||((g=this.faceAbnormal)==null?void 0:g.length)>0||this.faceExamined||((w=this.neckAbnormal)==null?void 0:w.length)>0||this.neckExamined||((C=this.chestAbnormal)==null?void 0:C.length)>0||this.chestExamined||((m=this.chestMovementAbnormal)==null?void 0:m.length)>0||this.chestMovementExamined||((y=this.heartSoundsAbnormal)==null?void 0:y.length)>0||this.heartSoundsExamined||((D=this.breathSoundsAbnormal)==null?void 0:D.length)>0||this.breathSoundsExamined||((u=this.addedBreathSoundsAbnormal)==null?void 0:u.length)>0||this.addedBreathSoundsExamined||((h=this.abdominalInspectionAbnormal)==null?void 0:h.length)>0||this.abdominalInspectionExamined},uniquePastMedicalHistory(){return[...new Map(this.pastMedicalHistory.map(t=>[t,t])).values()]},uniquePresentingComplaints(){return[...new Map(this.presentingComplaint.map(t=>[t,t])).values()]}},methods:{formatVisitDate(t){return t?Ue.toStandardHisDisplayFormat(t):"No visit date"},async updateData(){var n,v;if(!((n=this.patient)!=null&&n.patientID))return;const t=await kn(this.patient.patientID);t&&(this.visits=((v=t.visits)==null?void 0:v.visitsDates)||[],this.visits.length>0&&await this.loadSavedEncounters(this.visits[0]))},async loadSavedEncounters(t){this.visitDate=t;const n=Me("presentingComplaints"),v=Me("pastMedicalHistory"),g=Me("levelOfConsciousness"),w=Me("pregnancy"),C=Me("physicalExam"),m=Fe(n),y=Fe(v),D=Fe(g),u=Fe(w),h=Fe(C);await this.setPresentingComplainsEncounters(m),await this.setPastMedicalHistoryEncounters(y),await this.setLevelOfConsciousnessEncounters(D),await this.setPregnancyStatusEncounters(u),await this.setPhysicalExamEncounters(h)},filterObs(t,n){return t?t.filter(v=>{var g,w;return((w=(g=v.concept)==null?void 0:g.concept_names)==null?void 0:w.some(C=>C.name===n))||v.concept_name===n}):[]},async getConceptValues(t,n){return t?await Promise.all(t.map(async v=>v.value_coded?await j.getConceptName(v.value_coded):v.concept_name||v.name)):[]},async setPresentingComplainsEncounters(t){this.presentingComplaint=await this.getConceptValues(this.filterObs(t,"Presenting complaint"),"coded")},async setLevelOfConsciousnessEncounters(t){if(t&&Array.isArray(t)){const n=this.filterObs(t,"Eye opening response");this.levelOfConsciousness.eyeResponse=n.length>0?await j.getConceptName(n[0].value_coded):null;const v=this.filterObs(t,"Best verbal response");this.levelOfConsciousness.verbalResponse=v.length>0?await j.getConceptName(v[0].value_coded):null;const g=this.filterObs(t,"Best motor response");this.levelOfConsciousness.motorResponse=g.length>0?await j.getConceptName(g[0].value_coded):null}},async setPregnancyStatusEncounters(t){if(t&&Array.isArray(t)){const n=this.filterObs(t,"Patient pregnant");this.pregnancy.patientPregnant=n.length>0?await j.getConceptName(n[0].value_coded):null;const v=this.filterObs(t,"Is patient breast feeding?");this.pregnancy.breastFeeding=v.length>0?await j.getConceptName(v[0].value_coded):null}},async setPhysicalExamEncounters(t){var n,v,g,w,C,m,y,D;if(!(!t||!Array.isArray(t))){this.eyesAbnormal=[],this.mouthAbnormal=[],this.earsAbnormal=[],this.faceAbnormal=[],this.neckAbnormal=[],this.chestAbnormal=[],this.chestMovementAbnormal=[],this.heartSoundsAbnormal=[],this.breathSoundsAbnormal=[],this.addedBreathSoundsAbnormal=[],this.abdominalInspectionAbnormal=[],this.eyesExamined=!1,this.mouthExamined=!1,this.earsExamined=!1,this.faceExamined=!1,this.neckExamined=!1,this.chestExamined=!1,this.chestMovementExamined=!1,this.heartSoundsExamined=!1,this.breathSoundsExamined=!1,this.addedBreathSoundsExamined=!1,this.abdominalInspectionExamined=!1;for(const u of t){if(!u.concept_name&&!((n=u.concept)!=null&&n.concept_names))continue;const h=u.concept_name||((w=(g=(v=u.concept)==null?void 0:v.concept_names)==null?void 0:g.find(l=>l.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:w.name);h&&(h.includes("normal")||h.includes("Normal"))&&u.value_coded===1065&&(h.includes("Eyes normal")?this.eyesExamined=!0:h.includes("Mouth normal")?this.mouthExamined=!0:h.includes("Ears normal")?this.earsExamined=!0:h.includes("Face normal")?this.faceExamined=!0:h.includes("Neck normal")?this.neckExamined=!0:h.includes("Chest inspection normal")?this.chestExamined=!0:h.includes("Heart sounds normal")?this.heartSoundsExamined=!0:h.includes("Breath sounds normal")?this.breathSoundsExamined=!0:h.includes("Abdominal inspection normal")&&(this.abdominalInspectionExamined=!0))}for(const u of t){if(!u.concept_name&&!((C=u.concept)!=null&&C.concept_names))continue;const h=u.concept_name||((D=(y=(m=u.concept)==null?void 0:m.concept_names)==null?void 0:y.find(l=>l.concept_name_type==="FULLY_SPECIFIED"))==null?void 0:D.name);if(h&&!(h.includes("normal")||h.includes("Normal"))){if(h.includes("Abnormality for eyes"))if(this.eyesExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.eyesAbnormal.push(l)}else u.value_text&&this.eyesAbnormal.push(u.value_text);else if(h.includes("Abnormality for mouth"))if(this.mouthExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.mouthAbnormal.push(l)}else u.value_text&&this.mouthAbnormal.push(u.value_text);else if(h.includes("Abnormality for ears"))if(this.earsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.earsAbnormal.push(l)}else u.value_text&&this.earsAbnormal.push(u.value_text);else if(h.includes("Abnormality for face"))if(this.faceExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.faceAbnormal.push(l)}else u.value_text&&this.faceAbnormal.push(u.value_text);else if(h.includes("Abnormality for neck"))if(this.neckExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.neckAbnormal.push(l)}else u.value_text&&this.neckAbnormal.push(u.value_text);else if(h.includes("Abnormality for chest inspection"))if(this.chestExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.chestAbnormal.push(l)}else u.value_text&&this.chestAbnormal.push(u.value_text);else if(h.includes("Chest movements"))if(this.chestMovementExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.chestMovementAbnormal.push(l)}else u.value_text&&this.chestMovementAbnormal.push(u.value_text);else if(h.includes("Heart sounds abnormality"))if(this.heartSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.heartSoundsAbnormal.push(l)}else u.value_text&&this.heartSoundsAbnormal.push(u.value_text);else if(h.includes("Breath sounds abnormality"))if(this.breathSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.breathSoundsAbnormal.push(l)}else u.value_text&&this.breathSoundsAbnormal.push(u.value_text);else if(h.includes("Abnormalities when added"))if(this.addedBreathSoundsExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.addedBreathSoundsAbnormal.push(l)}else u.value_text&&this.addedBreathSoundsAbnormal.push(u.value_text);else if(h.includes("Abdominal inspection abnormality"))if(this.abdominalInspectionExamined=!0,u.value_coded){const l=await j.getConceptName(u.value_coded);l&&l.toLowerCase()!=="no"&&l.toLowerCase()!=="normal"&&this.abdominalInspectionAbnormal.push(l)}else u.value_text&&this.abdominalInspectionAbnormal.push(u.value_text)}}}},async setPastMedicalHistoryEncounters(t){this.pastMedicalHistory=await this.getConceptValues(this.filterObs(t,"Chronic disease"),"coded")}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),os={class:"visit-container"},is={class:"visit-header"},ls={class:"visit-date"},rs={class:"visit-sections"},us={key:0,class:"visit-section"},cs={class:"section-header"},ds={class:"section-content"},ms={key:0,class:"info-item"},ps={class:"info-value"},vs={key:1,class:"info-item"},fs={class:"info-value"},hs={key:2,class:"info-item"},gs={class:"info-value"},_s={key:1,class:"empty-section"},ys={key:2,class:"visit-section"},bs={class:"section-header"},Ds={class:"tags-container"},ws={key:3,class:"empty-section"},xs={key:4,class:"visit-section"},Ss={class:"section-header"},Cs={class:"section-content"},ks={key:0,class:"info-item"},Es={class:"info-value highlight"},Is={key:1,class:"info-item"},As={class:"info-value highlight"},Ps={key:5,class:"empty-section"},Os={key:6,class:"visit-section"},Ns={class:"section-header"},$s={class:"tags-container"},Ls={key:7,class:"empty-section"},Ms={key:8,class:"visit-section"},Fs={class:"section-header"},Bs={class:"tags-container"},Rs={key:0,class:"allergy-tag"},Ts={key:9,class:"empty-section"},Vs={key:10,class:"visit-section"},Hs={class:"section-header"},qs={class:"exam-section"},Us={key:0,class:"exam-category"},Ws={class:"exam-category-header"},zs={class:"exam-items"},Gs={key:1,class:"exam-category normal"},Ys={class:"exam-category-header"},js={key:2,class:"exam-category"},Ks={class:"exam-category-header"},Qs={class:"exam-items"},Js={key:3,class:"exam-category normal"},Xs={class:"exam-category-header"},Zs={key:4,class:"exam-category"},ea={class:"exam-category-header"},ta={class:"exam-items"},na={key:5,class:"exam-category normal"},sa={class:"exam-category-header"},aa={key:6,class:"exam-category"},oa={class:"exam-category-header"},ia={class:"exam-items"},la={key:7,class:"exam-category normal"},ra={class:"exam-category-header"},ua={key:8,class:"exam-category"},ca={class:"exam-category-header"},da={class:"exam-items"},ma={key:9,class:"exam-category normal"},pa={class:"exam-category-header"},va={key:10,class:"exam-category"},fa={class:"exam-category-header"},ha={class:"exam-items"},ga={key:11,class:"exam-category normal"},_a={class:"exam-category-header"},ya={key:12,class:"exam-category"},ba={class:"exam-category-header"},Da={class:"exam-items"},wa={key:13,class:"exam-category normal"},xa={class:"exam-category-header"},Sa={key:14,class:"exam-category"},Ca={class:"exam-category-header"},ka={class:"exam-items"},Ea={key:15,class:"exam-category normal"},Ia={class:"exam-category-header"},Aa={key:16,class:"exam-category"},Pa={class:"exam-items"},Oa={key:17,class:"exam-category normal"},Na={key:18,class:"exam-category"},$a={class:"exam-category-header"},La={class:"exam-items"},Ma={key:19,class:"exam-category normal"},Fa={class:"exam-category-header"},Ba={key:20,class:"exam-category"},Ra={class:"exam-category-header"},Ta={class:"exam-items"},Va={key:21,class:"exam-category normal"},Ha={class:"exam-category-header"},qa={key:11,class:"empty-section"};function Ua(t,n,v,g,w,C){const m=J("ion-icon");return s(),o("div",os,[e("div",is,[n[0]||(n[0]=e("h5",null,"Patient's Clinical Assessment Summary",-1)),e("div",ls,[a(m,{icon:t.calendarOutline},null,8,["icon"]),e("span",null,E(t.formatVisitDate(t.visitDate)),1)])]),e("div",rs,[t.hasLevelOfConsciousness?(s(),o("div",us,[e("div",cs,[a(m,{icon:t.alertCircleOutline,class:"section-icon"},null,8,["icon"]),n[1]||(n[1]=e("h3",null,"Level of Consciousness",-1))]),e("div",ds,[t.levelOfConsciousness.eyeResponse?(s(),o("div",ms,[n[2]||(n[2]=e("span",{class:"info-label"},"Eye Response:",-1)),e("span",ps,E(t.levelOfConsciousness.eyeResponse),1)])):S("",!0),t.levelOfConsciousness.verbalResponse?(s(),o("div",vs,[n[3]||(n[3]=e("span",{class:"info-label"},"Verbal Response:",-1)),e("span",fs,E(t.levelOfConsciousness.verbalResponse),1)])):S("",!0),t.levelOfConsciousness.motorResponse?(s(),o("div",hs,[n[4]||(n[4]=e("span",{class:"info-label"},"Motor Response:",-1)),e("span",gs,E(t.levelOfConsciousness.motorResponse),1)])):S("",!0)])])):(s(),o("div",_s,[a(m,{icon:t.alertCircleOutline},null,8,["icon"]),n[5]||(n[5]=e("p",null,"No level of consciousness recorded",-1))])),t.hasPresentingComplaints?(s(),o("div",ys,[e("div",bs,[a(m,{icon:t.documentTextOutline,class:"section-icon"},null,8,["icon"]),n[6]||(n[6]=e("h3",null,"Presenting Complaints",-1))]),e("div",Ds,[(s(!0),o(R,null,U(t.uniquePresentingComplaints,(y,D)=>(s(),o("div",{class:"complaint-tag",key:D},E(y),1))),128))])])):(s(),o("div",ws,[a(m,{icon:t.documentTextOutline},null,8,["icon"]),n[7]||(n[7]=e("p",null,"No presenting complaints recorded",-1))])),t.hasPregnancyData?(s(),o("div",xs,[e("div",Ss,[a(m,{icon:t.femaleOutline,class:"section-icon"},null,8,["icon"]),n[8]||(n[8]=e("h3",null,"Pregnancy Status",-1))]),e("div",Cs,[t.pregnancy.patientPregnant?(s(),o("div",ks,[n[9]||(n[9]=e("span",{class:"info-label"},"Pregnant:",-1)),e("span",Es,E(t.pregnancy.patientPregnant),1)])):S("",!0),t.pregnancy.breastFeeding?(s(),o("div",Is,[n[10]||(n[10]=e("span",{class:"info-label"},"Breastfeeding:",-1)),e("span",As,E(t.pregnancy.breastFeeding),1)])):S("",!0)])])):(s(),o("div",Ps,[a(m,{icon:t.femaleOutline},null,8,["icon"]),n[11]||(n[11]=e("p",null,"No pregnancy status recorded",-1))])),t.hasPastMedicalHistory?(s(),o("div",Os,[e("div",Ns,[a(m,{icon:t.medicalOutline,class:"section-icon"},null,8,["icon"]),n[12]||(n[12]=e("h3",null,"Medical History",-1))]),e("div",$s,[(s(!0),o(R,null,U(t.uniquePastMedicalHistory,(y,D)=>(s(),o("div",{class:"medical-tag",key:D},E(y),1))),128))])])):(s(),o("div",Ls,[a(m,{icon:t.medicalOutline},null,8,["icon"]),n[13]||(n[13]=e("p",null,"No medical history recorded",-1))])),t.hasAllergies?(s(),o("div",Ms,[e("div",Fs,[a(m,{icon:t.warningOutline,class:"section-icon"},null,8,["icon"]),n[14]||(n[14]=e("h3",null,"Allergies",-1))]),e("div",Bs,[(s(!0),o(R,null,U(t.selectedAllergiesList2,(y,D)=>(s(),o(R,{key:D},[y.selected?(s(),o("div",Rs,E(y.name),1)):S("",!0)],64))),128))])])):(s(),o("div",Ts,[a(m,{icon:t.warningOutline},null,8,["icon"]),n[15]||(n[15]=e("p",null,"No allergies recorded",-1))])),t.hasPhysicalExam?(s(),o("div",Vs,[e("div",Hs,[a(m,{icon:t.bodyOutline,class:"section-icon"},null,8,["icon"]),n[16]||(n[16]=e("h3",null,"Physical Examination",-1))]),e("div",qs,[t.eyesAbnormal.length?(s(),o("div",Us,[e("div",Ws,[a(m,{icon:t.eyeOutline},null,8,["icon"]),n[17]||(n[17]=e("h4",null,"Eyes",-1))]),e("div",zs,[(s(!0),o(R,null,U(t.eyesAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"eyes-"+D},E(y),1))),128))])])):t.eyesExamined?(s(),o("div",Gs,[e("div",Ys,[a(m,{icon:t.eyeOutline},null,8,["icon"]),n[18]||(n[18]=e("h4",null,"Eyes",-1))]),n[19]||(n[19]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.mouthAbnormal.length?(s(),o("div",js,[e("div",Ks,[a(m,{icon:t.nutritionOutline},null,8,["icon"]),n[20]||(n[20]=e("h4",null,"Mouth",-1))]),e("div",Qs,[(s(!0),o(R,null,U(t.mouthAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"mouth-"+D},E(y),1))),128))])])):t.mouthExamined?(s(),o("div",Js,[e("div",Xs,[a(m,{icon:t.nutritionOutline},null,8,["icon"]),n[21]||(n[21]=e("h4",null,"Mouth",-1))]),n[22]||(n[22]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.earsAbnormal.length?(s(),o("div",Zs,[e("div",ea,[a(m,{icon:t.earOutline},null,8,["icon"]),n[23]||(n[23]=e("h4",null,"Ears",-1))]),e("div",ta,[(s(!0),o(R,null,U(t.earsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"ears-"+D},E(y),1))),128))])])):t.earsExamined?(s(),o("div",na,[e("div",sa,[a(m,{icon:t.earOutline},null,8,["icon"]),n[24]||(n[24]=e("h4",null,"Ears",-1))]),n[25]||(n[25]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.faceAbnormal.length?(s(),o("div",aa,[e("div",oa,[a(m,{icon:t.happyOutline},null,8,["icon"]),n[26]||(n[26]=e("h4",null,"Face",-1))]),e("div",ia,[(s(!0),o(R,null,U(t.faceAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"face-"+D},E(y),1))),128))])])):t.faceExamined?(s(),o("div",la,[e("div",ra,[a(m,{icon:t.happyOutline},null,8,["icon"]),n[27]||(n[27]=e("h4",null,"Face",-1))]),n[28]||(n[28]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.neckAbnormal.length?(s(),o("div",ua,[e("div",ca,[a(m,{icon:t.manOutline},null,8,["icon"]),n[29]||(n[29]=e("h4",null,"Neck",-1))]),e("div",da,[(s(!0),o(R,null,U(t.neckAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"neck-"+D},E(y),1))),128))])])):t.neckExamined?(s(),o("div",ma,[e("div",pa,[a(m,{icon:t.manOutline},null,8,["icon"]),n[30]||(n[30]=e("h4",null,"Neck",-1))]),n[31]||(n[31]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.chestAbnormal.length?(s(),o("div",va,[e("div",fa,[a(m,{icon:t.fitnessOutline},null,8,["icon"]),n[32]||(n[32]=e("h4",null,"Chest",-1))]),e("div",ha,[(s(!0),o(R,null,U(t.chestAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"chest-"+D},E(y),1))),128))])])):t.chestExamined?(s(),o("div",ga,[e("div",_a,[a(m,{icon:t.fitnessOutline},null,8,["icon"]),n[33]||(n[33]=e("h4",null,"Chest",-1))]),n[34]||(n[34]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal examination ")],-1))])):S("",!0),t.chestMovementAbnormal.length?(s(),o("div",ya,[e("div",ba,[a(m,{icon:t.moveOutline},null,8,["icon"]),n[35]||(n[35]=e("h4",null,"Chest Movement",-1))]),e("div",Da,[(s(!0),o(R,null,U(t.chestMovementAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"chest-move-"+D},E(y),1))),128))])])):t.chestMovementExamined?(s(),o("div",wa,[e("div",xa,[a(m,{icon:t.moveOutline},null,8,["icon"]),n[36]||(n[36]=e("h4",null,"Chest Movement",-1))]),n[37]||(n[37]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal movement ")],-1))])):S("",!0),t.heartSoundsAbnormal.length?(s(),o("div",Sa,[e("div",Ca,[a(m,{icon:t.pulseOutline},null,8,["icon"]),n[38]||(n[38]=e("h4",null,"Heart Sounds",-1))]),e("div",ka,[(s(!0),o(R,null,U(t.heartSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"heart-"+D},E(y),1))),128))])])):t.heartSoundsExamined?(s(),o("div",Ea,[e("div",Ia,[a(m,{icon:t.pulseOutline},null,8,["icon"]),n[39]||(n[39]=e("h4",null,"Heart Sounds",-1))]),n[40]||(n[40]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal heart sounds ")],-1))])):S("",!0),t.breathSoundsAbnormal.length?(s(),o("div",Aa,[n[41]||(n[41]=e("div",{class:"exam-category-header"},[e("h4",null,"Breath Sounds")],-1)),e("div",Pa,[(s(!0),o(R,null,U(t.breathSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"breath-"+D},E(y),1))),128))])])):t.breathSoundsExamined?(s(),o("div",Oa,n[42]||(n[42]=[e("div",{class:"exam-category-header"},[e("h4",null,"Breath Sounds")],-1),e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal breath sounds ")],-1)]))):S("",!0),t.addedBreathSoundsAbnormal.length?(s(),o("div",Na,[e("div",$a,[a(m,{icon:t.addOutline},null,8,["icon"]),n[43]||(n[43]=e("h4",null,"Added Breath Sounds",-1))]),e("div",La,[(s(!0),o(R,null,U(t.addedBreathSoundsAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"added-breath-"+D},E(y),1))),128))])])):t.addedBreathSoundsExamined?(s(),o("div",Ma,[e("div",Fa,[a(m,{icon:t.addOutline},null,8,["icon"]),n[44]||(n[44]=e("h4",null,"Added Breath Sounds",-1))]),n[45]||(n[45]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," No abnormal added sounds ")],-1))])):S("",!0),t.abdominalInspectionAbnormal.length?(s(),o("div",Ba,[e("div",Ra,[a(m,{icon:t.scanOutline},null,8,["icon"]),n[46]||(n[46]=e("h4",null,"Abdominal Inspection",-1))]),e("div",Ta,[(s(!0),o(R,null,U(t.abdominalInspectionAbnormal,(y,D)=>(s(),o("div",{class:"exam-item",key:"abdomen-"+D},E(y),1))),128))])])):t.abdominalInspectionExamined?(s(),o("div",Va,[e("div",Ha,[a(m,{icon:t.scanOutline},null,8,["icon"]),n[47]||(n[47]=e("h4",null,"Abdominal Inspection",-1))]),n[48]||(n[48]=e("div",{class:"exam-items"},[e("div",{class:"exam-item normal"}," Normal abdominal inspection ")],-1))])):S("",!0)])])):(s(),o("div",qa,[a(m,{icon:t.bodyOutline},null,8,["icon"]),n[49]||(n[49]=e("p",null,"No physical exam recorded",-1))]))])])}const Wa=de(as,[["render",Ua],["__scopeId","data-v-8cfdbcc7"]]),za=Q(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Spontaneously",value:"Spontaneously"},{label:"To speech",value:"To speech"},{label:"To pain",value:"To pain"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Oriented to time, place and person",value:"Oriented to time, place and person"},{label:"Confused",value:"Confused"},{label:"Inappropriate words",value:"Inappropriate words"},{label:"Incomprehensible sounds",value:"Incomprehensible sounds"},{label:"No response",value:"No response"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Obeys commands",value:"Obeys commands"},{label:"Moves to localised pain",value:"Moves to localised pain"},{label:"Flexion withdrawal from pain",value:"Flexion withdrawal from pain"},{label:"Abnormal flexion (decorticate)",value:"Abnormal flexion (decorticate)"},{label:"Abnormal extension (decerebrate)",value:"Abnormal extension (decerebrate)"},{label:"No response",value:"No response"}]}]),Ga=Q(()=>[{componentType:"radioButtonField",header:"Eye opening response",name:"Eye opening response",obsValueType:"value_coded",type:"inline",options:[{label:"Directed eye movements",value:"Directed eye movements"},{label:"Not directed",value:"Not directed"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best verbal response",name:"Best verbal response",obsValueType:"value_coded",type:"inline",options:[{label:"Appropriate cry",value:"Appropriate cry"},{label:"Inappropriate cry or moan",value:"Inappropriate cry or moan"},{label:"No cry",value:"No cry"}]},{componentType:"Dashes"},{componentType:"radioButtonField",header:"Best motor response",name:"Best motor response",obsValueType:"value_coded",type:"inline",options:[{label:"Localizes pain",value:"Localizes pain"},{label:"Withdraws from pain",value:"Withdraws from pain"},{label:"Non specific or no response",value:"Non specific or no response"}]}]),Ya={Spontaneously:4,"To speech":3,"To pain":2,"No response":1},ja={"Oriented to time, place and person":5,Confused:4,"Inappropriate words":3,"Incomprehensible sounds":2,"No response":1},Ka={"Obeys commands":6,"Moves to localised pain":5,"Flexion withdrawal from pain":4,"Abnormal flexion (decorticate)":3,"Abnormal extension (decerebrate)":2,"No response":1},Qa={"Not directed":0,"Directed eye movements":1},Ja={"Non specific or no response":0,"Withdraws from pain":1,"Localizes pain":2},Xa={"No cry":0,"Inappropriate cry or moan":1,"Appropriate cry":2},Za={class:"modal_wrapper"},eo=te({__name:"LevelOfConsciousness",setup(t,{expose:n}){var D,u;const v=Ne(),{patient:g}=Pe(v),w=c(Ue.getAgeInYears((u=(D=g==null?void 0:g.value)==null?void 0:D.personInformation)==null?void 0:u.birthdate)),C=c(null),m=Q(()=>{var Y,X,_,i;const h=((Y=C.value)==null?void 0:Y.getFormValues())||{},l=h["Eye opening response"]||"",V=h["Best motor response"]||"",P=h["Best verbal response"]||"",T=w.value<18,A=(X=(T?Qa:Ya)[l])!=null?X:0,L=(_=(T?Ja:Ka)[V])!=null?_:0,F=(i=(T?Xa:ja)[P])!=null?i:0,H=A+L+F;return"(M ".concat(L," V ").concat(F," E ").concat(A,") ").concat(H,"/").concat(T?5:15)});return n({onSubmit:async()=>{var l;if(!C.value){console.error("Form reference is not available");return}const h=((l=C.value)==null?void 0:l.getFormValues())||{};h["Eye opening response"]||h["Best motor response"]||h["Best verbal response"]?(await ee.buildAddObsToEncounterPatient(h,Se.ASSESSMENT),C.value.resetForm(),$e("Level of Consciousness saved successfully")):ue(" No level of consciousness data to save ")}}),(h,l)=>(s(),o("div",Za,[w.value<18?(s(),$(He,{key:0,formData:r(Ga),ref_key:"formRef",ref:C},null,8,["formData"])):(s(),$(He,{key:1,formData:r(za),ref_key:"formRef",ref:C},null,8,["formData"])),e("h5",null,E(m.value),1)]))}}),to={class:"modal_wrapper"},no=te({__name:"PregnancyBreastfeeding",setup(t,{expose:n}){const v=En(),{pregnancy:g}=Pe(v),w=()=>{};return n({onSubmit:async()=>{const m=await Ze(g.value);m.length>0?(await ee.addObsToEncounterPatient(m,Se.PREGNANCY_STATUS),$e("Pregnancy status saved successfully")):ue("No pregnancy status data to save ")}}),(m,y)=>(s(),o("div",to,[a(Xe,{contentData:r(g),"onUpdate:inputValue":w},null,8,["contentData"])]))}}),so={class:"modal_wrapper"},ao={class:"uniform_columns"},oo=te({__name:"PastMedicalHistory",setup(t,{expose:n}){const v=In(),{pastMedicalHistory:g}=Pe(v),w=c([]);Oe(()=>{w.value=v.getInitial(),C()}),_e(g,()=>{C()},{deep:!0});const C=()=>{var h;const u=["TB","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Epilepsy","Previous stroke","Peptic Ulcer Disease (PUD)","Mental disorder","Bleeding disorders","Hypertension","HIV Positive","Diabetes Mellitus"];(h=An(g.value,"None"))!=null&&h.checked?u.forEach(l=>{he(g.value,"TB treatment","displayNone",!0),De(g.value,"TB drugs","displayNone",!0),De(g.value,"TB drug start date","displayNone",!0),he(g.value,"Hypertension medication","displayNone",!0),De(g.value,"Current hypertension treatment regimen","displayNone",!0),he(g.value,"HIV status","displayNone",!0),De(g.value,"ARV start date","displayNone",!0),he(g.value,"Diabetes","displayNone",!0),he(g.value,"Controlled by","displayNone",!0),ge(g.value,l,"checked",!1),ge(g.value,l,"disabled",!0)}):u.forEach(l=>{ge(g.value,l,"disabled",!1)})},m=u=>{De(g.value,"TB drugs","popOverData",{filterData:!0,data:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"},{name:"Cycloserine 125mg"},{name:"Cycloserine 250mg"},{name:"Delamanid 50mg"},{name:"Ethambutol 100mg"},{name:"Ethambutol 400mg"},{name:"Ethionamide 250mg"},{name:"Isoniazid 100mg "},{name:"Isoniazid 300mg"},{name:"Isoniazid / Rifapentine 300mg / 300mg"},{name:"Levofloxacin 100mg"},{name:"Levofloxacin 250mg"},{name:"Linezolid 600mg"},{name:"Moxifloxacin 400mg"},{name:"Pyrazinamide 400mg"},{name:"Rifabutin 150mg Capsules"},{name:"Rifampicin 150mg/isoniazid 75mg"},{name:"Rifampicin 75mg+INH 50mg dispersible"},{name:"Rifampicin 75mg+INH 50mg+Pyrazinamide 150mg dispersible"},{name:"Rifampicin150mg/Isoniazid75mg/Pyrazinamide 400mg/Ethambutol"}]}),De(g.value,"Current hypertension treatment regimen","popOverData",{filterData:!0,data:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}]})},y=async()=>[...await kt(g.value),...await Ze(g.value),...await Et(g.value)];return n({onSubmit:async()=>{const u=await y();if(u.length===0){ue("No past medical history data to save");return}await ee.addObsToEncounterPatient(u,Se.PAST_MEDICAL_HISTORY),$e("Past medical history saved successful")}}),(u,h)=>(s(),o("div",so,[e("div",ao,[a(Xe,{contentData:r(g),initialData:w.value,"onUpdate:inputValue":m,"onUpdate:selected":m},null,8,["contentData","initialData"])])]))}}),io=de(oo,[["__scopeId","data-v-49fdce72"]]),lo={class:"container"},ro=te({__name:"PhysicalExamination",setup(t,{expose:n}){const v=Pn(),g=Ne(),{physicalExam:w}=Pe(v),{patient:C}=Pe(g),m=c([]);Oe(()=>{m.value=v.getInitial(),y(),D()}),_e(w,()=>{y(),D()},{deep:!0});const y=()=>{On(w.value,"Physical examination")=="No"?he(w.value,"Reason why physical examination not done","displayNone",!1):(he(w.value,"Reason why physical examination not done","displayNone",!0),he(w.value,"Reason why physical examination not done","selectedValue",""))},D=()=>{var V,P;const l=(P=(V=C.value)==null?void 0:V.personInformation)==null?void 0:P.gender;l=="M"&&(ge(w.value,"Vulva examination","disabled",!0),ge(w.value,"Visible bleeding","disabled",!0)),l=="F"&&(ge(w.value,"Urethral meatus abnormal","disabled",!0),ge(w.value,"Scrotal swelling","disabled",!0),ge(w.value,"Tastes swelling","disabled",!0))},u=async()=>[...await kt(w.value),...await Ze(w.value),...await Et(w.value)];return n({onSubmit:async()=>{const l=await u();if(l.length===0){ue("No physical examination data to save");return}await ee.addObsToEncounterPatient(l,Se.PHYSICAL_EXAMINATION),$e("Diagnosis saved successful")}}),(l,V)=>{const P=J("ion-card-content"),T=J("ion-card");return s(),o("div",lo,[a(T,{class:"section"},{default:d(()=>[a(P,null,{default:d(()=>[a(Xe,{contentData:r(w),initialData:m.value},null,8,["contentData","initialData"])]),_:1})]),_:1})])}}}),uo=de(ro,[["__scopeId","data-v-3818e796"]]),co={key:0},mo={class:"ion-padding",slot:"content"},po={class:"nav-buttons"},vo={class:"ion-padding",slot:"content"},fo={class:"nav-buttons"},ho={class:"ion-padding",slot:"content"},go={class:"nav-buttons"},_o={class:"ion-padding",slot:"content"},yo={class:"nav-buttons"},bo={class:"ion-padding",slot:"content"},Do={class:"nav-buttons"},wo={class:"ion-padding",slot:"content"},xo={class:"nav-buttons"},So=te({__name:"ClinicalAssessment",setup(t,{expose:n}){const v=c("loc"),g=c(0),w=new Nn,C=Ne(),m=()=>{g.value++},y=c(null),D=c(null),u=c(null),h=c(null),l=c(null),V=c(null),P=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>w.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}],T=Q(()=>{const _=C.patient;if(!_)return!1;const k=new Date().toISOString().split("T")[0];return["levelOfConsciousness","presentingComplaints","pastMedicalHistory","physicalExam","allergies","pregnancy"].some(I=>{var z,Z;return[...((z=_[I])==null?void 0:z.saved)||[],...((Z=_[I])==null?void 0:Z.unsaved)||[]].some(ne=>ne.obs_datetime?new Date(ne.obs_datetime).toISOString().split("T")[0]===k:!1)})}),A=Q(()=>P.filter(_=>typeof _.show=="function"?_.show():_.show)),L=_=>{const i=P.find(k=>k.id===_);return i?typeof i.show=="function"?i.show():i.show:!1},F=_=>A.value.findIndex(i=>i.id===_),H=_=>{const i=F(_);i>0&&(v.value=A.value[i-1].id)},Y=_=>{const k=F(_)+1;k<A.value.length?v.value=A.value[k].id:(v.value="",m())};return n({onSubmit:async()=>{const _=[{ref:y,name:"PresentingComplaints"},{ref:D,name:"LevelOfConsciousness"},{ref:u,name:"PastMedicalHistory"},{ref:l,name:"PregnancyBreastfeeding"},{ref:V,name:"PhysicalExamination"}];for(const i of _)if(i.ref.value&&typeof i.ref.value.onSubmit=="function")try{await i.ref.value.onSubmit()}catch(k){console.error("Error calling ".concat(i.name," onSubmit:"),k)}else console.log("".concat(i.name," component ref not available or no onSubmit method"))}}),(_,i)=>T.value?(s(),o("div",co,[(s(),$(Wa,{key:g.value}))])):(s(),$(r(hn),{key:1,style:{width:"100%"}},{default:d(()=>[a(r(Be),{value:v.value,"onUpdate:value":i[12]||(i[12]=k=>v.value=k),ref:"accordionGroup",class:"previousView"},{default:d(()=>[L("loc")?(s(),$(r(ce),{key:0,value:"loc",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[13]||(i[13]=[O("Level of consciousness")])),_:1,__:[13]})]),_:1}),e("div",mo,[a(eo,{"is-active":v.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:D,onDataSaved:m},null,8,["is-active"]),e("div",po,[F("loc")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[0]||(i[0]=re(k=>H("loc"),["stop"]))},{default:d(()=>i[14]||(i[14]=[O(" Back ")])),_:1,__:[14]})):S("",!0),a(r(le),{fill:"outline",onClick:i[1]||(i[1]=re(k=>Y("loc"),["stop"]))},{default:d(()=>[O(E(F("loc")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pc")?(s(),$(r(ce),{key:1,value:"pc",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[15]||(i[15]=[O("Presenting complaints")])),_:1,__:[15]})]),_:1}),e("div",vo,[a(ss,{"is-active":v.value==="pc",onDataSaved:m,ref_key:"presentingComplaintsFormRef",ref:y},null,8,["is-active"]),e("div",fo,[F("pc")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[2]||(i[2]=re(k=>H("pc"),["stop"]))},{default:d(()=>i[16]||(i[16]=[O(" Back ")])),_:1,__:[16]})):S("",!0),a(r(le),{fill:"outline",onClick:i[3]||(i[3]=re(k=>Y("pc"),["stop"]))},{default:d(()=>[O(E(F("pc")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pbs")?(s(),$(r(ce),{key:2,value:"pbs",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[17]||(i[17]=[O("Pregnancy and breastfeeding status")])),_:1,__:[17]})]),_:1}),e("div",ho,[a(no,{"is-active":v.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:l,onDataSaved:m},null,8,["is-active"]),e("div",go,[F("pbs")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[4]||(i[4]=re(k=>H("pbs"),["stop"]))},{default:d(()=>i[18]||(i[18]=[O(" Back ")])),_:1,__:[18]})):S("",!0),a(r(le),{fill:"outline",onClick:i[5]||(i[5]=re(k=>Y("pbs"),["stop"]))},{default:d(()=>[O(E(F("pbs")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pmh")?(s(),$(r(ce),{key:3,value:"pmh",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[19]||(i[19]=[O("Past medical history")])),_:1,__:[19]})]),_:1}),e("div",_o,[a(io,{"is-active":v.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:u,onDataSaved:m},null,8,["is-active"]),e("div",yo,[F("pmh")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[6]||(i[6]=re(k=>H("pmh"),["stop"]))},{default:d(()=>i[20]||(i[20]=[O(" Back ")])),_:1,__:[20]})):S("",!0),a(r(le),{fill:"outline",onClick:i[7]||(i[7]=re(k=>Y("pmh"),["stop"]))},{default:d(()=>[O(E(F("pmh")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("al")?(s(),$(r(ce),{key:4,value:"al",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[21]||(i[21]=[O("Allergies")])),_:1,__:[21]})]),_:1}),e("div",bo,[a(Tn,{"is-active":v.value==="al",ref_key:"allergiesFormRef",ref:h,onDataSaved:m},null,8,["is-active"]),e("div",Do,[F("al")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[8]||(i[8]=re(k=>H("al"),["stop"]))},{default:d(()=>i[22]||(i[22]=[O(" Back ")])),_:1,__:[22]})):S("",!0),a(r(le),{fill:"outline",onClick:i[9]||(i[9]=re(k=>Y("al"),["stop"]))},{default:d(()=>[O(E(F("al")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0),L("pe")?(s(),$(r(ce),{key:5,value:"pe",class:"_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>i[23]||(i[23]=[O("Physical examination")])),_:1,__:[23]})]),_:1}),e("div",wo,[a(uo,{"is-active":v.value==="pe",ref_key:"physicalExaminationFormRef",ref:V,onDataSaved:m},null,8,["is-active"]),e("div",xo,[F("pe")>0?(s(),$(r(le),{key:0,fill:"outline",onClick:i[10]||(i[10]=re(k=>H("pe"),["stop"]))},{default:d(()=>i[24]||(i[24]=[O(" Back ")])),_:1,__:[24]})):S("",!0),a(r(le),{fill:"outline",onClick:i[11]||(i[11]=re(k=>Y("pe"),["stop"]))},{default:d(()=>[O(E(F("pe")<A.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):S("",!0)]),_:1},8,["value"])]),_:1}))}}),Ni=de(So,[["__scopeId","data-v-a8c21622"]]);class Co extends ct{constructor(n,v){super(n,8,v)}static async getDiagnosis(n="",v=1,g=10){const w=await j.getConceptID("Qech outpatient diagnosis list");return ct.getJson("diagnosis",{id:w,name:n,page:v,page_size:g})}}const ko=te({name:"Menu",components:{IonContent:ht,IonHeader:ft,IonItem:K,IonList:Ae,IonMenu:vt,IonTitle:pt,IonToolbar:mt,List:qe},computed:{...Ve(Ne,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:wt(["#006401"]),listIcon:Dt(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:gt,pulseOutline:Je}},async mounted(){const t=await ee.getAll(this.patient.patientID,"Primary diagnosis"),n=await ee.getAll(this.patient.patientID,"Secondary diagnosis"),v=await ee.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),g=[...t||[],...n||[],...v||[]],w=fe.isEmpty(g)?[]:Promise.all(g.map(async C=>({name:await ee.getConceptName(C.value_coded),obs_date:C.obs_datetime})));this.setListData(await w)},methods:{dismiss(){gn.dismiss()},handleIcon(){},setActivClass(t){this.activeHeight="",this.activeBMI="",this.activeWeight="",t=="height"?this.activeHeight="_active":t=="weight"?this.activeWeight="_active":t=="BMI"&&(this.activeBMI="_active")},setListData(t){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),t.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[Ue.toStandardHisFormat(n.obs_date),n.name,""]})})}}}),Eo={class:"modal_wrapper"};function Io(t,n,v,g,w,C){const m=J("list");return s(),o("div",Eo,[e("div",null,[a(m,{listData:t.list},null,8,["listData"])])])}const Ao=de(ko,[["render",Io],["__scopeId","data-v-88580898"]]),Po={class:"custom_card",style:{padding:"10px"}},Oo={key:0},No={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},$o={class:"ion-padding",slot:"content"},Lo=te({__name:"OPDDiagnosis",setup(t,{expose:n}){const v=Ie,g=c(!0),w=c(!1),C=c(!0),m=c(!1),y=c(!0),D=c(""),u=c(""),h=c([]),l=c([]),V=c(),P=c(null);$n();const T=Q(()=>l.value.some(b=>b.data.concept_id===6542));_e(l,()=>{i()},{deep:!0});const A=Q(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:h.value,icon:v.search,onSearchChange:X,validation:Re.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:h.value,icon:v.search,condition:b=>b==null?void 0:b.secondaryDiagnosisCheckbox,onSearchChange:X,validation:(b,I)=>L(I,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:h.value,icon:v.search,isMultiple:!0,condition:b=>b==null?void 0:b.differentialDiagnosisCheckbox,onSearchChange:X,validation:(b,I)=>L(I,"differentialDiagnosis")}]),L=(b,I)=>{var se,q,ye;if(!b)return null;const M=(se=b.primaryDiagnosis)==null?void 0:se.name,z=((q=b.secondaryDiagnosis)==null?void 0:q.map(me=>me.name))||[],Z=((ye=b.differentialDiagnosis)==null?void 0:ye.map(me=>me.name))||[];if(I==="secondaryDiagnosis"&&z.includes(M)||I==="differentialDiagnosis"&&Z.includes(M))return"".concat(M," is already the primary diagnosis");const ne=z.find(me=>Z.includes(me));return ne?"".concat(ne," cannot be both secondary and differential"):null},F=()=>{u.value="",D.value="",g.value=!1,y.value=!1,w.value=!0},H=async()=>{var b;((b=P.value)==null?void 0:b.validateForm())==null&&(Y(),w.value=!1,m.value=!0,y.value=!0,C.value=!1)},Y=()=>{var se;const b=[],I=l.value.map(q=>q.name),M=((se=P.value)==null?void 0:se.getFormValues())||{},z=M.primaryDiagnosis||[],Z=M.secondaryDiagnosis||[],ne=M.differentialDiagnosis||[];if(z.name&&!I.includes(z.name))if(!l.value.some(ye=>ye.data.concept_id===6542))b.push({actionBtn:!0,btn:["delete"],name:z.name,id:z.concept_id,display:[z.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:z.concept_id,obs_datetime:xe.getSessionDate()}});else return Ln("Only one primary diagnosis is allowed"),!1;return Z&&Z.forEach(q=>{I.includes(q.name)||b.push({actionBtn:!0,btn:["delete"],name:q.name,id:q.concept_id,display:[q.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:q.concept_id,obs_datetime:xe.getSessionDate()}})}),ne&&ne.forEach(q=>{I.includes(q.name)||b.push({actionBtn:!0,btn:["delete"],name:q.name,id:q.concept_id,display:[q.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:q.concept_id,obs_datetime:xe.getSessionDate()}})}),b.length>0&&(l.value=[...l.value,...b]),!0},X=async b=>{const I=b.trim().toLowerCase()||"";return h.value=await Co.getDiagnosis(I,1,15),h.value},_=b=>{const I=l.value,M=b.name,z=I.filter(Z=>Z.display[0]!==M);l.value=z},i=()=>{l.value.length>0?(m.value=!0,g.value=!1):w.value||(g.value=!0),y.value=!T.value},k=async()=>{if(l.value.length<=0){ue("Diagnosis not saved");return}const b=l.value.flatMap(M=>M.data);if(b.length<=0)return ue("Diagnosis not saved");const I=await ee.addObsToEncounter(b,Se.DIAGNOSIS);await ee.mergeObsToPatient(I),$e("Diagnosis saved successful"),l.value=[]};return Oe(async()=>{i(),await X("")}),n({onSubmit:k}),(b,I)=>{const M=J("ion-row"),z=J("ion-label"),Z=J("ion-accordion"),ne=J("ion-accordion-group");return s(),o(R,null,[e("div",Po,[a(Ct,{status:g.value,content:"No Diagnosis added"},null,8,["status"]),m.value?(s(),o("span",Oo,[a(qe,{listData:l.value,"onClicked:delete":_},null,8,["listData"]),T.value?(s(),o("div",No," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):S("",!0)])):S("",!0),w.value?(s(),$(M,{key:1},{default:d(()=>{var se;return[e("div",null,[a(He,{formData:A.value,ref_key:"formRef",ref:P},null,8,["formData"])]),e("div",null,[a(we,{fill:"clear",icon:r(v).plus,iconSlot:"icon-only","onClicked:btn":I[0]||(I[0]=q=>H()),name:"Save",disabled:(se=P.value)==null?void 0:se.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):S("",!0),y.value?(s(),$(M,{key:2,style:{"margin-top":"10px"}},{default:d(()=>[a(we,{fill:"clear",icon:r(v).plus,iconSlot:"icon-only","onClicked:btn":I[1]||(I[1]=se=>F()),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):S("",!0)]),a(M,null,{default:d(()=>[a(ne,{ref_key:"accordionGroup",ref:V,class:"previousView"},{default:d(()=>[a(Z,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(z,{class:"previousLabel"},{default:d(()=>I[2]||(I[2]=[O("Previous Diagnosis")])),_:1,__:[2]})]),_:1}),e("div",$o,[a(Ao)])]),_:1})]),_:1},512)]),_:1})],64)}}}),$i=de(Lo,[["__scopeId","data-v-cdf4ce7e"]]),Mo={class:"allergies-section"},Fo={class:"allergies-container"},Bo={key:0,class:"allergies-grid"},Ro={key:1,class:"no-allergies"},To={class:"ion-padding",slot:"content"},Vo={key:0},Ho={class:"previousSecDrgs"},qo={class:"ion-padding",slot:"content"},Uo={class:"previousSecDrgs"},Wo={class:"medication-section"},zo={class:"medication-content"},Go={key:0,class:"add-medication-form"},Yo={class:"form-group"},jo={class:"option-label"},Ko={key:0,class:"error-message"},Qo={class:"form-row"},Jo={class:"form-group"},Xo={key:0,class:"error-message"},Zo={class:"form-group"},ei={key:0,class:"error-message"},ti={class:"form-group"},ni={key:0,class:"error-message"},si={class:"action-buttons"},ai={class:"notes-section"},oi={class:"notes-content"},ii={class:"notes-input-container"},li={class:"ion-padding",slot:"content"},ri={class:"notes-timeline"},ui={class:"note-date"},ci={class:"note-content"},di={class:"ion-padding",slot:"content"},mi={class:"note-date"},pi={class:"note-content"},vi=te({watch:{},name:"xxxComponent"}),fi=te({...vi,setup(t){const n=Ie,v=Un,g=c(!1),w=c(!1),C=c(!0),m=c(0),y=c(""),D=c(!1),u=c(""),h=c(!1),l=c(),V=c(!1),P=c(""),T=c(""),A=c(""),L=c(""),F=c(""),H=c("");c(!1);const Y="Add new medication",X="clear";c("Show more medications");const _=ke(),i=St(),k=Q(()=>i.selectedMedicalAllergiesList),b=Q(()=>_.selectedMedicalDrugsList),I=Q(()=>_.partialOPDdrugList),M=Q(()=>_.nonPharmalogicalTherapyAndOtherNotes),z=["first","second","third"],Z=c(),ne=c(),se=c(),q=c(!1),ye=c(!1),me=c(!1),We=c("Show more notes"),ze=c("Show more allergies"),et=c(),tt=c(),Ce=c(),Te=Q(()=>_.editingDrugItem),It=c("Select a route"),Ge=c(!1),At=c("Select frequency"),Ye=c(!1),Pt=c("Select drug"),je=c(!1),ae=c(),oe=c(),pe=c(),Le=c([]),Ot=c([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),Nt=Q(()=>Le.value.length?Le.value:Ot.value);function $t(f){ae.value=f}async function Lt(){return await Wn()}async function Mt(f=5,p=1e3){let N=0;for(;N<f&&(Le.value=await Lt(),!(Le.value.length>0));)N++,await new Promise(W=>setTimeout(W,p));Le.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}Oe(async()=>{const f=new Vn,{previousDrugPrescriptions:p,previousClinicalNotes:N,previousDrugAllergies:W}=await f.getPatientEncounters();Z.value=p,ne.value=Object.entries(N)[0];const[,...x]=Object.entries(N);se.value=x,et.value=Object.entries(W)[0];const[,...B]=Object.entries(W);tt.value=B,await Mt()}),_e(()=>P.value,async f=>{nt()}),_e(()=>T.value,async f=>{Vt()}),_e(()=>A.value,async f=>{st()});function Ft(){if(fe.isEmpty(ae.value)==!0)return Ge.value=!0,!1;if(fe.isEmpty(ae.value)==!1)return Ge.value=!1,!0}function Bt(){if(fe.isEmpty(oe.value)==!0)return Ye.value=!0,!1;if(fe.isEmpty(oe.value)==!1)return Ye.value=!1,!0}function Rt(){if(fe.isEmpty(pe.value)==!0)return je.value=!0,!1;if(fe.isEmpty(pe.value)==!1)return je.value=!1,!0}function Tt(){C.value=!C.value,g.value=!0,h.value=!1,V.value=!1}async function nt(){const f=await Wt();return console.log({drugNameExists:f}),f?D.value=!1:(y.value="please select a valid drug name",D.value=!0),D.value}async function Vt(){return it(T.value)?h.value=!1:(u.value="please enter a number",h.value=!0),h.value}async function st(){return it(A.value)?V.value=!1:(l.value="please enter a number",V.value=!0),V.value}async function at(){const f=await nt(),p=await st(),N=Bt(),W=Rt(),x=Ft();return!f&&!p&&N==!0&&W==!0&&x==!0}function Ht(f){oe.value=f}async function ot(){const f=()=>Ce.value.dose_strength!=null&&Ce.value.dose_strength?Math.trunc(Ce.value.dose_strength):1;if(Te.value!==null){if(!await at()){ue("Please enter correct data values",4e3);return}const N=xe.getSessionDate(),W=lt(N,parseInt(A.value));let x=!1;Ke(Ce.value)==!0&&(x=!0);const B={drugName:P.value,dose:f(),frequency:oe.value.label,frequency_code:oe.value.code,duration:A.value,prescription:W,drug_id:H.value,units:F.value,route_concept_id:ae.value.concept_id,route_name:ae.value.name,highlightbackground:x},ie=ke();console.log(ie.setSelectedMedicalDrugsList([B])),ie.editingDrugItem=null,C.value=!0}else{if(!await at()){ue("Please enter correct data values",4e3);return}Xt();const N=xe.getSessionDate(),W=lt(N,parseInt(A.value));let x=!1;Ke(Ce.value)==!0&&(x=!0);const B={drugName:P.value,dose:f(),frequency:oe.value.label,frequency_code:oe.value.code,duration:A.value,prescription:W,drug_id:H.value,units:F.value,route_concept_id:ae.value.concept_id,route_name:ae.value.name,highlightbackground:x};ke().setSelectedMedicalDrugsList([B])}H.value="",P.value="",T.value="",oe.value=null,A.value="",L.value="",m.value++,pe.value=null,ae.value=null}async function qt(f){const p=f,x=await dt.getOfflineOPDDrugs({name:p,page:1,page_size:10});x.map(B=>({label:B.name,value:B.name,other:B})),_.setPartialOPDdrugList(x)}async function Ut(f){let p;f.target===void 0?p=f:p=f.target.value;const x=await dt.getOPDDrugs({name:encodeURIComponent(p),page:1,page_size:10});return x.map(B=>({label:B.name,value:B.name,other:B})),x}function Ke(f){const p=[];return k.value.forEach(W=>{W.selected&&p.push(W.concept_id)}),zt([f],p)==!0?(ue("Client is allergic to the selected medication",4e6),!0):!1}async function Wt(){return(await Ut(P.value)).length>0?P.value.length!=0:!1}function zt(f,p){try{return f.some(N=>p.includes(N.concept_id))}catch(N){return!1}}function Gt(f){f&&(P.value=f.name,H.value=f.drug_id,F.value=f.units,Ce.value=f,Ke(f))}function Yt(f){const p=b.value[f],N=ke();N.removeDrugById(p.drug_id),N.editingDrugItem=p,H.value="",P.value="",T.value="",oe.value=null,A.value="",L.value="",pe.value=null,ae.value=null,H.value=p.drug_id,P.value=p.drugName,T.value=p.dose,oe.value={label:p.frequency,code:p.frequency_code},A.value=p.duration,L.value=p.prescription;const W=I.value.find(x=>x.name===p.drugName);W&&(pe.value=W),ae.value={concept_id:p.route_concept_id,name:p.route_name},C.value=!1,m.value++}function jt(){if(Te.value!==null){H.value="",P.value="",T.value="",oe.value=null,A.value="",L.value="",pe.value=null,ae.value=null;const f=ke();f.setSelectedMedicalDrugsList([Te.value]),f.editingDrugItem=null}C.value=!0,m.value++}function Kt(f){b.value.splice(f,1),m.value++,ue("you have removed a drug from list",6e3)}function Qt(f){let p=f.target.value;Jt(p)}function Jt(f){ke().setNonPharmalogicalTherapyAndOtherNotes(f)}function it(f){return/^[0-9]+$/.test(f)}function lt(f,p){const N=new Date(f);N.setDate(N.getDate()+p);const W=N.getFullYear(),x=String(N.getMonth()+1).padStart(2,"0"),B=String(N.getDate()).padStart(2,"0");return"".concat(W,"-").concat(x,"-").concat(B)}function Xt(){g.value=!1,w.value=!0,C.value=!0}function Zt(f){z.filter(N=>N!==f.detail.value);const p=f.detail.value;p!==void 0?p=="third"&&(We.value="Show less notes",ye.value=!q.value):(We.value="Show more notes",ye.value=!q.value)}function en(f){z.filter(N=>N!==f.detail.value);const p=f.detail.value;p!==void 0?p=="fith"&&(ze.value="Show less allegies",me.value=!q.value):(ze.value="Show more allegies",me.value=!q.value)}function rt(f){return f[1]}function tn(f){(f.key==="Enter"||f.key==="ArrowDown")&&(f.preventDefault(),ot())}const ve=Q(()=>[{showAddItemButton:!0,addItemButton:!0,name:Te.value!==null?"Update":"ADD",btnFill:"clear",fn:ot},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",btnFill:"clear",fn:jt}]);return(f,p)=>{const N=J("ion-chip"),W=J("ion-text");return s(),$(r(Ae),null,{default:d(()=>[e("div",Mo,[a(r(G),{class:"section-title"},{default:d(()=>[a(r(Ee),{icon:r(bt),class:"alert-icon"},null,8,["icon"]),a(r(G),null,{default:d(()=>p[9]||(p[9]=[O("Allergies (Medication, Healthcare items, Environment and Food)")])),_:1,__:[9]})]),_:1}),e("div",Fo,[k.value.some(x=>x.selected)?(s(),o("div",Bo,[(s(!0),o(R,null,U(k.value,(x,B)=>_n((s(),o("div",{key:B,class:"allergy-item"},[a(N,{class:"allergy-chip",color:"danger"},{default:d(()=>[a(r(G),null,{default:d(()=>[O(E(x.name),1)]),_:2},1024),a(r(Ee),{icon:r(yn)},null,8,["icon"])]),_:2},1024)])),[[bn,x.selected]])),128))])):(s(),o("div",Ro,[a(W,{style:{"font-size":"16px","font-weight":"600",color:"#9c8011"}},{default:d(()=>p[10]||(p[10]=[O("No allergies recorded")])),_:1,__:[10]})])),a(r(Be),{ref:"accordionGroup",class:"previousView"},{default:d(()=>[a(r(ce),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"previousLabel"},{default:d(()=>p[11]||(p[11]=[O("Documented allergies timeline")])),_:1,__:[11]})]),_:1}),e("div",To,[(s(!0),o(R,null,U(et.value,(x,B)=>(s(),o("div",{class:"ionLbltp",key:B},[B==1?(s(),o("div",Vo,[e("div",null,[a(r(G),{class:"previousLabelDate"},{default:d(()=>[O(E(x[0].date),1)]),_:2},1024)]),(s(!0),o(R,null,U(x,(ie,be)=>(s(),o("div",{key:be},[e("div",Ho,[a(r(Ae),null,{default:d(()=>[a(r(G),{class:"notes_p"},{default:d(()=>[O(E(ie.value),1)]),_:2},1024)]),_:2},1024)])]))),128))])):S("",!0)]))),128)),a(r(Be),{onIonChange:en},{default:d(()=>[a(r(ce),{value:"fith","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:d(()=>[a(r(K),{slot:"header",color:"light"},{default:d(()=>[a(r(G),{class:"",color:"primary"},{default:d(()=>[O(E(ze.value),1)]),_:1})]),_:1}),e("div",qo,[(s(!0),o(R,null,U(tt.value,(x,B)=>(s(),o("div",{class:"ionLbltp",key:B},[e("div",null,[a(r(G),{class:"previousLabelDate"},{default:d(()=>[O(E(x[0]),1)]),_:2},1024)]),(s(!0),o(R,null,U(rt(x),(ie,be)=>(s(),o("div",{key:be},[e("div",Uo,[a(r(Ae),null,{default:d(()=>[a(r(G),{class:"notes_p"},{default:d(()=>[O(E(ie.value),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)])]),e("div",Wo,[a(r(K),{lines:"none",class:"section-header"},{default:d(()=>[a(r(Ee),{icon:r(yt),class:"section-icon"},null,8,["icon"]),a(r(G),{class:"section-title",style:{"margin-top":"12px"}},{default:d(()=>p[12]||(p[12]=[O("Medication")])),_:1,__:[12]})]),_:1}),e("div",zo,[(s(),$(Hn,{_selectedMedicalDrugsList:b.value,onEditItem:Yt,onRemoveItem:Kt,key:m.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),C.value?S("",!0):(s(),o("div",Go,[e("div",Yo,[p[13]||(p[13]=e("label",{class:"input-label"},"Medication",-1)),a(r(Qe),{modelValue:pe.value,"onUpdate:modelValue":[p[0]||(p[0]=x=>pe.value=x),p[1]||(p[1]=x=>Gt(x))],options:I.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:p[2]||(p[2]=x=>qt(x))},{option:d(x=>[e("div",jo,E(x.option.name),1)]),_:1},8,["modelValue","options"]),je.value?(s(),o("div",Ko,E(Pt.value),1)):S("",!0)]),e("div",Qo,[e("div",Jo,[p[14]||(p[14]=e("label",{class:"input-label"},"Route",-1)),a(r(Qe),{modelValue:ae.value,"onUpdate:modelValue":[p[3]||(p[3]=x=>ae.value=x),p[4]||(p[4]=x=>$t(x))],options:Nt.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id"},null,8,["modelValue","options"]),Ge.value?(s(),o("div",Xo,E(It.value),1)):S("",!0)]),e("div",Zo,[p[15]||(p[15]=e("label",{class:"input-label"},"Frequency",-1)),a(r(Qe),{modelValue:oe.value,"onUpdate:modelValue":[p[5]||(p[5]=x=>oe.value=x),p[6]||(p[6]=x=>Ht(x))],options:r(v),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),Ye.value?(s(),o("div",ei,E(At.value),1)):S("",!0)]),e("div",ti,[p[16]||(p[16]=e("label",{class:"input-label"},"Duration (days)",-1)),a(r(Dn),{modelValue:A.value,"onUpdate:modelValue":p[7]||(p[7]=x=>A.value=x),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:tn},null,8,["modelValue"]),V.value?(s(),o("div",ni,E(l.value),1)):S("",!0)])]),e("div",si,[ve.value[0].addItemButton?(s(),$(we,{key:0,name:ve.value[0].name,fill:ve.value[0].btnFill,icon:r(wn),"onClicked:btn":ve.value[0].fn,class:"save-button"},null,8,["name","fill","icon","onClicked:btn"])):S("",!0),ve.value[1].addItemButton?(s(),$(we,{key:1,name:ve.value[1].name,fill:ve.value[1].btnFill,icon:r(xn),"onClicked:btn":ve.value[1].fn,class:"cancel-button"},null,8,["name","fill","icon","onClicked:btn"])):S("",!0)])])),C.value?(s(),$(we,{key:1,name:Y,fill:X,icon:r(_t),"onClicked:btn":Tt,class:"add-new-button"},null,8,["icon"])):S("",!0)])]),e("div",ai,[a(r(K),{lines:"none",class:"section-header"},{default:d(()=>[a(r(Ee),{icon:r(Sn),class:"section-icon"},null,8,["icon"]),a(r(G),{class:"section-title"},{default:d(()=>p[17]||(p[17]=[O("Non-pharmacological therapy and other notes")])),_:1,__:[17]})]),_:1}),e("div",oi,[a(qn,{class:"intervention-component"}),e("div",ii,[a(r(K),{class:"notes-input-item"},{default:d(()=>[a(r(Ee),{slot:"start",icon:r(n).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),a(r(Cn),{modelValue:M.value,"onUpdate:modelValue":p[8]||(p[8]=x=>M.value=x),onIonInput:Qt,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),a(r(Be),{ref:"accordionGroup",class:"previous-notes"},{default:d(()=>[a(r(ce),{value:"fourth","toggle-icon-slot":"start"},{default:d(()=>[a(r(K),{slot:"header",color:"light",class:"previous-notes-header"},{default:d(()=>[a(r(G),null,{default:d(()=>p[18]||(p[18]=[O("Previous visit notes")])),_:1,__:[18]})]),_:1}),e("div",li,[e("div",ri,[f.index===1?(s(!0),o(R,{key:0},U(ne.value,(x,B)=>(s(),o("div",{key:B,class:"note-entry"},[(s(!0),o(R,null,U(x,(ie,be)=>(s(),o("div",{key:be},[e("div",ui,E(ie.date),1),e("div",ci,E(ie.notes),1)]))),128))]))),128)):S("",!0),a(r(Be),{onIonChange:Zt},{default:d(()=>[a(r(ce),{value:"third","toggle-icon-slot":"start"},{default:d(()=>[a(r(K),{slot:"header",color:"light",class:"show-more-header"},{default:d(()=>[a(r(G),{color:"primary"},{default:d(()=>[O(E(We.value),1)]),_:1})]),_:1}),e("div",di,[(s(!0),o(R,null,U(se.value,(x,B)=>(s(),o("div",{key:B,class:"note-entry"},[(s(!0),o(R,null,U(rt(x),(ie,be)=>(s(),o("div",{key:be},[e("div",mi,E(ie.date),1),e("div",pi,E(ie.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1})}}}),Li=de(fi,[["__scopeId","data-v-e5aea6dd"]]),hi={class:"dash_box"},gi={key:1},_i=te({name:"xxxComponent"}),yi=te({..._i,setup(t){const n=c("No outcome created yet"),v=c(!1),g=c("please select a type");c("Add new outcome"),c(!0);const w=c(!0),C=c(""),m=c(!0),y=c(!1),D=Mn(),u=Q(()=>D.outcomes),h=c(!1),l=c(!1),V=c(!1),P=c(!1),T=c(!1);c(null),c(null);const A=c([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]),L=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:A.value,listUpdatedFN:F,listFilteredFN:()=>{},use_internal_filter:!0,disabled:c(!1)}];function F(b){A.value=b,A.value.forEach(I=>{I.selected==!0&&(C.value=I.name)})}Oe(async()=>{Y()}),_e(()=>C.value,async b=>{h.value==!0?h.value=!1:i()}),_e(()=>u.value.length,async b=>{Y()});function H(){A.value.forEach(b=>{b.selected=!1}),C.value=""}function Y(){u.value.length>0?m.value=!1:u.value.length==0&&y.value==!1&&(m.value=!0)}function X(b){u.value.splice(b,1)}const _=b=>{};async function i(b=!0){const I=C.value;console.log(I),C.value=I;const M=C.value;M==A.value[0].name?V.value=!0:V.value=!1,M==A.value[1].name?(P.value=!0,console.log("show_discharged_options is set to true")):P.value=!1,M==A.value[2].name?(T.value=!0,console.log("show_discharged_options is set to true")):T.value=!1}function k(){l.value=!1,V.value=!1,P.value=!1,T.value=!1,H()}return(b,I)=>{const M=J("ion-row");return s(),$(r(Ae),null,{default:d(()=>[a(M,null,{default:d(()=>[a(r(ut),null,{default:d(()=>[(s(),$(zn,{key:0,"onUpdate:removeItem":X,"onUpdate:editItem":_,displayData:u.value},null,8,["displayData"]))]),_:1})]),_:1}),m.value?(s(),$(M,{key:0},{default:d(()=>[e("span",hi,E(n.value),1)]),_:1})):S("",!0),w.value?(s(),o("div",gi,[a(M,null,{default:d(()=>[a(r(ut),null,{default:d(()=>[a(Fn,{multiSelection:L[0].multi_Selection,show_label:L[0].show_list_label,uniqueId:L[0].unqueId,name_of_list:L[0].name_of_list,choose_place_holder:L[0].placeHolder,"items_-list":L[0].items,use_internal_filter:L[0].use_internal_filter,disabled:L[0].disabled.value,onItemListUpDated:L[0].listUpdatedFN,onItemListFiltered:L[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),e("div",null,[v.value?(s(),$(r(G),{key:0,class:"error-label"},{default:d(()=>[O(E(g.value),1)]),_:1})):S("",!0)])]),_:1})]),_:1})])):S("",!0),V.value?(s(),$(Gn,{key:2,onDataSaved:k,selected_ward_prop:"",admitted_other_props:""})):S("",!0),P.value?(s(),$(Yn,{key:3,onDataSaved:k,selected_referral_data:"",selected_other_referral_data:""})):S("",!0),T.value?(s(),$(jn,{key:4,onDataSaved:k,selected_discharged_prop:"",selected_discharged_data:""})):S("",!0)]),_:1})}}}),Mi=de(yi,[["__scopeId","data-v-b6576c18"]]);export{Ni as C,$i as O,Co as P,no as _,Li as a,Mi as b,ss as c,uo as d,eo as e};
