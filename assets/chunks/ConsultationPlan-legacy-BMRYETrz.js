System.register(["./vendor-legacy-DjGXx6Xl.js","../index-legacy-ByYLEw00.js","./DemographicBar-legacy-BEZEuq-n.js","./TreatmentPlan-legacy-D8pmkTQv.js","./NextAppointment-legacy-DkHJt5QI.js","./RiskAssessment.vue_vue_type_script_setup_true_lang-legacy-COOzHNvS.js","./Vitals.vue_vue_type_script_setup_true_lang-legacy-CCCasYvu.js","./nonPharmaTherapyStore-legacy-ByefDutm.js","./ComplicationsStore-legacy-CUmOCg0M.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-D2Ly5wDN.js","./Registration-legacy-DIG3gwXf.js","./usePatientProfile-legacy-DUp_da6h.js","./apexcharts-legacy-CnQpVQ3m.js","./patient_diagnosis_service-legacy-DAkQ9vGT.js","./DashBox-legacy-C1c_QjGG.js","./BasicForm-legacy-DsDCWh5d.js","./DateInputField-legacy-AJql8yGh.js","./group_validation-legacy-B-zdnEPs.js","./LabOrdersList-legacy-Bv6TWIhU.js","./useUserActivities-legacy-C76ohkbx.js","./RadiologyStore-legacy-B1gq1fNl.js","./previousComplaints-legacy-BvdvFbpd.js","./patient_complaints_service-legacy-CAFRssrj.js","./user_role_management-legacy-C0cJrJ56.js","./ncd_appointment_service-legacy-8PIQtqu3.js","./drug_prescription_service-legacy-DJYiewCD.js","./useLocation-legacy-B-thYyFh.js","./vaccines_service-legacy-DDOavvDh.js","./sms_service-legacy-Cu0Z-TYl.js","./EIRreportsStore-legacy-DFuseBK5.js","./Export-legacy-BdfLB8m4.js","./useNeonatalEnrollmentStore-legacy-DdzM4oOf.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-BgoePRM_.js"],function(e,a){"use strict";var t,n,l,s,i,o,c,u,r,v,g,d,p,m,y,f,h,_,b,S,w,D,j,C,x,A,k,P,T,I,R,N,V,L,M,O,B,F,H,z,E,$,J,U,W,Y,G,Q,X,K,Z,q,ee,ae,te,ne,le,se,ie,oe,ce,ue,re,ve,ge,de,pe,me,ye;return{setters:[e=>{t=e.d,n=e.ao,l=e.cp,s=e.r,i=e.c,o=e.aV,c=e.w,u=e.a,r=e.O,v=e.f,g=e.J,d=e.l,p=e.u,m=e.a3,y=e.k,f=e.m,h=e.i,_=e.bM,b=e.v,S=e.a6,w=e.b9},e=>{D=e.aI,j=e.u,C=e.aJ,x=e.aK,A=e.aL,k=e.aM,P=e.d,T=e.aN,I=e.g,R=e.$,N=e.e,V=e.T,L=e.J,M=e.N,O=e.H,B=e.aO,F=e.aP,H=e.m,z=e.aQ,E=e.aR,$=e.t,J=e.aS,U=e.aT,W=e.G,Y=e.aU,G=e.a1,Q=e.S},e=>{X=e.D},e=>{K=e.D,Z=e.C,q=e.T},e=>{ee=e.I,ae=e.N,te=e._,ne=e.i},e=>{le=e._},e=>{se=e._},e=>{ie=e.u,oe=e._,ce=e.s,ue=e.c,re=e.a},e=>{ve=e.u},e=>{ge=e.l},e=>{de=e.a,pe=e.b},e=>{me=e.C},e=>{ye=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const a={style:{width:"90vw",margin:"0 auto","margin-top":"10px"}},fe={class:"back_profile"};e("default",t({__name:"ConsultationPlan",setup(e,{expose:t}){const{onTabBeforeChange:he,currentTabIndex:_e}=ie(),{printVisitSummary:be}=ye(),Se=n(),we=l();s([]),s([]),s(!1);const De=s(!0),je=s(!1),Ce=s(!1),xe=i(()=>({text:Ce.value?"Saving...":"Finish",icon:Ce.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:je.value||Ce.value})),Ae=D(),ke=j(),Pe=C(),Te=x();A();const Ie=k(),Re=P();T();const Ne=I(),Ve=ve(),Le=R(),{patient:Me}=o(ke),{vitals:Oe}=o(Ae),{investigations:Be}=o(Pe),{diagnosis:Fe}=o(Te),{substance:He}=o(Ne),{selectedNCDMedicationList:ze}=o(Ie),{FootScreening:Ee,visualScreening:$e,cvScreening:Je}=o(Ve),{sessionDate:Ue}=o(Le),{apiStatus:We}=o(N());s(!1),c(xe,(e,a)=>{console.log("Done button options changed:",{from:a,to:e,currentStep:_e.value,tabsLength:Xe.value.length}),e.disabled!==(null==a?void 0:a.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==a?void 0:a.text)&&console.log(`Done button text changed from "${null==a?void 0:a.text}" to "${e.text}"`)},{deep:!0}),c(Ce,(e,a)=>{e!==a&&(console.log(`Saving state changed: ${a} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Ye=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Ge=()=>{let e=!1;return la(),Ce.value&&(e=!0),je.value=e,!e},Qe=()=>Re.NCDActivities.map(e=>({title:e,icon:""})),Xe=s(Qe()),Ke=s(null),Ze=s(null),qe=s(null),ea=s(null),aa=s(null),ta=s(null),na=s(null),la=()=>{var e;if(!Xe.value||0===Xe.value.length)return console.log("Tabs not yet initialized"),null;const a=_e.value>=0&&_e.value<Xe.value.length?_e.value:0;switch(null===(e=Xe.value[a])||void 0===e?void 0:e.title){case"Vital Signs":return"Vitals";case"Risk Assessment":return"RiskAssessment";case"Investigations":return"Investigations";case"Diagnosis":return"DiagnosisComponent";case"Complications Screening":return"ComplicationsScreening";case"Treatment Plan":return"TreatmentPlan";case"Next Appointment":return"NextAppointment";default:if(Re.NCDActivities.length>0)switch(Re.NCDActivities[0]){case"Vital Signs":return"Vitals";case"Risk Assessment":return"RiskAssessment";case"Investigations":return"Investigations";case"Diagnosis":return"DiagnosisComponent";case"Complications Screening":return"ComplicationsScreening";case"Treatment Plan":return"TreatmentPlan";case"Next Appointment":return"NextAppointment"}return null}},sa=()=>{De.value=!1,setTimeout(()=>{_e.value=0,De.value=!0},0)},ia=()=>{const e=D();e.setVitals(e.getInitialVitals(Me.value.ID))},oa=async()=>{const e=M(Ue.value,"sessionDate","value")||O.sessionDate(),a=B("vitals");for(let n=0;n<Xe.value.length;n++){const l=Xe.value[n];if("Vital Signs"===l.title)Xe.value[n].icon=ca(e,a)?w:"";else if("Risk Assessment"===l.title){const a=B("substanceAbuse");Xe.value[n].icon=ca(e,a)?w:""}else if("Investigations"===l.title){var t;const a=null==Me||null===(t=Me.value)||void 0===t||null===(t=t.labOrders)||void 0===t?void 0:t.saved,l=null==a?void 0:a.filter(a=>O.toStandardHisFormat(e)===O.toStandardHisFormat(a.order_date));Xe.value[n].icon=(null==l?void 0:l.length)>0?w:""}else if("Diagnosis"===l.title){const a=B("diagnosis");Xe.value[n].icon=ca(e,a)?w:""}else if("Complications Screening"===l.title){const a=B("screening");Xe.value[n].icon=ca(e,a)?w:""}else"Treatment Plan"===l.title&&(ze.value.length>0?Xe.value[n].icon=F()?w:"":Xe.value[n].icon="")}Ge()},ca=(e,a)=>{const t=new Date(e);return t.setHours(0,0,0,0),a.some(e=>{const a=new Date(e.obs_datetime);return a.setHours(0,0,0,0),a.getTime()===t.getTime()})},ua=async(e,a)=>{var t,n;const l=null===(t=Xe.value[e])||void 0===t?void 0:t.title,s=null===(n=Xe.value[a])||void 0===n?void 0:n.title;var i,o;e%1==0&&(_e.value=e),"Vital Signs"==s&&(null===(i=Ke.value)||void 0===i||i.onSubmit()),"Risk Assessment"==s&&(null===(o=Ze.value)||void 0===o||o.onSubmit()),"Complications Screening"==s&&await(async()=>{const e=[],a=await de($e.value),t=await pe(Ee.value),n=await de(Je.value);var l,s,i,o;a.length>0&&e.push({concept_id:await U.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:U.getSessionDate(),child:a}),t.length>0&&e.push({concept_id:await U.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:U.getSessionDate(),child:t}),n.length>0&&e.push(...n),e.length>0?(null!==(s=(l=null!==(o=(i=Me.value).screening)&&void 0!==o?o:i.screening={}).unsaved)&&void 0!==s||(l.unsaved=[]),Me.value.screening.unsaved.push(...e),W("Complications saved successfully")):$("No complications data to save")})(),"Treatment Plan"==s&&await(async()=>{const e=Y();if(!ge.isEmpty(e.selectedMedicalAllergiesList)){const a=G(),t=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:Q.getSessionDate(),value_coded:e.concept_id,location_id:a.facilityLocation.code,value_text:e.name})),n=await ce(t);Me.value=Object.assign(Me.value,n),console.log("Allergies staged successfully:",Me.value),e.clearSelectedMedicalAllergiesList()}const a=await ue();Me.value=Object.assign(Me.value,a);const t=await re().saveNonPharmaTherapyPatientData();Me.value=Object.assign(Me.value,t)})(),"Investigations"==l&&1==await(async()=>{let e=!1;const a=a=>{e=!1},t=async a=>{1==a.detail&&(e=!0)};if(1==await ne()){const e={message:"You can screen the patient for AHD, do you want to proceed?"};await H(J,{class:"otherVitalsModal"},!0,e,{cancel:a,confirm:t})}else e=!1;return e})()&&await H(te,{class:"fullScreenModal"},!0,{closeModalOnFinish:!0}),await z(Me.value)},ra=async()=>{Ce.value=!0;try{await E(),await z(Me.value),await va(),Se.push("patientProfile")}catch(e){console.error("Error saving data:",e),$("Error occurred while saving data. Please try again.")}finally{Ce.value=!1}},va=async()=>{"dismiss"!==await H(me,{class:"small-confirm-modal "})&&await be()};return u(async()=>{0!==Re.NCDActivities.length?(ve().resetScreening(),Xe.value=Qe(),await oa(),(void 0===_e.value||_e.value<0)&&(_e.value=0,console.log("Setting initial tab index to 0")),je.value=!1,Ce.value=!1,Ge()):Se.push("patientProfile")}),c(_e,async()=>{await Ge()}),c(Oe,async()=>{await oa()},{deep:!0}),c(Me,async()=>{ve().resetScreening(),await oa()},{deep:!0}),c(Ue,async()=>{await oa()},{deep:!0}),c(Be,async()=>{await oa()},{deep:!0}),c(Fe,async()=>{await oa()},{deep:!0}),c(He,async()=>{await oa()},{deep:!0}),c(ze,async()=>{await oa()},{deep:!0}),c(we,async e=>{sa(),ia(),Xe.value=Qe()},{deep:!0}),c(Me,async(e,a)=>{e.ID!=a.ID&&(sa(),ia())},{deep:!0}),t({saveData:ra,markWizard:oa,refreshWizard:sa,validateDoneButtonState:Ge}),(e,t)=>(v(),r(p(S),null,{default:g(()=>[d(V),d(p(m),{fullscreen:!0},{default:g(()=>[d(X),y("div",a,[De.value?(v(),r(oe,{key:0,ref:"wizard",headingTitle:"Consultation Plan","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:xe.value,"custom-tabs":Xe.value,beforeChange:p(he),onChange:ua,"onComplete:wizard":t[1]||(t[1]=e=>ra()),onDoneButtonChanged:Ye},{default:g(()=>[y("div",null,[y("div",fe,[d(L,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:p(_),"font-weight":"600",onClick:t[0]||(t[0]=e=>{Se.push("patientProfile")})},null,8,["icon"])])]),h(y("div",null,[d(se,{ref_key:"vitalsRef",ref:Ke},null,512)],512),[[b,"Vitals"==la()]]),h(y("div",null,[d(le,{ref_key:"riskAssessmentRef",ref:Ze},null,512)],512),[[b,"RiskAssessment"==la()]]),h(y("div",null,[d(ee,{ref_key:"investigationsRef",ref:qe},null,512)],512),[[b,"Investigations"==la()]]),h(y("div",null,[d(K,{ref_key:"diagnosisRef",ref:ea},null,512)],512),[[b,"DiagnosisComponent"==la()]]),h(y("div",null,[d(Z,{ref_key:"complicationsRef",ref:aa},null,512)],512),[[b,"ComplicationsScreening"==la()]]),h(y("div",null,[d(q,{ref_key:"treatmentPlanRef",ref:ta},null,512)],512),[[b,"TreatmentPlan"==la()]]),h(y("div",null,[d(ae,{ref_key:"nextAppointmentRef",ref:na},null,512)],512),[[b,"NextAppointment"==la()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):f("",!0)])]),_:1})]),_:1}))}}))}}});
