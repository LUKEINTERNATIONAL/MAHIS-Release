import{d as ce,b2 as Ee,r as n,c as W,a as ke,H as xe,e as D,f as s,l as u,m as v,O as k,J as y,k as l,u as p,$ as re,Q as F,F as se,w as Ce,ay as wt,c1 as jt,P as ge,aP as zt,K as P,p as dt,bz as Kt,ai as Xt,L as je,eA as ut,eB as mt,bq as ze,bb as pt,eC as ht,eD as ft,dc as yt,eE as vt,eF as bt,eG as gt,dh as _t,c0 as Jt,aw as ot,aA as Qt,c8 as Zt,n as be,X as fe,bF as ea,am as nt,al as Ae,N as pe,by as he,a5 as ta,br as Re,b3 as aa,bt as Ot,a3 as At,c6 as na,bB as oa,ak as xt,R as ia,aH as sa,be as Ct,bC as la,dv as ra,ec as Qe,a6 as Dt}from"./vendor-BataJFSH.js";import{u as Pe,n as ae,aF as We,aE as ca,aW as da,aG as Ke,M as Te,Q as ua,t as ye,S as Ue,ai as q,b as ee,K as Le,_ as Ne,ah as le,H as Me,bd as kt,P as Pt,a_ as He,o as ma,b6 as St,N as pa,B as Oe,aA as Ze,ar as et,av as tt,w as ha,a$ as fa,au as ya}from"../index-CYcjB3lE.js";import{e as va,a as ba,m as ga,b as _a,v as Ca,c as Da,_ as wa}from"./LevelOfConsciousness.vue_vue_type_script_setup_true_lang-B3khOm_s.js";import{u as Oa,p as Aa}from"./previousComplaints-DWtu4qAA.js";import{P as xa}from"./patient_complaints_service-CqslE5al.js";import{D as ka}from"./DashBox-MvA5RkFq.js";import{A as Pa,D as Sa,a as Ta}from"./NextAppointment-DAOKpNNs.js";import{a as Ea,b as Na}from"./drug_prescription_service-CAmeZFJa.js";import{P as Ia}from"./nonPharmaTherapyStore-BeLj4Wxw.js";import{l as Se}from"./lodash-NJiRuGo9.js";import{_ as at,D as Fa,A as Va,R as Ha,a as Ma,b as Ba}from"./Outcome-T6JLQrwS.js";const Ya={key:0},$a={style:{"align-content":"center"}},Ra={class:"ion-padding",slot:"content"},Ua=ce({__name:"PresentingComplaints",setup(c,{expose:h}){const o=Oa(),{presentingComplaints:a}=Ee(o),S=Pe(),{patient:A}=Ee(S),V=n(ae),B=n(!0),i=n(!1),e=n(!1),t=n(!0),f=n(!1),_=n([]),w=n([]),r=n(),N=n(null),H=n(null),T=(O,Y)=>{var De,Be;if(!O||!Y)return null;const L=(Be=(De=A.value)==null?void 0:De.personInformation)==null?void 0:Be.birthdate;if(!L)return null;const te=Number(O);if(isNaN(te)||te<=0)return null;const j=new Date(L),Z=new Date,de=Z.getTime()-j.getTime();let ue;switch(Y){case"Hours":ue=de/(1e3*60*60);break;case"Days":ue=de/(1e3*60*60*24);break;case"Weeks":ue=de/(1e3*60*60*24*7);break;case"Months":const me=Z.getFullYear()-j.getFullYear(),Ye=Z.getMonth()-j.getMonth();ue=me*12+Ye,Z.getDate()<j.getDate()&&ue--;break;case"Years":ue=Z.getFullYear()-j.getFullYear(),(Z.getMonth()<j.getMonth()||Z.getMonth()===j.getMonth()&&Z.getDate()<j.getDate())&&ue--;break;default:return null}return te>ue?"Duration cannot be before patient's birth date":null},I=W(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:ae.search,hideSelected:!0,validation:O=>d(O==null?void 0:O.name,_.value)?"Presenting complaint already added":We.required(O),options:w.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:ae.time,validation:O=>{N.value=O;const Y=We.isNotEmptyandNumber(O);if(Y)return Y;const L=H.value;if(!L)return null;const te=T(O,L);return console.log("Birthdate validation result:",te),te},grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:O=>(H.value=O,!O||O===""?"Please select a unit.":null)},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:ae.editPen,validation:O=>d(O,_.value)?"Presenting complaint already added":We.required(O),condition:O=>{var Y;return((Y=O==null?void 0:O.PresentingComplaints)==null?void 0:Y.name)==="Other"}},{componentType:"Alert",condition:O=>{var Y;return We.required((Y=O==null?void 0:O.PresentingComplaints)==null?void 0:Y.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:$}=ca(),R=async()=>{w.value=await xa.getComplaintsList("Presenting complaint"),ua(a.value,"PresentingComplaints","multiSelectData",w.value)},K=()=>{B.value=!1,t.value=!1,e.value=!0},J=async()=>{var L,te;const O=(L=$.value)==null?void 0:L.getFormValues();if(O.duration&&O.duration_unit){console.log("Validating duration against birthdate...");const j=T(O.duration,O.duration_unit);if(console.log("Validation result:",j),j){ye(j);return}}else console.log("Skipping birthdate validation - missing duration or unit");((te=$.value)==null?void 0:te.validateForm())==null&&(ve(O),e.value=!1,t.value=!0)},ve=O=>{var j;const Y=O.duration+" "+O.duration_unit,L=O.PresentingComplaints,te=L.name==="Other"?O["Other (specify)"]:L.name;_.value.push({actionBtn:!0,btn:["delete"],name:te,concept_id:L.concept_id,duration:L.duration,durationUnits:L.duration_unit,display:[te,Y],data:[{concept_id:8578,value_coded:L.concept_id,obs_datetime:Ue.getSessionDate(),child:[{concept_id:L.concept_id,value_text:Y,obs_datetime:Ue.getSessionDate()}]}]}),(j=$.value)==null||j.resetForm(),f.value=!0,U()},U=()=>{const O=["Cough","Convulsions"];i.value=_.value.some(Y=>O.includes(Y.name))},d=(O,Y)=>Y.some(L=>L.name===O),M=O=>{_.value=_.value.filter(Y=>Y.display[0]!==O.name)},Q=async()=>{const O=await q.getObsByEncounterIdAndDate(ee.PRESENTING_COMPLAINTS),Y=_.value.flatMap(L=>L.data);return Y.length<=0&&O.length<=0?(ye("Presenting complaints is required"),!1):(Y.length<=0||(await q.addObsToEncounterPatient(Y,ee.PRESENTING_COMPLAINTS),Le("Presenting complaints saved successful"),_.value=[]),!0)};return ke(async()=>{await R()}),h({onSubmit:Q}),(O,Y)=>{const L=xe("ion-row"),te=xe("ion-label"),j=xe("ion-accordion"),Z=xe("ion-accordion-group");return s(),D(se,null,[u(ka,{status:B.value,content:"No presenting complaints added"},null,8,["status"]),f.value?(s(),D("span",Ya,[u(da,{listData:_.value,"onClicked:delete":M},null,8,["listData"])])):v("",!0),e.value?(s(),k(L,{key:1},{default:y(()=>[u(Ke,{formData:I.value,ref_key:"formRef",ref:$},null,8,["formData"]),l("div",$a,[u(Te,{fill:"clear",icon:V.value.plus,iconSlot:"icon-only","onClicked:btn":Y[0]||(Y[0]=de=>J()),name:"Save"},null,8,["icon"])])]),_:1})):v("",!0),t.value?(s(),k(L,{key:2,style:{"margin-top":"10px"}},{default:y(()=>[u(Te,{fill:"clear",icon:V.value.plus,iconSlot:"icon-only","onClicked:btn":Y[1]||(Y[1]=de=>K()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):v("",!0),u(L,null,{default:y(()=>[u(Z,{ref_key:"accordionGroup",ref:r,class:"previousView"},{default:y(()=>[u(j,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(te,{class:"previousLabel"},{default:y(()=>[...Y[2]||(Y[2]=[F("Previous presenting complaints",-1)])]),_:1})]),_:1}),l("div",Ra,[u(Aa)])]),_:1})]),_:1},512)]),_:1})],64)}}}),La=Ne(Ua,[["__scopeId","data-v-482c7b52"]]),Ga={class:"visit-section"},qa={class:"section-header"},Wa={key:0,class:"no-data"},ja={key:1,class:"allergy-accordion"},za=["onClick"],Ka={class:"acc-left"},Xa={class:"acc-title"},Ja={class:"acc-count"},Qa={key:0,class:"accordion-body"},Za={class:"item-label"},en={class:"item-value"},tn=ce({__name:"AllergiesListing",setup(c){const h=Pe(),{patient:o}=Ee(h),a=n({}),S=n([]),A={antiviral:/abacavir|lamivudine|lopinavir|ritonavir|zidovudine|efavirenz|tenofovir/i,antibiotic:/penicillin|amoxicillin|cephalexin|azithromycin|ciprofloxacin|doxycycline/i,analgesic:/aspirin|ibuprofen|acetaminophen|morphine|codeine|tramadol/i,cardiac:/metoprolol|lisinopril|amlodipine|atorvastatin|warfarin/i,activated:/activated\s+charcoal/i},V={985:{name:"Drug Allergy",severity:"danger"},7759:{name:"Location/Environmental",severity:"info"},7579:{name:"Medical Condition",severity:"warning"},drug:{name:"Drug Allergy",severity:"danger"},food:{name:"Food Allergy",severity:"danger"},environmental:{name:"Environmental",severity:"warning"},contact:{name:"Contact Allergy",severity:"warning"},unknown:{name:"Drug Allergy",severity:"danger"}},B=r=>{const N=r.toLowerCase();return A.antiviral.test(N)?"Antiviral Medication":A.antibiotic.test(N)?"Antibiotic":A.analgesic.test(N)?"Pain Medication":A.cardiac.test(N)?"Cardiac Medication":A.activated.test(N)?"Detoxification Agent":"Medication"},i=async()=>{var r;try{if(!((r=o.value)!=null&&r.patientID))return;const N=await q.getObsByEncounterIdAndDate(ee.MEDICAL_HISTORY),H=await le.getConceptID("Allergic"),T=N.filter($=>$.concept_id===H);S.value=await Promise.all(T.map(async $=>{var U,d;const R=((U=$.value_coded)==null?void 0:U.toString())||"unknown",K=await le.getConceptName($.value_coded);let J=((d=V[R])==null?void 0:d.name)||"Drug Allergy",ve=$.value_text||K||"Unknown";return R==="985"&&$.value_text&&(J=B($.value_text)),{name:J,displayValue:ve,date:$.obs_datetime||$.encounter_datetime,conceptId:R}}));const I=Object.keys(t.value);I.length>0&&(a.value[I[0]]=!0)}catch(N){console.error("Error loading allergies:",N)}},e=W(()=>S.value.length>0),t=W(()=>{const r={};S.value.forEach(T=>{const I=T.date?_(T.date):"Unknown Date";r[I]||(r[I]=[]),r[I].push(T)});const N={};return Object.keys(r).sort((T,I)=>T==="Unknown Date"?1:I==="Unknown Date"?-1:new Date(I).getTime()-new Date(T).getTime()).forEach(T=>{N[T]=r[T]}),N}),f=r=>{a.value[r]=!a.value[r]},_=r=>{if(!r)return"Unknown Date";try{return new Date(r).toISOString().split("T")[0]}catch(N){return"Unknown Date"}},w=r=>{if(r==="Unknown Date")return"Unknown Date";try{const N=new Date(r),H=Me.sessionDate(),T=new Date(H),I=new Date(T);I.setDate(I.getDate()-1);const $=N.toDateString(),R=T.toDateString(),K=I.toDateString();return $===R?"Today":$===K?"Yesterday":N.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(N){return r}};return Ce(()=>{var r;return(r=o.value)==null?void 0:r.patientID},async r=>{r&&await i()},{immediate:!0}),Ce(()=>{var r;return(r=o.value)==null?void 0:r.observations},async(r,N)=>{r!==N&&await i()},{deep:!0}),ke(async()=>{await i()}),(r,N)=>{const H=xe("ion-icon");return s(),D("div",Ga,[l("div",qa,[u(H,{icon:p(wt),class:"section-icon"},null,8,["icon"]),N[0]||(N[0]=l("h3",null,"Allergies",-1))]),e.value?(s(),D("div",ja,[(s(!0),D(se,null,ge(t.value,(T,I)=>(s(),D("div",{key:I,class:"accordion-section"},[l("div",{class:dt(["accordion-header",{open:a.value[I]}]),onClick:$=>f(I)},[l("div",Ka,[u(H,{icon:p(zt),class:"acc-icon"},null,8,["icon"]),l("span",Xa,P(w(I)),1),l("span",Ja,"("+P(T.length)+")",1)]),u(H,{icon:p(Kt),class:dt(["chevron",{rotate:a.value[I]}])},null,8,["icon","class"])],10,za),a.value[I]?(s(),D("div",Qa,[(s(!0),D(se,null,ge(T,($,R)=>(s(),D("div",{class:"allergy-item",key:R},[l("span",Za,P($.name)+":",1),l("span",en,P($.displayValue),1)]))),128))])):v("",!0)]))),128))])):(s(),D("div",Wa,[u(H,{icon:p(jt),class:"no-data-icon"},null,8,["icon"]),N[1]||(N[1]=l("p",null,"No known allergies",-1))]))])}}}),Tt=Ne(tn,[["__scopeId","data-v-b14ceaf9"]]),an=ce({name:"VisitHistory",components:{AllergiesListing:Tt,IonIcon:je},setup(){const c=kt();return{selectedAllergiesList2:W(()=>c.selectedMedicalAllergiesList),alertCircleOutline:wt,documentTextOutline:Zt,femaleOutline:Qt,medicalOutline:ot,warningOutline:Jt,bodyOutline:ut,eyeOutline:_t,nutritionOutline:gt,fitnessOutline:ft,pulseOutline:pt,earOutline:bt,happyOutline:vt,manOutline:yt,moveOutline:ht,addOutline:ze,scanOutline:mt}},data(){return{presentingComplaintsWithDuration:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},allergyList:[],physicalExamCategories:{Eyes:{icon:_t,abnormalities:[],normal:!1},Mouth:{icon:gt,abnormalities:[],normal:!1},Ears:{icon:bt,abnormalities:[],normal:!1},Face:{icon:vt,abnormalities:[],normal:!1},Neck:{icon:yt,abnormalities:[],normal:!1},Chest:{icon:ft,abnormalities:[],normal:!1},"Chest Movement":{icon:ht,abnormalities:[],normal:!1},"Heart Sounds":{icon:pt,abnormalities:[],normal:!1},"Breath Sounds":{icon:ze,abnormalities:[],normal:!1},"Added Breath Sounds":{icon:ze,abnormalities:[],normal:!1},"Abdominal Inspection":{icon:mt,abnormalities:[],normal:!1},"Genital Examination":{icon:ut,abnormalities:[],normal:!1}}}},computed:{...Xt(Pe,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var c;return((c=this.presentingComplaintsWithDuration)==null?void 0:c.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var c;return((c=this.uniquePastMedicalHistory)==null?void 0:c.length)>0},hasAllergies(){var c;return((c=this.allergyList)==null?void 0:c.length)>0},hasPhysicalExam(){return Object.values(this.physicalExamCategories).some(c=>c.abnormalities.length>0||c.normal)},uniquePastMedicalHistory(){return[...new Set(this.pastMedicalHistory)]},uniquePresentingComplaints(){return[...new Set(this.presentingComplaintsWithDuration.map(c=>c.name))]},isMinor(){var c,h;return Me.getAgeInYears((h=(c=this.patient)==null?void 0:c.personInformation)==null?void 0:h.birthdate)<18},gcsScore(){var B,i,e;if(!this.hasLevelOfConsciousness)return null;const c=this.levelOfConsciousness.eyeResponse,h=this.levelOfConsciousness.motorResponse,o=this.levelOfConsciousness.verbalResponse,a=c&&(B=(this.isMinor?va:ba)[c])!=null?B:0,S=h&&(i=(this.isMinor?ga:_a)[h])!=null?i:0,A=o&&(e=(this.isMinor?Ca:Da)[o])!=null?e:0,V=a+S+A;return"(M ".concat(S," V ").concat(A," E ").concat(a,") ").concat(V,"/").concat(this.isMinor?5:15)}},methods:{async updateData(){var c;(c=this.patient)!=null&&c.patientID&&(await this.loadPresentingComplaints(),await this.loadPastMedicalHistory(),await this.loadLevelOfConsciousness(),await this.loadPregnancyStatus(),await this.loadPhysicalExam(),await this.loadAllergies())},async loadPresentingComplaints(){try{const c=await q.getObsByEncounterIdAndDate(ee.PRESENTING_COMPLAINTS);this.presentingComplaintsWithDuration=[];const h=c.filter(o=>o.concept_id===8578);for(const o of h){const a=await le.getConceptName(o.value_coded);let S="Duration not specified";o.children&&Array.isArray(o.children)&&o.children.length>0?S=o.children[0].value_text||"Duration not specified":o.child&&Array.isArray(o.child)&&o.child.length>0&&(S=o.child[0].value_text||"Duration not specified"),this.presentingComplaintsWithDuration.push({name:a,duration:S})}console.log("Loaded complaints:",this.presentingComplaintsWithDuration)}catch(c){console.error("Error loading presenting complaints:",c)}},async loadPastMedicalHistory(){try{const h=(await q.getObsByEncounterIdAndDate(ee.PAST_MEDICAL_HISTORY)).filter(o=>o.concept_name==="Chronic disease");this.pastMedicalHistory=await Promise.all(h.map(async o=>await le.getConceptName(o.value_coded)))}catch(c){console.error("Error loading past medical history:",c)}},async loadLevelOfConsciousness(){try{const c=await q.getObsByEncounterIdAndDate(ee.ASSESSMENT);if(c&&Array.isArray(c)){const h=c.find(S=>S.concept_name==="Eye opening response");this.levelOfConsciousness.eyeResponse=h!=null&&h.value_coded?await le.getConceptName(h.value_coded):null;const o=c.find(S=>S.concept_name==="Best verbal response");this.levelOfConsciousness.verbalResponse=o!=null&&o.value_coded?await le.getConceptName(o.value_coded):null;const a=c.find(S=>S.concept_name==="Best motor response");this.levelOfConsciousness.motorResponse=a!=null&&a.value_coded?await le.getConceptName(a.value_coded):null}}catch(c){console.error("Error loading level of consciousness:",c)}},async loadPregnancyStatus(){try{const c=await q.getObsByEncounterIdAndDate(ee.PREGNANCY_STATUS);if(c&&Array.isArray(c)){const h=c.find(a=>a.concept_name==="Patient pregnant");this.pregnancy.patientPregnant=h!=null&&h.value_coded?await le.getConceptName(h.value_coded):null;const o=c.find(a=>a.concept_name==="Is patient breast feeding?");this.pregnancy.breastFeeding=o!=null&&o.value_coded?await le.getConceptName(o.value_coded):null}}catch(c){console.error("Error loading pregnancy status:",c)}},async loadAllergies(){try{const c=await q.getObsByEncounterIdAndDate(ee.MEDICAL_HISTORY),h=await le.getConceptID("Allergic"),o=c.filter(a=>a.concept_id===h);this.allergyList=await Promise.all(o.map(async a=>a.value_text||await le.getConceptName(a.value_coded)))}catch(c){console.error("Error loading allergies:",c)}},async loadPhysicalExam(){try{const c=await q.getObsByEncounterIdAndDate(ee.PHYSICAL_EXAMINATION);Object.values(this.physicalExamCategories).forEach(h=>{h.abnormalities=[],h.normal=!1});for(const h of c){if(!h.concept_name)continue;const o=h.concept_name,a=h.value_text;o==="Eyes normal"&&a==="Yes"?this.physicalExamCategories.Eyes.normal=!0:o==="Abnormality for eyes"&&a?this.physicalExamCategories.Eyes.abnormalities.push(a):o==="Other eye abnormality notes"&&a&&this.physicalExamCategories.Eyes.abnormalities.push(a),o==="Mouth normal"&&a==="Yes"?this.physicalExamCategories.Mouth.normal=!0:o==="Abnormality for  mouth"&&a?this.physicalExamCategories.Mouth.abnormalities.push(a):o==="Other mouth abnormality notes"&&a&&this.physicalExamCategories.Mouth.abnormalities.push(a),o==="Ears normal"&&a==="Yes"?this.physicalExamCategories.Ears.normal=!0:o==="Abnormality for ears"&&a?this.physicalExamCategories.Ears.abnormalities.push(a):o==="Other ears abnormality notes"&&a&&this.physicalExamCategories.Ears.abnormalities.push(a),o==="Face normal"&&a==="Yes"?this.physicalExamCategories.Face.normal=!0:o==="Abnormality for face"&&a?this.physicalExamCategories.Face.abnormalities.push(a):o==="Other face abnormality notes"&&a&&this.physicalExamCategories.Face.abnormalities.push(a),o==="Neck normal"&&a==="Yes"?this.physicalExamCategories.Neck.normal=!0:o==="Abnormality for neck"&&a?this.physicalExamCategories.Neck.abnormalities.push(a):o==="Other neck abnormality notes"&&a&&this.physicalExamCategories.Neck.abnormalities.push(a),o==="Chest inspection normal"&&a==="Yes"?this.physicalExamCategories.Chest.normal=!0:o==="Abnormality for  chest inspection"&&a?this.physicalExamCategories.Chest.abnormalities.push(a):o==="Other chest abnormality notes"&&a&&this.physicalExamCategories.Chest.abnormalities.push(a),o==="Chest movements"&&a&&this.physicalExamCategories["Chest Movement"].abnormalities.push(a),o==="Heart sounds normal"&&a==="Yes"?this.physicalExamCategories["Heart Sounds"].normal=!0:o==="Heart sounds abnormality"&&a&&this.physicalExamCategories["Heart Sounds"].abnormalities.push(a),o==="Breath sounds normal"&&a==="Yes"?this.physicalExamCategories["Breath Sounds"].normal=!0:o==="Breath sounds abnormality"&&a&&this.physicalExamCategories["Breath Sounds"].abnormalities.push(a),o==="Abnormalities when added"&&a&&this.physicalExamCategories["Added Breath Sounds"].abnormalities.push(a),o==="Abdominal inspection normal"&&a==="Yes"?this.physicalExamCategories["Abdominal Inspection"].normal=!0:o==="Abdominal inspection abnormality"&&a?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(a):o==="Other abdominal abnormality notes"&&a?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(a):o==="Abdominal auscultation abnormality"&&a?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(a):o==="Bowel sounds abnormality"&&a?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(a):o==="Abdominal palpation abnormality"&&a&&this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(a),o==="Genital examination normal"&&a==="Yes"?this.physicalExamCategories["Genital Examination"].normal=!0:o==="Genital examination abnormality"&&a?this.physicalExamCategories["Genital Examination"].abnormalities.push(a):o==="Urethral meatus abnormalities"&&a?this.physicalExamCategories["Genital Examination"].abnormalities.push(a):o==="Vulva inspection abnormalities"&&a?this.physicalExamCategories["Genital Examination"].abnormalities.push(a):o==="Other genital abnormality notes"&&a&&this.physicalExamCategories["Genital Examination"].abnormalities.push(a)}}catch(c){console.error("Error loading physicalExam:",c)}}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),nn={class:"visit-container"},on={class:"visit-sections"},sn={key:0,class:"visit-section"},ln={class:"section-header"},rn={class:"section-content"},cn={key:0,class:"info-item"},dn={class:"info-value"},un={key:1,class:"info-item"},mn={class:"info-value"},pn={key:2,class:"info-item"},hn={class:"info-value"},fn={key:3,class:"info-item"},yn={class:"info-value highlight"},vn={key:1,class:"visit-section"},bn={class:"section-header"},gn={class:"complaints-container"},_n={class:"complaint-name"},Cn={class:"complaint-duration"},Dn={key:2,class:"visit-section"},wn={class:"section-header"},On={class:"section-content"},An={key:0,class:"info-item"},xn={class:"info-value highlight"},kn={key:1,class:"info-item"},Pn={class:"info-value highlight"},Sn={key:3,class:"visit-section"},Tn={class:"section-header"},En={class:"tags-container"},Nn={key:4,class:"visit-section"},In={class:"section-header"},Fn={class:"tags-container"},Vn={key:5,class:"visit-section"},Hn={class:"section-header"},Mn={class:"exam-section"},Bn={key:0,class:"exam-category"},Yn={class:"exam-category-header"},$n={class:"exam-items"},Rn={key:1,class:"exam-item normal"};function Un(c,h,o,a,S,A){const V=xe("ion-icon");return s(),D("div",nn,[h[12]||(h[12]=l("div",{class:"visit-header"},[l("h5",null,"Patient's Clinical Assessment Summary")],-1)),l("div",on,[c.hasLevelOfConsciousness?(s(),D("div",sn,[l("div",ln,[u(V,{icon:c.alertCircleOutline,class:"section-icon"},null,8,["icon"]),h[0]||(h[0]=l("h3",null,"Level of Consciousness",-1))]),l("div",rn,[c.levelOfConsciousness.eyeResponse?(s(),D("div",cn,[h[1]||(h[1]=l("span",{class:"info-label"},"Eye Response:",-1)),l("span",dn,P(c.levelOfConsciousness.eyeResponse),1)])):v("",!0),c.levelOfConsciousness.verbalResponse?(s(),D("div",un,[h[2]||(h[2]=l("span",{class:"info-label"},"Verbal Response:",-1)),l("span",mn,P(c.levelOfConsciousness.verbalResponse),1)])):v("",!0),c.levelOfConsciousness.motorResponse?(s(),D("div",pn,[h[3]||(h[3]=l("span",{class:"info-label"},"Motor Response:",-1)),l("span",hn,P(c.levelOfConsciousness.motorResponse),1)])):v("",!0),c.gcsScore?(s(),D("div",fn,[h[4]||(h[4]=l("span",{class:"info-label"},"Score:",-1)),l("span",yn,P(c.gcsScore),1)])):v("",!0)])])):v("",!0),c.hasPresentingComplaints?(s(),D("div",vn,[l("div",bn,[u(V,{icon:c.documentTextOutline,class:"section-icon"},null,8,["icon"]),h[5]||(h[5]=l("h3",null,"Presenting Complaints",-1))]),l("div",gn,[(s(!0),D(se,null,ge(c.presentingComplaintsWithDuration,(B,i)=>(s(),D("div",{class:"complaint-item",key:i},[l("div",_n,P(B.name),1),l("div",Cn,P(B.duration),1)]))),128))])])):v("",!0),c.hasPregnancyData?(s(),D("div",Dn,[l("div",wn,[u(V,{icon:c.femaleOutline,class:"section-icon"},null,8,["icon"]),h[6]||(h[6]=l("h3",null,"Pregnancy Status",-1))]),l("div",On,[c.pregnancy.patientPregnant?(s(),D("div",An,[h[7]||(h[7]=l("span",{class:"info-label"},"Pregnant:",-1)),l("span",xn,P(c.pregnancy.patientPregnant),1)])):v("",!0),c.pregnancy.breastFeeding?(s(),D("div",kn,[h[8]||(h[8]=l("span",{class:"info-label"},"Breastfeeding:",-1)),l("span",Pn,P(c.pregnancy.breastFeeding),1)])):v("",!0)])])):v("",!0),c.hasPastMedicalHistory?(s(),D("div",Sn,[l("div",Tn,[u(V,{icon:c.medicalOutline,class:"section-icon"},null,8,["icon"]),h[9]||(h[9]=l("h3",null,"Medical History",-1))]),l("div",En,[(s(!0),D(se,null,ge(c.uniquePastMedicalHistory,(B,i)=>(s(),D("div",{class:"medical-tag",key:i},P(B),1))),128))])])):v("",!0),c.hasAllergies?(s(),D("div",Nn,[l("div",In,[u(V,{icon:c.warningOutline,class:"section-icon"},null,8,["icon"]),h[10]||(h[10]=l("h3",null,"Allergies",-1))]),l("div",Fn,[(s(!0),D(se,null,ge(c.allergyList,(B,i)=>(s(),D("div",{class:"allergy-tag",key:i},P(B),1))),128))])])):v("",!0),c.hasPhysicalExam?(s(),D("div",Vn,[l("div",Hn,[u(V,{icon:c.bodyOutline,class:"section-icon"},null,8,["icon"]),h[11]||(h[11]=l("h3",null,"Physical Examination",-1))]),l("div",Mn,[(s(!0),D(se,null,ge(c.physicalExamCategories,(B,i)=>(s(),D(se,{key:i},[B.abnormalities.length>0||B.normal?(s(),D("div",Bn,[l("div",Yn,[u(V,{icon:B.icon},null,8,["icon"]),l("h4",null,P(i),1)]),l("div",$n,[B.abnormalities.length>0?(s(!0),D(se,{key:0},ge(B.abnormalities,(e,t)=>(s(),D("div",{class:"exam-item abnormal",key:t},P(e),1))),128)):B.normal?(s(),D("div",Rn,"Normal examination")):v("",!0)])])):v("",!0)],64))),128))])])):v("",!0)])])}const Ln=Ne(an,[["render",Un],["__scopeId","data-v-382ca63a"]]),Gn={class:"modal_wrapper"},qn=ce({__name:"PregnancyBreastfeeding",setup(c,{expose:h}){const o=n(null),a=n(0),S=W(()=>[{componentType:"radioButtonField",header:"Are you pregnant?",name:"Patient pregnant",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Breastfeeding?",name:"Is patient breast feeding?",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"}}]),A=async i=>{const e=[];for(const[t,f]of Object.entries(i))if(!(!f||f===!1||f==="")&&typeof f=="string")try{const _=await le.getConceptID(f,!0);_?e.push(await q.buildValueCoded(t,_)):e.push(await q.buildValueText(t,f))}catch(_){e.push(await q.buildValueText(t,f))}return e};return h({validateForm:()=>{var i;return(i=o.value)==null?void 0:i.validateForm()},onSubmit:async()=>{if(!o.value)return!1;const i=o.value.validateForm();if(i)return console.log("Validation errors:",i),ye("Please fix validation errors before submitting"),!1;const e=o.value.getFormValues();console.log("Form data:",e);const t=await A(e);return t.length===0?(ye("No pregnancy status data to save"),!1):(await q.addObsToEncounterPatient(t,ee.PREGNANCY_STATUS),a.value++,await be(),Le("Pregnancy status saved successfully"),!0)},resetForm:()=>{a.value++}}),(i,e)=>(s(),D("div",Gn,[(s(),k(Ke,{formData:S.value,ref_key:"formRef",ref:o,key:a.value},null,8,["formData"]))]))}}),Wn=()=>{const c=Pe(),{patient:h}=Ee(c),o=()=>{},a=W(()=>{var S,A,V,B;return[{componentType:"Heading",name:"Existing Chronic Health Conditions",grid:{s:"12"}},{componentType:"checkboxField",name:"TB",label:"TB",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const t={};return i||(t["TB treatment"]="",t["TB drugs"]=null,t["TB drug start date"]=""),t}},{componentType:"radioButtonField",header:"On TB medication",name:"TB treatment",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i.TB===!0,onChange:(i,e)=>{const t={};return i!=="Yes"&&(t["TB drugs"]=null,t["TB drug start date"]=""),t}},{componentType:"multiSelectInputField",header:"Select medication",name:"TB drugs",isMultiple:!1,trackBy:"name",grid:{s:"6"},icon:ae.search,options:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"}],condition:i=>i.TB===!0&&i["TB treatment"]==="Yes"},{componentType:"dateInputField",header:"Start date",name:"TB drug start date",grid:{s:"6"},condition:i=>i.TB===!0&&i["TB treatment"]==="Yes",minDate:((A=(S=h.value)==null?void 0:S.personInformation)==null?void 0:A.birthdate)||void 0,maxDate:new Date().toISOString().split("T")[0]},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Chronic Obstructive Pulmonary Disease (COPD)",label:"Chronic Obstructive Pulmonary Disease (COPD)",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Asthma",label:"Asthma",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Epilepsy",label:"Epilepsy",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Previous stroke",label:"Previous stroke",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Peptic Ulcer Disease (PUD)",label:"Peptic Ulcer Disease (PUD)",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Mental disorder",label:"Mental disorder",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Bleeding disorders",label:"Bleeding disorders",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Hypertension",label:"Hypertension",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const t={};return i||(t["Hypertension medication"]="",t["Current hypertension treatment regimen"]=null),t}},{componentType:"radioButtonField",header:"On medication",name:"Hypertension medication",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i.Hypertension===!0,onChange:(i,e)=>{const t={};return i!=="Yes"&&(t["Current hypertension treatment regimen"]=null),t}},{componentType:"multiSelectInputField",header:"Select medication",name:"Current hypertension treatment regimen",isMultiple:!1,trackBy:"name",grid:{s:"12"},icon:ae.search,options:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}],condition:i=>i.Hypertension===!0&&i["Hypertension medication"]==="Yes"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"HIV Positive",label:"HIV Positive",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const t={};return i||(t["HIV status"]="",t["ARV start date"]=""),t}},{componentType:"radioButtonField",header:"Is the patient on ART",name:"HIV status",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i["HIV Positive"]===!0,onChange:(i,e)=>{const t={};return i!=="Yes"&&(t["ARV start date"]=""),t}},{componentType:"dateInputField",header:"Enter ARV start date",name:"ARV start date",grid:{s:"12"},condition:i=>i["HIV Positive"]===!0&&i["HIV status"]==="Yes",minDate:((B=(V=h.value)==null?void 0:V.personInformation)==null?void 0:B.birthdate)||void 0,maxDate:new Date().toISOString().split("T")[0]},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Diabetes Mellitus",label:"Diabetes Mellitus",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const t={};return i||(t.Diabetes="",t["Controlled by"]=""),t}},{componentType:"radioButtonField",header:"Type",name:"Diabetes",options:[{value:"Type 1 diabetes",label:"Type I"},{value:"Type 2 diabetes",label:"Type II"},{value:"Unknown",label:"Unsure"}],grid:{s:"12"},condition:i=>i["Diabetes Mellitus"]===!0},{componentType:"radioButtonField",header:"Controlled by",name:"Controlled by",options:[{value:"Diet",label:"Diet"},{value:"Tablets",label:"Tablets"},{value:"Insulin",label:"Insulin"}],grid:{s:"12"},condition:i=>i["Diabetes Mellitus"]===!0},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"None",label:"None",type:"single",grid:{s:"12"},onChange:(i,e)=>{const t={};return i&&(t.TB=!1,t["Chronic Obstructive Pulmonary Disease (COPD)"]=!1,t.Asthma=!1,t.Epilepsy=!1,t["Previous stroke"]=!1,t["Peptic Ulcer Disease (PUD)"]=!1,t["Mental disorder"]=!1,t["Bleeding disorders"]=!1,t.Hypertension=!1,t["HIV Positive"]=!1,t["Diabetes Mellitus"]=!1,t["TB treatment"]="",t["TB drugs"]=null,t["TB drug start date"]="",t["Hypertension medication"]="",t["Current hypertension treatment regimen"]=null,t["HIV status"]="",t["ARV start date"]="",t.Diabetes="",t["Controlled by"]=""),t}}]});return{resetForm:o,pastMedicalHistoryFormSection:a}},jn=ce({__name:"PastMedicalHistory",setup(c,{expose:h}){const o=Wn(),a=n(null),S=n(0),A=Pe(),{patient:V}=Ee(A);Ce(()=>{var t;return(t=V.value)==null?void 0:t.patientID},async(t,f)=>{t&&t!==f&&(console.log("Patient changed, resetting form"),S.value++,await be(),await be())}),Ce(()=>{var t,f;return(f=(t=a.value)==null?void 0:t.getFormValues())==null?void 0:f.None},t=>{t&&a.value&&be(()=>{})});const B=async()=>{if(!a.value)return console.error("Form reference is not available"),!1;const t=a.value.validateForm();if(t)return console.log("Validation errors:",t),ye("Please fix validation errors before submitting"),!1;const f=a.value.getFormValues();console.log("Form data:",f);const _=await i(f);return _.length===0?(ye("No past medical history data to save"),!1):(await q.addObsToEncounterPatient(_,ee.PAST_MEDICAL_HISTORY),S.value++,await be(),await be(),Le("Past medical history saved successfully"),!0)},i=async t=>{const f=[];for(const[_,w]of Object.entries(t))if(!(!w||w===!1||w===""))if(typeof w=="boolean"&&w===!0)try{const r=await le.getConceptID(_,!0);r&&f.push(await q.buildValueCoded("Chronic disease",r))}catch(r){f.push(await q.buildValueText("Chronic disease",_))}else typeof w=="string"?f.push(await q.buildValueText(_,w)):typeof w=="object"&&(w!=null&&w.name)?f.push(await q.buildValueText(_,w.name)):(w instanceof Date||/^\d{4}-\d{2}-\d{2}$/.test(w))&&f.push(await q.buildValueDate(_,w));return console.log("Processed past medical history:",f),f};ke(async()=>{console.log("Past medical history form mounted"),await be(),await be()});const e=W(()=>o.pastMedicalHistoryFormSection.value);return h({validateForm:()=>{var t;return(t=a.value)==null?void 0:t.validateForm()},onSubmit:B,resetForm:()=>{S.value++}}),(t,f)=>(s(),k(Ke,{formData:e.value,ref_key:"formRef",ref:a,key:S.value},null,8,["formData"]))}}),zn=()=>{const c=Pe(),{patient:h}=Ee(c),o=()=>{},a=W(()=>{var B,i;const S=(i=(B=h.value)==null?void 0:B.personInformation)==null?void 0:i.gender,A=S==="M",V=S==="F";return[{componentType:"radioButtonField",header:"Has physical examination been done?",name:"Physical examination",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},onChange:(e,t)=>{if(e==="No")return{"Eyes normal":"","Abnormality for eyes":[],"Other eye abnormality notes":"","Mouth normal":"","Abnormality for  mouth":[],"Other mouth abnormality notes":"","Ears normal":"","Abnormality for ears":[],"Other ears abnormality notes":"","Face normal":"","Abnormality for face":[],"Other face abnormality notes":"","Neck normal":"","Abnormality for neck":[],"Other neck abnormality notes":"","Chest inspection normal":"","Abnormality for  chest inspection":[],"Other chest abnormality notes":"","Chest movements":"","Heart sounds normal":"","Heart sounds abnormality":[],"Breath sounds normal":"","Breath sounds abnormality":[],"Abnormalities when added":[],"Abdominal inspection normal":"","Abdominal inspection abnormality":[],"Other abdominal abnormality notes":"","Abdominal auscultation normal":"","Abdominal auscultation abnormality":[],"Other abdominal auscultation abnormality notes":"","Bowel sounds abnormality":[],"Abdominal palpation normal":"","Abdominal palpation abnormality":[],"Other abdominal palpation abnormality notes":"","Genital examination normal":"","Genital examination abnormality":[],"Urethral meatus abnormalities":[],"Vulva inspection abnormalities":[],"Other genital abnormality notes":"","Extremities normal":"","Abnormality for extremities":[],"Other extremities abnormalities notes":""}}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Reason why physical examination not done?",name:"Reason why physical examination not done",options:[{value:"Condition does not necessitate assessment",label:"Condition does not necessitate assessment"},{value:"Patient refused to consent",label:"Patient refused to consent"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="No"},{componentType:"radioButtonField",header:"Eyes normal?",name:"Eyes normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for eyes":[],"Other eye abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on eyes?",name:"Abnormality for eyes",type:"multiple",options:[{value:"Pallor",label:"Pallor"},{value:"Jaundice",label:"Jaundice"},{value:"Ulcerations",label:"Ulcerations"},{value:"Other eye abnormality",label:"Other eye abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Eyes normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other eye abnormality")))return{"Other eye abnormality notes":""}}},{componentType:"inputField",header:"Specify eye abnormality",name:"Other eye abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Eyes normal"]==="No"&&Array.isArray(e["Abnormality for eyes"])&&e["Abnormality for eyes"].includes("Other eye abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Mouth normal?",name:"Mouth normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for  mouth":[],"Other mouth abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities in the mouth?",name:"Abnormality for  mouth",type:"multiple",options:[{value:"Oral thrush",label:"Oral thrush"},{value:"Kaposi's Sarcoma lesions",label:"Kaposi's Sarcoma lesions"},{value:"Sores",label:"Sores"},{value:"Other mouth abnormality",label:"Other mouth abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Mouth normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other mouth abnormality")))return{"Other mouth abnormality notes":""}}},{componentType:"inputField",header:"Specify mouth abnormality",name:"Other mouth abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Mouth normal"]==="No"&&Array.isArray(e["Abnormality for  mouth"])&&e["Abnormality for  mouth"].includes("Other mouth abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Ears normal?",name:"Ears normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for ears":[],"Other ears abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on ears?",name:"Abnormality for ears",type:"multiple",options:[{value:"Ear discharge",label:"Ear discharge"},{value:"Bleeding",label:"Bleeding"},{value:"Other ears abnormality",label:"Other ears abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Ears normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other ears abnormality")))return{"Other ears abnormality notes":""}}},{componentType:"inputField",header:"Specify ears abnormality",name:"Other ears abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Ears normal"]==="No"&&Array.isArray(e["Abnormality for ears"])&&e["Abnormality for ears"].includes("Other ears abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Face normal?",name:"Face normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for face":[],"Other face abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on face?",name:"Abnormality for face",type:"multiple",options:[{value:"Rash",label:"Rash"},{value:"Swelling",label:"Swelling"},{value:"Other face abnormality",label:"Other face abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Face normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other face abnormality")))return{"Other face abnormality notes":""}}},{componentType:"inputField",header:"Specify face abnormality",name:"Other face abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Face normal"]==="No"&&Array.isArray(e["Abnormality for face"])&&e["Abnormality for face"].includes("Other face abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Neck normal?",name:"Neck normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for neck":[],"Other neck abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on the neck?",name:"Abnormality for neck",type:"multiple",options:[{value:"Neck rash",label:"Neck rash"},{value:"Swelling",label:"Swelling"},{value:"Neck mass",label:"Neck mass"},{value:"Other neck abnormality",label:"Other neck abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Neck normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other neck abnormality")))return{"Other neck abnormality notes":""}}},{componentType:"inputField",header:"Specify neck abnormality",name:"Other neck abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Neck normal"]==="No"&&Array.isArray(e["Abnormality for neck"])&&e["Abnormality for neck"].includes("Other neck abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Chest inspection normal?",name:"Chest inspection normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for  chest inspection":[],"Other chest abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on the chest?",name:"Abnormality for  chest inspection",type:"multiple",options:[{value:"Chest rash",label:"Chest rash"},{value:"Chest burns",label:"Chest burns"},{value:"Chest bruises",label:"Chest bruises"},{value:"Chest wounds",label:"Chest wounds"},{value:"Other chest abnormality",label:"Other chest abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Chest inspection normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other chest abnormality")))return{"Other chest abnormality notes":""}}},{componentType:"inputField",header:"Specify chest abnormality",name:"Other chest abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Chest inspection normal"]==="No"&&Array.isArray(e["Abnormality for  chest inspection"])&&e["Abnormality for  chest inspection"].includes("Other chest abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Chest movement?",name:"Chest movements",options:[{value:"Symmetrical",label:"Symmetrical"},{value:"Asymmetrical",label:"Asymmetrical"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Heart sounds normal?",name:"Heart sounds normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Heart sounds abnormality":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the heart sounds?",name:"Heart sounds abnormality",type:"multiple",options:[{value:"Loud P2",label:"Loud P2"},{value:"Splitting P2",label:"Splitting P2"},{value:"Gallop rhythm",label:"Gallop rhythm"},{value:"Murmur",label:"Murmur"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Heart sounds normal"]==="No"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Breath sounds normal?",name:"Breath sounds normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Breath sounds abnormality":[],"Abnormalities when added":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the breath sounds?",name:"Breath sounds abnormality",type:"multiple",options:[{value:"Absent",label:"Absent"},{value:"Reduced",label:"Reduced"},{value:"Added",label:"Added"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Breath sounds normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Added")))return{"Abnormalities when added":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the breath sounds are Added?",name:"Abnormalities when added",type:"multiple",options:[{value:"Crackles",label:"Crackles"},{value:"Wheezes",label:"Wheezes"},{value:"Bronchial",label:"Bronchial"},{value:"Crepitations",label:"Crepitations"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Breath sounds normal"]==="No"&&Array.isArray(e["Breath sounds abnormality"])&&e["Breath sounds abnormality"].includes("Added")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal inspection normal?",name:"Abdominal inspection normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abdominal inspection abnormality":[],"Other abdominal abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities after Abdominal inspection?",name:"Abdominal inspection abnormality",type:"multiple",options:[{value:"Abdominal distension",label:"Abdominal distension"},{value:"Abdominal rash",label:"Abdominal rash"},{value:"Abdominal wounds",label:"Abdominal wounds"},{value:"Laceration",label:"Laceration"},{value:"Abdominal bruises",label:"Abdominal bruises"},{value:"Abdominal burns",label:"Abdominal burns"},{value:"Other abdominal abnormality",label:"Other abdominal abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal inspection normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other abdominal abnormality")))return{"Other abdominal abnormality notes":""}}},{componentType:"inputField",header:"Specify abdominal abnormality",name:"Other abdominal abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal inspection normal"]==="No"&&Array.isArray(e["Abdominal inspection abnormality"])&&e["Abdominal inspection abnormality"].includes("Other abdominal abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal auscultation normal?",name:"Abdominal auscultation normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abdominal auscultation abnormality":[],"Other abdominal auscultation abnormality notes":"","Bowel sounds abnormality":[]}}},{componentType:"checkboxField",header:"What are the abdominal auscultation abnormalities?",name:"Abdominal auscultation abnormality",type:"multiple",options:[{value:"Bruit",label:"Bruit"},{value:"Hyperactive",label:"Hyperactive"},{value:"Reduced bowel sounds",label:"Reduced bowel sounds"},{value:"Other",label:"Other"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No",onChange:(e,t)=>{const f={};return e!=null&&e.includes("Reduced bowel sounds")||(f["Bowel sounds abnormality"]=[]),e!=null&&e.includes("Other")||(f["Other abdominal auscultation abnormality notes"]=""),f}},{componentType:"checkboxField",header:"What are the abnormalities on bowel sounds?",name:"Bowel sounds abnormality",type:"multiple",options:[{value:"Reduced bowel sounds",label:"Reduced bowel sounds"},{value:"Abdominal auscultation absent",label:"Abdominal auscultation absent"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No"&&Array.isArray(e["Abdominal auscultation abnormality"])&&e["Abdominal auscultation abnormality"].includes("Reduced bowel sounds")},{componentType:"inputField",header:"Specify abdominal auscultation abnormality",name:"Other abdominal auscultation abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No"&&Array.isArray(e["Abdominal auscultation abnormality"])&&e["Abdominal auscultation abnormality"].includes("Other")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal palpation normal?",name:"Abdominal palpation normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abdominal palpation abnormality":[],"Other abdominal palpation abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abdominal palpation abnormalities?",name:"Abdominal palpation abnormality",type:"multiple",options:[{value:"Tenderness",label:"Tenderness"},{value:"Splenomegaly",label:"Splenomegaly"},{value:"Kidney ballotable",label:"Kidney ballotable"},{value:"Other masses",label:"Other masses"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal palpation normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other masses")))return{"Other abdominal palpation abnormality notes":""}}},{componentType:"inputField",header:"Specify abdominal palpation abnormality",name:"Other abdominal palpation abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal palpation normal"]==="No"&&Array.isArray(e["Abdominal palpation abnormality"])&&e["Abdominal palpation abnormality"].includes("Other masses")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Genital examination normal?",name:"Genital examination normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Genital examination abnormality":[],"Urethral meatus abnormalities":[],"Vulva inspection abnormalities":[],"Other genital abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities after genital examination?",name:"Genital examination abnormality",type:"multiple",options:[{value:"Warts",label:"Warts"},{value:"Vesicles",label:"Vesicles"},{value:"Growths",label:"Growths"},{value:"Genital sores",label:"Genital sores"},{value:"Scrotal swelling",label:"Scrotal swelling",disabled:V},{value:"Tastes swelling",label:"Tastes swelling",disabled:V},{value:"Urethral meatus abnormal",label:"Urethral meatus abnormal",disabled:V},{value:"Vulva examination",label:"Vulva examination",disabled:A},{value:"Visible bleeding",label:"Visible bleeding",disabled:A},{value:"Other genital abnormalities",label:"Other genital abnormalities"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No",onChange:(e,t)=>{const f={};return e!=null&&e.includes("Urethral meatus abnormal")||(f["Urethral meatus abnormalities"]=[]),e!=null&&e.includes("Vulva examination")||(f["Vulva inspection abnormalities"]=[]),e!=null&&e.includes("Other genital abnormalities")||(f["Other genital abnormality notes"]=""),f}},{componentType:"checkboxField",header:"What are the urethral meatus abnormalities for the patient?",name:"Urethral meatus abnormalities",type:"multiple",options:[{value:"Oedema",label:"Oedema"},{value:"Abnormal discharge",label:"Abnormal discharge"},{value:"Bleeding",label:"Bleeding"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&A&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Urethral meatus abnormal")},{componentType:"checkboxField",header:"What Vulva abnormalities does the patient have?",name:"Vulva inspection abnormalities",type:"multiple",options:[{value:"Oedematous cervix",label:"Oedematous cervix"},{value:"Abnormal vaginal discharge",label:"Abnormal vaginal discharge"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&V&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Vulva examination")},{componentType:"inputField",header:"Specify genital abnormality",name:"Other genital abnormality notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Other genital abnormalities")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Extremities normal?",name:"Extremities normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,t)=>{if(e==="Yes")return{"Abnormality for extremities":[],"Other extremities abnormalities notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities for extremities?",name:"Abnormality for extremities",type:"multiple",options:[{value:"Cold and clammy",label:"Cold and clammy"},{value:"Generalized oedema",label:"Generalized oedema"},{value:"Fracture",label:"Fracture"},{value:"Extremity burns",label:"Extremity burns"},{value:"Extremity rash",label:"Extremity rash"},{value:"Deformity",label:"Deformity"},{value:"Finger clubbing",label:"Finger clubbing"},{value:"Decreased Power",label:"Decreased Power"},{value:"Decreased Sensation",label:"Decreased Sensation"},{value:"Other extremities abnormality",label:"Other extremities abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Extremities normal"]==="No",onChange:(e,t)=>{if(!(e!=null&&e.includes("Other extremities abnormality")))return{"Other extremities abnormalities notes":""}}},{componentType:"inputField",header:"Specify extremity abnormality",name:"Other extremities abnormalities notes",icon:ae.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Extremities normal"]==="No"&&Array.isArray(e["Abnormality for extremities"])&&e["Abnormality for extremities"].includes("Other extremities abnormality")}]});return{resetForm:o,physicalExaminationFormSection:a}},Kn=ce({__name:"PhysicalExamination",setup(c,{expose:h}){const o=zn(),a=n(null),S=n(0),A=Pe(),{patient:V}=Ee(A);Ce(()=>{var t;return(t=V.value)==null?void 0:t.patientID},async(t,f)=>{t&&t!==f&&(S.value++,await be())});const B=async()=>{if(!a.value)return console.error("Form reference is not available"),!1;if(a.value.validateForm())return ye("Please fix validation errors before submitting"),!1;const f=a.value.getFormValues(),_=await i(f);return _.length===0?(ye("No physical examination data to save"),!1):(await q.addObsToEncounterPatient(_,ee.PHYSICAL_EXAMINATION),S.value++,await be(),Le("Physical examination saved successfully"),!0)},i=async t=>{const f=[];for(const[_,w]of Object.entries(t))!w||w===!1||w===""||(typeof w=="boolean"&&w===!0?f.push(await q.buildValueText("Physical examination finding",_)):typeof w=="string"&&f.push(await q.buildValueText(_,w)));return f};ke(async()=>{await be()});const e=W(()=>o.physicalExaminationFormSection.value);return h({validateForm:()=>{var t;return(t=a.value)==null?void 0:t.validateForm()},onSubmit:B,resetForm:()=>{S.value++}}),(t,f)=>(s(),k(Ke,{formData:e.value,ref_key:"formRef",ref:a,key:S.value},null,8,["formData"]))}}),Xn={key:0},Jn={class:"ion-padding",slot:"content"},Qn={class:"nav-buttons"},Zn={class:"ion-padding",slot:"content"},eo={class:"nav-buttons"},to={class:"ion-padding",slot:"content"},ao={class:"nav-buttons"},no={class:"ion-padding",slot:"content"},oo={class:"nav-buttons"},io={class:"ion-padding",slot:"content"},so={class:"nav-buttons"},lo={class:"ion-padding",slot:"content"},ro={class:"nav-buttons"},co=ce({__name:"ClinicalAssessment",setup(c,{expose:h}){const o=n("loc"),a=n(0),S=n(!1),A=n(!1),V=new Pt,B=Pe(),i=()=>{a.value++},e=n(null),t=n(null),f=n(null),_=n(null),w=n(null),r=n(null),N=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>V.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}];async function H(){const U=Ue.getSessionDate(),d=[ee.ASSESSMENT,ee.PRESENTING_COMPLAINTS,ee.PAST_MEDICAL_HISTORY,ee.PHYSICAL_EXAMINATION,ee.MEDICAL_HISTORY,ee.PREGNANCY_STATUS];let M=!1;for(const Q of d)try{const O=await q.getObsByEncounterIdAndDate(Q);if(O&&O.some(Y=>Y.obs_datetime?Me.toStandardHisFormat(Y.obs_datetime)===Me.toStandardHisFormat(U):!1)){M=!0;break}}catch(O){console.error("Error checking observations for encounter type ".concat(Q,":"),O)}S.value=M}ke(H),Ce(()=>B.patient,H);const T=W(()=>S.value),I=W(()=>N.filter(U=>typeof U.show=="function"?U.show():U.show)),$=U=>{const d=N.find(M=>M.id===U);return d?typeof d.show=="function"?d.show():d.show:!1},R=U=>I.value.findIndex(d=>d.id===U),K=U=>{const d=R(U);d>0&&(o.value=I.value[d-1].id)},J=U=>{const M=R(U)+1;M<I.value.length?o.value=I.value[M].id:(o.value="",i())};return h({onSubmit:async()=>{const U=[{ref:e,name:"PresentingComplaints"},{ref:t,name:"LevelOfConsciousness"},{ref:f,name:"PastMedicalHistory"},{ref:w,name:"PregnancyBreastfeeding"},{ref:r,name:"PhysicalExamination"},{ref:_,name:"Allergies"}];for(const d of U)if(d.ref.value&&typeof d.ref.value.onSubmit=="function")try{const M=await d.ref.value.onSubmit();if(d.name==="PresentingComplaints"&&M===!1)return}catch(M){if(console.error("Error calling ".concat(d.name," onSubmit:"),M),d.name==="PresentingComplaints")return}else console.log("".concat(d.name," component ref not available or no onSubmit method"))}}),(U,d)=>(s(),D(se,null,[T.value?(s(),D("div",Xn,[u(p(re),{lines:"none"},{default:y(()=>[u(p(fe),null,{default:y(()=>[...d[14]||(d[14]=[F("Switch between Capture Mode and Summary Mode",-1)])]),_:1}),u(p(ea),{checked:A.value,onIonChange:d[0]||(d[0]=M=>A.value=M.detail.checked),slot:"end"},null,8,["checked"])]),_:1}),A.value?v("",!0):(s(),k(Ln,{key:a.value}))])):v("",!0),!T.value||A.value?(s(),k(p(ta),{key:1,style:{width:"100%"}},{default:y(()=>[u(p(nt),{value:o.value,"onUpdate:value":d[13]||(d[13]=M=>o.value=M),ref:"accordionGroup",class:"previousView"},{default:y(()=>[$("loc")?(s(),k(p(Ae),{key:0,value:"loc",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[15]||(d[15]=[F("Level of consciousness",-1)])]),_:1})]),_:1}),l("div",Jn,[u(wa,{"is-active":o.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:t,onDataSaved:i},null,8,["is-active"]),l("div",Qn,[R("loc")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[1]||(d[1]=he(M=>K("loc"),["stop"]))},{default:y(()=>[...d[16]||(d[16]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[2]||(d[2]=he(M=>J("loc"),["stop"]))},{default:y(()=>[F(P(R("loc")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0),$("pc")?(s(),k(p(Ae),{key:1,value:"pc",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[17]||(d[17]=[F(" Presenting complaints - ",-1),l("span",{class:"required-badge"},"Required",-1)])]),_:1})]),_:1}),l("div",Zn,[u(La,{"is-active":o.value==="pc",onDataSaved:i,ref_key:"presentingComplaintsFormRef",ref:e},null,8,["is-active"]),l("div",eo,[R("pc")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[3]||(d[3]=he(M=>K("pc"),["stop"]))},{default:y(()=>[...d[18]||(d[18]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[4]||(d[4]=he(M=>J("pc"),["stop"]))},{default:y(()=>[F(P(R("pc")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0),$("pbs")?(s(),k(p(Ae),{key:2,value:"pbs",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[19]||(d[19]=[F("Pregnancy and breastfeeding status",-1)])]),_:1})]),_:1}),l("div",to,[u(qn,{"is-active":o.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:w,onDataSaved:i},null,8,["is-active"]),l("div",ao,[R("pbs")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[5]||(d[5]=he(M=>K("pbs"),["stop"]))},{default:y(()=>[...d[20]||(d[20]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[6]||(d[6]=he(M=>J("pbs"),["stop"]))},{default:y(()=>[F(P(R("pbs")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0),$("pmh")?(s(),k(p(Ae),{key:3,value:"pmh",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[21]||(d[21]=[F("Past medical history",-1)])]),_:1})]),_:1}),l("div",no,[u(jn,{"is-active":o.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:f,onDataSaved:i},null,8,["is-active"]),l("div",oo,[R("pmh")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[7]||(d[7]=he(M=>K("pmh"),["stop"]))},{default:y(()=>[...d[22]||(d[22]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[8]||(d[8]=he(M=>J("pmh"),["stop"]))},{default:y(()=>[F(P(R("pmh")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0),$("al")?(s(),k(p(Ae),{key:4,value:"al",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[23]||(d[23]=[F("Allergies",-1)])]),_:1})]),_:1}),l("div",io,[u(Pa,{"is-active":o.value==="al",ref_key:"allergiesFormRef",ref:_,onDataSaved:i},null,8,["is-active"]),l("div",so,[R("al")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[9]||(d[9]=he(M=>K("al"),["stop"]))},{default:y(()=>[...d[24]||(d[24]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[10]||(d[10]=he(M=>J("al"),["stop"]))},{default:y(()=>[F(P(R("al")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0),$("pe")?(s(),k(p(Ae),{key:5,value:"pe",class:"_card"},{default:y(()=>[u(p(re),{slot:"header",color:"light"},{default:y(()=>[u(p(fe),{class:"previousLabel"},{default:y(()=>[...d[25]||(d[25]=[F("Physical examination",-1)])]),_:1})]),_:1}),l("div",lo,[u(Kn,{"is-active":o.value==="pe",ref_key:"physicalExaminationFormRef",ref:r,onDataSaved:i},null,8,["is-active"]),l("div",ro,[R("pe")>0?(s(),k(p(pe),{key:0,fill:"outline",onClick:d[11]||(d[11]=he(M=>K("pe"),["stop"]))},{default:y(()=>[...d[26]||(d[26]=[F(" Back ",-1)])]),_:1})):v("",!0),u(p(pe),{fill:"outline",onClick:d[12]||(d[12]=he(M=>J("pe"),["stop"]))},{default:y(()=>[F(P(R("pe")<I.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):v("",!0)]),_:1},8,["value"])]),_:1})):v("",!0)],64))}}),Oi=Ne(co,[["__scopeId","data-v-f7298259"]]),uo={class:"allergies-section"},mo={class:"allergies-container"},po={class:"medication-section"},ho={class:"medication-content"},fo={key:0,class:"add-medication-form"},yo={class:"form-group"},vo={class:"option-label"},bo={key:0,class:"error-message"},go={class:"form-row"},_o={class:"form-group"},Co={key:0,class:"error-message"},Do={class:"form-group"},wo={key:0,class:"error-message"},Oo={class:"form-group"},Ao={key:0,class:"error-message"},xo={class:"action-buttons"},ko={class:"notes-section"},Po={class:"notes-content"},So={class:"notes-input-container"},To={class:"ion-padding",slot:"content"},Eo={class:"notes-timeline"},No={key:0,class:"note-entry"},Io={class:"note-date"},Fo={class:"note-content"},Vo={class:"ion-padding",slot:"content"},Ho={class:"note-date"},Mo={class:"note-content"},Bo=ce({watch:{},name:"xxxComponent"}),Yo=ce({...Bo,setup(c){const h=ae,o=Ea,a=n(!1),S=n(!1),A=n(!0),V=n(0),B=n(""),i=n(!1),e=n(),t=n(!1),f=n(""),_=n(""),w=n(""),r=n(""),N=n(""),H=n(""),T="Add new medication",I=He(),$=kt(),R=W(()=>$.selectedMedicalAllergiesList),K=W(()=>I.selectedMedicalDrugsList),J=W(()=>I.partialOPDdrugList),ve=W(()=>I.nonPharmalogicalTherapyAndOtherNotes),U=["first","second","third"],d=n(),M=n(),Q=n(),O=n(!1),Y=n(!1),L=n("Show more notes"),te=n(),j=n(),Z=n(),de=W(()=>I.editingDrugItem),ue=n("Select a route"),De=n(!1),Be=n("Select frequency"),me=n(!1),Ye=n("Select drug"),Ie=n(!1),ne=n(),oe=n(),_e=n(),we=n([]),m=n([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),g=W(()=>we.value.length?we.value:m.value);function E(C){ne.value=C}async function z(){return await Na()}async function $e(C=5,b=1e3){let x=0;for(;x<C&&(we.value=await z(),!(we.value.length>0));)x++,await new Promise(G=>setTimeout(G,b));we.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}ke(async()=>{const C=new Ia,{previousDrugPrescriptions:b,previousClinicalNotes:x,previousDrugAllergies:G}=await C.getPatientEncounters();d.value=b,M.value=Object.entries(x)[0];const[,...X]=Object.entries(x);Q.value=X,te.value=Object.entries(G)[0];const[,...ie]=Object.entries(G);j.value=ie,await $e()}),Ce(()=>_.value,async C=>{Nt()}),Ce(()=>w.value,async C=>{it()});function Fe(){if(Se.isEmpty(ne.value)==!0)return De.value=!0,!1;if(Se.isEmpty(ne.value)==!1)return De.value=!1,!0}function Ge(){if(Se.isEmpty(oe.value)==!0)return me.value=!0,!1;if(Se.isEmpty(oe.value)==!1)return me.value=!1,!0}function qe(){if(Se.isEmpty(_e.value)==!0)return Ie.value=!0,!1;if(Se.isEmpty(_e.value)==!1)return Ie.value=!1,!0}function Et(){A.value=!A.value,a.value=!0,i.value=!1,t.value=!1}async function Nt(){return rt(_.value)?i.value=!1:(B.value="please enter a number",i.value=!0),i.value}async function it(){return rt(w.value)?t.value=!1:(e.value="please enter a number",t.value=!0),t.value}async function st(){const C=await it(),b=Ge(),x=qe(),G=Fe();return!C&&b==!0&&x==!0&&G==!0}function It(C){oe.value=C}async function lt(){try{const C=()=>Z.value.dose_strength!=null&&Z.value.dose_strength?Math.trunc(Z.value.dose_strength):1;if(de.value!==null){if(!await st()){ye("Please enter correct data values",4e3);return}const x=Ue.getSessionDate(),G=ct(x,parseInt(w.value));let X=!1;Xe(Z.value)==!0&&(X=!0);const ie={drugName:f.value,dose:C(),frequency:oe.value.label,frequency_code:oe.value.code,duration:w.value,prescription:G,drug_id:H.value,units:N.value,route_concept_id:ne.value.concept_id,route_name:ne.value.name,highlightbackground:X},Je=He();console.log(Je.setSelectedMedicalDrugsList([ie])),Je.editingDrugItem=null,A.value=!0}else{if(!await st()){ye("Please enter correct data values",4e3);return}Ut();const x=Ue.getSessionDate(),G=ct(x,parseInt(w.value));let X=!1;Xe(Z.value)==!0&&(X=!0);const ie={drugName:f.value,dose:C(),frequency:oe.value.label,frequency_code:oe.value.code,duration:w.value,prescription:G,drug_id:H.value,units:N.value,route_concept_id:ne.value.concept_id,route_name:ne.value.name,highlightbackground:X};He().setSelectedMedicalDrugsList([ie])}H.value="",f.value="",_.value="",oe.value=null,w.value="",r.value="",V.value++,_e.value=null,ne.value=null}catch(C){console.error("Error saving data:",C)}}async function Ft(C){const b=C,X=await pa.getOfflineOPDDrugs({name:b,page:1,page_size:10});X.map(ie=>({label:ie.name,value:ie.name,other:ie})),I.setPartialOPDdrugList(X)}function Xe(C){const b=[];return R.value.forEach(G=>{G.selected&&b.push(G.concept_id)}),Vt([C],b)==!0?(ye("Client is allergic to the selected medication",4e6),!0):!1}function Vt(C,b){try{return C.some(x=>b.includes(x.concept_id))}catch(x){return!1}}function Ht(C){C&&(f.value=C.name,H.value=C.drug_id,N.value=C.units,Z.value=C,Xe(C))}function Mt(C){const b=K.value[C],x=He();x.removeDrugById(b.drug_id),x.editingDrugItem=b,H.value="",f.value="",_.value="",oe.value=null,w.value="",r.value="",_e.value=null,ne.value=null,H.value=b.drug_id,f.value=b.drugName,_.value=b.dose,oe.value={label:b.frequency,code:b.frequency_code},w.value=b.duration,r.value=b.prescription;const G=J.value.find(X=>X.name===b.drugName);G&&(_e.value=G),ne.value={concept_id:b.route_concept_id,name:b.route_name},A.value=!1,V.value++}function Bt(){if(de.value!==null){H.value="",f.value="",_.value="",oe.value=null,w.value="",r.value="",_e.value=null,ne.value=null;const C=He();C.setSelectedMedicalDrugsList([de.value]),C.editingDrugItem=null}A.value=!0,V.value++}function Yt(C){K.value.splice(C,1),V.value++,ye("you have removed a drug from list",6e3)}function $t(C){let b=C.target.value;Rt(b)}function Rt(C){He().setNonPharmalogicalTherapyAndOtherNotes(C)}function rt(C){return/^[0-9]+$/.test(C)}function ct(C,b){const x=new Date(C);x.setDate(x.getDate()+b);const G=x.getFullYear(),X=String(x.getMonth()+1).padStart(2,"0"),ie=String(x.getDate()).padStart(2,"0");return"".concat(G,"-").concat(X,"-").concat(ie)}function Ut(){a.value=!1,S.value=!0,A.value=!0}function Lt(C){U.filter(x=>x!==C.detail.value);const b=C.detail.value;b!==void 0?b=="third"&&(L.value="Show less notes",Y.value=!O.value):(L.value="Show more notes",Y.value=!O.value)}function Gt(C){return C[1]}function qt(C){(C.key==="Enter"||C.key==="ArrowDown")&&(C.preventDefault(),lt())}const Ve=W(()=>[{showAddItemButton:!0,addItemButton:!0,name:de.value!==null?"Update":"ADD",fn:lt},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",fn:Wt}]),Wt=async()=>{ma(St,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to cancel?"},{cancel:G=>{},confirm:async G=>{G.detail==!0&&Bt()}})};return(C,b)=>(s(),k(p(xt),null,{default:y(()=>[l("div",uo,[l("div",mo,[u(Tt)])]),l("div",po,[u(p(re),{lines:"none",class:"section-header"},{default:y(()=>[u(p(je),{icon:p(ot),class:"section-icon"},null,8,["icon"]),u(p(fe),{class:"section-title",style:{"margin-top":"12px"}},{default:y(()=>[...b[9]||(b[9]=[F("Medication",-1)])]),_:1})]),_:1}),l("div",ho,[(s(),k(Sa,{_selectedMedicalDrugsList:K.value,onEditItem:Mt,onRemoveItem:Yt,key:V.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),A.value?v("",!0):(s(),D("div",fo,[l("div",yo,[b[10]||(b[10]=l("label",{class:"input-label"},"Medication",-1)),u(p(Re),{modelValue:_e.value,"onUpdate:modelValue":[b[0]||(b[0]=x=>_e.value=x),b[1]||(b[1]=x=>Ht(x))],options:J.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:b[2]||(b[2]=x=>Ft(x))},{option:y(x=>[l("div",vo,P(x.option.name),1)]),_:1},8,["modelValue","options"]),Ie.value?(s(),D("div",bo,P(Ye.value),1)):v("",!0)]),l("div",go,[l("div",_o,[b[11]||(b[11]=l("label",{class:"input-label"},"Route",-1)),u(p(Re),{modelValue:ne.value,"onUpdate:modelValue":[b[3]||(b[3]=x=>ne.value=x),b[4]||(b[4]=x=>E(x))],options:g.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id",disabled:!1},null,8,["modelValue","options"]),De.value?(s(),D("div",Co,P(ue.value),1)):v("",!0)]),l("div",Do,[b[12]||(b[12]=l("label",{class:"input-label"},"Frequency",-1)),u(p(Re),{modelValue:oe.value,"onUpdate:modelValue":[b[5]||(b[5]=x=>oe.value=x),b[6]||(b[6]=x=>It(x))],options:p(o),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),me.value?(s(),D("div",wo,P(Be.value),1)):v("",!0)]),l("div",Oo,[b[13]||(b[13]=l("label",{class:"input-label"},"Duration (days)",-1)),u(p(aa),{modelValue:w.value,"onUpdate:modelValue":b[7]||(b[7]=x=>w.value=x),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:qt},null,8,["modelValue"]),t.value?(s(),D("div",Ao,P(e.value),1)):v("",!0)])]),l("div",xo,[Ve.value[0].addItemButton?(s(),k(Te,{key:0,name:Ve.value[0].name,icon:p(Ot),"onClicked:btn":Ve.value[0].fn,class:"save-button"},null,8,["name","icon","onClicked:btn"])):v("",!0),Ve.value[1].addItemButton?(s(),k(Te,{key:1,name:Ve.value[1].name,icon:p(At),"onClicked:btn":Ve.value[1].fn,class:"cancel-button"},null,8,["name","icon","onClicked:btn"])):v("",!0)])])),A.value?(s(),k(Te,{key:1,name:T,icon:p(ze),fontWeight:"600","onClicked:btn":Et,class:"add-new-button"},null,8,["icon"])):v("",!0)])]),l("div",ko,[u(p(re),{lines:"none",class:"section-header"},{default:y(()=>[u(p(je),{icon:p(na),class:"section-icon"},null,8,["icon"]),u(p(fe),{class:"section-title"},{default:y(()=>[...b[14]||(b[14]=[F("Non-pharmacological therapy and other notes",-1)])]),_:1})]),_:1}),l("div",Po,[u(Ta,{class:"intervention-component"}),l("div",So,[u(p(re),{class:"notes-input-item"},{default:y(()=>[u(p(je),{slot:"start",icon:p(h).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),u(p(oa),{modelValue:ve.value,"onUpdate:modelValue":b[8]||(b[8]=x=>ve.value=x),onIonInput:$t,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),u(p(nt),{ref:"accordionGroup",class:"previous-notes"},{default:y(()=>[u(p(Ae),{value:"fourth","toggle-icon-slot":"start"},{default:y(()=>[u(p(re),{slot:"header",color:"light",class:"previous-notes-header"},{default:y(()=>[u(p(fe),null,{default:y(()=>[...b[15]||(b[15]=[F("Previous visit notes",-1)])]),_:1})]),_:1}),l("div",To,[l("div",Eo,[(s(!0),D(se,null,ge(M.value,(x,G)=>(s(),D(se,{key:G},[G===1?(s(),D("div",No,[(s(!0),D(se,null,ge(x,(X,ie)=>(s(),D("div",{key:ie},[l("div",Io,P(X.date),1),l("div",Fo,P(X.notes),1)]))),128))])):v("",!0)],64))),128)),u(p(nt),{onIonChange:Lt},{default:y(()=>[u(p(Ae),{value:"third","toggle-icon-slot":"start"},{default:y(()=>[u(p(re),{slot:"header",color:"light",class:"show-more-header"},{default:y(()=>[u(p(fe),{color:"primary"},{default:y(()=>[F(P(L.value),1)]),_:1})]),_:1}),l("div",Vo,[(s(!0),D(se,null,ge(Q.value,(x,G)=>(s(),D("div",{key:G,class:"note-entry"},[(s(!0),D(se,null,ge(Gt(x),(X,ie)=>(s(),D("div",{key:ie},[l("div",Ho,P(X.date),1),l("div",Mo,P(X.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1}))}}),Ai=Ne(Yo,[["__scopeId","data-v-14c793af"]]);function $o(){return{showConfirm:async h=>{const o=await ia.create({component:St,componentProps:{message:h},cssClass:"otherVitalsModal"});return await o.present(),new Promise(a=>{const S=()=>{o.removeEventListener("confirm",S),a(!0)},A=()=>{o.removeEventListener("cancel",A),a(!1)};o.addEventListener("confirm",S),o.addEventListener("cancel",A),o.onDidDismiss().then(()=>a(!1))})}}}const Ro={class:"form-grid"},Uo={class:"form-field"},Lo={class:"form-field"},Go={class:"form-field"},qo={class:"form-field"},Wo={key:0,class:"form-field checkbox-field"},jo={class:"form-field"},zo={class:"form-field"},Ko={class:"form-field"},Xo={class:"form-field full-width"},Jo={key:1,class:"form-field full-width"},Qo={key:2,class:"form-field full-width"},Zo={key:3,class:"form-field full-width"},ei={class:"form-field"},ti={class:"form-field"},ai={class:"form-field"},ni={class:"form-field"},oi={class:"form-field full-width"},ii={class:"button-container"},si=ce({name:"xxxComponent"}),li=ce({...si,emits:["dataSaved"],setup(c,{emit:h}){const o=n(),a=n("gurdian phone number");n(!0);const S=n(),A=n(),{showConfirm:V}=$o();ke(async()=>{});const B=W(()=>{const m=N.value.find(g=>g.selected);return(m==null?void 0:m.name)==="Other - specify"}),i=W(()=>{const m=H.value.find(g=>g.selected);return(m==null?void 0:m.name)==="Other - specify"}),e=W(()=>new Pt().isChildBearing()),t=W(()=>{const m=N.value.find(g=>g.selected);return(m==null?void 0:m.name)==="Accident"}),f=[{placeHolder:{default:"Enter time of death if known"},property_name:"timeOfDeath",dataHandler:ve,dataValue:n(),show_error:n(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time arrived"},property_name:"timeArrived",dataHandler:U,dataValue:n(),show_error:n(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time confirming death"},property_name:"timeOfDeathConfirmation",dataHandler:d,dataValue:n(),show_error:n(!1),error_message:"Time required",skip_validation:!1}],_=[{placeHolder:{default:"Enter date of death"},property_name:"dateOfDeath",dataHandler:M,dataValue:n(),show_error:n(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date arrived"},property_name:"dateArrived",dataHandler:Q,dataValue:n(),show_error:n(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date confirming death"},property_name:"dateOfDeathConfirmation",dataHandler:O,dataValue:n(),show_error:n(!1),error_message:"Date required",type:"date",skip_validation:!1}],w=[{lblTxt:"Was the individual pregnant at the time of death?",value:n(!1),show_error:n(!1),error_message:"Please indicate pregnancy status",skip_validation:!1}],r=[{placeHolder:"Enter place of death",property_name:"placeOfDeath",dataHandler:Y,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter name of guardian",property_name:"nameOfGuardian",dataHandler:L,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter name of person confirming death",property_name:"nameOfPersonConfirmindDeath",dataHandler:te,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter position of the person confirming death",property_name:"positionOfthePersonConfirmingDeath",dataHandler:j,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!1},{placeHolder:"Enter medical council registration number of the person confirming death",property_name:"medicalConcilRegistrationNumberOfThePersonConfirmingDeath",dataHandler:Z,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters and numbers are allowed",type:"alphanumeric",skip_validation:!1},{placeHolder:"Specify other cause of death",property_name:"otherNotes",dataHandler:de,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!0},{placeHolder:"Specify other accident cause of death",property_name:"otherNotes",dataHandler:ue,dataValue:n(),show_error:n(!1),error_message:"Input required, Only letters allowed",type:"text",skip_validation:!0}],N=n([{id:1,name:"Natural",selected:!1},{id:2,name:"Accident",selected:!1},{id:3,name:"Homicide",selected:!1},{id:4,name:"Suicide",selected:!1},{id:5,name:"Pending investigation",selected:!1},{id:6,name:"Could not be determined",selected:!1},{id:7,name:"Other - specify",selected:!1}]),H=n([{id:1,name:"Motor vehicle (passenger)",selected:!1},{id:2,name:"Motor vehicle (pedestrian)",selected:!1},{id:3,name:"Drowning",selected:!1},{id:4,name:"Other - specify",selected:!1}]),T=[{multi_Selection:!1,manner_of_death_Selection_value:n(),show_list_label:!0,unqueId:"qwerty",name_of_list:"Manner of death ",property_name:"mannerOfDeath",placeHolder:"Choose one",items:N.value,listUpdatedFN:De,listFilteredFN:()=>{},use_internal_filter:!0,disabled:n(!1),show_error:n(!1),error_message:"selection required"},{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty1hjkn",name_of_list:"How did it occur?",property_name:"howDiditOccur",placeHolder:"Choose one",items:H.value,listUpdatedFN:Ie,listFilteredFN:()=>{},use_internal_filter:!0,disabled:n(!0),show_error:n(!1),error_message:"selection required"}],I=()=>{R($,"Are you sure you want to cancel? Unsaved data will be lost.")};function $(){J()}const R=async(m,g="Do you want to save changes?")=>{await V(g)&&m()},K=h;function J(m={dataSaved:!0}){K("dataSaved",m)}function ve(m){f[0].dataValue.value=m}function U(m){f[1].dataValue.value=m}function d(m){f[2].dataValue.value=m}function M(m){const g={day:m.value.day,month:m.value.month,year:m.value.year,formattedDate:m.value.formattedDate};_[0].dataValue.value=g}function Q(m){const g={day:m.value.day,month:m.value.month,year:m.value.year,formattedDate:m.value.formattedDate};_[1].dataValue.value=g,console.log(_[2].dataValue.value)}function O(m){const g={day:m.value.day,month:m.value.month,year:m.value.year,formattedDate:m.value.formattedDate};_[2].dataValue.value=g,console.log(_[2].dataValue.value)}function Y(m){const g=m.target.value;r[0].dataValue.value=g}function L(m){const g=m.target.value;r[1].dataValue.value=g}function te(m){const g=m.target.value;r[2].dataValue.value=g}function j(m){const g=m.target.value;r[3].dataValue.value=g}function Z(m){const g=m.target.value;r[4].dataValue.value=g}function de(m){const g=m.target.value;r[5].dataValue.value=g}function ue(m){const g=m.target.value;r[6].dataValue.value=g}function De(m){N.value.forEach(E=>E.selected=!1);const g=N.value.find(E=>E.id==m.id);m.name!=="Accident"&&(A.value=null,Ye(),r[6].dataValue.value=""),m.name!=="Other - specify"&&(r[5].dataValue.value=""),g.selected=!0}const me=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:async()=>{R(ne,"Do you want to save the death outcome?")}},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:I}];function Ye(){H.value.forEach(m=>{m.selected=!1})}function Ie(m){H.value.forEach(E=>E.selected=!1);const g=H.value.find(E=>E.id==m.id);m.name!=="Other - specify"&&(r[6].dataValue.value=""),g.selected=!0}async function ne(){try{const m=et(r),g=et(_),E=et(f);if(!m||!E)return;_e();const z=Se.merge(tt(r),tt(_),tt(f),we(T[0]),we(T[1])),Fe=[{concept_id:11520,value_coded:11520,child:oe(z),obs_datetime:Me.sessionDate()}];await q.addObsToEncounterPatient(Fe,ee.PATIENT_OUTCOME),Le("Patient outcome saved successfully"),J()}catch(m){ha("Failed to save patient outcome"),console.error(m)}}const oe=m=>{var z,$e,Fe,Ge,qe;const g=Me.sessionDate(),E=[];return(z=m.dateOfDeath)!=null&&z.formattedDate&&E.push({concept_id:1815,value_text:m.dateOfDeath.formattedDate,obs_datetime:g}),($e=m.dateArrived)!=null&&$e.formattedDate&&E.push({concept_id:7398,value_text:m.dateArrived.formattedDate,obs_datetime:g}),(Fe=m.timeOfDeath)!=null&&Fe.time&&E.push({concept_id:9161,value_text:m.timeOfDeath.time,obs_datetime:g}),(Ge=m.timeArrived)!=null&&Ge.time&&E.push({concept_id:5605,value_text:m.timeArrived.time,obs_datetime:g}),(qe=m.timeOfDeathConfirmation)!=null&&qe.time&&E.push({concept_id:1345,value_text:m.timeOfDeathConfirmation.time,obs_datetime:g}),m.mannerOfDeath&&E.push({concept_id:5002,value_text:m.mannerOfDeath,obs_datetime:g}),m.positionOfthePersonConfirmingDeath&&E.push({concept_id:7837,value_text:m.positionOfthePersonConfirmingDeath,obs_datetime:g}),m.nameOfGuardian&&E.push({concept_id:1824,value_text:m.nameOfGuardian,obs_datetime:g}),m.nameOfPersonConfirmindDeath&&E.push({concept_id:2122,value_text:m.nameOfPersonConfirmindDeath,obs_datetime:g}),m.medicalConcilRegistrationNumberOfThePersonConfirmingDeath&&E.push({concept_id:9763,value_text:m.medicalConcilRegistrationNumberOfThePersonConfirmingDeath,obs_datetime:g}),E};function _e(){const m=N.value.find(g=>g.selected);if(m){if(T[0].show_error.value=!1,m.name==="Accident")if(H.value.find(E=>E.selected))T[1].show_error.value=!1;else return T[1].show_error.value=!0,!1}else return T[0].show_error.value=!0,!1;return!0}function we(m){const g=[];let E={};return m.items.forEach(z=>{z.selected==!0&&g.push({property_name:m.property_name,name:z.name})}),g.length>0&&(E[g[0].property_name]=g[0].name),E}return(m,g)=>{const E=xe("ion-label");return s(),D("div",Ro,[l("div",Uo,[u(Oe,{placeholder:r[0].placeHolder,icon:p(sa),inputValue:r[0].dataValue.value,"onUpdate:inputValue":r[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[0].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[0].error_message),1)]),_:1})):v("",!0)]),l("div",Lo,[u(Ze,{place_holder:_[0].placeHolder,onDateUpDated:_[0].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[0].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(_[0].error_message),1)]),_:1})):v("",!0)]),l("div",Go,[u(at,{place_holder:f[0].placeHolder,onTimeUpDated:f[0].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[0].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(f[0].error_message),1)]),_:1})):v("",!0)]),l("div",qo,[u(Oe,{placeholder:r[1].placeHolder,icon:p(Ct),inputValue:r[1].dataValue.value,"onUpdate:inputValue":r[1].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[1].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[1].error_message),1)]),_:1})):v("",!0)]),e.value?(s(),D("div",Wo,[u(p(la),{modelValue:w[0].value.value,"onUpdate:modelValue":g[0]||(g[0]=z=>w[0].value.value=z),alignment:"start",class:"ion-lblCls"},{default:y(()=>[F(P(w[0].lblTxt),1)]),_:1},8,["modelValue"]),w[0].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(w[0].error_message),1)]),_:1})):v("",!0)])):v("",!0),l("div",jo,[u(Oe,{placeholder:a.value,icon:p(ra),modelValue:o.value,"onUpdate:modelValue":g[1]||(g[1]=z=>o.value=z)},null,8,["placeholder","icon","modelValue"])]),l("div",zo,[u(Ze,{place_holder:_[1].placeHolder,onDateUpDated:_[1].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[1].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(_[1].error_message),1)]),_:1})):v("",!0)]),l("div",Ko,[u(at,{place_holder:f[1].placeHolder,onTimeUpDated:f[1].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[1].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(f[1].error_message),1)]),_:1})):v("",!0)]),l("div",Xo,[u(p(Re),{modelValue:S.value,"onUpdate:modelValue":[g[2]||(g[2]=z=>S.value=z),g[3]||(g[3]=z=>De(z))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom",placeholder:"Manner of death",selectLabel:"",label:"name",searchable:!0,"track-by":"id",options:N.value},null,8,["modelValue","options"]),T[0].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(T[0].error_message),1)]),_:1})):v("",!0)]),B.value?(s(),D("div",Jo,[u(Oe,{placeholder:r[5].placeHolder,icon:p(Qe),inputValue:r[5].dataValue.value,"onUpdate:inputValue":r[5].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[5].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[5].error_message),1)]),_:1})):v("",!0)])):v("",!0),t.value?(s(),D("div",Qo,[u(p(Re),{modelValue:A.value,"onUpdate:modelValue":[g[4]||(g[4]=z=>A.value=z),g[5]||(g[5]=z=>Ie(z))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom",placeholder:"How did it occur?",selectLabel:"",label:"name",searchable:!0,"track-by":"id",options:H.value},null,8,["modelValue","options"]),T[1].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(T[1].error_message),1)]),_:1})):v("",!0)])):v("",!0),i.value?(s(),D("div",Zo,[u(Oe,{placeholder:r[6].placeHolder,icon:p(Qe),inputValue:r[6].dataValue.value,"onUpdate:inputValue":r[6].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[6].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[6].error_message),1)]),_:1})):v("",!0)])):v("",!0),l("div",ei,[u(Ze,{place_holder:_[2].placeHolder,onDateUpDated:_[2].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[2].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(_[2].error_message),1)]),_:1})):v("",!0)]),l("div",ti,[u(at,{place_holder:f[2].placeHolder,onTimeUpDated:f[2].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[2].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(f[2].error_message),1)]),_:1})):v("",!0)]),l("div",ai,[u(Oe,{placeholder:r[2].placeHolder,icon:p(Ct),inputValue:r[2].dataValue.value,"onUpdate:inputValue":r[2].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[2].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[2].error_message),1)]),_:1})):v("",!0)]),l("div",ni,[u(Oe,{placeholder:r[3].placeHolder,icon:p(ot),inputValue:r[3].dataValue.value,"onUpdate:inputValue":r[3].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[3].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[3].error_message),1)]),_:1})):v("",!0)]),l("div",oi,[u(Oe,{placeholder:r[4].placeHolder,icon:p(Qe),inputValue:r[4].dataValue.value,"onUpdate:inputValue":r[4].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r[4].show_error.value?(s(),k(E,{key:0,class:"error-label"},{default:y(()=>[F(P(r[4].error_message),1)]),_:1})):v("",!0)]),l("div",ii,[(s(),k(Te,{key:0,name:me[0].name,fill:me[0].btnFill,icon:p(Ot),"onClicked:btn":me[0].fn},null,8,["name","fill","icon","onClicked:btn"])),(s(),k(Te,{key:1,name:me[1].name,fill:me[1].btnFill,icon:p(At),"onClicked:btn":me[1].fn},null,8,["name","fill","icon","onClicked:btn"]))])])}}}),ri=Ne(li,[["__scopeId","data-v-827718e5"]]),ci={class:"dash_box"},di={key:1},ui=ce({name:"xxxComponent"}),mi=ce({...ui,setup(c){const h=n("No outcome created yet"),o=n(!1),a=n("please select a type"),S=n(!0),A=n(""),V=n(!0),B=n(!1),i=fa(),e=W(()=>i.outcomes),t=n(!1),f=n(!1),_=n(!1),w=n(!1),r=n(!1),N=n(!1),H=n([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1},{name:"Death",selected:!1}]),T=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:H.value,listUpdatedFN:I,listFilteredFN:()=>{},use_internal_filter:!0,disabled:n(!1)}];function I(d){H.value=d,H.value.forEach(M=>{M.selected==!0&&(A.value=M.name)})}ke(async()=>{R()}),Ce(()=>A.value,async d=>{t.value==!0?t.value=!1:ve()}),Ce(()=>e.value.length,async d=>{R()});function $(){H.value.forEach(d=>{d.selected=!1}),A.value=""}function R(){e.value.length>0?V.value=!1:e.value.length==0&&B.value==!1&&(V.value=!0)}function K(d){e.value.splice(d,1)}const J=d=>{console.log(d)};async function ve(d=!0){const M=A.value;console.log(M),A.value=M;const Q=A.value;Q==H.value[0].name?_.value=!0:_.value=!1,Q==H.value[1].name?(w.value=!0,console.log("show_discharged_options is set to true")):w.value=!1,Q==H.value[2].name?(r.value=!0,console.log("show_discharged_options is set to true")):r.value=!1,Q==H.value[3].name?N.value=!0:N.value=!1,Q==H.value[4].name?f.value=!0:f.value=!1}function U(){f.value=!1,_.value=!1,w.value=!1,r.value=!1,$()}return(d,M)=>{const Q=xe("ion-row");return s(),k(p(xt),null,{default:y(()=>[u(Q,null,{default:y(()=>[u(p(Dt),null,{default:y(()=>[(s(),k(Fa,{key:0,"onUpdate:removeItem":K,"onUpdate:editItem":J,displayData:e.value},null,8,["displayData"]))]),_:1})]),_:1}),V.value?(s(),k(Q,{key:0},{default:y(()=>[l("span",ci,P(h.value),1)]),_:1})):v("",!0),S.value?(s(),D("div",di,[u(Q,null,{default:y(()=>[u(p(Dt),null,{default:y(()=>[u(ya,{multiSelection:T[0].multi_Selection,show_label:T[0].show_list_label,uniqueId:T[0].unqueId,name_of_list:T[0].name_of_list,choose_place_holder:T[0].placeHolder,"items_-list":T[0].items,use_internal_filter:T[0].use_internal_filter,disabled:T[0].disabled.value,onItemListUpDated:T[0].listUpdatedFN,onItemListFiltered:T[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),l("div",null,[o.value?(s(),k(p(fe),{key:0,class:"error-label"},{default:y(()=>[F(P(a.value),1)]),_:1})):v("",!0)])]),_:1})]),_:1})])):v("",!0),_.value?(s(),k(Va,{key:2,onDataSaved:U,selected_ward_prop:"",admitted_other_props:""})):v("",!0),w.value?(s(),k(Ha,{key:3,onDataSaved:U,selected_referral_data:"",selected_other_referral_data:""})):v("",!0),r.value?(s(),k(Ma,{key:4,onDataSaved:U,selected_discharged_prop:"",selected_discharged_data:""})):v("",!0),f.value?(s(),k(ri,{key:5,onDataSaved:U})):v("",!0),N.value?(s(),k(Ba,{key:6,onDataSaved:U})):v("",!0)]),_:1})}}}),xi=Ne(mi,[["__scopeId","data-v-5c28f6ca"]]);export{Oi as C,xi as O,La as P,qn as _,Kn as a,Ai as b};
