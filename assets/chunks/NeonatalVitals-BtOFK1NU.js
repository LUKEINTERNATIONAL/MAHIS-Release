import{d as D,r as y,eR as O,c as F,b as J,w as S,e as w,f as A,k as H,l as T,K as Y,u as C,D as K,a3 as X,a6 as G,an as q,aU as Q,eS as Z,H as W,O as ee,J as z}from"./vendor-BpjEhVym.js";import{aD as M,_ as b,T as te,u as ae,aY as E,t as j,ag as I,ch as oe,G as ne}from"../index-3yAmd6Ip.js";import{a as h,b as R,d as re,N as se}from"./NeonatalStepper-DtSNtvrl.js";import{N as ie}from"./neonatal_service-DvkNQ1I3.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DMAoEdNS.js";import"./SaveProgressModal-UUZh5kA3.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const ce={class:"neonatal-vitals-section"},le={class:"respiratory-timer-body"},ue={class:"respiratory-timer-time"},me={class:"respiratory-timer-instruction"},U=60,pe=D({__name:"VitalSignsSection",setup(l,{expose:_}){const a=y(null),c=h.find(r=>r.title==="Vital Signs");if(!c)throw new Error("[VitalSignsSection] Missing configuration for Vital Signs section");const n=O(R),m=y(U),s=y(!1),u=y(!1);let e=null;const t=F(()=>{const r=Math.floor(m.value/60).toString().padStart(2,"0"),o=(m.value%60).toString().padStart(2,"0");return"".concat(r,":").concat(o)}),v=F(()=>s.value?"TAP TO PAUSE COUNTDOWN":m.value===U?"TAP TO START COUNTDOWN":m.value===0?"TAP TO RESTART COUNTDOWN":"TAP TO RESUME COUNTDOWN"),g=()=>{e===null&&(s.value=!0,u.value=!1,e=window.setInterval(()=>{m.value>0?m.value-=1:(s.value=!1,u.value=!0,e!==null&&(clearInterval(e),e=null))},1e3))},d=()=>{e!==null&&(clearInterval(e),e=null),s.value=!1},V=()=>{d(),m.value=U,u.value=!1},N=()=>{s.value?d():(m.value===0&&V(),g())};J(()=>{e!==null&&clearInterval(e)});const k=F(()=>c.formData.map(r=>{var p,f;if(!r.name||!n)return{...r};const o=n[r.name],i=r.componentType==="switchField"?o!=null?o:null:(f=(p=o!=null?o:r.initialValue)!=null?p:r.value)!=null?f:"";return{...r,initialValue:i}})),P=c.conditionalRules||[],x=r=>{var o,i;n&&(n.respiratory_rate=r.respiratory_rate||"",n.heart_rate=r.heart_rate||"",n.can_measure_oxygen_saturation=(o=r.can_measure_oxygen_saturation)!=null?o:null,n.oxygen_saturation=r.oxygen_saturation||"",n.can_measure_temperature=(i=r.can_measure_temperature)!=null?i:null,n.temperature=r.temperature||"")};return S(()=>{var r;return(r=a.value)==null?void 0:r.formValues},r=>{r&&x(r)},{deep:!0}),S(()=>a.value,r=>{r!=null&&r.getFormValues&&x(r.getFormValues())},{immediate:!0}),_({getFormRef:()=>a.value,validateForm:()=>{var r,o;return((o=(r=a.value)==null?void 0:r.validateForm)==null?void 0:o.call(r))||null},getFormValues:()=>{var r,o;return((o=(r=a.value)==null?void 0:r.getFormValues)==null?void 0:o.call(r))||{}}}),(r,o)=>(A(),w("div",ce,[H("div",{class:"respiratory-timer-card",onClick:N},[H("div",le,[H("div",ue,Y(t.value),1),H("div",me,Y(v.value),1)])]),T(M,{formData:k.value,conditionalRules:C(P),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),fe=b(pe,[["__scopeId","data-v-19d42943"]]),_e={class:"neonatal-vitals-section"},ge=D({__name:"WeightMeasurementsSection",setup(l,{expose:_}){const a=y(null),c=h.find(e=>e.title==="Weight Measurements");if(!c)throw new Error("[WeightMeasurementsSection] Missing configuration for Weight Measurements section");const n=O(R),m=F(()=>c.formData.map(e=>{var v,g;if(!e.name||!n)return{...e};const t=n[e.name];return{...e,initialValue:(g=(v=t!=null?t:e.initialValue)!=null?v:e.value)!=null?g:""}})),s=c.conditionalRules||[],u=e=>{n&&(n.current_weight=e.current_weight||"",n.head_circumference=e.head_circumference||"")};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&u(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&u(e.getFormValues())},{immediate:!0}),_({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(A(),w("div",_e,[T(M,{formData:m.value,conditionalRules:C(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),de=b(ge,[["__scopeId","data-v-7a8515ce"]]),ve={class:"neonatal-vitals-section"},Se=D({__name:"BloodSugarSection",setup(l,{expose:_}){const a=y(null),c=h.find(e=>e.title==="Blood Sugar");if(!c)throw new Error("[BloodSugarSection] Missing configuration for Blood Sugar section");const n=O(R),m=F(()=>c.formData.map(e=>{var g,d,V,N;if(!e.name||!n)return{...e};const t=n[e.name];if(e.name==="blood_sugar")return{...e,initialValue:(d=(g=t!=null?t:e.initialValue)!=null?g:e.value)!=null?d:"",initialUnit:n.blood_sugar_unit||e.initialUnit||"mg/dL"};const v=e.componentType==="switchField"?t!=null?t:null:(N=(V=t!=null?t:e.initialValue)!=null?V:e.value)!=null?N:"";return{...e,initialValue:v}})),s=c.conditionalRules||[],u=e=>{var t;n&&(n.can_measure_blood_sugar=(t=e.can_measure_blood_sugar)!=null?t:null,n.blood_sugar=e.blood_sugar||"",n.blood_sugar_unit=e.blood_sugar_unit||n.blood_sugar_unit||"mg/dL")};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&u(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&u(e.getFormValues())},{immediate:!0}),_({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(A(),w("div",ve,[T(M,{formData:m.value,conditionalRules:C(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),ye=b(Se,[["__scopeId","data-v-bfd75302"]]),he={class:"neonatal-vitals-section"},Ne=D({__name:"HypoglycemiaSymptomaticSection",setup(l,{expose:_}){const a=y(null),c=h.find(e=>e.title==="Hypoglycemia-Symptomatic");if(!c)throw new Error("[HypoglycemiaSymptomaticSection] Missing configuration for Hypoglycemia-Symptomatic section");const n=O(R),m=F(()=>c.formData.map(e=>{var g,d;if(!e.name||!n)return{...e};const t=n[e.name],v=e.componentType==="switchField"?t!=null?t:null:(d=(g=t!=null?t:e.initialValue)!=null?g:e.value)!=null?d:"";return{...e,initialValue:v}})),s=c.conditionalRules||[],u=e=>{n&&Object.assign(n,e)};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&u(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&u(e.getFormValues())},{immediate:!0}),_({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(A(),w("div",he,[T(M,{formData:m.value,conditionalRules:C(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),Te=b(Ne,[["__scopeId","data-v-34b36eb5"]]),Fe={class:"neonatal-vitals-section"},Ve=D({__name:"HypoglycemiaAsymptomaticSection",setup(l,{expose:_}){const a=y(null),c=h.find(e=>e.title==="Hypoglycemia-Asymptomatic");if(!c)throw new Error("[HypoglycemiaAsymptomaticSection] Missing configuration for Hypoglycemia-Asymptomatic section");const n=O(R),m=F(()=>c.formData.map(e=>{var g,d;if(!e.name||!n)return{...e};const t=n[e.name],v=e.componentType==="switchField"?t!=null?t:null:(d=(g=t!=null?t:e.initialValue)!=null?g:e.value)!=null?d:"";return{...e,initialValue:v}})),s=c.conditionalRules||[],u=e=>{n&&Object.assign(n,e)};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&u(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&u(e.getFormValues())},{immediate:!0}),_({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(A(),w("div",Fe,[T(M,{formData:m.value,conditionalRules:C(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),Ie=b(Ve,[["__scopeId","data-v-a5dcc574"]]),De={class:"neonatal-vitals-section"},Ae=D({__name:"VitalsSummarySection",setup(l,{expose:_}){const a=y(null),c=h.find(s=>s.title==="Vitals Summary");if(!c)throw new Error("[VitalsSummarySection] Missing configuration for Vitals Summary section");const n=O(R),m=F(()=>c.formData.map(s=>{if(s.componentType!=="summaryField"||!n)return{...s};const u=s.builder;return{...s,builder:e=>{if(typeof u!="function")return[];const t={...n||{},...e};return u(t)}}}));return _({getFormRef:()=>a.value,validateForm:()=>null,getFormValues:()=>({...n||{}})}),(s,u)=>(A(),w("div",De,[T(M,{formData:m.value,ref_key:"formRef",ref:a},null,8,["formData"])]))}}),be=b(Ae,[["__scopeId","data-v-fbe7c51f"]]),$=()=>JSON.parse(JSON.stringify(re)),Re=K("neonatalVitalsStore",{state:()=>({activePatientId:null,formData:$(),formCache:{}}),actions:{initializeForPatient(l){if(l==null){this.activePatientId=null,Object.assign(this.formData,$());return}this.activePatientId=l;const _=String(l),a=this.formCache[_];a?Object.assign(this.formData,a):Object.assign(this.formData,$()),this.saveSnapshot()},saveSnapshot(){if(this.activePatientId==null)return;const l=String(this.activePatientId);this.formCache[l]=JSON.parse(JSON.stringify(this.formData))},resetActiveForm(){Object.assign(this.formData,$()),this.saveSnapshot()},clearPatient(l){delete this.formCache[String(l)],this.activePatientId===l&&this.resetActiveForm()}},persist:{paths:["activePatientId","formData","formCache"]}}),Ee=D({name:"NeonatalVitals",components:{IonPage:G,IonContent:X,Toolbar:te,NeonatalStepper:se},setup(){const l=q(),_=ae(),{patient:a}=Q(_),c=Re(),n=o=>{const i=Number(o);return Number.isFinite(i)?i:null},m=()=>{var i;const o=n((i=a.value)==null?void 0:i.patientID);c.initializeForPatient(o)};m(),S(()=>{var o;return(o=a.value)==null?void 0:o.patientID},()=>m());const s=c.formData;Z(R,s),S(()=>c.formData,()=>c.saveSnapshot(),{deep:!0});const u=y(h.map((o,i)=>({title:o.title,number:i+1,checked:!1,class:i===0?"open_step common_step":"common_step",last_step:i===h.length-1?"last_step":""}))),e=o=>h.findIndex(i=>i.title===o),t=[{title:"Vital Signs",value:"1",component:fe,configIndex:e("Vital Signs")},{title:"Weight Measurements",value:"2",component:de,configIndex:e("Weight Measurements")},{title:"Blood Sugar",value:"3",component:ye,configIndex:e("Blood Sugar")},{title:"Hypoglycemia-Symptomatic",value:"4",component:Te,configIndex:e("Hypoglycemia-Symptomatic")},{title:"Hypoglycemia-Asymptomatic",value:"5",component:Ie,configIndex:e("Hypoglycemia-Asymptomatic")},{title:"Vitals Summary",value:"6",component:be,configIndex:e("Vitals Summary")}],v="Neonatal Vital Signs",g=y("1"),d=o=>{o&&o.value&&u.value.forEach((i,p)=>{o.value===(p+1).toString()?(i.class="open_step common_step",i.checked=!1):p<parseInt(o.value)-1?(i.class="common_step color_white",i.checked=!0):(i.class="common_step",i.checked=!1)})},V=o=>(o!=null?o:"").trim().toUpperCase(),N=[{encounterType:E.NEONATAL_SIGNS_SYMPTOMS,route:"/neonatal/signs-symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS"]},{encounterType:E.NEONATAL_REVIEW_OF_SYSTEMS,route:"/neonatal/review-of-systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"]},{encounterType:E.PHYSICAL_EXAMINATION_BABY,route:"/neonatal/general-examination",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"]},{encounterType:E.VITALS,route:"/neonatal/vitals",encounterNames:["VITALS","NEONATAL VITALS"]},{encounterType:E.NEONATAL_SYSTEMIC_EXAMINATION,route:"/neonatal/SystemicExamination",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"]}],k=N[N.length-1].route,P=new Map;N.forEach(o=>{o.encounterNames.forEach(i=>{P.set(V(i),o.encounterType)})});const x=o=>{const i=new Set;o.forEach(f=>{const L=V(f),B=P.get(L);B!==void 0&&i.add(B)});const p=N.find(f=>!i.has(f.encounterType));return p?p.route:k};return{wizardData:u,stepperData:t,stepperTitle:v,currentOpenStepper:g,updateStatus:d,getSaveFunction:o=>o===t.length-1?async()=>{var i;if(!((i=a.value)!=null&&i.patientID)){j("No patient selected");return}try{const p=[];if(s.respiratory_rate&&p.push(await I.buildValueNumber("Respiratory rate",Number(s.respiratory_rate))),s.heart_rate&&p.push(await I.buildValueNumber("Pulse",Number(s.heart_rate))),s.oxygen_saturation&&p.push(await I.buildValueNumber("Oxygen saturation",Number(s.oxygen_saturation))),s.temperature&&p.push(await I.buildValueNumber("Temperature (C)",Number(s.temperature))),s.current_weight&&p.push(await I.buildValueNumber("Weight (kg)",Number(s.current_weight)/1e3)),s.head_circumference&&p.push(await I.buildValueNumber("Head circumference",Number(s.head_circumference))),s.blood_sugar){let f=Number(s.blood_sugar);(s.blood_sugar_unit||"mg/dL")==="mmol/L"&&(f=f*18.018),p.push(await I.buildValueNumber("Blood sugar",f))}await oe(a.value.patientID,E.VITALS,p),ne("Vital signs recorded successfully"),c.clearPatient(a.value.patientID);try{const f=await ie.getSavedEncounters(a.value.patientID),L=Array.isArray(f==null?void 0:f.encounters)?f.encounters:[],B=x(L);l.push(B)}catch(f){console.error("Error determining next admission step:",f),l.push({path:"/patientProfile"})}}catch(p){console.error("Failed to save vital signs",p),j("Failed to save vital signs")}}:null,neonatalVitalsSections:h}}});function Oe(l,_,a,c,n,m){const s=W("Toolbar"),u=W("NeonatalStepper"),e=W("ion-content"),t=W("ion-page");return A(),ee(t,{class:"neonatal-vitals-page"},{default:z(()=>[T(s),T(e,{fullscreen:!0},{default:z(()=>[T(u,{wizardData:l.wizardData,StepperData:l.stepperData,stepperTitle:l.stepperTitle,openStepper:l.currentOpenStepper,backUrl:"/patientProfile",flowType:"vitals",getSaveFunction:l.getSaveFunction,sectionsConfig:l.neonatalVitalsSections,onUpdateStatus:l.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","sectionsConfig","onUpdateStatus"])]),_:1})]),_:1})}const $e=b(Ee,[["render",Oe],["__scopeId","data-v-5f1f2ad2"]]);export{$e as default};
