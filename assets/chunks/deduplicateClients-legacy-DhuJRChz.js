System.register(["./vendor-legacy-CdypqbXP.js","./NavigationMenu-legacy-CXr9qK9O.js","./bottomNavBar-legacy-BwgxPjnI.js","../index-legacy-a_4iRUcf.js","./EIRreportsStore-legacy-CgG4vUEp.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-DPlv51y0.js"],function(e,a){"use strict";var t,l,n,i,o,r,d,c,s,u,m,p,g,_,f,y,v,h,b,I,C,P,k,w,x,D,z,N,S,B,V,U,M,j,$,O,E,G,L,Q,A,F,H,R,J,K,T,W,Z,q,X,Y,ee,ae,te,le;return{setters:[e=>{t=e.d,l=e.I,n=e.M,i=e.e_,o=e.e$,r=e.f0,d=e.bO,c=e.cB,s=e.bu,u=e.d$,m=e.L,p=e.N,g=e.bC,_=e.aV,f=e.aR,y=e.ae,v=e.aS,h=e.bw,b=e.a2,I=e.a6,C=e.ah,P=e.ad,k=e.ac,w=e.bs,x=e.ab,D=e.r,z=e.c,N=e.bW,S=e.bV,B=e.f1,V=e.f2,U=e.f3,M=e.dp,j=e.cc,$=e.f4,O=e.f5,E=e.H,G=e.O,L=e.f,Q=e.J,A=e.l,F=e.e,H=e.F,R=e.P,J=e.k,K=e.m,T=e.p,W=e.K,Z=e.Q},e=>{q=e.N},e=>{X=e.B},e=>{Y=e.P,ee=e.Z,ae=e.t,te=e._},e=>{le=e.E},null,null],execute:function(){var a=document.createElement("style");a.textContent=".selected-client[data-v-4495dd33]{--background: var(--ion-color-primary-tint);--color: var(--ion-color-primary-contrast)}.selected-client ion-label h2[data-v-4495dd33]{font-weight:700}.client-container[data-v-4495dd33]{position:relative}.sticky-header[data-v-4495dd33]{position:sticky;top:0;z-index:10;background-color:var(--ion-background-color)}.client-details[data-v-4495dd33]{padding-left:16px;padding-right:16px}ion-badge[data-v-4495dd33]{margin-right:8px}ion-card-content ion-icon[data-v-4495dd33]{font-size:1.2em;margin-right:8px}h2[data-v-4495dd33]{font-size:1rem;font-weight:700;color:var(--ion-color-primary)}ion-searchbar[data-v-4495dd33]{--background: var(--ion-color-light);--border-radius: 8px;margin-bottom:1px}ion-item-sliding[data-v-4495dd33]{margin-bottom:8px}.sticky-footer[data-v-4495dd33]{margin-top:auto;position:relative;box-shadow:0 -2px 5px rgba(0,0,0,.1)}ion-footer[data-v-4495dd33]{width:100%;box-shadow:0 -2px 5px rgba(0,0,0,.1)}\n/*$vite$:1*/",document.head.appendChild(a);const ne=t({name:"ClientDeduplication",components:{IonContent:x,IonGrid:w,IonRow:k,IonCol:P,IonList:C,IonItem:I,IonLabel:b,IonCard:h,IonCardHeader:v,IonPage:y,IonCardTitle:f,IonCardContent:_,IonCheckbox:g,IonButton:p,IonIcon:m,IonAvatar:u,IonBadge:s,NavigationMenu:q,IonCardSubtitle:c,IonSearchbar:d,IonItemSliding:r,IonItemOption:o,IonItemOptions:i,IonFooter:n,bottomNavBar:X,IonHeader:l},setup(){const e=D([]),a=D([]),t=D(null),l=D(33),n=D(""),i=D(0),o=D(1),r=D(10),d=z(()=>!0),c=async()=>{try{le().setNavigationPayload("Client De-Duplication",!0,!1,"/","home","");const t=await Y.getCachedClientProfileDuplicates(o.value,r.value);e.value=t.results,i.value=t.count,a.value=e.value}catch(t){console.error("Error fetching duplicate clients:",t)}};return{clients:e,filteredClients:a,selectedPrimaryClient:t,toggleClientDetails:e=>{t.value===e?t.value=null:t.value=e},hasSelectedDuplicates:e=>e.duplicates.some(e=>e.selected),mergeSelected:async e=>{const a=e.duplicates.filter(e=>e.selected),n={primary:{patient_id:e.primary_patient_id},secondary:a.map(e=>({patient_id:e.secondary_patient_id})),program_id:l.value};try{console.log("Merge Payload:",n),await Y.mergePatients(n),t.value=null,ee("Clients merged successfully"),await c()}catch(i){console.error("Error merging clients:",i),ae("Failed to merge clients. Please try again.")}},programId:l,initNavData:c,getGenderIcon:e=>"M"===e.toUpperCase()?$:O,searchQuery:n,filterClients:()=>{n.value?a.value=e.value.filter(e=>{const a=`${e.primary_given_name} ${e.primary_family_name}`.toLowerCase(),t=n.value.toLowerCase(),l=String(e.primary_patient_id);return a.includes(t)||l.includes(t)}):a.value=e.value},viewDetails:e=>{console.log("View details for:",e)},personCircle:j,calendar:M,fingerPrint:U,location:V,linkOutline:B,chevronDown:S,chevronUp:N,showNavBar:d,totalCount:i,currentPage:o,itemsPer_Page:r,handlePaginationUpdate:async({page:e,itemsPerPage:a})=>{o.value=e,r.value=a,await c()}}},watch:{$route:{handler(e){"Deduplicateclients"===e.name&&this.initNavData()},immediate:!0}},mounted(){this.initNavData()}}),ie={class:"sticky-header"},oe={key:0,class:"client-details"};e("default",te(ne,[["render",function(e,a,t,l,n,i){const o=E("NavigationMenu"),r=E("ion-searchbar"),d=E("ion-col"),c=E("ion-row"),s=E("ion-header"),u=E("ion-icon"),m=E("ion-avatar"),p=E("ion-label"),g=E("ion-badge"),_=E("ion-item"),f=E("ion-card-subtitle"),y=E("ion-card-header"),v=E("ion-grid"),h=E("ion-card-content"),b=E("ion-card"),I=E("ion-checkbox"),C=E("ion-item-option"),P=E("ion-item-options"),k=E("ion-item-sliding"),w=E("ion-list"),x=E("ion-button"),D=E("ion-content"),z=E("bottomNavBar"),N=E("ion-footer"),S=E("ion-page");return L(),G(S,null,{default:Q(()=>[A(o),A(s,{style:{"background-color":"transparent"},class:"ion-no-border"},{default:Q(()=>[A(c,null,{default:Q(()=>[A(d,{size:"12","size-md":"10","size-lg":"8","offset-md":"1","offset-lg":"2"},{default:Q(()=>[A(r,{placeholder:"Search clients",modelValue:e.searchQuery,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchQuery=a),onIonInput:e.filterClients},null,8,["modelValue","onIonInput"])]),_:1})]),_:1})]),_:1}),A(D,null,{default:Q(()=>[A(v,null,{default:Q(()=>[A(c,null,{default:Q(()=>[A(d,{size:"12","size-md":"10","size-lg":"8","offset-md":"1","offset-lg":"2"},{default:Q(()=>[A(b,null,{default:Q(()=>[A(h,null,{default:Q(()=>[A(w,null,{default:Q(()=>[(L(!0),F(H,null,R(e.filteredClients,t=>(L(),F("div",{key:t.primary_patient_id,class:"client-container"},[J("div",ie,[A(_,{button:"",onClick:a=>e.toggleClientDetails(t),class:T({"selected-client":e.selectedPrimaryClient===t})},{default:Q(()=>[A(m,{slot:"start"},{default:Q(()=>[A(u,{icon:e.personCircle,size:"large",color:e.selectedPrimaryClient===t?"primary":"medium"},null,8,["icon","color"])]),_:2},1024),A(p,null,{default:Q(()=>[J("h2",null,W(t.primary_given_name)+" "+W(t.primary_family_name),1),J("p",null,"ID: "+W(t.primary_patient_id),1)]),_:2},1024),A(g,{color:"warning",slot:"end"},{default:Q(()=>[Z(W(t.duplicates.length),1)]),_:2},1024),A(u,{icon:e.selectedPrimaryClient===t?e.chevronUp:e.chevronDown,slot:"end"},null,8,["icon"])]),_:2},1032,["onClick","class"])]),e.selectedPrimaryClient===t?(L(),F("div",oe,[A(b,{style:{"margin-bottom":"10px","margin-top":"5px"}},{default:Q(()=>[A(y,{color:"light"},{default:Q(()=>[A(f,null,{default:Q(()=>[...a[1]||(a[1]=[Z("Primary Client Details",-1)])]),_:1})]),_:1}),A(h,null,{default:Q(()=>[A(v,null,{default:Q(()=>[A(c,null,{default:Q(()=>[A(d,{size:"12","size-md":"6"},{default:Q(()=>[A(_,{lines:"none"},{default:Q(()=>[A(u,{icon:e.calendar,slot:"start",color:"primary"},null,8,["icon"]),A(p,null,{default:Q(()=>[Z("Birth Date: "+W(t.primary_birthdate),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),A(d,{size:"12","size-md":"6"},{default:Q(()=>[A(_,{lines:"none"},{default:Q(()=>[A(u,{icon:e.getGenderIcon(t.primary_gender),slot:"start",color:"primary"},null,8,["icon"]),A(p,null,{default:Q(()=>[Z("Gender: "+W(t.primary_gender),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),A(c,null,{default:Q(()=>[A(d,{size:"12"},{default:Q(()=>[A(_,{lines:"none"},{default:Q(()=>[A(u,{icon:e.location,slot:"start",color:"primary"},null,8,["icon"]),A(p,{class:"ion-text-wrap"},{default:Q(()=>[Z(" Address: "+W(t.primary_home_village)+", "+W(t.primary_home_ta)+", "+W(t.primary_home_district),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),A(b,null,{default:Q(()=>[A(y,{color:"light"},{default:Q(()=>[A(f,null,{default:Q(()=>[...a[2]||(a[2]=[Z("Potential Duplicates",-1)])]),_:1})]),_:1}),A(h,null,{default:Q(()=>[A(w,null,{default:Q(()=>[(L(!0),F(H,null,R(t.duplicates,t=>(L(),G(k,{key:t.secondary_patient_id},{default:Q(()=>[A(_,null,{default:Q(()=>[A(I,{slot:"start",modelValue:t.selected,"onUpdate:modelValue":e=>t.selected=e},null,8,["modelValue","onUpdate:modelValue"]),A(p,null,{default:Q(()=>[J("h2",null,W(t.secondary_given_name)+" "+W(t.secondary_family_name),1),A(g,{color:"primary"},{default:Q(()=>[Z("Match: "+W(t.match_percentage)+"%",1)]),_:2},1024),J("p",null,"ID: "+W(t.secondary_patient_id),1),J("p",null," Birth Date: "+W(t.secondary_birthdate)+" | Gender: "+W(t.secondary_gender),1),J("p",null," Address: "+W(t.secondary_home_village)+", "+W(t.secondary_home_ta)+", "+W(t.secondary_home_district),1)]),_:2},1024)]),_:2},1024),A(P,{side:"end"},{default:Q(()=>[A(C,{color:"primary",onClick:a=>e.viewDetails(t)},{default:Q(()=>[...a[3]||(a[3]=[Z("View",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),A(x,{expand:"block",onClick:a=>e.mergeSelected(t),disabled:!e.hasSelectedDuplicates(t),class:"ion-margin-top"},{default:Q(()=>[A(u,{icon:e.linkOutline,slot:"start"},null,8,["icon"]),a[4]||(a[4]=Z(" Merge Selected ",-1))]),_:1},8,["onClick","disabled"])])):K("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),A(N,{class:"sticky-footer"},{default:Q(()=>[A(c,null,{default:Q(()=>[A(d,{size:"12",style:{"max-width":"100%"}},{default:Q(()=>[e.showNavBar?(L(),G(z,{key:0,totalItems:e.totalCount,currentPage:e.currentPage,itemsPerPage:e.itemsPer_Page,"onUpdate:pagination":e.handlePaginationUpdate},null,8,["totalItems","currentPage","itemsPerPage","onUpdate:pagination"])):K("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-4495dd33"]]))}}});
