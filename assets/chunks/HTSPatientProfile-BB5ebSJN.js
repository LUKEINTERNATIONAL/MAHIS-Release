import{d as ie,r as R,c as ee,e as $,f as h,bF as Ue,p as ve,bt as nt,k as a,l as s,F as de,P as ce,W as at,J as n,u as e,a6 as z,L as ke,X,K as C,a5 as se,H as ge,Q as p,R as Qe,a as Se,b2 as $e,O as Q,m as J,bd as Ce,N as j,b1 as lt,bD as qe,$ as U,d0 as ot,bj as ze,I as je,G as Ke,E as Ye,aW as Ge,a4 as Je,M as it,ap as rt,w as Xe,c$ as ut,dV as dt,am as ct,al as _e,ak as pt,bz as xe,b6 as vt}from"./vendor-CzFJ4KTZ.js";import{l as mt}from"./lodash-NJiRuGo9.js";import{l as be,_ as re,aD as te,aE as he,H as ue,S as ye,ag as ft,aU as _t,G as Ie,u as Fe,t as Re,af as we,bm as pe,m as Z,O as Ze,J as yt,j as gt,P as ht}from"../index-CmeorCN9.js";import{N as wt}from"./vaccines_service-B8ikxPnx.js";import{u as bt}from"./usePatientProfile-BZ6rcqJY.js";import xt from"./WeightHeightChart-nzhibzsH.js";import{O as Tt,w as kt}from"./weightAndHeight-S8XzCoro.js";import"./apexcharts-C9muk_WD.js";import"./sms_service-C7cixsG6.js";import"./EIRreportsStore-Bm2_2gSo.js";import"./Export-2rkA9GHs.js";import"./Registration-h33tILUs.js";import"./useLocation-Cafaofbj.js";import"./user_role_management-CmP_x9xl.js";import"./useNeonatalEnrollmentStore-gP4YJ0fZ.js";import"./enrollment-DU-PLRUa.js";import"./Outcome-CVELDwm-.js";import"./wardsStore-APM5K_Vb.js";import"./chartjs-DOB13Wxe.js";import"./BasicForm-C_DF_-63.js";import"./DateInputField-C2D86UT4.js";import"./customDatePicker-cXedrwSU.js";import"./VitalsMixin.vue_vue_type_script_lang-BhXddGmG.js";import"./formatServerData-CgQTXtYD.js";const Ct=["onKeydown"],It={class:"ripple-container"},Rt=["onAnimationend"],St={class:"status-badge"},$t={class:"ion-text-wrap"},Ft=ie({__name:"ReferralCard",props:{status:{type:String,default:"Referred OPD"},title:{type:String,required:!0},type:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},emits:["pressed","click"],setup(E,{emit:x}){const k=E,D=x,w=R(!1),_=R(null),g=R([]);let y=0;const A=ee(()=>{if(k.disabled)return"timeline-item-disabled";switch(k.type){case"hiv":return"timeline-item-hiv";case"hepatitis":return"timeline-item-hepatitis";default:return"timeline-item-default"}}),q=ee(()=>{if(k.disabled)return"icon-container-disabled";switch(k.type){case"hiv":return"icon-container-hiv";case"hepatitis":return"icon-container-hepatitis";default:return"icon-container-default"}}),N=l=>{if(k.disabled||!_.value)return;const c=_.value.getBoundingClientRect(),b=Math.max(c.width,c.height)*2;let P,W;if(l.type==="keydown")P=c.width/2-b/2,W=c.height/2-b/2;else{const r=l.type.includes("touch")?l.touches[0].clientX:l.clientX,u=l.type.includes("touch")?l.touches[0].clientY:l.clientY;P=r-c.left-b/2,W=u-c.top-b/2}const G={id:y++,x:P,y:W,size:b,duration:600};g.value.push(G)},M=l=>{const c=g.value.findIndex(b=>b.id===l);c>-1&&g.value.splice(c,1)},v=l=>{k.disabled||(N(l),D("pressed",{type:k.type,title:k.title,status:k.status,event:l}),D("click",l))},T=l=>{k.disabled||(w.value=!0,N(l))},O=()=>{w.value=!1},i=()=>{w.value=!1},H=l=>{k.disabled||(w.value=!0,N(l))},d=()=>{w.value=!1};return(l,c)=>(h(),$("div",{class:ve(["timeline-item",A.value,{"timeline-item-pressed":w.value}]),onClick:v,onMousedown:T,onMouseup:O,onMouseleave:i,onTouchstart:H,onTouchend:d,role:"button",tabindex:"0",onKeydown:[Ue(v,["enter"]),Ue(nt(v,["prevent"]),["space"])],ref_key:"timelineElement",ref:_},[a("div",It,[(h(!0),$(de,null,ce(g.value,b=>(h(),$("div",{key:b.id,class:"ripple",style:at({left:b.x+"px",top:b.y+"px",width:b.size+"px",height:b.size+"px",animationDuration:b.duration+"ms"}),onAnimationend:P=>M(b.id)},null,44,Rt))),128))]),s(e(se),null,{default:n(()=>[s(e(z),{class:"ion-text-center"},{default:n(()=>[a("div",null,[s(e(ke),{class:ve(["icon-container",q.value]),icon:e(be).greenInjection,"aria-hidden":"true"},null,8,["class","icon"])])]),_:1}),s(e(z),{class:"ion-text-center"},{default:n(()=>[s(e(X),null,{default:n(()=>[a("span",St,C(E.status),1)]),_:1})]),_:1}),s(e(z),{class:"ion-text-center"},{default:n(()=>[s(e(X),null,{default:n(()=>[a("h2",$t,C(E.title),1)]),_:1})]),_:1})]),_:1})],42,Ct))}}),Dt=re(Ft,[["__scopeId","data-v-3af6644b"]]),Ht={style:{"padding-left":"10px","padding-right":"10px"}},Mt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Ot=ie({__name:"RiskCategoryFollowUpModal",setup(E){const x=R(null),k=ee(()=>[{componentType:"multiSelectInputField",header:"Risk Category",name:"risk_category",trackBy:"id",validation:te.required,options:[{id:"1",name:"Sex worker"},{id:"2",name:"MSM"},{id:"3",name:"AGYW"},{id:"4",name:"Client of sex workers"},{id:"5",name:"Female sex workers"},{id:"6",name:"Risk age group"},{id:"7",name:"None"}]}]),D=async()=>{var _,g;const w=(_=x.value)==null?void 0:_.getFormValues();console.log("ðŸš€ ~ save ~ result:",w),await Qe.dismiss((g=w==null?void 0:w.risk_category)==null?void 0:g.name)};return(w,_)=>{const g=ge("ion-button");return h(),$("div",Ht,[_[3]||(_[3]=a("div",{class:"content"},[a("h4",null,"Risk Category & Follow-up")],-1)),a("div",null,[s(he,{formData:k.value,ref_key:"formRef",ref:x},null,8,["formData"])]),a("div",Mt,[s(g,{color:"danger"},{default:n(()=>[..._[1]||(_[1]=[p("Cancel",-1)])]),_:1}),s(g,{onClick:_[0]||(_[0]=y=>D())},{default:n(()=>[..._[2]||(_[2]=[p("Save",-1)])]),_:1})])])}}}),Vt=re(Ot,[["__scopeId","data-v-fdbc4375"]]),Pt={style:{"padding-left":"10px","padding-right":"10px"}},Nt={class:"content"},Bt={style:{"margin-top":"10px"}},Et={style:{display:"flex","justify-content":"space-between",padding:"10px"}},At=ie({__name:"OutcomeSummaryModal",setup(E){const x=R(""),k=async()=>{x.value=ue.toStandardHisDisplayFormat(await ye.getApiDate())},D=R(null),w=[{header:"Outcome Summary",componentType:"textAreaField",name:"Outcome",icon:be.editPen,obsValueType:"value_text"},{componentType:"radioButtonField",header:"Is new positive?",name:"New Positive",obsValueType:"value_text",validation:te.required,type:"inline",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"radioButtonField",header:"Refer patient to ART clinic?",name:"ART referral",obsValueType:"value_text",validation:te.required,type:"inline",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]}],_=async()=>{var y;const g=(y=D.value)==null?void 0:y.getFormValues();await ft.buildSaveObs(g,_t.PATIENT_OUTCOME),await Qe.dismiss(),Ie("Outcome summary saved successfully.")};return Se(async()=>{await k()}),(g,y)=>{const A=ge("ion-button");return h(),$("div",Pt,[a("div",Nt,[y[2]||(y[2]=a("h4",null,"Patient Outcome",-1)),a("div",null,[y[1]||(y[1]=a("span",null,"Todays Date : ",-1)),a("span",null,C(x.value),1)])]),a("div",Bt,[s(he,{formData:w,ref_key:"formRef",ref:D},null,512)]),a("div",Et,[s(A,{onClick:y[0]||(y[0]=q=>_())},{default:n(()=>[...y[3]||(y[3]=[p("Complete",-1)])]),_:1})])])}}}),Wt=re(At,[["__scopeId","data-v-62e554aa"]]),Lt={style:{"padding-left":"10px","padding-right":"10px"}},Ut={class:"content"},qt={style:{"text-align":"center",padding:"15px"}},zt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},jt=ie({__name:"HIVTestingModal",props:{order:{}},setup(E){const x=R(null),k=Fe(),{patient:D}=$e(k),w=R([]),_=R(""),g=R(""),y=R(""),A=E,q=ee(()=>[{componentType:"radioButtonField",header:"Test Type",name:"test_type",obsValueType:"value_text",type:"inline",validation:te.required,onChange:r=>{M()},options:[{label:"Detremin",value:"Detremin"},{label:"Unigold",value:"Unigold"},{label:"Bioline",value:"Bioline"}]},{componentType:"inputField",header:"Test Kit Serial Number",name:"test_kit_serial_number",obsValueType:"value_text",icon:be.scanner,onChange:r=>{M()},validation:te.required},{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:te.required,type:"inline",onChange:r=>{M()},options:[{label:"Reactive",value:"Reactive"},{label:"Non reactive",value:"Non reactive"}]}]),N=()=>ye.getSessionDate(),M=()=>{var S;const r=(S=x.value)==null?void 0:S.getFormValues();if(!(r!=null&&r.test_results)){g.value="",y.value="";return}const u=r.test_type,m=r.test_results;u==="Detremin"?m==="Non reactive"?(g.value="risk_category",y.value="Continue to Risk Category"):m==="Reactive"&&(g.value="unigold",y.value="Continue to Unigold"):u==="Unigold"?m==="Non reactive"?(g.value="repeat_determine",y.value="Repeat Determine Test"):m==="Reactive"&&(g.value="bioline",y.value="Continue to Bioline"):u==="Bioline"&&(m==="Non reactive"?(g.value="inconclusive",y.value="Schedule Inconclusive Follow-up"):m==="Reactive"&&(g.value="Outcome summary",y.value="Continue to Summary"))},v=r=>{if(r!=null&&r.tests)return r.tests[0].name},T=async()=>{var ne,ae,le,o;if(((ne=x.value)==null?void 0:ne.validateForm())!=null){Re("Please fill in all required fields");return}const r=(ae=x.value)==null?void 0:ae.getFormValues(),u=r.test_type;w.value.push({type:u,result:r.test_results});let m=A.order,S="";const B=v(m)||m.value_text,I=await we.getConceptID(B,!0);m!=null&&m.new_order&&(S=await G(I,B,"Blood"));const F=await pe.buildResults([{name:"HIV test",concept_id:I,value:"".concat(u,"-").concat(r.test_results)}]),K=((o=(le=m==null?void 0:m.tests)==null?void 0:le[0])==null?void 0:o.id)||"";await pe.saveResults(D.value,F,K,S,_.value),l(u,r.test_results)?await c(u,r.test_results):Ie("Test result saved")},O=async()=>{var r,u,m,S,B,I,F;if(((r=x.value)==null?void 0:r.validateForm())!=null){Re("Please fill in all required fields");return}switch(await T(),g.value){case"risk_category":await d();const K=await Z(Vt,{class:"mediumAutoHeightModal"});K=="None"?await i():K&&(await H(),await i());break;case"unigold":(u=x.value)==null||u.resetForm(),(m=x.value)==null||m.setFormValue("test_type","Unigold");break;case"repeat_determine":(S=x.value)==null||S.resetForm(),(B=x.value)==null||B.setFormValue("test_type","Detremin");break;case"bioline":(I=x.value)==null||I.resetForm(),(F=x.value)==null||F.setFormValue("test_type","Bioline"),M();break;case"inconclusive":await P();break;case"Outcome summary":await i();break}},i=async()=>{await d(),await Z(Wt,{class:"mediumAutoHeightModal"})},H=async()=>(await d(),await Z(wt,{class:"mediumAutoHeightModal"})),d=async()=>{await Ce.getTop()&&await Ce.dismiss()},l=(r,u)=>r==="Detremin"&&u==="Non reactive"?!1:[...w.value].length>=3,c=async(r,u)=>{const m=w.value,S=m.find(F=>F.type==="Detremin"),B=m.find(F=>F.type==="Unigold"),I=m.find(F=>F.type==="Bioline");(S==null?void 0:S.result)==="Reactive"&&(B==null?void 0:B.result)==="Reactive"&&(I==null?void 0:I.result)==="Reactive"?await b():(I==null?void 0:I.result)==="Non reactive"&&await P()},b=async()=>{await d(),Ie("Positive result confirmed. Proceeding to ART enrollment.")},P=async()=>{await H(),await i()},W=async()=>{var r;try{const u=await pe.getLabResults(D.value,9);if((r=u==null?void 0:u.latestTest)!=null&&r.value){const S=u.latestTest.value.split("-");S.length===2&&(w.value=[{type:S[0],result:S[1]}])}}catch(u){console.error("Error loading previous tests:",u)}},G=async(r,u,m)=>{var F,K,ne,ae,le,o;const S=[{order_type_id:9,concept_id:r,name:u,specimen:m,reason:"Routine",specimenConcept:await we.getConceptID(m,!0)}],B=await Ze.buildLabOrders("",S,_.value),I=JSON.parse(JSON.stringify(D.value));return(ne=(K=(F=I.labOrders)!=null?F:I.labOrders={}).unsaved)!=null||(K.unsaved=[]),(o=(le=(ae=I.labOrders)!=null?ae:I.labOrders={}).saved)!=null||(le.saved=[]),I.labOrders.unsaved.push(...B),D.value=I,B[0].offline_id};return Se(async()=>{var r;_.value=(r=A.order)==null?void 0:r.past_date,await W(),M()}),(r,u)=>{const m=ge("ion-button");return h(),$("div",Lt,[a("div",Ut,[u[3]||(u[3]=a("h4",null,"HIV Testing",-1)),a("div",null,[u[2]||(u[2]=a("span",null,"Todays Date : ",-1)),a("span",null,C(N()),1)])]),a("div",null,[s(he,{formData:q.value,ref_key:"formRef",ref:x},null,8,["formData"])]),a("div",qt,[u[4]||(u[4]=a("span",null,"Reported by: ",-1)),a("span",null,C(e(ye).getUserName()),1)]),a("div",zt,[s(m,{onClick:u[0]||(u[0]=S=>T())},{default:n(()=>[...u[5]||(u[5]=[p("Complete",-1)])]),_:1}),g.value?(h(),Q(m,{key:0,onClick:u[1]||(u[1]=S=>O())},{default:n(()=>[p(C(y.value),1)]),_:1})):J("",!0)])])}}}),et=re(jt,[["__scopeId","data-v-229d1968"]]),Kt={style:{"padding-left":"10px","padding-right":"10px"}},Yt={class:"content"},Gt={style:{"text-align":"center",padding:"15px"}},Jt={style:{display:"flex","justify-content":"center",padding:"10px"}},Xt=ie({__name:"HepatitisModal",props:{order:{}},setup(E){const x=R(null);let k=R({});const D=Fe(),{patient:w}=$e(D),_=R(""),g=E,y=ee(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:te.required,type:"inline",options:[{label:"Positive",value:"Positive"},{label:"Negative",value:"Negative"},{label:"Inconclusive",value:"Inconclusive"}]}]),A=()=>ye.getSessionDate(),q=v=>{var T;if(v!=null&&v.tests)return(T=v==null?void 0:v.tests[0])==null?void 0:T.name},N=async()=>{var l,c,b,P;if(((l=x.value)==null?void 0:l.validateForm())!=null){Re("Please fill in all required fields");return}let v=g.order;_.value=v.past_date;let T="";const O=q(v)||(v==null?void 0:v.value_text),i=await we.getConceptID(O,!0);k.value=(c=x.value)==null?void 0:c.getFormValues(),v!=null&&v.new_order&&(T=await M(i,O,"Blood"));const H=await pe.buildResults([{name:O,concept_id:i,value:k.value.test_results}]),d=((P=(b=v==null?void 0:v.tests)==null?void 0:b[0])==null?void 0:P.id)||"";await pe.saveResults(w.value,H,d,T,_.value),await Ce.dismiss()},M=async(v,T,O)=>{var l,c,b,P,W,G;const i=[{order_type_id:9,concept_id:v,name:T,specimen:O,reason:"Routine",specimenConcept:await we.getConceptID(O,!0)}],H=await Ze.buildLabOrders("",i,_.value);console.log("ðŸš€ ~ createLabOrder ~ data:=======------",H);const d=JSON.parse(JSON.stringify(w.value));return(b=(c=(l=d.labOrders)!=null?l:d.labOrders={}).unsaved)!=null||(c.unsaved=[]),(G=(W=(P=d.labOrders)!=null?P:d.labOrders={}).saved)!=null||(W.saved=[]),d.labOrders.unsaved.push(...H),w.value=d,H[0].offline_id};return(v,T)=>{const O=ge("ion-button");return h(),$("div",Kt,[a("div",Yt,[a("h4",null,C(E.order.value_text)+" Testing",1),a("div",null,[T[1]||(T[1]=a("span",null,"Todays Date : ",-1)),a("span",null,C(A()),1)])]),a("div",null,[s(he,{formData:y.value,ref_key:"formRef",ref:x},null,8,["formData"])]),a("div",Gt,[T[2]||(T[2]=a("span",null,"Reported by: ",-1)),a("span",null,C(e(ye).getUserName()),1)]),a("div",Jt,[s(O,{onClick:T[0]||(T[0]=i=>N())},{default:n(()=>[...T[3]||(T[3]=[p("Complete",-1)])]),_:1})])])}}}),tt=re(Xt,[["__scopeId","data-v-c8a25de3"]]),Qt={class:"past-test-results"},Zt={class:"header"},es={class:"test-results-list"},ts={class:"test-info"},ss={class:"test-name"},ns={class:"test-date"},as={class:"add-results-section"},ls={class:"modal-test-results-list"},os={class:"test-info"},is={class:"test-name"},rs={class:"test-date"},us=ie({__name:"PastTestResults",props:{results:{default:()=>[]}},emits:["seeFullHistory","enterKnownResults"],setup(E,{emit:x}){const k=E,D=x,w=R(!1),_=R(!1),g=R(null),y=ee(()=>k.results||[]),A=ee(()=>y.value.slice(0,3)),q=ee(()=>[{componentType:"radioButtonField",header:"Select test",name:"test",obsValueType:"value_text",validation:te.required,type:"standard",options:[{label:"Hepatitis B Test",value:"Hepatitis B Test"},{label:"Hepatitis C Test",value:"Hepatitis C Test"},{label:"HIV test",value:"HIV test"},{label:"Syphilis",value:"Syphilis"}]},{componentType:"dateInputField",header:"Past Date",name:"past_date",validation:te.required}]),N=d=>{const l=d.toLowerCase();return l.includes("reactive")&&!l.includes("non reactive")||l.includes("positive")?"reactive":l.includes("non reactive")||l.includes("negative")?"non-reactive":(l.includes("inconclusive"),"default")},M=async()=>{var c;const d=(c=g.value)==null?void 0:c.getFormValues(),l={value_text:d.test,new_order:!0,past_date:d.past_date};H(),await v(l)},v=async d=>{d.value_text=="HIV test"&&await Z(et,{class:"otherVitalsModal"},!0,{order:d}),(d.value_text=="Syphilis"||d.value_text=="Hepatitis B Test"||d.value_text=="Hepatitis C Test")&&await Z(tt,{class:"otherVitalsModal"},!0,{order:d})},T=()=>{_.value=!0},O=()=>{w.value=!0,D("seeFullHistory")},i=()=>{w.value=!1},H=()=>{_.value=!1};return(d,l)=>(h(),$("div",Qt,[a("div",Zt,[l[2]||(l[2]=a("h2",{class:"header-title"},"PAST TEST RESULTS",-1)),s(e(j),{fill:"clear",size:"small",class:"see-history-btn",onClick:O},{default:n(()=>[l[1]||(l[1]=p(" See full History ",-1)),s(e(ke),{icon:e(lt),slot:"end"},null,8,["icon"])]),_:1})]),a("div",es,[(h(!0),$(de,null,ce(A.value,(c,b)=>(h(),Q(e(U),{key:b,class:"test-result-item",lines:"none"},{default:n(()=>[a("div",ts,[a("h3",ss,C(c.name),1),a("p",ns,C(c.date),1)]),s(e(qe),{class:ve(["result-chip",N(c.value)]),slot:"end"},{default:n(()=>[p(C(c.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),a("div",as,[s(e(j),{fill:"clear",size:"default",class:"add-results-btn",onClick:l[0]||(l[0]=c=>T())},{default:n(()=>[s(e(ke),{icon:e(ot),slot:"start"},null,8,["icon"]),l[3]||(l[3]=p(" Enter Known Past Results ",-1))]),_:1})]),s(e(ze),{"is-open":w.value,onDidDismiss:i,class:"history-modal"},{default:n(()=>[s(e(je),null,{default:n(()=>[s(e(Ke),null,{default:n(()=>[s(e(Ye),null,{default:n(()=>[p("Full Test History ("+C(y.value.length)+")",1)]),_:1}),s(e(Ge),{slot:"end"},{default:n(()=>[s(e(j),{onClick:i},{default:n(()=>[...l[4]||(l[4]=[p("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(e(Je),{class:"modal-content"},{default:n(()=>[a("div",ls,[(h(!0),$(de,null,ce(y.value,(c,b)=>(h(),Q(e(U),{key:"modal-".concat(b),class:"test-result-item",lines:"none"},{default:n(()=>[a("div",os,[a("h3",is,C(c.name),1),a("p",rs,C(c.date),1)]),s(e(qe),{class:ve(["result-chip",N(c.value)]),slot:"end"},{default:n(()=>[p(C(c.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))])]),_:1})]),_:1},8,["is-open"]),s(e(ze),{"is-open":_.value,onDidDismiss:H,class:"history-modal"},{default:n(()=>[s(e(je),null,{default:n(()=>[s(e(Ke),null,{default:n(()=>[s(e(Ye),null,{default:n(()=>[...l[5]||(l[5]=[p("Select Test and Date",-1)])]),_:1}),s(e(Ge),{slot:"end"},{default:n(()=>[s(e(j),{onClick:H},{default:n(()=>[...l[6]||(l[6]=[p("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(e(Je),{class:"modal-content"},{default:n(()=>[s(he,{formData:q.value,ref_key:"formRef",ref:g},null,8,["formData"])]),_:1}),s(e(it),{style:{padding:"10px"}},{default:n(()=>[s(yt,{style:{float:"right"},name:"Cont.",onClick:M})]),_:1})]),_:1},8,["is-open"])]))}}),ds=re(us,[["__scopeId","data-v-b2ac8efe"]]),cs={style:{"max-width":"900px",margin:"auto"}},ps={style:{"--background":"#fff","margin-bottom":"30px"}},vs={class:"demographics"},ms={style:{"text-overflow":"ellipsis"}},fs={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},_s={style:{"margin-right":"5px"}},ys={style:{"margin-top":"5px"}},gs={class:"demographicsFirstRow"},hs={class:"name custom-name-container"},ws={class:"demographicsOtherRow",style:{"margin-top":"10px"}},bs={class:"demographicsText",style:{display:"flex","flex-wrap":"wrap"}},xs={style:{"flex-shrink":"0"}},Ts={style:{"flex-shrink":"0"}},ks={key:0,class:"demographicsOtherRow"},Cs={class:"demographicsText mediumFontColor"},Is={key:1,class:"demographicsOtherRow"},Rs={class:"demographicsText mediumFontColor"},Ss={class:"demographicsOtherRow"},$s={class:"demographicsText smallFont"},Fs={class:"mediumFontColor"},Ds={style:{background:"transparent"}},Hs={class:"graphSection"},Ms={class:"graphBtn",style:{"margin-bottom":"5px"}},Os={class:"weightHeightGraphBtns"},Vs={key:0},Ps={key:1},Ns={style:{"margin-top":"20px"}},Bs={class:"test-results-container"},Es={class:"test-buttons-container"},As={style:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},Ws={key:0,class:"pagination-dots"},Ls=["onClick"],Us={class:"ion-padding",slot:"content"},Te=3,qs=ie({__name:"HTSPatientProfile",setup(E){const{event:x,popoverOpen:k,openPopover:D,openPIM:w,printVisitSummary:_,printID:g,formatCurrentAddress:y}=bt(),A=rt(),q=be,N=R(!1),M=R(7),v=R([]),T=R([]),O=Fe(),{patient:i}=$e(O),H=R(0),d=R(null),l=ee(()=>Math.ceil(v.value.length/Te)),c=o=>{const t=o*Te;return v.value.slice(t,t+Te)},b=o=>{const t=o.target,L=t.scrollLeft,Y=t.offsetWidth,oe=Math.round(L/Y);H.value=oe},P=o=>{if(d.value){const t=d.value.offsetWidth;d.value.scrollTo({left:o*t,behavior:"smooth"})}},W=async o=>{M.value=o},G=async()=>{const o=pe.getLabResults(i.value,9);T.value=o==null?void 0:o.results},r=async()=>{var t,L,Y,oe,me;if(!((t=i.value)!=null&&t.labOrders))return;const o=[...(Y=(L=i.value)==null?void 0:L.labOrders)==null?void 0:Y.saved,...(me=(oe=i.value)==null?void 0:oe.labOrders)==null?void 0:me.unsaved];v.value=o.filter(fe=>fe.order_type_id===9&&!fe.tests[0].result)},u=o=>ue.calculateDisplayAge(ue.toStandardHisFormat(o)),m=()=>{var o,t,L,Y;mt.isEmpty((t=(o=i.value)==null?void 0:o.personInformation)==null?void 0:t.birthdate)||(N.value=ue.dateDiffInDays(ue.sessionDate(),(Y=(L=i.value)==null?void 0:L.personInformation)==null?void 0:Y.birthdate)<42)},S=()=>{Z(Tt,{class:"otherVitalsModal"})},B=()=>{Z(kt,{class:"otherVitalsModal"})},I=o=>{var t;if(o!=null&&o.tests)return(t=o==null?void 0:o.tests[0])==null?void 0:t.name},F=async o=>{const t=I(o)||o.value_text;t=="HIV test"&&await Z(et,{class:"otherVitalsModal"},!0,{order:o}),(t=="Syphilis"||t=="Hepatitis B Test"||t=="Hepatitis C Test")&&await Z(tt,{class:"otherVitalsModal"},!0,{order:o})},K=()=>new ht().isUnderFive(),ne=()=>{console.log("Navigate to full history")},ae=()=>{console.log("Enter known results")},le=()=>{var o,t;return ue.toStandardHisDisplayFormat((t=(o=i.value)==null?void 0:o.personInformation)==null?void 0:t.birthdate)};return Xe(()=>A.currentRoute.value,async o=>{o.name=="patientProfile"&&i.value.patientID}),Xe(i,async()=>{i&&(m(),await G(),await r())}),Se(async()=>{m(),await r(),await G()}),(o,t)=>{var Y,oe,me,fe,De,He,Me,Oe,Ve,Pe,Ne,Be,Ee,Ae,We,Le;const L=ge("ion-icon");return h(),$("div",cs,[a("div",ps,[a("div",vs,[a("div",ms,[a("div",fs,[a("div",_s,[s(e(se),null,{default:n(()=>[s(e(z),null,{default:n(()=>{var f,V;return[a("div",{class:ve(((V=(f=e(i))==null?void 0:f.personInformation)==null?void 0:V.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor"),style:{display:"flex","flex-direction":"column","align-items":"center"}},[s(L,{style:{color:"#fff","font-size":"100px"},icon:e(ut)},null,8,["icon"])],2)]}),_:1})]),_:1}),s(e(se),null,{default:n(()=>[s(e(z),null,{default:n(()=>[...t[15]||(t[15]=[a("span",{class:"pill-text"},"Returning Client",-1)])]),_:1})]),_:1})]),a("div",ys,[a("div",gs,[a("div",hs,[(oe=(Y=e(i))==null?void 0:Y.personInformation)!=null&&oe.given_name?(h(),Q(e(se),{key:0,class:"custom-name-row"},{default:n(()=>[s(e(z),{class:"custom-name-col"},{default:n(()=>{var f,V;return[p(C((V=(f=e(i))==null?void 0:f.personInformation)==null?void 0:V.given_name),1)]}),_:1})]),_:1})):J("",!0),(fe=(me=e(i))==null?void 0:me.personInformation)!=null&&fe.middle_name?(h(),Q(e(se),{key:1,class:"custom-name-row"},{default:n(()=>[s(e(z),{class:"custom-name-col"},{default:n(()=>{var f,V;return[p(C((V=(f=e(i))==null?void 0:f.personInformation)==null?void 0:V.middle_name),1)]}),_:1})]),_:1})):J("",!0),(He=(De=e(i))==null?void 0:De.personInformation)!=null&&He.family_name?(h(),Q(e(se),{key:2,class:"custom-name-row"},{default:n(()=>[s(e(z),{class:"custom-name-col"},{default:n(()=>{var f,V;return[p(C((V=(f=e(i))==null?void 0:f.personInformation)==null?void 0:V.family_name),1)]}),_:1})]),_:1})):J("",!0)])]),a("div",ws,[a("div",bs,[a("span",xs,C(((Oe=(Me=e(i))==null?void 0:Me.personInformation)==null?void 0:Oe.gender)=="M"?"Male":"Female"),1),t[16]||(t[16]=a("span",{style:{"flex-shrink":"0"}},".",-1)),a("span",Ts,C(u((Pe=(Ve=e(i))==null?void 0:Ve.personInformation)==null?void 0:Pe.birthdate))+" ("+C(le())+")",1)])]),(Be=(Ne=e(i))==null?void 0:Ne.personInformation)!=null&&Be.current_district?(h(),$("div",ks,[t[17]||(t[17]=a("div",{class:"demographicsText"},"Current Address:",-1)),a("div",Cs,C(e(y)(e(i))),1)])):J("",!0),(Ae=(Ee=e(i))==null?void 0:Ee.personInformation)!=null&&Ae.country?(h(),$("div",Is,[t[18]||(t[18]=a("div",{class:"demographicsText"},"Country:",-1)),a("div",Rs,C((Le=(We=e(i))==null?void 0:We.personInformation)==null?void 0:Le.country),1)])):J("",!0),a("div",Ss,[a("div",$s,[t[19]||(t[19]=p(" MRN: ",-1)),a("span",Fs,C(e(i).ID),1)])])])])]),a("div",Ds,[s(e(se),{class:"no-wrap-row",style:{"align-items":"center"}},{default:n(()=>[s(e(z),{style:{flex:"1","min-width":"0"}},{default:n(()=>[s(e(j),{class:"deactivate-button",fill:"solid",shape:"round"},{default:n(()=>[...t[20]||(t[20]=[p(" Deactivate Visit ",-1)])]),_:1})]),_:1}),s(e(z),{size:"auto",style:{"flex-shrink":"0"}},{default:n(()=>[a("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:t[0]||(t[0]=f=>e(D)(f))},[s(L,{icon:e(dt)},null,8,["icon"])])]),_:1})]),_:1})])]),a("div",Hs,[a("div",null,[K()?(h(),Q(xt,{key:0,checkUnderSixWeeks:N.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):J("",!0),K()?J("",!0):(h(),Q(gt,{key:1}))]),a("div",Ms,[a("div",Os,[a("div",null,[s(e(j),{class:"btnText",fill:"solid",onClick:t[1]||(t[1]=f=>B())},{default:n(()=>[N.value?(h(),$("span",Ps," Enter Weight")):(h(),$("span",Vs," Enter Weight/Height")),s(L,{slot:"end",size:"small",icon:e(q).whiteHeightWeight},null,8,["icon"])]),_:1})]),a("div",null,[s(e(j),{class:"btnText",fill:"solid",onClick:t[2]||(t[2]=f=>S())},{default:n(()=>[t[21]||(t[21]=p(" Enter Other Vitals ",-1)),s(L,{slot:"end",size:"small",icon:e(q).whiteVitals},null,8,["icon"])]),_:1})])])])]),a("div",Ns,[s(e(U),{class:"new-orders-header"},{default:n(()=>[s(e(X),{class:"new-orders-label"},{default:n(()=>[...t[22]||(t[22]=[p(" NEW ORDERS ",-1)])]),_:1})]),_:1}),a("div",Bs,[a("div",Es,[s(e(j),{class:"test-button",fill:"outline",shape:"round",onClick:t[3]||(t[3]=f=>F({value_text:"HIV test",new_order:!0}))},{default:n(()=>[...t[23]||(t[23]=[p(" HIV ",-1)])]),_:1}),s(e(j),{class:"test-button",fill:"outline",shape:"round",onClick:t[4]||(t[4]=f=>F({value_text:"Syphilis",new_order:!0}))},{default:n(()=>[...t[24]||(t[24]=[p(" Syphilis ",-1)])]),_:1}),s(e(j),{class:"test-button",fill:"outline",shape:"round",onClick:t[5]||(t[5]=f=>F({value_text:"Hepatitis B Test",new_order:!0}))},{default:n(()=>[...t[25]||(t[25]=[p(" Hepatitis B ",-1)])]),_:1}),s(e(j),{class:"test-button",fill:"outline",shape:"round",onClick:t[6]||(t[6]=f=>F({value_text:"Hepatitis C Test",new_order:!0}))},{default:n(()=>[...t[26]||(t[26]=[p(" Hepatitis C ",-1)])]),_:1})]),s(ds,{results:T.value,onSeeFullHistory:ne,onEnterKnownResults:ae},null,8,["results"])]),s(e(U),{class:"new-orders-header",style:{"margin-top":"10px"}},{default:n(()=>[s(e(X),{class:"new-orders-label"},{default:n(()=>[...t[27]||(t[27]=[p(" ORDERS FROM OTHER CLINICS ",-1)])]),_:1})]),_:1}),a("div",As,[a("div",{ref_key:"ordersScrollContainer",ref:d,class:"orders-scroll-container",onScroll:b},[(h(!0),$(de,null,ce(l.value,f=>(h(),$("div",{key:f,class:"orders-page"},[(h(!0),$(de,null,ce(c(f-1),(V,st)=>(h(),Q(e(se),{key:st,style:{"margin-bottom":"10px"}},{default:n(()=>[s(e(z),null,{default:n(()=>[s(Dt,{title:I(V),status:"Referred ".concat(V.program_name),type:"hiv",onPressed:zs=>F(V)},null,8,["title","status","onPressed"])]),_:2},1024)]),_:2},1024))),128))]))),128))],544),l.value>1?(h(),$("div",Ws,[(h(!0),$(de,null,ce(l.value,f=>(h(),$("div",{key:f,class:ve(["dot",{active:H.value===f-1}]),onClick:V=>P(f-1)},null,10,Ls))),128))])):J("",!0)])])]),s(e(vt),{style:{"--offset-x":"-10px"},"is-open":e(k),"show-backdrop":!1,event:e(x),onDidDismiss:t[14]||(t[14]=f=>k.value=!1)},{default:n(()=>[a("div",null,[s(e(ct),{multiple:!0},{default:n(()=>[s(e(_e),{value:"first","toggle-icon":"",onClick:t[7]||(t[7]=f=>e(w)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(X),null,{default:n(()=>[...t[28]||(t[28]=[p("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),s(e(_e),{value:"first","toggle-icon":"",onClick:t[8]||(t[8]=()=>{})},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(X),null,{default:n(()=>[...t[29]||(t[29]=[p("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),s(e(_e),{value:"second","toggle-icon":"",onClick:t[9]||(t[9]=f=>e(_)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(X),null,{default:n(()=>[...t[30]||(t[30]=[p("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),s(e(_e),{value:"third","toggle-icon":"",onClick:t[10]||(t[10]=f=>e(g)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(X),null,{default:n(()=>[...t[31]||(t[31]=[p("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),s(e(_e),{value:"fourth"},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(X),null,{default:n(()=>[...t[32]||(t[32]=[p("Update outcome",-1)])]),_:1})]),_:1}),a("div",Us,[s(e(pt),null,{default:n(()=>[s(e(U),null,{default:n(()=>[s(e(xe),{checked:M.value==7,value:"active",onIonChange:t[11]||(t[11]=f=>W(7))},{default:n(()=>[...t[33]||(t[33]=[p(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),s(e(U),null,{default:n(()=>[s(e(xe),{checked:M.value==6,value:"inactive",onIonChange:t[12]||(t[12]=f=>W(6))},{default:n(()=>[...t[34]||(t[34]=[p(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),s(e(U),null,{default:n(()=>[s(e(xe),{checked:M.value==3,value:"died",onIonChange:t[13]||(t[13]=f=>W(3))},{default:n(()=>[...t[35]||(t[35]=[p(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])}}}),yn=re(qs,[["__scopeId","data-v-12ad2584"]]);export{yn as default};
