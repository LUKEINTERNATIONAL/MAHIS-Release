System.register(["./vendor-legacy-BV-WGgzk.js","../index-legacy-CImVo-5a.js","./Registration-legacy-BtzBPpdW.js","./lodash-legacy-pOOc9Efu.js"],function(e,a){"use strict";var t,l,n,o,r,d,i,s,u,c,p,v,f,m,_,g,h,b,y,x,w,k,D,I,V,S,C,N,P,A,B,H,F,U,E,R,O,L,T,z,M,j,q,$,G,J,Q,Z,K,W,X,Y,ee,ae,te,le,ne,oe,re,de,ie,se,ue,ce,pe,ve,fe,me,_e,ge,he,be,ye,xe,we,ke,De,Ie,Ve,Se,Ce,Ne,Pe,Ae;return{setters:[e=>{t=e.d,l=e.O,n=e.f,o=e.W,r=e.a5,d=e._,i=e.H,s=e.e,u=e.P,c=e.J,p=e.l,v=e.Q,f=e.K,m=e.k,_=e.p,g=e.F,h=e.r,b=e.w,y=e.u,x=e.e2,w=e.m,k=e.bR,D=e.a,I=e.bp,V=e.aP,S=e.aQ,C=e.a4,N=e.bk,P=e.e8,A=e.bm,B=e.a2,H=e.aT,F=e.N,U=e.aU,E=e.c,R=e.aj,O=e.G,L=e.E,T=e.aZ,z=e.L,M=e.I,j=e.a3,q=e.M,$=e.R,G=e.an,J=e.cB,Q=e.aw,Z=e.b1,K=e.Z,W=e.aF,X=e.V,Y=e.ds,ee=e.a7},e=>{ae=e.i,te=e.V,le=e.l,ne=e._,oe=e.B,re=e.aM,de=e.t,ie=e.o,se=e.ax,ue=e.J,ce=e.F,pe=e.L,ve=e.b4,fe=e.a,me=e.az,_e=e.aA,ge=e.ar,he=e.a7,be=e.m,ye=e.aR,xe=e.S,we=e.H,ke=e.G,De=e.u,Ie=e.P,Ve=e.aP,Se=e.D,Ce=e.aE,Ne=e.ba},e=>{Pe=e.R},e=>{Ae=e.l}],execute:function(){var a=document.createElement("style");a.textContent=".spaceBetween[data-v-4346bf77]{margin-left:10px;margin-right:10px}ion-item.ionLbltp[data-v-4346bf77]{border-bottom:2px dotted var(--ion-color-medium);--inner-border-width:0}.action_buttons[data-v-4346bf77]{color:var(--ion-color-primary);display:flex;align-items:center;float:right}.action_buttons[data-v-4346bf77]:hover{cursor:pointer}.modify_buttons[data-v-4346bf77]{padding-left:20px}.truncate-text[data-v-4346bf77]{overflow:hidden!important;white-space:nowrap!important;text-overflow:ellipsis!important}.col-st1[data-v-4346bf77]{max-width:23%}.col-st2[data-v-4346bf77]{max-width:58%}.error-label[data-v-060f83ec]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.spc_btwn[data-v-060f83ec]{margin-top:2%}.lsp-cls-1[data-v-060f83ec]{margin:-15px -15px -15px 0}.action-buttons-row[data-v-060f83ec]{margin-top:2%;display:flex;justify-content:flex-end}.error-label[data-v-f25626fb]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.action-buttons-row[data-v-f25626fb]{margin-top:2%;display:flex;justify-content:flex-end;padding-right:16px;padding-bottom:8px}ion-card[data-v-f25626fb]{padding:0;margin:10px}ion-list[data-v-f25626fb]{padding:0}.error-label[data-v-c55ed5f5]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.action-buttons-row[data-v-c55ed5f5]{margin-top:2%;display:flex;justify-content:flex-end}ion-card[data-v-c55ed5f5]{padding:10px;margin:10px}.date-results-container[data-v-1e34f199]{padding:20px}.date-buttons-container[data-v-1e34f199]{display:flex;justify-content:left;gap:12px;flex-wrap:wrap}.date-button[data-v-1e34f199]{--border-color: #4caf50;--border-width: 2px;--color: #4caf50;--background: transparent;--border-radius: 20px;font-size:18px;font-weight:500;text-transform:none;height:auto;text-align:left;transition:all .3s ease}.date-button.error-border[data-v-1e34f199]{--border-color: #f44336;--color: #f44336}.date-button.selected[data-v-1e34f199]{--background: #4caf50;--color: white;--border-color: #4caf50}.date-button[data-v-1e34f199]:hover{opacity:.8}.validation-message[data-v-1e34f199]{color:#f44336;font-size:16px;margin-top:10px;font-weight:500;padding-left:5px}.error-label[data-v-721c6ae2]{background:#fecdca;color:#b42318;text-transform:none;padding:3%;border-radius:10px;margin-top:7px;display:flex;text-align:center}.action-buttons[data-v-721c6ae2]{margin-top:20px}.action-buttons ion-col[data-v-721c6ae2]{display:flex;gap:10px;justify-content:flex-end}.initTxt[data-v-2873182f]{text-align:center}.spc_btwn[data-v-2873182f]{margin-top:2%}.item-al[data-v-2873182f]{cursor:pointer;padding:5px;background-color:#ebebeb;margin-top:8px}.item-al[data-v-2873182f]:hover{background-color:rgba(85,81,81,.282);padding:5px;border-radius:3px}ion-popover.popover-al[data-v-2873182f]{--background: #fff}ion-list.list-al[data-v-2873182f]{--background: #fff;-ion-item-background:#fff}.saveContainer[data-v-2873182f]{display:flex;align-items:flex-end}.action_buttons[data-v-2873182f]{margin-top:5px}.error-label[data-v-2873182f]{background:#fecdca;color:#b42318;text-transform:none;padding:6%;border-radius:10px;margin-top:7px;display:flex;text-align:center}ion-card[data-v-696e3b8f]{margin:16px 0;border-radius:12px}.sub-menu-icon[data-v-696e3b8f]{font-size:1.2rem}ion-item[data-v-696e3b8f]{--padding-start: 8px;margin:8px 0}.current-ncd-item[data-v-696e3b8f]{--background: var(--ion-color-success-tint);border-radius:8px;margin:8px 0;border-left:4px solid var(--ion-color-primary)}.current-ncd-item ion-label h2[data-v-696e3b8f]{font-weight:600;color:var(--ion-color-primary)}.current-ncd-item ion-label p[data-v-696e3b8f]{font-size:1.1em;margin-top:4px;color:var(--ion-color-dark)}.custom-input[data-v-696e3b8f]{--padding-start: 0;font-size:1.5em}.prefix-container[data-v-696e3b8f]{display:flex;align-items:center;height:100%}.prefix-part[data-v-696e3b8f]{border:none;background:#f0f0f0;padding:0 8px;border-right:1px solid #ccc;color:var(--ion-color-dark);font-weight:600}.error-message[data-v-696e3b8f]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;margin-top:8px;background-color:rgba(255,0,0,.1);border-radius:4px}.error-content[data-v-696e3b8f]{display:flex;align-items:center;gap:8px}.close-button[data-v-696e3b8f]{margin-left:auto}#container[data-v-cde3e630]{font-family:monospace;font-size:24px;overflow:hidden;padding:15px;width:594px}ul[data-v-cde3e630],ol[data-v-cde3e630]{list-style-type:none;padding-left:0;margin:0}\n/*$vite$:1*/",document.head.appendChild(a),e("u",function(){const e=h(ee.isNativePlatform()),a=h([]),t=h(null),l=h(!1),n=h(null),o=De().patient;return{isMobile:e,visits:a,event:t,popoverOpen:l,program:n,patient:o,openPopover:e=>{t.value=e,l.value=!0},openPIM:()=>{be(Be,{class:"fullScreenModal"})},openOutCome:()=>{be(da,{class:"large-modal-x10"})},printVisitSummary:async()=>{1==xe.getProgramID()?await Ne():32==xe.getProgramID()?await async function(){await Se(Ja,{copies:1})}():(new Ce).printData("visit")},printID:()=>{(new Ce).printData("barcode")},formatCurrentAddress:e=>{var a,t,l;return[null==e||null===(a=e.personInformation)||void 0===a?void 0:a.current_district,null==e||null===(t=e.personInformation)||void 0===t?void 0:t.current_traditional_authority,null==e||null===(l=e.personInformation)||void 0===l?void 0:l.current_village].filter(Boolean).join(",")},openUpdateNCDNUmbers:()=>{be(Va,{class:"large-modal-x10"})}}});const Be=e("c",t({__name:"personalInformationModal",setup:e=>(e,a)=>(n(),l(Pe,{editMode:!0}))})),He=t({components:{IonItem:d,IonCol:r,IonLabel:o},data:()=>({iconsContent:le}),props:{displayData:{type:Array,default:[]}},methods:{highlightItem(e){const a=document.getElementById(e+"_lbl");a&&(a.style.color="#006401"),this.highlightActionBtns(e)},undoHighlightItem(e){const a=document.getElementById(e+"_lbl");a&&(a.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(e)},highlightActionBtns(e){const a=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<a.length;t++)a[t].style.display="block"},undohighlightActionBtns(e){const a=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<a.length;t++)a[t].style.display="none"},asignLblID:e=>e+"_lbl",asignSpanLblID:e=>e+"_spanlbl",async removeItemAtIndex(e,a){await te("Do you want to delete it?",a)&&this.$emit("update:removeItem",e)},async editItemAtIndex(e,a,t){await ae("Do you want to edit it?",t)&&this.$emit("update:editItem",{index:e,item:a})},fomartDate:e=>e.year+"-"+(e.month<10?"0":"")+e.month+"-"+(e.day<10?"0":"")+e.day}}),Fe=e("D",ne(He,[["render",function(e,a,t,o,r,d){const h=i("ion-label"),b=i("ion-col"),y=i("ion-icon"),x=i("ion-item");return n(!0),s(g,null,u(e.displayData,(t,o)=>(n(),l(x,{displayData:e.displayData,class:"ionLbltp",key:o,onMousemove:a=>e.highlightItem(o),onMouseout:a=>e.undoHighlightItem(o)},{default:c(()=>[p(b,{class:"col-st1"},{default:c(()=>[p(h,{id:e.asignLblID(o),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:c(()=>[v(f(t.type),1)]),_:2},1032,["id"])]),_:2},1024),p(b,{class:"col-st2"},{default:c(()=>[p(h,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:c(()=>[a[0]||(a[0]=m("span",{class:"spaceBetween"},null,-1)),v(" "+f(t.name)+" ",1),a[1]||(a[1]=m("span",{class:"spaceBetween"},null,-1)),v(f(t.reason),1),a[2]||(a[2]=m("span",{class:"spaceBetween"},null,-1)),v(f(e.fomartDate(t.date)),1)]),_:2},1024)]),_:2},1024),p(b,{class:"action_buttons"},{default:c(()=>[p(h,{class:_(e.asignSpanLblID(o)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:a=>e.editItemAtIndex(o,t,a)},{default:c(()=>[p(y,{icon:e.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),p(h,{class:_(e.asignSpanLblID(o)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:a=>e.removeItemAtIndex(o,a)},{default:c(()=>[p(y,{icon:e.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}],["__scopeId","data-v-4346bf77"]])),Ue=e("_",t({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(e,{emit:a}){const t=h(),o=h({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),r=h(),d={name:"Now",show:!0,fn:S},u=h(!0),v=h(!1),f=h(0),m=e;b(()=>m.time_prop,e=>{e&&(t.value=e.time)},{immediate:!0,deep:!0});const _=a;function D(e){1==v.value?(u.value=!1,v.value=!1):u.value=!0,o.value.isOpen=!0,o.value.event=e}function I(e){t.value=e.detail.value;const a=V(t.value);1!=(-1!==a.indexOf("NaN"))?t.value=a:S()}function V(e){let a=new Date(e),t=a.getHours(),l=a.getMinutes(),n=t>=12?"PM":"AM";t%=12,t=t||12;let o=t.toString().padStart(2,"0")+":"+l.toString().padStart(2,"0")+" "+n;return r.value={time:o,meridian:n},_("timeUpDated",r.value),o}function S(){v.value=!0,t.value=V(new Date),u.value=!1,f.value++}return(e,a)=>{const r=i("ion-popover");return n(),s(g,null,[(n(),l(oe,{placeholder:m.place_holder.default,inputValue:t.value,icon:y(x),"-inner-action-btn-propeties":d,"onClicked:inputValue":D,"onUpdate:InnerActionBtnPropetiesAction":d.fn,key:f.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),p(r,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":o.value.isOpen,event:o.value.event,side:"top",onDidDismiss:a[0]||(a[0]=e=>o.value.isOpen=!1)},{default:c(()=>[u.value?(n(),l(y(k),{key:0,onIonChange:I,id:"datetime",presentation:"time","show-default-buttons":!0})):w("",!0)]),_:1},8,["is-open","event"])],64)}}})),Ee=t({name:"xxxComponent"}),Re=t({...Ee,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=h([]),d=re(),i=h(NaN),s=h(!1),u=h(),_=h(!1);D(async()=>{R(),E()});const g=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:O},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:function(){T()}}],x=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;x[0].dataValue.value=a,1==_.value&&de("Remember to press the SAVE button",1e4),E(!1)},dataValue:h(),show_error:h(!1),error_message:"please provide a reason"}],k=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};k[0].dataValue.value=a,O(!1)},dataValue:h(),show_error:h(!1),error_message:"please provide date"}],F=[{placeHolder:{default:"Enter time of admission"},dataHandler:function(e){F[0].dataValue.value=e,O(!1)},dataValue:h(),show_error:h(!1),error_message:"error"}],U=e;function E(e=!0){_.value=e}async function R(e){t.value=await ie("wards")}function O(e=!0){void 0===u.value||""==u.value?s.value=!0:s.value=!1,""==x[0].dataValue.value||void 0===x[0].dataValue.value?x[0].show_error.value=!0:x[0].show_error.value=!1,void 0===k[0].dataValue.value||""==k[0].dataValue.value?k[0].show_error.value=!0:k[0].show_error.value=!1,void 0===F[0].dataValue.value||""==k[0].dataValue.value?F[0].show_error.value=!0:F[0].show_error.value=!1,0==k[0].show_error.value&&0==F[0].show_error.value&&0==x[0].show_error.value&&0==s.value?async function(){const e={name:u.value.name,type:"Admitted for short stay",date:k[0].dataValue,time:F[0].dataValue,reason:x[0].dataValue,other:u.value,selected:!0};await d.addOutcomeData(e,i.value)&&T({dataSaved:!1})}():e&&de("Please enter correct data values",4e3)}b(()=>U.selected_ward_prop,e=>{e&&(u.value=e)},{immediate:!0,deep:!0}),b(()=>U.admitted_other_props,e=>{e&&(x[0].dataValue.value=e.reason,F[0].dataValue.value=e.time,k[0].dataValue.value=e.date)},{immediate:!0,deep:!0});const L=a;function T(e={dataSaved:!0}){L("dataSaved",e)}return(e,a)=>(n(),l(y(I),null,{default:c(()=>[p(y(S),null,{default:c(()=>[p(y(V),{onClick:a[0]||(a[0]=e=>R())},{default:c(()=>[...a[4]||(a[4]=[v("Admitted for Short Stay",-1)])]),_:1})]),_:1}),p(y(H),null,{default:c(()=>[p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[p(y(N),{modelValue:u.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>u.value=e),a[2]||(a[2]=e=>{return a=e,u.value=a,E(),void O(!1);var a})],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:a[3]||(a[3]=e=>({})),"track-by":"location_ward_id",options:t.value},null,8,["modelValue","options"]),m("div",null,[s.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[...a[5]||(a[5]=[v(f("Please select a ward"),-1)])]),_:1})):w("",!0)])]),_:1})]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[m("div",null,[p(se,{place_holder:k[0].placeHolder,onDateUpDated:k[0].dataHandler,date_prop:k[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),m("div",null,[k[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(k[0].error_message),1)]),_:1})):w("",!0)])])]),_:1})]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[m("div",null,[p(Ue,{place_holder:F[0].placeHolder,onTimeUpDated:F[0].dataHandler,time_prop:F[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),m("div",null,[F[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(F[0].error_message),1)]),_:1})):w("",!0)])])]),_:1})]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[p(oe,{placeholder:x[0].placeHolder,icon:y(P),inputValue:x[0].dataValue.value,"onUpdate:inputValue":x[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),m("div",null,[x[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(x[0].error_message),1)]),_:1})):w("",!0)])]),_:1})]),_:1}),g[0].showAddItemButton?(n(),l(y(C),{key:0,class:"action-buttons-row"},{default:c(()=>[g[0].addItemButton?(n(),l(ue,{key:0,name:g[0].name,fill:g[0].btnFill,icon:y(A),"onClicked:btn":g[0].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0),g[1].addItemButton?(n(),l(ue,{key:1,name:g[1].name,fill:g[1].btnFill,icon:y(B),"onClicked:btn":g[1].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0)]),_:1})):w("",!0)]),_:1})]),_:1}))}}),Oe=e("A",ne(Re,[["__scopeId","data-v-060f83ec"]])),Le=t({name:"xxxComponent"}),Te=t({...Le,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=h(NaN),d=h(null),i=re(),s=h(!1),u=h([]),_=h({}),g=h(!0),x={location_data:{}},k=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;k[0].dataValue.value=a,1==g.value&&de("Remember to press the SAVE button",1e4),O(!1)},dataValue:h(),show_error:h(!1),error_message:"please provide a reason"}],N=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};N[0].dataValue.value=a,E(!1)},dataValue:h(),show_error:h(!1),error_message:"please provide date"}],F=[{placeHolder:{default:"Enter time of referral"},dataHandler:function(e){F[0].dataValue.value=e,E(!1)},dataValue:h(),show_error:h(!1),error_message:"error"}],U=e;function E(e=!0){R(),""==k[0].dataValue.value||void 0===k[0].dataValue.value?k[0].show_error.value=!0:k[0].show_error.value=!1,void 0===N[0].dataValue.value||""==N[0].dataValue.value?N[0].show_error.value=!0:N[0].show_error.value=!1,void 0===F[0].dataValue.value||""==N[0].dataValue.value?F[0].show_error.value=!0:F[0].show_error.value=!1,0==N[0].show_error.value&&0==F[0].show_error.value&&0==k[0].show_error.value&&0==s.value?T():e&&de("Please enter correct data values",4e3)}function R(){d.value?s.value=!1:s.value=!0}function O(e=!0){g.value=e}b(()=>U.selected_other_referral_data,e=>{e&&(k[0].dataValue.value=e.reason,N[0].dataValue.value=e.date,F[0].dataValue.value=e.time)},{immediate:!0,deep:!0}),b(()=>U.selected_referral_data,e=>{if(!e)return;d.value=e.selected_location,x.location_data=e;const a=Array.isArray(e.selected_district_ids)?[...e.selected_district_ids]:[],t=e.selected_location?{...e.selected_location}:null;u.value=a,_.value=t},{immediate:!0,deep:!0}),D(()=>{O()});const L=e=>{d.value=e.selected_location,R(),x.location_data=e,O(),E(!1)},T=async()=>{const e={name:d.value.name,type:"Referred out",selected:!0,date:N[0].dataValue,time:F[0].dataValue,reason:k[0].dataValue},a={...e,other:{ref_data:e,location_data:x.location_data}};await i.addOutcomeData(a,t.value)&&M({dataSaved:!1})},z=a;function M(e={dataSaved:!0}){z("dataSaved",e)}const j=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:E},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:()=>{M()}}];return(e,a)=>(n(),l(y(I),null,{default:c(()=>[p(y(S),null,{default:c(()=>[p(y(V),null,{default:c(()=>[...a[0]||(a[0]=[v("Referred Out",-1)])]),_:1})]),_:1}),p(y(H),null,{default:c(()=>[p(y(C),null,{default:c(()=>[p(ce,{show_error:s.value,onFacilitySelected:L,selected_district_ids:u.value,selected_location:_.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[m("div",null,[p(se,{place_holder:N[0].placeHolder,onDateUpDated:N[0].dataHandler,date_prop:N[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),m("div",null,[N[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(N[0].error_message),1)]),_:1})):w("",!0)])])]),_:1})]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[m("div",null,[p(Ue,{place_holder:F[0].placeHolder,onTimeUpDated:F[0].dataHandler,time_prop:F[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),m("div",null,[F[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(F[0].error_message),1)]),_:1})):w("",!0)])])]),_:1})]),_:1}),p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[p(oe,{placeholder:k[0].placeHolder,icon:y(P),inputValue:k[0].dataValue.value,"onUpdate:inputValue":k[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),m("div",null,[k[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(k[0].error_message),1)]),_:1})):w("",!0)])]),_:1})]),_:1}),j[0].showAddItemButton?(n(),l(y(C),{key:0,class:"action-buttons-row"},{default:c(()=>[j[0].addItemButton?(n(),l(ue,{key:0,name:j[0].name,fill:j[0].btnFill,icon:y(A),"onClicked:btn":j[0].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0),j[1].addItemButton?(n(),l(ue,{key:1,name:j[1].name,fill:j[1].btnFill,icon:y(B),"onClicked:btn":j[1].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0)]),_:1})):w("",!0)]),_:1})]),_:1}))}}),ze=e("R",ne(Te,[["__scopeId","data-v-f25626fb"]])),Me=t({name:"xxxComponent"}),je=t({...Me,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=h(NaN),d=h([]),i=re(),s=h();D(async()=>{N("")});const u=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;u[0].dataValue.value=a},dataValue:h(),show_error:h(!1),error_message:"please provide a reason"}],_=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};_[0].dataValue.value=a,P(!1)},dataValue:h(),show_error:h(!1),error_message:"please provide date"}],g=e;b(()=>g.selected_discharged_prop,e=>{e&&(s.value=e)},{immediate:!0,deep:!0}),b(()=>g.selected_discharged_data,e=>{e&&(_[0].dataValue.value=e.date||"",e.reason&&(u[0].dataValue.value=e.reason))},{immediate:!0,deep:!0}),d.value,h(!1),h(!1);const x=[{placeHolder:{default:"Enter time of referral"},dataHandler:function(e){x[0].dataValue.value=e},dataValue:h(),show_error:h(!1),error_message:"error"}],k=new Set;async function N(e){const a=e,t=await pe.getFacilities({name:a});t||t.forEach(e=>{k.has(e.location_id)||(k.add(e.location_id),0==Ae.isEmpty(e.name)&&d.value.push({name:e.name,selected:!1,other:e}))})}function P(e=!0){void 0===_[0].dataValue.value||""==_[0].dataValue.value?_[0].show_error.value=!0:_[0].show_error.value=!1,_[0].show_error.value?e&&de("Please enter a valid date",4e3):async function(){const e={type:"Discharged Home",date:_[0].dataValue,reason:u[0].dataValue.value};await i.addOutcomeData(e,t.value)&&U({dataSaved:!1})}()}const F=a;function U(e={dataSaved:!0}){F("dataSaved",e)}const E=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:P},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:function(){U()}}];return(e,a)=>(n(),l(y(I),null,{default:c(()=>[p(y(S),null,{default:c(()=>[p(y(V),null,{default:c(()=>[...a[0]||(a[0]=[v("Discharged Home",-1)])]),_:1})]),_:1}),p(y(H),null,{default:c(()=>[p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[m("div",null,[p(se,{place_holder:_[0].placeHolder,onDateUpDated:_[0].dataHandler,date_prop:_[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),m("div",null,[_[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(_[0].error_message),1)]),_:1})):w("",!0)])])]),_:1})]),_:1}),E[0].showAddItemButton?(n(),l(y(C),{key:0,class:"action-buttons-row"},{default:c(()=>[E[0].addItemButton?(n(),l(ue,{key:0,name:E[0].name,fill:E[0].btnFill,icon:y(A),"onClicked:btn":E[0].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0),E[1].addItemButton?(n(),l(ue,{key:1,name:E[1].name,fill:E[1].btnFill,icon:y(B),"onClicked:btn":E[1].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0)]),_:1})):w("",!0)]),_:1})]),_:1}))}}),qe=e("a",ne(je,[["__scopeId","data-v-c55ed5f5"]])),$e={class:"date-results-container"},Ge={class:"date-buttons-container"},Je={key:0,class:"validation-message"},Qe=ne({__name:"DatePillSelector",props:{availableDates:{type:Array,required:!0,default:()=>[]}},emits:["dateSelected"],setup(e,{expose:a,emit:t}){const o=e,r=t,d=h(null),i=h(!1),p=e=>{const a=new Date(e);return isNaN(a)?e:a.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})};return a({validateSelection:()=>null===d.value?(i.value=!0,!1):(i.value=!1,!0),getSelectedDate:()=>null!==d.value?o.availableDates[d.value]:null}),(a,t)=>(n(),s("div",$e,[m("div",Ge,[(n(!0),s(g,null,u(e.availableDates,(e,a)=>(n(),l(y(F),{key:a,class:_(["date-button",{selected:d.value===a,"error-border":i.value&&d.value!==a}]),fill:"outline",shape:"round",onClick:e=>(e=>{d.value=e,i.value=!1,r("dateSelected",{date:o.availableDates[e],index:e})})(a)},{default:c(()=>[v(f(p(e)),1)]),_:2},1032,["class","onClick"]))),128))]),i.value?(n(),s("p",Je," ⚠️ Please select an available date to proceed. ")):w("",!0)]))}},[["__scopeId","data-v-1e34f199"]]);class Ze extends ve{constructor(e,a){super(e,114,a)}}const Ke=e("b",ne(t({__name:"ReferToAnotherClinic",emits:["programDateSelected","referralDataReady","dataSaved"],setup(e,{emit:a}){const t=a,d=h([]),i=h([]),_=h([]),b=fe(),x=me(),{activeProgram:k}=U(b),N=h(!1),P=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Clinics",placeHolder:"Search for programs",items:[],listUpdatedFN:async function(e){d.value=e,function(){const e=[];d.value.forEach(a=>{1==a.selected&&e.push(a.other)});const a=e.map(e=>e.program_id);i.value=i.value.filter(e=>a.includes(e.id)),_.value=_.value.filter(e=>a.includes(e.programId)),e.forEach(e=>{i.value.some(a=>a.id===e.program_id)||i.value.push({id:e.program_id,name:e.name,dates:[],dateSelectorRef:null})}),P[0].show_error.value=0===e.length}(),N.value=!1,await O()},listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:h(!1),error_message:"Please select one or more clinics/programs to refer to.",disabled:h(!1)}],F=async e=>{try{const a=xe.getUserID(),t=xe.getPatientID(),l=new Ze(t,a);await l.createEncounter();const n=e.map(e=>({concept_id:2227,value_numeric:e.programId,obs_datetime:we.sessionDate(),child:[{concept_id:11242,value_text:we.toStandardHisFormat(e.date),obs_datetime:we.sessionDate()}]}));await l.saveObservationList(n),ke("Patient referral saved successfully"),E()}catch(a){de("Error saving referral data. Please try again.",4e3),console.error("Error in sub_refferal_data:",a)}};function E(e={dataSaved:!0}){t("dataSaved",e)}const R=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:async()=>{N.value=!1;const e=i.value.length>0;if(P[0].show_error.value=!e,!e)return void console.log("Validation Failed: No programs selected.");let a=!0;_.value=[];for(const t of i.value)if(t.dateSelectorRef)if(t.dateSelectorRef.validateSelection()){const e=t.dateSelectorRef.getSelectedDate();e?_.value.push({programId:t.id,programName:t.name,date:e}):a=!1}else a=!1;else a=!1,console.error(`Date Selector ref is missing for program ${t.name}`);if(!a)return N.value=!0,void console.log("Validation Failed: Not all dates selected.");console.log("Validation Passed! Ready to refer patient with data:",_.value),t("referralDataReady",_.value),await L(_.value,F)}},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:()=>{E()}}],O=async()=>{const e=i.value.map(async e=>{try{const a=x.getAvailableDatesByProgramId(e.id,90,!0,4);e.dates=a}catch(a){console.error(`Error fetching dates for program ${e.name}:`,a),e.dates=[]}});await Promise.all(e)},L=async(e,a)=>{be(ye,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Referral(s)?"},{cancel:e=>{},confirm:async t=>{1==t.detail&&await a(e)}})};return D(async()=>{await async function(){const e=k.value.program_id,a=await he.getAllPrograms(),t=[];a.forEach(a=>{a.program_id!==e&&t.push({name:a.name,other:a,selected:!1})}),d.value=t}(),_e()}),(e,a)=>(n(),l(y(I),null,{default:c(()=>[p(y(S),null,{default:c(()=>[p(y(V),null,{default:c(()=>[...a[0]||(a[0]=[v("Refer to another clinic",-1)])]),_:1})]),_:1}),p(y(H),null,{default:c(()=>[p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[p(y(o),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:c(()=>[...a[1]||(a[1]=[v(" Program(s)",-1),m("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),p(ge,{multiSelection:P[0].multi_Selection,show_label:P[0].show_list_label,uniqueId:P[0].unqueId,name_of_list:P[0].name_of_list,choose_place_holder:P[0].placeHolder,"items_-list":d.value,use_internal_filter:P[0].use_internal_filter,disabled:P[0].disabled.value,onItemListUpDated:P[0].listUpdatedFN,onItemListFiltered:P[0].listFilteredFN,onItemSearchText:P[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),m("div",null,[P[0].show_error.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[v(f(P[0].error_message),1)]),_:1})):w("",!0)])]),_:1})]),_:1}),(n(!0),s(g,null,u(i.value,(e,d)=>(n(),l(y(C),{key:e.id},{default:c(()=>[p(y(r),null,{default:c(()=>[p(y(o),{style:{margin:"10px","margin-top":"20px","font-weight":"bold",display:"block"}},{default:c(()=>[a[2]||(a[2]=m("span",{style:{color:"gray"}},"Available Dates for:",-1)),v(" "+f(e.name),1)]),_:2},1024),p(Qe,{availableDates:e.dates,onDateSelected:a=>((e,a,l)=>{t("programDateSelected",{programId:a,programName:l,date:e}),N.value=!1;const n=_.value.findIndex(e=>e.programId===a),o={programId:a,programName:l,date:e};n>-1?_.value[n]=o:_.value.push(o)})(a,e.id,e.name),ref_for:!0,ref:a=>{a&&(e.dateSelectorRef=a)}},null,8,["availableDates","onDateSelected"])]),_:2},1024)]),_:2},1024))),128)),N.value?(n(),l(y(C),{key:0,style:{"margin-top":"-10px"}},{default:c(()=>[p(y(r),null,{default:c(()=>[p(y(o),{class:"error-label"},{default:c(()=>[...a[3]||(a[3]=[v(" ⚠️ Please select an available date for all selected programs. ",-1)])]),_:1})]),_:1})]),_:1})):w("",!0),p(y(C),{class:"action-buttons"},{default:c(()=>[p(y(r),{class:"ion-text-end"},{default:c(()=>[R[1].addItemButton?(n(),l(ue,{key:0,name:R[1].name,fill:R[1].btnFill,icon:y(B),"onClicked:btn":R[1].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0),i.value.length>0?(n(),l(ue,{key:1,name:R[0].name,fill:R[0].btnFill,icon:y(A),"onClicked:btn":R[0].fn},null,8,["name","fill","icon","onClicked:btn"])):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),[["__scopeId","data-v-721c6ae2"]])),We={class:"dash_box"},Xe={key:0,style:{"margin-top":"100px"}},Ye=t({name:"xxxComponent"}),ea=t({...Ye,setup(e){const a=h("No outcome created yet"),t=h(!1),d=h(!0),u=h(""),_=h(!0),g=h(!1),x=re(),k=E(()=>x.outcomes),I=h(!1),V=h(!1),S=h(!1),C=h(!1),P=h(!1),A=h(!1),B=h(),H=h(null),F=h(null),U=h(null),O=h(null),L=h(null),T=h(null),z=h([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]);function M(e){z.value.forEach(a=>{1!=e.selected||e.name!=a.name&&e.type!=a.name||(u.value=a.name)})}function j(){k.value.length>0?_.value=!1:0==k.value.length&&0==g.value&&(_.value=!0)}function q(e){k.value.splice(e,1)}D(async()=>{j()}),b(()=>u.value,async e=>{1==I.value?I.value=!1:async function(){const e=u.value;u.value=e;const a=u.value;a==z.value[0].name?S.value=!0:S.value=!1,a==z.value[1].name?C.value=!0:C.value=!1,a==z.value[2].name?P.value=!0:P.value=!1,a==z.value[3].name?A.value=!0:A.value=!1}()}),b(()=>k.value.length,async e=>{j()});const $=e=>{q(e.index),M(e.item),H.value=e.item.other.location_data,F.value={reason:e.item.reason,date:e.item.date,time:e.item.time},U.value=e.item.other,O.value=e.item,"Discharged Home"===e.item.type&&(L.value=e.item,T.value={reason:e.item.reason,date:e.item.date})};function G(){V.value=!1,S.value=!1,P.value=!1,C.value=!1,z.value.forEach(e=>{e.selected=!1}),u.value=""}return(e,u)=>{const g=i("ion-row");return n(),l(y(R),null,{default:c(()=>[p(g,null,{default:c(()=>[p(y(r),null,{default:c(()=>[(n(),l(Fe,{key:0,"onUpdate:removeItem":q,"onUpdate:editItem":$,displayData:k.value},null,8,["displayData"]))]),_:1})]),_:1}),_.value?(n(),l(g,{key:0},{default:c(()=>[m("span",We,f(a.value),1)]),_:1})):w("",!0),p(g,null,{default:c(()=>[p(y(r),null,{default:c(()=>[d.value?(n(),s("div",Xe,[p(g,null,{default:c(()=>[p(y(N),{modelValue:B.value,"onUpdate:modelValue":[u[0]||(u[0]=e=>B.value=e),u[1]||(u[1]=e=>{return a=e,z.value.forEach(e=>{e.selected=!1}),B.value=a,B.value.selected=!0,void M(B.value);var a})],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:z.value},null,8,["modelValue","options"]),m("div",null,[t.value?(n(),l(y(o),{key:0,class:"error-label"},{default:c(()=>[...u[2]||(u[2]=[v(f("please select a type"),-1)])]),_:1})):w("",!0)])]),_:1})])):w("",!0)]),_:1})]),_:1}),S.value?(n(),l(Oe,{key:1,onDataSaved:G,selected_ward_prop:U.value,admitted_other_props:O.value},null,8,["selected_ward_prop","admitted_other_props"])):w("",!0),C.value?(n(),l(ze,{key:2,onDataSaved:G,selected_referral_data:H.value,selected_other_referral_data:F.value},null,8,["selected_referral_data","selected_other_referral_data"])):w("",!0),P.value?(n(),l(qe,{key:3,onDataSaved:G,selected_discharged_prop:L.value,selected_discharged_data:T.value},null,8,["selected_discharged_prop","selected_discharged_data"])):w("",!0),A.value?(n(),l(Ke,{key:4,onDataSaved:G})):w("",!0)]),_:1})}}}),aa=e("O",ne(ea,[["__scopeId","data-v-2873182f"]])),ta={style:{"font-weight":"400","font-size":"19px"}},la={style:{display:"flex","align-items":"center"}},na={class:""},oa={class:"center text_12"},ra=t({watch:{},name:"xxxComponent"}),da=t({...ra,props:{is_open:{},user_id:{}},emits:["closePopover","save"],setup(e,{emit:a}){h("");const t=a;return(e,a)=>(n(),s(g,null,[p(y(M),null,{default:c(()=>[p(y(O),null,{default:c(()=>[p(y(L),null,{default:c(()=>[...a[1]||(a[1]=[m("div",{style:{display:"flex","align-items":"center"}},[m("b",{style:{"margin-left":"6px"}},"Patient Outcome")],-1)])]),_:1}),p(y(T),{slot:"end"},{default:c(()=>[p(y(L),null,{default:c(()=>[p(y(F),{onClick:a[0]||(a[0]=e=>(t("closePopover",!1),void $.dismiss())),fill:"solid"},{default:c(()=>[m("span",ta,[m("div",la,[p(y(z),{icon:y(B),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),a[2]||(a[2]=m("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),p(y(j),{class:"ion-padding"},{default:c(()=>[m("div",na,[m("div",oa,[p(y(C),null,{default:c(()=>[p(y(r),null,{default:c(()=>[p(aa)]),_:1})]),_:1})])])]),_:1}),p(y(q),null,{default:c(()=>[p(y(O))]),_:1})],64))}}),ia={style:{display:"flex","align-items":"center"}},sa={style:{"font-weight":"400","font-size":"19px"}},ua={style:{display:"flex","align-items":"center"}},ca={style:{"font-weight":"600","font-size":"17px"}},pa={style:{"margin-top":"15px",width:"100%"}},va={key:0,class:"error-message"},fa={key:1},ma={slot:"start",class:"prefix-container"},_a=["value"],ga={key:0,class:"error-message"},ha={style:{"font-size":"16px","font-weight":"600px",color:"red"}},ba={key:1},ya={style:{"font-weight":"400","font-size":"19px"}},xa={style:{display:"flex","align-items":"center"}},wa={style:{"font-weight":"400","font-size":"20px"}},ka={style:{display:"flex","align-items":"center"}},Da=t({name:"UpdateNCDNumberModal"}),Ia=t({...Da,emits:["closePopover","save"],setup(e,{emit:a}){const t=G(),l=De(),{patient:r}=U(l),i=h(""),u=h(""),v=h(""),_=h(!1),x=new Ie;let k=null;const I=e=>{const a=e.target.value.replace(/[^0-9]/g,"");a!==e.target.value&&(_.value=!0,k&&clearTimeout(k),k=window.setTimeout(()=>{_.value=!1,k=null},3e3),i.value=a)},V=()=>{_.value=!1,k&&(clearTimeout(k),k=null)},S=E(()=>i.value&&""!==i.value.trim()),C=async()=>{try{const e=await he.getNextSuggestedNCDNumber(),a=e.ncd_number.replace(/^\D+|\s/g,""),t=e.ncd_number.replace(/\d+/g,"")+"-NCD-";i.value=a,u.value=t}catch(e){console.error("Error fetching suggested NCD number:",e),v.value="Failed to fetch suggested NCD number (missing SITE Prefix)"}};D(()=>{C()}),b(()=>r.value.ID,()=>{C()},{deep:!0});const N=a;function P(){N("closePopover",!1),$.dismiss()}async function H(){try{if(v.value="",!S.value)return void(v.value="Please enter a valid NCD number");const e=`${u.value}${i.value}`,a=await Ie.findByID(r.value.patientID);for(const t of a.patient_identifiers)31===t.identifier_type&&(await x.updateNCDNumber(t.patient_identifier_id,e),N("save",{newNcdId:e}));await Ve(r.value),P()}catch(e){console.error(e)}}return(e,a)=>(n(),s(g,null,[p(y(M),null,{default:c(()=>[p(y(O),null,{default:c(()=>[p(y(L),null,{default:c(()=>[m("div",ia,[p(y(z),{icon:y(J),class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),a[3]||(a[3]=m("b",{style:{"margin-left":"6px"}},"Update NCD Number",-1))])]),_:1}),p(y(T),{slot:"end"},{default:c(()=>[p(y(L),null,{default:c(()=>[p(y(F),{onClick:a[0]||(a[0]=e=>P()),fill:"solid"},{default:c(()=>[m("span",sa,[m("div",ua,[p(y(z),{icon:y(B),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),a[4]||(a[4]=m("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),p(y(j),{class:"ion-padding"},{default:c(()=>[p(y(R),null,{default:c(()=>[p(y(d),{class:"current-ncd-item"},{default:c(()=>[p(y(o),null,{default:c(()=>[a[5]||(a[5]=m("h2",null,"Current NCD Number",-1)),m("p",ca,f(y(r).NcdID||"Not assigned"),1)]),_:1})]),_:1}),p(y(d),null,{default:c(()=>[m("div",pa,[_.value?(n(),s("div",va,[p(y(z),{icon:y(Q),color:"danger"},null,8,["icon"]),a[6]||(a[6]=m("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),p(y(F),{fill:"clear",size:"small",onClick:V},{default:c(()=>[p(y(z),{icon:y(B)},null,8,["icon"])]),_:1})])):w("",!0),v.value?w("",!0):(n(),s("div",fa,[a[7]||(a[7]=m("span",{style:{"font-weight":"600","font-size":"17px",color:"grey"}},"New NCD Number",-1)),p(y(Z),{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),placeholder:"Enter number",inputmode:"numeric",pattern:"[0-9]*",onInput:I,class:"custom-input"},{default:c(()=>[m("div",ma,[m("input",{value:u.value,readonly:"",class:"prefix-part",type:"text"},null,8,_a)])]),_:1},8,["modelValue"])]))])]),_:1}),v.value?(n(),s("div",ga,[p(y(K),{color:"danger"},{default:c(()=>[m("span",ha,f(v.value),1)]),_:1})])):w("",!0),v.value?(n(),s("div",ba,[p(y(F),{onClick:a[2]||(a[2]=e=>function(e){try{console.log(e),t.push(e)}catch(a){console.error(a)}}("setSitePrefix")),fill:"solid",style:{margin:"14px"}},{default:c(()=>[m("span",ya,[m("div",xa,[p(y(z),{icon:y(W),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),a[8]||(a[8]=m("span",{style:{"margin-left":"6px"}},"set Site Prefix",-1))])])]),_:1})])):w("",!0)]),_:1})]),_:1}),p(y(q),null,{default:c(()=>[p(y(O),null,{default:c(()=>[p(y(T),{slot:"end"},{default:c(()=>[p(y(L),null,{default:c(()=>[p(y(F),{onClick:H,fill:"solid",disabled:!S.value},{default:c(()=>[m("span",wa,[m("div",ka,[p(y(z),{icon:y(A),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),a[9]||(a[9]=m("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}}),Va=ne(Ia,[["__scopeId","data-v-696e3b8f"]]),Sa={key:0,style:{display:"flex","justify-content":"space-between",width:"100%"}},Ca={key:0},Na={key:1,style:{"font-weight":"bold",padding:"1.7px"}},Pa={key:1,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},Aa={key:0},Ba={key:1},Ha={key:2},Fa={key:2},Ua={style:{display:"flex","flex-wrap":"wrap",gap:"8px",width:"100%"}},Ea={key:3,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},Ra={key:0},Oa={key:1},La={key:2},Ta={key:3},za={key:4,style:{width:"100%","text-align":"center","border-collapse":"collapse",border:"1px solid black"}},Ma={key:0},ja={style:{border:"1px solid black"}},qa={style:{border:"1px solid black"}},$a={style:{border:"1px solid black"}},Ga={style:{border:"1px solid black"}},Ja=ne(t({__name:"NCDVisitLbl",props:{imageOut:{type:Object},patient:{type:Object}},emits:["label-out"],setup(e,{emit:a}){const t=a,l=h(null),o=h(0),r=h(""),d=h(4),i=e,c=E(()=>{var e;return null!==(e=i.patient)&&void 0!==e&&e.medications?i.patient.medications.filter(e=>e&&(e.name||e.dose||e.frequency||e.quantity)):[]}),p=E(()=>{var e,a;const t=null===(e=i.patient)||void 0===e?void 0:e.vitals;return t&&(t.height||t.weight||t.bloodPressure||(null===(a=i.patient)||void 0===a?void 0:a.bloodGlucose))}),_=E(()=>{const e=c.value;if(0===e.length)return[];if(0===o.value)return e.slice(0,2);{const a=2+(o.value-1)*d.value;return e.slice(a,a+d.value)}}),b=E(()=>{const e=c.value.length;if(e<=2)return 1;const a=e-2;return 1+Math.ceil(a/d.value)});return D(async()=>{try{const e=xe.getIsIpPrintersStatus();d.value=e?7:4,r.value=e?"800px":"594px";const a=await(async()=>{const e=[];for(let t=0;t<b.value;t++){o.value=t,await new Promise(e=>setTimeout(e,100));try{let a;a=xe.getIsIpPrintersStatus()?await Y.toCanvas(l.value,{height:300,width:800}):await Y.toPng(l.value,{height:300,width:594}),e.push(a)}catch(a){console.error("Error generating image for page",t,a)}}return e})();t("label-out",a),"function"==typeof i.imageOut&&i.imageOut(a)}catch(e){console.error("Error generating patient labels:",e)}}),(a,t)=>{var d,i,c,h,b,y,x,k,D,I,V,S,C,N,P,A,B,H;return n(),s("div",{ref_key:"lblComponent",ref:l,id:"container",style:X("padding: 15px; width:"+r.value)},[0===o.value&&(null!==(d=e.patient)&&void 0!==d&&d.latestVisitDate||null!==(i=e.patient)&&void 0!==i&&i.patientID)?(n(),s("div",Sa,[null!==(c=e.patient)&&void 0!==c&&c.latestVisitDate?(n(),s("span",Ca,[t[0]||(t[0]=m("b",null,"Visit:",-1)),v(" "+f(e.patient.latestVisitDate),1)])):w("",!0),null!==(h=e.patient)&&void 0!==h&&h.patientID?(n(),s("span",Na,f(e.patient.patientID),1)):w("",!0)])):w("",!0),0===o.value&&(null!==(b=e.patient)&&void 0!==b&&b.patientName||null!==(y=e.patient)&&void 0!==y&&y.gender||null!==(x=e.patient)&&void 0!==x&&x.diagnoses&&e.patient.diagnoses.length>0)?(n(),s("div",Pa,[null!==(k=e.patient)&&void 0!==k&&k.patientName||null!==(D=e.patient)&&void 0!==D&&D.gender?(n(),s("span",Aa,[m("b",null,f(null===(I=e.patient)||void 0===I?void 0:I.patientName)+f(null!==(V=e.patient)&&void 0!==V&&V.gender?`(${e.patient.gender})`:""),1)])):w("",!0),null!==(S=e.patient)&&void 0!==S&&S.prescriber?(n(),s("span",Ba,[t[1]||(t[1]=m("b",null,"Seen by:",-1)),v(f(e.patient.prescriber),1)])):w("",!0),null!==(C=e.patient)&&void 0!==C&&C.nextAppointment?(n(),s("span",Ha,[t[2]||(t[2]=m("b",null,"Nxt App:",-1)),v(" "+f(e.patient.nextAppointment),1)])):w("",!0)])):w("",!0),0===o.value&&null!==(N=e.patient)&&void 0!==N&&N.diagnoses&&e.patient.diagnoses.length>0?(n(),s("div",Fa,[m("span",Ua,[t[3]||(t[3]=m("b",null,"Diagnoses:",-1)),v(" "+f(e.patient.diagnoses.filter(e=>e).join(", ")),1)])])):w("",!0),0===o.value&&p.value?(n(),s("div",Ea,[null!==(P=e.patient)&&void 0!==P&&null!==(P=P.vitals)&&void 0!==P&&P.height?(n(),s("span",Ra,f(e.patient.vitals.height||""),1)):w("",!0),null!==(A=e.patient)&&void 0!==A&&null!==(A=A.vitals)&&void 0!==A&&A.weight?(n(),s("span",Oa,f(e.patient.vitals.weight||""),1)):w("",!0),null!==(B=e.patient)&&void 0!==B&&null!==(B=B.vitals)&&void 0!==B&&B.bloodPressure?(n(),s("span",La,f(e.patient.vitals.bloodPressure||""),1)):w("",!0),null!==(H=e.patient)&&void 0!==H&&H.bloodGlucose?(n(),s("span",Ta,f(e.patient.bloodGlucose||""),1)):w("",!0)])):w("",!0),_.value.length>0?(n(),s("table",za,[0===o.value?(n(),s("thead",Ma,[...t[4]||(t[4]=[m("tr",null,[m("th",{style:{border:"1px solid black"}},"Drug"),m("th",{style:{border:"1px solid black"}},"Dose"),m("th",{style:{border:"1px solid black"}},"Freq"),m("th",{style:{border:"1px solid black"}},"Qty")],-1)])])):w("",!0),m("tbody",null,[(n(!0),s(g,null,u(_.value,(e,a)=>(n(),s("tr",{key:a},[m("td",ja,f((null==e?void 0:e.name)||""),1),m("td",qa,f((null==e?void 0:e.dose)||""),1),m("td",$a,f((null==e?void 0:e.frequency)||""),1),m("td",Ga,f((null==e?void 0:e.quantity)||""),1)]))),128))])])):w("",!0)],4)}}}),[["__scopeId","data-v-cde3e630"]])}}});
