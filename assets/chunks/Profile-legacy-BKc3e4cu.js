System.register(["./vendor-legacy-CdypqbXP.js","../index-legacy-CQ-7M6kd.js","./DemographicBar-legacy-BEY4wqH6.js","./useFormWizard-legacy-DczO6gxA.js","./MedicalHistory-legacy-C8xKDPIU.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-DPlv51y0.js"],function(e,a){"use strict";var t,i,n,o,r,l,s,d,u,c,v,p,m,f,g,y,b,h,x,w,T,k,D,P,G,N,F,A,S,I,M,C,_,q,O,z,V,L,B,E,H,$,R,j,W,U,Y,J,K,Q,Z,X,ee,ae,te,ie,ne,oe,re,le,se,de,ue,ce,ve,pe;return{setters:[e=>{t=e.c,i=e.d,n=e.r,o=e.b2,r=e.w,l=e.a,s=e.n,d=e.e,u=e.f,c=e.k,v=e.l,p=e.J,m=e.O,f=e.u,g=e.aV,y=e.bj,b=e.m,h=e.F,x=e.P,w=e.p,T=e.L,k=e.K,D=e.eO,P=e.at,G=e.aa,N=e.eP,F=e.Q,A=e.c1,S=e.eI,I=e.aM,M=e.av,C=e.e0,_=e.bw,q=e.aS,O=e.aR,z=e.am,V=e.cr,L=e.ab,B=e.i,E=e.bT,H=e.v,$=e.ae,R=e.ba},e=>{j=e.n,W=e.u,U=e.z,Y=e.t,J=e.F,K=e.b,Q=e.Z,Z=e._,X=e.e,ee=e.a7,ae=e.f,te=e.T,ie=e.D,ne=e.a1,oe=e.H,re=e.b3,le=e.C},e=>{se=e.D},e=>{de=e.u,ue=e._},e=>{ce=e.M,ve=e.a,pe=e.W},null,null],execute:function(){var a=document.createElement("style");a.textContent=".container[data-v-2d34e009]{padding:16px}.custom-card[data-v-2d34e009]{background:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.tetanus-immunization-wrapper[data-v-38c4c6e6]{width:100%;padding:15px;margin-bottom:0}.dashed-separator[data-v-38c4c6e6]{width:100%;height:1px;border-bottom:1px dashed #dde1e6;margin:20px 0}.dashed-separator-thin[data-v-38c4c6e6]{width:100%;height:1px;border-bottom:1px dashed #e8e8e8;margin:16px 0}.field-header-container[data-v-38c4c6e6]{margin-bottom:16px}.header-with-icon[data-v-38c4c6e6]{display:flex;align-items:flex-start;gap:12px}.header-icon[data-v-38c4c6e6]{font-size:24px;color:#016302;margin-top:2px;flex-shrink:0}.field-header[data-v-38c4c6e6]{font-size:14px;font-weight:600;color:#00190e;margin:0 0 4px;line-height:1.4}.field-description[data-v-38c4c6e6]{font-size:13px;color:#666;margin:0;line-height:1.4}.required-asterisk[data-v-38c4c6e6]{color:#b3261e;margin-left:2px}.status-selection[data-v-38c4c6e6]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-bottom:0}.status-option[data-v-38c4c6e6]{display:flex;align-items:center;gap:10px;background:#fff;border:1.5px solid #dde1e6;border-radius:8px;padding:12px;cursor:pointer;transition:all .2s ease}.status-option[data-v-38c4c6e6]:hover{border-color:#016302;background:#f8f9fa}.status-option.selected[data-v-38c4c6e6]{border-color:#016302;background:#e8f5e9;border-width:2px}.status-icon[data-v-38c4c6e6]{font-size:22px;color:#666;flex-shrink:0}.status-option.selected .status-icon[data-v-38c4c6e6]{color:#016302}.status-content[data-v-38c4c6e6]{display:flex;flex-direction:column;gap:2px;flex:1}.status-label[data-v-38c4c6e6]{font-size:13px;font-weight:600;color:#00190e}.status-desc[data-v-38c4c6e6]{font-size:11px;color:#666}.doses-section[data-v-38c4c6e6]{background:#fff;margin-top:0}.section-subtitle-header[data-v-38c4c6e6]{display:flex;align-items:center;justify-content:space-between;border-radius:6px;margin-bottom:20px}.subtitle-left[data-v-38c4c6e6]{display:flex;align-items:center;gap:8px;font-size:13px;font-weight:600;color:#00190e}.subtitle-icon[data-v-38c4c6e6]{font-size:18px;color:#016302}.progress-badge[data-v-38c4c6e6]{background:#016302;color:#fff;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600}.doses-grid[data-v-38c4c6e6]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}.date-input[data-v-38c4c6e6]:disabled{background:#f5f5f5;cursor:not-allowed;opacity:.6}.date-input.disabled[data-v-38c4c6e6]{background:#f5f5f5;border-color:#e8e8e8}@media(max-width:992px){.doses-grid[data-v-38c4c6e6]{grid-template-columns:repeat(2,1fr)}}@media(max-width:576px){.doses-grid[data-v-38c4c6e6]{grid-template-columns:1fr}}.dose-field-group[data-v-38c4c6e6]{display:flex;flex-direction:column;gap:8px;margin-bottom:0}.field-group[data-v-38c4c6e6]{margin-bottom:20px}.input-header-row[data-v-38c4c6e6]{display:flex;align-items:center;justify-content:space-between}.input-label[data-v-38c4c6e6]{font-size:13px;font-weight:500;color:#00190e;display:flex;align-items:center;gap:6px}.label-icon[data-v-38c4c6e6]{font-size:16px;color:#016302}.completed-badge[data-v-38c4c6e6]{color:#10b981;font-size:20px;display:flex;align-items:center}.input-wrapper[data-v-38c4c6e6]{position:relative}.date-input[data-v-38c4c6e6]{width:100%;background:#fff;border:1.5px solid #dde1e6;border-radius:8px;padding:10px 40px 10px 12px;font-size:13px;color:#00190e;outline:none;transition:all .2s ease;font-family:inherit}.date-input[data-v-38c4c6e6]:hover{border-color:#016302}.date-input[data-v-38c4c6e6]:focus{border-color:#016302}.date-input.has-error[data-v-38c4c6e6]{border-color:#b3261e}.input-icon-readonly[data-v-38c4c6e6]{position:absolute;right:12px;top:11px;font-size:18px;color:#666;pointer-events:none}.input-icon[data-v-38c4c6e6]{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:18px;color:#666;pointer-events:none}.text-input-container[data-v-38c4c6e6]{position:relative;display:flex;align-items:center}.text-input[data-v-38c4c6e6]{width:100%;background:#fff;border:1.5px solid #dde1e6;border-radius:8px;padding:10px 40px 10px 12px;font-size:13px;color:#00190e;outline:none;transition:all .2s ease}.text-input[data-v-38c4c6e6]:focus{border-color:#016302}.text-input[data-v-38c4c6e6]::placeholder{color:#999}.text-input-container .input-icon[data-v-38c4c6e6]{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:18px;color:#666;pointer-events:none}.error-message[data-v-38c4c6e6]{display:flex;align-items:center;gap:4px;font-size:11px;color:#b3261e;margin-top:6px}.error-icon[data-v-38c4c6e6]{font-size:14px}.prerequisite-message[data-v-38c4c6e6]{display:flex;align-items:center;gap:8px;font-size:12px;color:#666;padding:10px 12px;background:#f5f5f5;border-radius:6px}.lock-icon[data-v-38c4c6e6]{font-size:16px;color:#999}.dose-count-options[data-v-38c4c6e6]{display:grid;grid-template-columns:repeat(11,1fr);gap:10px}.dose-count-btn[data-v-38c4c6e6]{display:flex;flex-direction:column;align-items:center;gap:4px;background:#fff;border:1.5px solid #dde1e6;border-radius:8px;padding:4px;cursor:pointer;transition:all .2s ease}.dose-count-btn[data-v-38c4c6e6]:hover{border-color:#016302}.dose-count-btn.active[data-v-38c4c6e6]{border-color:#016302;background:#e8f5e9;border-width:2px}.count-number[data-v-38c4c6e6]{font-size:20px;font-weight:700;color:#00190e}.count-label[data-v-38c4c6e6]{font-size:11px;color:#666}.dose-count-btn.active .count-number[data-v-38c4c6e6]{color:#016302}.radio-options[data-v-38c4c6e6]{display:flex;flex-direction:row;gap:8px;flex-wrap:wrap}.radio-option[data-v-38c4c6e6]{display:flex;align-items:center;gap:12px;padding:12px;cursor:pointer;transition:all .2s ease;flex:1 1 auto;min-width:120px}.radio-option[data-v-38c4c6e6]:hover{border-color:#016302}.radio-circle[data-v-38c4c6e6]{width:20px;height:20px;border:2px solid #666666;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s ease;flex-shrink:0}.radio-circle.checked[data-v-38c4c6e6]{border-color:#016302}.radio-dot[data-v-38c4c6e6]{width:10px;height:10px;background:#016302;border-radius:50%}.radio-option label[data-v-38c4c6e6]{flex:1;font-size:13px;color:#00190e;cursor:pointer;margin:0}.alert-box[data-v-38c4c6e6]{display:flex;gap:10px;background:#fff4e5;border:1.5px solid #f59e0b;border-radius:2px;padding:10px;margin-top:0}.alert-icon[data-v-38c4c6e6]{font-size:24px;color:#f59e0b;flex-shrink:0;margin-top:2px}.alert-title[data-v-38c4c6e6]{font-size:13px;font-weight:600;color:#00190e;margin-bottom:4px}.alert-text[data-v-38c4c6e6]{font-size:12px;color:#666;line-height:1.5}@media(max-width:768px){.status-selection[data-v-38c4c6e6],.dose-count-options[data-v-38c4c6e6]{grid-template-columns:repeat(2,1fr)}}.container[data-v-e88315ec]{display:flex;flex-direction:column;align-items:center}.section[data-v-e88315ec]{width:100%;max-width:1300px;margin-bottom:6px}ion-card[data-v-e88315ec]{width:100%;color:#000}@media(max-width:1500px){.container[data-v-e88315ec]{padding:10px}}.container[data-v-7161ce7a]{display:flex;flex-direction:column;align-items:center}.section[data-v-7161ce7a]{width:100%;max-width:1300px;margin-bottom:20px}ion-card[data-v-7161ce7a]{width:100%;color:#000}ion-card-title[data-v-7161ce7a]{font-size:20px;font-weight:700;color:#00190e}@media(max-width:1500px){.container[data-v-7161ce7a]{padding:10px}}.back_profile[data-v-7e500135]{margin-bottom:16px}\n/*$vite$:1*/",document.head.appendChild(a);const me=()=>{const e=[{id:1,name:"Caesarean section"},{id:2,name:"Vacuum extraction delivery"},{id:3,name:"Breech delivery"},{id:4,name:"SVD"},{id:5,name:"Other"}],a=[{id:1,name:"Asphyxia"},{id:2,name:"Pre-eclampsia"},{id:3,name:"Eclampsia"},{id:4,name:"Puerperal Sepsis"},{id:5,name:"Baby died within 24hrs of birth"},{id:6,name:"Convulsions"},{id:7,name:"Gestational diabetes mellitus"},{id:8,name:"Heavy bleeding"},{id:9,name:"Macrosomia"},{id:10,name:"Perineal tear (3rd or 4th degree)"},{id:11,name:"Other"},{id:12,name:"None"}];return{resetForm:()=>{},pastObstetricHistoryFormSection:t(()=>{const t=[{componentType:"inputField",header:"Gravida",name:"Gravida",icon:j.editPen,required:!0,grid:{s:"12"},validation:e=>{if(!e||""===e)return"Gravida is required";const a=Number(e);return isNaN(a)?"Gravida can only be number":a<0?"Gravida must be 0 or greater":a>30?"Gravida must be 30 or less":null},onChange:(e,a)=>{if(!a)return{};const t=e?parseInt(e):null,i={};if(null===t||0===t||""===e)i["Abortions/Miscarriages"]="",i.Stillbirths="",i.LiveBirths="",i.Parity="";else if(1===t){i["Abortions/Miscarriages"]="",i.Stillbirths="",i.LiveBirths="",i.Parity="",i["Gestational age at last live birth"]="",i["Last live birth had congenital abnormalities"]="",i["past pregnancies complications"]=[];for(let e=0;e<30;e++)i[`Mode of delivery ${e}`]="",i[`Specify ${e}`]=""}else{const e=parseInt(a["Abortions/Miscarriages"])||0;if(!isNaN(t)&&!isNaN(e)){i.Parity=Math.max(0,t-e-1);const n=parseInt(a.Stillbirths)||0;if(!isNaN(n)){const a=t-e-1;i.LiveBirths=Math.max(0,a-n)}}}return i}},{componentType:"inputField",header:"Abortions/Miscarriages",name:"Abortions/Miscarriages",icon:j.editPen,required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>{const t=parseInt(null==a?void 0:a.Gravida)||0;if(t<=1)return null;if(!e||""===e)return"Abortions/Miscarriages is required";const i=Number(e);return isNaN(i)?"Abortions/Miscarriages can only be number":i<0?"Abortions/Miscarriages must be 0 or greater":t>0&&i>=t?"Abortions/Miscarriages cannot be equal to or greater than Gravida":null},condition:e=>parseInt(e.Gravida)>1,onChange:(e,a)=>{if(!a)return{};const t=parseInt(a.Gravida)||0,i=e?parseInt(e):0,n={};if(!isNaN(t)&&!isNaN(i)&&t>1){const e=Math.max(0,t-i-1);n.Parity=e;const o=parseInt(a.Stillbirths)||0;isNaN(o)||(n.LiveBirths=Math.max(0,e-o))}else n.Parity="",n.LiveBirths="";return n}},{componentType:"inputField",header:"Stillbirths",name:"Stillbirths",icon:j.editPen,required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>{if((parseInt(null==a?void 0:a.Gravida)||0)<=1)return null;if(!e||""===e)return"Stillbirths is required";const t=Number(e);if(isNaN(t))return"Stillbirths can only be number";if(t<0)return"Stillbirths must be 0 or greater";const i=parseInt(null==a?void 0:a.Parity)||0;return i>0&&t>i?"Stillbirths cannot exceed Parity":null},condition:e=>parseInt(e.Gravida)>1,onChange:(e,a)=>{if(!a)return{};const t=parseInt(a.Parity)||0,i=e?parseInt(e):0;return isNaN(t)||isNaN(i)?{LiveBirths:""}:{LiveBirths:Math.max(0,t-i)}}},{componentType:"inputField",header:"Live births",name:"LiveBirths",disabled:!0,grid:{s:"12",md:"6"},condition:e=>parseInt(e.Gravida)>1},{componentType:"inputField",header:"Parity",name:"Parity",required:!1,disabled:!0,grid:{s:"12",md:"6"},condition:e=>parseInt(e.Gravida)>1},{grid:{s:"12"},componentType:"Dashes"}],i=(a=>{const t=[];for(let i=0;i<a;i++)t.push({componentType:"multiSelectInputField",header:`Specify mode of delivery (child ${i+1})`,name:`Mode of delivery ${i}`,trackBy:"id",isMultiple:!1,required:!0,options:e,grid:{s:"12",md:"6"},validation:(e,a)=>{const t=parseInt(null==a?void 0:a.LiveBirths)||0;return i>=t||e&&""!==e?null:`Mode of delivery for child ${i+1} is required`},condition:e=>{const a=parseInt(e.LiveBirths)||0;return a>0&&a>i},onChange:(a,t)=>{const n={},o=e.find(e=>e.id===a);return"Other"!==((null==o?void 0:o.name)||"")&&(n[`Specify ${i}`]=""),n}});t.push({grid:{s:"12"},componentType:"Dashes",condition:e=>(parseInt(e.LiveBirths)||0)>0});for(let i=0;i<a;i++)t.push({componentType:"inputField",header:`Specify delivery details (child ${i+1})`,name:`Specify ${i}`,icon:j.editPen,required:!0,grid:{s:"12",md:"6"},validation:(a,t)=>{const n=parseInt(null==t?void 0:t.LiveBirths)||0;if(i>=n)return null;const o=null==t?void 0:t[`Mode of delivery ${i}`],r=e.find(e=>e.id===o);return"Other"!==((null==r?void 0:r.name)||"")||a&&""!==a?null:`Please specify details for child ${i+1}`},condition:a=>{const t=parseInt(a.LiveBirths)||0,n=a[`Mode of delivery ${i}`],o=e.find(e=>e.id===n),r=(null==o?void 0:o.name)||"";return t>0&&t>i&&("Caesarean section"===r||"Other"===r)}});return t})(30);return t.push(...i),t.push({componentType:"Alert",name:"FirstPregnancyAlert",backgroundColor:"#FFD700",status:"info",icon:"info-circle",textColor:"#000000",value:"First pregnancy, proceed.",grid:{s:"12"},condition:e=>1===parseInt(e.Gravida)},{componentType:"radioButtonField",header:"What was the gestational age at last live birth?",name:"Gestation age at last live birth",options:[{value:"<28 weeks",label:"<28 weeks"},{value:"28–34 weeks",label:"28–34 weeks"},{value:"35–36 weeks",label:"35–36 weeks"},{value:"≥37 weeks (Full term)",label:"≥37 weeks (Full term)"}],grid:{s:"12"},condition:e=>parseInt(e.Gravida)>1},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Last live birth had congenital abnormalities?",name:"Last live birth had congenital abnormalities",type:"inline",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>parseInt(e.Gravida)>1},{grid:{s:"12"},componentType:"Dashes"},{componentType:"Heading",name:"Past Pregnancy Complications",grid:{s:"12"},condition:e=>parseInt(e.Gravida)>1},{componentType:"multiSelectInputField",header:"Did the woman have any of the complications during the past pregnancies?",name:"past pregnancies complications",isMultiple:!0,trackBy:"id",grid:{s:"12"},options:a,validation:e=>{if(!e||0===e.length)return"Please select at least one option or 'None'";if(Array.isArray(e)){const a=e.some(e=>"None"===e.name),t=e.some(e=>"None"!==e.name);if(a&&t)return"'None' cannot be selected with other complications"}return null},condition:e=>parseInt(e.Gravida)>1,onChange:(e,a)=>{if(!a||!Array.isArray(e))return{};const t={};if(Array.isArray(e)){const a=e.some(e=>"None"===e.name),i=e.some(e=>"Other"===e.name);if(a){const a=e.find(e=>"None"===e.name);t["past pregnancies complications"]=[a],t["Other complications notes"]=""}i||(t["Other complications notes"]="")}return t}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"inputField",header:"Specify other complications*",name:"Other complications notes",icon:j.editPen,required:!0,grid:{s:"12"},validation:(e,a)=>{const t=null==a?void 0:a["past pregnancies complications"];if(Array.isArray(t)){const a=t.some(e=>"Other"===e.name),i=t.some(e=>"None"===e.name);if(a&&!i&&(!e||""===e))return"Please specify other complications"}return null},condition:e=>{const a=parseInt(e.Gravida),t=e["past pregnancies complications"];if(a<=1||!Array.isArray(t))return!1;const i=t.some(e=>"Other"===e.name),n=t.some(e=>"None"===e.name);return i&&!n}}),t})}},fe={class:"container"},ge={class:"custom-card"},ye=Z(i({__name:"PastObstetricHistory",setup(e,{expose:a}){const i=me(),y=n(null),b=n(0),h=W(),{patient:x}=o(h);r(()=>{var e;return null===(e=x.value)||void 0===e?void 0:e.patientID},async(e,a)=>{e&&e!==a&&(b.value++,await s())});const w=async e=>{const a=[];for(const[t,i]of Object.entries(e))if(i&&!1!==i&&""!==i&&"FirstPregnancyAlert"!==t)if(Array.isArray(i))if("past pregnancies complications"===t)for(const e of i){const i="object"==typeof e&&null!==e?e.name:e;i&&""!==i&&a.push(await J.buildValueText(t,String(i)))}else for(const e of i){const i="object"==typeof e&&null!==e?e.value||e.name:e;i&&""!==i&&a.push(await J.buildValueText(t,String(i)))}else if("object"==typeof i&&null!==i){if(t.startsWith("Mode of delivery")){const n=i.name||"";if(n){const i=e[`Specify ${t.replace("Mode of delivery ","")}`];if("Caesarean section"!==n&&"Other"!==n||!i)a.push(await J.buildValueText("Mode of delivery",n));else{const e=await J.buildValueText("Mode of delivery",n),t=await J.buildValueText("Mode of delivery details",i);e.child=[t],a.push(e)}}}}else if("string"==typeof i||"number"==typeof i){if(t.startsWith("Specify "))continue;a.push(await J.buildValueText(t,String(i)))}else"boolean"==typeof i&&!0===i&&a.push(await J.buildValueText("Past obstetric finding",t));return a};l(async()=>{await s()});const T=t(()=>i.pastObstetricHistoryFormSection.value);return a({validateForm:()=>{var e;return null===(e=y.value)||void 0===e?void 0:e.validateForm()},onSubmit:async()=>{if(!y.value)return console.error("Form reference is not available"),!1;const e=y.value.validateForm();if(e)return Y("Please fix validation errors before submitting"),console.log("Validation errors:",e),!1;const a=y.value.getFormValues();try{const e=await w(a);return 0===e.length?(Y("No past obstetric history data to save"),!1):(await J.addObsToEncounterPatient(e,K.OBSTETRIC_HISTORY),b.value++,await s(),Q("Past obstetric history saved successfully"),!0)}catch(t){return console.error("Error processing past obstetric history:",t),Y((null==t?void 0:t.message)||"Failed to save past obstetric history"),!1}},resetForm:()=>{b.value++}}),(e,a)=>(u(),d("div",fe,[c("div",ge,[v(f(g),null,{default:p(()=>[(u(),m(U,{formData:T.value,ref_key:"formRef",ref:y,key:b.value},null,8,["formData"]))]),_:1})])]))}}),[["__scopeId","data-v-2d34e009"]]),be={class:"tetanus-immunization-wrapper"},he={class:"status-selection"},xe=["onClick"],we={class:"status-content"},Te={class:"status-label"},ke={class:"status-desc"},De={key:0,class:"dashed-separator"},Pe={key:1,class:"doses-section"},Ge={class:"section-subtitle-header"},Ne={class:"progress-badge"},Fe={class:"doses-grid"},Ae={class:"input-header-row"},Se={class:"input-label"},Ie={key:0,class:"completed-badge"},Me={class:"input-wrapper"},Ce=["value","onChange","max","min","disabled"],_e={key:0,class:"error-message"},qe={key:2,class:"doses-section"},Oe={class:"field-group"},ze={class:"dose-count-options"},Ve=["onClick"],Le={class:"count-number"},Be={class:"count-label"},Ee={key:0,class:"dashed-separator"},He={class:"doses-grid"},$e={class:"input-header-row"},Re={class:"input-label"},je={key:0,class:"completed-badge"},We={class:"input-wrapper"},Ue=["value","onChange","max","min","disabled"],Ye={key:0,class:"error-message"},Je={key:3,class:"doses-section"},Ke={class:"field-group"},Qe={class:"radio-options"},Ze=["onClick"],Xe={key:0,class:"radio-dot"},ea={key:0,class:"dashed-separator-thin"},aa={key:1,class:"field-group"},ta={class:"input-label"},ia={class:"input-wrapper"},na={class:"text-input-container"},oa=["value"],ra={key:4,class:"alert-box"},la={key:5,class:"dashed-separator"},sa=Z(i({__name:"TetanusImmunizationTable",setup(e,{expose:a}){const i=[{value:"Fully immunised",label:"Fully Immunised",description:"5 doses",icon:D},{value:"Under immunised",label:"Under Immunised",description:"1-4 doses",icon:P},{value:"No doses",label:"No Doses",description:"Not immunized",icon:G},{value:"Unknown doses",label:"Unknown",description:"Status unclear",icon:N}],o=[{value:"stockout",label:"Stockout"},{value:"client is ill",label:"Client is ill"},{value:"client refused",label:"Client refused"},{value:"allergy",label:"Allergy to vaccine"},{value:"other",label:"Other (please specify)"}],r=n(""),l=n(Array(5).fill("")),s=n(Array(5).fill("")),p=n(Array(4).fill("")),m=n(Array(4).fill("")),g=n(0),_=n(""),q=n(""),O=t(()=>l.value.filter(e=>""!==e).length);return t(()=>p.value.filter(e=>""!==e).length),a({getValues:()=>{const e={"The woman received tetanus doses for immunization?":r.value};if("Fully immunised"===r.value)for(let a=0;a<5;a++)e[`tt1Date${a+1}`]=l.value[a];if("Under immunised"===r.value){e["Number of tetanus doses"]=1===g.value?"one dose":2===g.value?"two doses":3===g.value?"three doses":"four doses";for(let a=0;a<g.value;a++)e[`tt2Date${a+1}`]=p.value[a]}return"No doses"===r.value&&(e["Reason Tetanus toxoid (TT) was not conducted"]=_.value,"other"===_.value&&(e.Other=q.value)),e},validate:()=>{if(!r.value)return"Tetanus immunization status is required";if("Fully immunised"===r.value)for(let e=0;e<5;e++){if(!l.value[e])return`TTV Dose ${e+1} date is required`;if(s.value[e])return s.value[e]}if("Under immunised"===r.value){if(!g.value)return"Please select number of doses";for(let e=0;e<g.value;e++){if(!p.value[e])return`TTV Dose ${e+1} date is required`;if(m.value[e])return m.value[e]}}if("No doses"===r.value){if(!_.value)return"Please select a reason";if("other"===_.value&&!q.value)return"Please specify other reason"}return null}}),(e,a)=>(u(),d("div",be,[a[9]||(a[9]=y('<div class="dashed-separator" data-v-38c4c6e6></div><div class="field-header-container" data-v-38c4c6e6><div class="header-with-icon" data-v-38c4c6e6><div data-v-38c4c6e6><h6 class="field-header" data-v-38c4c6e6>Select Tetanus Immunization Status <span class="required-asterisk" data-v-38c4c6e6>*</span></h6></div></div></div>',2)),c("div",he,[(u(),d(h,null,x(i,e=>c("div",{key:e.value,class:w(["status-option",{selected:r.value===e.value}]),onClick:a=>(e=>{r.value=e,l.value=Array(5).fill(""),p.value=Array(4).fill(""),s.value=Array(5).fill(""),m.value=Array(4).fill(""),g.value=0,_.value="",q.value=""})(e.value)},[v(f(T),{icon:e.icon,class:"status-icon"},null,8,["icon"]),c("div",we,[c("span",Te,k(e.label),1),c("span",ke,k(e.description),1)])],10,xe)),64))]),r.value?(u(),d("div",De)):b("",!0),"Fully immunised"===r.value?(u(),d("div",Pe,[c("div",Ge,[a[1]||(a[1]=c("div",{class:"subtitle-left"},[c("span",null,"Complete all 5 TDV dose dates")],-1)),c("span",Ne,k(O.value)+"/5",1)]),c("div",Fe,[(u(),d(h,null,x(5,e=>c("div",{key:`fully-${e}`,class:"dose-field-group"},[c("div",Ae,[c("label",Se,[F(" Date for TDV "+k(e)+" ",1),a[2]||(a[2]=c("span",{class:"required-asterisk"},"*",-1))]),l.value[e-1]?(u(),d("span",Ie,[v(f(T),{icon:f(A)},null,8,["icon"])])):b("",!0)]),c("div",Me,[c("input",{type:"date",value:l.value[e-1],onChange:a=>((e,a)=>{if(l.value[e]=a,s.value[e]="",e>0&&l.value[e-1]&&new Date(a)<=new Date(l.value[e-1]))s.value[e]=`Date must be after TTV ${e}`;else for(let t=e+1;t<5;t++)l.value[t]&&new Date(l.value[t])<=new Date(a)&&(l.value[t]="",s.value[t]="")})(e-1,a.target.value),max:(new Date).toISOString().split("T")[0],min:e>1&&l.value[e-2]?l.value[e-2]:void 0,disabled:e>1&&!l.value[e-2],class:w(["date-input",{"has-error":s.value[e-1],disabled:e>1&&!l.value[e-2]}])},null,42,Ce),v(f(T),{icon:e>1&&!l.value[e-2]?f(S):f(I),class:"input-icon-readonly"},null,8,["icon"])]),s.value[e-1]?(u(),d("div",_e,[v(f(T),{icon:f(M),class:"error-icon"},null,8,["icon"]),F(" "+k(s.value[e-1]),1)])):b("",!0)])),64))])])):b("",!0),"Under immunised"===r.value?(u(),d("div",qe,[c("div",Oe,[a[3]||(a[3]=c("div",{class:"header-with-icon"},[c("div",null,[c("h6",{class:"field-header"},[F("Number of doses received "),c("span",{class:"required-asterisk"},"*")])])],-1)),c("div",ze,[(u(),d(h,null,x([1,2,3,4],e=>c("button",{key:e,type:"button",class:w(["dose-count-btn",{active:g.value===e}]),onClick:a=>(e=>{g.value=e,p.value=Array(4).fill(""),m.value=Array(4).fill("")})(e)},[c("span",Le,k(e),1),c("span",Be,"dose"+k(e>1?"s":""),1)],10,Ve)),64))])]),g.value?(u(),d("div",Ee)):b("",!0),c("div",He,[(u(!0),d(h,null,x(g.value,e=>(u(),d("div",{key:`under-${e}`,class:"dose-field-group"},[c("div",$e,[c("label",Re,[F(" Date for TDV "+k(e)+" ",1),a[4]||(a[4]=c("span",{class:"required-asterisk"},"*",-1))]),p.value[e-1]?(u(),d("span",je,[v(f(T),{icon:f(A)},null,8,["icon"])])):b("",!0)]),c("div",We,[c("input",{type:"date",value:p.value[e-1],onChange:a=>((e,a)=>{if(p.value[e]=a,m.value[e]="",e>0&&p.value[e-1]&&new Date(a)<=new Date(p.value[e-1]))m.value[e]=`Date must be after TTV ${e}`;else for(let t=e+1;t<g.value;t++)p.value[t]&&new Date(p.value[t])<=new Date(a)&&(p.value[t]="",m.value[t]="")})(e-1,a.target.value),max:(new Date).toISOString().split("T")[0],min:e>1&&p.value[e-2]?p.value[e-2]:void 0,disabled:e>1&&!p.value[e-2],class:w(["date-input",{"has-error":m.value[e-1],disabled:e>1&&!p.value[e-2]}])},null,42,Ue),v(f(T),{icon:e>1&&!p.value[e-2]?f(S):f(I),class:"input-icon-readonly"},null,8,["icon"])]),m.value[e-1]?(u(),d("div",Ye,[v(f(T),{icon:f(M),class:"error-icon"},null,8,["icon"]),F(" "+k(m.value[e-1]),1)])):b("",!0)]))),128))])])):b("",!0),"No doses"===r.value?(u(),d("div",Je,[c("div",Ke,[a[5]||(a[5]=c("div",{class:"header-with-icon"},[c("div",null,[c("h6",{class:"field-header"},[F("Reason TDV was not conducted "),c("span",{class:"required-asterisk"},"*")])])],-1)),c("div",Qe,[(u(),d(h,null,x(o,e=>c("div",{key:e.value,class:w(["radio-option",{selected:_.value===e.value}]),onClick:a=>{return t=e.value,_.value=t,void("other"!==t&&(q.value=""));var t}},[c("div",{class:w(["radio-circle",{checked:_.value===e.value}])},[_.value===e.value?(u(),d("div",Xe)):b("",!0)],2),c("label",null,k(e.label),1)],10,Ze)),64))])]),"other"===_.value?(u(),d("div",ea)):b("",!0),"other"===_.value?(u(),d("div",aa,[c("label",ta,[v(f(T),{icon:f(C),class:"label-icon"},null,8,["icon"]),a[6]||(a[6]=F(" Specify other reasons ",-1)),a[7]||(a[7]=c("span",{class:"required-asterisk"},"*",-1))]),c("div",ia,[c("div",na,[c("input",{type:"text",value:q.value,onInput:a[0]||(a[0]=e=>{return a=e.target.value,void(q.value=a);var a}),placeholder:"Please specify the reason...",class:"text-input"},null,40,oa),v(f(T),{icon:f(C),class:"input-icon"},null,8,["icon"])])])])):b("",!0)])):b("",!0),"Unknown doses"===r.value?(u(),d("div",ra,[v(f(T),{icon:f(M),class:"alert-icon"},null,8,["icon"]),a[8]||(a[8]=c("div",{class:"alert-content"},[c("div",{class:"alert-title"},"Unknown Immunization Status"),c("div",{class:"alert-text"}," The woman's tetanus immunization history is not known. Please try to obtain this information from health records or previous documentation. ")],-1))])):b("",!0),r.value?(u(),d("div",la)):b("",!0)]))}}),[["__scopeId","data-v-38c4c6e6"]]),da={class:"container"},ua=Z(i({__name:"CurrentPregnancy",setup(e,{expose:a}){const i={resetForm:()=>{},gestationAgeSection:t(()=>[{componentType:"radioButtonField",header:"Gestation age to be used",name:"Gestation age to be used",type:"inline",required:!0,options:[{value:"GA by LNMP",label:"GA by LNMP"},{value:"GA by ultrasound",label:"GA by ultrasound"},{value:"GA by palpation",label:"GA by palpation"}],grid:{s:"12"},validation:e=>e&&""!==e?null:"Gestation age to be used is required",onChange:(e,a)=>({"lmnp date":"","Gestation weeks":"","Estimated date of delivery":"",Ultrasound:"",specify:"","ultrasound lmnp date":"","Estimated date of delivery from ultrasound":"","Gestation age by palpation":"","date of delivery":""})},{componentType:"dateInputField",header:"LNMP date",name:"lmnp date",icon:j.calenderPrimary,required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>"GA by LNMP"!==(null==a?void 0:a["Gestation age to be used"])||e&&""!==e?null:"LNMP date is required",condition:e=>"GA by LNMP"===e["Gestation age to be used"],onChange:(e,a)=>{const t={};if(!e||""===e)return t["Gestation weeks"]="",t["Estimated date of delivery"]="",t;const i=Date.parse(e);if(!isNaN(i)){const e=((new Date).getTime()-i)/864e5,a=Math.floor(e/7);t["Gestation weeks"]=a;const n=new Date(i+24192e6);t["Estimated date of delivery"]=n.toISOString().split("T")[0]}return t}},{componentType:"inputField",header:"Gestation age",name:"Gestation weeks",unit:"Weeks",disabled:!0,grid:{s:"12",md:"3"},condition:e=>"GA by LNMP"===e["Gestation age to be used"]},{componentType:"dateInputField",header:"EDD",name:"Estimated date of delivery",icon:j.calenderPrimary,disabled:!0,grid:{s:"12",md:"3"},condition:e=>"GA by LNMP"===e["Gestation age to be used"]},{componentType:"dateInputField",header:"Date for ultrasound",name:"Ultrasound",icon:j.calenderPrimary,required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>"GA by ultrasound"!==(null==a?void 0:a["Gestation age to be used"])||e&&""!==e?null:"Ultrasound date is required",condition:e=>"GA by ultrasound"===e["Gestation age to be used"]},{componentType:"inputField",header:"Gestation age from ultrasound",name:"specify",icon:j.editPen,unit:"Weeks",required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>{if("GA by ultrasound"===(null==a?void 0:a["Gestation age to be used"])){if(!e||""===e)return"Gestation age from ultrasound is required";const a=Number(e);if(isNaN(a))return"Gestation age must be a number";if(a<0||a>42)return"Gestation age must be between 0 and 42 weeks"}return null},condition:e=>"GA by ultrasound"===e["Gestation age to be used"],onChange:(e,a)=>{const t={};if(!e||""===e)return t["lmnp date"]="",t["Estimated date of delivery from ultrasound"]="",t;const i=parseInt(e);if(!isNaN(i)){const e=new Date,a=new Date(e.getTime()-7*i*24*60*60*1e3);t["lmnp date"]=a.toISOString().split("T")[0];const n=new Date(e.getTime()-7*i*24*60*60*1e3),o=new Date(n.getTime()+24192e6);t["Estimated date of delivery from ultrasound"]=o.toISOString().split("T")[0]}return t}},{componentType:"dateInputField",header:"LMNP date from ultrasound",name:"lmnp date",icon:j.calenderPrimary,grid:{s:"12",md:"6"},condition:e=>"GA by ultrasound"===e["Gestation age to be used"]},{componentType:"dateInputField",header:"EDD from ultrasound",name:"Estimated date of delivery",icon:j.calenderPrimary,grid:{s:"12",md:"6"},condition:e=>"GA by ultrasound"===e["Gestation age to be used"]},{componentType:"inputField",header:"Enter gestation age by palpation (weeks)",name:"Gestation weeks",icon:j.editPen,required:!0,grid:{s:"12",md:"6"},validation:(e,a)=>{if("GA by palpation"===(null==a?void 0:a["Gestation age to be used"])){if(!e||""===e)return"Gestation age by palpation is required";const a=Number(e);if(isNaN(a))return"Gestation age must be a number";if(a<0||a>42)return"Gestation age must be between 0 and 42 weeks"}return null},condition:e=>"GA by palpation"===e["Gestation age to be used"],onChange:(e,a)=>{const t={};if(!e||""===e)return t["date of delivery"]="",t;const i=parseInt(e);if(!isNaN(i)){const e=new Date((new Date).getTime()-7*i*24*60*60*1e3),a=new Date(e.getTime()+24192e6);t["date of delivery"]=a.toISOString().split("T")[0]}return t}},{componentType:"dateInputField",header:"EDD",name:"Estimated date of delivery",icon:j.calenderPrimary,disabled:!0,grid:{s:"12",md:"6"},condition:e=>"GA by palpation"===e["Gestation age to be used"]},{grid:{s:"12"},componentType:"Dashes"}]),tdvSection:t(()=>[{componentType:"radioButtonField",header:"TDV started at what gestation age?",name:"TDV at gestation age",type:"inline",grid:{s:"12"},options:[{label:"None",value:"None"},{label:"4 Weeks",value:"4 weeks"},{label:"6 Months",value:"6 months"},{label:"1 year",value:"1 year"},{label:"> 1 yr",value:"> 1 yr"}]}])},c=n(null),y=n(null),b=n(null),h=n(0),x=W(),{patient:w}=o(x);r(()=>{var e;return null===(e=w.value)||void 0===e?void 0:e.patientID},async(e,a)=>{e&&e!==a&&(h.value++,await s())});const T=async e=>{const a=[];for(const[i,n]of Object.entries(e))if(n&&!1!==n&&""!==n&&!i.startsWith("tt1Date")&&!i.startsWith("tt2Date"))if(Array.isArray(n))for(const e of n){const t="object"==typeof e&&null!==e?e.value||e.name:e;t&&""!==t&&a.push(await J.buildValueText(i,String(t)))}else if("object"==typeof n&&null!==n){const e=n.value||n.name||String(n);e&&""!==e&&a.push(await J.buildValueText(i,String(e)))}else"string"==typeof n||"number"==typeof n?a.push(await J.buildValueText(i,String(n))):"boolean"==typeof n&&!0===n&&a.push(await J.buildValueText("Current pregnancy finding",i));const t=e["The woman received tetanus doses for immunization?"];if("Fully immunised"===t)for(let i=1;i<=5;i++){const t=e[`tt1Date${i}`];t&&""!==t&&a.push(await J.buildValueText("tt1Date",String(t)))}if("Under immunised"===t){const t=e["Number of tetanus doses"];let i=0;"one dose"===t?i=1:"two doses"===t?i=2:"three doses"===t?i=3:"four doses"===t&&(i=4);for(let n=1;n<=i;n++){const t=e[`tt2Date${n}`];t&&""!==t&&a.push(await J.buildValueText("tt2Date",String(t)))}}return a};l(async()=>{await s()});const k=t(()=>i.gestationAgeSection.value),D=t(()=>i.tdvSection.value);return a({validateForm:()=>{var e,a,t;const i=null===(e=c.value)||void 0===e?void 0:e.validateForm(),n=null===(a=b.value)||void 0===a?void 0:a.validate(),o=null===(t=y.value)||void 0===t?void 0:t.validateForm();return i||n||o},onSubmit:async()=>{var e,a,t,i,n,o;const r=null===(e=c.value)||void 0===e?void 0:e.validateForm(),l=null===(a=b.value)||void 0===a?void 0:a.validate(),d=null===(t=y.value)||void 0===t?void 0:t.validateForm();if(r||l||d)return Y(l||"Please fix validation errors before submitting"),!1;const u={...(null===(i=c.value)||void 0===i?void 0:i.getFormValues())||{},...(null===(n=b.value)||void 0===n?void 0:n.getValues())||{},...(null===(o=y.value)||void 0===o?void 0:o.getFormValues())||{}};try{const e=await T(u);return 0===e.length?(Y("No current pregnancy data to save"),!1):(await J.addObsToEncounterPatient(e,K.CURRENT_PREGNANCY),h.value++,await s(),Q("Current pregnancy data saved successfully"),!0)}catch(v){return console.error("Error details:",v),Y((null==v?void 0:v.message)||"Failed to save current pregnancy data"),!1}},getFormValues:()=>{var e,a,t;return{...(null===(e=c.value)||void 0===e?void 0:e.getFormValues())||{},...(null===(a=b.value)||void 0===a?void 0:a.getValues())||{},...(null===(t=y.value)||void 0===t?void 0:t.getFormValues())||{}}},resetForm:()=>{h.value++}}),(e,a)=>(u(),d("div",da,[v(f(_),{class:"section"},{default:p(()=>[v(f(g),null,{default:p(()=>[(u(),m(U,{formData:k.value,ref_key:"gestationFormRef",ref:c,key:h.value},null,8,["formData"])),v(sa,{ref_key:"tetanusRef",ref:b},null,512),(u(),m(U,{formData:D.value,ref_key:"tdvFormRef",ref:y,key:h.value},null,8,["formData"]))]),_:1})]),_:1})]))}}),[["__scopeId","data-v-e88315ec"]]),ca={class:"container"},va=Z(i({__name:"Gynaecology",setup(e,{expose:a}){const i={resetForm:()=>{},gynaecologyFormSection:t(()=>[{componentType:"inputField",header:"Age at menarche",name:"Age at menarche",unit:"Years",icon:j.editPen,required:!0,grid:{s:"12"},validation:e=>{if(!e||""===e)return"Age at menarche is required";const a=Number(e);return isNaN(a)?"Age at menarche must be a number":a<8?"Age at menarche must be at least 8 years":a>20?"Age at menarche cannot exceed 20 years":null}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"inputField",header:"Length of menstrual flow",name:"Length of menstrual flow days",unit:"Days",icon:j.editPen,required:!0,grid:{s:"12",md:"6"},validation:e=>{if(!e||""===e)return"Length of menstrual flow is required";const a=Number(e);return isNaN(a)?"Length of menstrual flow must be a number":a<1?"Length of menstrual flow must be at least 1 day":a>15?"Length of menstrual flow cannot exceed 15 days":null}},{componentType:"inputField",header:"Length of menstrual flow",name:"Length of menstrual flow weeks",icon:j.editPen,unit:"Weeks",required:!1,grid:{s:"12",md:"6"},validation:e=>{if(!e||""===e)return null;const a=Number(e);return isNaN(a)?"Length of menstrual flow must be a number":a<0?"Length of menstrual flow cannot be negative":a>4?"Length of menstrual flow cannot exceed 4 weeks":null}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Regularity of menstrual flow",name:"Regularity of menstrual flow",required:!0,type:"inline",options:[{value:"Regular",label:"Regular"},{value:"Irregular",label:"Irregular"}],grid:{s:"12"},validation:e=>e&&""!==e?null:"Regularity of menstrual flow is required"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Amount of menstrual flow",name:"Amount of menstrual flow",required:!0,type:"inline",options:[{value:"Light",label:"Light"},{value:"Moderate",label:"Moderate"},{value:"Heavy",label:"Heavy"}],grid:{s:"12"},validation:e=>e&&""!==e?null:"Amount of flow is required"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Dysmenorrhea",name:"Dysmenorrhea",required:!0,type:"inline",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},validation:e=>e&&""!==e?null:"Dysmenorrhea is required"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"inputField",header:"Gynaecological surgery",name:"Gynaecological surgery",icon:j.editPen,required:!1,grid:{s:"12"}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"inputField",header:"Other",name:"Other notes",required:!1,grid:{s:"12"},rows:4}])},c=n(null),y=n(0),b=W(),{patient:h}=o(b);r(()=>{var e;return null===(e=h.value)||void 0===e?void 0:e.patientID},async(e,a)=>{e&&e!==a&&(y.value++,await s())});const x=async e=>{const a=[];for(const[t,i]of Object.entries(e))if(i&&!1!==i&&""!==i)if(Array.isArray(i))for(const e of i){const i="object"==typeof e&&null!==e?e.value||e.name:e;i&&""!==i&&a.push(await J.buildValueText(t,String(i)))}else"string"==typeof i||"number"==typeof i?a.push(await J.buildValueText(t,String(i))):"boolean"==typeof i&&!0===i&&a.push(await J.buildValueText("Gynaecological finding",t));return a};l(async()=>{await s()});const w=t(()=>i.gynaecologyFormSection.value);return a({validateForm:()=>{var e;return null===(e=c.value)||void 0===e?void 0:e.validateForm()},onSubmit:async()=>{if(!c.value)return!1;const e=c.value.validateForm();if(e)return Y("Please fix validation errors before submitting"),console.log("Validation errors:",e),!1;const a=c.value.getFormValues();try{const e=await x(a);return 0===e.length?(Y("No gynaecological history data to save"),!1):(await J.addObsToEncounterPatient(e,K.Obstetrics_and_Gynecology),y.value++,await s(),Q("Gynaecological history saved successfully"),!0)}catch(t){return console.error("Error details:",t),Y((null==t?void 0:t.message)||"Failed to save gynaecological history"),!1}},resetForm:()=>{y.value++}}),(e,a)=>(u(),d("div",ca,[v(f(_),{class:"section"},{default:p(()=>[v(f(q),null,{default:p(()=>[v(f(O),null,{default:p(()=>[...a[0]||(a[0]=[F("Gynaecological History",-1)])]),_:1})]),_:1}),v(f(g),null,{default:p(()=>[(u(),m(U,{formData:w.value,ref_key:"formRef",ref:c,key:y.value},null,8,["formData"]))]),_:1})]),_:1})]))}}),[["__scopeId","data-v-7161ce7a"]]),pa={style:{width:"90vw",margin:"0 auto","margin-top":"10px"}},ma={class:"back_profile"};e("default",Z(i({__name:"Profile",setup(e,{expose:a}){const{currentTabIndex:i}=de(),s=z(),d=V(),g=n(!0),y=n(!1),h=n(!1),x=n(null),w=n(null),T=n(null),k=n(null),D=n(null),P=n(null),G=t(()=>({text:h.value?"Saving...":"Finish",icon:h.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:y.value||h.value})),N=W(),F=X(),A=ee(),{patient:S}=o(N),{sessionDate:I}=o(A),{apiStatus:M}=o(ae()),C=e=>{console.log("Done button change received from wizard:",e)},_=()=>{let e=!1;return h.value&&(e=!0),y.value=e,!e},q=n([{title:"Past Obstetric History",icon:""},{title:"Medical History",icon:""},{title:"Current Pregnancy",icon:""},{title:"Gynaecology",icon:""},{title:"Medications",icon:""},{title:"Woman Behaviour",icon:""}]),O=()=>{var e;if(!q.value||0===q.value.length)return null;const a=i.value>=0&&i.value<q.value.length?i.value:0;return{"Past Obstetric History":"PastObstetricHistory","Medical History":"MedicalHistory","Current Pregnancy":"CurrentPregnancy",Gynaecology:"Gynaecology",Medications:"Medications","Woman Behaviour":"WomanBehaviour"}[null===(e=q.value[a])||void 0===e?void 0:e.title]||null},j=e=>{var a;return(null===(a={"Past Obstetric History":x,"Medical History":w,"Current Pregnancy":T,Gynaecology:k,Medications:D,"Woman Behaviour":P}[e])||void 0===a?void 0:a.value)||null},U=async()=>{var e;const a=null===(e=q.value[i.value])||void 0===e?void 0:e.title;if(!a)return!0;const t=j(a);if(!t||!t.validateForm)return!0;try{t.markAllAsTouched&&t.markAllAsTouched();const e=t.validateForm();return!e||(Y("Please fix validation errors before proceeding"),console.log("Validation errors:",e),!1)}catch(n){return console.error("Error during validation:",n),!0}},J=()=>{g.value=!1,setTimeout(()=>{i.value=0,g.value=!0},0)},K=async()=>{const e=ne(I.value,"sessionDate","value")||oe.sessionDate();for(let a=0;a<q.value.length;a++)if("Past Obstetric History"===q.value[a].title){const t=re("pastObstetricHistory");q.value[a].icon=Z(e,t)?R:""}_()},Z=(e,a)=>{const t=new Date(e);return t.setHours(0,0,0,0),null==a?void 0:a.some(e=>{const a=new Date(e.obs_datetime);return a.setHours(0,0,0,0),a.getTime()===t.getTime()})},me=async(e,a)=>{e%1==0&&(i.value=e)},fe=async()=>{h.value=!0;try{const t=[];for(let a=0;a<q.value.length;a++){const i=q.value[a],n=j(i.title);if(null!=n&&n.validateForm){var e;const a=n.validateForm(),o=(null===(e=n.getFormValues)||void 0===e?void 0:e.call(n))||{},r=Object.values(o).some(e=>""!==e&&null!=e&&!(Array.isArray(e)&&0===e.length));t.push({tabTitle:i.title,hasErrors:null!==a,hasData:r})}}const n=t.filter(e=>e.hasData&&e.hasErrors);if(n.length>0){const e=n[0],a=q.value.findIndex(a=>a.title===e.tabTitle);return-1!==a&&(i.value=a),Y(`Please fix validation errors in: ${n.map(e=>e.tabTitle).join(", ")}`),void(h.value=!1)}let o=0;for(let e=0;e<q.value.length;e++){const t=q.value[e],n=j(t.title);if(null!=n&&n.onSubmit)try{await n.onSubmit(),o++}catch(a){return console.error(`Error saving ${t.title}:`,a),Y(`Error saving ${t.title}. Please try again.`),i.value=e,void(h.value=!1)}}await le(S.value),await K(),Q(`Successfully saved ${o} section(s)`),s.push("/quickCheck")}catch(a){console.error("Error in saveAllData:",a),Y("Error occurred while saving data. Please try again.")}finally{h.value=!1}};return l(async()=>{0!==F.NCDActivities.length?(q.value=[{title:"Past Obstetric History",icon:""},{title:"Medical History",icon:""},{title:"Current Pregnancy",icon:""},{title:"Gynaecology",icon:""},{title:"Medications",icon:""},{title:"Woman Behaviour",icon:""}],await K(),(void 0===i.value||i.value<0)&&(i.value=0),y.value=!1,h.value=!1,_()):s.push("patientProfile")}),r(i,async()=>{await _()}),r(S,async()=>{await K()},{deep:!0}),r(I,async()=>{await K()},{deep:!0}),r(d,async()=>{J(),q.value=[{title:"Past Obstetric History",icon:""},{title:"Medical History",icon:""},{title:"Current Pregnancy",icon:""},{title:"Gynaecology",icon:""},{title:"Medications",icon:""},{title:"Woman Behaviour",icon:""}]},{deep:!0}),r(S,async(e,a)=>{a.ID!=e.ID&&J()},{deep:!0}),a({saveAllData:fe,markWizard:K,refreshWizard:J,validateDoneButtonState:_}),(e,a)=>(u(),m(f($),null,{default:p(()=>[v(te),v(f(L),{fullscreen:!0},{default:p(()=>[v(se),c("div",pa,[g.value?(u(),m(ue,{key:0,ref:"wizard",headingTitle:"ANC Profile","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:G.value,"custom-tabs":q.value,beforeChange:U,onChange:me,"onComplete:wizard":a[1]||(a[1]=e=>fe()),onDoneButtonChanged:C},{default:p(()=>[c("div",null,[c("div",ma,[v(ie,{name:"Back to Profile",iconSlot:"start",fill:"clear",icon:f(E),"font-weight":"600",onClick:a[0]||(a[0]=e=>{s.push("/patientProfile")})},null,8,["icon"])])]),B(c("div",null,[v(ye,{ref_key:"pastObstetricHistoryRef",ref:x},null,512)],512),[[H,"PastObstetricHistory"==O()]]),B(c("div",null,[v(ce,{ref_key:"medicalHistoryRef",ref:w},null,512)],512),[[H,"MedicalHistory"==O()]]),B(c("div",null,[v(ua,{ref_key:"currentPregnancyRef",ref:T},null,512)],512),[[H,"CurrentPregnancy"==O()]]),B(c("div",null,[v(va,{ref_key:"gynaecologyRef",ref:k},null,512)],512),[[H,"Gynaecology"==O()]]),B(c("div",null,[v(ve,{ref_key:"medicationsRef",ref:D},null,512)],512),[[H,"Medications"==O()]]),B(c("div",null,[v(pe,{ref_key:"womanBehaviourRef",ref:P},null,512)],512),[[H,"WomanBehaviour"==O()]])]),_:1},8,["doneButton","custom-tabs"])):b("",!0)])]),_:1})]),_:1}))}}),[["__scopeId","data-v-7e500135"]]))}}});
