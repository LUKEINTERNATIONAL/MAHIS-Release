var T=Object.defineProperty;var M=(o,a,s)=>a in o?T(o,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[a]=s;var P=(o,a,s)=>M(o,typeof a!="symbol"?a+"":a,s);import{bh as R,d as y,r as h,w as b,e as g,f as A,l as p,u as C,c as D,L as z,bq as U,aF as q,G as B,Q as W,H as x}from"./vendor-CJ2tyHrn.js";import{u as N,ab as j,G as L,am as Q,x as O,aY as Y,C as w,_ as v,T as J,t as K}from"../index-CPIhguZJ.js";import{D as X}from"./DemographicBar-CMCjh8ca.js";import{n as i,N as Z}from"./NeonatalStepper-BvXO5k96.js";import{u as f}from"./useNeonatalExamStore-BRNxlQFe.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BtvCa6MI.js";import"./SaveProgressModal-Bs8SOcXY.js";import"./enrollment-DU-PLRUa.js";import"./images-142qstiX.js";class ee extends Y{constructor(a,s){super(a,117,s)}}class se extends Y{constructor(s,n){super(s,117,n);P(this,"physical_examination_service");P(this,"childObservation",async s=>await this.physical_examination_service.buildValueCoded(s,s));P(this,"computeParentObservation",async s=>({tag:s,obs:await this.physical_examination_service.buildValueCoded(s,s)}));P(this,"buildValueText",async(s,n)=>await this.physical_examination_service.buildValueText(s,n));this.physical_examination_service=new ee(s,n)}async ensureEncounterExists(){if(this.encounterID)return;const s=await this.physical_examination_service.createEncounter();if(!s)throw new Error("Failed to create encounter");if(this.encounterID=s.encounter_id,s.patient_id!==this.patientID)throw new Error("Encounter created for the wrong patient! Context inconsistency detected.")}async onSubmit(s){await this.ensureEncounterExists(),this.saveObservationList(s)}}const _=async(o,a,s,n)=>{if(!s){const m="".concat(n," is required");throw O(m),new Error(m)}const t=await o.computeParentObservation(a),r={["".concat(a.replace(/\s/g,"").toLowerCase(),"Observation")]:t},e=await o.childObservation(s);if(!e){const m="".concat(n," observations are required");throw new Error(m)}const l=Object.keys(r)[0];return r[l].obs.child=[e],r},ae=async o=>{try{const a=f(),s=await _(o,"Activity",a.activityAssessment,"Activity Assessment");await o.onSubmit([s.activityObservation.obs]),a.setActivityAssessment(null)}catch(a){throw a}},te=async o=>{try{const a=f(),s=await _(o,"Fontanelle",a.fontanelleAssessment,"Fontanelle Assessment");await o.onSubmit([s.fontanelleObservation.obs]),a.setFontanelleAssessment(null);const n=await _(o,"Head",a.massInHeadAssessment,"Mass in Head Assessment");await o.onSubmit([n.headObservation.obs]),a.setMassInHeadAssessment(null);const r={colorObservation:await o.computeParentObservation("Colour")};if(r.colorObservation.obs.child=[],a.isBabyYellow!==null&&a.isBabyYellow){const e=await o.childObservation("Yell");r.colorObservation.obs.child.push(e)}if(a.isBabyPallorPink!==null&&a.isBabyPallorPink){const e=await o.childObservation("Pink");r.colorObservation.obs.child.push(e)}if(a.hasBabyCyanosis!==null&&a.hasBabyCyanosis){const e=await o.childObservation("Blue");r.colorObservation.obs.child.push(e)}if(a.hasBabyOedema!==null&&a.hasBabyOedema){const e=await o.childObservation("White");r.colorObservation.obs.child.push(e)}await o.onSubmit([r.colorObservation.obs]),a.setIsBabyYellow(null),a.setIsBabyPallorPink(null),a.setHasBabyCyanosis(null),a.setHasBabyOedema(null)}catch(a){throw a}},oe=async o=>{try{const a=f(),s=await _(o,"Femorals",a.femoralPulses,"Femoral Pulses assessment");await o.onSubmit([s.femoralsObservation.obs]),a.setFemoralPulses(null)}catch(a){throw a}},ne=async o=>{try{const a=f(),s=await _(o,"Anus2",a.anusAssessment,"Anus assessment");await o.onSubmit([s.anus2Observation.obs]),a.setAnusAssessment(null);const n=await _(o,"Genitalia",a.genitaliaAssessment,"Genitalia assessment");await o.onSubmit([n.genitaliaObservation.obs]),a.setGenitaliaAssessment(null)}catch(a){throw a}},le=async o=>{try{const a=f(),s=await _(o,"Palate",a.cleftAssessment,"Cleft Lip/Palate assessment");await o.onSubmit([s.palateObservation.obs]),a.setCleftAssessment(null)}catch(a){throw a}},re=async o=>{try{const a=f(),n={congenitalAbnormalitiesObservation:await o.computeParentObservation("Other congenital abnormality")};if(n.congenitalAbnormalitiesObservation.obs.child=[],a.hasCongenitalAbnormalities!==null){let t=a.hasCongenitalAbnormalities?"Yes":"No";const r=await o.childObservation(t);n.congenitalAbnormalitiesObservation.obs.child.push(r)}if(a.abnormalitiesNotes!==""){const t=await o.buildValueText("Notes",a.abnormalitiesNotes);n.congenitalAbnormalitiesObservation.obs.child.push(t)}await o.onSubmit([n.congenitalAbnormalitiesObservation.obs]),a.setHasCongenitalAbnormalities(null),a.setAbnormalitiesNotes("")}catch(a){throw a}},ie=async()=>{try{const o=N(),{patient:a}=R(o),s=j(),n=new se(a.value.patientID,s.user_ID);await Promise.all([ae(n),te(n),oe(n),ne(n),le(n),re(n)]),console.log("SUCCESS: All General Examination sections saved successfully!"),L("General Examination saved successfully"),Q.push({path:"/neonatal/checkpoint"})}catch(o){throw console.error("FAILED to save General Examination:",o),O("Failed to save General Examination. Please try again."),o}},me={class:"activity-assessment-wrapper"},ce=y({__name:"ActivityAssessmentForm",setup(o,{expose:a}){const s=h(null),n=i[0].formData,t=f(),r=e=>{t.setActivityAssessment(e!=null?e:null)};return b(()=>{var e,l,m;return(m=(l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))==null?void 0:m.activityAssessment},e=>{r(e)},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",me,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),V=v(ce,[["__scopeId","data-v-ac0b0041"]]),ue={class:"head-assessment-wrapper"},de=y({__name:"HeadAssessmentForm",setup(o,{expose:a}){const s=h(null),n=i[1].formData,t=f(),r=e=>{e.fontanelleAssessment&&t.setFontanelleAssessment(e.fontanelleAssessment),e.massInHeadAssessment&&t.setMassInHeadAssessment(e.massInHeadAssessment),e.isBabyYellow!==void 0&&t.setIsBabyYellow(e.isBabyYellow==="yes"?!0:e.isBabyYellow==="no"?!1:null),e.isBabyPallorPink!==void 0&&t.setIsBabyPallorPink(e.isBabyPallorPink==="yes"?!0:e.isBabyPallorPink==="no"?!1:null),e.hasBabyCyanosis!==void 0&&t.setHasBabyCyanosis(e.hasBabyCyanosis==="yes"?!0:e.hasBabyCyanosis==="no"?!1:null),e.hasBabyOedema!==void 0&&t.setHasBabyOedema(e.hasBabyOedema==="yes"?!0:e.hasBabyOedema==="no"?!1:null)};return b(()=>{var e;return(e=s.value)==null?void 0:e.formValues},e=>{e&&r(e)},{deep:!0}),b(()=>s.value,e=>{e!=null&&e.getFormValues&&r(e.getFormValues())},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",ue,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),E=v(de,[["__scopeId","data-v-4aef5988"]]),fe={class:"cardiovascular-assessment-wrapper"},be=y({__name:"CardiovascularAssessmentForm",setup(o,{expose:a}){const s=h(null),n=i[2].formData,t=f(),r=e=>{e.heartSoundsAssessment&&t.setHeartSoundsAssessment(e.heartSoundsAssessment),e.femoralPulses&&t.setFemoralPulses(e.femoralPulses),e.hasCardiacAbnormality!==void 0&&t.setHasCardiacAbnormality(e.hasCardiacAbnormality==="yes"?!0:e.hasCardiacAbnormality==="no"?!1:null)};return b(()=>{var e;return(e=s.value)==null?void 0:e.formValues},e=>{e&&r(e)},{deep:!0}),b(()=>s.value,e=>{e!=null&&e.getFormValues&&r(e.getFormValues())},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",fe,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),k=v(be,[["__scopeId","data-v-4929920c"]]),pe={class:"genital-anus-assessment-wrapper"},he=y({__name:"GenitalAndAnusAssessmentForm",setup(o,{expose:a}){const s=h(null),n=i[3].formData,t=f(),r=e=>{e.genitaliaAssessment&&t.setGenitaliaAssessment(e.genitaliaAssessment),e.anusPatent&&t.setAnusAssessment(e.anusPatent),e.hasMeconiumPassed!==void 0&&t.setHasMeconiumPassed(e.hasMeconiumPassed==="yes"?!0:e.hasMeconiumPassed==="no"?!1:null)};return b(()=>{var e;return(e=s.value)==null?void 0:e.formValues},e=>{e&&r(e)},{deep:!0}),b(()=>s.value,e=>{e!=null&&e.getFormValues&&r(e.getFormValues())},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",pe,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),I=v(he,[["__scopeId","data-v-94b28256"]]),ye={class:"cleft-lip-palate-wrapper"},Ae=y({__name:"CleftLipPalateForm",setup(o,{expose:a}){const s=h(null),n=i[4].formData,t=f(),r=e=>{if(!e){t.setHasCleftLip(null),t.setHasCleftPalate(null),t.setCleftAssessment(null);return}const l=e==="cleft_lip"||e==="cleft_lip_and_palate",m=e==="cleft_palate"||e==="cleft_lip_and_palate";t.setHasCleftLip(l),t.setHasCleftPalate(m),t.setCleftAssessment(l||m?"present":"absent")};return b(()=>{var e,l,m;return(m=(l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))==null?void 0:m.cleftLipPalateAssessment},e=>{console.log("selection: ",e),r(e!=null?e:null)},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",ye,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),H=v(Ae,[["__scopeId","data-v-5d6bdac9"]]),ve={class:"congenital-abnormalities-wrapper"},_e=y({__name:"CongenitalAbnormalitiesForm",setup(o,{expose:a}){const s=h(null),n=i[5].formData,t=f(),r=e=>{e.hasCongenitalAbnormalities!==void 0&&t.setHasCongenitalAbnormalities(e.hasCongenitalAbnormalities==="yes"?!0:e.hasCongenitalAbnormalities==="no"?!1:null),e.congenitalAbnormalitiesDescription&&t.setAbnormalitiesNotes(e.congenitalAbnormalitiesDescription)};return b(()=>{var e;return(e=s.value)==null?void 0:e.formValues},e=>{e&&r(e)},{deep:!0}),b(()=>s.value,e=>{e!=null&&e.getFormValues&&r(e.getFormValues())},{immediate:!0}),a({validateForm:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=s.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(A(),g("div",ve,[p(w,{formData:C(n),ref_key:"formRef",ref:s},null,8,["formData"])]))}}),G=v(_e,[["__scopeId","data-v-83d289a0"]]),ge={class:"general-examination-summary-wrapper"},we=y({__name:"GeneralExaminationSummary",setup(o,{expose:a}){const s=h(null),n=i[6].formData,t=f(),r=D(()=>({activityAssessment:t.activityAssessment,fontanelleAssessment:t.fontanelleAssessment,massInHeadAssessment:t.massInHeadAssessment,isBabyYellow:t.isBabyYellow?"yes":t.isBabyYellow===!1?"no":void 0,isBabyPallorPink:t.isBabyPallorPink?"yes":t.isBabyPallorPink===!1?"no":void 0,hasBabyCyanosis:t.hasBabyCyanosis?"yes":t.hasBabyCyanosis===!1?"no":void 0,hasBabyOedema:t.hasBabyOedema?"yes":t.hasBabyOedema===!1?"no":void 0,heartSoundsAssessment:t.heartSoundsAssessment,femoralPulses:t.femoralPulses,hasCardiacAbnormality:t.hasCardiacAbnormality?"yes":t.hasCardiacAbnormality===!1?"no":void 0,genitaliaAssessment:t.genitaliaAssessment,anusPatent:t.anusAssessment,hasMeconiumPassed:t.hasMeconiumPassed?"yes":t.hasMeconiumPassed===!1?"no":void 0,hasCleftLip:t.hasCleftLip?"yes":t.hasCleftLip===!1?"no":void 0,hasCleftPalate:t.hasCleftPalate?"yes":t.hasCleftPalate===!1?"no":void 0,hasCongenitalAbnormalities:t.hasCongenitalAbnormalities?"yes":t.hasCongenitalAbnormalities===!1?"no":void 0,congenitalAbnormalitiesDescription:t.abnormalitiesNotes})),e=n.find(d=>d.componentType==="summaryField"),l=D(()=>e!=null&&e.builder?e.builder(r.value):[]),m=D(()=>n.map(d=>d.componentType==="summaryField"?{...d,builder:void 0,summaryRows:l.value}:d));return a({validateForm:()=>null,getFormValues:()=>{var d,F;return((F=(d=s.value)==null?void 0:d.getFormValues)==null?void 0:F.call(d))||{}}}),(d,F)=>(A(),g("div",ge,[p(w,{formData:m.value,ref_key:"formRef",ref:s},null,8,["formData"])]))}}),$=v(we,[["__scopeId","data-v-7475ebc7"]]),Ce=y({name:"NeonatalGeneralExamination",components:{IonPage:U,IonContent:z,Toolbar:J,DemographicBar:X,NeonatalStepper:Z,ActivityAssessmentForm:V,HeadAssessmentForm:E,CardiovascularAssessmentForm:k,GenitalAndAnusAssessmentForm:I,CleftLipPalateForm:H,CongenitalAbnormalitiesForm:G,GeneralExaminationSummary:$},setup(){const o=q(),a=N(),{patient:s}=R(a),n=f(),t=h(!1),r=c=>c==null?null:String(c),e=()=>{var u;const c=r((u=s.value)==null?void 0:u.patientID);c&&n.setCurrentPatientID(c)};e(),b(()=>{var c;return(c=s.value)==null?void 0:c.patientID},()=>e());const l=h(i.map((c,u)=>({title:c.title,number:u+1,checked:!1,class:u===0?"open_step common_step":"common_step",last_step:u===i.length-1?"last_step":""}))),m=[{title:i[0].title,subtitle:i[0].subtitle||"",value:"1",component:V},{title:i[1].title,subtitle:i[1].subtitle||"",value:"2",component:E},{title:i[2].title,subtitle:i[2].subtitle||"",value:"3",component:k},{title:i[3].title,subtitle:i[3].subtitle||"",value:"4",component:I},{title:i[4].title,subtitle:i[4].subtitle||"",value:"5",component:H},{title:i[5].title,subtitle:i[5].subtitle||"",value:"6",component:G},{title:i[6].title,subtitle:i[6].subtitle||"",value:"7",component:$}];return{router:o,patient:s,stepperTitle:"General Examination",currentOpenStepper:"1",wizardData:l,stepperData:m,updateStatus:c=>{c&&c.value&&l.value.forEach((u,S)=>{c.value===(S+1).toString()?(u.class="open_step common_step",u.checked=!1):S<parseInt(c.value)-1?(u.class="common_step color_white",u.checked=!0):(u.class="common_step",u.checked=!1)})},getSaveFunction:c=>c===m.length-1?async()=>{var u;if(!((u=s.value)!=null&&u.patientID)){K("No patient selected");return}if(!t.value)try{console.log("[GeneralExamination] finish clicked, saving exam"),console.log("[GeneralExamination] store payload",{activityAssessment:n.activityAssessment,fontanelleAssessment:n.fontanelleAssessment,massInHeadAssessment:n.massInHeadAssessment,isBabyYellow:n.isBabyYellow,isBabyPallorPink:n.isBabyPallorPink,hasBabyCyanosis:n.hasBabyCyanosis,hasBabyOedema:n.hasBabyOedema,heartSoundsAssessment:n.heartSoundsAssessment,femoralPulses:n.femoralPulses,hasCardiacAbnormality:n.hasCardiacAbnormality,genitaliaAssessment:n.genitaliaAssessment,anusAssessment:n.anusAssessment,hasMeconiumPassed:n.hasMeconiumPassed,cleftAssessment:n.cleftAssessment,hasCleftLip:n.hasCleftLip,hasCleftPalate:n.hasCleftPalate,hasCongenitalAbnormalities:n.hasCongenitalAbnormalities,abnormalitiesNotes:n.abnormalitiesNotes}),t.value=!0,await ie(),L("General examination saved successfully"),o.push({path:"/neonatal/checkpoint"}),n.resetExamData()}catch(S){console.error("General examination save failed",S),O("Failed to save general examination. Please try again."),t.value=!1}}:null,isSaving:t}}});function Pe(o,a,s,n,t,r){const e=B("Toolbar"),l=B("NeonatalStepper"),m=B("ion-content"),d=B("ion-page");return A(),W(d,{class:"neonatal-general-examination-page"},{default:x(()=>[p(e),p(m,{fullscreen:!0},{default:x(()=>[p(l,{wizardData:o.wizardData,StepperData:o.stepperData,stepperTitle:o.stepperTitle,openStepper:o.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:o.getSaveFunction,flowType:"general-examination",onUpdateStatus:o.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const Ge=v(Ce,[["render",Pe],["__scopeId","data-v-dff41fbe"]]);export{Ge as default};
