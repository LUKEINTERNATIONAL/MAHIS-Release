import{d as te,au as Qe,r as S,c as ee,e as V,f as b,bD as Pe,p as re,br as Ze,k as n,l as t,F as ce,P as pe,V as et,J as a,u as e,a5 as q,L as fe,W as K,K as T,a4 as Q,H as ue,Q as c,R as Ye,a as he,aV as xe,O as j,m as Z,bc as _e,N as z,aZ as tt,bB as Ne,_ as A,cY as st,bi as Ee,I as Ae,G as Le,E as Ue,a_ as We,a3 as qe,M as at,an as nt,w as ze,cX as lt,dQ as ot,al as it,ak as ie,aj as rt,ds as me,b5 as ut}from"./vendor-v_5UaDDk.js";import{l as dt}from"./lodash-NJiRuGo9.js";import{_ as se,aB as G,aC as de,l as we,H as ae,S as le,af as Ke,aW as je,G as ye,u as be,t as ge,aQ as ve,bm as ne,m as J,O as Je,J as ct,j as pt,P as vt}from"../index-C8cssZLO.js";import{N as mt}from"./vaccines_service-l7-BzYVC.js";import{u as ft}from"./usePatientProfile-CFdpfGI0.js";import _t from"./WeightHeightChart-CPc9Ut_t.js";import{O as yt,w as gt}from"./weightAndHeight-hxQNhNHF.js";import"./apexcharts-Cw3il1Pz.js";import"./sms_service-vgS-MfbT.js";import"./EIRreportsStore-3CMlodgg.js";import"./Export-ef-tEK24.js";import"./Registration-D8LQT031.js";import"./useLocation-PsgOAJGJ.js";import"./NeonatalEnrollmentStore-Dtu2d1u6.js";import"./chartjs-L44WAfwS.js";import"./BasicForm-hEu39l0Y.js";import"./DateInputField-BE5UH0_q.js";import"./customDatePicker-CR-0vWV3.js";import"./VitalsMixin.vue_vue_type_script_lang-GSU5yxbx.js";import"./formatServerData-BaQE7XEY.js";const ht=["onKeydown"],xt={class:"ripple-container"},wt=["onAnimationend"],bt={class:"status-badge"},Tt={class:"ion-text-wrap"},kt=te({__name:"ReferralCard",props:{icon:{type:String,default:Qe},status:{type:String,default:"Referred OPD"},title:{type:String,required:!0},type:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},emits:["pressed","click"],setup(O,{emit:g}){const w=O,$=g,y=S(!1),v=S(null),f=S([]);let m=0;const E=ee(()=>{if(w.disabled)return"timeline-item-disabled";switch(w.type){case"hiv":return"timeline-item-hiv";case"hepatitis":return"timeline-item-hepatitis";default:return"timeline-item-default"}}),L=ee(()=>{if(w.disabled)return"icon-container-disabled";switch(w.type){case"hiv":return"icon-container-hiv";case"hepatitis":return"icon-container-hepatitis";default:return"icon-container-default"}}),B=l=>{if(w.disabled||!v.value)return;const p=v.value.getBoundingClientRect(),h=Math.max(p.width,p.height)*2;let U,W;if(l.type==="keydown")U=p.width/2-h/2,W=p.height/2-h/2;else{const i=l.type.includes("touch")?l.touches[0].clientX:l.clientX,u=l.type.includes("touch")?l.touches[0].clientY:l.clientY;U=i-p.left-h/2,W=u-p.top-h/2}const d={id:m++,x:U,y:W,size:h,duration:600};f.value.push(d)},x=l=>{const p=f.value.findIndex(h=>h.id===l);p>-1&&f.value.splice(p,1)},k=l=>{w.disabled||(B(l),$("pressed",{type:w.type,title:w.title,status:w.status,event:l}),$("click",l))},F=l=>{w.disabled||(y.value=!0,B(l))},D=()=>{y.value=!1},M=()=>{y.value=!1},o=l=>{w.disabled||(y.value=!0,B(l))},C=()=>{y.value=!1};return(l,p)=>(b(),V("div",{class:re(["timeline-item",E.value,{"timeline-item-pressed":y.value}]),onClick:k,onMousedown:F,onMouseup:D,onMouseleave:M,onTouchstart:o,onTouchend:C,role:"button",tabindex:"0",onKeydown:[Pe(k,["enter"]),Pe(Ze(k,["prevent"]),["space"])],ref_key:"timelineElement",ref:v},[n("div",xt,[(b(!0),V(ce,null,pe(f.value,h=>(b(),V("div",{key:h.id,class:"ripple",style:et({left:h.x+"px",top:h.y+"px",width:h.size+"px",height:h.size+"px",animationDuration:h.duration+"ms"}),onAnimationend:U=>x(h.id)},null,44,wt))),128))]),t(e(Q),null,{default:a(()=>[t(e(q),{class:"ion-text-center"},{default:a(()=>[n("div",null,[t(e(fe),{class:re(["icon-container",L.value]),icon:O.icon,"aria-hidden":"true"},null,8,["class","icon"])])]),_:1}),t(e(q),{class:"ion-text-center"},{default:a(()=>[t(e(K),null,{default:a(()=>[n("span",bt,T(O.status),1)]),_:1})]),_:1}),t(e(q),{class:"ion-text-center"},{default:a(()=>[t(e(K),null,{default:a(()=>[n("h2",Tt,T(O.title),1)]),_:1})]),_:1})]),_:1})],42,ht))}}),Ct=se(kt,[["__scopeId","data-v-897e90a9"]]),It={style:{"padding-left":"10px","padding-right":"10px"}},Rt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},St=te({__name:"RiskCategoryFollowUpModal",setup(O){const g=S(null),w=ee(()=>[{componentType:"multiSelectInputField",header:"Risk Category",name:"risk_category",trackBy:"id",validation:G.required,options:[{id:"1",name:"Sex worker"},{id:"2",name:"MSM"},{id:"3",name:"AGYW"},{id:"4",name:"Client of sex workers"},{id:"5",name:"Female sex workers"},{id:"6",name:"Risk age group"},{id:"7",name:"None"}]}]),$=async()=>{var v,f;const y=(v=g.value)==null?void 0:v.getFormValues();console.log("ðŸš€ ~ save ~ result:",y),await Ye.dismiss((f=y==null?void 0:y.risk_category)==null?void 0:f.name)};return(y,v)=>{const f=ue("ion-button");return b(),V("div",It,[v[3]||(v[3]=n("div",{class:"content"},[n("h4",null,"Risk Category & Follow-up")],-1)),n("div",null,[t(de,{formData:w.value,ref_key:"formRef",ref:g},null,8,["formData"])]),n("div",Rt,[t(f,{color:"danger"},{default:a(()=>[...v[1]||(v[1]=[c("Cancel",-1)])]),_:1}),t(f,{onClick:v[0]||(v[0]=m=>$())},{default:a(()=>[...v[2]||(v[2]=[c("Save",-1)])]),_:1})])])}}}),$t=se(St,[["__scopeId","data-v-fdbc4375"]]),Ft={style:{"padding-left":"10px","padding-right":"10px"}},Dt={class:"content"},Ht={style:{"margin-top":"10px"}},Vt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Mt=te({__name:"OutcomeSummaryModal",setup(O){const g=S(""),w=async()=>{g.value=ae.toStandardHisDisplayFormat(await le.getApiDate())},$=S(null),y=[{header:"Outcome Summary",componentType:"textAreaField",name:"Outcome",icon:we.editPen,obsValueType:"value_text"},{componentType:"radioButtonField",header:"Is new positive?",name:"New Positive",obsValueType:"value_text",validation:G.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"radioButtonField",header:"Refer patient to ART clinic?",name:"ART referral",obsValueType:"value_text",validation:G.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]}],v=async()=>{var m;const f=(m=$.value)==null?void 0:m.getFormValues();await Ke.buildSaveObs(f,je.PATIENT_OUTCOME),await Ye.dismiss(),ye("Outcome summary saved successfully.")};return he(async()=>{await w()}),(f,m)=>{const E=ue("ion-button");return b(),V("div",Ft,[n("div",Dt,[m[2]||(m[2]=n("h4",null,"Patient Outcome",-1)),n("div",null,[m[1]||(m[1]=n("span",null,"Todays Date : ",-1)),n("span",null,T(g.value),1)])]),n("div",Ht,[t(de,{formData:y,ref_key:"formRef",ref:$},null,512)]),n("div",Vt,[t(E,{onClick:m[0]||(m[0]=L=>v())},{default:a(()=>[...m[3]||(m[3]=[c("Complete",-1)])]),_:1})])])}}}),Ot=se(Mt,[["__scopeId","data-v-a869c649"]]),Bt={style:{"padding-left":"10px","padding-right":"10px"}},Pt={class:"content"},Nt={style:{"text-align":"center",padding:"15px"}},Et={style:{display:"flex","justify-content":"space-between",padding:"10px"}},At=te({__name:"HIVTestingModal",props:{order:{}},setup(O){const g=S(null),w=be(),{patient:$}=xe(w),y=S([]),v=S(""),f=S(""),m=S(""),E=O,L=ee(()=>[{componentType:"radioButtonField",header:"Test Type",name:"test_type",obsValueType:"value_text",type:"inline",validation:G.required,onChange:d=>{x()},options:[{label:"Detremin",value:"Detremin"},{label:"Unigold",value:"Unigold"},{label:"Bioline",value:"Bioline"}]},{componentType:"inputField",header:"Test Kit Serial Number",name:"test_kit_serial_number",obsValueType:"value_text",icon:we.scanner,onChange:d=>{x()},validation:G.required},{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:G.required,type:"inline",onChange:d=>{x()},options:[{label:"Reactive",value:"Reactive"},{label:"Non reactive",value:"Non reactive"}]}]),B=()=>le.getSessionDate(),x=()=>{var I;const d=(I=g.value)==null?void 0:I.getFormValues();if(!(d!=null&&d.test_results)){f.value="",m.value="";return}const i=d.test_type,u=d.test_results;i==="Detremin"?u==="Non reactive"?(f.value="risk_category",m.value="Continue to Risk Category"):u==="Reactive"&&(f.value="unigold",m.value="Continue to Unigold"):i==="Unigold"?u==="Non reactive"?(f.value="repeat_determine",m.value="Repeat Determine Test"):u==="Reactive"&&(f.value="bioline",m.value="Continue to Bioline"):i==="Bioline"&&(u==="Non reactive"?(f.value="inconclusive",m.value="Schedule Inconclusive Follow-up"):u==="Reactive"&&(f.value="Outcome summary",m.value="Continue to Summary"))},k=async()=>{var H,r;if(((H=g.value)==null?void 0:H.validateForm())!=null){ge("Please fill in all required fields");return}const d=(r=g.value)==null?void 0:r.getFormValues(),i=d.test_type;y.value.push({type:i,result:d.test_results});let u=E.order,I="";const P=await ve.getConceptID(u.value_text,!0);u!=null&&u.new_order&&(I=await W(P,u.value_text,"Blood"));const R=await ne.buildResults([{name:"HIV test",concept_id:P,value:"".concat(i,"-").concat(d.test_results)}]);await ne.saveResults($.value,R,u.order_obs_id,I,v.value),C(i,d.test_results)?await l(i,d.test_results):ye("Test result saved")},F=async()=>{var d,i,u,I,P,R,H;if(((d=g.value)==null?void 0:d.validateForm())!=null){ge("Please fill in all required fields");return}switch(await k(),f.value){case"risk_category":await o();const r=await J($t,{class:"mediumAutoHeightModal"});r=="None"?await D():r&&(await M(),await D());break;case"unigold":(i=g.value)==null||i.resetForm(),(u=g.value)==null||u.setFormValue("test_type","Unigold");break;case"repeat_determine":(I=g.value)==null||I.resetForm(),(P=g.value)==null||P.setFormValue("test_type","Detremin");break;case"bioline":(R=g.value)==null||R.resetForm(),(H=g.value)==null||H.setFormValue("test_type","Bioline"),x();break;case"inconclusive":await h();break;case"Outcome summary":await D();break}},D=async()=>{await o(),await J(Ot,{class:"mediumAutoHeightModal"})},M=async()=>(await o(),await J(mt,{class:"mediumAutoHeightModal"})),o=async()=>{await _e.getTop()&&await _e.dismiss()},C=(d,i)=>d==="Detremin"&&i==="Non reactive"?!1:[...y.value].length>=3,l=async(d,i)=>{const u=y.value,I=u.find(H=>H.type==="Detremin"),P=u.find(H=>H.type==="Unigold"),R=u.find(H=>H.type==="Bioline");(I==null?void 0:I.result)==="Reactive"&&(P==null?void 0:P.result)==="Reactive"&&(R==null?void 0:R.result)==="Reactive"?await p():(R==null?void 0:R.result)==="Non reactive"&&await h()},p=async()=>{await o(),ye("Positive result confirmed. Proceeding to ART enrollment.")},h=async()=>{await M(),await D()},U=async()=>{var d;try{const i=await ne.getLabResults($.value);if((d=i==null?void 0:i.latestTest)!=null&&d.value){const I=i.latestTest.value.split("-");I.length===2&&(y.value=[{type:I[0],result:I[1]}])}}catch(i){console.error("Error loading previous tests:",i)}},W=async(d,i,u)=>{var H,r,s,Y,X,oe;const I=[{concept_id:d,name:i,specimen:u,reason:"Routine",specimenConcept:await ve.getConceptID(u,!0)}],P=await Je.buildLabOrders("",I,v.value),R=JSON.parse(JSON.stringify($.value));return(s=(r=(H=R.labOrders)!=null?H:R.labOrders={}).unsaved)!=null||(r.unsaved=[]),(oe=(X=(Y=R.labOrders)!=null?Y:R.labOrders={}).saved)!=null||(X.saved=[]),R.labOrders.unsaved.push(...P),$.value=R,P[0].offline_id};return he(async()=>{var d;v.value=(d=E.order)==null?void 0:d.past_date,await U(),x()}),(d,i)=>{const u=ue("ion-button");return b(),V("div",Bt,[n("div",Pt,[i[3]||(i[3]=n("h4",null,"HIV Testing",-1)),n("div",null,[i[2]||(i[2]=n("span",null,"Todays Date : ",-1)),n("span",null,T(B()),1)])]),n("div",null,[t(de,{formData:L.value,ref_key:"formRef",ref:g},null,8,["formData"])]),n("div",Nt,[i[4]||(i[4]=n("span",null,"Reported by: ",-1)),n("span",null,T(e(le).getUserName()),1)]),n("div",Et,[t(u,{onClick:i[0]||(i[0]=I=>k())},{default:a(()=>[...i[5]||(i[5]=[c("Complete",-1)])]),_:1}),f.value?(b(),j(u,{key:0,onClick:i[1]||(i[1]=I=>F())},{default:a(()=>[c(T(m.value),1)]),_:1})):Z("",!0)])])}}}),Ge=se(At,[["__scopeId","data-v-6a7ec868"]]),Lt={style:{"padding-left":"10px","padding-right":"10px"}},Ut={class:"content"},Wt={style:{"text-align":"center",padding:"15px"}},qt={style:{display:"flex","justify-content":"center",padding:"10px"}},zt=te({__name:"HepatitisModal",props:{order:{}},setup(O){const g=S(null);let w=S({});const $=be(),{patient:y}=xe($),v=S(""),f=O,m=ee(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:G.required,type:"inline",options:[{label:"Positive",value:"Positive"},{label:"Negative",value:"Negative"},{label:"Inconclusive",value:"Inconclusive"}]}]),E=()=>le.getSessionDate(),L=async()=>{var M,o;if(((M=g.value)==null?void 0:M.validateForm())!=null){ge("Please fill in all required fields");return}let x=f.order;v.value=x.past_date;let k="";const F=await ve.getConceptID(x.value_text,!0);w.value=(o=g.value)==null?void 0:o.getFormValues(),x!=null&&x.new_order&&(k=await B(F,x.value_text,"Blood"));const D=await ne.buildResults([{name:x.value_text,concept_id:F,value:w.value.test_results}]);await ne.saveResults(y.value,D,x.order_obs_id,k,v.value),await _e.dismiss()},B=async(x,k,F)=>{var C,l,p,h,U,W;const D=[{concept_id:x,name:k,specimen:F,reason:"Routine",specimenConcept:await ve.getConceptID(F,!0)}],M=await Je.buildLabOrders("",D,v.value),o=JSON.parse(JSON.stringify(y.value));return(p=(l=(C=o.labOrders)!=null?C:o.labOrders={}).unsaved)!=null||(l.unsaved=[]),(W=(U=(h=o.labOrders)!=null?h:o.labOrders={}).saved)!=null||(U.saved=[]),o.labOrders.unsaved.push(...M),y.value=o,M[0].offline_id};return(x,k)=>{const F=ue("ion-button");return b(),V("div",Lt,[n("div",Ut,[n("h4",null,T(O.order.value_text)+" Testing",1),n("div",null,[k[1]||(k[1]=n("span",null,"Todays Date : ",-1)),n("span",null,T(E()),1)])]),n("div",null,[t(de,{formData:m.value,ref_key:"formRef",ref:g},null,8,["formData"])]),n("div",Wt,[k[2]||(k[2]=n("span",null,"Reported by: ",-1)),n("span",null,T(e(le).getUserName()),1)]),n("div",qt,[t(F,{onClick:k[0]||(k[0]=D=>L())},{default:a(()=>[...k[3]||(k[3]=[c("Complete",-1)])]),_:1})])])}}}),Xe=se(zt,[["__scopeId","data-v-8a252bcf"]]),Yt={class:"past-test-results"},Kt={class:"header"},jt={class:"test-results-list"},Jt={class:"test-info"},Gt={class:"test-name"},Xt={class:"test-date"},Qt={class:"add-results-section"},Zt={class:"modal-test-results-list"},es={class:"test-info"},ts={class:"test-name"},ss={class:"test-date"},as=te({__name:"PastTestResults",props:{results:{default:()=>[]}},emits:["seeFullHistory","enterKnownResults"],setup(O,{emit:g}){const w=O,$=g,y=S(!1),v=S(!1),f=S(null),m=ee(()=>w.results||[]),E=ee(()=>m.value.slice(0,3)),L=ee(()=>[{componentType:"radioButtonField",header:"Select test",name:"test",obsValueType:"value_text",validation:G.required,type:"standard",options:[{label:"Hepatitis B Test",value:"Hepatitis B Test"},{label:"Hepatitis C Test",value:"Hepatitis C Test"},{label:"HIV test",value:"HIV test"},{label:"Syphilis",value:"Syphilis"}]},{componentType:"dateInputField",header:"Past Date",name:"past_date",validation:G.required}]),B=C=>{const l=C.toLowerCase();return l.includes("reactive")&&!l.includes("non reactive")?"reactive":l.includes("non reactive")||l.includes("negative")?"non-reactive":(l.includes("inconclusive"),"default")},x=async()=>{var p;const C=(p=f.value)==null?void 0:p.getFormValues(),l={value_text:C.test,new_order:!0,past_date:C.past_date};o(),await k(l)},k=async C=>{C.value_text=="HIV test"&&await J(Ge,{class:"otherVitalsModal"},!0,{order:C}),(C.value_text=="Syphilis"||C.value_text=="Hepatitis B Test"||C.value_text=="Hepatitis C Test")&&await J(Xe,{class:"otherVitalsModal"},!0,{order:C})},F=()=>{v.value=!0},D=()=>{y.value=!0,$("seeFullHistory")},M=()=>{y.value=!1},o=()=>{v.value=!1};return(C,l)=>(b(),V("div",Yt,[n("div",Kt,[l[2]||(l[2]=n("h2",{class:"header-title"},"PAST TEST RESULTS",-1)),t(e(z),{fill:"clear",size:"small",class:"see-history-btn",onClick:D},{default:a(()=>[l[1]||(l[1]=c(" See full History ",-1)),t(e(fe),{icon:e(tt),slot:"end"},null,8,["icon"])]),_:1})]),n("div",jt,[(b(!0),V(ce,null,pe(E.value,(p,h)=>(b(),j(e(A),{key:h,class:"test-result-item",lines:"none"},{default:a(()=>[n("div",Jt,[n("h3",Gt,T(p.name),1),n("p",Xt,T(p.date),1)]),t(e(Ne),{class:re(["result-chip",B(p.value)]),slot:"end"},{default:a(()=>[c(T(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),n("div",Qt,[t(e(z),{fill:"clear",size:"default",class:"add-results-btn",onClick:l[0]||(l[0]=p=>F())},{default:a(()=>[t(e(fe),{icon:e(st),slot:"start"},null,8,["icon"]),l[3]||(l[3]=c(" Enter Known Past Results ",-1))]),_:1})]),t(e(Ee),{"is-open":y.value,onDidDismiss:M,class:"history-modal"},{default:a(()=>[t(e(Ae),null,{default:a(()=>[t(e(Le),null,{default:a(()=>[t(e(Ue),null,{default:a(()=>[c("Full Test History ("+T(m.value.length)+")",1)]),_:1}),t(e(We),{slot:"end"},{default:a(()=>[t(e(z),{onClick:M},{default:a(()=>[...l[4]||(l[4]=[c("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(qe),{class:"modal-content"},{default:a(()=>[n("div",Zt,[(b(!0),V(ce,null,pe(m.value,(p,h)=>(b(),j(e(A),{key:"modal-".concat(h),class:"test-result-item",lines:"none"},{default:a(()=>[n("div",es,[n("h3",ts,T(p.name),1),n("p",ss,T(p.date),1)]),t(e(Ne),{class:re(["result-chip",B(p.value)]),slot:"end"},{default:a(()=>[c(T(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))])]),_:1})]),_:1},8,["is-open"]),t(e(Ee),{"is-open":v.value,onDidDismiss:o,class:"history-modal"},{default:a(()=>[t(e(Ae),null,{default:a(()=>[t(e(Le),null,{default:a(()=>[t(e(Ue),null,{default:a(()=>[...l[5]||(l[5]=[c("Select Test and Date",-1)])]),_:1}),t(e(We),{slot:"end"},{default:a(()=>[t(e(z),{onClick:o},{default:a(()=>[...l[6]||(l[6]=[c("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(qe),{class:"modal-content"},{default:a(()=>[t(de,{formData:L.value,ref_key:"formRef",ref:f},null,8,["formData"])]),_:1}),t(e(at),{style:{padding:"10px"}},{default:a(()=>[t(ct,{style:{float:"right"},name:"Cont.",onClick:x})]),_:1})]),_:1},8,["is-open"])]))}}),ns=se(as,[["__scopeId","data-v-29352a6b"]]),ls={style:{"max-width":"900px",margin:"auto"}},os={style:{"--background":"#fff"}},is={class:"demographics"},rs={style:{"text-overflow":"ellipsis"}},us={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},ds={style:{"margin-right":"5px"}},cs={style:{"margin-top":"5px"}},ps={class:"demographicsFirstRow"},vs={class:"name custom-name-container"},ms={class:"demographicsOtherRow",style:{"margin-top":"10px"}},fs={class:"demographicsText",style:{display:"flex","flex-wrap":"wrap"}},_s={style:{"flex-shrink":"0"}},ys={style:{"flex-shrink":"0"}},gs={key:0,class:"demographicsOtherRow"},hs={class:"demographicsText mediumFontColor"},xs={key:1,class:"demographicsOtherRow"},ws={class:"demographicsText mediumFontColor"},bs={class:"demographicsOtherRow"},Ts={class:"demographicsText smallFont"},ks={class:"mediumFontColor"},Cs={style:{background:"transparent"}},Is={class:"graphSection"},Rs={class:"graphBtn",style:{"margin-bottom":"5px"}},Ss={class:"weightHeightGraphBtns"},$s={key:0},Fs={key:1},Ds={class:"test-results-container"},Hs={class:"test-buttons-container"},Vs={style:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},Ms={class:"ion-padding",slot:"content"},Os=te({__name:"HTSPatientProfile",setup(O){const{event:g,popoverOpen:w,openPopover:$,openPIM:y,printVisitSummary:v,printID:f,formatCurrentAddress:m}=ft(),E=nt(),L=we,B=S(!1),x=S(7),k=S([]),F=S([]),D=S([]),M=be(),{patient:o}=xe(M),C=async r=>{x.value=r},l=async()=>{const r=ne.getLabResults(o.value);console.log("ðŸš€ ~ getLabResults ~ lab:",r),D.value=r.results},p=async()=>{var r;F.value=await le.getJson("/hts_referral_orders",{patient_id:(r=o.value)==null?void 0:r.patientID,filter_by_lab_result:!0})},h=async()=>{var s;const r=await Ke.getObsByEncounterId(je.REFERRAL);k.value=((s=r[0])==null?void 0:s.obs)||[]},U=r=>ae.calculateDisplayAge(ae.toStandardHisFormat(r)),W=()=>{var r,s,Y,X;dt.isEmpty((s=(r=o.value)==null?void 0:r.personInformation)==null?void 0:s.birthdate)||(B.value=ae.dateDiffInDays(ae.sessionDate(),(X=(Y=o.value)==null?void 0:Y.personInformation)==null?void 0:X.birthdate)<42)},d=()=>{J(yt,{class:"otherVitalsModal"})},i=()=>{J(gt,{class:"otherVitalsModal"})},u=async r=>{r.value_text=="HIV test"&&await J(Ge,{class:"otherVitalsModal"},!0,{order:r}),(r.value_text=="Syphilis"||r.value_text=="Hepatitis B Test"||r.value_text=="Hepatitis C Test")&&await J(Xe,{class:"otherVitalsModal"},!0,{order:r})},I=()=>!!new vt().isUnderFive(),P=()=>{console.log("Navigate to full history")},R=()=>{console.log("Enter known results")},H=()=>{var r,s;return ae.toStandardHisDisplayFormat((s=(r=o.value)==null?void 0:r.personInformation)==null?void 0:s.birthdate)};return ze(()=>E.currentRoute.value,async r=>{r.name=="patientProfile"&&o.value.patientID}),ze(o,async()=>{o&&(W(),await l(),await p())}),he(async()=>{W(),await h(),await p(),await l()}),(r,s)=>{var X,oe,Te,ke,Ce,Ie,Re,Se,$e,Fe,De,He,Ve,Me,Oe,Be;const Y=ue("ion-icon");return b(),V("div",ls,[n("div",os,[n("div",is,[n("div",rs,[n("div",us,[n("div",ds,[t(e(Q),null,{default:a(()=>[t(e(q),null,{default:a(()=>{var _,N;return[n("div",{class:re(((N=(_=e(o))==null?void 0:_.personInformation)==null?void 0:N.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor"),style:{display:"flex","flex-direction":"column","align-items":"center"}},[t(Y,{style:{color:"#fff","font-size":"100px"},icon:e(lt)},null,8,["icon"])],2)]}),_:1})]),_:1}),t(e(Q),null,{default:a(()=>[t(e(q),null,{default:a(()=>[...s[15]||(s[15]=[n("span",{class:"pill-text"},"Returning Client",-1)])]),_:1})]),_:1})]),n("div",cs,[n("div",ps,[n("div",vs,[(oe=(X=e(o))==null?void 0:X.personInformation)!=null&&oe.given_name?(b(),j(e(Q),{key:0,class:"custom-name-row"},{default:a(()=>[t(e(q),{class:"custom-name-col"},{default:a(()=>{var _,N;return[c(T((N=(_=e(o))==null?void 0:_.personInformation)==null?void 0:N.given_name),1)]}),_:1})]),_:1})):Z("",!0),(ke=(Te=e(o))==null?void 0:Te.personInformation)!=null&&ke.middle_name?(b(),j(e(Q),{key:1,class:"custom-name-row"},{default:a(()=>[t(e(q),{class:"custom-name-col"},{default:a(()=>{var _,N;return[c(T((N=(_=e(o))==null?void 0:_.personInformation)==null?void 0:N.middle_name),1)]}),_:1})]),_:1})):Z("",!0),(Ie=(Ce=e(o))==null?void 0:Ce.personInformation)!=null&&Ie.family_name?(b(),j(e(Q),{key:2,class:"custom-name-row"},{default:a(()=>[t(e(q),{class:"custom-name-col"},{default:a(()=>{var _,N;return[c(T((N=(_=e(o))==null?void 0:_.personInformation)==null?void 0:N.family_name),1)]}),_:1})]),_:1})):Z("",!0)])]),n("div",ms,[n("div",fs,[n("span",_s,T(((Se=(Re=e(o))==null?void 0:Re.personInformation)==null?void 0:Se.gender)=="M"?"Male":"Female"),1),s[16]||(s[16]=n("span",{style:{"flex-shrink":"0"}},".",-1)),n("span",ys,T(U((Fe=($e=e(o))==null?void 0:$e.personInformation)==null?void 0:Fe.birthdate))+" ("+T(H())+")",1)])]),(He=(De=e(o))==null?void 0:De.personInformation)!=null&&He.current_district?(b(),V("div",gs,[s[17]||(s[17]=n("div",{class:"demographicsText"},"Current Address:",-1)),n("div",hs,T(e(m)(e(o))),1)])):Z("",!0),(Me=(Ve=e(o))==null?void 0:Ve.personInformation)!=null&&Me.country?(b(),V("div",xs,[s[18]||(s[18]=n("div",{class:"demographicsText"},"Country:",-1)),n("div",ws,T((Be=(Oe=e(o))==null?void 0:Oe.personInformation)==null?void 0:Be.country),1)])):Z("",!0),n("div",bs,[n("div",Ts,[s[19]||(s[19]=c(" MRN: ",-1)),n("span",ks,T(e(o).ID),1)])])])])]),n("div",Cs,[t(e(Q),{class:"no-wrap-row",style:{"align-items":"center"}},{default:a(()=>[t(e(q),{style:{flex:"1","min-width":"0"}},{default:a(()=>[t(e(z),{class:"deactivate-button",fill:"solid",shape:"round"},{default:a(()=>[...s[20]||(s[20]=[c(" Deactivate Visit ",-1)])]),_:1})]),_:1}),t(e(q),{size:"auto",style:{"flex-shrink":"0"}},{default:a(()=>[n("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:s[0]||(s[0]=_=>e($)(_))},[t(Y,{icon:e(ot)},null,8,["icon"])])]),_:1})]),_:1})])]),n("div",Is,[n("div",null,[I()?(b(),j(_t,{key:0,checkUnderSixWeeks:B.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):Z("",!0),I()?Z("",!0):(b(),j(pt,{key:1}))]),n("div",Rs,[n("div",Ss,[n("div",null,[t(e(z),{class:"btnText",fill:"solid",onClick:s[1]||(s[1]=_=>i())},{default:a(()=>[B.value?(b(),V("span",Fs," Enter Weight")):(b(),V("span",$s," Enter Weight/Height")),t(Y,{slot:"end",size:"small",icon:e(L).whiteHeightWeight},null,8,["icon"])]),_:1})]),n("div",null,[t(e(z),{class:"btnText",fill:"solid",onClick:s[2]||(s[2]=_=>d())},{default:a(()=>[s[21]||(s[21]=c(" Enter Other Vitals ",-1)),t(Y,{slot:"end",size:"small",icon:e(L).whiteVitals},null,8,["icon"])]),_:1})])])])]),n("div",null,[t(e(A),{class:"new-orders-header"},{default:a(()=>[t(e(K),{class:"new-orders-label"},{default:a(()=>[...s[22]||(s[22]=[c(" NEW ORDERS ",-1)])]),_:1})]),_:1}),n("div",Ds,[n("div",Hs,[t(e(z),{class:"test-button",fill:"outline",shape:"round",onClick:s[3]||(s[3]=_=>u({value_text:"HIV test",new_order:!0}))},{default:a(()=>[...s[23]||(s[23]=[c(" HIV ",-1)])]),_:1}),t(e(z),{class:"test-button",fill:"outline",shape:"round",onClick:s[4]||(s[4]=_=>u({value_text:"Syphilis",new_order:!0}))},{default:a(()=>[...s[24]||(s[24]=[c(" Syphilis ",-1)])]),_:1}),t(e(z),{class:"test-button",fill:"outline",shape:"round",onClick:s[5]||(s[5]=_=>u({value_text:"Hepatitis B Test",new_order:!0}))},{default:a(()=>[...s[25]||(s[25]=[c(" Hepatitis B ",-1)])]),_:1}),t(e(z),{class:"test-button",fill:"outline",shape:"round",onClick:s[6]||(s[6]=_=>u({value_text:"Hepatitis C Test",new_order:!0}))},{default:a(()=>[...s[26]||(s[26]=[c(" Hepatitis C ",-1)])]),_:1})]),t(ns,{results:D.value,onSeeFullHistory:P,onEnterKnownResults:R},null,8,["results"])]),t(e(A),{class:"new-orders-header",style:{"margin-top":"10px"}},{default:a(()=>[t(e(K),{class:"new-orders-label"},{default:a(()=>[...s[27]||(s[27]=[c(" ORDERS FROM OTHER CLINICS ",-1)])]),_:1})]),_:1}),n("div",Vs,[(b(!0),V(ce,null,pe(F.value,(_,N)=>(b(),j(e(Q),{key:N,style:{"margin-bottom":"10px"}},{default:a(()=>[t(e(q),null,{default:a(()=>[t(Ct,{title:_.value_text,status:"Referred ".concat(_.program_name),type:"hiv",onPressed:Bs=>u(_)},null,8,["title","status","onPressed"])]),_:2},1024)]),_:2},1024))),128))])])]),t(e(ut),{style:{"--offset-x":"-10px"},"is-open":e(w),"show-backdrop":!1,event:e(g),onDidDismiss:s[14]||(s[14]=_=>w.value=!1)},{default:a(()=>[n("div",null,[t(e(it),{multiple:!0},{default:a(()=>[t(e(ie),{value:"first","toggle-icon":"",onClick:s[7]||(s[7]=_=>e(y)())},{default:a(()=>[t(e(A),{slot:"header",color:"light"},{default:a(()=>[t(e(K),null,{default:a(()=>[...s[28]||(s[28]=[c("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),t(e(ie),{value:"first","toggle-icon":"",onClick:s[8]||(s[8]=()=>{})},{default:a(()=>[t(e(A),{slot:"header",color:"light"},{default:a(()=>[t(e(K),null,{default:a(()=>[...s[29]||(s[29]=[c("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),t(e(ie),{value:"second","toggle-icon":"",onClick:s[9]||(s[9]=_=>e(v)())},{default:a(()=>[t(e(A),{slot:"header",color:"light"},{default:a(()=>[t(e(K),null,{default:a(()=>[...s[30]||(s[30]=[c("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),t(e(ie),{value:"third","toggle-icon":"",onClick:s[10]||(s[10]=_=>e(f)())},{default:a(()=>[t(e(A),{slot:"header",color:"light"},{default:a(()=>[t(e(K),null,{default:a(()=>[...s[31]||(s[31]=[c("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),t(e(ie),{value:"fourth"},{default:a(()=>[t(e(A),{slot:"header",color:"light"},{default:a(()=>[t(e(K),null,{default:a(()=>[...s[32]||(s[32]=[c("Update outcome",-1)])]),_:1})]),_:1}),n("div",Ms,[t(e(rt),null,{default:a(()=>[t(e(A),null,{default:a(()=>[t(e(me),{checked:x.value==7,value:"active",onIonChange:s[11]||(s[11]=_=>C(7))},{default:a(()=>[...s[33]||(s[33]=[c(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),t(e(A),null,{default:a(()=>[t(e(me),{checked:x.value==6,value:"inactive",onIonChange:s[12]||(s[12]=_=>C(6))},{default:a(()=>[...s[34]||(s[34]=[c(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),t(e(A),null,{default:a(()=>[t(e(me),{checked:x.value==3,value:"died",onIonChange:s[13]||(s[13]=_=>C(3))},{default:a(()=>[...s[35]||(s[35]=[c(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])}}}),aa=se(Os,[["__scopeId","data-v-cd9945a8"]]);export{aa as default};
