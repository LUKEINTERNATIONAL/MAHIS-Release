import{d as W,eO as ce,c as R,e as T,f as v,l as s,i as X,u as o,_ as K,J as b,bv as Y,W as z,k as m,K as _e,L as De,em as Oe,bs as ke,F as re,P as Ee,O as M,Q as oe,v as q,r as h,m as ue,bw as Ke,eP as Ce,H as de,aV as H,a as Ae,an as Ye,cE as ze,w as O,a3 as We,bK as Xe,a6 as qe,b9 as U}from"./vendor-BDGIuVwJ.js";import{_ as me,J as be,l as le,aB as Te,aC as je,aG as Be,u as Je,aH as Qe,aI as Ze,aJ as et,aK as tt,d as nt,aL as at,g as st,Z as ot,e as lt,T as it,N as ct,H as fe,aM as ae,aN as rt,aO as Pe,aP as ut,t as Le,aQ as se,G as dt,aR as mt,a0 as pt,S as vt}from"../index-lAUB1meQ.js";import{D as ft}from"./DemographicBar-1TmYJB4o.js";import{u as gt}from"./RadiologyStore-CuHM4cCI.js";import{B as V}from"./BasicForm-DUnfo8vp.js";import{u as _t,_ as Et}from"./useFormWizard-BjlGNpCo.js";import{u as ge,s as bt,c as yt,a as St}from"./nonPharmaTherapyStore-B8DSRFUe.js";import{l as ht}from"./lodash-NJiRuGo9.js";import{a as Ie,b as Ct}from"./formatServerData-DcqUlKjs.js";import{u as Tt}from"./usePatientProfile-CWhqFCzZ.js";import"./apexcharts-XnpXrK8U.js";import"./DateInputField-CdOLGRjF.js";import"./drug_prescription_service-CO90EjSW.js";import"./patient_diagnosis_service-C1j5LhFG.js";import"./Registration-DtG3X5p0.js";import"./useLocation-C1BzRSce.js";import"./vaccines_service-CZ-otSwy.js";import"./sms_service-CremovcI.js";import"./EIRreportsStore-C-7UOi8Y.js";import"./Export-DRxOmWsQ.js";import"./NeonatalEnrollmentStore-BzZSnKIK.js";const Bt={class:"checkbox-group"},Pt={class:"label-content"},Lt={class:"nested-content"},It=W({__name:"CheckboxGroup",props:{sectionKey:{}},setup(G){const i=G,e=ce("sections"),c=ce("sectionDefinitions")[i.sectionKey],I=R(()=>e.value[i.sectionKey]),D=R(()=>I.value.open),B=R(()=>I.value.selectedFields),y=R(()=>!c.fields||c.fields.length===0?!1:c.fields.every(a=>B.value[a.name])),k=R(()=>{if(!c.fields||c.fields.length===0)return!1;const a=c.fields.filter(r=>B.value[r.name]).length;return a>0&&a<c.fields.length}),N=()=>{e.value[i.sectionKey].open=!e.value[i.sectionKey].open,console.log("ðŸš€ ~ toggleOpen ~ sections.value[props.sectionKey].open:",e.value[i.sectionKey].open)},g=a=>{e.value[i.sectionKey].selectedFields[a]=!e.value[i.sectionKey].selectedFields[a]},d=()=>{const a=!y.value;c.fields&&c.fields.forEach(r=>{e.value[i.sectionKey].selectedFields[r.name]=a}),a&&(e.value[i.sectionKey].open=!0)};return(a,r)=>(v(),T("div",Bt,[s(o(K),{lines:"none",class:"section-header"},{default:b(()=>[s(o(Y),{slot:"start",checked:y.value,indeterminate:k.value&&!y.value,onIonChange:d},null,8,["checked","indeterminate"]),s(o(z),{style:{"margin-left":"5px"}},{default:b(()=>[m("div",Pt,[m("span",null,_e(o(c).title),1),m("div",{class:"chevron-container",onClick:N},[s(o(De),{icon:D.value?o(Oe):o(ke),class:"chevron-icon"},null,8,["icon"])])])]),_:1})]),_:1}),X(m("div",Lt,[(v(!0),T(re,null,Ee(o(c).fields,l=>(v(),M(o(K),{key:l.name,lines:"none",class:"field-item"},{default:b(()=>[s(o(Y),{slot:"start",checked:B.value[l.name],onIonChange:A=>g(l.name)},null,8,["checked","onIonChange"]),s(o(z),null,{default:b(()=>[oe(_e(l.label),1)]),_:2},1024)]),_:2},1024))),128))],512),[[q,D.value]])]))}}),ie=me(It,[["__scopeId","data-v-674cf61d"]]),Dt={class:"parent-checkbox-group"},Ot={class:"label-content"},kt={class:"nested-content"},At=W({__name:"ParentCheckboxGroup",props:{sectionKey:{}},setup(G){const i=G,e=ce("sections"),t=ce("sectionDefinitions"),c=t[i.sectionKey],I=R(()=>e.value[i.sectionKey]),D=R(()=>I.value.open),B=R(()=>c.subSections?c.subSections.every(g=>{const d=t[g];return!d.fields||d.fields.length===0?!0:d.fields.every(a=>e.value[g].selectedFields[a.name])}):!1),y=R(()=>{if(!c.subSections)return!1;let g=0,d=0;return c.subSections.forEach(a=>{const r=t[a];r.fields&&(d+=r.fields.length,g+=r.fields.filter(l=>e.value[a].selectedFields[l.name]).length)}),g>0&&g<d}),k=()=>{e.value[i.sectionKey].open=!e.value[i.sectionKey].open},N=()=>{const g=!B.value;c.subSections&&c.subSections.forEach(d=>{const a=t[d];a.fields&&(a.fields.forEach(r=>{e.value[d].selectedFields[r.name]=g}),e.value[d].open=!0)}),e.value[i.sectionKey].open=!0};return(g,d)=>(v(),T("div",Dt,[s(o(K),{lines:"none",class:"section-header"},{default:b(()=>[s(o(Y),{slot:"start",checked:B.value,indeterminate:y.value&&!B.value,onIonChange:N},null,8,["checked","indeterminate"]),s(o(z),{onClick:k,class:"clickable-label"},{default:b(()=>[m("div",Ot,[m("strong",null,_e(o(c).title),1),s(o(De),{icon:D.value?o(Oe):o(ke),class:"chevron-icon"},null,8,["icon"])])]),_:1})]),_:1}),X(m("div",kt,[(v(!0),T(re,null,Ee(o(c).subSections,a=>(v(),M(ie,{key:a,"section-key":a},null,8,["section-key"]))),128))],512),[[q,D.value]])]))}}),Nt=me(At,[["__scopeId","data-v-2fe0d76b"]]),Ht={class:"ion-padding"},Rt={key:0,class:"loading-overlay"},xt={class:"form-content"},Ft={class:"checkbox-item"},Vt={class:"checkbox-item"},Gt={class:"checkbox-item"},wt={class:"ion-float-right ion-padding"},Mt=W({__name:"BedsidePlan",setup(G){const i={PREGNANCY_TEST:"PREGNANCY_TEST",UROBILINOGEN:"UROBILINOGEN",LEUKOCYTES:"LEUKOCYTES",BILIRUBIN:"BILIRUBIN",SPECIFIC_GRAVITY:"SPECIFIC_GRAVITY",NITRITE:"NITRITE",KETONES:"KETONES",BLOOD:"BLOOD",PROTEIN:"PROTEIN",POINT_OF_CARE_ULTRASOUND:"POCUS",ECG:"ECG",PEFR:"PEFR",OTHER:"OTHER"},e={PH:"pH",PCO2:"pCOâ‚‚ (mmHg)",PO2:"pOâ‚‚ (mmHg)",CTHB:"c_tHb (g/dL)",SO2:"sOâ‚‚ (%)",FO2HB:"FOâ‚‚Hb (%)",FHHB:"FHHb (%)",FMETHB:"FmetHb (%)",CK:"cKâº (mmol/L)",CNA:"cNaâº (mmol/L)",CA2:"cCaÂ²âº (mmol/L)",CCL:"cClâ» (mmol/L)",GLU:"cGlu (mmol/L)",LAC:"cLac (mmol/L)",CTBIL:"ctBil (Âµmol/L)",PH_T:"pH (T)",PCO2_T:"pCOâ‚‚ (T) mmHg",PO2_T:"pOâ‚‚ (T) mmHg",P50E:"P50e",BASE_EXCESS:"cBaseExcess (Ecf)c",HCO3:"cHCOâ‚ƒâ» (P,st)c",ANION_GAP:"Anion Gap",MOSM:"cmOSm"},t={PH:{name:e.PH,label:e.PH},PCO2:{name:e.PCO2,label:e.PCO2},PO2:{name:e.PO2,label:e.PO2},CTHB:{name:e.CTHB,label:e.CTHB},SO2E:{name:e.SO2,label:e.SO2},FO2HBE:{name:e.FO2HB,label:e.FO2HB},FHHBE:{name:e.FHHB,label:e.FHHB},FMETHB:{name:e.FMETHB,label:e.FMETHB},CK:{name:e.CK,label:e.CK},CNA:{name:e.CNA,label:e.CNA},CA2:{name:e.CA2,label:e.CA2},CCL:{name:e.CCL,label:e.CCL},glucose:{name:e.GLU,label:e.GLU},LACTATE:{name:e.LAC,label:e.LAC},CTBIL:{name:e.CTBIL,label:e.CTBIL},PH_T:{name:e.PH_T,label:e.PH_T},PCO2_T:{name:e.PCO2_T,label:e.PCO2_T},PO2_T:{name:e.PO2_T,label:e.PO2_T},P50E:{name:e.P50E,label:e.P50E},BASE_EXCESS:{name:e.BASE_EXCESS,label:e.BASE_EXCESS},HCO3:{name:e.HCO3,label:e.HCO3},ANION_GAPC:{name:e.ANION_GAP,label:e.ANION_GAP},MOSMC:{name:e.MOSM,label:e.MOSM},pregnancyTest:{name:i.PREGNANCY_TEST,label:"Pregnancy Test",coded:!0},urobilinogen:{name:i.UROBILINOGEN,label:"Urobilinogen"},leukocytes:{name:i.LEUKOCYTES,label:"Leukocytes"},bilirubin:{name:i.BILIRUBIN,label:"Bilirubin"},specificGravity:{name:i.SPECIFIC_GRAVITY,label:"Specific Gravity"},nitrite:{name:i.NITRITE,label:"Nitrite"},ketones:{name:i.KETONES,label:"Ketones"},blood:{name:i.BLOOD,label:"Blood"},protein:{name:i.PROTEIN,label:"Protein"},pocus:{name:i.POINT_OF_CARE_ULTRASOUND,label:"Point of care ultrasound"},ecg:{name:i.ECG,label:"ECG"},pefr:{name:i.PEFR,label:"PEFR"},other:{name:i.OTHER,label:"Other"}},c={arterialVenousBloodGasMain:{title:"Arterial/Venous Blood Gas",subSections:["bloodGasValues","oximetryValues","electrolyteValues","metabolicValues","temperatureCorrectedValues","acidBaseStatus"]},bloodGasValues:{title:"Blood Gas Values",fields:[t.PH,t.PCO2,t.PO2]},oximetryValues:{title:"Oximetry Values",fields:[t.CTHB,t.SO2E,t.FO2HBE,t.FHHBE,t.FMETHB]},electrolyteValues:{title:"Electrolyte Values",fields:[t.CK,t.CNA,t.CA2,t.CCL]},metabolicValues:{title:"Metabolic Values",fields:[t.glucose,t.LACTATE,t.CTBIL]},temperatureCorrectedValues:{title:"Temperature Corrected Values",fields:[t.PH_T,t.PCO2_T,t.PO2_T,t.P50E]},acidBaseStatus:{title:"Acid Base Status",fields:[t.BASE_EXCESS,t.HCO3,t.ANION_GAPC,t.MOSMC]},dipstick:{title:"Dipstick",fields:[t.urobilinogen,t.PH,t.leukocytes,t.glucose,t.specificGravity,t.protein,t.nitrite,t.ketones,t.bilirubin,t.blood]},additionalTests:{title:"Additional Tests",fields:[t.pocus,t.ecg,t.pefr,t.other]},pregnancyTest:{title:"Pregnancy Test",fields:[t.pregnancyTest]}},I=h({activeVisit:"visit-123",patientId:"patient-456",gender:"Female"}),B=h((()=>{const d={};return Object.keys(c).forEach(a=>{const r=c[a];d[a]={open:!1,selectedFields:{}},r.fields&&r.fields.forEach(l=>{d[a].selectedFields[l.name]=!1})}),d})()),y=h(!1),k=h(!1),N=h(!1),g=h(!1);return Ce("sections",B),Ce("sectionDefinitions",c),(d,a)=>(v(),T("div",Ht,[g.value?(v(),T("div",Rt,[s(o(Ke),{name:"crescent"})])):ue("",!0),m("div",xt,[s(Nt,{"section-key":"arterialVenousBloodGasMain"}),m("div",Ft,[s(o(K),{lines:"none"},{default:b(()=>[s(o(Y),{slot:"start",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=r=>y.value=r)},null,8,["modelValue"]),s(o(z),{style:{"margin-left":"5px"}},{default:b(()=>[...a[3]||(a[3]=[oe("MRDT",-1)])]),_:1})]),_:1})]),m("div",Vt,[s(o(K),{lines:"none"},{default:b(()=>[s(o(Y),{slot:"start",modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=r=>k.value=r)},null,8,["modelValue"]),s(o(z),{style:{"margin-left":"5px"}},{default:b(()=>[...a[4]||(a[4]=[oe("HIV",-1)])]),_:1})]),_:1})]),m("div",Gt,[s(o(K),{lines:"none"},{default:b(()=>[s(o(Y),{slot:"start",modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=r=>N.value=r)},null,8,["modelValue"]),s(o(z),{style:{"margin-left":"5px"}},{default:b(()=>[...a[5]||(a[5]=[oe("VDRL",-1)])]),_:1})]),_:1})]),I.value.gender==="Female"?(v(),M(ie,{key:0,"section-key":"pregnancyTest"})):ue("",!0),s(ie,{"section-key":"dipstick"}),s(ie,{"section-key":"additionalTests"})]),m("div",wt,[s(be,{name:"Submit"})])]))}}),$t=me(Mt,[["__scopeId","data-v-c6d265c2"]]),Ut={class:"ion-float-right ion-padding"},Kt=W({__name:"LabOrderPlan",setup(G){const i=[{componentType:"multiSelectInputField",header:"Tests",name:"tests",isMultiple:!1,trackBy:"id",grid:{s:"6"},icon:le.search,options:[{id:1,name:"HIV"},{id:2,name:"VDRL"},{id:3,name:"Urine Routine"},{id:4,name:"Urine Microscopy"},{id:5,name:"Urine Culture"}]},{componentType:"multiSelectInputField",header:"Sample Type",name:"sample_type",isMultiple:!1,trackBy:"id",grid:{s:"6"},icon:le.search,options:[{id:1,name:"Blood"},{id:2,name:"Urine"},{id:3,name:"Serum"},{id:4,name:"Sputum"}]},{componentType:"radioButtonField",header:"Emergency",name:"is_emergency",obsValueType:"value_text",validation:Te.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"radioButtonField",header:"Urgent Sample",name:"is_urgent_sample",obsValueType:"value_text",validation:Te.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"textAreaField",header:"Description",name:"description",icon:le.editPen}];return(e,t)=>{const c=de("ion-card-content"),I=de("ion-card");return v(),M(I,null,{default:b(()=>[s(c,null,{default:b(()=>[s(je,{formData:i}),m("div",Ut,[s(be,{name:"Submit"})])]),_:1})]),_:1})}}}),Yt=["innerHTML"],zt={class:"scrollable-container"},Wt={key:0,class:"form-section"},Xt={key:1,class:"form-section"},qt={key:2,class:"form-section"},jt={key:3,class:"form-section"},Jt={key:4,class:"form-section"},Qt={key:5,class:"form-section"},Zt={key:6,class:"form-section"},en={key:7,class:"form-section"},tn=W({__name:"Radiology",setup(G){const i=gt(),{head:e,neck:t,chest:c,abdomen:I,upper_extremity:D,spine:B,pelvis:y,lower_extremity:k}=H(i),N=h(le),g=h([]),d=(r,l,A)=>{document.querySelectorAll("#".concat(r," path")).forEach(p=>{p.classList.toggle("white-fill")}),document.querySelectorAll("#".concat(l," line")).forEach(p=>{p.classList.toggle("dark-green-stroke")}),document.querySelectorAll("#".concat(l," rect")).forEach(p=>{p.classList.toggle("bright-green-fill"),p.classList.toggle("dark-green-stroke")}),document.querySelectorAll("#".concat(l," path")).forEach(p=>{p.classList.toggle("dark-green-fill")}),document.querySelectorAll("#".concat(l," circle")).forEach(p=>{p.classList.toggle("bright-green-fill")});const x=g.value.findIndex(p=>p.id===A);x>=0?g.value.splice(x,1):g.value.unshift({id:A,active:!0})},a=()=>{const r=document.getElementById("SPINE");r.style.display==="none"||r.style.display==""?r.style.display="block":r.style.display="none",d("SPINE","SPINE_LABEL-2","spine")};return Ae(()=>{const r=document.getElementById("HEAD");r&&r.addEventListener("click",()=>{d("HEAD","LABEL-6","head")});const l=document.getElementById("NECK");l&&l.addEventListener("click",()=>{d("NECK","LABEL-5","neck")});const A=document.getElementById("CHEST");A&&A.addEventListener("click",()=>{d("CHEST","LABEL-4","chest")});const x=document.getElementById("ABDOMEN_LABEL");x&&x.addEventListener("click",()=>{const w=document.getElementById("ABDOMEN-2");w.style.display==="none"||w.style.display==""?w.style.display="block":w.style.display="none",d("ABDOMEN","ABDOMEN_LABEL-2","abdomen")});const p=document.getElementById("UPPER_EXTRMITY");p&&p.addEventListener("click",()=>{d("UPPER_EXTRMITY","LABEL-3","upper_extremity")});const _=document.getElementById("SPINE"),j=document.getElementById("SPINE_LABEL"),J=document.getElementById("LOWER_SPINE_INACTIVE");_&&_.addEventListener("click",()=>{a()}),j&&j.addEventListener("click",()=>{a()}),J&&J.addEventListener("click",()=>{a()});const Q=document.getElementById("PELVIS");Q&&Q.addEventListener("click",()=>{d("PELVIS","LABEL-2","pelvis")});const Z=document.getElementById("LOWER_EXTREMITY");Z&&Z.addEventListener("click",()=>{d("LOWER_EXTREMITY","LABEL","lower_extremity")})}),(r,l)=>{const A=de("ion-col"),x=de("ion-row");return v(),M(x,null,{default:b(()=>[s(A,{size:"7"},{default:b(()=>[m("div",{innerHTML:N.value.full_body_sk},null,8,Yt)]),_:1}),s(A,{size:"5",class:"form-column"},{default:b(()=>[m("div",zt,[(v(!0),T(re,null,Ee(g.value,p=>(v(),T(re,null,[p.id==="head"?(v(),T("div",Wt,[l[0]||(l[0]=m("h6",null,"Body Part: Head",-1)),s(V,{contentData:o(e)},null,8,["contentData"])])):p.id==="neck"?(v(),T("div",Xt,[l[1]||(l[1]=m("h6",null,"Body Part: Neck",-1)),s(V,{contentData:o(t)},null,8,["contentData"])])):p.id==="chest"?(v(),T("div",qt,[l[2]||(l[2]=m("h6",null,"Body Part: Chest",-1)),s(V,{contentData:o(c)},null,8,["contentData"])])):p.id==="abdomen"?(v(),T("div",jt,[l[3]||(l[3]=m("h6",null,"Body Part: Abdomen",-1)),s(V,{contentData:o(I)},null,8,["contentData"])])):p.id==="upper_extremity"?(v(),T("div",Jt,[l[4]||(l[4]=m("h6",null,"Body Part: Upper Extremity",-1)),s(V,{contentData:o(D)},null,8,["contentData"])])):p.id==="spine"?(v(),T("div",Qt,[l[5]||(l[5]=m("h6",null,"Body Part: Spine",-1)),s(V,{contentData:o(B)},null,8,["contentData"])])):p.id==="pelvis"?(v(),T("div",Zt,[l[6]||(l[6]=m("h6",null,"Body Part: Pelvis",-1)),s(V,{contentData:o(y)},null,8,["contentData"])])):p.id==="lower_extremity"?(v(),T("div",en,[l[7]||(l[7]=m("h6",null,"Body Part: Lower Extremity",-1)),s(V,{contentData:o(k)},null,8,["contentData"])])):ue("",!0)],64))),256))])]),_:1})]),_:1})}}}),nn=me(tn,[["__scopeId","data-v-33a0b153"]]),an={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},sn={class:"back_profile"},In=W({__name:"Investigations",setup(G,{expose:i}){const{onTabBeforeChange:e,currentTabIndex:t}=_t();Tt();const c=Ye(),I=ze();h([]),h([]),h(!1);const D=h(!0),B=h(!1),y=h(!1),k=R(()=>({text:y.value?"Saving...":"Finish",icon:y.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:B.value||y.value})),N=Be(),g=Je(),d=Qe(),a=Ze();et();const r=tt(),l=nt();at();const A=st(),x=ge(),p=ot(),{patient:_}=H(g),{vitals:j}=H(N),{investigations:J}=H(d),{diagnosis:Q}=H(a),{substance:Z}=H(A),{selectedNCDMedicationList:w}=H(r),{FootScreening:Ne,visualScreening:He,cvScreening:Re}=H(x),{sessionDate:ye}=H(p),{apiStatus:on}=H(lt());O(k,(n,u)=>{console.log("Done button options changed:",{from:u,to:n,currentStep:t.value,tabsLength:S.value.length}),n.disabled!==(u==null?void 0:u.disabled)&&console.log("Done button ".concat(n.disabled?"disabled":"enabled")),n.text!==(u==null?void 0:u.text)&&console.log('Done button text changed from "'.concat(u==null?void 0:u.text,'" to "').concat(n.text,'"'))},{deep:!0}),O(y,(n,u)=>{n!==u&&(console.log("Saving state changed: ".concat(u," -> ").concat(n)),console.log(n?"Starting save process...":"Save process completed"))});const xe=n=>{console.log("Done button change received from wizard:",n),n.newOptions.disabled&&console.log("Done button has been disabled"),n.isLastStep&&console.log("User is on the last step, done button should be visible")},ee=()=>{let n=!1;return te(),y.value&&(n=!0),B.value=n,!n},Fe=()=>{c.push("/patientProfile")},pe=()=>[{title:"Bedside plan",icon:""},{title:"Lab Order Plan",icon:""},{title:"Radiology",icon:""}],S=h(pe()),Ve=h(null),Ge=h(null),te=()=>{var E;if(!S.value||S.value.length===0)return console.log("Tabs not yet initialized"),null;const n=t.value>=0&&t.value<S.value.length?t.value:0;switch((E=S.value[n])==null?void 0:E.title){case"Bedside plan":return"BedsidePlan";case"Lab Order Plan":return"LabOrderPlan";case"Radiology":return"Radiology";default:if(l.NCDActivities.length>0)switch(l.NCDActivities[0]){case"Bedside plan":return"BedsidePlan";case"Lab Order Plan":return"LabOrderPlan";case"Radiology":return"Radiology"}return null}},ve=()=>{D.value=!1,setTimeout(()=>{t.value=0,D.value=!0},0)},Se=()=>{const n=Be();n.setVitals(n.getInitialVitals(_.value.ID))},F=async()=>{var E,L;const n=ct(ye.value,"sessionDate","value")||fe.sessionDate(),u=ae("vitals");for(let f=0;f<S.value.length;f++){const P=S.value[f];if(P.title==="Vital Signs")S.value[f].icon=ne(n,u)?U:"";else if(P.title==="Risk Assessment"){const C=ae("substanceAbuse");S.value[f].icon=ne(n,C)?U:""}else if(P.title==="Investigations"){const C=(L=(E=_==null?void 0:_.value)==null?void 0:E.labOrders)==null?void 0:L.saved,$=C==null?void 0:C.filter(Ue=>fe.toStandardHisFormat(n)===fe.toStandardHisFormat(Ue.order_date));S.value[f].icon=($==null?void 0:$.length)>0?U:""}else if(P.title==="Diagnosis"){const C=ae("diagnosis");S.value[f].icon=ne(n,C)?U:""}else if(P.title==="Complications Screening"){const C=ae("screening");S.value[f].icon=ne(n,C)?U:""}else P.title==="Treatment Plan"&&(w.value.length>0?S.value[f].icon=rt()?U:"":S.value[f].icon="")}ee()},ne=(n,u)=>{const E=new Date(n);return E.setHours(0,0,0,0),u.some(L=>{const f=new Date(L.obs_datetime);return f.setHours(0,0,0,0),f.getTime()===E.getTime()})},we=async()=>{var f,P,C,$;const n=[],u=await Ie(He.value),E=await Ct(Ne.value),L=await Ie(Re.value);u.length>0&&n.push({concept_id:await se.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:se.getSessionDate(),child:u}),E.length>0&&n.push({concept_id:await se.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:se.getSessionDate(),child:E}),L.length>0&&n.push(...L),n.length>0?(($=(C=(P=(f=_.value).screening)!=null?P:f.screening={}).unsaved)!=null||(C.unsaved=[]),_.value.screening.unsaved.push(...n),dt("Complications saved successfully")):Le("No complications data to save")},Me=async()=>{const n=mt();if(!ht.isEmpty(n.selectedMedicalAllergiesList)){const L=pt(),f=n.selectedMedicalAllergiesList.map(C=>({concept_id:C.concept_id,obs_datetime:vt.getSessionDate(),value_coded:C.concept_id,location_id:L.facilityLocation.code,value_text:C.name})),P=await bt(f);_.value=Object.assign(_.value,P),console.log("Allergies staged successfully:",_.value),n.clearSelectedMedicalAllergiesList()}const u=await yt();_.value=Object.assign(_.value,u);const E=await St().saveNonPharmaTherapyPatientData();_.value=Object.assign(_.value,E)},$e=async(n,u)=>{var L,f,P;const E=(L=S.value[u])==null?void 0:L.title;n%1===0&&(t.value=n),E=="Vital Signs"&&((f=Ve.value)==null||f.onSubmit()),E=="Risk Assessment"&&((P=Ge.value)==null||P.onSubmit()),E=="Complications Screening"&&await we(),E=="Treatment Plan"&&await Me(),await Pe(_.value)},he=async()=>{y.value=!0;try{await ut(),await Pe(_.value),c.push("/triageList")}catch(n){console.error("Error saving data:",n),Le("Error occurred while saving data. Please try again.")}finally{y.value=!1}};return Ae(async()=>{if(l.NCDActivities.length===0){c.push("patientProfile");return}ge().resetScreening(),S.value=pe(),await F(),(t.value===void 0||t.value<0)&&(t.value=0,console.log("Setting initial tab index to 0")),B.value=!1,y.value=!1,ee()}),O(t,async()=>{await ee()}),O(j,async()=>{await F()},{deep:!0}),O(_,async()=>{ge().resetScreening(),await F()},{deep:!0}),O(ye,async()=>{await F()},{deep:!0}),O(J,async()=>{await F()},{deep:!0}),O(Q,async()=>{await F()},{deep:!0}),O(Z,async()=>{await F()},{deep:!0}),O(w,async()=>{await F()},{deep:!0}),O(I,async n=>{ve(),Se(),S.value=pe()},{deep:!0}),O(_,async(n,u)=>{n.ID!=u.ID&&(ve(),Se())},{deep:!0}),i({saveData:he,markWizard:F,refreshWizard:ve,validateDoneButtonState:ee}),(n,u)=>(v(),M(o(qe),null,{default:b(()=>[s(it),s(o(We),{fullscreen:!0},{default:b(()=>[s(ft),m("div",an,[D.value?(v(),M(Et,{key:0,ref:"wizard",headingTitle:"Investigation Plan","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:k.value,"custom-tabs":S.value,beforeChange:o(e),onChange:$e,"onComplete:wizard":u[1]||(u[1]=E=>he()),onDoneButtonChanged:xe},{default:b(()=>[m("div",null,[m("div",sn,[s(be,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:o(Xe),"font-weight":"600",onClick:u[0]||(u[0]=E=>Fe())},null,8,["icon"])])]),X(m("div",null,[s($t,{ref:"bedsidePlanRef"},null,512)],512),[[q,te()=="BedsidePlan"]]),X(m("div",null,[s(Kt,{ref:"labOrderPlanRef"},null,512)],512),[[q,te()=="LabOrderPlan"]]),X(m("div",null,[s(nn,{ref:"radiologyRef"},null,512)],512),[[q,te()=="Radiology"]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):ue("",!0)])]),_:1})]),_:1}))}});export{In as default};
