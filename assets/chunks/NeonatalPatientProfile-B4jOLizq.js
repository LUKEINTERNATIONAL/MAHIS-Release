import{d as Te,aF as _e,bh as he,r as y,a as Oe,w as ne,e as ae,f as C,k as o,l as a,u as e,au as Se,H as s,ad as j,av as Y,bH as F,Q as se,m as q,bF as be,a3 as N,I as m,b7 as W,dt as H,bu as z,c as Ie,G as we,p as Ee,d1 as Me,d$ as ke,aC as De,aB as P,al as T,a5 as x,ak as Re,aq as Z,bk as Pe}from"./vendor-CJ2tyHrn.js";import{l as xe}from"./lodash-NJiRuGo9.js";import{u as Ge}from"./usePatientProfile-Bjyh6yGB.js";import Be from"./WeightHeightChart-XjtIUsKb.js";import{u as ye,b as O,t as ee,_ as Le,l as Ve,o as Ue,q as $e,bq as Ye,S as Fe,K as We,H as h,P as He}from"../index-CPIhguZJ.js";import{N as te}from"./neonatal_service-DKdrVzxM.js";import{g as ge}from"./admissionWorkflow-C1e4oic-.js";import{I as X}from"./images-142qstiX.js";import"./Registration-F5RJpZPr.js";import"./useSetRegistrationValues-CWxNfeBu.js";import"./useLocation-BxHWO3Ky.js";import"./vaccines_service-CFrWoT5a.js";import"./sms_service-ba9KXWCi.js";import"./EIRreportsStore-COMUTdOQ.js";import"./Export-CZmpfP5c.js";import"./user_role_management-C_d1iPJp.js";import"./useNeonatalEnrollmentStore--u9Qw-om.js";import"./enrollment-DU-PLRUa.js";import"./Outcome-BVD9d5EL.js";import"./wardsStore-DRE4cKPY.js";import"./chartjs-DHFif7P9.js";import"./apexcharts-BtvCa6MI.js";const ze={class:"neonatal-home-component"},Xe={class:"icon-container"},qe={class:"icon-container"},Ke={class:"icon-container"},Qe={class:"icon-container"},Je=Te({__name:"NeonatalCare",setup(Ce){const p=_e(),K=ye(),{patient:f}=he(K),_=y(""),A=y(""),b=l=>{const i={discharge:{path:"/neonatal/discharge"},"neonatal-opd":{path:"/neonatal/opd"},"in-patient":{path:"/neonatal/in-patient"},"emergency-triage":{path:"/neonatal/triage",query:{source:"profile"}},"instruction-guides":{path:"/neonatal/guides"},checkpoint:{path:"/neonatal/checkpoint"}}[l];i?p.push({path:i.path,query:i.query}):console.warn("Route not found for: ".concat(l))},d=l=>(l!=null?l:"").trim().toUpperCase(),v=[{encounterType:O.NEONATAL_SIGNS_SYMPTOMS,route:"/neonatal/signs-symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS"],title:"Signs & Symptoms"},{encounterType:O.NEONATAL_REVIEW_OF_SYSTEMS,route:"/neonatal/review-of-systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"],title:"Review of Systems"},{encounterType:O.PHYSICAL_EXAMINATION_BABY,route:"/neonatal/general-examination",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"],title:"General Exam"},{encounterType:O.VITALS,route:"/neonatal/vitals",encounterNames:["VITALS","NEONATAL VITALS"],title:"Vitals"},{encounterType:O.NEONATAL_SYSTEMIC_EXAMINATION,route:"/neonatal/SystemicExamination",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"],title:"Systemic Exam"},{encounterType:O.NEONATAL_ADMISSION_OUTCOMES,route:"/neonatal/admission-outcomes",encounterNames:["NEONATAL ADMISSION OUTCOMES"],title:"Outcomes"}],G=v[0].route,S=v[v.length-1].route,Q=l=>{const n=ge(l,v),i=v[n];return i?i.route:S},J=l=>{const n=ge(l,v),i=v[n];return i?i.title:""},B=async l=>{try{const n=await te.getSavedEncounters(l),i=Array.isArray(n==null?void 0:n.encounters)?n.encounters:[],I=Q(i);await p.push(I)}catch(n){console.error("Error determining neonatal admission workflow:",n),ee("Unable to determine next admission step. Starting from Signs & Symptoms."),await p.push(G)}},V=l=>{const n=d("NEONATAL ENROLLMENT");return l.some(i=>d(i)===n)},U=l=>{const n=d("NEONATAL TRIAGE");return l.some(i=>d(i)===n)},$=[{title:"Triage",encounterNames:["NEONATAL TRIAGE"]},{title:"Profiling",encounterNames:["NEONATAL ENROLLMENT"]},{title:"Signs & Symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS","NEONATAL SIGNS SYMPTOMS"]},{title:"Review of Systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"]},{title:"General Exam",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"]},{title:"Vitals",encounterNames:["VITALS","NEONATAL VITALS"]},{title:"Systemic Exam",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"]},{title:"Diagnosis",encounterNames:["DIAGNOSIS","NEONATAL DIAGNOSIS"]},{title:"Investigations",encounterNames:["INVESTIGATION","NEONATAL INVESTIGATION","LAB ORDERS","LAB RESULTS"]},{title:"Treatment",encounterNames:["TREATMENT","NEONATAL TREATMENT PLAN"]},{title:"Outcomes",encounterNames:["NEONATAL ADMISSION OUTCOMES","ADMISSION OUTCOMES"]}],u=async()=>{var l;if(!((l=f.value)!=null&&l.patientID)){_.value="",A.value="";return}try{const n=await te.getSavedEncounters(f.value.patientID),i=Array.isArray(n==null?void 0:n.encounters)?n.encounters:[],I=new Set(i.map(c=>d(c))),M=c=>c.some(r=>I.has(d(r)));let L=null;for(const c of $)if(!M(c.encounterNames)){L=c;break}L?A.value=L.title:A.value="Complete";const k=V(i),D=U(i);if(!k)_.value="Enrollment";else if(!D)_.value="Triage";else{const c=J(i);_.value=c||"Completed"}}catch(n){console.error("Error loading next encounter badge:",n),_.value="",A.value=""}},w=async()=>{var l;if(!((l=f.value)!=null&&l.patientID)){ee("No patient selected");return}try{const n=await te.getSavedEncounters(f.value.patientID),i=Array.isArray(n==null?void 0:n.encounters)?n.encounters:[],I=new Set(i.map(c=>d(c))),M=c=>c.some(r=>I.has(d(r)));if($.every(c=>M(c.encounterNames))){p.push("/neonatal/checkpoint");return}if(!U(i)){p.push("/neonatal/triage");return}if(!V(i)){p.push("/neonatal/enrollment");return}await B(f.value.patientID)}catch(n){console.error("Error in handleAdmit:",n),ee("Unable to check admission status")}};return Oe(()=>{u()}),ne(()=>{var l;return(l=f.value)==null?void 0:l.patientID},()=>{u()}),(l,n)=>(C(),ae("div",ze,[n[7]||(n[7]=o("div",{class:"section-header"},[o("h2",null,"Activities")],-1)),a(e(Se),null,{default:s(()=>[a(e(j),null,{default:s(()=>[a(e(Y),{size:"6"},{default:s(()=>[a(e(F),{button:"",onClick:w,class:"activity-card admit-card"},{default:s(()=>[A.value?(C(),se(e(be),{key:0,class:"admit-badge",color:"primary"},{default:s(()=>[N(m(A.value),1)]),_:1})):q("",!0),a(e(W),{class:"card-content"},{default:s(()=>[o("div",Xe,[a(e(H),{src:e(X).patientProfile.cryBaby,alt:"Admit",class:"activity-icon"},null,8,["src"])]),a(e(z),{class:"card-label"},{default:s(()=>[...n[3]||(n[3]=[o("p",null,"Clinical Review",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(Y),{size:"6"},{default:s(()=>[a(e(F),{button:"",onClick:n[0]||(n[0]=i=>b("discharge")),class:"activity-card"},{default:s(()=>[a(e(W),{class:"card-content"},{default:s(()=>[o("div",qe,[a(e(H),{src:e(X).patientProfile.babyTransport,alt:"Discharge",class:"activity-icon"},null,8,["src"])]),a(e(z),{class:"card-label"},{default:s(()=>[...n[4]||(n[4]=[o("p",null,"Discharge",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(e(j),null,{default:s(()=>[a(e(Y),{size:"6"},{default:s(()=>[a(e(F),{button:"",onClick:n[1]||(n[1]=i=>b("in-patient")),class:"activity-card"},{default:s(()=>[a(e(W),{class:"card-content"},{default:s(()=>[o("div",Ke,[a(e(H),{src:e(X).patientProfile.medClinic,alt:"Clinical Review",class:"activity-icon"},null,8,["src"])]),a(e(z),{class:"card-label"},{default:s(()=>[...n[5]||(n[5]=[o("p",null,"In-Patient",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n[8]||(n[8]=o("div",{class:"section-header",style:{"margin-top":"24px"}},[o("h2",null,"Quick Actions")],-1)),a(e(Se),null,{default:s(()=>[a(e(j),null,{default:s(()=>[a(e(Y),{size:"6"},{default:s(()=>[a(e(F),{button:"",onClick:n[2]||(n[2]=i=>b("instruction-guides")),class:"activity-card"},{default:s(()=>[a(e(W),{class:"card-content"},{default:s(()=>[o("div",Qe,[a(e(H),{src:e(X).patientProfile.info,alt:"Instruction Guides",class:"activity-icon"},null,8,["src"])]),a(e(z),{class:"card-label"},{default:s(()=>[...n[6]||(n[6]=[o("p",null,"Instruction Guides",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}}),je=Le(Je,[["__scopeId","data-v-0f9809b1"]]),Ze={class:"profile-container"},et={class:"profile-wrapper"},tt={class:"demographics-card"},nt={class:"profile-content"},at={class:"avatar-section"},st={class:"info-section"},ot={class:"name-row"},rt={class:"patient-name"},it={class:"name-line"},lt={class:"name-line"},ut={class:"meta-row"},ct={key:0,class:"detail-row"},dt={class:"field-value scrollable-address"},mt={class:"detail-row"},pt={class:"field-value"},ft={class:"detail-row"},vt={class:"graphSection"},Nt={style:{width:"100%","min-width":"0"}},At={class:"ion-padding",slot:"content"},St=Te({__name:"NeonatalPatientProfile",setup(Ce){const p=_e(),{event:K,popoverOpen:f,openPopover:_,openPIM:A,printVisitSummary:b,printID:d,formatCurrentAddress:v}=Ge(),G=y(!1),S=y(7),Q=y([]),J=y([]),B=y([]),V=Ie(()=>{switch(S.value){case 7:return"Admitted";case 6:return"Discharged";case 3:return"Died";default:return"Unknown"}}),U=Ie(()=>{switch(S.value){case 7:return"status-admitted";case 6:return"status-discharged";case 3:return"status-died";default:return"status-unknown"}}),$=ye(),{patient:u}=he($),w=async r=>{S.value=r},l=()=>{var t,E;if(!((E=(t=u.value)==null?void 0:t.personInformation)!=null&&E.birthdate))return!1;const r=h.dateDiffInDays(h.sessionDate(),u.value.personInformation.birthdate);return r>=0&&r<=28},n=async()=>{if(!l()){await Ue($e,{class:"small-confirm-modal"},!0,{title:"Redirection",message:"Patient is not a neonate, redirecting to home"}),p.push("/home");return}},i=async()=>{try{const r=await Ye.getLabResults(u.value);B.value=(r==null?void 0:r.results)||[]}catch(r){console.error("Error fetching lab results:",r),B.value=[]}},I=async()=>{var r;J.value=await Fe.getJson("/hts_referral_orders",{patient_id:(r=u.value)==null?void 0:r.patientID,filter_by_lab_result:!0})},M=async()=>{var t;const r=await We.getObsByEncounterId(O.REFERRAL);Q.value=((t=r[0])==null?void 0:t.obs)||[]},L=r=>h.calculateDisplayAge(h.toStandardHisFormat(r)),k=()=>{var r,t,E,R;xe.isEmpty((t=(r=u.value)==null?void 0:r.personInformation)==null?void 0:t.birthdate)||(G.value=h.dateDiffInDays(h.sessionDate(),(R=(E=u.value)==null?void 0:E.personInformation)==null?void 0:R.birthdate)<42)},D=()=>!!new He().isUnderFive(),c=()=>{var r,t;return h.toStandardHisDisplayFormat((t=(r=u.value)==null?void 0:r.personInformation)==null?void 0:t.birthdate)};return ne(()=>p.currentRoute.value,async r=>{(r.name=="patientProfile"||r.name=="neonatalPatientProfile")&&u.value.patientID&&await n()}),ne(()=>{var r;return(r=u.value)==null?void 0:r.patientID},async(r,t)=>{r&&t!==void 0&&r!==t&&(k(),await n(),await i(),await I())}),Oe(async()=>{k(),await n(),await M(),await I(),await i()}),(r,t)=>{var R,oe,re,ie,le,ue,ce,de,me,pe,fe,ve,Ne,Ae;const E=we("ion-icon");return C(),ae("div",Ze,[o("div",et,[o("div",tt,[o("div",nt,[o("div",at,[o("div",{class:Ee(["avatar-box",((oe=(R=e(u))==null?void 0:R.personInformation)==null?void 0:oe.gender)=="M"?"male-avatar":"female-avatar"])},[a(E,{icon:e(Me),class:"avatar-icon"},null,8,["icon"])],2)]),o("div",st,[o("div",ot,[o("h2",rt,[o("span",it,m((ie=(re=e(u))==null?void 0:re.personInformation)==null?void 0:ie.given_name)+" "+m((ue=(le=e(u))==null?void 0:le.personInformation)==null?void 0:ue.middle_name),1),o("span",lt,m((de=(ce=e(u))==null?void 0:ce.personInformation)==null?void 0:de.family_name),1)]),o("div",{class:"menu-trigger",onClick:t[0]||(t[0]=g=>e(_)(g))},[a(E,{icon:e(ke)},null,8,["icon"])])]),o("div",ut,[o("span",null,m(((pe=(me=e(u))==null?void 0:me.personInformation)==null?void 0:pe.gender)=="M"?"Male":"Female"),1),t[9]||(t[9]=o("span",{class:"separator"},"•",-1)),o("span",null,m(L((ve=(fe=e(u))==null?void 0:fe.personInformation)==null?void 0:ve.birthdate))+" old",1),t[10]||(t[10]=o("span",{class:"separator"},"•",-1)),o("span",null,m(c()),1)]),(Ae=(Ne=e(u))==null?void 0:Ne.personInformation)!=null&&Ae.current_district?(C(),ae("div",ct,[t[11]||(t[11]=o("span",{class:"field-label"},"Current Address:",-1)),o("span",dt,m(e(v)(e(u))),1)])):q("",!0),o("div",mt,[t[12]||(t[12]=o("span",{class:"field-label"},"MRN:",-1)),o("span",pt,m(e(u).ID),1)]),o("div",ft,[t[13]||(t[13]=o("span",{class:"field-label"},"Outcome:",-1)),o("span",{class:Ee(["outcome-badge",U.value])},m(V.value),3)])])])]),o("div",vt,[o("div",Nt,[D()?(C(),se(Be,{key:0,checkUnderSixWeeks:G.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):q("",!0),D()?q("",!0):(C(),se(Ve,{key:1}))])]),a(je),a(e(Pe),{class:"menu-popover","is-open":e(f),"show-backdrop":!1,event:e(K),onDidDismiss:t[8]||(t[8]=g=>f.value=!1)},{default:s(()=>[o("div",null,[a(e(De),{multiple:!0},{default:s(()=>[a(e(P),{value:"first","toggle-icon":"",onClick:t[1]||(t[1]=g=>e(A)())},{default:s(()=>[a(e(T),{slot:"header",color:"light"},{default:s(()=>[a(e(x),null,{default:s(()=>[...t[14]||(t[14]=[N("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),a(e(P),{value:"first","toggle-icon":"",onClick:t[2]||(t[2]=()=>{})},{default:s(()=>[a(e(T),{slot:"header",color:"light"},{default:s(()=>[a(e(x),null,{default:s(()=>[...t[15]||(t[15]=[N("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),a(e(P),{value:"second","toggle-icon":"",onClick:t[3]||(t[3]=g=>e(b)())},{default:s(()=>[a(e(T),{slot:"header",color:"light"},{default:s(()=>[a(e(x),null,{default:s(()=>[...t[16]||(t[16]=[N("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),a(e(P),{value:"third","toggle-icon":"",onClick:t[4]||(t[4]=g=>e(d)())},{default:s(()=>[a(e(T),{slot:"header",color:"light"},{default:s(()=>[a(e(x),null,{default:s(()=>[...t[17]||(t[17]=[N("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),a(e(P),{value:"fourth"},{default:s(()=>[a(e(T),{slot:"header",color:"light"},{default:s(()=>[a(e(x),null,{default:s(()=>[...t[18]||(t[18]=[N("Update outcome",-1)])]),_:1})]),_:1}),o("div",At,[a(e(Re),null,{default:s(()=>[a(e(T),null,{default:s(()=>[a(e(Z),{checked:S.value==7,value:"active",onIonChange:t[5]||(t[5]=g=>w(7))},{default:s(()=>[...t[19]||(t[19]=[N(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),a(e(T),null,{default:s(()=>[a(e(Z),{checked:S.value==6,value:"inactive",onIonChange:t[6]||(t[6]=g=>w(6))},{default:s(()=>[...t[20]||(t[20]=[N(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),a(e(T),null,{default:s(()=>[a(e(Z),{checked:S.value==3,value:"died",onIonChange:t[7]||(t[7]=g=>w(3))},{default:s(()=>[...t[21]||(t[21]=[N(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])])}}}),$t=Le(St,[["__scopeId","data-v-e6464fda"]]);export{$t as default};
