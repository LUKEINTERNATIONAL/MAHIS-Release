System.register(["./vendor-legacy-h4cyiMXU.js","../index-legacy-BOBcaga6.js","./patient_diagnosis_service-legacy-CsLrAQT7.js","./DashBox-legacy-MhQb1IdE.js","./lodash-legacy-pOOc9Efu.js"],function(e,a){"use strict";var i,t,n,o,s,l,d,r,c,u,p,g,v,m,h,y,f,b,D,_,x,I,k,w,S,B,C,F,M,H,T,A,P,E,O,L,$,j,z,N,G,V,W,J,R,q;return{setters:[e=>{i=e.d,t=e.af,n=e.G,o=e.E,s=e.ag,l=e.ah,d=e.a6,r=e.I,c=e.ab,u=e.R,p=e.bb,g=e.aU,v=e.H,m=e.e,h=e.f,y=e.k,f=e.l,b=e.r,D=e.c,_=e.w,x=e.a,I=e.m,k=e.O,w=e.J,S=e.u,B=e.Q,C=e.F},e=>{F=e.aZ,M=e.H,H=e.J,T=e.a$,A=e.a_,P=e.u,E=e._,O=e.bV,L=e.x,$=e.n,j=e.z,z=e.D,N=e.S,G=e.w,V=e.b,W=e.F},e=>{J=e.P},e=>{R=e.D},e=>{q=e.l}],execute:function(){var a=document.createElement("style");a.textContent=".bmi_blood[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:190px}.graphBtn[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:90px}._active[data-v-88580898]{background-color:#ded;color:#006401;padding:5px;border-radius:4px}.iconBg[data-v-88580898]{background:#ded;padding:2px;border-radius:5px}#container[data-v-5b47889c]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-5b47889c]{font-size:20px;line-height:26px}#container p[data-v-5b47889c]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-5b47889c]{text-decoration:none}.action_buttons[data-v-5b47889c]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-5b47889c]{padding-left:20px}.item_no_border[data-v-5b47889c]{--border-color: transparent}.search_result[data-v-5b47889c]{padding:10px}.previousView[data-v-5b47889c]{margin-top:70px;margin-bottom:20px}\n/*$vite$:1*/",document.head.appendChild(a);const Q=i({name:"Menu",components:{IonContent:c,IonHeader:r,IonItem:d,IonList:l,IonMenu:s,IonTitle:o,IonToolbar:n,List:F},computed:{...t(P,["patient"])},data:()=>({valueNumericArray:[],obsDatetime:[],graphIcon:A(["#006401"]),listIcon:T(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}),setup:()=>({checkmark:g,pulseOutline:p}),async mounted(){const e=[...await H.getAll(this.patient.patientID,"Primary diagnosis")||[],...await H.getAll(this.patient.patientID,"Secondary diagnosis")||[],...await H.getAll(this.patient.patientID,"Attempted/ Differential diagnosis")||[]],a=q.isEmpty(e)?[]:Promise.all(e.map(async e=>({name:await H.getConceptName(e.value_coded),obs_date:e.obs_datetime})));this.setListData(await a)},methods:{dismiss(){u.dismiss()},handleIcon(){},setActivClass(e){this.activeHeight="",this.activeBMI="",this.activeWeight="","height"==e?this.activeHeight="_active":"weight"==e?this.activeWeight="_active":"BMI"==e&&(this.activeBMI="_active")},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),e.forEach(e=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[M.toStandardHisFormat(e.obs_date),e.name,""]})})}}}),U={class:"modal_wrapper"},Y=E(Q,[["render",function(e,a,i,t,n,o){const s=v("list");return h(),m("div",U,[y("div",null,[f(s,{listData:e.list},null,8,["listData"])])])}],["__scopeId","data-v-88580898"]]),Z={class:"custom_card",style:{padding:"10px"}},K={key:0},X={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},ee={style:{width:"100%"}},ae={class:"ion-padding",slot:"content"};e("O",E(i({__name:"OPDDiagnosis",setup(e,{expose:a}){const i=$,t=b(!0),n=b(!1),o=b(!0),s=b(!1),l=b(!0),r=b(""),c=b(""),u=b([]),p=b([]),g=b(),M=b(null);O();const T=D(()=>p.value.some(e=>6542===e.data.concept_id));_(p,()=>{U()},{deep:!0});const A=D(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",trackBy:"name",options:u.value,icon:i.search,onSearchChange:q,validation:L.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",trackBy:"name",componentType:"multiSelectInputField",isMultiple:!0,options:u.value,icon:i.search,condition:e=>null==e?void 0:e.secondaryDiagnosisCheckbox,onSearchChange:q,validation:(e,a)=>P(a,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",trackBy:"name",componentType:"multiSelectInputField",options:u.value,icon:i.search,isMultiple:!0,condition:e=>null==e?void 0:e.differentialDiagnosisCheckbox,onSearchChange:q,validation:(e,a)=>P(a,"differentialDiagnosis")}]),P=(e,a)=>{var i,t,n;if(!e)return null;const o=null===(i=e.primaryDiagnosis)||void 0===i?void 0:i.name,s=(null===(t=e.secondaryDiagnosis)||void 0===t?void 0:t.map(e=>e.name))||[],l=(null===(n=e.differentialDiagnosis)||void 0===n?void 0:n.map(e=>e.name))||[];if("secondaryDiagnosis"===a&&s.includes(o))return`${o} is already the primary diagnosis`;if("differentialDiagnosis"===a&&l.includes(o))return`${o} is already the primary diagnosis`;const d=s.find(e=>l.includes(e));return d?`${d} cannot be both secondary and differential`:null},E=()=>{var e;const a=[],i=p.value.map(e=>e.name),t=(null===(e=M.value)||void 0===e?void 0:e.getFormValues())||{},n=t.primaryDiagnosis||[],o=t.secondaryDiagnosis||[],s=t.differentialDiagnosis||[];if(n.name&&!i.includes(n.name)){if(p.value.some(e=>6542===e.data.concept_id))return G("Only one primary diagnosis is allowed"),!1;a.push({actionBtn:!0,btn:["delete"],name:n.name,id:n.concept_id,display:[n.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:n.concept_id,obs_datetime:N.getSessionDate()}})}return o&&o.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:e.concept_id,obs_datetime:N.getSessionDate()}})}),s&&s.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:e.concept_id,obs_datetime:N.getSessionDate()}})}),a.length>0&&(p.value=[...p.value,...a]),!0},q=async e=>{const a=e.trim().toLowerCase()||"";return u.value=await J.getDiagnosis(a,1,15),u.value},Q=e=>{const a=p.value,i=e.name,t=a.filter(e=>e.display[0]!==i);p.value=t},U=()=>{p.value.length>0?(s.value=!0,t.value=!1):n.value||(t.value=!0),l.value=!T.value};return x(async()=>{U(),await q("")}),a({onSubmit:async()=>{if(p.value.length<=0)return;const e=p.value.flatMap(e=>e.data);e.length<=0||(await H.addObsToEncounterPatient(e,V.DIAGNOSIS),W("Diagnosis saved successful"),p.value=[])}}),(e,a)=>{const u=v("ion-row"),b=v("ion-label"),D=v("ion-accordion"),_=v("ion-accordion-group");return h(),m(C,null,[y("div",Z,[f(R,{status:t.value,content:"No Diagnosis added"},null,8,["status"]),s.value?(h(),m("span",K,[f(F,{listData:p.value,"onClicked:delete":Q},null,8,["listData"]),T.value?(h(),m("div",X," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):I("",!0)])):I("",!0),n.value?(h(),k(u,{key:1},{default:w(()=>{var e;return[y("div",ee,[f(j,{formData:A.value,ref_key:"formRef",ref:M},null,8,["formData"])]),y("div",null,[f(z,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[0]||(a[0]=e=>(async()=>{var e;null==(null===(e=M.value)||void 0===e?void 0:e.validateForm())&&(E(),n.value=!1,s.value=!0,l.value=!0,o.value=!1)})()),name:"Save",disabled:null===(e=M.value)||void 0===e?void 0:e.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):I("",!0),l.value?(h(),k(u,{key:2,style:{"margin-top":"10px"}},{default:w(()=>[f(z,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[1]||(a[1]=e=>(c.value="",r.value="",t.value=!1,l.value=!1,void(n.value=!0))),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):I("",!0)]),f(u,null,{default:w(()=>[f(_,{ref_key:"accordionGroup",ref:g,class:"previousView"},{default:w(()=>[f(D,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:w(()=>[f(S(d),{slot:"header",color:"light"},{default:w(()=>[f(b,{class:"previousLabel"},{default:w(()=>[...a[2]||(a[2]=[B("Previous Diagnosis",-1)])]),_:1})]),_:1}),y("div",ae,[f(Y)])]),_:1})]),_:1},512)]),_:1})],64)}}}),[["__scopeId","data-v-5b47889c"]]))}}});
