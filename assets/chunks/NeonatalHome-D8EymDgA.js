var Pe=Object.defineProperty;var ze=(n,d,c)=>d in n?Pe(n,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[d]=c;var O=(n,d,c)=>ze(n,typeof d!="symbol"?d+"":d,c);import{d as T,O as k,f as r,u as a,bq as U,p as P,J as m,l as o,aU as K,k as i,e as g,m as _e,K as b,c as j,Q as q,bi as Ee,I as Re,G as Fe,E as He,a_ as Oe,N as je,L as qe,aS as Ge,a3 as ve,j as Ue,ao as Ke,r as M,a as Qe,a4 as me,F as L,P as p,a5 as ge,bm as fe,dS as B,a6 as We}from"./vendor-hvlGrBh_.js";import{_ as A,u as Je,T as Xe}from"../index-PgsDW9mu.js";import{N as Ye}from"./neonatal_service-BcUDlw5D.js";import{I as C}from"./images-DJIykHYW.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BtPTSgal.js";const I=class I{constructor(){O(this,"statusColorMap",{admitted:"primary",discharged:"success",critical:"warning"})}getStatusColor(d){var c;return(c=this.statusColorMap[d.toLowerCase()])!=null?c:"medium"}formatWeight(d){return"".concat((d/1e3).toFixed(2)," kg")}static getInstance(){return I.instance||(I.instance=new I),I.instance}};O(I,"instance");let G=I;const Ze=G.getInstance(),E=[{label:"Triaged without Registration",key:"triage_only",iconSrc:C.icons.triaged},{label:"Admitted Today",key:"admitted",iconSrc:C.icons.newborn},{label:"Discharged Today",key:"discharged",iconSrc:C.icons.babyCarriage},{label:"Critical",key:"critical",iconSrc:C.icons.warningSign,isCritical:!0}],Ve=[{label:"Start Emergency Triage",iconSrc:C.icons.electrocardiogram,iconClass:"emergency-icon",route:"/neonatal/triage",query:{source:"dashboard"}},{label:"Instruction Guides",iconSrc:C.icons.info,route:"/neonatal/guides"}],ye={class:"stat-icon-wrapper"},et=["innerHTML"],tt=["src","alt"],st={class:"stat-label"},nt=T({__name:"card",props:{label:{},value:{},iconSrc:{},svgIcon:{},isCritical:{type:Boolean},clickable:{type:Boolean}},emits:["click"],setup(n,{emit:d}){const c=n,v=d,f=()=>{c.clickable&&v("click")};return(_,$)=>(r(),k(a(U),{class:P(["stat-card",{"is-clickable":n.clickable}]),onClick:f},{default:m(()=>[o(a(K),{class:"stat-content"},{default:m(()=>[i("div",ye,[n.svgIcon?(r(),g("div",{key:0,innerHTML:n.svgIcon,class:"stat-icon"},null,8,et)):n.iconSrc?(r(),g("img",{key:1,src:n.iconSrc,class:"stat-icon critical-icon",alt:n.label},null,8,tt)):_e("",!0)]),i("div",st,b(n.label),1),i("div",{class:P(["stat-value",{"critical-value":n.isCritical}])},b(n.value),3)]),_:1})]),_:1},8,["class"]))}}),at=A(nt,[["__scopeId","data-v-de1dedbc"]]),it={class:"action-icon-wrapper"},ot=["innerHTML"],ct=["src","alt"],lt={class:"action-label"},rt=T({__name:"action-card",props:{label:{},svgIcon:{},iconSrc:{},iconClass:{}},emits:["click"],setup(n,{emit:d}){const c=d,v=()=>{c("click")};return(f,_)=>(r(),k(a(U),{class:"action-card",onClick:v},{default:m(()=>[o(a(K),{class:"action-content"},{default:m(()=>[i("div",it,[n.svgIcon?(r(),g("div",{key:0,innerHTML:n.svgIcon,class:P(["action-icon",n.iconClass])},null,10,ot)):n.iconSrc?(r(),g("img",{key:1,src:n.iconSrc,class:P(["action-icon",n.iconClass]),alt:n.label},null,10,ct)):_e("",!0)]),i("div",lt,b(n.label),1)]),_:1})]),_:1}))}}),ut=A(rt,[["__scopeId","data-v-fc22b927"]]),dt={class:"neonate-info"},mt={class:"neonate-name"},gt={class:"neonate-mrn"},ft={class:"neonate-details"},ht={class:"detail-item"},_t=["src"],vt={class:"detail-item"},bt=["src"],kt={class:"neonate-status"},Ct=T({__name:"neonate-card",props:{neonate:{},getStatusColor:{type:Function}},emits:["click"],setup(n,{emit:d}){const c=n,v=d,f=j(()=>c.getStatusColor(c.neonate.status)),_=()=>{v("click",c.neonate.id,c.neonate.status)};return($,x)=>(r(),k(a(U),{class:"neonate-card",onClick:_},{default:m(()=>[o(a(K),{class:"neonate-content"},{default:m(()=>[i("div",dt,[i("div",mt,b(n.neonate.name),1),i("div",gt,b(n.neonate.mrn),1),i("div",ft,[i("span",ht,[i("img",{src:a(C).icons.deliveryTime,class:"detail-icon"},null,8,_t),q(" "+b(n.neonate.age),1)]),i("span",vt,[i("img",{src:a(C).icons.babyWeight,class:"detail-icon"},null,8,bt),q(" "+b(n.neonate.weight),1)])])]),i("div",kt,[i("div",{class:P(["status-badge","status-".concat(f.value)])},b(n.neonate.status),3)])]),_:1})]),_:1}))}}),he=A(Ct,[["__scopeId","data-v-1d7d32b4"]]),St={class:"drilldown-content"},$t={key:0,class:"empty-drilldown"},It={key:1,class:"drilldown-list"},wt=T({__name:"DrilldownModal",props:{isOpen:{type:Boolean},title:{},isEmpty:{type:Boolean,default:!1},emptyMessage:{default:"No items available."}},emits:["close","dismiss"],setup(n,{emit:d}){const c=d,v=Ge,f=()=>{c("close")},_=()=>{c("dismiss")};return($,x)=>(r(),k(a(Ee),{"is-open":n.isOpen,onDidDismiss:_,class:"drilldown-modal"},{default:m(()=>[o(a(Re),null,{default:m(()=>[o(a(Fe),null,{default:m(()=>[o(a(He),null,{default:m(()=>[q(b(n.title),1)]),_:1}),o(a(Oe),{slot:"end"},{default:m(()=>[o(a(je),{fill:"clear",onClick:f},{default:m(()=>[o(a(qe),{slot:"icon-only",icon:a(v)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(a(ve),null,{default:m(()=>[i("div",St,[n.isEmpty?(r(),g("div",$t,b(n.emptyMessage),1)):(r(),g("div",It,[Ue($.$slots,"default",{},void 0,!0)]))])]),_:3})]),_:3},8,["is-open"]))}}),Nt=A(wt,[["__scopeId","data-v-912ed09a"]]),Tt={class:"neonatal-dashboard"},At={class:"header-image"},xt=["src"],Dt={class:"section-container"},Mt={class:"section-container"},Lt={class:"section-container"},pt={key:0,class:"neonates-list"},Bt={class:"skeleton-content"},Pt={key:1,class:"neonates-list"},zt={key:2,class:"empty-neonates"},Et=T({__name:"LandingPage",setup(n){const d={enrolled:"In patient",admitted:"Admitted",discharged:"Discharged",critical:"Critical",triage_only:"Triaged"},c=()=>E.reduce((e,t)=>(e[t.key]={count:0,neonates:[]},e),{}),v=Ke(),f=M(c()),_=M([]),$=M(!0),x=M(!1),w=M(null),z=j(()=>{var e,t;return w.value?(t=(e=f.value[w.value])==null?void 0:e.neonates)!=null?t:[]:[]}),be=e=>{var t,s;return e&&(s=(t=E.find(l=>l.key===e))==null?void 0:t.label)!=null?s:"Neonates"},ke=j(()=>{const e=be(w.value);return z.value.length?"".concat(e," (").concat(z.value.length,")"):e}),Ce=e=>{var t,s;return(s=(t=f.value[e])==null?void 0:t.count)!=null?s:0},Q=e=>{var t,s;return((s=(t=f.value[e])==null?void 0:t.neonates.length)!=null?s:0)>0},Se=e=>{Q(e)&&(w.value=e,x.value=!0)},W=()=>{x.value=!1,w.value=null},$e=e=>{v.push({path:e.route,query:e.query})},R=e=>{v.push({path:e})},J=async(e,t)=>{try{await Je().setPatientRecord({patientID:Number(e)}),R(t==="Triaged"?"/registration/manual?patientID=".concat(e):"/patientProfile?id=".concat(e))}catch(s){console.error("[NeonatalLanding] Failed to load patient:",s),R("/patientProfile?id=".concat(e))}},X=e=>Ze.getStatusColor(e),Ie=async()=>{try{$.value=!0;const e=await Ye.getStatistics();f.value=we(e),e.recent_neonates&&Array.isArray(e.recent_neonates)?_.value=e.recent_neonates.map(t=>({id:String(t.id||t.patient_id||""),name:t.name||"Unknown Neonate",mrn:t.mrn||"N/A",age:t.age||"—",weight:t.weight||"—",status:t.status||"In patient"})):De()}catch(e){console.error("[NeonatalLanding] Failed to load statistics",e),f.value=c(),_.value=[]}finally{$.value=!1}},we=e=>{const t=c();return E.forEach(s=>{var S,N;const l=s.key,h=(N=e==null?void 0:e[l])!=null?N:(S=e==null?void 0:e.stats)==null?void 0:S[l],u=Ne(e,l);t[l]=Te(h,u,l)}),t},Ne=(e,t)=>{var l,h,u,S,N;return e?(N=[(l=e==null?void 0:e.neonates)==null?void 0:l[t],(h=e==null?void 0:e.details)==null?void 0:h[t],e==null?void 0:e["".concat(t,"_neonates")],e==null?void 0:e["".concat(t,"_patients")],e==null?void 0:e["".concat(t,"_records")],(u=e==null?void 0:e[t])==null?void 0:u.neonates,(S=e==null?void 0:e[t])==null?void 0:S.patients].find(H=>Array.isArray(H)))!=null?N:[]:[]},Te=(e,t,s)=>{if(typeof e=="number")return{count:e,neonates:F(t,s)};if(e&&typeof e=="object"){const h=Array.isArray(e.neonates)?e.neonates:Array.isArray(e.patients)?e.patients:t,u=F(h,s);return{count:typeof e.count=="number"?e.count:typeof e.total=="number"?e.total:typeof e.value=="number"?e.value:u.length,neonates:u}}const l=F(t,s);return{count:l.length,neonates:l}},F=(e,t)=>Array.isArray(e)?e.map((s,l)=>Ae(s,t,l)):[],Ae=(e,t,s)=>{var Y,Z,V,y,ee,te,se,ne,ae,ie,oe,ce,le,re,ue,de;const l=d[t],h="".concat(t,"-").concat(s);if(e!=null&&e.name&&(e!=null&&e.mrn))return{id:String((Y=e.id)!=null?Y:h),name:e.name,mrn:e.mrn,age:(Z=e.age)!=null?Z:"—",weight:(V=e.weight)!=null?V:"—",status:(y=e.status)!=null?y:l};const u=(ee=e==null?void 0:e.patient)!=null?ee:e,S=(ne=(se=(te=e==null?void 0:e.id)!=null?te:e==null?void 0:e.patient_id)!=null?se:u==null?void 0:u.patient_id)!=null?ne:h,H=[e==null?void 0:e.name,u==null?void 0:u.given_name,u==null?void 0:u.family_name].filter(Boolean).join(" ").trim()||"Unknown Neonate",Me=(oe=(ie=(ae=e==null?void 0:e.mrn)!=null?ae:e==null?void 0:e.identifier)!=null?ie:u==null?void 0:u.identifier)!=null?oe:"N/A",Le=(le=(ce=e==null?void 0:e.age)!=null?ce:xe(u==null?void 0:u.birthdate))!=null?le:"—",D=(ue=(re=e==null?void 0:e.weight)!=null?re:e==null?void 0:e.latest_weight)!=null?ue:e==null?void 0:e.weight_kg,pe=typeof D=="number"?"".concat(D.toFixed(2)," Kg"):D!=null?D:"—",Be=(de=e==null?void 0:e.status)!=null?de:l;return{id:String(S),name:H,mrn:Me,age:Le,weight:pe,status:Be}},xe=e=>{if(!e)return null;const t=new Date(e);if(Number.isNaN(t.getTime()))return null;const s=Date.now()-t.getTime(),l=Math.floor(s/(1e3*60*60));if(l<24)return"".concat(l," hrs old");const h=Math.floor(l/24);return h<1?"Today":"".concat(h," day").concat(h===1?"":"s"," old")},De=()=>{const e=Object.values(f.value).flatMap(t=>t.neonates).slice(0,5);_.value=e};return Qe(()=>{Ie()}),(e,t)=>(r(),g("div",Tt,[i("div",At,[i("img",{src:a(C).banners.babyHand,alt:"baby-hand-banner",style:{"object-fit":"cover"}},null,8,xt)]),i("div",Dt,[t[0]||(t[0]=i("h2",{class:"section-title"},"Today's Stats",-1)),o(a(fe),{class:"stats-grid"},{default:m(()=>[o(a(me),null,{default:m(()=>[(r(!0),g(L,null,p(a(E),s=>(r(),k(a(ge),{key:s.key,size:"6","size-md":"3"},{default:m(()=>[o(at,{label:s.label,value:Ce(s.key),"icon-src":s.iconSrc,"svg-icon":s.svgIcon,"is-critical":s.isCritical,clickable:Q(s.key),onClick:l=>Se(s.key)},null,8,["label","value","icon-src","svg-icon","is-critical","clickable","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),i("div",Mt,[t[1]||(t[1]=i("h2",{class:"section-title"},"Quick Actions",-1)),o(a(fe),{class:"actions-grid"},{default:m(()=>[o(a(me),null,{default:m(()=>[(r(!0),g(L,null,p(a(Ve),s=>(r(),k(a(ge),{key:s.route,size:"6","size-md":"6"},{default:m(()=>[o(ut,{label:s.label,"svg-icon":s.svgIcon,"icon-src":s.iconSrc,"icon-class":s.iconClass,onClick:l=>$e(s)},null,8,["label","svg-icon","icon-src","icon-class","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),i("div",Lt,[t[2]||(t[2]=i("h2",{class:"section-title"},"Recent Neonates",-1)),$.value?(r(),g("div",pt,[(r(),g(L,null,p(5,s=>i("div",{key:"skeleton-".concat(s),class:"neonate-skeleton"},[o(a(B),{animated:!0,style:{width:"60px",height:"60px","border-radius":"50%"}}),i("div",Bt,[o(a(B),{animated:!0,style:{width:"70%",height:"20px","margin-bottom":"8px"}}),o(a(B),{animated:!0,style:{width:"50%",height:"16px","margin-bottom":"4px"}}),o(a(B),{animated:!0,style:{width:"40%",height:"16px"}})]),o(a(B),{animated:!0,style:{width:"80px",height:"24px","border-radius":"12px"}})])),64))])):_.value.length?(r(),g("div",Pt,[(r(!0),g(L,null,p(_.value,s=>(r(),k(he,{key:s.id,neonate:s,"get-status-color":X,onClick:J},null,8,["neonate"]))),128))])):(r(),g("div",zt,"No recent neonates to display."))]),o(Nt,{"is-open":x.value,title:ke.value,"is-empty":!z.value.length,"empty-message":"No neonates available for this statistic.",onClose:W,onDismiss:W},{default:m(()=>[(r(!0),g(L,null,p(z.value,s=>(r(),k(he,{key:"".concat(w.value,"-").concat(s.id),neonate:s,"get-status-color":X,onClick:J},null,8,["neonate"]))),128))]),_:1},8,["is-open","title","is-empty"])]))}}),Rt=A(Et,[["__scopeId","data-v-8ed8dd68"]]),Ft=T({__name:"NeonatalHome",setup(n){return(d,c)=>(r(),k(a(We),null,{default:m(()=>[o(Xe),o(a(ve),{fullscreen:!0},{default:m(()=>[o(Rt)]),_:1})]),_:1}))}}),Qt=A(Ft,[["__scopeId","data-v-052dae1c"]]);export{Qt as default};
