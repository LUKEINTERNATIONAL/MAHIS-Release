import{bH as k,n as i,x as n,u as B,z as _,l as I,t as R,J as P,b as A,I as W,F as D,_ as N}from"../index-DK7ddGbV.js";import{r as S,c as v,d as E,b2 as j,w as L,a as V,n as p,b as z,e as G,f as F,O as J,l as h,J as y,u as f,aj as K,ai as Q,k as U,a6 as $,a2 as q,Q as X,ac as Y,F as Z}from"./vendor-Do1wNTJR.js";const ee=()=>{const a=k(),d=S(""),e=S(!1),c=async()=>{const t=await a.checkHeight();t&&t!=""&&t!="0"?(d.value=t,e.value=!0):(d.value="",e.value=!1)},T=()=>{d.value="",e.value=!1},w=v(()=>[{componentType:"Heading",name:"Height and weight",grid:{s:"3"}},{componentType:"inputField",name:"height",header:"Height",unit:"cm",type:"number",icon:i.height,value:d.value||"",grid:{s:"4.5"},validation:(t,r)=>r!=null&&r["Check height not done"]||e.value?null:n.vitalsHeight(t),disabled:t=>t["Check height not done"]||e.value},{componentType:"inputField",name:"weight",header:"Weight",unit:"kg",icon:i.weight,type:"number",grid:{s:"4.5"},validation:(t,r)=>r!=null&&r["Check weight not done"]?null:n.vitalsWeight(t),disabled:t=>t["Check weight not done"]},{grid:{s:"3"}},{componentType:"Alert",condition:async t=>n.vitalsWeight(t.weight)==null&&n.vitalsHeight(t.height)==null?await a.setBMI(t.height,t.weight):!1,grid:{s:"9"}},{grid:{s:"3"}},{componentType:"checkboxField",name:"Check height not done",type:"single",label:"Height not done",value:!1,grid:{s:"4.5"},disabled:t=>e.value,onChange:(t,r)=>{if(t===!0)return{height:""}}},{componentType:"checkboxField",name:"Check weight not done",type:"single",label:"Weight not done",value:!1,grid:{s:"4.5"},onChange:(t,r)=>{if(t===!0)return{weight:""}}},{grid:{s:"3"}},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:t=>t["Check height not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:t=>t["Check weight not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0}]);return{height:d,isHeightPreLoaded:e,loadHeight:c,resetHeight:T,heightWeightFormSection:w}},te=()=>{const a=k();return{bloodPressureFormSection:v(()=>[{componentType:"Heading",name:"Blood pressure",grid:{s:"3"}},{componentType:"inputField",name:"Systolic",header:"Systolic Pressure",unit:"mmHg",type:"number",icon:i.systolicPressure,grid:{s:"4.5"},validation:e=>n.vitalsSystolic(e),disabled:e=>e["Check blood pressure not done"]},{componentType:"inputField",name:"Diastolic",header:"Diastolic pressure",unit:"mmHg",icon:i.diastolicPressure,type:"number",grid:{s:"4.5"},validation:e=>n.vitalsDiastolic(e),disabled:e=>e["Check blood pressure not done"]},{grid:{s:"3"}},{componentType:"Alert",grid:{s:"9"},condition:async e=>n.vitalsSystolic(e.Systolic)==null&&n.vitalsDiastolic(e.Diastolic)==null?await a.updateBP(e.Systolic,e.Diastolic):!1},{grid:{s:"3"}},{componentType:"checkboxField",name:"Check blood pressure not done",type:"single",label:"Blood pressure not done",value:"",grid:{s:"4.5"}},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Blood Pressure",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:e=>e["Check blood pressure not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0}])}},ne=()=>{const a=k();return{temperaturePulseRateForm:v(()=>[{componentType:"Heading",name:"Temperature and rates",grid:{s:"3"}},{componentType:"inputField",name:"Temperature",header:"Temperature",unit:"°C",type:"number",icon:i.temprature,grid:{s:"4.5"},validation:e=>n.vitalsTemperature(e),disabled:e=>e["Check temperature not done"]},{componentType:"inputField",name:"Pulse",header:"Pulse rate",unit:"BMP",icon:i.pulse,type:"number",grid:{s:"4.5"},validation:e=>n.vitalsPulseRate(e),disabled:e=>e["Check pulse rate not done"]},{grid:{s:"3"}},{componentType:"Alert",grid:{s:"9"},condition:async e=>{if(n.vitalsTemperature(e.Temperature)==null){const c=a.getTemperatureStatus(e.Temperature);return await a.updateRate("temp",e.Temperature,"°C",c,4)}else return!1}},{grid:{s:"3"}},{componentType:"Alert",grid:{s:"9"},condition:async e=>{if(n.vitalsPulseRate(e.Pulse)==null){const c=a.getPulseRateStatus(e.Pulse);return await a.updateRate("pulse",e.Pulse,"BMP",c,4)}else return!1}},{grid:{s:"3"}},{componentType:"checkboxField",name:"Check temperature not done",type:"single",label:"Temperature not done",grid:{s:"4.5"}},{componentType:"checkboxField",name:"Check pulse rate not done",type:"single",label:"Pulse not done",grid:{s:"4.5"}},{grid:{s:"3"}},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:e=>e["Check temperature not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:e=>e["Check pulse rate not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0}])}},ae=()=>{const a=k();return{respiratoryRateOxygenForm:v(()=>[{grid:{s:"3"}},{componentType:"inputField",name:"Respiratory rate",header:"Respiratory rate",unit:"BMP",icon:i.respiratory,type:"number",grid:{s:"4.5"},validation:e=>n.vitalsRespiratoryRate(e),disabled:e=>e["Check respiratory rate not done"]},{componentType:"inputField",name:"SAO2",header:"Oxygen saturation",unit:"%",icon:i.oxgenStaturation,type:"number",grid:{s:"4.5"},validation:e=>n.vitalsOxygenSaturation(e),disabled:e=>e["Check oxygen saturation not done"]},{grid:{s:"3"}},{componentType:"Alert",grid:{s:"9"},condition:async e=>{if(n.vitalsRespiratoryRate(e["Respiratory rate"])==null){const c=a.getRespiratoryRateStatus(e["Respiratory rate"]);return await a.updateRate("respiratory",e["Respiratory rate"],"BMP",c,4)}else return!1}},{grid:{s:"3"}},{componentType:"Alert",grid:{s:"9"},condition:async e=>{if(n.vitalsOxygenSaturation(e.SAO2)==null){const c=a.getOxygenSaturationStatus(e.SAO2);return await a.updateRate("oxygen",e.SAO2,"%",c,4)}else return!1}},{grid:{s:"3"}},{componentType:"checkboxField",name:"Check respiratory rate not done",type:"single",label:"Respiratory rate not done",grid:{s:"4.5"}},{componentType:"checkboxField",name:"Check oxygen saturation not done",type:"single",label:"Oxygen saturation not done",value:"",grid:{s:"4.5"}},{grid:{s:"3"}},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:e=>e["Check respiratory rate not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0},{componentType:"multiSelectInputField",header:"Specify Reason",name:"Other notes",isMultiple:!1,trackBy:"id",grid:{s:"4.5"},icon:i.search,options:[{id:1,name:"Patient uncooperative"},{id:2,name:"Machine not working"},{id:3,name:"Machine not available"}],condition:e=>e["Check oxygen saturation not done"],taggable:!1,hideSelected:!1,closeOnSelect:!0}])}},oe={class:"ion-padding",slot:"content"},ie=E({__name:"Vitals",setup(a,{expose:d}){const e=ee(),c=te(),T=ne(),w=ae(),t=S(null),r=S(0),C=B(),{patient:x}=j(C);L(()=>{var o;return(o=x.value)==null?void 0:o.patientID},async(o,l)=>{o&&o!==l&&(e.resetHeight(),r.value++,await p(),await p(),await e.loadHeight(),console.log("Form reset complete for new patient"))});const O=async()=>{if(!t.value)return console.error("Form reference is not available"),!1;const o=t.value.validateForm();if(o)return console.log("Validation errors:",o),R("Please fix validation errors before submitting"),!1;const l=t.value.getFormValues();console.log("Form data after validation:",l);const g=Object.keys(l).some(m=>m.startsWith("Check ")&&m.endsWith(" not done")&&l[m]===!0);if(!g){const m=t.value.validateForm();if(m)return console.log("Validation errors:",m),R("Please fix validation errors before submitting"),!1}const{newVitals:u,vitalsReasons:s}=await M(l);if(!u.length&&!s.length&&!g)return R("No vitals data to save"),!1;const b=await P.addObsToEncounterPatient([...u,...s],A.VITALS);return await W(b),r.value++,await p(),await p(),await e.loadHeight(),D("Vitals saved successful"),!0},M=async o=>{const l=[],g=[];for(const[u,s]of Object.entries(o)){if(u.startsWith("Check ")&&u.endsWith(" not done")){console.log("Skipping checkbox field: ".concat(u));continue}if(typeof s=="string"&&s&&!isNaN(Number(s))||typeof s=="number")l.push(await P.buildValueNumber(u,parseInt(String(s))));else if(s&&typeof s=="object"&&(s!=null&&s.name)){let b=u;u.endsWith("_reason")&&(b=u.replace("_reason","")),g.push(await P.buildValueText(b,s.name))}}return console.log("Processed vitals:",{newVitals:l,vitalsReasons:g}),{newVitals:l,vitalsReasons:g}};V(async()=>{e.resetHeight(),await p(),await p(),await e.loadHeight(),console.log("Vitals form initialization complete")}),z(()=>{console.log("Vitals form unmounting")});const H=v(()=>[...e.heightWeightFormSection.value,{grid:{s:"3"}},{grid:{s:"9"},componentType:"Dashes"},...c.bloodPressureFormSection.value,{grid:{s:"3"}},{grid:{s:"9"},componentType:"Dashes"},...T.temperaturePulseRateForm.value,...w.respiratoryRateOxygenForm.value]);return d({validateForm:()=>{var o;return(o=t.value)==null?void 0:o.validateForm()},onSubmit:O,resetForm:()=>{r.value++,p(()=>{e.loadHeight()})}}),(o,l)=>(F(),G(Z,null,[(F(),J(_,{formData:H.value,ref_key:"formRef",ref:t,key:r.value},null,8,["formData"])),h(f(Y),null,{default:y(()=>[h(f(K),{ref:"accordionGroup",class:"previousView"},{default:y(()=>[h(f(Q),{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:y(()=>[h(f($),{slot:"header",color:"light"},{default:y(()=>[h(f(q),{class:"previousLabel"},{default:y(()=>[...l[0]||(l[0]=[X("Previous measurements",-1)])]),_:1})]),_:1}),U("div",oe,[h(I)])]),_:1})]),_:1},512)]),_:1})],64))}}),le=N(ie,[["__scopeId","data-v-369a8536"]]);export{le as V};
