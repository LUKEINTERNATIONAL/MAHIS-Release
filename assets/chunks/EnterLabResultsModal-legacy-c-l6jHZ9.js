!function(){function e(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./vendor-legacy-CdypqbXP.js","../index-legacy-CQ-7M6kd.js"],function(t,n){"use strict";var a,i,s,l,o,r,u,d,m,c,f,p,v,y,g,_,h,b,D,I,T,w,C,x,R,S,k,P,B,L,N,E,j,M,W;return{setters:[e=>{a=e.d,i=e.r,s=e.am,l=e.b2,o=e.a,r=e.H,u=e.e,d=e.f,m=e.F,c=e.l,f=e.u,p=e.I,v=e.J,y=e.G,g=e.E,_=e.k,h=e.K,b=e.aW,D=e.N,I=e.aa,T=e.ab,w=e.M,C=e.bt,x=e.R},e=>{R=e.aW,S=e.O,k=e.u,P=e.n,B=e.z,L=e.S,N=e.g,E=e.an,j=e.bo,M=e.Z,W=e._}],execute:function(){var n=document.createElement("style");n.textContent="ion-footer[data-v-9a2f68e9]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-9a2f68e9]{--width: 90%;--height: 94%}\n/*$vite$:1*/",document.head.appendChild(n);class F extends R{constructor(t){super(t,32),e(this,"patientID",void 0),e(this,"testTypeID",void 0),e(this,"resultDate",void 0),e(this,"testID",void 0),this.patientID=t,this.testTypeID=-1,this.resultDate="",this.testID=-1}createLabResult(e){return R.postJson(`lab/tests/${this.testID}/results`,{encounter_id:this.encounterID,date:this.resultDate,measures:e})}getTestID(){return this.testID}getTestTypeID(){return this.testTypeID}setTestTypeID(e){this.testTypeID=e}setResultDate(e){this.resultDate=e}setTestID(e){this.testID=e}getTestsWithoutResults(){return S.getOrders(this.patientID,{status:"drawn"})}getTestIndicators(){return S.getJson("lab/test_result_indicators",{test_type_id:this.testTypeID})}static getTestIndicatorsWithID(e){return S.getJson("lab/test_result_indicators",{test_type_id:e})}}const H={style:{display:"flex","align-items":"center"}},O={style:{"margin-left":"6px"}},V={style:{"font-weight":"400","font-size":"19px"}},z={style:{display:"flex","align-items":"center"}},J={style:{"font-weight":"400","font-size":"20px"}},K={style:{display:"flex","align-items":"center"}},$=a({__name:"EnterLabResultsModal",props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:()=>({})},popoverOpen:{type:Boolean,default:!1},event:{default:""},title:{default:""},test_data:{}},emits:["closePopoover","closeModal","saved"],setup(e,{emit:t}){var n,a;const R=e;let S=i([]);s();const W=k(),{patient:$}=l(W),A=i(null),U=i((null===(n=R.test_data)||void 0===n?void 0:n.tests[0])||{}),G=i((null===(a=U.value)||void 0===a?void 0:a.name)||""),Z=()=>{x.dismiss()},q=async()=>{var e,t,n;const a=null===(e=A.value)||void 0===e?void 0:e.getFormValues(),i=await Promise.all(Object.entries(a).map(async([e,t])=>({name:e,concept_id:await E.getConceptID(e,!0),value:(null==t?void 0:t.name)||t}))),s=await j.buildResults(i);await j.saveResults($.value,s,null===(t=U.value)||void 0===t?void 0:t.id,null===(n=R.test_data)||void 0===n?void 0:n.offline_id),M("Lab results saved successfully"),Z()};return o(async()=>{await(async e=>{let t;t=L.getPouchDbStatus()||L.getLanConnectionStatus()?await N("test_result_indicators",{selector:{concept_id:e.concept_id}}):await F.getTestIndicatorsWithID(e.concept_id),t.forEach(e=>{let t={componentType:"inputField",name:e.name,header:e.name,grid:{s:"3"}};if("RBS"!=e.name&&"FBS"!=e.name||(t={...t,unit:"mg/dl"}),"MRDT"==e.name||"Tuberculosis program"==e.name||"Vdrl"==e.name||"Hepatitis B"==e.name||"Lam"==e.name||"CrAg"==e.name||"CD4 count"==e.name||"Leukocytes"==e.name||"Protein"==e.name||"Nitrite"==e.name||"Urine Ketones"==e.name||"HIV test"==e.name){let n=[];"MRDT"!=e.name&&"Vdrl"!=e.name&&"Hepatitis B"!=e.name&&"CrAg"!=e.name&&"Lam"!=e.name||(n=[{id:"1",name:"Positive"},{id:"2",name:"Negative"},{id:"3",name:"Invalid"}]),"Tuberculosis program"==e.name&&(n=[{id:"1",name:"Scanty"},{id:"2",name:"Negative"},{id:"3",name:"1+"},{id:"4",name:"2+"},{id:"5",name:"3+"}]),"CD4 count"==e.name&&(n=[{id:"1",name:"below reference line"},{id:"2",name:"above reference line"}]),"Leukocytes"!=e.name&&"Protein"!=e.name&&"Nitrite"!=e.name&&"Ketones"!=e.name&&"Urine Ketones"!=e.name||(n=[{id:"2",name:"Negative"},{id:"1",name:"Trace"},{id:"3",name:"1+"},{id:"4",name:"2+"},{id:"5",name:"3+"},{id:"6",name:"4+"}]),"HIV test"==e.name&&(n=[{id:"2",name:"Positive"},{id:"1",name:"Negative"},{id:"3",name:"Invalid"}]),t={componentType:"multiSelectInputField",header:e.name,name:e.name,trackBy:"id",icon:P.search,options:n}}S.value.push(t)})})(U.value)}),(e,t)=>{const n=r("ion-icon");return d(),u(m,null,[c(f(p),null,{default:v(()=>[c(f(y),null,{default:v(()=>[c(f(g),null,{default:v(()=>[_("div",H,[c(n,{icon:f(P).saveWhite,class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),_("b",O,"Enter lab results for "+h(G.value),1)])]),_:1}),c(f(b),{slot:"end"},{default:v(()=>[c(f(g),null,{default:v(()=>[c(f(D),{onClick:t[0]||(t[0]=e=>Z()),fill:"solid"},{default:v(()=>[_("span",V,[_("div",z,[c(n,{icon:f(I),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[1]||(t[1]=_("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),c(f(T),{class:"ion-padding"},{default:v(()=>[c(B,{formData:f(S),ref_key:"formRef",ref:A},null,8,["formData"])]),_:1}),c(f(w),null,{default:v(()=>[c(f(y),null,{default:v(()=>[c(f(b),{slot:"end"},{default:v(()=>[c(f(g),null,{default:v(()=>[c(f(D),{onClick:q,color:"primary",fill:"solid"},{default:v(()=>[_("span",J,[_("div",K,[c(n,{icon:f(C),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[2]||(t[2]=_("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});t("E",W($,[["__scopeId","data-v-9a2f68e9"]]))}}})}();
