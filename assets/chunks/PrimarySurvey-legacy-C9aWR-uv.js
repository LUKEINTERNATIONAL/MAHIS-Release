System.register(["./vendor-legacy-CdypqbXP.js","../index-legacy-CQ-7M6kd.js","./DemographicBar-legacy-BEY4wqH6.js","./useFormWizard-legacy-DczO6gxA.js","./ComplicationsStore-legacy-C6kh9Gm4.js","./nonPharmaTherapyStore-legacy-Dgf8Ss9q.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-CLaDeN80.js","./usePatientProfile-legacy-BbB0e34Z.js","./ExposureAssessment.vue_vue_type_script_setup_true_lang-legacy-BozXy_QQ.js","./apexcharts-legacy-DPlv51y0.js","./drug_prescription_service-legacy-CnmefQBQ.js","./patient_diagnosis_service-legacy-BJeeEUxT.js","./Registration-legacy-JhJajsP_.js","./useSetRegistrationValues-legacy-IforFUde.js","./useLocation-legacy-BZZkt9lG.js","./vaccines_service-legacy-B8eoR-ig.js","./sms_service-legacy-ChckZ70S.js","./EIRreportsStore-legacy-CgG4vUEp.js","./Export-legacy-Br3f2iIr.js","./user_role_management-legacy-CcinxvQT.js","./useNeonatalEnrollmentStore-legacy-DHZSAMR0.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-CSvd9eX3.js","./wardsStore-legacy-CQsA9Tn3.js","./DisplaySelectedBodyParts.vue_vue_type_script_setup_true_lang-legacy-B6SJKhcW.js","./ReusableDataTable-legacy-DM0gVWAt.js"],function(e,s){"use strict";var t,a,n,l,i,o,c,u,r,v,d,g,m,y,p,b,h,A,f,w,_,D,S,j,x,C,B,T,E,P,R,k,I,L,z,N,O,V,F,H,$,M,U,W,J,Q,Z,q,G,K,X,Y,ee,se,te,ae,ne,le,ie,oe,ce,ue;return{setters:[e=>{t=e.d,a=e.am,n=e.cr,l=e.r,i=e.c,o=e.b2,c=e.w,u=e.a,r=e.O,v=e.f,d=e.J,g=e.l,m=e.u,y=e.ab,p=e.k,b=e.m,h=e.i,A=e.bT,f=e.v,w=e.ae,_=e.ba},e=>{D=e.b8,S=e.u,j=e.b9,x=e.ba,C=e.b0,B=e.bb,T=e.e,E=e.b1,P=e.i,R=e.a7,k=e.f,I=e.T,L=e.D,z=e.a1,N=e.H,O=e.b3,V=e.bc,F=e.C,H=e.bd,$=e.t,M=e.an,U=e.Z,W=e.be,J=e.a9,Q=e.S},e=>{Z=e.D},e=>{q=e.u,G=e._},e=>{K=e.u},e=>{X=e.s,Y=e.c,ee=e.u},e=>{se=e.l},e=>{te=e.f,ae=e.a},e=>{ne=e.u},e=>{le=e._,ie=e.B,oe=e.a,ce=e.b,ue=e.c},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const s={style:{width:"90vw",margin:"0 auto","margin-top":"10px"}},re={class:"back_profile"};e("default",t({__name:"PrimarySurvey",setup(e,{expose:t}){const{onTabBeforeChange:ve,currentTabIndex:de}=q();ne();const ge=a(),me=n();l([]),l([]),l(!1);const ye=l(!0),pe=l(!1),be=l(!1),he=i(()=>({text:be.value?"Saving...":"Finish",icon:be.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:pe.value||be.value})),Ae=D(),fe=S(),we=j(),_e=x();C();const De=B(),Se=T();E();const je=P(),xe=K(),Ce=R(),{patient:Be}=o(fe),{vitals:Te}=o(Ae),{investigations:Ee}=o(we),{diagnosis:Pe}=o(_e),{substance:Re}=o(je),{selectedNCDMedicationList:ke}=o(De),{FootScreening:Ie,visualScreening:Le,cvScreening:ze}=o(xe),{sessionDate:Ne}=o(Ce),{apiStatus:Oe}=o(k());c(he,(e,s)=>{console.log("Done button options changed:",{from:s,to:e,currentStep:de.value,tabsLength:He.value.length}),e.disabled!==(null==s?void 0:s.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==s?void 0:s.text)&&console.log(`Done button text changed from "${null==s?void 0:s.text}" to "${e.text}"`)},{deep:!0}),c(be,(e,s)=>{e!==s&&(console.log(`Saving state changed: ${s} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Ve=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Fe=()=>{let e=!1;return Ue(),be.value&&(e=!0),pe.value=e,!e},He=l([{title:"Airway Assessment",icon:""},{title:"Breathing Assessment",icon:""},{title:"Circulation Assessment",icon:""},{title:"Disability Assessment",icon:""},{title:"Exposure Assessment",icon:""}]),$e=l(null),Me=l(null),Ue=()=>{var e;if(!He.value||0===He.value.length)return console.log("Tabs not yet initialized"),null;const s=de.value>=0&&de.value<He.value.length?de.value:0;switch(null===(e=He.value[s])||void 0===e?void 0:e.title){case"Airway Assessment":return"AirwayAssessment";case"Breathing Assessment":return"BreathingAssessment";case"Circulation Assessment":return"CirculationAssessment";case"Disability Assessment":return"DisabilityAssessment";case"Exposure Assessment":return"ExposureAssessment";default:if(Se.NCDActivities.length>0)switch(Se.NCDActivities[0]){case"Airway Assessment":return"AirwayAssessment";case"Breathing Assessment":return"BreathingAssessment";case"Circulation Assessment":return"CirculationAssessment";case"Disability Assessment":return"DisabilityAssessment";case"Exposure Assessment":return"ExposureAssessment"}return null}},We=()=>{ye.value=!1,setTimeout(()=>{de.value=0,ye.value=!0},0)},Je=()=>{const e=D();e.setVitals(e.getInitialVitals(Be.value.ID))},Qe=async()=>{const e=z(Ne.value,"sessionDate","value")||N.sessionDate(),s=O("vitals");for(let a=0;a<He.value.length;a++){const n=He.value[a];if("Vital Signs"===n.title)He.value[a].icon=Ze(e,s)?_:"";else if("Risk Assessment"===n.title){const s=O("substanceAbuse");He.value[a].icon=Ze(e,s)?_:""}else if("Investigations"===n.title){var t;const s=null==Be||null===(t=Be.value)||void 0===t||null===(t=t.labOrders)||void 0===t?void 0:t.saved,n=null==s?void 0:s.filter(s=>N.toStandardHisFormat(e)===N.toStandardHisFormat(s.order_date));He.value[a].icon=(null==n?void 0:n.length)>0?_:""}else if("Diagnosis"===n.title){const s=O("diagnosis");He.value[a].icon=Ze(e,s)?_:""}else if("Complications Screening"===n.title){const s=O("screening");He.value[a].icon=Ze(e,s)?_:""}else"Treatment Plan"===n.title&&(ke.value.length>0?He.value[a].icon=V()?_:"":He.value[a].icon="")}Fe()},Ze=(e,s)=>{const t=new Date(e);return t.setHours(0,0,0,0),s.some(e=>{const s=new Date(e.obs_datetime);return s.setHours(0,0,0,0),s.getTime()===t.getTime()})},qe=async(e,s)=>{var t;const a=null===(t=He.value[s])||void 0===t?void 0:t.title;var n,l;e%1==0&&(de.value=e),"Vital Signs"==a&&(null===(n=$e.value)||void 0===n||n.onSubmit()),"Risk Assessment"==a&&(null===(l=Me.value)||void 0===l||l.onSubmit()),"Complications Screening"==a&&await(async()=>{const e=[],s=await te(Le.value),t=await ae(Ie.value),a=await te(ze.value);var n,l,i,o;s.length>0&&e.push({concept_id:await M.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:M.getSessionDate(),child:s}),t.length>0&&e.push({concept_id:await M.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:M.getSessionDate(),child:t}),a.length>0&&e.push(...a),e.length>0?(null!==(l=(n=null!==(o=(i=Be.value).screening)&&void 0!==o?o:i.screening={}).unsaved)&&void 0!==l||(n.unsaved=[]),Be.value.screening.unsaved.push(...e),U("Complications saved successfully")):$("No complications data to save")})(),"Treatment Plan"==a&&await(async()=>{const e=W();if(!se.isEmpty(e.selectedMedicalAllergiesList)){const s=J(),t=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:Q.getSessionDate(),value_coded:e.concept_id,location_id:s.facilityLocation.code,value_text:e.name})),a=await X(t);Be.value=Object.assign(Be.value,a),console.log("Allergies staged successfully:",Be.value),e.clearSelectedMedicalAllergiesList()}const s=await Y();Be.value=Object.assign(Be.value,s);const t=await ee().saveNonPharmaTherapyPatientData();Be.value=Object.assign(Be.value,t)})(),await F(Be.value)},Ge=async()=>{be.value=!0;try{await H(),await F(Be.value),ge.push("/triageList")}catch(e){console.error("Error saving data:",e),$("Error occurred while saving data. Please try again.")}finally{be.value=!1}};return u(async()=>{0!==Se.NCDActivities.length?(K().resetScreening(),He.value=[{title:"Airway Assessment",icon:""},{title:"Breathing Assessment",icon:""},{title:"Circulation Assessment",icon:""},{title:"Disability Assessment",icon:""},{title:"Exposure Assessment",icon:""}],await Qe(),(void 0===de.value||de.value<0)&&(de.value=0,console.log("Setting initial tab index to 0")),pe.value=!1,be.value=!1,Fe()):ge.push("patientProfile")}),c(de,async()=>{await Fe()}),c(Te,async()=>{await Qe()},{deep:!0}),c(Be,async()=>{K().resetScreening(),await Qe()},{deep:!0}),c(Ne,async()=>{await Qe()},{deep:!0}),c(Ee,async()=>{await Qe()},{deep:!0}),c(Pe,async()=>{await Qe()},{deep:!0}),c(Re,async()=>{await Qe()},{deep:!0}),c(ke,async()=>{await Qe()},{deep:!0}),c(me,async e=>{We(),Je(),He.value=[{title:"Airway Assessment",icon:""},{title:"Breathing Assessment",icon:""},{title:"Circulation Assessment",icon:""},{title:"Disability Assessment",icon:""},{title:"Exposure Assessment",icon:""}]},{deep:!0}),c(Be,async(e,s)=>{e.ID!=s.ID&&(We(),Je())},{deep:!0}),t({saveData:Ge,markWizard:Qe,refreshWizard:We,validateDoneButtonState:Fe}),(e,t)=>(v(),r(m(w),null,{default:d(()=>[g(I),g(m(y),{fullscreen:!0},{default:d(()=>[g(Z),p("div",s,[ye.value?(v(),r(G,{key:0,ref:"wizard",headingTitle:"Primary Survey","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:he.value,"custom-tabs":He.value,beforeChange:m(ve),onChange:qe,"onComplete:wizard":t[1]||(t[1]=e=>Ge()),onDoneButtonChanged:Ve},{default:d(()=>[p("div",null,[p("div",re,[g(L,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:m(A),"font-weight":"600",onClick:t[0]||(t[0]=e=>{ge.push("/patientProfile")})},null,8,["icon"])])]),h(p("div",null,[g(le,{ref:"airwayAssessmentRef"},null,512)],512),[[f,"AirwayAssessment"==Ue()]]),h(p("div",null,[g(ie,{ref:"breathingAssessmentRef"},null,512)],512),[[f,"BreathingAssessment"==Ue()]]),h(p("div",null,[g(oe,{ref:"circulationAssessmentRef"},null,512)],512),[[f,"CirculationAssessment"==Ue()]]),h(p("div",null,[g(ce,{ref:"disabilityAssessmentRef"},null,512)],512),[[f,"DisabilityAssessment"==Ue()]]),h(p("div",null,[g(ue,{ref:"exposureAssessmentRef"},null,512)],512),[[f,"ExposureAssessment"==Ue()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):b("",!0)])]),_:1})]),_:1}))}}))}}});
