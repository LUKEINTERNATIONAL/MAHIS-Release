import{d as j,am as K,b2 as Q,r as u,c as w,w as B,a as J,e as I,f as n,k as e,i as x,l as Z,K as V,u as l,fl as ee,fm as se,L as A,v as G,bj as te,p as a,m as d,O as N,ba as T,Q as ae,F as le,P as oe,U as Y}from"./vendor-Do41i3tR.js";import{u as ne,b as y,_ as ie}from"../index-DmWNBpr9.js";import{N as ce}from"./neonatal_service-BhATEAP8.js";import{g as re}from"./admissionWorkflow-C1e4oic-.js";const ue={class:"summary-wrapper"},de={class:"progress-bar-container"},ve={class:"progress-title"},pe={class:"progress-content"},me={class:"step-indicator"},Ae={key:0,class:"step-line"},Ne={class:"step-content"},Te={class:"step-indicator"},ge={key:0,class:"step-line"},Se={class:"step-content"},Ee={class:"step-indicator"},fe={class:"step-content expandable"},Ie={key:0,class:"edit-link"},_e={class:"sub-steps"},Oe=["onClick"],Ce={class:"sub-step-title"},ye={class:"step-indicator"},Le={class:"step-content"},ke={class:"step-indicator"},he={class:"step-content"},Me={class:"step-indicator"},be={class:"step-content"},De={class:"step-indicator"},Pe={class:"step-content"},Re=j({__name:"AdmissionProgressBar",setup(we){const p=K(),U=ne(),{patient:M}=Q(U),_=u(!0),L=u(!0),O=u([]),D=u(["Triage","Profiling","Admission"]),C=u([{encounterType:y.NEONATAL_SIGNS_SYMPTOMS,title:"Signs & Symptoms",route:"/neonatal/signs-symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS","NEONATAL SIGNS SYMPTOMS"],isCompleted:!1},{encounterType:y.NEONATAL_REVIEW_OF_SYSTEMS,title:"A review of systems",route:"/neonatal/review-of-systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"],isCompleted:!1},{encounterType:y.PHYSICAL_EXAMINATION_BABY,title:"General examination",route:"/neonatal/general-examination",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"],isCompleted:!1},{encounterType:y.VITALS,title:"Vitals",route:"/neonatal/vitals",encounterNames:["VITALS","NEONATAL VITALS"],isCompleted:!1},{encounterType:y.NEONATAL_SYSTEMIC_EXAMINATION,title:"Systemic examination",route:"/neonatal/SystemicExamination",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"],isCompleted:!1}]),o=u(!1),c=u(!1),m=u(!1),g=u(!1),S=u(!1),E=u(!1),i=w(()=>C.value.every(t=>t.isCompleted)),H=w(()=>C.value.find(t=>!t.isCompleted)),P=t=>{var s;return!o.value||!c.value||t.isCompleted?!1:((s=H.value)==null?void 0:s.encounterType)===t.encounterType},k=t=>(t!=null?t:"").trim().toUpperCase(),b=async()=>{var t;if((t=M.value)!=null&&t.patientID)try{const s=await ce.getSavedEncounters(M.value.patientID);O.value=Array.isArray(s==null?void 0:s.encounters)?s.encounters:[],c.value=O.value.some(v=>{const f=k(v);return f==="NEONATAL ENROLLMENT"||f==="NEONATAL ENROLMENT"});const r=re(O.value,C.value);C.value.forEach((v,f)=>{v.isCompleted=f<r});const R=new Set(O.value.map(v=>k(v))),h=v=>v.some(f=>R.has(k(f)));m.value=h(["DIAGNOSIS","NEONATAL DIAGNOSIS"]),g.value=h(["INVESTIGATION","NEONATAL INVESTIGATION","LAB ORDERS","LAB RESULTS","AHD LAB ORDERS","AHD LAB RESULTS"]),S.value=h(["TREATMENT","NEONATAL TREATMENT PLAN"]),E.value=h(["NEONATAL ADMISSION OUTCOMES","ADMISSION OUTCOMES"]),o.value=O.value.some(v=>k(v)==="NEONATAL TRIAGE")}catch(s){console.error("Error loading progress:",s)}},X=()=>{_.value=!_.value},z=async()=>{if(i.value){p.push("/neonatal/checkpoint");return}if(!o.value){await(await Y.create({header:"Triage Required",message:"Please complete triage before starting admission.",buttons:[{text:"Cancel",role:"cancel"},{text:"Go to Triage",handler:()=>{p.push("/neonatal/triage")}}]})).present();return}if(!c.value){await(await Y.create({header:"Profiling Required",message:"Please complete profiling before starting admission.",buttons:[{text:"Cancel",role:"cancel"},{text:"Go to Profiling",handler:()=>{p.push("/neonatal/enrollment")}}]})).present();return}L.value=!L.value},F=()=>{p.push("/neonatal/triage")},$=()=>{p.push("/neonatal/enrollment")},q=()=>{p.push("/neonatal/diagnosis")},W=t=>{p.push(t)};return B(()=>{var t;return(t=M.value)==null?void 0:t.patientID},t=>{t&&b()}),B(()=>p.currentRoute.value,()=>{b()}),J(()=>{b()}),(t,s)=>(n(),I("div",ue,[s[11]||(s[11]=e("div",{class:"summary-title"},"Summary",-1)),e("div",de,[e("div",{class:"progress-header",onClick:X},[e("span",ve,V(_.value?"Hide progress bar":"Show progress bar"),1),Z(l(A),{icon:_.value?l(ee):l(se),class:"toggle-icon"},null,8,["icon"])]),x(e("div",pe,[e("div",{class:a(["progress-step",{completed:o.value,active:!o.value}])},[e("div",me,[e("div",{class:a(["step-circle",{completed:o.value}])},[o.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),D.value.length>1?(n(),I("div",Ae)):d("",!0)]),e("div",Ne,[e("div",{class:a(["step-title",{clickable:!o.value,incomplete:!o.value}]),onClick:s[0]||(s[0]=r=>!o.value&&F())},"Triage",2)])],2),e("div",{class:a(["progress-step",{completed:c.value,active:!c.value&&o.value}])},[e("div",Te,[e("div",{class:a(["step-circle",{completed:c.value}])},[c.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),D.value.length>2?(n(),I("div",ge)):d("",!0)]),e("div",Se,[e("div",{class:a(["step-title",{clickable:!c.value&&o.value,incomplete:!c.value}]),onClick:s[1]||(s[1]=r=>!c.value&&o.value&&$())},"Profiling",2)])],2),e("div",{class:a(["progress-step",{completed:i.value,active:!i.value&&o.value&&c.value}])},[e("div",Ee,[e("div",{class:a(["step-circle",{completed:i.value}])},[i.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),s[3]||(s[3]=e("div",{class:"step-line last-line"},null,-1))]),e("div",fe,[e("div",{class:a(["step-title clickable",{incomplete:!i.value}]),onClick:z},[s[4]||(s[4]=ae(" Admission ",-1)),L.value?d("",!0):(n(),I("span",Ie,"edit"))],2),x(e("div",_e,[(n(!0),I(le,null,oe(C.value,r=>(n(),I("div",{key:r.encounterType,class:a(["sub-step",{completed:r.isCompleted,clickable:P(r)}]),onClick:R=>P(r)&&W(r.route)},[s[5]||(s[5]=e("span",{class:"bullet"},"â€¢",-1)),e("span",Ce,V(r.title),1)],10,Oe))),128))],512),[[G,L.value]])])],2),e("div",{class:a(["progress-step",{completed:m.value,active:!m.value&&i.value}])},[e("div",ye,[e("div",{class:a(["step-circle",{completed:m.value}])},[m.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),s[6]||(s[6]=e("div",{class:"step-line"},null,-1))]),e("div",Le,[e("div",{class:a(["step-title",{clickable:!m.value&&i.value,incomplete:!m.value}]),onClick:s[2]||(s[2]=r=>!m.value&&i.value&&q())},"Diagnosis",2)])],2),e("div",{class:a(["progress-step",{completed:g.value,active:i.value&&!g.value}])},[e("div",ke,[e("div",{class:a(["step-circle",{completed:g.value}])},[g.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),s[7]||(s[7]=e("div",{class:"step-line"},null,-1))]),e("div",he,[e("div",{class:a(["step-title",{incomplete:!g.value}])},"Investigations",2)])],2),e("div",{class:a(["progress-step",{completed:S.value,active:i.value&&!S.value}])},[e("div",Me,[e("div",{class:a(["step-circle",{completed:S.value}])},[S.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),s[8]||(s[8]=e("div",{class:"step-line"},null,-1))]),e("div",be,[e("div",{class:a(["step-title",{incomplete:!S.value}])},"Treatment Plan",2)])],2),e("div",{class:a(["progress-step",{completed:E.value,active:i.value&&!E.value}])},[e("div",De,[e("div",{class:a(["step-circle",{completed:E.value}])},[E.value?(n(),N(l(A),{key:0,icon:l(T)},null,8,["icon"])):d("",!0)],2),s[9]||(s[9]=e("div",{class:"step-line"},null,-1))]),e("div",Pe,[e("div",{class:a(["step-title",{incomplete:!E.value}])},"Outcome",2)])],2),s[10]||(s[10]=te('<div class="progress-step last" data-v-854733d0><div class="step-indicator" data-v-854733d0><div class="step-circle" data-v-854733d0></div></div><div class="step-content" data-v-854733d0><div class="step-title incomplete" data-v-854733d0>Signoff &amp; Printout</div></div></div>',1))],512),[[G,_.value]])])]))}}),Ye=ie(Re,[["__scopeId","data-v-854733d0"]]);export{Ye as A};
