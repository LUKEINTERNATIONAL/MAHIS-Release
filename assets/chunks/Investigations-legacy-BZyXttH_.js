System.register(["./vendor-legacy-BV-WGgzk.js","../index-legacy-BjCoULK2.js","./DemographicBar-legacy-DLgbbY27.js","./RadiologyStore-legacy-Bsbn4jyZ.js","./BasicForm-legacy-2lkhPati.js","./nonPharmaTherapyStore-legacy-Dide5aYZ.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-3I1UGkvW.js","./usePatientProfile-legacy-D2rMc8Bi.js","./apexcharts-legacy-CgZ9vWXi.js","./DateInputField-legacy-CF2vHm9k.js","./drug_prescription_service-legacy-D3aBZmyS.js","./patient_diagnosis_service-legacy-Tyc3rEvj.js","./Registration-legacy-D0BCFyTC.js","./useLocation-legacy-BQvq23NU.js","./vaccines_service-legacy-BhlUawKT.js","./sms_service-legacy-B9h22baM.js","./EIRreportsStore-legacy-3Y83EF5Q.js","./Export-legacy-CFvsfYDf.js","./useNeonatalEnrollmentStore-legacy-BHOsgqmj.js","./enrollment-legacy-BWFKsMdA.js"],function(e,t){"use strict";var a,l,n,i,o,s,c,d,r,u,v,m,p,g,b,f,y,h,E,_,x,k,S,L,B,P,C,T,I,D,O,A,w,H,N,V,R,F,M,j,K,G,U,z,Y,$,q,W,X,J,Q,Z,ee,te,ae,le,ne,ie,oe,se,ce,de,re,ue,ve,me,pe,ge,be,fe,ye,he,Ee,_e,xe,ke,Se,Le;return{setters:[e=>{a=e.d,l=e.eR,n=e.c,i=e.e,o=e.f,s=e.l,c=e.i,d=e.u,r=e._,u=e.J,v=e.bv,m=e.W,p=e.k,g=e.K,b=e.L,f=e.ep,y=e.bs,h=e.F,E=e.P,_=e.O,x=e.Q,k=e.v,S=e.r,L=e.m,B=e.bw,P=e.eS,C=e.H,T=e.aU,I=e.a,D=e.an,O=e.cG,A=e.w,w=e.a3,H=e.bL,N=e.a6,V=e.b8},e=>{R=e._,F=e.J,M=e.l,j=e.aB,K=e.aC,G=e.aG,U=e.u,z=e.aH,Y=e.aI,$=e.aJ,q=e.aK,W=e.d,X=e.aL,J=e.g,Q=e.Z,Z=e.e,ee=e.T,te=e.N,ae=e.H,le=e.aM,ne=e.aN,ie=e.aO,oe=e.aP,se=e.t,ce=e.aR,de=e.G,re=e.aS,ue=e.a0,ve=e.S},e=>{me=e.D},e=>{pe=e.u},e=>{ge=e.B},e=>{be=e.u,fe=e.a,ye=e._,he=e.s,Ee=e.c,_e=e.b},e=>{xe=e.l},e=>{ke=e.a,Se=e.b},e=>{Le=e.u},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".checkbox-group[data-v-674cf61d]{margin-bottom:8px}.section-header[data-v-674cf61d]{--padding-start: 0;--inner-padding-end: 0}.label-content[data-v-674cf61d]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:8px 0}.chevron-container[data-v-674cf61d]{display:flex;align-items:center;cursor:pointer;padding:4px 8px;margin:-4px -8px}.chevron-container[data-v-674cf61d]:hover{opacity:.7}.chevron-icon[data-v-674cf61d]{font-size:20px;pointer-events:none}.nested-content[data-v-674cf61d]{padding-left:32px;margin-top:4px;display:flex;flex-wrap:wrap;gap:8px}.field-item[data-v-674cf61d]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:4px;width:100%}.field-item ion-label[data-v-674cf61d]{margin-left:8px}.parent-checkbox-group[data-v-2fe0d76b]{margin-bottom:12px}.section-header[data-v-2fe0d76b]{--padding-start: 0;--inner-padding-end: 0;cursor:pointer}.clickable-label[data-v-2fe0d76b]{cursor:pointer;margin-left:5px}.label-content[data-v-2fe0d76b]{display:flex;align-items:center;justify-content:space-between;width:100%;padding:8px 0}.chevron-icon[data-v-2fe0d76b]{margin-left:8px;font-size:20px}.nested-content[data-v-2fe0d76b]{padding-left:32px;margin-top:8px}.patient-info[data-v-c6d265c2]{background-color:#e3f2fd;padding:16px;margin-bottom:16px;border-radius:8px;border:1px solid #90caf9}.patient-info p[data-v-c6d265c2]{margin:0;font-size:14px}.loading-overlay[data-v-c6d265c2]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:9999}.form-content[data-v-c6d265c2]{padding-bottom:80px}.checkbox-item[data-v-c6d265c2]{margin-bottom:4px}.checkbox-item ion-item[data-v-c6d265c2]{--padding-start: 0;--inner-padding-end: 0}.submit-button[data-v-c6d265c2]{margin-top:24px}#ABDOMEN-2[data-v-33a0b153],#SPINE[data-v-33a0b153]{display:none}.white-fill[data-v-33a0b153]{fill:#fff!important}.dark-green-stroke[data-v-33a0b153]{stroke:#006401!important}.dark-green-fill[data-v-33a0b153]{fill:#006401!important}.bright-green-fill[data-v-33a0b153]{fill:#ded!important}ion-footer[data-v-33a0b153]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-33a0b153]{--width: 90%;--height: 94%}.form-column[data-v-33a0b153]{border-left:1px solid #a3a1a1;max-height:600px;display:flex;flex-direction:column}.scrollable-container[data-v-33a0b153]{overflow-y:auto;max-height:100%;padding-right:10px;padding-left:10px}.form-section[data-v-33a0b153]{margin-bottom:20px}.form-section h6[data-v-33a0b153]{margin-top:0;margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid #eaeaea;font-weight:600}\n/*$vite$:1*/",document.head.appendChild(t);const Be={class:"checkbox-group"},Pe={class:"label-content"},Ce={class:"nested-content"},Te=R(a({__name:"CheckboxGroup",props:{sectionKey:{}},setup(e){const t=e,a=l("sections"),S=l("sectionDefinitions")[t.sectionKey],L=n(()=>a.value[t.sectionKey]),B=n(()=>L.value.open),P=n(()=>L.value.selectedFields),C=n(()=>!(!S.fields||0===S.fields.length)&&S.fields.every(e=>P.value[e.name])),T=n(()=>{if(!S.fields||0===S.fields.length)return!1;const e=S.fields.filter(e=>P.value[e.name]).length;return e>0&&e<S.fields.length}),I=()=>{a.value[t.sectionKey].open=!a.value[t.sectionKey].open,console.log("ðŸš€ ~ toggleOpen ~ sections.value[props.sectionKey].open:",a.value[t.sectionKey].open)},D=()=>{const e=!C.value;S.fields&&S.fields.forEach(l=>{a.value[t.sectionKey].selectedFields[l.name]=e}),e&&(a.value[t.sectionKey].open=!0)};return(e,l)=>(o(),i("div",Be,[s(d(r),{lines:"none",class:"section-header"},{default:u(()=>[s(d(v),{slot:"start",checked:C.value,indeterminate:T.value&&!C.value,onIonChange:D},null,8,["checked","indeterminate"]),s(d(m),{style:{"margin-left":"5px"}},{default:u(()=>[p("div",Pe,[p("span",null,g(d(S).title),1),p("div",{class:"chevron-container",onClick:I},[s(d(b),{icon:B.value?d(f):d(y),class:"chevron-icon"},null,8,["icon"])])])]),_:1})]),_:1}),c(p("div",Ce,[(o(!0),i(h,null,E(d(S).fields,e=>(o(),_(d(r),{key:e.name,lines:"none",class:"field-item"},{default:u(()=>[s(d(v),{slot:"start",checked:P.value[e.name],onIonChange:l=>{return n=e.name,void(a.value[t.sectionKey].selectedFields[n]=!a.value[t.sectionKey].selectedFields[n]);var n}},null,8,["checked","onIonChange"]),s(d(m),null,{default:u(()=>[x(g(e.label),1)]),_:2},1024)]),_:2},1024))),128))],512),[[k,B.value]])]))}}),[["__scopeId","data-v-674cf61d"]]),Ie={class:"parent-checkbox-group"},De={class:"label-content"},Oe={class:"nested-content"},Ae=R(a({__name:"ParentCheckboxGroup",props:{sectionKey:{}},setup(e){const t=e,a=l("sections"),x=l("sectionDefinitions"),S=x[t.sectionKey],L=n(()=>a.value[t.sectionKey]),B=n(()=>L.value.open),P=n(()=>!!S.subSections&&S.subSections.every(e=>{const t=x[e];return!t.fields||0===t.fields.length||t.fields.every(t=>a.value[e].selectedFields[t.name])})),C=n(()=>{if(!S.subSections)return!1;let e=0,t=0;return S.subSections.forEach(l=>{const n=x[l];n.fields&&(t+=n.fields.length,e+=n.fields.filter(e=>a.value[l].selectedFields[e.name]).length)}),e>0&&e<t}),T=()=>{a.value[t.sectionKey].open=!a.value[t.sectionKey].open},I=()=>{const e=!P.value;S.subSections&&S.subSections.forEach(t=>{const l=x[t];l.fields&&(l.fields.forEach(l=>{a.value[t].selectedFields[l.name]=e}),a.value[t].open=!0)}),a.value[t.sectionKey].open=!0};return(e,t)=>(o(),i("div",Ie,[s(d(r),{lines:"none",class:"section-header"},{default:u(()=>[s(d(v),{slot:"start",checked:P.value,indeterminate:C.value&&!P.value,onIonChange:I},null,8,["checked","indeterminate"]),s(d(m),{onClick:T,class:"clickable-label"},{default:u(()=>[p("div",De,[p("strong",null,g(d(S).title),1),s(d(b),{icon:B.value?d(f):d(y),class:"chevron-icon"},null,8,["icon"])])]),_:1})]),_:1}),c(p("div",Oe,[(o(!0),i(h,null,E(d(S).subSections,e=>(o(),_(Te,{key:e,"section-key":e},null,8,["section-key"]))),128))],512),[[k,B.value]])]))}}),[["__scopeId","data-v-2fe0d76b"]]),we={class:"ion-padding"},He={key:0,class:"loading-overlay"},Ne={class:"form-content"},Ve={class:"checkbox-item"},Re={class:"checkbox-item"},Fe={class:"checkbox-item"},Me={class:"ion-float-right ion-padding"},je=R(a({__name:"BedsidePlan",setup(e){const t="pH",a="pCOâ‚‚ (mmHg)",l="pOâ‚‚ (mmHg)",n="c_tHb (g/dL)",c="sOâ‚‚ (%)",g="FOâ‚‚Hb (%)",b="FHHb (%)",f="FmetHb (%)",y="cKâº (mmol/L)",h="cNaâº (mmol/L)",E="cCaÂ²âº (mmol/L)",k="cClâ» (mmol/L)",C="cGlu (mmol/L)",T="cLac (mmol/L)",I="ctBil (Âµmol/L)",D="pH (T)",O="pCOâ‚‚ (T) mmHg",A="pOâ‚‚ (T) mmHg",w="P50e",H="cBaseExcess (Ecf)c",N="cHCOâ‚ƒâ» (P,st)c",V="Anion Gap",R="cmOSm",M={PH:{name:t,label:t},PCO2:{name:a,label:a},PO2:{name:l,label:l},CTHB:{name:n,label:n},SO2E:{name:c,label:c},FO2HBE:{name:g,label:g},FHHBE:{name:b,label:b},FMETHB:{name:f,label:f},CK:{name:y,label:y},CNA:{name:h,label:h},CA2:{name:E,label:E},CCL:{name:k,label:k},glucose:{name:C,label:C},LACTATE:{name:T,label:T},CTBIL:{name:I,label:I},PH_T:{name:D,label:D},PCO2_T:{name:O,label:O},PO2_T:{name:A,label:A},P50E:{name:w,label:w},BASE_EXCESS:{name:H,label:H},HCO3:{name:N,label:N},ANION_GAPC:{name:V,label:V},MOSMC:{name:R,label:R},pregnancyTest:{name:"PREGNANCY_TEST",label:"Pregnancy Test",coded:!0},urobilinogen:{name:"UROBILINOGEN",label:"Urobilinogen"},leukocytes:{name:"LEUKOCYTES",label:"Leukocytes"},bilirubin:{name:"BILIRUBIN",label:"Bilirubin"},specificGravity:{name:"SPECIFIC_GRAVITY",label:"Specific Gravity"},nitrite:{name:"NITRITE",label:"Nitrite"},ketones:{name:"KETONES",label:"Ketones"},blood:{name:"BLOOD",label:"Blood"},protein:{name:"PROTEIN",label:"Protein"},pocus:{name:"POCUS",label:"Point of care ultrasound"},ecg:{name:"ECG",label:"ECG"},pefr:{name:"PEFR",label:"PEFR"},other:{name:"OTHER",label:"Other"}},j={arterialVenousBloodGasMain:{title:"Arterial/Venous Blood Gas",subSections:["bloodGasValues","oximetryValues","electrolyteValues","metabolicValues","temperatureCorrectedValues","acidBaseStatus"]},bloodGasValues:{title:"Blood Gas Values",fields:[M.PH,M.PCO2,M.PO2]},oximetryValues:{title:"Oximetry Values",fields:[M.CTHB,M.SO2E,M.FO2HBE,M.FHHBE,M.FMETHB]},electrolyteValues:{title:"Electrolyte Values",fields:[M.CK,M.CNA,M.CA2,M.CCL]},metabolicValues:{title:"Metabolic Values",fields:[M.glucose,M.LACTATE,M.CTBIL]},temperatureCorrectedValues:{title:"Temperature Corrected Values",fields:[M.PH_T,M.PCO2_T,M.PO2_T,M.P50E]},acidBaseStatus:{title:"Acid Base Status",fields:[M.BASE_EXCESS,M.HCO3,M.ANION_GAPC,M.MOSMC]},dipstick:{title:"Dipstick",fields:[M.urobilinogen,M.PH,M.leukocytes,M.glucose,M.specificGravity,M.protein,M.nitrite,M.ketones,M.bilirubin,M.blood]},additionalTests:{title:"Additional Tests",fields:[M.pocus,M.ecg,M.pefr,M.other]},pregnancyTest:{title:"Pregnancy Test",fields:[M.pregnancyTest]}},K=S({activeVisit:"visit-123",patientId:"patient-456",gender:"Female"}),G=S((()=>{const e={};return Object.keys(j).forEach(t=>{const a=j[t];e[t]={open:!1,selectedFields:{}},a.fields&&a.fields.forEach(a=>{e[t].selectedFields[a.name]=!1})}),e})()),U=S(!1),z=S(!1),Y=S(!1),$=S(!1);return P("sections",G),P("sectionDefinitions",j),(e,t)=>(o(),i("div",we,[$.value?(o(),i("div",He,[s(d(B),{name:"crescent"})])):L("",!0),p("div",Ne,[s(Ae,{"section-key":"arterialVenousBloodGasMain"}),p("div",Ve,[s(d(r),{lines:"none"},{default:u(()=>[s(d(v),{slot:"start",modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=e=>U.value=e)},null,8,["modelValue"]),s(d(m),{style:{"margin-left":"5px"}},{default:u(()=>[...t[3]||(t[3]=[x("MRDT",-1)])]),_:1})]),_:1})]),p("div",Re,[s(d(r),{lines:"none"},{default:u(()=>[s(d(v),{slot:"start",modelValue:z.value,"onUpdate:modelValue":t[1]||(t[1]=e=>z.value=e)},null,8,["modelValue"]),s(d(m),{style:{"margin-left":"5px"}},{default:u(()=>[...t[4]||(t[4]=[x("HIV",-1)])]),_:1})]),_:1})]),p("div",Fe,[s(d(r),{lines:"none"},{default:u(()=>[s(d(v),{slot:"start",modelValue:Y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>Y.value=e)},null,8,["modelValue"]),s(d(m),{style:{"margin-left":"5px"}},{default:u(()=>[...t[5]||(t[5]=[x("VDRL",-1)])]),_:1})]),_:1})]),"Female"===K.value.gender?(o(),_(Te,{key:0,"section-key":"pregnancyTest"})):L("",!0),s(Te,{"section-key":"dipstick"}),s(Te,{"section-key":"additionalTests"})]),p("div",Me,[s(F,{name:"Submit"})])]))}}),[["__scopeId","data-v-c6d265c2"]]),Ke={class:"ion-float-right ion-padding"},Ge=a({__name:"LabOrderPlan",setup(e){const t=[{componentType:"multiSelectInputField",header:"Tests",name:"tests",isMultiple:!1,trackBy:"id",grid:{s:"6"},icon:M.search,options:[{id:1,name:"HIV"},{id:2,name:"VDRL"},{id:3,name:"Urine Routine"},{id:4,name:"Urine Microscopy"},{id:5,name:"Urine Culture"}]},{componentType:"multiSelectInputField",header:"Sample Type",name:"sample_type",isMultiple:!1,trackBy:"id",grid:{s:"6"},icon:M.search,options:[{id:1,name:"Blood"},{id:2,name:"Urine"},{id:3,name:"Serum"},{id:4,name:"Sputum"}]},{componentType:"radioButtonField",header:"Emergency",name:"is_emergency",obsValueType:"value_text",validation:j.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"radioButtonField",header:"Urgent Sample",name:"is_urgent_sample",obsValueType:"value_text",validation:j.required,type:"standard",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"textAreaField",header:"Description",name:"description",icon:M.editPen}];return(e,a)=>{const l=C("ion-card-content"),n=C("ion-card");return o(),_(n,null,{default:u(()=>[s(l,null,{default:u(()=>[s(K,{formData:t}),p("div",Ke,[s(F,{name:"Submit"})])]),_:1})]),_:1})}}}),Ue=["innerHTML"],ze={class:"scrollable-container"},Ye={key:0,class:"form-section"},$e={key:1,class:"form-section"},qe={key:2,class:"form-section"},We={key:3,class:"form-section"},Xe={key:4,class:"form-section"},Je={key:5,class:"form-section"},Qe={key:6,class:"form-section"},Ze={key:7,class:"form-section"},et=R(a({__name:"Radiology",setup(e){const t=pe(),{head:a,neck:l,chest:n,abdomen:c,upper_extremity:r,spine:v,pelvis:m,lower_extremity:g}=T(t),b=S(M),f=S([]),y=(e,t,a)=>{document.querySelectorAll(`#${e} path`).forEach(e=>{e.classList.toggle("white-fill")}),document.querySelectorAll(`#${t} line`).forEach(e=>{e.classList.toggle("dark-green-stroke")}),document.querySelectorAll(`#${t} rect`).forEach(e=>{e.classList.toggle("bright-green-fill"),e.classList.toggle("dark-green-stroke")}),document.querySelectorAll(`#${t} path`).forEach(e=>{e.classList.toggle("dark-green-fill")}),document.querySelectorAll(`#${t} circle`).forEach(e=>{e.classList.toggle("bright-green-fill")});const l=f.value.findIndex(e=>e.id===a);l>=0?f.value.splice(l,1):f.value.unshift({id:a,active:!0})},x=()=>{const e=document.getElementById("SPINE");"none"===e.style.display||""==e.style.display?e.style.display="block":e.style.display="none",y("SPINE","SPINE_LABEL-2","spine")};return I(()=>{const e=document.getElementById("HEAD");e&&e.addEventListener("click",()=>{y("HEAD","LABEL-6","head")});const t=document.getElementById("NECK");t&&t.addEventListener("click",()=>{y("NECK","LABEL-5","neck")});const a=document.getElementById("CHEST");a&&a.addEventListener("click",()=>{y("CHEST","LABEL-4","chest")});const l=document.getElementById("ABDOMEN_LABEL");l&&l.addEventListener("click",()=>{const e=document.getElementById("ABDOMEN-2");"none"===e.style.display||""==e.style.display?e.style.display="block":e.style.display="none",y("ABDOMEN","ABDOMEN_LABEL-2","abdomen")});const n=document.getElementById("UPPER_EXTRMITY");n&&n.addEventListener("click",()=>{y("UPPER_EXTRMITY","LABEL-3","upper_extremity")});const i=document.getElementById("SPINE"),o=document.getElementById("SPINE_LABEL"),s=document.getElementById("LOWER_SPINE_INACTIVE");i&&i.addEventListener("click",()=>{x()}),o&&o.addEventListener("click",()=>{x()}),s&&s.addEventListener("click",()=>{x()});const c=document.getElementById("PELVIS");c&&c.addEventListener("click",()=>{y("PELVIS","LABEL-2","pelvis")});const d=document.getElementById("LOWER_EXTREMITY");d&&d.addEventListener("click",()=>{y("LOWER_EXTREMITY","LABEL","lower_extremity")})}),(e,t)=>{const y=C("ion-col"),x=C("ion-row");return o(),_(x,null,{default:u(()=>[s(y,{size:"7"},{default:u(()=>[p("div",{innerHTML:b.value.full_body_sk},null,8,Ue)]),_:1}),s(y,{size:"5",class:"form-column"},{default:u(()=>[p("div",ze,[(o(!0),i(h,null,E(f.value,e=>(o(),i(h,null,["head"===e.id?(o(),i("div",Ye,[t[0]||(t[0]=p("h6",null,"Body Part: Head",-1)),s(ge,{contentData:d(a)},null,8,["contentData"])])):"neck"===e.id?(o(),i("div",$e,[t[1]||(t[1]=p("h6",null,"Body Part: Neck",-1)),s(ge,{contentData:d(l)},null,8,["contentData"])])):"chest"===e.id?(o(),i("div",qe,[t[2]||(t[2]=p("h6",null,"Body Part: Chest",-1)),s(ge,{contentData:d(n)},null,8,["contentData"])])):"abdomen"===e.id?(o(),i("div",We,[t[3]||(t[3]=p("h6",null,"Body Part: Abdomen",-1)),s(ge,{contentData:d(c)},null,8,["contentData"])])):"upper_extremity"===e.id?(o(),i("div",Xe,[t[4]||(t[4]=p("h6",null,"Body Part: Upper Extremity",-1)),s(ge,{contentData:d(r)},null,8,["contentData"])])):"spine"===e.id?(o(),i("div",Je,[t[5]||(t[5]=p("h6",null,"Body Part: Spine",-1)),s(ge,{contentData:d(v)},null,8,["contentData"])])):"pelvis"===e.id?(o(),i("div",Qe,[t[6]||(t[6]=p("h6",null,"Body Part: Pelvis",-1)),s(ge,{contentData:d(m)},null,8,["contentData"])])):"lower_extremity"===e.id?(o(),i("div",Ze,[t[7]||(t[7]=p("h6",null,"Body Part: Lower Extremity",-1)),s(ge,{contentData:d(g)},null,8,["contentData"])])):L("",!0)],64))),256))])]),_:1})]),_:1})}}}),[["__scopeId","data-v-33a0b153"]]),tt={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},at={class:"back_profile"};e("default",a({__name:"Investigations",setup(e,{expose:t}){const{onTabBeforeChange:a,currentTabIndex:l}=be();Le();const i=D(),r=O();S([]),S([]),S(!1);const v=S(!0),m=S(!1),g=S(!1),b=n(()=>({text:g.value?"Saving...":"Finish",icon:g.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:m.value||g.value})),f=G(),y=U(),h=z(),E=Y();$();const x=q(),B=W();X();const P=J(),C=fe(),R=Q(),{patient:M}=T(y),{vitals:j}=T(f),{investigations:K}=T(h),{diagnosis:pe}=T(E),{substance:ge}=T(P),{selectedNCDMedicationList:Be}=T(x),{FootScreening:Pe,visualScreening:Ce,cvScreening:Te}=T(C),{sessionDate:Ie}=T(R),{apiStatus:De}=T(Z());A(b,(e,t)=>{console.log("Done button options changed:",{from:t,to:e,currentStep:l.value,tabsLength:we.value.length}),e.disabled!==(null==t?void 0:t.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==t?void 0:t.text)&&console.log(`Done button text changed from "${null==t?void 0:t.text}" to "${e.text}"`)},{deep:!0}),A(g,(e,t)=>{e!==t&&(console.log(`Saving state changed: ${t} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Oe=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Ae=()=>{let e=!1;return Ve(),g.value&&(e=!0),m.value=e,!e},we=S([{title:"Bedside plan",icon:""},{title:"Lab Order Plan",icon:""},{title:"Radiology",icon:""}]),He=S(null),Ne=S(null),Ve=()=>{var e;if(!we.value||0===we.value.length)return console.log("Tabs not yet initialized"),null;const t=l.value>=0&&l.value<we.value.length?l.value:0;switch(null===(e=we.value[t])||void 0===e?void 0:e.title){case"Bedside plan":return"BedsidePlan";case"Lab Order Plan":return"LabOrderPlan";case"Radiology":return"Radiology";default:if(B.NCDActivities.length>0)switch(B.NCDActivities[0]){case"Bedside plan":return"BedsidePlan";case"Lab Order Plan":return"LabOrderPlan";case"Radiology":return"Radiology"}return null}},Re=()=>{v.value=!1,setTimeout(()=>{l.value=0,v.value=!0},0)},Fe=()=>{const e=G();e.setVitals(e.getInitialVitals(M.value.ID))},Me=async()=>{const e=te(Ie.value,"sessionDate","value")||ae.sessionDate(),t=le("vitals");for(let l=0;l<we.value.length;l++){const n=we.value[l];if("Vital Signs"===n.title)we.value[l].icon=Ke(e,t)?V:"";else if("Risk Assessment"===n.title){const t=le("substanceAbuse");we.value[l].icon=Ke(e,t)?V:""}else if("Investigations"===n.title){var a;const t=null==M||null===(a=M.value)||void 0===a||null===(a=a.labOrders)||void 0===a?void 0:a.saved,n=null==t?void 0:t.filter(t=>ae.toStandardHisFormat(e)===ae.toStandardHisFormat(t.order_date));we.value[l].icon=(null==n?void 0:n.length)>0?V:""}else if("Diagnosis"===n.title){const t=le("diagnosis");we.value[l].icon=Ke(e,t)?V:""}else if("Complications Screening"===n.title){const t=le("screening");we.value[l].icon=Ke(e,t)?V:""}else"Treatment Plan"===n.title&&(Be.value.length>0?we.value[l].icon=ne()?V:"":we.value[l].icon="")}Ae()},Ke=(e,t)=>{const a=new Date(e);return a.setHours(0,0,0,0),t.some(e=>{const t=new Date(e.obs_datetime);return t.setHours(0,0,0,0),t.getTime()===a.getTime()})},Ue=async(e,t)=>{var a;const n=null===(a=we.value[t])||void 0===a?void 0:a.title;var i,o;e%1==0&&(l.value=e),"Vital Signs"==n&&(null===(i=He.value)||void 0===i||i.onSubmit()),"Risk Assessment"==n&&(null===(o=Ne.value)||void 0===o||o.onSubmit()),"Complications Screening"==n&&await(async()=>{const e=[],t=await ke(Ce.value),a=await Se(Pe.value),l=await ke(Te.value);var n,i,o,s;t.length>0&&e.push({concept_id:await ce.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:ce.getSessionDate(),child:t}),a.length>0&&e.push({concept_id:await ce.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:ce.getSessionDate(),child:a}),l.length>0&&e.push(...l),e.length>0?(null!==(i=(n=null!==(s=(o=M.value).screening)&&void 0!==s?s:o.screening={}).unsaved)&&void 0!==i||(n.unsaved=[]),M.value.screening.unsaved.push(...e),de("Complications saved successfully")):se("No complications data to save")})(),"Treatment Plan"==n&&await(async()=>{const e=re();if(!xe.isEmpty(e.selectedMedicalAllergiesList)){const t=ue(),a=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:ve.getSessionDate(),value_coded:e.concept_id,location_id:t.facilityLocation.code,value_text:e.name})),l=await he(a);M.value=Object.assign(M.value,l),console.log("Allergies staged successfully:",M.value),e.clearSelectedMedicalAllergiesList()}const t=await Ee();M.value=Object.assign(M.value,t);const a=await _e().saveNonPharmaTherapyPatientData();M.value=Object.assign(M.value,a)})(),await ie(M.value)},ze=async()=>{g.value=!0;try{await oe(),await ie(M.value),i.push("/triageList")}catch(e){console.error("Error saving data:",e),se("Error occurred while saving data. Please try again.")}finally{g.value=!1}};return I(async()=>{0!==B.NCDActivities.length?(fe().resetScreening(),we.value=[{title:"Bedside plan",icon:""},{title:"Lab Order Plan",icon:""},{title:"Radiology",icon:""}],await Me(),(void 0===l.value||l.value<0)&&(l.value=0,console.log("Setting initial tab index to 0")),m.value=!1,g.value=!1,Ae()):i.push("patientProfile")}),A(l,async()=>{await Ae()}),A(j,async()=>{await Me()},{deep:!0}),A(M,async()=>{fe().resetScreening(),await Me()},{deep:!0}),A(Ie,async()=>{await Me()},{deep:!0}),A(K,async()=>{await Me()},{deep:!0}),A(pe,async()=>{await Me()},{deep:!0}),A(ge,async()=>{await Me()},{deep:!0}),A(Be,async()=>{await Me()},{deep:!0}),A(r,async e=>{Re(),Fe(),we.value=[{title:"Bedside plan",icon:""},{title:"Lab Order Plan",icon:""},{title:"Radiology",icon:""}]},{deep:!0}),A(M,async(e,t)=>{e.ID!=t.ID&&(Re(),Fe())},{deep:!0}),t({saveData:ze,markWizard:Me,refreshWizard:Re,validateDoneButtonState:Ae}),(e,t)=>(o(),_(d(N),null,{default:u(()=>[s(ee),s(d(w),{fullscreen:!0},{default:u(()=>[s(me),p("div",tt,[v.value?(o(),_(ye,{key:0,ref:"wizard",headingTitle:"Investigation Plan","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:b.value,"custom-tabs":we.value,beforeChange:d(a),onChange:Ue,"onComplete:wizard":t[1]||(t[1]=e=>ze()),onDoneButtonChanged:Oe},{default:u(()=>[p("div",null,[p("div",at,[s(F,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:d(H),"font-weight":"600",onClick:t[0]||(t[0]=e=>{i.push("/patientProfile")})},null,8,["icon"])])]),c(p("div",null,[s(je,{ref:"bedsidePlanRef"},null,512)],512),[[k,"BedsidePlan"==Ve()]]),c(p("div",null,[s(Ge,{ref:"labOrderPlanRef"},null,512)],512),[[k,"LabOrderPlan"==Ve()]]),c(p("div",null,[s(et,{ref:"radiologyRef"},null,512)],512),[[k,"Radiology"==Ve()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):L("",!0)])]),_:1})]),_:1}))}}))}}});
