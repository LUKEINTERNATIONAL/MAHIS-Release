import{d as G,r as P,eT as de,w as C,e as x,f as R,l as A,u as w,aW as Ue,c as F,a as tt,b as st,i as nt,v as ot,p as at,k as e,m as ue,K as n,cv as it,bf as ke,cw as lt,J,N as rt,Q as ut,L as dt,aI as mt,D as ct,a4 as pt,a7 as ft,ap as vt,eU as gt,H as Q,O as ht}from"./vendor-9T3c-tPq.js";import{aD as K,_ as U,a1 as We,H as ze,u as Ee,T as _t,t as Be,G as St,s as wt}from"../index-Zqy7iC3X.js";import{m as b,o as Z,p as Ot,N as Dt}from"./NeonatalStepper-DqyCFAZs.js";import{u as yt}from"./useNeonatalEnrollmentStore-CxYalRxf.js";import{u as Ft}from"./useSignsSymptomsStore-S9tLtED1.js";import{u as It}from"./useNeonatalVitalsStore-D8n67E0U.js";import{N as bt}from"./neonatal_service-exD9ZkT8.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-qlDaiiMc.js";import"./SaveProgressModal-DZ752BDo.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const At={class:"admission-outcome-wrapper"},Pt=G({__name:"AdmissionOutcomeSection",setup(r,{expose:p}){const l=P(null),d=b[0],v=d.formData,c=d.subtitle,h=de(Z),g=s=>{h&&(h.admissionOutcome=s.admissionOutcome||"")};return C(()=>{var s;return(s=l.value)==null?void 0:s.formValues},s=>{s&&g(s)},{deep:!0}),C(()=>l.value,s=>{s!=null&&s.getFormValues&&g(s.getFormValues())},{immediate:!0}),p({getFormRef:()=>l.value,validateForm:()=>{var s,m;return((m=(s=l.value)==null?void 0:s.validateForm)==null?void 0:m.call(s))||null},getFormValues:()=>{var s,m;return((m=(s=l.value)==null?void 0:s.getFormValues)==null?void 0:m.call(s))||{}}}),(s,m)=>(R(),x("div",At,[A(K,{formData:w(v),subtitle:w(c),ref_key:"formRef",ref:l,class:"main-form"},null,8,["formData","subtitle"])]))}}),Me=U(Pt,[["__scopeId","data-v-8fed0253"]]),Nt={class:"safeguard-concerns-wrapper"},Rt=G({__name:"SafeguardConcernsSection",setup(r,{expose:p}){const l=P(null),d=b[1],v=d.formData,c=d.subtitle;return p({getFormRef:()=>l.value,validateForm:()=>null,getFormValues:()=>({})}),(h,g)=>(R(),x("div",Nt,[A(K,{formData:w(v),subtitle:w(c),ref_key:"formRef",ref:l,class:"main-form"},null,8,["formData","subtitle"])]))}}),$e=U(Rt,[["__scopeId","data-v-2dda68fa"]]);function Ct(r){const p=We(),l=()=>{if(!r.value||!p.user)return null;const c={healthcareWorkerId:p.user.username||"",electronicSignature:d(),userRole:v(),signOffDate:ze.currentDate()};return Object.entries(c).forEach(([h,g])=>{r.value.setFormValue&&r.value.setFormValue(h,g)}),c},d=()=>{if(!p.user)return"";const c=[p.user.given_name,p.user.family_name].filter(Boolean);return c.length>0?c.join(" "):p.user.username||""},v=()=>{var c;return((c=p.user)==null?void 0:c.user_type)||"Clinician"};return C(()=>r.value,c=>{c&&c.setFormValue&&setTimeout(()=>{l()},100)},{immediate:!0}),C(()=>p.user,c=>{c&&r.value&&l()},{deep:!0}),{populateSignOffData:l,userStore:p,getFullName:d,getUserRole:v}}const Tt={class:"admission-signoff-wrapper"},Vt=G({__name:"AdmissionSignOffSection",setup(r,{expose:p}){const l=P(null),d=b[2],v=d.formData,c=d.subtitle,h=de(Z);Ct(l);const g=s=>{h&&(h.healthcareWorkerId=s.healthcareWorkerId||"",h.electronicSignature=s.electronicSignature||"",h.userRole=s.userRole||"",h.signOffDate=s.signOffDate||"")};return C(()=>{var s;return(s=l.value)==null?void 0:s.formValues},s=>{s&&g(s)},{deep:!0}),C(()=>l.value,s=>{s!=null&&s.getFormValues&&g(s.getFormValues())},{immediate:!0}),p({getFormRef:()=>l.value,validateForm:()=>{var s,m;return((m=(s=l.value)==null?void 0:s.validateForm)==null?void 0:m.call(s))||null},getFormValues:()=>{var s,m;return((m=(s=l.value)==null?void 0:s.getFormValues)==null?void 0:m.call(s))||{}}}),(s,m)=>(R(),x("div",Tt,[A(K,{formData:w(v),subtitle:w(c),ref_key:"formRef",ref:l,class:"main-form"},null,8,["formData","subtitle"])]))}}),He=U(Vt,[["__scopeId","data-v-0d826c68"]]),xt={class:"page-header"},Lt={class:"logo-container"},kt=["src"],Bt=["src"],Mt={class:"header-meta"},$t={class:"facility-name"},Ht={class:"facility-details"},Gt={class:"patient-meta"},Ut={key:0,class:"barcode-container"},Wt=["src"],zt={class:"npid-text"},Et={class:"print-page"},Yt={class:"print-column"},jt={class:"print-section"},qt={class:"field-row"},Qt={class:"field-row"},Xt={class:"field-row"},Jt={class:"field-row"},Kt={class:"field-row"},Zt={class:"field-row"},es={class:"field-row"},ts={class:"field-row"},ss={class:"field-row"},ns={class:"field-row"},os={class:"field-row"},as={class:"print-section"},is={class:"field-row"},ls={class:"field-row"},rs={class:"field-row"},us={class:"field-row"},ds={class:"field-row"},ms={class:"field-row"},cs={class:"field-row"},ps={class:"field-row"},fs={class:"field-row"},vs={class:"print-section"},gs={class:"field-row"},hs={class:"field-row"},_s={class:"field-row"},Ss={class:"field-row"},ws={class:"field-row"},Os={class:"field-row"},Ds={class:"field-row"},ys={class:"print-section"},Fs={class:"field-row"},Is={class:"highlight"},bs={class:"field-row"},As={class:"print-column"},Ps={class:"print-section"},Ns={class:"field-row"},Rs={class:"field-row"},Cs={class:"field-row"},Ts={class:"field-row"},Vs={class:"field-row"},xs={class:"field-row"},Ls={class:"field-row"},ks={class:"print-section"},Bs={class:"field-row single-line"},Ms={class:"field-row single-line"},$s={class:"field-row single-line"},Hs={class:"field-row single-line"},Gs={key:0,class:"print-section"},Us={class:"field-row"},Ws={class:"field-row"},zs={class:"field-row"},Es={class:"field-row"},Ys={class:"field-row"},js={class:"field-row"},qs={class:"field-row"},Qs={class:"print-section"},Xs={class:"field-row"},Js={class:"field-row"},Ks={class:"field-row"},Zs={class:"field-row"},en={class:"print-footer"},tn=G({__name:"PrintableAdmissionForm",props:{forceShow:{type:Boolean,default:!1}},setup(r,{expose:p}){const l=Ee(),{patient:d}=Ue(l),v=yt(),c=Ft(),h=It(),g=We(),s=de(Z,{}),m=P(!1),I=P(""),ee=new URL(""+new URL("../neotree.4QnvY_lU.png",import.meta.url).href,import.meta.url).href,S="./mw.png",f=new Map,B=ee,Ye=S,me=async a=>a?f.has(a)?f.get(a):await new Promise(t=>{const u=new Image;u.crossOrigin="anonymous",u.onload=()=>{try{const y=document.createElement("canvas");y.width=u.width,y.height=u.height;const L=y.getContext("2d");if(!L){t(null);return}L.drawImage(u,0,0);const _=y.toDataURL("image/png");f.set(a,_),t(_)}catch(y){console.warn("Image toDataURL failed",y),t(null)}},u.onerror=()=>t(null),u.src=a}):null,Y=F(()=>{var t;const a=(t=d.value)==null?void 0:t.personInformation;return a&&"".concat(a.given_name||""," ").concat(a.family_name||"").trim()||"N/A"}),N=F(()=>{var a,t;return((a=d.value)==null?void 0:a.nationalId)||((t=d.value)==null?void 0:t.patientID)||"N/A"}),ce=F(()=>{var a,t;return((t=(a=d.value)==null?void 0:a.personInformation)==null?void 0:t.gender)||"N/A"}),W=F(()=>{var a,t;return((t=(a=d.value)==null?void 0:a.personInformation)==null?void 0:t.birthdate)||"N/A"}),o=F(()=>{var t;return((t=d.value)==null?void 0:t.patientID)?v.enrollmentForm||{}:{}}),T=F(()=>{var t;return((t=d.value)==null?void 0:t.patientID)&&c.formData||null}),O=F(()=>{var t;return((t=d.value)==null?void 0:t.patientID)&&h.formData||null}),pe=F(()=>{var a;return z((a=o.value)==null?void 0:a.resuscitationMethods)}),te=F(()=>g.userFacilityName||localStorage.getItem("facilityName")||"Healthcare Facility"),j=F(()=>{var a;return((a=g.facilityLocation)==null?void 0:a.code)||localStorage.getItem("facility_code")||"-"}),q=F(()=>{var a;return((a=g.facilityLocation)==null?void 0:a.district)||localStorage.getItem("locationDistrict")||"-"}),je=F(()=>{const a=[te.value];return q.value&&q.value!=="-"&&a.push(q.value),j.value&&j.value!=="-"&&a.push("Code: ".concat(j.value)),a.join(" · ")}),fe=F(()=>s.signOffDate?new Date(s.signOffDate).toLocaleString():new Date().toLocaleString()),i=a=>a==null||a===""?"-":Array.isArray(a)?a.length?a.join(", "):"-":String(a),z=a=>!a||!a.length?"-":a.join(", "),qe=async()=>{var De,ye,Fe,Ie,be,Ae,Pe,Ne,Re,Ce,Te;const[a,t]=await Promise.all([me(ee),me(S)]),u=new it({orientation:"portrait",unit:"pt",format:"a4"}),y=u.internal.pageSize.getWidth(),L=u.internal.pageSize.getHeight(),_=28,he=14,E=(y-_*2-he)/2,Qe=_,Xe=_+E+he,ne=52,oe=52,ae=100,_e=100;let ie,le,k=_+8,M=_;if(a&&(u.addImage(a,"PNG",_,_,ne,ne),M=_+ne+10),t){const D=M;u.addImage(t,"PNG",D,_,oe,oe),M=D+oe+10}u.setFontSize(14),u.setFont("helvetica","bold"),u.text(String(te.value||"Facility"),M,k),k+=18,u.text("Neotree Malawi · Tertiary Admission Form",M,k),u.setFontSize(11),u.setFont("helvetica","normal"),k+=16,["Patient: ".concat(i(Y.value)),"NPID: ".concat(i(N.value)),"DOB: ".concat(i(W.value))].forEach(D=>{u.text(D,M,k),k+=14});const re=i(N.value);let Se=_;if(re&&re!=="-")try{const D=await ke.toDataURL(re,{width:ae,margin:1}),$=y-_-ae,H=_;u.addImage(D,"PNG",$,H,ae,_e),Se=H+_e}catch(D){console.warn("QR generation failed",D)}const we=Math.max(k,Se+6)+12;ie=we,le=we;const V=(D,$,H)=>{const Ve=H==="left"?Qe:Xe,xe=H==="left"?ie:le;lt(u,{startY:xe,margin:{left:Ve,right:y-Ve-E},tableWidth:E,head:[[D,""]],body:$.map(([Ze,et])=>[Ze,i(et)]),theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[232,232,232],textColor:20,fontStyle:"bold"},columnStyles:{0:{cellWidth:E*.48},1:{cellWidth:E*.52,halign:"right"}}});const Le=u.lastAutoTable.finalY||xe;H==="left"?ie=Le+10:le=Le+10};V("Birth Details",[["Twin",o.value.hasTwin],["Place of birth",o.value.placeOfBirth],["Birth facility",o.value.nameOfBirthFacility],["Type of birth",o.value.typeOfBirth],["Birth weight (g)",o.value.birthWeight],["Gestation (weeks)",o.value.gestationWeeks],["APGAR (1 min)",o.value.apgarScoreAt1],["APGAR (5 min)",o.value.apgarScoreAt5],["APGAR (10 min)",o.value.apgarScoreAt10],["Cried after birth",o.value.criedAfterBirth],["Resuscitation",pe.value]],"left"),V("Pregnancy & Delivery",[["Mode of delivery",o.value.modeOfDelivery],["Rupture of membranes",o.value.ruptureOfMembranes],["Duration of ROM",o.value.durationOfRuptureMembranes],["Offensive liquor",o.value.offensiveLiquor],["Meconium present",o.value.meconiumPresent],["Maternal analgesia",o.value.maternalAnalgesia],["Anaesthesia used",o.value.anesthesiaUsed],["Steroids given",o.value.steroidsGiven],["Gestation assessment",o.value.gestationMethodAssessment]],"left"),V("Maternal Information",[["Mother name",o.value.motherName],["Mother NPID",o.value.motherNationalId],["HIV status",o.value.motherHivStatus],["Last HIV test",o.value.lastHivTestDate],["VDRL result",o.value.motherVdrlResult],["Hepatitis result",o.value.motherHepatitisResult],["Tetanus/Diphtheria",z(o.value.tetanusDiphtheria)]],"left"),V("Admission Outcome",[["Outcome",s.admissionOutcome],["Safeguard concerns",s.safeguardConcerns]],"left"),V("Patient Information",[["Name",Y.value],["NPID",N.value],["Gender",ce.value],["Date of birth",W.value||W],["Admitted from",o.value.admittedFrom],["Referred from",o.value.referredFrom],["Transport mode",o.value.modeOfTransport]],"right"),V("Presenting Complaints",[["Complaints",z((De=T.value)==null?void 0:De.presenting_complaints)],["Onset",(ye=T.value)==null?void 0:ye.symptom_onset_time],["Severity",(Fe=T.value)==null?void 0:Fe.symptom_severity],["Notes",(Ie=T.value)==null?void 0:Ie.detailed_assessment_notes]],"right"),V("Vital Signs",[["Temp (°C)",(be=O.value)==null?void 0:be.temperature],["Heart rate",(Ae=O.value)==null?void 0:Ae.heart_rate],["Resp rate",(Pe=O.value)==null?void 0:Pe.respiratory_rate],["Oxygen saturation",(Ne=O.value)==null?void 0:Ne.oxygen_saturation],["Blood sugar",(Re=O.value)==null?void 0:Re.blood_sugar],["Current weight (g)",(Ce=O.value)==null?void 0:Ce.current_weight],["Head circumference",(Te=O.value)==null?void 0:Te.head_circumference]],"right"),V("Sign-off",[["Healthcare Worker",s.healthcareWorkerId],["Role/Cadre",s.userRole],["Signature",s.electronicSignature],["Date",fe.value]],"right");const Oe=u.getNumberOfPages(),Je="Generated: ".concat(new Date().toLocaleString());for(let D=1;D<=Oe;D++){u.setPage(D),u.setFontSize(8),u.setFont("helvetica","normal");const $=L-16;u.text(Je,_,$,{align:"left"}),u.text("Page ".concat(D," of ").concat(Oe),y-_,$,{align:"right"})}const Ke="admission-summary-".concat(N.value||"patient",".pdf");u.save(Ke)},se=async()=>{const a=i(N.value);if(!a||a==="-"){I.value="";return}try{I.value=await ke.toDataURL(a,{width:140,margin:1})}catch(t){console.error("Error generating QR:",t),I.value=""}},ve=()=>{m.value=!0,setTimeout(se,50)},ge=()=>{m.value=!1};return tt(()=>{window.addEventListener("beforeprint",ve),window.addEventListener("afterprint",ge)}),st(()=>{window.removeEventListener("beforeprint",ve),window.removeEventListener("afterprint",ge)}),C([N,m],()=>{m.value&&setTimeout(se,50)}),p({showPreview:()=>{m.value=!0,setTimeout(se,50)},hidePreview:()=>{m.value=!1},exportPdf:qe}),(a,t)=>{var u,y,L,_;return nt((R(),x("div",{class:at(["printable-admission-form",{"preview-mode":r.forceShow,"print-mode":!r.forceShow}])},[e("header",xt,[e("div",Lt,[e("img",{src:w(B),alt:"Neotree logo",class:"header-logo"},null,8,kt),e("img",{src:w(Ye),alt:"Coat of arms",class:"header-logo app-logo"},null,8,Bt)]),e("div",Mt,[e("div",$t,n(te.value),1),e("div",Ht,n(q.value)+" · Code: "+n(j.value),1),t[0]||(t[0]=e("div",{class:"form-title"},"Neotree Malawi · Tertiary Admission Form",-1)),e("div",Gt,[e("span",null,"Patient: "+n(Y.value),1),e("span",null,"NPID: "+n(N.value),1),e("span",null,"DOB: "+n(W.value),1)])]),r.forceShow?ue("",!0):(R(),x("div",Ut,[I.value?(R(),x("img",{key:0,src:I.value,class:"qr-img",alt:"Patient QR"},null,8,Wt)):ue("",!0),e("div",zt,n(N.value),1)]))]),e("div",Et,[e("div",Yt,[e("section",jt,[t[12]||(t[12]=e("h3",{class:"section-title"},"Birth Details",-1)),e("div",qt,[t[1]||(t[1]=e("span",null,"Twin",-1)),e("span",null,n(i(o.value.hasTwin)),1)]),e("div",Qt,[t[2]||(t[2]=e("span",null,"Place of birth",-1)),e("span",null,n(i(o.value.placeOfBirth)),1)]),e("div",Xt,[t[3]||(t[3]=e("span",null,"Birth facility",-1)),e("span",null,n(i(o.value.nameOfBirthFacility)),1)]),e("div",Jt,[t[4]||(t[4]=e("span",null,"Type of birth",-1)),e("span",null,n(i(o.value.typeOfBirth)),1)]),e("div",Kt,[t[5]||(t[5]=e("span",null,"Birth weight (g)",-1)),e("span",null,n(i(o.value.birthWeight)),1)]),e("div",Zt,[t[6]||(t[6]=e("span",null,"Gestation (weeks)",-1)),e("span",null,n(i(o.value.gestationWeeks)),1)]),e("div",es,[t[7]||(t[7]=e("span",null,"APGAR (1 min)",-1)),e("span",null,n(i(o.value.apgarScoreAt1)),1)]),e("div",ts,[t[8]||(t[8]=e("span",null,"APGAR (5 min)",-1)),e("span",null,n(i(o.value.apgarScoreAt5)),1)]),e("div",ss,[t[9]||(t[9]=e("span",null,"APGAR (10 min)",-1)),e("span",null,n(i(o.value.apgarScoreAt10)),1)]),e("div",ns,[t[10]||(t[10]=e("span",null,"Cried after birth",-1)),e("span",null,n(i(o.value.criedAfterBirth)),1)]),e("div",os,[t[11]||(t[11]=e("span",null,"Resuscitation",-1)),e("span",null,n(pe.value),1)])]),e("section",as,[t[22]||(t[22]=e("h3",{class:"section-title"},"Pregnancy & Delivery",-1)),e("div",is,[t[13]||(t[13]=e("span",null,"Mode of delivery",-1)),e("span",null,n(i(o.value.modeOfDelivery)),1)]),e("div",ls,[t[14]||(t[14]=e("span",null,"Rupture of membranes",-1)),e("span",null,n(i(o.value.ruptureOfMembranes)),1)]),e("div",rs,[t[15]||(t[15]=e("span",null,"Duration of ROM",-1)),e("span",null,n(i(o.value.durationOfRuptureMembranes)),1)]),e("div",us,[t[16]||(t[16]=e("span",null,"Offensive liquor",-1)),e("span",null,n(i(o.value.offensiveLiquor)),1)]),e("div",ds,[t[17]||(t[17]=e("span",null,"Meconium present",-1)),e("span",null,n(i(o.value.meconiumPresent)),1)]),e("div",ms,[t[18]||(t[18]=e("span",null,"Maternal analgesia",-1)),e("span",null,n(i(o.value.maternalAnalgesia)),1)]),e("div",cs,[t[19]||(t[19]=e("span",null,"Anaesthesia used",-1)),e("span",null,n(i(o.value.anesthesiaUsed)),1)]),e("div",ps,[t[20]||(t[20]=e("span",null,"Steroids given",-1)),e("span",null,n(i(o.value.steroidsGiven)),1)]),e("div",fs,[t[21]||(t[21]=e("span",null,"Gestation assessment",-1)),e("span",null,n(i(o.value.gestationMethodAssessment)),1)])]),e("section",vs,[t[30]||(t[30]=e("h3",{class:"section-title"},"Maternal Information",-1)),e("div",gs,[t[23]||(t[23]=e("span",null,"Mother name",-1)),e("span",null,n(i(o.value.motherName)),1)]),e("div",hs,[t[24]||(t[24]=e("span",null,"Mother NPID",-1)),e("span",null,n(i(o.value.motherNationalId)),1)]),e("div",_s,[t[25]||(t[25]=e("span",null,"HIV status",-1)),e("span",null,n(i(o.value.motherHivStatus)),1)]),e("div",Ss,[t[26]||(t[26]=e("span",null,"Last HIV test",-1)),e("span",null,n(i(o.value.lastHivTestDate)),1)]),e("div",ws,[t[27]||(t[27]=e("span",null,"VDRL result",-1)),e("span",null,n(i(o.value.motherVdrlResult)),1)]),e("div",Os,[t[28]||(t[28]=e("span",null,"Hepatitis result",-1)),e("span",null,n(i(o.value.motherHepatitisResult)),1)]),e("div",Ds,[t[29]||(t[29]=e("span",null,"Tetanus/Diphtheria",-1)),e("span",null,n(z(o.value.tetanusDiphtheria)),1)])]),e("section",ys,[t[33]||(t[33]=e("h3",{class:"section-title"},"Admission Outcome",-1)),e("div",Fs,[t[31]||(t[31]=e("span",null,"Outcome",-1)),e("span",Is,n(i(w(s).admissionOutcome)),1)]),e("div",bs,[t[32]||(t[32]=e("span",null,"Safeguard concerns",-1)),e("span",null,n(i(w(s).safeguardConcerns)),1)])])]),e("div",As,[e("section",Ps,[t[41]||(t[41]=e("h3",{class:"section-title"},"Patient Information",-1)),e("div",Ns,[t[34]||(t[34]=e("span",null,"Name",-1)),e("span",null,n(Y.value),1)]),e("div",Rs,[t[35]||(t[35]=e("span",null,"NPID",-1)),e("span",null,n(N.value),1)]),e("div",Cs,[t[36]||(t[36]=e("span",null,"Gender",-1)),e("span",null,n(ce.value),1)]),e("div",Ts,[t[37]||(t[37]=e("span",null,"Date of birth",-1)),e("span",null,n(W.value),1)]),e("div",Vs,[t[38]||(t[38]=e("span",null,"Admitted from",-1)),e("span",null,n(i(o.value.admittedFrom)),1)]),e("div",xs,[t[39]||(t[39]=e("span",null,"Referred from",-1)),e("span",null,n(i(o.value.referredFrom)),1)]),e("div",Ls,[t[40]||(t[40]=e("span",null,"Transport mode",-1)),e("span",null,n(i(o.value.modeOfTransport)),1)])]),e("section",ks,[t[46]||(t[46]=e("h3",{class:"section-title"},"Presenting Complaints",-1)),e("div",Bs,[t[42]||(t[42]=e("span",null,"Complaints",-1)),e("span",null,n(z((u=T.value)==null?void 0:u.presenting_complaints)),1)]),e("div",Ms,[t[43]||(t[43]=e("span",null,"Onset",-1)),e("span",null,n(i((y=T.value)==null?void 0:y.symptom_onset_time)),1)]),e("div",$s,[t[44]||(t[44]=e("span",null,"Severity",-1)),e("span",null,n(i((L=T.value)==null?void 0:L.symptom_severity)),1)]),e("div",Hs,[t[45]||(t[45]=e("span",null,"Notes",-1)),e("span",null,n(i((_=T.value)==null?void 0:_.detailed_assessment_notes)),1)])]),O.value?(R(),x("section",Gs,[t[54]||(t[54]=e("h3",{class:"section-title"},"Vital Signs",-1)),e("div",Us,[t[47]||(t[47]=e("span",null,"Temp (°C)",-1)),e("span",null,n(i(O.value.temperature)),1)]),e("div",Ws,[t[48]||(t[48]=e("span",null,"Heart rate",-1)),e("span",null,n(i(O.value.heart_rate)),1)]),e("div",zs,[t[49]||(t[49]=e("span",null,"Resp rate",-1)),e("span",null,n(i(O.value.respiratory_rate)),1)]),e("div",Es,[t[50]||(t[50]=e("span",null,"Oxygen saturation",-1)),e("span",null,n(i(O.value.oxygen_saturation)),1)]),e("div",Ys,[t[51]||(t[51]=e("span",null,"Blood sugar",-1)),e("span",null,n(i(O.value.blood_sugar)),1)]),e("div",js,[t[52]||(t[52]=e("span",null,"Current weight (g)",-1)),e("span",null,n(i(O.value.current_weight)),1)]),e("div",qs,[t[53]||(t[53]=e("span",null,"Head circumference",-1)),e("span",null,n(i(O.value.head_circumference)),1)])])):ue("",!0),e("section",Qs,[t[59]||(t[59]=e("h3",{class:"section-title"},"Sign-off",-1)),e("div",Xs,[t[55]||(t[55]=e("span",null,"Healthcare Worker",-1)),e("span",null,n(i(w(s).healthcareWorkerId)),1)]),e("div",Js,[t[56]||(t[56]=e("span",null,"Role/Cadre",-1)),e("span",null,n(i(w(s).userRole)),1)]),e("div",Ks,[t[57]||(t[57]=e("span",null,"Signature",-1)),e("span",null,n(i(w(s).electronicSignature)),1)]),e("div",Zs,[t[58]||(t[58]=e("span",null,"Date",-1)),e("span",null,n(fe.value),1)])])])]),e("div",en,[e("span",null,"Generated: "+n(new Date().toLocaleString()),1),e("span",null,n(je.value),1)])],2)),[[ot,r.forceShow||m.value]])}}}),sn=U(tn,[["__scopeId","data-v-4732c624"]]),nn={class:"print-summary-wrapper"},on={class:"print-content"},an={class:"print-actions"},ln=G({__name:"PrintSummarySection",setup(r,{expose:p}){const l=P(null),d=P(null),v=P(null),c=b[3],h=c.formData,g=c.subtitle,s=async()=>{var m,I;if((m=d.value)!=null&&m.exportPdf){await d.value.exportPdf();return}(I=v.value)!=null&&I.exportPdf&&await v.value.exportPdf()};return p({getFormRef:()=>l.value,validateForm:()=>null,getFormValues:()=>({})}),(m,I)=>(R(),x("div",nn,[A(K,{formData:w(h),subtitle:w(g),ref_key:"formRef",ref:l,class:"main-form"},{printSection:J(()=>[e("div",on,[e("div",an,[A(w(rt),{expand:"block",color:"primary",onClick:s,class:"print-button"},{default:J(()=>[A(w(dt),{icon:w(mt),slot:"start"},null,8,["icon"]),I[0]||(I[0]=ut(" Print Admission Summary ",-1))]),_:1})])])]),_:1},8,["formData","subtitle"]),A(sn,{ref_key:"printablePrintRef",ref:v},null,512)]))}}),Ge=U(ln,[["__scopeId","data-v-69ee3821"]]),X=()=>JSON.parse(JSON.stringify(Ot)),rn=ct("neonatalAdmissionOutcomesStore",{state:()=>({activePatientId:null,admissionOutcomesForm:X(),admissionOutcomesFormCache:{}}),getters:{getActivePatientId(){return this.activePatientId}},actions:{initializeAdmissionOutcomesForm(r){if(r==null){this.activePatientId=null,Object.assign(this.admissionOutcomesForm,X());return}this.activePatientId=r;const p=this.admissionOutcomesFormCache[String(r)];p?Object.assign(this.admissionOutcomesForm,p):Object.assign(this.admissionOutcomesForm,X()),this.saveAdmissionOutcomesSnapshot()},saveAdmissionOutcomesSnapshot(){this.activePatientId!=null&&(this.admissionOutcomesFormCache[String(this.activePatientId)]=JSON.parse(JSON.stringify(this.admissionOutcomesForm)))},resetAdmissionOutcomesForm(){Object.assign(this.admissionOutcomesForm,X()),this.saveAdmissionOutcomesSnapshot()},clearAdmissionOutcomesForm(r){delete this.admissionOutcomesFormCache[String(r)],this.activePatientId===r&&this.resetAdmissionOutcomesForm()}},persist:{paths:["activePatientId","admissionOutcomesForm","admissionOutcomesFormCache"]}}),un=G({name:"NeonatalAdmissionOutcomes",components:{IonPage:ft,IonContent:pt,Toolbar:_t,NeonatalStepper:Dt,AdmissionOutcomeSection:Me,SafeguardConcernsSection:$e,AdmissionSignOffSection:He,PrintSummarySection:Ge},setup(){const r=vt(),p=Ee(),{patient:l}=Ue(p),d=P(!1),v=rn(),c=S=>{const f=Number(S);return Number.isFinite(f)?f:null},h=()=>{var f;const S=c((f=l.value)==null?void 0:f.patientID);v.initializeAdmissionOutcomesForm(S)};h(),C(()=>{var S;return(S=l.value)==null?void 0:S.patientID},()=>h());const g=v.admissionOutcomesForm;gt(Z,g),C(()=>v.admissionOutcomesForm,()=>v.saveAdmissionOutcomesSnapshot(),{deep:!0});const s=P(b.map((S,f)=>({title:S.title,number:f+1,checked:!1,class:f===0?"open_step common_step":"common_step",last_step:f===b.length-1?"last_step":""}))),m=[{title:b[0].title,value:"1",component:Me,configIndex:0},{title:b[1].title,value:"2",component:$e,configIndex:1},{title:b[2].title,value:"3",component:He,configIndex:2,buttonText:"SIGN"},{title:b[3].title,value:"4",component:Ge,configIndex:3}];return{router:r,patient:l,admissionOutcomesFormData:g,stepperTitle:"Admission Outcomes",currentOpenStepper:"1",wizardData:s,stepperData:m,updateStatus:S=>{S&&S.value&&s.value.forEach((f,B)=>{S.value===(B+1).toString()?(f.class="open_step common_step",f.checked=!1):B<parseInt(S.value)-1?(f.class="common_step color_white",f.checked=!0):(f.class="common_step",f.checked=!1)})},getSaveFunction:S=>S===m.length-1?async()=>{var f;if(!((f=l.value)!=null&&f.patientID)){Be("No patient selected");return}if(!d.value)try{if(d.value=!0,!g.admissionOutcome){Be("Please select an admission outcome"),d.value=!1;return}await bt.saveAdmissionOutcomes(l.value.patientID,g,ze.sessionDate()),St("Admission outcomes saved successfully"),v.clearAdmissionOutcomesForm(l.value.patientID),r.push({name:"neonatalPatientProfile"})}catch(B){console.error("Failed to save admission outcomes",B),wt("Failed to save admission outcomes. Please try again."),d.value=!1}}:null,isSaving:d,neonatalAdmissionOutcomesSections:b}}});function dn(r,p,l,d,v,c){const h=Q("Toolbar"),g=Q("NeonatalStepper"),s=Q("ion-content"),m=Q("ion-page");return R(),ht(m,{class:"neonatal-admission-outcomes-page"},{default:J(()=>[A(h),A(s,{fullscreen:!0},{default:J(()=>[A(g,{wizardData:r.wizardData,StepperData:r.stepperData,stepperTitle:r.stepperTitle,openStepper:r.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:r.getSaveFunction,flowType:"admissionOutcomes",sectionsConfig:r.neonatalAdmissionOutcomesSections,useSkipLogic:!0,onUpdateStatus:r.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","sectionsConfig","onUpdateStatus"])]),_:1})]),_:1})}const Fn=U(un,[["render",dn],["__scopeId","data-v-780323dd"]]);export{Fn as default};
