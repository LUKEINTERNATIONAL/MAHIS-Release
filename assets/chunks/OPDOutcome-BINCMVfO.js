import{d as re,b2 as we,r as o,c as K,a as Ae,H as ge,e as w,f as l,l as u,m as b,O as x,J as y,k as c,u as r,a6 as le,Q as F,F as te,w as fe,av as ya,c1 as za,P as pe,aM as Ka,K as P,p as ta,bz as Ja,af as Xa,L as Be,eA as na,eB as oa,bq as Me,bb as sa,eC as ia,eD as la,dc as ra,eE as ca,eF as da,eG as ua,dh as ma,c0 as Qa,at as Je,ax as Za,c8 as et,n as me,a2 as U,bF as at,aj as Ke,ai as be,N as ce,by as de,ac as tt,br as Ne,b3 as nt,bt as va,aa as ba,c6 as ot,bB as st,ah as ga,R as it,bw as lt,aS as rt,aE as ct,be as pa,bC as dt,dy as ut,ed as Ge,aV as mt,ad as ha}from"./vendor-BTebhqHt.js";import{u as _e,n as ee,x as Ve,y as pt,aZ as ht,z as Ye,D as De,a0 as ft,t as ue,S as Ie,J as z,b as Z,F as Fe,_ as ke,ao as ie,H as Se,bf as _a,P as Ca,b1 as Pe,o as yt,b8 as Da,$ as vt,B as ve,aH as qe,c as bt,ax as We,w as fa,aB as je,b2 as gt,aA as _t}from"../index-DBQF-8Xn.js";import{e as Ct,a as Dt,m as wt,b as At,v as kt,c as Ot,_ as xt}from"./LevelOfConsciousness.vue_vue_type_script_setup_true_lang-ecrTZXZY.js";import{u as Pt,p as St}from"./previousComplaints-Q0LZx8D5.js";import{P as Tt}from"./patient_complaints_service-DHyU6P9S.js";import{D as Et}from"./DashBox-DKevRKsj.js";import{A as Nt,D as It,a as Ft}from"./NextAppointment-Dgqwcs2A.js";import{a as Ht,b as Vt}from"./drug_prescription_service-nTQSIINm.js";import{P as Bt}from"./nonPharmaTherapyStore-Di9r8tlh.js";import{l as Ce}from"./lodash-NJiRuGo9.js";import{_ as ze,D as Mt,A as Yt,R as $t,a as Rt,b as Lt}from"./Outcome-Byh15Hmo.js";const Ut={key:0},Gt={style:{"align-content":"center"}},qt={class:"ion-padding",slot:"content"},Wt=re({__name:"PresentingComplaints",setup(m,{expose:v}){const s=Pt(),{presentingComplaints:t}=we(s),S=_e(),{patient:A}=we(S),V=o(ee),B=o(!0),i=o(!1),e=o(!1),a=o(!0),f=o(!1),_=o([]),d=o([]),D=o(),E=o(null),$=o(null),M=(n,p)=>{var Oe,He;if(!n||!p)return null;const T=(He=(Oe=A.value)==null?void 0:Oe.personInformation)==null?void 0:He.birthdate;if(!T)return null;const H=Number(n);if(isNaN(H)||H<=0)return null;const k=new Date(T),R=new Date,j=R.getTime()-k.getTime();let he;switch(p){case"Hours":he=j/(1e3*60*60);break;case"Days":he=j/(1e3*60*60*24);break;case"Weeks":he=j/(1e3*60*60*24*7);break;case"Months":const Te=R.getFullYear()-k.getFullYear(),$e=R.getMonth()-k.getMonth();he=Te*12+$e,R.getDate()<k.getDate()&&he--;break;case"Years":he=R.getFullYear()-k.getFullYear(),(R.getMonth()<k.getMonth()||R.getMonth()===k.getMonth()&&R.getDate()<k.getDate())&&he--;break;default:return null}return H>he?"Duration cannot be before patient's birth date":null},N=K(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:ee.search,hideSelected:!0,validation:n=>h(n==null?void 0:n.name,_.value)?"Presenting complaint already added":Ve.required(n),options:d.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:ee.time,validation:n=>{E.value=n;const p=Ve.isNotEmptyandNumber(n);if(p)return p;const T=$.value;if(!T)return null;const H=M(n,T);return console.log("Birthdate validation result:",H),H},grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:n=>($.value=n,!n||n===""?"Please select a unit.":null)},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:ee.editPen,validation:n=>h(n,_.value)?"Presenting complaint already added":Ve.required(n),condition:n=>{var p;return((p=n==null?void 0:n.PresentingComplaints)==null?void 0:p.name)==="Other"}},{componentType:"Alert",condition:n=>{var p;return Ve.required((p=n==null?void 0:n.PresentingComplaints)==null?void 0:p.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:Y}=pt(),L=async()=>{d.value=await Tt.getComplaintsList("Presenting complaint"),ft(t.value,"PresentingComplaints","multiSelectData",d.value)},J=()=>{B.value=!1,a.value=!1,e.value=!0},G=async()=>{var T,H;const n=(T=Y.value)==null?void 0:T.getFormValues();if(n.duration&&n.duration_unit){console.log("Validating duration against birthdate...");const k=M(n.duration,n.duration_unit);if(console.log("Validation result:",k),k){ue(k);return}}else console.log("Skipping birthdate validation - missing duration or unit");((H=Y.value)==null?void 0:H.validateForm())==null&&(X(n),e.value=!1,a.value=!0)},X=n=>{var k;const p=n.duration+" "+n.duration_unit,T=n.PresentingComplaints,H=T.name==="Other"?n["Other (specify)"]:T.name;_.value.push({actionBtn:!0,btn:["delete"],name:H,concept_id:T.concept_id,duration:T.duration,durationUnits:T.duration_unit,display:[H,p],data:[{concept_id:8578,value_coded:T.concept_id,obs_datetime:Ie.getSessionDate(),child:[{concept_id:T.concept_id,value_text:p,obs_datetime:Ie.getSessionDate()}]}]}),(k=Y.value)==null||k.resetForm(),f.value=!0,q()},q=()=>{const n=["Cough","Convulsions"];i.value=_.value.some(p=>n.includes(p.name))},h=(n,p)=>p.some(T=>T.name===n),I=n=>{_.value=_.value.filter(p=>p.display[0]!==n.name)},ne=async()=>{const n=await z.getObsByEncounterIdAndDate(Z.PRESENTING_COMPLAINTS),p=_.value.flatMap(T=>T.data);return p.length<=0&&n.length<=0?(ue("Presenting complaints is required"),!1):(p.length<=0||(await z.addObsToEncounterPatient(p,Z.PRESENTING_COMPLAINTS),Fe("Presenting complaints saved successful"),_.value=[]),!0)};return Ae(async()=>{await L()}),v({onSubmit:ne}),(n,p)=>{const T=ge("ion-row"),H=ge("ion-label"),k=ge("ion-accordion"),R=ge("ion-accordion-group");return l(),w(te,null,[u(Et,{status:B.value,content:"No presenting complaints added"},null,8,["status"]),f.value?(l(),w("span",Ut,[u(ht,{listData:_.value,"onClicked:delete":I},null,8,["listData"])])):b("",!0),e.value?(l(),x(T,{key:1},{default:y(()=>[u(Ye,{formData:N.value,ref_key:"formRef",ref:Y},null,8,["formData"]),c("div",Gt,[u(De,{fill:"clear",icon:V.value.plus,iconSlot:"icon-only","onClicked:btn":p[0]||(p[0]=j=>G()),name:"Save"},null,8,["icon"])])]),_:1})):b("",!0),a.value?(l(),x(T,{key:2,style:{"margin-top":"10px"}},{default:y(()=>[u(De,{fill:"clear",icon:V.value.plus,iconSlot:"icon-only","onClicked:btn":p[1]||(p[1]=j=>J()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):b("",!0),u(T,null,{default:y(()=>[u(R,{ref_key:"accordionGroup",ref:D,class:"previousView"},{default:y(()=>[u(k,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(H,{class:"previousLabel"},{default:y(()=>[...p[2]||(p[2]=[F("Previous presenting complaints",-1)])]),_:1})]),_:1}),c("div",qt,[u(St)])]),_:1})]),_:1},512)]),_:1})],64)}}}),jt=ke(Wt,[["__scopeId","data-v-482c7b52"]]),zt={class:"visit-section"},Kt={class:"section-header"},Jt={key:0,class:"no-data"},Xt={key:1,class:"allergy-accordion"},Qt=["onClick"],Zt={class:"acc-left"},en={class:"acc-title"},an={class:"acc-count"},tn={key:0,class:"accordion-body"},nn={class:"item-label"},on={class:"item-value"},sn=re({__name:"AllergiesListing",setup(m){const v=_e(),{patient:s}=we(v),t=o({}),S=o([]),A={antiviral:/abacavir|lamivudine|lopinavir|ritonavir|zidovudine|efavirenz|tenofovir/i,antibiotic:/penicillin|amoxicillin|cephalexin|azithromycin|ciprofloxacin|doxycycline/i,analgesic:/aspirin|ibuprofen|acetaminophen|morphine|codeine|tramadol/i,cardiac:/metoprolol|lisinopril|amlodipine|atorvastatin|warfarin/i,activated:/activated\s+charcoal/i},V={985:{name:"Drug Allergy",severity:"danger"},7759:{name:"Location/Environmental",severity:"info"},7579:{name:"Medical Condition",severity:"warning"},drug:{name:"Drug Allergy",severity:"danger"},food:{name:"Food Allergy",severity:"danger"},environmental:{name:"Environmental",severity:"warning"},contact:{name:"Contact Allergy",severity:"warning"},unknown:{name:"Drug Allergy",severity:"danger"}},B=D=>{const E=D.toLowerCase();return A.antiviral.test(E)?"Antiviral Medication":A.antibiotic.test(E)?"Antibiotic":A.analgesic.test(E)?"Pain Medication":A.cardiac.test(E)?"Cardiac Medication":A.activated.test(E)?"Detoxification Agent":"Medication"},i=async()=>{var D;try{if(!((D=s.value)!=null&&D.patientID))return;const E=await z.getObsByEncounterIdAndDate(Z.MEDICAL_HISTORY),$=await ie.getConceptID("Allergic"),M=E.filter(Y=>Y.concept_id===$);S.value=await Promise.all(M.map(async Y=>{var q,h;const L=((q=Y.value_coded)==null?void 0:q.toString())||"unknown",J=await ie.getConceptName(Y.value_coded);let G=((h=V[L])==null?void 0:h.name)||"Drug Allergy",X=Y.value_text||J||"Unknown";return L==="985"&&Y.value_text&&(G=B(Y.value_text)),{name:G,displayValue:X,date:Y.obs_datetime||Y.encounter_datetime,conceptId:L}}));const N=Object.keys(a.value);N.length>0&&(t.value[N[0]]=!0)}catch(E){console.error("Error loading allergies:",E)}},e=K(()=>S.value.length>0),a=K(()=>{const D={};S.value.forEach(M=>{const N=M.date?_(M.date):"Unknown Date";D[N]||(D[N]=[]),D[N].push(M)});const E={};return Object.keys(D).sort((M,N)=>M==="Unknown Date"?1:N==="Unknown Date"?-1:new Date(N).getTime()-new Date(M).getTime()).forEach(M=>{E[M]=D[M]}),E}),f=D=>{t.value[D]=!t.value[D]},_=D=>{if(!D)return"Unknown Date";try{return new Date(D).toISOString().split("T")[0]}catch(E){return"Unknown Date"}},d=D=>{if(D==="Unknown Date")return"Unknown Date";try{const E=new Date(D),$=Se.sessionDate(),M=new Date($),N=new Date(M);N.setDate(N.getDate()-1);const Y=E.toDateString(),L=M.toDateString(),J=N.toDateString();return Y===L?"Today":Y===J?"Yesterday":E.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(E){return D}};return fe(()=>{var D;return(D=s.value)==null?void 0:D.patientID},async D=>{D&&await i()},{immediate:!0}),fe(()=>{var D;return(D=s.value)==null?void 0:D.observations},async(D,E)=>{D!==E&&await i()},{deep:!0}),Ae(async()=>{await i()}),(D,E)=>{const $=ge("ion-icon");return l(),w("div",zt,[c("div",Kt,[u($,{icon:r(ya),class:"section-icon"},null,8,["icon"]),E[0]||(E[0]=c("h3",null,"Allergies",-1))]),e.value?(l(),w("div",Xt,[(l(!0),w(te,null,pe(a.value,(M,N)=>(l(),w("div",{key:N,class:"accordion-section"},[c("div",{class:ta(["accordion-header",{open:t.value[N]}]),onClick:Y=>f(N)},[c("div",Zt,[u($,{icon:r(Ka),class:"acc-icon"},null,8,["icon"]),c("span",en,P(d(N)),1),c("span",an,"("+P(M.length)+")",1)]),u($,{icon:r(Ja),class:ta(["chevron",{rotate:t.value[N]}])},null,8,["icon","class"])],10,Qt),t.value[N]?(l(),w("div",tn,[(l(!0),w(te,null,pe(M,(Y,L)=>(l(),w("div",{class:"allergy-item",key:L},[c("span",nn,P(Y.name)+":",1),c("span",on,P(Y.displayValue),1)]))),128))])):b("",!0)]))),128))])):(l(),w("div",Jt,[u($,{icon:r(za),class:"no-data-icon"},null,8,["icon"]),E[1]||(E[1]=c("p",null,"No known allergies",-1))]))])}}}),wa=ke(sn,[["__scopeId","data-v-b14ceaf9"]]),ln=re({name:"VisitHistory",components:{AllergiesListing:wa,IonIcon:Be},setup(){const m=_a();return{selectedAllergiesList2:K(()=>m.selectedMedicalAllergiesList),alertCircleOutline:ya,documentTextOutline:et,femaleOutline:Za,medicalOutline:Je,warningOutline:Qa,bodyOutline:na,eyeOutline:ma,nutritionOutline:ua,fitnessOutline:la,pulseOutline:sa,earOutline:da,happyOutline:ca,manOutline:ra,moveOutline:ia,addOutline:Me,scanOutline:oa}},data(){return{presentingComplaintsWithDuration:[],pastMedicalHistory:[],levelOfConsciousness:{eyeResponse:null,verbalResponse:null,motorResponse:null},pregnancy:{patientPregnant:null,breastFeeding:null},allergyList:[],physicalExamCategories:{Eyes:{icon:ma,abnormalities:[],normal:!1},Mouth:{icon:ua,abnormalities:[],normal:!1},Ears:{icon:da,abnormalities:[],normal:!1},Face:{icon:ca,abnormalities:[],normal:!1},Neck:{icon:ra,abnormalities:[],normal:!1},Chest:{icon:la,abnormalities:[],normal:!1},"Chest Movement":{icon:ia,abnormalities:[],normal:!1},"Heart Sounds":{icon:sa,abnormalities:[],normal:!1},"Breath Sounds":{icon:Me,abnormalities:[],normal:!1},"Added Breath Sounds":{icon:Me,abnormalities:[],normal:!1},"Abdominal Inspection":{icon:oa,abnormalities:[],normal:!1},"Genital Examination":{icon:na,abnormalities:[],normal:!1}}}},computed:{...Xa(_e,["patient"]),hasLevelOfConsciousness(){return this.levelOfConsciousness.eyeResponse||this.levelOfConsciousness.verbalResponse||this.levelOfConsciousness.motorResponse},hasPresentingComplaints(){var m;return((m=this.presentingComplaintsWithDuration)==null?void 0:m.length)>0},hasPregnancyData(){return this.pregnancy.patientPregnant||this.pregnancy.breastFeeding},hasPastMedicalHistory(){var m;return((m=this.uniquePastMedicalHistory)==null?void 0:m.length)>0},hasAllergies(){var m;return((m=this.allergyList)==null?void 0:m.length)>0},hasPhysicalExam(){return Object.values(this.physicalExamCategories).some(m=>m.abnormalities.length>0||m.normal)},uniquePastMedicalHistory(){return[...new Set(this.pastMedicalHistory)]},uniquePresentingComplaints(){return[...new Set(this.presentingComplaintsWithDuration.map(m=>m.name))]},isMinor(){var m,v;return Se.getAgeInYears((v=(m=this.patient)==null?void 0:m.personInformation)==null?void 0:v.birthdate)<18},gcsScore(){var B,i,e;if(!this.hasLevelOfConsciousness)return null;const m=this.levelOfConsciousness.eyeResponse,v=this.levelOfConsciousness.motorResponse,s=this.levelOfConsciousness.verbalResponse,t=m&&(B=(this.isMinor?Ct:Dt)[m])!=null?B:0,S=v&&(i=(this.isMinor?wt:At)[v])!=null?i:0,A=s&&(e=(this.isMinor?kt:Ot)[s])!=null?e:0,V=t+S+A;return"(M ".concat(S," V ").concat(A," E ").concat(t,") ").concat(V,"/").concat(this.isMinor?5:15)}},methods:{async updateData(){var m;(m=this.patient)!=null&&m.patientID&&(await this.loadPresentingComplaints(),await this.loadPastMedicalHistory(),await this.loadLevelOfConsciousness(),await this.loadPregnancyStatus(),await this.loadPhysicalExam(),await this.loadAllergies())},async loadPresentingComplaints(){try{const m=await z.getObsByEncounterIdAndDate(Z.PRESENTING_COMPLAINTS);this.presentingComplaintsWithDuration=[];const v=m.filter(s=>s.concept_id===8578);for(const s of v){const t=await ie.getConceptName(s.value_coded);let S="Duration not specified";s.children&&Array.isArray(s.children)&&s.children.length>0?S=s.children[0].value_text||"Duration not specified":s.child&&Array.isArray(s.child)&&s.child.length>0&&(S=s.child[0].value_text||"Duration not specified"),this.presentingComplaintsWithDuration.push({name:t,duration:S})}console.log("Loaded complaints:",this.presentingComplaintsWithDuration)}catch(m){console.error("Error loading presenting complaints:",m)}},async loadPastMedicalHistory(){try{const v=(await z.getObsByEncounterIdAndDate(Z.PAST_MEDICAL_HISTORY)).filter(s=>s.concept_name==="Chronic disease");this.pastMedicalHistory=await Promise.all(v.map(async s=>await ie.getConceptName(s.value_coded)))}catch(m){console.error("Error loading past medical history:",m)}},async loadLevelOfConsciousness(){try{const m=await z.getObsByEncounterIdAndDate(Z.ASSESSMENT);if(m&&Array.isArray(m)){const v=m.find(S=>S.concept_name==="Eye opening response");this.levelOfConsciousness.eyeResponse=v!=null&&v.value_coded?await ie.getConceptName(v.value_coded):null;const s=m.find(S=>S.concept_name==="Best verbal response");this.levelOfConsciousness.verbalResponse=s!=null&&s.value_coded?await ie.getConceptName(s.value_coded):null;const t=m.find(S=>S.concept_name==="Best motor response");this.levelOfConsciousness.motorResponse=t!=null&&t.value_coded?await ie.getConceptName(t.value_coded):null}}catch(m){console.error("Error loading level of consciousness:",m)}},async loadPregnancyStatus(){try{const m=await z.getObsByEncounterIdAndDate(Z.PREGNANCY_STATUS);if(m&&Array.isArray(m)){const v=m.find(t=>t.concept_name==="Patient pregnant");this.pregnancy.patientPregnant=v!=null&&v.value_coded?await ie.getConceptName(v.value_coded):null;const s=m.find(t=>t.concept_name==="Is patient breast feeding?");this.pregnancy.breastFeeding=s!=null&&s.value_coded?await ie.getConceptName(s.value_coded):null}}catch(m){console.error("Error loading pregnancy status:",m)}},async loadAllergies(){try{const m=await z.getObsByEncounterIdAndDate(Z.MEDICAL_HISTORY),v=await ie.getConceptID("Allergic"),s=m.filter(t=>t.concept_id===v);this.allergyList=await Promise.all(s.map(async t=>t.value_text||await ie.getConceptName(t.value_coded)))}catch(m){console.error("Error loading allergies:",m)}},async loadPhysicalExam(){try{const m=await z.getObsByEncounterIdAndDate(Z.PHYSICAL_EXAMINATION);Object.values(this.physicalExamCategories).forEach(v=>{v.abnormalities=[],v.normal=!1});for(const v of m){if(!v.concept_name)continue;const s=v.concept_name,t=v.value_text;s==="Eyes normal"&&t==="Yes"?this.physicalExamCategories.Eyes.normal=!0:s==="Abnormality for eyes"&&t?this.physicalExamCategories.Eyes.abnormalities.push(t):s==="Other eye abnormality notes"&&t&&this.physicalExamCategories.Eyes.abnormalities.push(t),s==="Mouth normal"&&t==="Yes"?this.physicalExamCategories.Mouth.normal=!0:s==="Abnormality for  mouth"&&t?this.physicalExamCategories.Mouth.abnormalities.push(t):s==="Other mouth abnormality notes"&&t&&this.physicalExamCategories.Mouth.abnormalities.push(t),s==="Ears normal"&&t==="Yes"?this.physicalExamCategories.Ears.normal=!0:s==="Abnormality for ears"&&t?this.physicalExamCategories.Ears.abnormalities.push(t):s==="Other ears abnormality notes"&&t&&this.physicalExamCategories.Ears.abnormalities.push(t),s==="Face normal"&&t==="Yes"?this.physicalExamCategories.Face.normal=!0:s==="Abnormality for face"&&t?this.physicalExamCategories.Face.abnormalities.push(t):s==="Other face abnormality notes"&&t&&this.physicalExamCategories.Face.abnormalities.push(t),s==="Neck normal"&&t==="Yes"?this.physicalExamCategories.Neck.normal=!0:s==="Abnormality for neck"&&t?this.physicalExamCategories.Neck.abnormalities.push(t):s==="Other neck abnormality notes"&&t&&this.physicalExamCategories.Neck.abnormalities.push(t),s==="Chest inspection normal"&&t==="Yes"?this.physicalExamCategories.Chest.normal=!0:s==="Abnormality for  chest inspection"&&t?this.physicalExamCategories.Chest.abnormalities.push(t):s==="Other chest abnormality notes"&&t&&this.physicalExamCategories.Chest.abnormalities.push(t),s==="Chest movements"&&t&&this.physicalExamCategories["Chest Movement"].abnormalities.push(t),s==="Heart sounds normal"&&t==="Yes"?this.physicalExamCategories["Heart Sounds"].normal=!0:s==="Heart sounds abnormality"&&t&&this.physicalExamCategories["Heart Sounds"].abnormalities.push(t),s==="Breath sounds normal"&&t==="Yes"?this.physicalExamCategories["Breath Sounds"].normal=!0:s==="Breath sounds abnormality"&&t&&this.physicalExamCategories["Breath Sounds"].abnormalities.push(t),s==="Abnormalities when added"&&t&&this.physicalExamCategories["Added Breath Sounds"].abnormalities.push(t),s==="Abdominal inspection normal"&&t==="Yes"?this.physicalExamCategories["Abdominal Inspection"].normal=!0:s==="Abdominal inspection abnormality"&&t?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(t):s==="Other abdominal abnormality notes"&&t?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(t):s==="Abdominal auscultation abnormality"&&t?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(t):s==="Bowel sounds abnormality"&&t?this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(t):s==="Abdominal palpation abnormality"&&t&&this.physicalExamCategories["Abdominal Inspection"].abnormalities.push(t),s==="Genital examination normal"&&t==="Yes"?this.physicalExamCategories["Genital Examination"].normal=!0:s==="Genital examination abnormality"&&t?this.physicalExamCategories["Genital Examination"].abnormalities.push(t):s==="Urethral meatus abnormalities"&&t?this.physicalExamCategories["Genital Examination"].abnormalities.push(t):s==="Vulva inspection abnormalities"&&t?this.physicalExamCategories["Genital Examination"].abnormalities.push(t):s==="Other genital abnormality notes"&&t&&this.physicalExamCategories["Genital Examination"].abnormalities.push(t)}}catch(m){console.error("Error loading physicalExam:",m)}}},watch:{patient:{async handler(){await this.updateData()},deep:!0}},async mounted(){await this.updateData()}}),rn={class:"visit-container"},cn={class:"visit-sections"},dn={key:0,class:"visit-section"},un={class:"section-header"},mn={class:"section-content"},pn={key:0,class:"info-item"},hn={class:"info-value"},fn={key:1,class:"info-item"},yn={class:"info-value"},vn={key:2,class:"info-item"},bn={class:"info-value"},gn={key:3,class:"info-item"},_n={class:"info-value highlight"},Cn={key:1,class:"visit-section"},Dn={class:"section-header"},wn={class:"complaints-container"},An={class:"complaint-name"},kn={class:"complaint-duration"},On={key:2,class:"visit-section"},xn={class:"section-header"},Pn={class:"section-content"},Sn={key:0,class:"info-item"},Tn={class:"info-value highlight"},En={key:1,class:"info-item"},Nn={class:"info-value highlight"},In={key:3,class:"visit-section"},Fn={class:"section-header"},Hn={class:"tags-container"},Vn={key:4,class:"visit-section"},Bn={class:"section-header"},Mn={class:"tags-container"},Yn={key:5,class:"visit-section"},$n={class:"section-header"},Rn={class:"exam-section"},Ln={key:0,class:"exam-category"},Un={class:"exam-category-header"},Gn={class:"exam-items"},qn={key:1,class:"exam-item normal"};function Wn(m,v,s,t,S,A){const V=ge("ion-icon");return l(),w("div",rn,[v[12]||(v[12]=c("div",{class:"visit-header"},[c("h5",null,"Patient's Clinical Assessment Summary")],-1)),c("div",cn,[m.hasLevelOfConsciousness?(l(),w("div",dn,[c("div",un,[u(V,{icon:m.alertCircleOutline,class:"section-icon"},null,8,["icon"]),v[0]||(v[0]=c("h3",null,"Level of Consciousness",-1))]),c("div",mn,[m.levelOfConsciousness.eyeResponse?(l(),w("div",pn,[v[1]||(v[1]=c("span",{class:"info-label"},"Eye Response:",-1)),c("span",hn,P(m.levelOfConsciousness.eyeResponse),1)])):b("",!0),m.levelOfConsciousness.verbalResponse?(l(),w("div",fn,[v[2]||(v[2]=c("span",{class:"info-label"},"Verbal Response:",-1)),c("span",yn,P(m.levelOfConsciousness.verbalResponse),1)])):b("",!0),m.levelOfConsciousness.motorResponse?(l(),w("div",vn,[v[3]||(v[3]=c("span",{class:"info-label"},"Motor Response:",-1)),c("span",bn,P(m.levelOfConsciousness.motorResponse),1)])):b("",!0),m.gcsScore?(l(),w("div",gn,[v[4]||(v[4]=c("span",{class:"info-label"},"Score:",-1)),c("span",_n,P(m.gcsScore),1)])):b("",!0)])])):b("",!0),m.hasPresentingComplaints?(l(),w("div",Cn,[c("div",Dn,[u(V,{icon:m.documentTextOutline,class:"section-icon"},null,8,["icon"]),v[5]||(v[5]=c("h3",null,"Presenting Complaints",-1))]),c("div",wn,[(l(!0),w(te,null,pe(m.presentingComplaintsWithDuration,(B,i)=>(l(),w("div",{class:"complaint-item",key:i},[c("div",An,P(B.name),1),c("div",kn,P(B.duration),1)]))),128))])])):b("",!0),m.hasPregnancyData?(l(),w("div",On,[c("div",xn,[u(V,{icon:m.femaleOutline,class:"section-icon"},null,8,["icon"]),v[6]||(v[6]=c("h3",null,"Pregnancy Status",-1))]),c("div",Pn,[m.pregnancy.patientPregnant?(l(),w("div",Sn,[v[7]||(v[7]=c("span",{class:"info-label"},"Pregnant:",-1)),c("span",Tn,P(m.pregnancy.patientPregnant),1)])):b("",!0),m.pregnancy.breastFeeding?(l(),w("div",En,[v[8]||(v[8]=c("span",{class:"info-label"},"Breastfeeding:",-1)),c("span",Nn,P(m.pregnancy.breastFeeding),1)])):b("",!0)])])):b("",!0),m.hasPastMedicalHistory?(l(),w("div",In,[c("div",Fn,[u(V,{icon:m.medicalOutline,class:"section-icon"},null,8,["icon"]),v[9]||(v[9]=c("h3",null,"Medical History",-1))]),c("div",Hn,[(l(!0),w(te,null,pe(m.uniquePastMedicalHistory,(B,i)=>(l(),w("div",{class:"medical-tag",key:i},P(B),1))),128))])])):b("",!0),m.hasAllergies?(l(),w("div",Vn,[c("div",Bn,[u(V,{icon:m.warningOutline,class:"section-icon"},null,8,["icon"]),v[10]||(v[10]=c("h3",null,"Allergies",-1))]),c("div",Mn,[(l(!0),w(te,null,pe(m.allergyList,(B,i)=>(l(),w("div",{class:"allergy-tag",key:i},P(B),1))),128))])])):b("",!0),m.hasPhysicalExam?(l(),w("div",Yn,[c("div",$n,[u(V,{icon:m.bodyOutline,class:"section-icon"},null,8,["icon"]),v[11]||(v[11]=c("h3",null,"Physical Examination",-1))]),c("div",Rn,[(l(!0),w(te,null,pe(m.physicalExamCategories,(B,i)=>(l(),w(te,{key:i},[B.abnormalities.length>0||B.normal?(l(),w("div",Ln,[c("div",Un,[u(V,{icon:B.icon},null,8,["icon"]),c("h4",null,P(i),1)]),c("div",Gn,[B.abnormalities.length>0?(l(!0),w(te,{key:0},pe(B.abnormalities,(e,a)=>(l(),w("div",{class:"exam-item abnormal",key:a},P(e),1))),128)):B.normal?(l(),w("div",qn,"Normal examination")):b("",!0)])])):b("",!0)],64))),128))])])):b("",!0)])])}const jn=ke(ln,[["render",Wn],["__scopeId","data-v-382ca63a"]]),zn={class:"modal_wrapper"},Kn=re({__name:"PregnancyBreastfeeding",setup(m,{expose:v}){const s=o(null),t=o(0),S=K(()=>[{componentType:"radioButtonField",header:"Are you pregnant?",name:"Patient pregnant",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Breastfeeding?",name:"Is patient breast feeding?",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"}}]),A=async i=>{const e=[];for(const[a,f]of Object.entries(i))if(!(!f||f===!1||f==="")&&typeof f=="string")try{const _=await ie.getConceptID(f,!0);_?e.push(await z.buildValueCoded(a,_)):e.push(await z.buildValueText(a,f))}catch(_){e.push(await z.buildValueText(a,f))}return e};return v({validateForm:()=>{var i;return(i=s.value)==null?void 0:i.validateForm()},onSubmit:async()=>{if(!s.value)return!1;const i=s.value.validateForm();if(i)return console.log("Validation errors:",i),ue("Please fix validation errors before submitting"),!1;const e=s.value.getFormValues();console.log("Form data:",e);const a=await A(e);return a.length===0?(ue("No pregnancy status data to save"),!1):(await z.addObsToEncounterPatient(a,Z.PREGNANCY_STATUS),t.value++,await me(),Fe("Pregnancy status saved successfully"),!0)},resetForm:()=>{t.value++}}),(i,e)=>(l(),w("div",zn,[(l(),x(Ye,{formData:S.value,ref_key:"formRef",ref:s,key:t.value},null,8,["formData"]))]))}}),Jn=()=>{const m=_e(),{patient:v}=we(m),s=()=>{},t=K(()=>{var S,A,V,B;return[{componentType:"Heading",name:"Existing Chronic Health Conditions",grid:{s:"12"}},{componentType:"checkboxField",name:"TB",label:"TB",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const a={};return i||(a["TB treatment"]="",a["TB drugs"]=null,a["TB drug start date"]=""),a}},{componentType:"radioButtonField",header:"On TB medication",name:"TB treatment",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i.TB===!0,onChange:(i,e)=>{const a={};return i!=="Yes"&&(a["TB drugs"]=null,a["TB drug start date"]=""),a}},{componentType:"multiSelectInputField",header:"Select medication",name:"TB drugs",isMultiple:!1,trackBy:"name",grid:{s:"6"},icon:ee.search,options:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"}],condition:i=>i.TB===!0&&i["TB treatment"]==="Yes"},{componentType:"dateInputField",header:"Start date",name:"TB drug start date",grid:{s:"6"},condition:i=>i.TB===!0&&i["TB treatment"]==="Yes",minDate:((A=(S=v.value)==null?void 0:S.personInformation)==null?void 0:A.birthdate)||void 0,maxDate:new Date().toISOString().split("T")[0]},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Chronic Obstructive Pulmonary Disease (COPD)",label:"Chronic Obstructive Pulmonary Disease (COPD)",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Asthma",label:"Asthma",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Epilepsy",label:"Epilepsy",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Previous stroke",label:"Previous stroke",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Peptic Ulcer Disease (PUD)",label:"Peptic Ulcer Disease (PUD)",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Mental disorder",label:"Mental disorder",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Bleeding disorders",label:"Bleeding disorders",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:()=>({})},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Hypertension",label:"Hypertension",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const a={};return i||(a["Hypertension medication"]="",a["Current hypertension treatment regimen"]=null),a}},{componentType:"radioButtonField",header:"On medication",name:"Hypertension medication",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i.Hypertension===!0,onChange:(i,e)=>{const a={};return i!=="Yes"&&(a["Current hypertension treatment regimen"]=null),a}},{componentType:"multiSelectInputField",header:"Select medication",name:"Current hypertension treatment regimen",isMultiple:!1,trackBy:"name",grid:{s:"12"},icon:ee.search,options:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}],condition:i=>i.Hypertension===!0&&i["Hypertension medication"]==="Yes"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"HIV Positive",label:"HIV Positive",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const a={};return i||(a["HIV status"]="",a["ARV start date"]=""),a}},{componentType:"radioButtonField",header:"Is the patient on ART",name:"HIV status",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:i=>i["HIV Positive"]===!0,onChange:(i,e)=>{const a={};return i!=="Yes"&&(a["ARV start date"]=""),a}},{componentType:"dateInputField",header:"Enter ARV start date",name:"ARV start date",grid:{s:"12"},condition:i=>i["HIV Positive"]===!0&&i["HIV status"]==="Yes",minDate:((B=(V=v.value)==null?void 0:V.personInformation)==null?void 0:B.birthdate)||void 0,maxDate:new Date().toISOString().split("T")[0]},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"Diabetes Mellitus",label:"Diabetes Mellitus",type:"single",grid:{s:"12"},disabled:i=>i.None,onChange:(i,e)=>{const a={};return i||(a.Diabetes="",a["Controlled by"]=""),a}},{componentType:"radioButtonField",header:"Type",name:"Diabetes",options:[{value:"Type 1 diabetes",label:"Type I"},{value:"Type 2 diabetes",label:"Type II"},{value:"Unknown",label:"Unsure"}],grid:{s:"12"},condition:i=>i["Diabetes Mellitus"]===!0},{componentType:"radioButtonField",header:"Controlled by",name:"Controlled by",options:[{value:"Diet",label:"Diet"},{value:"Tablets",label:"Tablets"},{value:"Insulin",label:"Insulin"}],grid:{s:"12"},condition:i=>i["Diabetes Mellitus"]===!0},{grid:{s:"12"},componentType:"Dashes"},{componentType:"checkboxField",name:"None",label:"None",type:"single",grid:{s:"12"},onChange:(i,e)=>{const a={};return i&&(a.TB=!1,a["Chronic Obstructive Pulmonary Disease (COPD)"]=!1,a.Asthma=!1,a.Epilepsy=!1,a["Previous stroke"]=!1,a["Peptic Ulcer Disease (PUD)"]=!1,a["Mental disorder"]=!1,a["Bleeding disorders"]=!1,a.Hypertension=!1,a["HIV Positive"]=!1,a["Diabetes Mellitus"]=!1,a["TB treatment"]="",a["TB drugs"]=null,a["TB drug start date"]="",a["Hypertension medication"]="",a["Current hypertension treatment regimen"]=null,a["HIV status"]="",a["ARV start date"]="",a.Diabetes="",a["Controlled by"]=""),a}}]});return{resetForm:s,pastMedicalHistoryFormSection:t}},Xn=re({__name:"PastMedicalHistory",setup(m,{expose:v}){const s=Jn(),t=o(null),S=o(0),A=_e(),{patient:V}=we(A);fe(()=>{var a;return(a=V.value)==null?void 0:a.patientID},async(a,f)=>{a&&a!==f&&(console.log("Patient changed, resetting form"),S.value++,await me(),await me())}),fe(()=>{var a,f;return(f=(a=t.value)==null?void 0:a.getFormValues())==null?void 0:f.None},a=>{a&&t.value&&me(()=>{})});const B=async()=>{if(!t.value)return console.error("Form reference is not available"),!1;const a=t.value.validateForm();if(a)return console.log("Validation errors:",a),ue("Please fix validation errors before submitting"),!1;const f=t.value.getFormValues();console.log("Form data:",f);const _=await i(f);return _.length===0?(ue("No past medical history data to save"),!1):(await z.addObsToEncounterPatient(_,Z.PAST_MEDICAL_HISTORY),S.value++,await me(),await me(),Fe("Past medical history saved successfully"),!0)},i=async a=>{const f=[];for(const[_,d]of Object.entries(a))if(!(!d||d===!1||d===""))if(typeof d=="boolean"&&d===!0)try{const D=await ie.getConceptID(_,!0);D&&f.push(await z.buildValueCoded("Chronic disease",D))}catch(D){f.push(await z.buildValueText("Chronic disease",_))}else typeof d=="string"?f.push(await z.buildValueText(_,d)):typeof d=="object"&&(d!=null&&d.name)?f.push(await z.buildValueText(_,d.name)):(d instanceof Date||/^\d{4}-\d{2}-\d{2}$/.test(d))&&f.push(await z.buildValueDate(_,d));return console.log("Processed past medical history:",f),f};Ae(async()=>{console.log("Past medical history form mounted"),await me(),await me()});const e=K(()=>s.pastMedicalHistoryFormSection.value);return v({validateForm:()=>{var a;return(a=t.value)==null?void 0:a.validateForm()},onSubmit:B,resetForm:()=>{S.value++}}),(a,f)=>(l(),x(Ye,{formData:e.value,ref_key:"formRef",ref:t,key:S.value},null,8,["formData"]))}}),Qn=()=>{const m=_e(),{patient:v}=we(m),s=()=>{},t=K(()=>{var B,i;const S=(i=(B=v.value)==null?void 0:B.personInformation)==null?void 0:i.gender,A=S==="M",V=S==="F";return[{componentType:"radioButtonField",header:"Has physical examination been done?",name:"Physical examination",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},onChange:(e,a)=>{if(e==="No")return{"Eyes normal":"","Abnormality for eyes":[],"Other eye abnormality notes":"","Mouth normal":"","Abnormality for  mouth":[],"Other mouth abnormality notes":"","Ears normal":"","Abnormality for ears":[],"Other ears abnormality notes":"","Face normal":"","Abnormality for face":[],"Other face abnormality notes":"","Neck normal":"","Abnormality for neck":[],"Other neck abnormality notes":"","Chest inspection normal":"","Abnormality for  chest inspection":[],"Other chest abnormality notes":"","Chest movements":"","Heart sounds normal":"","Heart sounds abnormality":[],"Breath sounds normal":"","Breath sounds abnormality":[],"Abnormalities when added":[],"Abdominal inspection normal":"","Abdominal inspection abnormality":[],"Other abdominal abnormality notes":"","Abdominal auscultation normal":"","Abdominal auscultation abnormality":[],"Other abdominal auscultation abnormality notes":"","Bowel sounds abnormality":[],"Abdominal palpation normal":"","Abdominal palpation abnormality":[],"Other abdominal palpation abnormality notes":"","Genital examination normal":"","Genital examination abnormality":[],"Urethral meatus abnormalities":[],"Vulva inspection abnormalities":[],"Other genital abnormality notes":"","Extremities normal":"","Abnormality for extremities":[],"Other extremities abnormalities notes":""}}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Reason why physical examination not done?",name:"Reason why physical examination not done",options:[{value:"Condition does not necessitate assessment",label:"Condition does not necessitate assessment"},{value:"Patient refused to consent",label:"Patient refused to consent"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="No"},{componentType:"radioButtonField",header:"Eyes normal?",name:"Eyes normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for eyes":[],"Other eye abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on eyes?",name:"Abnormality for eyes",type:"multiple",options:[{value:"Pallor",label:"Pallor"},{value:"Jaundice",label:"Jaundice"},{value:"Ulcerations",label:"Ulcerations"},{value:"Other eye abnormality",label:"Other eye abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Eyes normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other eye abnormality")))return{"Other eye abnormality notes":""}}},{componentType:"inputField",header:"Specify eye abnormality",name:"Other eye abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Eyes normal"]==="No"&&Array.isArray(e["Abnormality for eyes"])&&e["Abnormality for eyes"].includes("Other eye abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Mouth normal?",name:"Mouth normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for  mouth":[],"Other mouth abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities in the mouth?",name:"Abnormality for  mouth",type:"multiple",options:[{value:"Oral thrush",label:"Oral thrush"},{value:"Kaposi's Sarcoma lesions",label:"Kaposi's Sarcoma lesions"},{value:"Sores",label:"Sores"},{value:"Other mouth abnormality",label:"Other mouth abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Mouth normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other mouth abnormality")))return{"Other mouth abnormality notes":""}}},{componentType:"inputField",header:"Specify mouth abnormality",name:"Other mouth abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Mouth normal"]==="No"&&Array.isArray(e["Abnormality for  mouth"])&&e["Abnormality for  mouth"].includes("Other mouth abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Ears normal?",name:"Ears normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for ears":[],"Other ears abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on ears?",name:"Abnormality for ears",type:"multiple",options:[{value:"Ear discharge",label:"Ear discharge"},{value:"Bleeding",label:"Bleeding"},{value:"Other ears abnormality",label:"Other ears abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Ears normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other ears abnormality")))return{"Other ears abnormality notes":""}}},{componentType:"inputField",header:"Specify ears abnormality",name:"Other ears abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Ears normal"]==="No"&&Array.isArray(e["Abnormality for ears"])&&e["Abnormality for ears"].includes("Other ears abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Face normal?",name:"Face normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for face":[],"Other face abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on face?",name:"Abnormality for face",type:"multiple",options:[{value:"Rash",label:"Rash"},{value:"Swelling",label:"Swelling"},{value:"Other face abnormality",label:"Other face abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Face normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other face abnormality")))return{"Other face abnormality notes":""}}},{componentType:"inputField",header:"Specify face abnormality",name:"Other face abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Face normal"]==="No"&&Array.isArray(e["Abnormality for face"])&&e["Abnormality for face"].includes("Other face abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Neck normal?",name:"Neck normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for neck":[],"Other neck abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on the neck?",name:"Abnormality for neck",type:"multiple",options:[{value:"Neck rash",label:"Neck rash"},{value:"Swelling",label:"Swelling"},{value:"Neck mass",label:"Neck mass"},{value:"Other neck abnormality",label:"Other neck abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Neck normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other neck abnormality")))return{"Other neck abnormality notes":""}}},{componentType:"inputField",header:"Specify neck abnormality",name:"Other neck abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Neck normal"]==="No"&&Array.isArray(e["Abnormality for neck"])&&e["Abnormality for neck"].includes("Other neck abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Chest inspection normal?",name:"Chest inspection normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for  chest inspection":[],"Other chest abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities on the chest?",name:"Abnormality for  chest inspection",type:"multiple",options:[{value:"Chest rash",label:"Chest rash"},{value:"Chest burns",label:"Chest burns"},{value:"Chest bruises",label:"Chest bruises"},{value:"Chest wounds",label:"Chest wounds"},{value:"Other chest abnormality",label:"Other chest abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Chest inspection normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other chest abnormality")))return{"Other chest abnormality notes":""}}},{componentType:"inputField",header:"Specify chest abnormality",name:"Other chest abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Chest inspection normal"]==="No"&&Array.isArray(e["Abnormality for  chest inspection"])&&e["Abnormality for  chest inspection"].includes("Other chest abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Chest movement?",name:"Chest movements",options:[{value:"Symmetrical",label:"Symmetrical"},{value:"Asymmetrical",label:"Asymmetrical"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Heart sounds normal?",name:"Heart sounds normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Heart sounds abnormality":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the heart sounds?",name:"Heart sounds abnormality",type:"multiple",options:[{value:"Loud P2",label:"Loud P2"},{value:"Splitting P2",label:"Splitting P2"},{value:"Gallop rhythm",label:"Gallop rhythm"},{value:"Murmur",label:"Murmur"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Heart sounds normal"]==="No"},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Breath sounds normal?",name:"Breath sounds normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Breath sounds abnormality":[],"Abnormalities when added":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the breath sounds?",name:"Breath sounds abnormality",type:"multiple",options:[{value:"Absent",label:"Absent"},{value:"Reduced",label:"Reduced"},{value:"Added",label:"Added"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Breath sounds normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Added")))return{"Abnormalities when added":[]}}},{componentType:"checkboxField",header:"What are the abnormalities on the breath sounds are Added?",name:"Abnormalities when added",type:"multiple",options:[{value:"Crackles",label:"Crackles"},{value:"Wheezes",label:"Wheezes"},{value:"Bronchial",label:"Bronchial"},{value:"Crepitations",label:"Crepitations"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Breath sounds normal"]==="No"&&Array.isArray(e["Breath sounds abnormality"])&&e["Breath sounds abnormality"].includes("Added")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal inspection normal?",name:"Abdominal inspection normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abdominal inspection abnormality":[],"Other abdominal abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities after Abdominal inspection?",name:"Abdominal inspection abnormality",type:"multiple",options:[{value:"Abdominal distension",label:"Abdominal distension"},{value:"Abdominal rash",label:"Abdominal rash"},{value:"Abdominal wounds",label:"Abdominal wounds"},{value:"Laceration",label:"Laceration"},{value:"Abdominal bruises",label:"Abdominal bruises"},{value:"Abdominal burns",label:"Abdominal burns"},{value:"Other abdominal abnormality",label:"Other abdominal abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal inspection normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other abdominal abnormality")))return{"Other abdominal abnormality notes":""}}},{componentType:"inputField",header:"Specify abdominal abnormality",name:"Other abdominal abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal inspection normal"]==="No"&&Array.isArray(e["Abdominal inspection abnormality"])&&e["Abdominal inspection abnormality"].includes("Other abdominal abnormality")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal auscultation normal?",name:"Abdominal auscultation normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abdominal auscultation abnormality":[],"Other abdominal auscultation abnormality notes":"","Bowel sounds abnormality":[]}}},{componentType:"checkboxField",header:"What are the abdominal auscultation abnormalities?",name:"Abdominal auscultation abnormality",type:"multiple",options:[{value:"Bruit",label:"Bruit"},{value:"Hyperactive",label:"Hyperactive"},{value:"Reduced bowel sounds",label:"Reduced bowel sounds"},{value:"Other",label:"Other"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No",onChange:(e,a)=>{const f={};return e!=null&&e.includes("Reduced bowel sounds")||(f["Bowel sounds abnormality"]=[]),e!=null&&e.includes("Other")||(f["Other abdominal auscultation abnormality notes"]=""),f}},{componentType:"checkboxField",header:"What are the abnormalities on bowel sounds?",name:"Bowel sounds abnormality",type:"multiple",options:[{value:"Reduced bowel sounds",label:"Reduced bowel sounds"},{value:"Abdominal auscultation absent",label:"Abdominal auscultation absent"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No"&&Array.isArray(e["Abdominal auscultation abnormality"])&&e["Abdominal auscultation abnormality"].includes("Reduced bowel sounds")},{componentType:"inputField",header:"Specify abdominal auscultation abnormality",name:"Other abdominal auscultation abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal auscultation normal"]==="No"&&Array.isArray(e["Abdominal auscultation abnormality"])&&e["Abdominal auscultation abnormality"].includes("Other")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Abdominal palpation normal?",name:"Abdominal palpation normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abdominal palpation abnormality":[],"Other abdominal palpation abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abdominal palpation abnormalities?",name:"Abdominal palpation abnormality",type:"multiple",options:[{value:"Tenderness",label:"Tenderness"},{value:"Splenomegaly",label:"Splenomegaly"},{value:"Kidney ballotable",label:"Kidney ballotable"},{value:"Other masses",label:"Other masses"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal palpation normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other masses")))return{"Other abdominal palpation abnormality notes":""}}},{componentType:"inputField",header:"Specify abdominal palpation abnormality",name:"Other abdominal palpation abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Abdominal palpation normal"]==="No"&&Array.isArray(e["Abdominal palpation abnormality"])&&e["Abdominal palpation abnormality"].includes("Other masses")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Genital examination normal?",name:"Genital examination normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Genital examination abnormality":[],"Urethral meatus abnormalities":[],"Vulva inspection abnormalities":[],"Other genital abnormality notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities after genital examination?",name:"Genital examination abnormality",type:"multiple",options:[{value:"Warts",label:"Warts"},{value:"Vesicles",label:"Vesicles"},{value:"Growths",label:"Growths"},{value:"Genital sores",label:"Genital sores"},{value:"Scrotal swelling",label:"Scrotal swelling",disabled:V},{value:"Tastes swelling",label:"Tastes swelling",disabled:V},{value:"Urethral meatus abnormal",label:"Urethral meatus abnormal",disabled:V},{value:"Vulva examination",label:"Vulva examination",disabled:A},{value:"Visible bleeding",label:"Visible bleeding",disabled:A},{value:"Other genital abnormalities",label:"Other genital abnormalities"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No",onChange:(e,a)=>{const f={};return e!=null&&e.includes("Urethral meatus abnormal")||(f["Urethral meatus abnormalities"]=[]),e!=null&&e.includes("Vulva examination")||(f["Vulva inspection abnormalities"]=[]),e!=null&&e.includes("Other genital abnormalities")||(f["Other genital abnormality notes"]=""),f}},{componentType:"checkboxField",header:"What are the urethral meatus abnormalities for the patient?",name:"Urethral meatus abnormalities",type:"multiple",options:[{value:"Oedema",label:"Oedema"},{value:"Abnormal discharge",label:"Abnormal discharge"},{value:"Bleeding",label:"Bleeding"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&A&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Urethral meatus abnormal")},{componentType:"checkboxField",header:"What Vulva abnormalities does the patient have?",name:"Vulva inspection abnormalities",type:"multiple",options:[{value:"Oedematous cervix",label:"Oedematous cervix"},{value:"Abnormal vaginal discharge",label:"Abnormal vaginal discharge"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&V&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Vulva examination")},{componentType:"inputField",header:"Specify genital abnormality",name:"Other genital abnormality notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Genital examination normal"]==="No"&&Array.isArray(e["Genital examination abnormality"])&&e["Genital examination abnormality"].includes("Other genital abnormalities")},{grid:{s:"12"},componentType:"Dashes"},{componentType:"radioButtonField",header:"Extremities normal?",name:"Extremities normal",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes",onChange:(e,a)=>{if(e==="Yes")return{"Abnormality for extremities":[],"Other extremities abnormalities notes":""}}},{componentType:"checkboxField",header:"What are the abnormalities for extremities?",name:"Abnormality for extremities",type:"multiple",options:[{value:"Cold and clammy",label:"Cold and clammy"},{value:"Generalized oedema",label:"Generalized oedema"},{value:"Fracture",label:"Fracture"},{value:"Extremity burns",label:"Extremity burns"},{value:"Extremity rash",label:"Extremity rash"},{value:"Deformity",label:"Deformity"},{value:"Finger clubbing",label:"Finger clubbing"},{value:"Decreased Power",label:"Decreased Power"},{value:"Decreased Sensation",label:"Decreased Sensation"},{value:"Other extremities abnormality",label:"Other extremities abnormality"}],grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Extremities normal"]==="No",onChange:(e,a)=>{if(!(e!=null&&e.includes("Other extremities abnormality")))return{"Other extremities abnormalities notes":""}}},{componentType:"inputField",header:"Specify extremity abnormality",name:"Other extremities abnormalities notes",icon:ee.editPen,grid:{s:"12"},condition:e=>e["Physical examination"]==="Yes"&&e["Extremities normal"]==="No"&&Array.isArray(e["Abnormality for extremities"])&&e["Abnormality for extremities"].includes("Other extremities abnormality")}]});return{resetForm:s,physicalExaminationFormSection:t}},Zn=re({__name:"PhysicalExamination",setup(m,{expose:v}){const s=Qn(),t=o(null),S=o(0),A=_e(),{patient:V}=we(A);fe(()=>{var a;return(a=V.value)==null?void 0:a.patientID},async(a,f)=>{a&&a!==f&&(S.value++,await me())});const B=async()=>{if(!t.value)return console.error("Form reference is not available"),!1;if(t.value.validateForm())return ue("Please fix validation errors before submitting"),!1;const f=t.value.getFormValues(),_=await i(f);return _.length===0?(ue("No physical examination data to save"),!1):(await z.addObsToEncounterPatient(_,Z.PHYSICAL_EXAMINATION),S.value++,await me(),Fe("Physical examination saved successfully"),!0)},i=async a=>{const f=[];for(const[_,d]of Object.entries(a))!d||d===!1||d===""||(typeof d=="boolean"&&d===!0?f.push(await z.buildValueText("Physical examination finding",_)):typeof d=="string"&&f.push(await z.buildValueText(_,d)));return f};Ae(async()=>{await me()});const e=K(()=>s.physicalExaminationFormSection.value);return v({validateForm:()=>{var a;return(a=t.value)==null?void 0:a.validateForm()},onSubmit:B,resetForm:()=>{S.value++}}),(a,f)=>(l(),x(Ye,{formData:e.value,ref_key:"formRef",ref:t,key:S.value},null,8,["formData"]))}}),eo={key:0},ao={class:"ion-padding",slot:"content"},to={class:"nav-buttons"},no={class:"ion-padding",slot:"content"},oo={class:"nav-buttons"},so={class:"ion-padding",slot:"content"},io={class:"nav-buttons"},lo={class:"ion-padding",slot:"content"},ro={class:"nav-buttons"},co={class:"ion-padding",slot:"content"},uo={class:"nav-buttons"},mo={class:"ion-padding",slot:"content"},po={class:"nav-buttons"},ho=re({__name:"ClinicalAssessment",setup(m,{expose:v}){const s=o("loc"),t=o(0),S=o(!1),A=o(!1),V=new Ca,B=_e(),i=()=>{t.value++},e=o(null),a=o(null),f=o(null),_=o(null),d=o(null),D=o(null),E=[{id:"loc",label:"Level of consciousness",show:!0},{id:"pc",label:"Presenting complaints",show:!0},{id:"pbs",label:"Pregnancy and breastfeeding status",show:()=>V.isChildBearing()},{id:"pmh",label:"Past medical history",show:!0},{id:"al",label:"Allergies",show:!0},{id:"pe",label:"Physical examination",show:!0}];async function $(){const q=Ie.getSessionDate(),h=[Z.ASSESSMENT,Z.PRESENTING_COMPLAINTS,Z.PAST_MEDICAL_HISTORY,Z.PHYSICAL_EXAMINATION,Z.MEDICAL_HISTORY,Z.PREGNANCY_STATUS];let I=!1;for(const ne of h)try{const n=await z.getObsByEncounterIdAndDate(ne);if(n&&n.some(p=>p.obs_datetime?Se.toStandardHisFormat(p.obs_datetime)===Se.toStandardHisFormat(q):!1)){I=!0;break}}catch(n){console.error("Error checking observations for encounter type ".concat(ne,":"),n)}S.value=I}Ae($),fe(()=>B.patient,$);const M=K(()=>S.value),N=K(()=>E.filter(q=>typeof q.show=="function"?q.show():q.show)),Y=q=>{const h=E.find(I=>I.id===q);return h?typeof h.show=="function"?h.show():h.show:!1},L=q=>N.value.findIndex(h=>h.id===q),J=q=>{const h=L(q);h>0&&(s.value=N.value[h-1].id)},G=q=>{const I=L(q)+1;I<N.value.length?s.value=N.value[I].id:(s.value="",i())};return v({onSubmit:async()=>{const q=[{ref:e,name:"PresentingComplaints"},{ref:a,name:"LevelOfConsciousness"},{ref:f,name:"PastMedicalHistory"},{ref:d,name:"PregnancyBreastfeeding"},{ref:D,name:"PhysicalExamination"},{ref:_,name:"Allergies"}];for(const h of q)if(h.ref.value&&typeof h.ref.value.onSubmit=="function")try{const I=await h.ref.value.onSubmit();if(h.name==="PresentingComplaints"&&I===!1)return}catch(I){if(console.error("Error calling ".concat(h.name," onSubmit:"),I),h.name==="PresentingComplaints")return}else console.log("".concat(h.name," component ref not available or no onSubmit method"))}}),(q,h)=>(l(),w(te,null,[M.value?(l(),w("div",eo,[u(r(le),{lines:"none"},{default:y(()=>[u(r(U),null,{default:y(()=>[...h[14]||(h[14]=[F("Switch between Capture Mode and Summary Mode",-1)])]),_:1}),u(r(at),{checked:A.value,onIonChange:h[0]||(h[0]=I=>A.value=I.detail.checked),slot:"end"},null,8,["checked"])]),_:1}),A.value?b("",!0):(l(),x(jn,{key:t.value}))])):b("",!0),!M.value||A.value?(l(),x(r(tt),{key:1,style:{width:"100%"}},{default:y(()=>[u(r(Ke),{value:s.value,"onUpdate:value":h[13]||(h[13]=I=>s.value=I),ref:"accordionGroup",class:"previousView"},{default:y(()=>[Y("loc")?(l(),x(r(be),{key:0,value:"loc",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[15]||(h[15]=[F("Level of consciousness",-1)])]),_:1})]),_:1}),c("div",ao,[u(xt,{"is-active":s.value==="loc",ref_key:"levelOfConsciousnessFormRef",ref:a,onDataSaved:i},null,8,["is-active"]),c("div",to,[L("loc")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[1]||(h[1]=de(I=>J("loc"),["stop"]))},{default:y(()=>[...h[16]||(h[16]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[2]||(h[2]=de(I=>G("loc"),["stop"]))},{default:y(()=>[F(P(L("loc")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0),Y("pc")?(l(),x(r(be),{key:1,value:"pc",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[17]||(h[17]=[F(" Presenting complaints - ",-1),c("span",{class:"required-badge"},"Required",-1)])]),_:1})]),_:1}),c("div",no,[u(jt,{"is-active":s.value==="pc",onDataSaved:i,ref_key:"presentingComplaintsFormRef",ref:e},null,8,["is-active"]),c("div",oo,[L("pc")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[3]||(h[3]=de(I=>J("pc"),["stop"]))},{default:y(()=>[...h[18]||(h[18]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[4]||(h[4]=de(I=>G("pc"),["stop"]))},{default:y(()=>[F(P(L("pc")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0),Y("pbs")?(l(),x(r(be),{key:2,value:"pbs",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[19]||(h[19]=[F("Pregnancy and breastfeeding status",-1)])]),_:1})]),_:1}),c("div",so,[u(Kn,{"is-active":s.value==="pbs",ref_key:"pregnancyBreastfeedingFormRef",ref:d,onDataSaved:i},null,8,["is-active"]),c("div",io,[L("pbs")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[5]||(h[5]=de(I=>J("pbs"),["stop"]))},{default:y(()=>[...h[20]||(h[20]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[6]||(h[6]=de(I=>G("pbs"),["stop"]))},{default:y(()=>[F(P(L("pbs")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0),Y("pmh")?(l(),x(r(be),{key:3,value:"pmh",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[21]||(h[21]=[F("Past medical history",-1)])]),_:1})]),_:1}),c("div",lo,[u(Xn,{"is-active":s.value==="pmh",ref_key:"pastMedicalHistoryFormRef",ref:f,onDataSaved:i},null,8,["is-active"]),c("div",ro,[L("pmh")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[7]||(h[7]=de(I=>J("pmh"),["stop"]))},{default:y(()=>[...h[22]||(h[22]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[8]||(h[8]=de(I=>G("pmh"),["stop"]))},{default:y(()=>[F(P(L("pmh")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0),Y("al")?(l(),x(r(be),{key:4,value:"al",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[23]||(h[23]=[F("Allergies",-1)])]),_:1})]),_:1}),c("div",co,[u(Nt,{"is-active":s.value==="al",ref_key:"allergiesFormRef",ref:_,onDataSaved:i},null,8,["is-active"]),c("div",uo,[L("al")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[9]||(h[9]=de(I=>J("al"),["stop"]))},{default:y(()=>[...h[24]||(h[24]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[10]||(h[10]=de(I=>G("al"),["stop"]))},{default:y(()=>[F(P(L("al")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0),Y("pe")?(l(),x(r(be),{key:5,value:"pe",class:"_card"},{default:y(()=>[u(r(le),{slot:"header",color:"light"},{default:y(()=>[u(r(U),{class:"previousLabel"},{default:y(()=>[...h[25]||(h[25]=[F("Physical examination",-1)])]),_:1})]),_:1}),c("div",mo,[u(Zn,{"is-active":s.value==="pe",ref_key:"physicalExaminationFormRef",ref:D,onDataSaved:i},null,8,["is-active"]),c("div",po,[L("pe")>0?(l(),x(r(ce),{key:0,fill:"outline",onClick:h[11]||(h[11]=de(I=>J("pe"),["stop"]))},{default:y(()=>[...h[26]||(h[26]=[F(" Back ",-1)])]),_:1})):b("",!0),u(r(ce),{fill:"outline",onClick:h[12]||(h[12]=de(I=>G("pe"),["stop"]))},{default:y(()=>[F(P(L("pe")<N.value.length-1?"Next":"Finish"),1)]),_:1})])])]),_:1})):b("",!0)]),_:1},8,["value"])]),_:1})):b("",!0)],64))}}),Ps=ke(ho,[["__scopeId","data-v-f7298259"]]),fo={class:"allergies-section"},yo={class:"allergies-container"},vo={class:"medication-section"},bo={class:"medication-content"},go={key:0,class:"add-medication-form"},_o={class:"form-group"},Co={class:"option-label"},Do={key:0,class:"error-message"},wo={class:"form-row"},Ao={class:"form-group"},ko={key:0,class:"error-message"},Oo={class:"form-group"},xo={key:0,class:"error-message"},Po={class:"form-group"},So={key:0,class:"error-message"},To={class:"action-buttons"},Eo={class:"notes-section"},No={class:"notes-content"},Io={class:"notes-input-container"},Fo={class:"ion-padding",slot:"content"},Ho={class:"notes-timeline"},Vo={key:0,class:"note-entry"},Bo={class:"note-date"},Mo={class:"note-content"},Yo={class:"ion-padding",slot:"content"},$o={class:"note-date"},Ro={class:"note-content"},Lo=re({watch:{},name:"xxxComponent"}),Uo=re({...Lo,setup(m){const v=ee,s=Ht,t=o(!1),S=o(!1),A=o(!0),V=o(0),B=o(""),i=o(!1),e=o(),a=o(!1),f=o(""),_=o(""),d=o(""),D=o(""),E=o(""),$=o(""),M="Add new medication",N=Pe(),Y=_a(),L=K(()=>Y.selectedMedicalAllergiesList),J=K(()=>N.selectedMedicalDrugsList),G=K(()=>N.partialOPDdrugList),X=K(()=>N.nonPharmalogicalTherapyAndOtherNotes),q=["first","second","third"],h=o(),I=o(),ne=o(),n=o(!1),p=o(!1),T=o("Show more notes"),H=o(),k=o(),R=o(),j=K(()=>N.editingDrugItem),he=o("Select a route"),Oe=o(!1),He=o("Select frequency"),Te=o(!1),$e=o("Select drug"),Re=o(!1),oe=o(),se=o(),ye=o(),Ee=o([]),Aa=o([{concept_id:11797,name:"Buccal",concept_name_id:null,id:1769},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:6284},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:6285},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:6286},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:6295},{concept_id:3327,name:"Oral",concept_name_id:null,id:8686},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:8920},{concept_id:11792,name:"Rectally",concept_name_id:null,id:10785},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:12342},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:12344},{concept_id:11792,name:"Rectally",concept_name_id:null,id:14078},{concept_id:11793,name:"Intravenous (IV)",concept_name_id:null,id:14079},{concept_id:11794,name:"Intradermal",concept_name_id:null,id:14080},{concept_id:11795,name:"Intramuscular (IM)",concept_name_id:null,id:14081},{concept_id:11796,name:"Sublingual",concept_name_id:null,id:14082},{concept_id:11797,name:"Buccal",concept_name_id:null,id:14083},{concept_id:11798,name:"Subcutaneous",concept_name_id:null,id:14084},{concept_id:11799,name:"Intraosseous",concept_name_id:null,id:14085},{concept_id:11800,name:"Other method of prescription",concept_name_id:null,id:14086}]),ka=K(()=>Ee.value.length?Ee.value:Aa.value);function Oa(C){oe.value=C}async function xa(){return await Vt()}async function Pa(C=5,g=1e3){let O=0;for(;O<C&&(Ee.value=await xa(),!(Ee.value.length>0));)O++,await new Promise(W=>setTimeout(W,g));Ee.value.length===0&&console.warn("Failed to fetch route list after maximum retries.")}Ae(async()=>{const C=new Bt,{previousDrugPrescriptions:g,previousClinicalNotes:O,previousDrugAllergies:W}=await C.getPatientEncounters();h.value=g,I.value=Object.entries(O)[0];const[,...Q]=Object.entries(O);ne.value=Q,H.value=Object.entries(W)[0];const[,...ae]=Object.entries(W);k.value=ae,await Pa()}),fe(()=>_.value,async C=>{Ia()}),fe(()=>d.value,async C=>{Xe()});function Sa(){if(Ce.isEmpty(oe.value)==!0)return Oe.value=!0,!1;if(Ce.isEmpty(oe.value)==!1)return Oe.value=!1,!0}function Ta(){if(Ce.isEmpty(se.value)==!0)return Te.value=!0,!1;if(Ce.isEmpty(se.value)==!1)return Te.value=!1,!0}function Ea(){if(Ce.isEmpty(ye.value)==!0)return Re.value=!0,!1;if(Ce.isEmpty(ye.value)==!1)return Re.value=!1,!0}function Na(){A.value=!A.value,t.value=!0,i.value=!1,a.value=!1}async function Ia(){return ea(_.value)?i.value=!1:(B.value="please enter a number",i.value=!0),i.value}async function Xe(){return ea(d.value)?a.value=!1:(e.value="please enter a number",a.value=!0),a.value}async function Qe(){const C=await Xe(),g=Ta(),O=Ea(),W=Sa();return!C&&g==!0&&O==!0&&W==!0}function Fa(C){se.value=C}async function Ze(){try{const C=()=>R.value.dose_strength!=null&&R.value.dose_strength?Math.trunc(R.value.dose_strength):1;if(j.value!==null){if(!await Qe()){ue("Please enter correct data values",4e3);return}const O=Ie.getSessionDate(),W=aa(O,parseInt(d.value));let Q=!1;Le(R.value)==!0&&(Q=!0);const ae={drugName:f.value,dose:C(),frequency:se.value.label,frequency_code:se.value.code,duration:d.value,prescription:W,drug_id:$.value,units:E.value,route_concept_id:oe.value.concept_id,route_name:oe.value.name,highlightbackground:Q},Ue=Pe();console.log(Ue.setSelectedMedicalDrugsList([ae])),Ue.editingDrugItem=null,A.value=!0}else{if(!await Qe()){ue("Please enter correct data values",4e3);return}Ua();const O=Ie.getSessionDate(),W=aa(O,parseInt(d.value));let Q=!1;Le(R.value)==!0&&(Q=!0);const ae={drugName:f.value,dose:C(),frequency:se.value.label,frequency_code:se.value.code,duration:d.value,prescription:W,drug_id:$.value,units:E.value,route_concept_id:oe.value.concept_id,route_name:oe.value.name,highlightbackground:Q};Pe().setSelectedMedicalDrugsList([ae])}$.value="",f.value="",_.value="",se.value=null,d.value="",D.value="",V.value++,ye.value=null,oe.value=null}catch(C){console.error("Error saving data:",C)}}async function Ha(C){const g=C,Q=await vt.getOfflineOPDDrugs({name:g,page:1,page_size:10});Q.map(ae=>({label:ae.name,value:ae.name,other:ae})),N.setPartialOPDdrugList(Q)}function Le(C){const g=[];return L.value.forEach(W=>{W.selected&&g.push(W.concept_id)}),Va([C],g)==!0?(ue("Client is allergic to the selected medication",4e6),!0):!1}function Va(C,g){try{return C.some(O=>g.includes(O.concept_id))}catch(O){return!1}}function Ba(C){C&&(f.value=C.name,$.value=C.drug_id,E.value=C.units,R.value=C,Le(C))}function Ma(C){const g=J.value[C],O=Pe();O.removeDrugById(g.drug_id),O.editingDrugItem=g,$.value="",f.value="",_.value="",se.value=null,d.value="",D.value="",ye.value=null,oe.value=null,$.value=g.drug_id,f.value=g.drugName,_.value=g.dose,se.value={label:g.frequency,code:g.frequency_code},d.value=g.duration,D.value=g.prescription;const W=G.value.find(Q=>Q.name===g.drugName);W&&(ye.value=W),oe.value={concept_id:g.route_concept_id,name:g.route_name},A.value=!1,V.value++}function Ya(){if(j.value!==null){$.value="",f.value="",_.value="",se.value=null,d.value="",D.value="",ye.value=null,oe.value=null;const C=Pe();C.setSelectedMedicalDrugsList([j.value]),C.editingDrugItem=null}A.value=!0,V.value++}function $a(C){J.value.splice(C,1),V.value++,ue("you have removed a drug from list",6e3)}function Ra(C){let g=C.target.value;La(g)}function La(C){Pe().setNonPharmalogicalTherapyAndOtherNotes(C)}function ea(C){return/^[0-9]+$/.test(C)}function aa(C,g){const O=new Date(C);O.setDate(O.getDate()+g);const W=O.getFullYear(),Q=String(O.getMonth()+1).padStart(2,"0"),ae=String(O.getDate()).padStart(2,"0");return"".concat(W,"-").concat(Q,"-").concat(ae)}function Ua(){t.value=!1,S.value=!0,A.value=!0}function Ga(C){q.filter(O=>O!==C.detail.value);const g=C.detail.value;g!==void 0?g=="third"&&(T.value="Show less notes",p.value=!n.value):(T.value="Show more notes",p.value=!n.value)}function qa(C){return C[1]}function Wa(C){(C.key==="Enter"||C.key==="ArrowDown")&&(C.preventDefault(),Ze())}const xe=K(()=>[{showAddItemButton:!0,addItemButton:!0,name:j.value!==null?"Update":"ADD",fn:Ze},{showAddItemButton:!0,addItemButton:!0,name:"CANCEL",fn:ja}]),ja=async()=>{yt(Da,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to cancel?"},{cancel:W=>{},confirm:async W=>{W.detail==!0&&Ya()}})};return(C,g)=>(l(),x(r(ga),null,{default:y(()=>[c("div",fo,[c("div",yo,[u(wa)])]),c("div",vo,[u(r(le),{lines:"none",class:"section-header"},{default:y(()=>[u(r(Be),{icon:r(Je),class:"section-icon"},null,8,["icon"]),u(r(U),{class:"section-title",style:{"margin-top":"12px"}},{default:y(()=>[...g[9]||(g[9]=[F("Medication",-1)])]),_:1})]),_:1}),c("div",bo,[(l(),x(It,{_selectedMedicalDrugsList:J.value,onEditItem:Ma,onRemoveItem:$a,key:V.value,class:"medication-list"},null,8,["_selectedMedicalDrugsList"])),A.value?b("",!0):(l(),w("div",go,[c("div",_o,[g[10]||(g[10]=c("label",{class:"input-label"},"Medication",-1)),u(r(Ne),{modelValue:ye.value,"onUpdate:modelValue":[g[0]||(g[0]=O=>ye.value=O),g[1]||(g[1]=O=>Ba(O))],options:G.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select medication",label:"name","track-by":"drug_id",onSearchChange:g[2]||(g[2]=O=>Ha(O))},{option:y(O=>[c("div",Co,P(O.option.name),1)]),_:1},8,["modelValue","options"]),Re.value?(l(),w("div",Do,P($e.value),1)):b("",!0)]),c("div",wo,[c("div",Ao,[g[11]||(g[11]=c("label",{class:"input-label"},"Route",-1)),u(r(Ne),{modelValue:oe.value,"onUpdate:modelValue":[g[3]||(g[3]=O=>oe.value=O),g[4]||(g[4]=O=>Oa(O))],options:ka.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select route",label:"name","track-by":"concept_id",disabled:!1},null,8,["modelValue","options"]),Oe.value?(l(),w("div",ko,P(he.value),1)):b("",!0)]),c("div",Oo,[g[12]||(g[12]=c("label",{class:"input-label"},"Frequency",-1)),u(r(Ne),{modelValue:se.value,"onUpdate:modelValue":[g[5]||(g[5]=O=>se.value=O),g[6]||(g[6]=O=>Fa(O))],options:r(s),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Select frequency",label:"label","track-by":"code"},null,8,["modelValue","options"]),Te.value?(l(),w("div",xo,P(He.value),1)):b("",!0)]),c("div",Po,[g[13]||(g[13]=c("label",{class:"input-label"},"Duration (days)",-1)),u(r(nt),{modelValue:d.value,"onUpdate:modelValue":g[7]||(g[7]=O=>d.value=O),type:"number",inputmode:"numeric",pattern:"[0-9]*",fill:"outline",placeholder:"Enter duration",onKeydown:Wa},null,8,["modelValue"]),a.value?(l(),w("div",So,P(e.value),1)):b("",!0)])]),c("div",To,[xe.value[0].addItemButton?(l(),x(De,{key:0,name:xe.value[0].name,icon:r(va),"onClicked:btn":xe.value[0].fn,class:"save-button"},null,8,["name","icon","onClicked:btn"])):b("",!0),xe.value[1].addItemButton?(l(),x(De,{key:1,name:xe.value[1].name,icon:r(ba),"onClicked:btn":xe.value[1].fn,class:"cancel-button"},null,8,["name","icon","onClicked:btn"])):b("",!0)])])),A.value?(l(),x(De,{key:1,name:M,icon:r(Me),fontWeight:"600","onClicked:btn":Na,class:"add-new-button"},null,8,["icon"])):b("",!0)])]),c("div",Eo,[u(r(le),{lines:"none",class:"section-header"},{default:y(()=>[u(r(Be),{icon:r(ot),class:"section-icon"},null,8,["icon"]),u(r(U),{class:"section-title"},{default:y(()=>[...g[14]||(g[14]=[F("Non-pharmacological therapy and other notes",-1)])]),_:1})]),_:1}),c("div",No,[u(Ft,{class:"intervention-component"}),c("div",Io,[u(r(le),{class:"notes-input-item"},{default:y(()=>[u(r(Be),{slot:"start",icon:r(v).editPen,class:"edit-icon","aria-hidden":"true"},null,8,["icon"]),u(r(st),{modelValue:X.value,"onUpdate:modelValue":g[8]||(g[8]=O=>X.value=O),onIonInput:Ra,placeholder:"Enter notes here...","auto-grow":!0,class:"notes-textarea",fill:"outline",style:{"--padding-start":"16px"}},null,8,["modelValue"])]),_:1})]),u(r(Ke),{ref:"accordionGroup",class:"previous-notes"},{default:y(()=>[u(r(be),{value:"fourth","toggle-icon-slot":"start"},{default:y(()=>[u(r(le),{slot:"header",color:"light",class:"previous-notes-header"},{default:y(()=>[u(r(U),null,{default:y(()=>[...g[15]||(g[15]=[F("Previous visit notes",-1)])]),_:1})]),_:1}),c("div",Fo,[c("div",Ho,[(l(!0),w(te,null,pe(I.value,(O,W)=>(l(),w(te,{key:W},[W===1?(l(),w("div",Vo,[(l(!0),w(te,null,pe(O,(Q,ae)=>(l(),w("div",{key:ae},[c("div",Bo,P(Q.date),1),c("div",Mo,P(Q.notes),1)]))),128))])):b("",!0)],64))),128)),u(r(Ke),{onIonChange:Ga},{default:y(()=>[u(r(be),{value:"third","toggle-icon-slot":"start"},{default:y(()=>[u(r(le),{slot:"header",color:"light",class:"show-more-header"},{default:y(()=>[u(r(U),{color:"primary"},{default:y(()=>[F(P(T.value),1)]),_:1})]),_:1}),c("div",Yo,[(l(!0),w(te,null,pe(ne.value,(O,W)=>(l(),w("div",{key:W,class:"note-entry"},[(l(!0),w(te,null,pe(qa(O),(Q,ae)=>(l(),w("div",{key:ae},[c("div",$o,P(Q.date),1),c("div",Ro,P(Q.notes),1)]))),128))]))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},512)])])]),_:1}))}}),Ss=ke(Uo,[["__scopeId","data-v-14c793af"]]);function Go(){return{showConfirm:async v=>{const s=await it.create({component:Da,componentProps:{message:v},cssClass:"otherVitalsModal"});return await s.present(),new Promise(t=>{const S=()=>{s.removeEventListener("confirm",S),t(!0)},A=()=>{s.removeEventListener("cancel",A),t(!1)};s.addEventListener("confirm",S),s.addEventListener("cancel",A),s.onDidDismiss().then(()=>t(!1))})}}}const qo={class:"form-grid"},Wo={class:"form-field"},jo={class:"form-field"},zo={class:"form-field"},Ko={class:"form-field"},Jo={key:0,class:"form-field checkbox-field"},Xo={class:"form-field"},Qo={class:"form-field"},Zo={class:"form-field"},es={class:"form-field full-width"},as={key:1,class:"form-field full-width"},ts={key:2,class:"form-field full-width"},ns={key:3,class:"form-field full-width"},os={class:"form-field"},ss={class:"form-field"},is={class:"form-field"},ls={class:"form-field"},rs={class:"form-field full-width"},cs={class:"button-container"},ds=re({name:"DeathOutcomeComponent"}),us=re({...ds,emits:["dataSaved"],setup(m,{emit:v}){const s=o(),t=o("guardian phone number"),S=o(),A=o(),{showConfirm:V}=Go(),B=K(()=>{const n=E.value.find(p=>p.selected);return(n==null?void 0:n.name)==="Other - specify"}),i=K(()=>{const n=$.value.find(p=>p.selected);return(n==null?void 0:n.name)==="Other - specify"}),e=K(()=>new Ca().isChildBearing()),a=K(()=>{const n=E.value.find(p=>p.selected);return(n==null?void 0:n.name)==="Accident"}),f=[{placeHolder:{default:"Enter time of death if known"},property_name:"timeOfDeath",dataHandler:n=>{f[0].dataValue.value=n,f[0].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time arrived"},property_name:"timeArrived",dataHandler:n=>{f[1].dataValue.value=n,f[1].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Time required",type:"time",skip_validation:!1},{placeHolder:{default:"Enter time confirming death"},property_name:"timeOfDeathConfirmation",dataHandler:n=>{f[2].dataValue.value=n,f[2].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Time required",skip_validation:!1}],_=[{placeHolder:{default:"Enter date of death"},property_name:"dateOfDeath",dataHandler:n=>{_[0].dataValue.value=n.value,_[0].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date arrived"},property_name:"dateArrived",dataHandler:n=>{_[1].dataValue.value=n.value,_[1].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Date required",type:"date",skip_validation:!1},{placeHolder:{default:"Enter date confirming death"},property_name:"dateOfDeathConfirmation",dataHandler:n=>{_[2].dataValue.value=n.value,_[2].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Date required",type:"date",skip_validation:!1}],d=[{placeHolder:"Enter place of death",property_name:"placeOfDeath",dataHandler:n=>{d[0].dataValue.value=n.target.value,d[0].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!1},{placeHolder:"Enter name of guardian",property_name:"nameOfGuardian",dataHandler:n=>{d[1].dataValue.value=n.target.value,d[1].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!1},{placeHolder:"Enter name of person confirming death",property_name:"nameOfPersonConfirmindDeath",dataHandler:n=>{d[2].dataValue.value=n.target.value,d[2].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!1},{placeHolder:"Enter position of the person confirming death",property_name:"positionOfthePersonConfirmingDeath",dataHandler:n=>{d[3].dataValue.value=n.target.value,d[3].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!1},{placeHolder:"Enter medical council registration number",property_name:"medicalConcilRegistrationNumberOfThePersonConfirmingDeath",dataHandler:n=>{d[4].dataValue.value=n.target.value,d[4].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"alphanumeric",skip_validation:!1},{placeHolder:"Specify other cause of death",property_name:"otherMannerNotes",dataHandler:n=>{d[5].dataValue.value=n.target.value,d[5].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!0},{placeHolder:"Specify other accident cause",property_name:"otherCauseNotes",dataHandler:n=>{d[6].dataValue.value=n.target.value,d[6].show_error.value=!1},dataValue:o(),show_error:o(!1),error_message:"Input required",type:"text",skip_validation:!0}],D=[{lblTxt:"Was the individual pregnant at the time of death?",value:o(!1),show_error:o(!1),error_message:"Please indicate pregnancy status",skip_validation:!1}],E=o([{id:1,name:"Natural",selected:!1},{id:2,name:"Accident",selected:!1},{id:3,name:"Homicide",selected:!1},{id:4,name:"Suicide",selected:!1},{id:5,name:"Pending investigation",selected:!1},{id:6,name:"Could not be determined",selected:!1},{id:7,name:"Other - specify",selected:!1}]),$=o([{id:1,name:"Motor vehicle (passenger)",selected:!1},{id:2,name:"Motor vehicle (pedestrian)",selected:!1},{id:3,name:"Drowning",selected:!1},{id:4,name:"Other - specify",selected:!1}]),M=[{property_name:"mannerOfDeath",show_error:o(!1),items:E.value},{property_name:"howDiditOccur",show_error:o(!1),items:$.value}];function N(n){M[0].show_error.value=!1,E.value.forEach(p=>p.selected=p.id===n.id),n.name!=="Accident"&&(A.value=null,$.value.forEach(p=>p.selected=!1),M[1].show_error.value=!1)}function Y(n){M[1].show_error.value=!1,$.value.forEach(p=>p.selected=p.id===n.id)}function L(){let n=!0;const p=E.value.find(T=>T.selected);return p||(M[0].show_error.value=!0,n=!1),(p==null?void 0:p.name)==="Accident"&&($.value.find(H=>H.selected)||(M[1].show_error.value=!0,n=!1)),n}const J=async()=>{const n=We(d),p=We(_),T=We(f),H=L();if(!n||!p||!T||!H){fa("Please fill in all required fields correctly.");return}try{const k=Ce.merge(je(d),je(_),je(f),X(M[0]),X(M[1])),j=[{concept_id:11520,value_coded:11520,child:G(k),obs_datetime:Se.sessionDate()}];await z.addObsToEncounterPatient(j,Z.PATIENT_OUTCOME),Fe("Patient outcome saved successfully"),ne("dataSaved",{dataSaved:!0})}catch(k){fa("Failed to save patient outcome")}},G=n=>{var H,k,R,j;const p=Se.sessionDate(),T=[];return(H=n.dateOfDeath)!=null&&H.formattedDate&&T.push({concept_id:1815,value_text:n.dateOfDeath.formattedDate,obs_datetime:p}),(k=n.dateArrived)!=null&&k.formattedDate&&T.push({concept_id:7398,value_text:n.dateArrived.formattedDate,obs_datetime:p}),(R=n.timeOfDeath)!=null&&R.time&&T.push({concept_id:9161,value_text:n.timeOfDeath.time,obs_datetime:p}),(j=n.timeArrived)!=null&&j.time&&T.push({concept_id:5605,value_text:n.timeArrived.time,obs_datetime:p}),n.mannerOfDeath&&T.push({concept_id:5002,value_text:n.mannerOfDeath,obs_datetime:p}),T};function X(n){const p=n.items.find(T=>T.selected);return p?{[n.property_name]:p.name}:{}}const q=()=>h(J,"Do you want to save the death outcome?"),h=async(n,p)=>{await V(p)&&n()},I=[{addItemButton:!0,name:"save",btnFill:"clear",fn:q},{addItemButton:!0,name:"cancel",btnFill:"clear",fn:()=>ne("dataSaved",{dataSaved:!0})}],ne=v;return(n,p)=>{const T=ge("ion-card-title");return l(),x(r(lt),null,{default:y(()=>[u(r(rt),null,{default:y(()=>[u(T,null,{default:y(()=>[...p[7]||(p[7]=[F("Death Outcome",-1)])]),_:1})]),_:1}),u(r(mt),null,{default:y(()=>[c("div",qo,[c("div",Wo,[u(ve,{placeholder:d[0].placeHolder,icon:r(ct),inputValue:d[0].dataValue.value,"onUpdate:inputValue":d[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[0].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[0].error_message),1)]),_:1})):b("",!0)]),c("div",jo,[u(qe,{place_holder:_[0].placeHolder,onDateUpDated:_[0].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[0].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(_[0].error_message),1)]),_:1})):b("",!0)]),c("div",zo,[u(ze,{place_holder:f[0].placeHolder,onTimeUpDated:f[0].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[0].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(f[0].error_message),1)]),_:1})):b("",!0)]),c("div",Ko,[u(ve,{placeholder:d[1].placeHolder,icon:r(pa),inputValue:d[1].dataValue.value,"onUpdate:inputValue":d[1].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[1].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[1].error_message),1)]),_:1})):b("",!0)]),e.value?(l(),w("div",Jo,[u(r(dt),{modelValue:D[0].value.value,"onUpdate:modelValue":p[0]||(p[0]=H=>D[0].value.value=H),alignment:"start",class:"ion-lblCls",onIonChange:p[1]||(p[1]=H=>D[0].show_error.value=!1)},{default:y(()=>[F(P(D[0].lblTxt),1)]),_:1},8,["modelValue"]),D[0].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(D[0].error_message),1)]),_:1})):b("",!0)])):b("",!0),c("div",Xo,[u(ve,{placeholder:t.value,icon:r(ut),modelValue:s.value,"onUpdate:modelValue":p[2]||(p[2]=H=>s.value=H)},null,8,["placeholder","icon","modelValue"])]),c("div",Qo,[u(qe,{place_holder:_[1].placeHolder,onDateUpDated:_[1].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[1].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(_[1].error_message),1)]),_:1})):b("",!0)]),c("div",Zo,[u(ze,{place_holder:f[1].placeHolder,onTimeUpDated:f[1].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[1].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(f[1].error_message),1)]),_:1})):b("",!0)]),c("div",es,[u(r(Ne),{modelValue:S.value,"onUpdate:modelValue":[p[3]||(p[3]=H=>S.value=H),p[4]||(p[4]=H=>N(H))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom",placeholder:"Manner of death",selectLabel:"",label:"name",searchable:!0,"track-by":"id",options:E.value},null,8,["modelValue","options"]),M[0].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(M[0].error_message),1)]),_:1})):b("",!0)]),B.value?(l(),w("div",as,[u(ve,{placeholder:d[5].placeHolder,icon:r(Ge),inputValue:d[5].dataValue.value,"onUpdate:inputValue":d[5].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[5].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[5].error_message),1)]),_:1})):b("",!0)])):b("",!0),a.value?(l(),w("div",ts,[u(r(Ne),{modelValue:A.value,"onUpdate:modelValue":[p[5]||(p[5]=H=>A.value=H),p[6]||(p[6]=H=>Y(H))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom",placeholder:"How did it occur?",selectLabel:"",label:"name",searchable:!0,"track-by":"id",options:$.value},null,8,["modelValue","options"]),M[1].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(M[1].error_message),1)]),_:1})):b("",!0)])):b("",!0),i.value?(l(),w("div",ns,[u(ve,{placeholder:d[6].placeHolder,icon:r(Ge),inputValue:d[6].dataValue.value,"onUpdate:inputValue":d[6].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[6].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[6].error_message),1)]),_:1})):b("",!0)])):b("",!0),c("div",os,[u(qe,{place_holder:_[2].placeHolder,onDateUpDated:_[2].dataHandler,date_prop:""},null,8,["place_holder","onDateUpDated"]),_[2].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(_[2].error_message),1)]),_:1})):b("",!0)]),c("div",ss,[u(ze,{place_holder:f[2].placeHolder,onTimeUpDated:f[2].dataHandler,time_prop:""},null,8,["place_holder","onTimeUpDated"]),f[2].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(f[2].error_message),1)]),_:1})):b("",!0)]),c("div",is,[u(ve,{placeholder:d[2].placeHolder,icon:r(pa),inputValue:d[2].dataValue.value,"onUpdate:inputValue":d[2].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[2].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[2].error_message),1)]),_:1})):b("",!0)]),c("div",ls,[u(ve,{placeholder:d[3].placeHolder,icon:r(Je),inputValue:d[3].dataValue.value,"onUpdate:inputValue":d[3].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[3].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[3].error_message),1)]),_:1})):b("",!0)]),c("div",rs,[u(ve,{placeholder:d[4].placeHolder,icon:r(Ge),inputValue:d[4].dataValue.value,"onUpdate:inputValue":d[4].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),d[4].show_error.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(d[4].error_message),1)]),_:1})):b("",!0)]),u(bt,{color:"#006401",animated:!0,thickness:1,class:"full-width-divider"}),c("div",cs,[I[0].addItemButton?(l(),x(De,{key:0,name:I[0].name,fill:I[0].btnFill,icon:r(va),"onClicked:btn":I[0].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0),I[1].addItemButton?(l(),x(De,{key:1,name:I[1].name,fill:I[1].btnFill,icon:r(ba),"onClicked:btn":I[1].fn},null,8,["name","fill","icon","onClicked:btn"])):b("",!0)])])]),_:1})]),_:1})}}}),ms=ke(us,[["__scopeId","data-v-b051bf57"]]),ps={class:"dash_box"},hs={key:1},fs=re({name:"xxxComponent"}),ys=re({...fs,setup(m){const v=o("No outcome created yet"),s=o(!1),t=o("please select a type"),S=o(!0),A=o(""),V=o(!0),B=o(!1),i=gt(),e=K(()=>i.outcomes),a=o(!1),f=o(!1),_=o(!1),d=o(!1),D=o(!1),E=o(!1);o();const $=o(null),M=o(null),N=o(null),Y=o(null),L=o(null),J=o(null),G=o([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1},{name:"Death",selected:!1}]),X=[{multi_Selection:!1,show_list_label:!0,unqueId:"qwerty2",name_of_list:"Add new outcome",placeHolder:"Choose one",items:G.value,listUpdatedFN:q,listFilteredFN:()=>{},use_internal_filter:!0,disabled:o(!1)}];function q(k){G.value=k,G.value.forEach(R=>{R.selected==!0&&(A.value=R.name)})}Ae(async()=>{I()}),fe(()=>A.value,async k=>{a.value==!0?a.value=!1:T()}),fe(()=>e.value.length,async k=>{I()});function h(){G.value.forEach(k=>{k.selected=!1}),A.value=""}function I(){e.value.length>0?V.value=!1:e.value.length==0&&B.value==!1&&(V.value=!0)}function ne(k){e.value.splice(k,1)}function n(k){G.value.forEach(R=>{k.selected==!0&&(k.name==R.name||k.type==R.name)&&(A.value=R.name)})}const p=k=>{ne(k.index),n(k.item),$.value=k.item.other.location_data,M.value={reason:k.item.reason,date:k.item.date,time:k.item.time},N.value=k.item.other,Y.value=k.item,k.item.type==="Discharged Home"&&(L.value=k.item,J.value={reason:k.item.reason,date:k.item.date})};async function T(k=!0){const R=A.value;console.log(R),A.value=R;const j=A.value;j==G.value[0].name?_.value=!0:_.value=!1,j==G.value[1].name?(d.value=!0,console.log("show_discharged_options is set to true")):d.value=!1,j==G.value[2].name?(D.value=!0,console.log("show_discharged_options is set to true")):D.value=!1,j==G.value[3].name?E.value=!0:E.value=!1,j==G.value[4].name?f.value=!0:f.value=!1}function H(){f.value=!1,_.value=!1,d.value=!1,D.value=!1,h()}return(k,R)=>{const j=ge("ion-row");return l(),x(r(ga),null,{default:y(()=>[u(j,null,{default:y(()=>[u(r(ha),null,{default:y(()=>[(l(),x(Mt,{key:0,"onUpdate:removeItem":ne,"onUpdate:editItem":p,displayData:e.value},null,8,["displayData"]))]),_:1})]),_:1}),V.value?(l(),x(j,{key:0},{default:y(()=>[c("span",ps,P(v.value),1)]),_:1})):b("",!0),S.value?(l(),w("div",hs,[u(j,null,{default:y(()=>[u(r(ha),null,{default:y(()=>[u(_t,{multiSelection:X[0].multi_Selection,show_label:X[0].show_list_label,uniqueId:X[0].unqueId,name_of_list:X[0].name_of_list,choose_place_holder:X[0].placeHolder,"items_-list":X[0].items,use_internal_filter:X[0].use_internal_filter,disabled:X[0].disabled.value,onItemListUpDated:X[0].listUpdatedFN,onItemListFiltered:X[0].listFilteredFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered"]),c("div",null,[s.value?(l(),x(r(U),{key:0,class:"error-label"},{default:y(()=>[F(P(t.value),1)]),_:1})):b("",!0)])]),_:1})]),_:1})])):b("",!0),_.value?(l(),x(Yt,{key:2,onDataSaved:H,selected_ward_prop:N.value,admitted_other_props:Y.value},null,8,["selected_ward_prop","admitted_other_props"])):b("",!0),d.value?(l(),x($t,{key:3,onDataSaved:H,selected_referral_data:$.value,selected_other_referral_data:M.value},null,8,["selected_referral_data","selected_other_referral_data"])):b("",!0),D.value?(l(),x(Rt,{key:4,onDataSaved:H,selected_discharged_prop:L.value,selected_discharged_data:J.value},null,8,["selected_discharged_prop","selected_discharged_data"])):b("",!0),f.value?(l(),x(ms,{key:5,onDataSaved:H})):b("",!0),E.value?(l(),x(Lt,{key:6,onDataSaved:H})):b("",!0)]),_:1})}}}),Ts=ke(ys,[["__scopeId","data-v-624d1093"]]);export{Ps as C,Ts as O,jt as P,Kn as _,Zn as a,Ss as b};
