import{d as j,W as M,a5 as $,_ as ge,H as Y,e as Q,f as c,P as fe,O as p,J as a,l as o,Q as x,K as T,k as P,p as ce,F as ae,r as l,w as J,u as e,e4 as be,m as I,bS as De,a as ee,bq as te,aQ as le,aR as oe,a4 as R,bl as ve,ea as he,bn as ne,a2 as re,aU as se,N as we,aV as Se,c as Ie,aj as ke}from"./vendor-BolvhNQv.js";import{i as Ve,V as Ce,l as Fe,_ as G,B as _e,aN as de,t as Z,o as Ae,ax as me,J as K,F as Be,L as He,b1 as Ue,a as Pe,az as xe,aA as Ne,ar as Ee,a8 as Te,m as Re,aS as $e,S as pe,H as ie,G as Oe}from"../index-BJJABCwX.js";import{l as Le}from"./lodash-NJiRuGo9.js";const Me=j({components:{IonItem:ge,IonCol:$,IonLabel:M},data(){return{iconsContent:Fe}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(u){const m=document.getElementById(u+"_lbl");m&&(m.style.color="#006401"),this.highlightActionBtns(u)},undoHighlightItem(u){const m=document.getElementById(u+"_lbl");m&&(m.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(u)},highlightActionBtns(u){const m=document.getElementsByClassName(u+"_spanlbl");for(let v=0;v<m.length;v++)m[v].style.display="block"},undohighlightActionBtns(u){const m=document.getElementsByClassName(u+"_spanlbl");for(let v=0;v<m.length;v++)m[v].style.display="none"},asignLblID(u){return u+"_lbl"},asignSpanLblID(u){return u+"_spanlbl"},async removeItemAtIndex(u,m){await Ce("Do you want to delete it?",m)&&this.$emit("update:removeItem",u)},async editItemAtIndex(u,m,v){await Ve("Do you want to edit it?",v)&&this.$emit("update:editItem",{index:u,item:m})},fomartDate(u){const m=u.year,v=(u.month<10?"0":"")+u.month,S=(u.day<10?"0":"")+u.day;return m+"-"+v+"-"+S}}});function qe(u,m,v,S,k,h){const g=Y("ion-label"),D=Y("ion-col"),w=Y("ion-icon"),b=Y("ion-item");return c(!0),Q(ae,null,fe(u.displayData,(n,s)=>(c(),p(b,{displayData:u.displayData,class:"ionLbltp",key:s,onMousemove:y=>u.highlightItem(s),onMouseout:y=>u.undoHighlightItem(s)},{default:a(()=>[o(D,{class:"col-st1"},{default:a(()=>[o(g,{id:u.asignLblID(s),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[x(T(n.type),1)]),_:2},1032,["id"])]),_:2},1024),o(D,{class:"col-st2"},{default:a(()=>[o(g,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[m[0]||(m[0]=P("span",{class:"spaceBetween"},null,-1)),x(" "+T(n.name)+" ",1),m[1]||(m[1]=P("span",{class:"spaceBetween"},null,-1)),x(T(n.reason),1),m[2]||(m[2]=P("span",{class:"spaceBetween"},null,-1)),x(T(u.fomartDate(n.date)),1)]),_:2},1024)]),_:2},1024),o(D,{class:"action_buttons"},{default:a(()=>[o(g,{class:ce(u.asignSpanLblID(s)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:y=>u.editItemAtIndex(s,n,y)},{default:a(()=>[o(w,{icon:u.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),o(g,{class:ce(u.asignSpanLblID(s)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:y=>u.removeItemAtIndex(s,y)},{default:a(()=>[o(w,{icon:u.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const We=G(Me,[["render",qe],["__scopeId","data-v-4346bf77"]]),ye=j({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(u,{emit:m}){const v=l(),S=l({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),k=l(),h={name:"Now",show:!0,fn:O},g=l(!0),D=l(!1),w=l(0),b=u;J(()=>b.time_prop,U=>{U&&(v.value=U.time)},{immediate:!0,deep:!0});const n=m;function s(){n("timeUpDated",k.value)}function y(U){D.value==!0?(g.value=!1,D.value=!1):g.value=!0,S.value.isOpen=!0,S.value.event=U}function H(U){v.value=U.detail.value;const A=F(v.value);if(N(A)==!0){O();return}v.value=A}function N(U){return U.indexOf("NaN")!==-1}function F(U){let A=new Date(U),B=A.getHours(),q=A.getMinutes(),L=B>=12?"PM":"AM";B=B%12,B=B||12;let i=B.toString().padStart(2,"0")+":"+q.toString().padStart(2,"0")+" "+L;return k.value={time:i,meridian:L},s(),i}function O(){D.value=!0,v.value=F(new Date),g.value=!1,w.value++}return(U,A)=>{const B=Y("ion-popover");return c(),Q(ae,null,[(c(),p(_e,{placeholder:b.place_holder.default,inputValue:v.value,icon:e(be),"-inner-action-btn-propeties":h,"onClicked:inputValue":y,"onUpdate:InnerActionBtnPropetiesAction":h.fn,key:w.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),o(B,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":S.value.isOpen,event:S.value.event,side:"top",onDidDismiss:A[0]||(A[0]=q=>S.value.isOpen=!1)},{default:a(()=>[g.value?(c(),p(e(De),{key:0,onIonChange:H,id:"datetime",presentation:"time","show-default-buttons":!0})):I("",!0)]),_:1},8,["is-open","event"])],64)}}}),je=j({name:"xxxComponent"}),ze=j({...je,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(u,{emit:m}){const v=l([]),S=de(),k=l(NaN),h=l(!1),g=l(),D=l(!1);ee(async()=>{A(),H()});const w=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:B},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:C}],b=[{placeHolder:"Reason",dataHandler:O,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],n=[{placeHolder:{default:"Enter date"},dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],s=[{placeHolder:{default:"Enter time of admission"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"error"}],y=u;J(()=>y.selected_ward_prop,_=>{_&&(g.value=_)},{immediate:!0,deep:!0}),J(()=>y.admitted_other_props,_=>{_&&(b[0].dataValue.value=_.reason,s[0].dataValue.value=_.time,n[0].dataValue.value=_.date)},{immediate:!0,deep:!0});function H(_=!0){D.value=_}function N(_){s[0].dataValue.value=_,B(!1)}function F(_){const d={day:_.value.day,month:_.value.month,year:_.value.year,formattedDate:_.value.formattedDate};n[0].dataValue.value=d,B(!1)}function O(_){const d=_.target.value;b[0].dataValue.value=d,U(),H(!1)}function U(){D.value==!0&&Z("Remember to press the SAVE button",1e4)}async function A(_){v.value=await Ae("wards")}function B(_=!0){q(),L(),V(),W(),n[0].show_error.value==!1&&s[0].show_error.value==!1&&b[0].show_error.value==!1&&h.value==!1?i():_&&Z("Please enter correct data values",4e3)}function q(){g.value===void 0||g.value==""?h.value=!0:h.value=!1}function L(){b[0].dataValue.value==""||b[0].dataValue.value===void 0?b[0].show_error.value=!0:b[0].show_error.value=!1}async function i(){const _={name:g.value.name,type:"Admitted for short stay",date:n[0].dataValue,time:s[0].dataValue,reason:b[0].dataValue,other:g.value,selected:!0};await S.addOutcomeData(_,k.value)&&r({dataSaved:!1})}const t=m;function r(_={dataSaved:!0}){t("dataSaved",_)}function C(){r()}function V(){n[0].dataValue.value===void 0||n[0].dataValue.value==""?n[0].show_error.value=!0:n[0].show_error.value=!1}function W(){s[0].dataValue.value===void 0||n[0].dataValue.value==""?s[0].show_error.value=!0:s[0].show_error.value=!1}const X=_=>{g.value=_,H(),B(!1)};return(_,d)=>(c(),p(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),{onClick:d[0]||(d[0]=f=>A("dd"))},{default:a(()=>[...d[4]||(d[4]=[x("Admitted for Short Stay",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(ve),{modelValue:g.value,"onUpdate:modelValue":[d[1]||(d[1]=f=>g.value=f),d[2]||(d[2]=f=>X(f))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:d[3]||(d[3]=f=>f={}),"track-by":"location_ward_id",options:v.value},null,8,["modelValue","options"]),P("div",null,[h.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[...d[5]||(d[5]=[x(T("Please select a ward"),-1)])]),_:1})):I("",!0)])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[P("div",null,[o(me,{place_holder:n[0].placeHolder,onDateUpDated:n[0].dataHandler,date_prop:n[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),P("div",null,[n[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(n[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[P("div",null,[o(ye,{place_holder:s[0].placeHolder,onTimeUpDated:s[0].dataHandler,time_prop:s[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),P("div",null,[s[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(s[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:b[0].placeHolder,icon:e(he),inputValue:b[0].dataValue.value,"onUpdate:inputValue":b[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),P("div",null,[b[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(b[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),w[0].showAddItemButton?(c(),p(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[w[0].addItemButton?(c(),p(K,{key:0,name:w[0].name,fill:w[0].btnFill,icon:e(ne),"onClicked:btn":w[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),w[1].addItemButton?(c(),p(K,{key:1,name:w[1].name,fill:w[1].btnFill,icon:e(re),"onClicked:btn":w[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),Je=G(ze,[["__scopeId","data-v-060f83ec"]]),Ke=j({name:"xxxComponent"}),Qe=j({...Ke,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(u,{emit:m}){const v=l(NaN),S=l(null),k=de(),h=l(!1),g=l([]),D=l({}),w=l(!0),b={location_data:{}},n=[{placeHolder:"Reason",dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],s=[{placeHolder:{default:"Enter date"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],y=[{placeHolder:{default:"Enter time of referral"},dataHandler:U,dataValue:l(),show_error:l(!1),error_message:"error"}],H=u;J(()=>H.selected_other_referral_data,d=>{d&&(n[0].dataValue.value=d.reason,s[0].dataValue.value=d.date,y[0].dataValue.value=d.time)},{immediate:!0,deep:!0}),J(()=>H.selected_referral_data,d=>{if(!d)return;S.value=d.selected_location,b.location_data=d;const f=Array.isArray(d.selected_district_ids)?[...d.selected_district_ids]:[],E=d.selected_location?{...d.selected_location}:null;g.value=f,D.value=E},{immediate:!0,deep:!0}),ee(()=>{t()});function N(d){const f={day:d.value.day,month:d.value.month,year:d.value.year,formattedDate:d.value.formattedDate};s[0].dataValue.value=f,A(!1)}function F(d){const f=d.target.value;n[0].dataValue.value=f,O(),t(!1)}function O(){w.value==!0&&Z("Remember to press the SAVE button",1e4)}function U(d){y[0].dataValue.value=d,A(!1)}function A(d=!0){i(),B(),q(),L(),s[0].show_error.value==!1&&y[0].show_error.value==!1&&n[0].show_error.value==!1&&h.value==!1?C():d&&Z("Please enter correct data values",4e3)}function B(){n[0].dataValue.value==""||n[0].dataValue.value===void 0?n[0].show_error.value=!0:n[0].show_error.value=!1}function q(){s[0].dataValue.value===void 0||s[0].dataValue.value==""?s[0].show_error.value=!0:s[0].show_error.value=!1}function L(){y[0].dataValue.value===void 0||s[0].dataValue.value==""?y[0].show_error.value=!0:y[0].show_error.value=!1}function i(){S.value?h.value=!1:h.value=!0}function t(d=!0){w.value=d}const r=d=>{S.value=d.selected_location,i(),b.location_data=d,t(),A(!1)},C=async()=>{const d={name:S.value.name,type:"Referred out",selected:!0,date:s[0].dataValue,time:y[0].dataValue,reason:n[0].dataValue},f={...d,other:{ref_data:d,location_data:b.location_data}};await k.addOutcomeData(f,v.value)&&X({dataSaved:!1})},V=()=>{X()},W=m;function X(d={dataSaved:!0}){W("dataSaved",d)}const _=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:A},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:V}];return(d,f)=>(c(),p(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...f[0]||(f[0]=[x("Referred Out",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(Be,{show_error:h.value,onFacilitySelected:r,selected_district_ids:g.value,selected_location:D.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[P("div",null,[o(me,{place_holder:s[0].placeHolder,onDateUpDated:s[0].dataHandler,date_prop:s[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),P("div",null,[s[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(s[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[P("div",null,[o(ye,{place_holder:y[0].placeHolder,onTimeUpDated:y[0].dataHandler,time_prop:y[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),P("div",null,[y[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(y[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:n[0].placeHolder,icon:e(he),inputValue:n[0].dataValue.value,"onUpdate:inputValue":n[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),P("div",null,[n[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(n[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),_[0].showAddItemButton?(c(),p(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[_[0].addItemButton?(c(),p(K,{key:0,name:_[0].name,fill:_[0].btnFill,icon:e(ne),"onClicked:btn":_[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),_[1].addItemButton?(c(),p(K,{key:1,name:_[1].name,fill:_[1].btnFill,icon:e(re),"onClicked:btn":_[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),Ge=G(Qe,[["__scopeId","data-v-f25626fb"]]),Xe=j({name:"xxxComponent"}),Ye=j({...Xe,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(u,{emit:m}){const v=l(NaN),S=l([]),k=de(),h=l();ee(async()=>{N("")});const g=[{placeHolder:"Reason",dataHandler:n,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],D=[{placeHolder:{default:"Enter date"},dataHandler:b,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],w=u;J(()=>w.selected_discharged_prop,t=>{t&&(h.value=t)},{immediate:!0,deep:!0}),J(()=>w.selected_discharged_data,t=>{t&&(D[0].dataValue.value=t.date||"",t.reason&&(g[0].dataValue.value=t.reason))},{immediate:!0,deep:!0});function b(t){const r={day:t.value.day,month:t.value.month,year:t.value.year,formattedDate:t.value.formattedDate};D[0].dataValue.value=r,O(!1)}function n(t){const r=t.target.value;g[0].dataValue.value=r}S.value,l(!1),l(!1);const s=[{placeHolder:{default:"Enter time of referral"},dataHandler:y,dataValue:l(),show_error:l(!1),error_message:"error"}];function y(t){s[0].dataValue.value=t}const H=new Set;async function N(t){const r=t,C=await He.getFacilities({name:r});C||C.forEach(V=>{H.has(V.location_id)||(H.add(V.location_id),Le.isEmpty(V.name)==!1&&S.value.push({name:V.name,selected:!1,other:V}))})}function F(t){S.value=t}function O(t=!0){U(),D[0].show_error.value?t&&Z("Please enter a valid date",4e3):A()}function U(){D[0].dataValue.value===void 0||D[0].dataValue.value==""?D[0].show_error.value=!0:D[0].show_error.value=!1}async function A(){const t={type:"Discharged Home",date:D[0].dataValue,reason:g[0].dataValue.value};await k.addOutcomeData(t,v.value)&&L({dataSaved:!1})}function B(){L()}const q=m;function L(t={dataSaved:!0}){q("dataSaved",t)}const i=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:O},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:B}];return(t,r)=>(c(),p(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...r[0]||(r[0]=[x("Discharged Home",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[P("div",null,[o(me,{place_holder:D[0].placeHolder,onDateUpDated:D[0].dataHandler,date_prop:D[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),P("div",null,[D[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(D[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),i[0].showAddItemButton?(c(),p(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[i[0].addItemButton?(c(),p(K,{key:0,name:i[0].name,fill:i[0].btnFill,icon:e(ne),"onClicked:btn":i[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),i[1].addItemButton?(c(),p(K,{key:1,name:i[1].name,fill:i[1].btnFill,icon:e(re),"onClicked:btn":i[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),Ze=G(Ye,[["__scopeId","data-v-c55ed5f5"]]),ea={class:"date-results-container"},aa={class:"date-buttons-container"},ta={key:0,class:"validation-message"},la={__name:"DatePillSelector",props:{availableDates:{type:Array,required:!0,default:()=>[]}},emits:["dateSelected"],setup(u,{expose:m,emit:v}){const S=u,k=v,h=l(null),g=l(!1),D=s=>{h.value=s,g.value=!1,k("dateSelected",{date:S.availableDates[s],index:s})},w=s=>{const y=new Date(s),H={weekday:"short",month:"short",day:"numeric"};return isNaN(y)?s:y.toLocaleDateString("en-US",H)};return m({validateSelection:()=>h.value===null?(g.value=!0,!1):(g.value=!1,!0),getSelectedDate:()=>h.value!==null?S.availableDates[h.value]:null}),(s,y)=>(c(),Q("div",ea,[P("div",aa,[(c(!0),Q(ae,null,fe(u.availableDates,(H,N)=>(c(),p(e(we),{key:N,class:ce(["date-button",{selected:h.value===N,"error-border":g.value&&h.value!==N}]),fill:"outline",shape:"round",onClick:F=>D(N)},{default:a(()=>[x(T(w(H)),1)]),_:2},1032,["class","onClick"]))),128))]),g.value?(c(),Q("p",ta," ⚠️ Please select an available date to proceed. ")):I("",!0)]))}},oa=G(la,[["__scopeId","data-v-1e34f199"]]);class na extends Ue{constructor(m,v){super(m,114,v)}}const ra=j({__name:"ReferToAnotherClinic",emits:["programDateSelected","referralDataReady","dataSaved"],setup(u,{emit:m}){const v=m,S=l([]),k=l([]),h=l([]),g=Pe(),D=xe(),{activeProgram:w}=Se(g),b=l(!1),n=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Clinics",placeHolder:"Search for programs",items:[],listUpdatedFN:U,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:l(!1),error_message:"Please select one or more clinics/programs to refer to.",disabled:l(!1)}],s=async()=>{b.value=!1;const i=k.value.length>0;if(n[0].show_error.value=!i,!i){console.log("Validation Failed: No programs selected.");return}let t=!0;h.value=[];for(const r of k.value)if(r.dateSelectorRef)if(!r.dateSelectorRef.validateSelection())t=!1;else{const V=r.dateSelectorRef.getSelectedDate();V?h.value.push({programId:r.id,programName:r.name,date:V}):t=!1}else t=!1,console.error("Date Selector ref is missing for program ".concat(r.name));if(!t){b.value=!0,console.log("Validation Failed: Not all dates selected.");return}console.log("Validation Passed! Ready to refer patient with data:",h.value),v("referralDataReady",h.value),await L(h.value,y)},y=async i=>{try{const t=pe.getUserID(),r=pe.getPatientID(),C=new na(r,t);await C.createEncounter();const V=i.map(W=>({concept_id:2227,value_numeric:W.programId,obs_datetime:ie.sessionDate(),child:[{concept_id:11242,value_text:ie.toStandardHisFormat(W.date),obs_datetime:ie.sessionDate()}]}));await C.saveObservationList(V),Oe("Patient referral saved successfully"),N()}catch(t){Z("Error saving referral data. Please try again.",4e3),console.error("Error in sub_refferal_data:",t)}},H=()=>{N()};function N(i={dataSaved:!0}){v("dataSaved",i)}const F=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:s},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:H}],O=(i,t,r)=>{v("programDateSelected",{programId:t,programName:r,date:i}),b.value=!1;const C=h.value.findIndex(W=>W.programId===t),V={programId:t,programName:r,date:i};C>-1?h.value[C]=V:h.value.push(V)};async function U(i){S.value=i,A(),b.value=!1,await B()}function A(){const i=[];S.value.forEach(r=>{r.selected==!0&&i.push(r.other)});const t=i.map(r=>r.program_id);k.value=k.value.filter(r=>t.includes(r.id)),h.value=h.value.filter(r=>t.includes(r.programId)),i.forEach(r=>{k.value.some(C=>C.id===r.program_id)||k.value.push({id:r.program_id,name:r.name,dates:[],dateSelectorRef:null})}),n[0].show_error.value=i.length===0}const B=async()=>{const i=k.value.map(async t=>{try{const r=D.getAvailableDatesByProgramId(t.id,90,!0,4);t.dates=r}catch(r){console.error("Error fetching dates for program ".concat(t.name,":"),r),t.dates=[]}});await Promise.all(i)};async function q(){const i=w.value.program_id,t=await Te.getAllPrograms(),r=[];t.forEach(C=>{C.program_id!==i&&r.push({name:C.name,other:C,selected:!1})}),S.value=r}const L=async(i,t)=>{Re($e,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Referral(s)?"},{cancel:W=>{},confirm:async W=>{W.detail==!0&&await t(i)}})};return ee(async()=>{await q(),Ne()}),(i,t)=>(c(),p(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...t[0]||(t[0]=[x("Refer to another clinic",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:a(()=>[...t[1]||(t[1]=[x(" Program(s)",-1),P("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),o(Ee,{multiSelection:n[0].multi_Selection,show_label:n[0].show_list_label,uniqueId:n[0].unqueId,name_of_list:n[0].name_of_list,choose_place_holder:n[0].placeHolder,"items_-list":S.value,use_internal_filter:n[0].use_internal_filter,disabled:n[0].disabled.value,onItemListUpDated:n[0].listUpdatedFN,onItemListFiltered:n[0].listFilteredFN,onItemSearchText:n[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),P("div",null,[n[0].show_error.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(n[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),(c(!0),Q(ae,null,fe(k.value,(r,C)=>(c(),p(e(R),{key:r.id},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-top":"20px","font-weight":"bold",display:"block"}},{default:a(()=>[t[2]||(t[2]=P("span",{style:{color:"gray"}},"Available Dates for:",-1)),x(" "+T(r.name),1)]),_:2},1024),o(oa,{availableDates:r.dates,onDateSelected:V=>O(V,r.id,r.name),ref_for:!0,ref:V=>{V&&(r.dateSelectorRef=V)}},null,8,["availableDates","onDateSelected"])]),_:2},1024)]),_:2},1024))),128)),b.value?(c(),p(e(R),{key:0,style:{"margin-top":"-10px"}},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{class:"error-label"},{default:a(()=>[...t[3]||(t[3]=[x(" ⚠️ Please select an available date for all selected programs. ",-1)])]),_:1})]),_:1})]),_:1})):I("",!0),o(e(R),{class:"action-buttons"},{default:a(()=>[o(e($),{class:"ion-text-end"},{default:a(()=>[F[1].addItemButton?(c(),p(K,{key:0,name:F[1].name,fill:F[1].btnFill,icon:e(re),"onClicked:btn":F[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),k.value.length>0?(c(),p(K,{key:1,name:F[0].name,fill:F[0].btnFill,icon:e(ne),"onClicked:btn":F[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),sa=G(ra,[["__scopeId","data-v-721c6ae2"]]),da={class:"dash_box"},ua={key:0,style:{"margin-top":"100px"}},ia=j({name:"xxxComponent"}),ca=j({...ia,setup(u){const m=l("No outcome created yet"),v=l(!1),S=l(!0),k=l(""),h=l(!0),g=l(!1),D=de(),w=Ie(()=>D.outcomes),b=l(!1),n=l(!1),s=l(!1),y=l(!1),H=l(!1),N=l(!1),F=l(),O=l(null),U=l(null),A=l(null),B=l(null),q=l(null),L=l(null),i=l([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]);function t(f){i.value.forEach(E=>{f.selected==!0&&(f.name==E.name||f.type==E.name)&&(k.value=E.name)})}ee(async()=>{C()}),J(()=>k.value,async f=>{b.value==!0?b.value=!1:X()}),J(()=>w.value.length,async f=>{C()});function r(){i.value.forEach(f=>{f.selected=!1}),k.value=""}function C(){w.value.length>0?h.value=!1:w.value.length==0&&g.value==!1&&(h.value=!0)}function V(f){w.value.splice(f,1)}const W=f=>{V(f.index),t(f.item),O.value=f.item.other.location_data,U.value={reason:f.item.reason,date:f.item.date,time:f.item.time},A.value=f.item.other,B.value=f.item,f.item.type==="Discharged Home"&&(q.value=f.item,L.value={reason:f.item.reason,date:f.item.date})};async function X(f=!0){const E=k.value;k.value=E;const z=k.value;z==i.value[0].name?s.value=!0:s.value=!1,z==i.value[1].name?y.value=!0:y.value=!1,z==i.value[2].name?H.value=!0:H.value=!1,z==i.value[3].name?N.value=!0:N.value=!1}function _(){n.value=!1,s.value=!1,H.value=!1,y.value=!1,r()}const d=f=>{i.value.forEach(E=>{E.selected=!1}),F.value=f,F.value.selected=!0,t(F.value)};return(f,E)=>{const z=Y("ion-row");return c(),p(e(ke),null,{default:a(()=>[o(z,null,{default:a(()=>[o(e($),null,{default:a(()=>[(c(),p(We,{key:0,"onUpdate:removeItem":V,"onUpdate:editItem":W,displayData:w.value},null,8,["displayData"]))]),_:1})]),_:1}),h.value?(c(),p(z,{key:0},{default:a(()=>[P("span",da,T(m.value),1)]),_:1})):I("",!0),o(z,null,{default:a(()=>[o(e($),null,{default:a(()=>[S.value?(c(),Q("div",ua,[o(z,null,{default:a(()=>[o(e(ve),{modelValue:F.value,"onUpdate:modelValue":[E[0]||(E[0]=ue=>F.value=ue),E[1]||(E[1]=ue=>d(ue))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:i.value},null,8,["modelValue","options"]),P("div",null,[v.value?(c(),p(e(M),{key:0,class:"error-label"},{default:a(()=>[...E[2]||(E[2]=[x(T("please select a type"),-1)])]),_:1})):I("",!0)])]),_:1})])):I("",!0)]),_:1})]),_:1}),s.value?(c(),p(Je,{key:1,onDataSaved:_,selected_ward_prop:A.value,admitted_other_props:B.value},null,8,["selected_ward_prop","admitted_other_props"])):I("",!0),y.value?(c(),p(Ge,{key:2,onDataSaved:_,selected_referral_data:O.value,selected_other_referral_data:U.value},null,8,["selected_referral_data","selected_other_referral_data"])):I("",!0),H.value?(c(),p(Ze,{key:3,onDataSaved:_,selected_discharged_prop:q.value,selected_discharged_data:L.value},null,8,["selected_discharged_prop","selected_discharged_data"])):I("",!0),N.value?(c(),p(sa,{key:4,onDataSaved:_})):I("",!0)]),_:1})}}}),pa=G(ca,[["__scopeId","data-v-2873182f"]]);export{Je as A,We as D,pa as O,Ge as R,ye as _,Ze as a,sa as b};
