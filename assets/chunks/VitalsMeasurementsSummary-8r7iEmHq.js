import{d as j,b2 as q,cp as z,r as i,w as _,a as G,b7 as C,cW as Q,e as h,f as w,l as U,J as X,k as S,F as Y,P as Z,K as $,u as tt}from"./vendor-BuyqdZ53.js";import{u as et,ag as at,af as o,H as y,bb as st,_ as ot}from"../index-Wz3npakQ.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BQpaTz5X.js";const nt={class:"table-responsive"},rt=j({__name:"VitalsMeasurementsSummary",setup(ct){const B=et(),{patient:c}=q(B),M=z(),T=i(null),l=i([]),b=i(""),E=i(["Date","Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic","BMI"]),V=i({responsive:!0,select:!1,layout:{topStart:"",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1}),d=async()=>{try{l.value=[];const r=(await at.getObsByEncounterId(6)).flatMap(e=>e.obs||[]),t=new Map;r.forEach(e=>{var a;if(e.obs_datetime){const s=e.obs_datetime.split(" ")[0];t.has(s)||t.set(s,[]),(a=t.get(s))==null||a.push(e)}});for(const[e,a]of t.entries())await k(e,a);l.value.sort((e,a)=>new Date(a[0]).getTime()-new Date(e[0]).getTime())}catch(n){console.error("Error updating vitals data:",n)}},k=async(n,r)=>{const t=K=>{var D;const I=r.find(L=>L.concept_id===K);return(D=I==null?void 0:I.value_numeric)!=null?D:""},e=await o.getConceptID("Height (cm)"),a=await o.getConceptID("Weight (kg)"),s=await o.getConceptID("Systolic blood pressure"),p=await o.getConceptID("Diastolic blood pressure"),u=await o.getConceptID("Temperature (c)"),g=await o.getConceptID("Pulse"),O=await o.getConceptID("Blood oxygen saturation"),R=await o.getConceptID("Respiratory rate"),m=t(a),f=t(e),H=t(u),F=t(g),P=t(O),W=t(s),A=t(R),N=t(p);let v="";m&&f&&(v=await x(m,f));const J=[y.toStandardHisDisplayFormat(n),m,f,H,F,P,W,A,N,v];l.value.push(J)},x=async(n,r)=>{var t,e,a,s,p,u;if((e=(t=c.value)==null?void 0:t.personInformation)!=null&&e.gender&&((s=(a=c.value)==null?void 0:a.personInformation)!=null&&s.birthdate))try{return b.value=await st.getBMI(parseInt(String(n)),parseInt(String(r)),c.value.personInformation.gender,y.calculateAge(c.value.personInformation.birthdate,y.sessionDate())),(u=(p=b.value)==null?void 0:p.index)!=null?u:""}catch(g){return console.error("Error calculating BMI:",g),""}return""};return _(()=>M.path,async()=>{await d()},{deep:!0}),_(c,async()=>{await d()},{deep:!0}),G(async()=>{await d(),C.use(Q)}),(n,r)=>(w(),h("div",nt,[U(tt(C),{ref_key:"dataTable",ref:T,options:V.value,data:l.value,class:"display nowrap modern-table",width:"100%"},{default:X(()=>[S("thead",null,[S("tr",null,[(w(!0),h(Y,null,Z(E.value,t=>(w(),h("th",{key:t},$(t),1))),128))])])]),_:1},8,["options","data"])]))}}),dt=ot(rt,[["__scopeId","data-v-0a1dc812"]]);export{dt as default};
