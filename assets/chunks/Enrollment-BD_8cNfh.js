import{d as U,eT as Q,r as S,c as ee,w as V,e as D,m as O,f as h,k as n,l as p,u,aR as Fe,J as k,L as B,bj as te,cz as we,Q as A,aQ as Ne,aU as Se,Y as Ie,bH as ke,N as K,aZ as xe,F as ae,P as re,K as F,cK as $e,a as ie,O as j,ao as Ve,ff as Me,bk as Oe,fg as Be,bM as Ee,dc as He,a3 as ze,a6 as Ge,aV as Qe,eU as Ue,H as Z}from"./vendor-BolvhNQv.js";import{u as ue,P as Re,_ as oe,L as Te,aD as W,T as Le,t as fe,X as pe,H as qe,ac as Ke,G as We,s as Ye}from"../index-BOg8gPmV.js";import{N as je}from"./neonatal_service-Csw8PsyE.js";import{D as Je}from"./DemographicBar-k5auJVs7.js";import{n as x,N as Xe}from"./NeonatalStepper-DmRecIj2.js";import{n as L}from"./enrollment-DU-PLRUa.js";import{I as le}from"./images-DJIykHYW.js";import{u as Pe}from"./useNeonatalEnrollmentStore-DndLv6lC.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-Go-aTq24.js";import"./SaveProgressModal-T3jxWlEp.js";const Ze={key:0,class:"twin-search-container"},et={style:{border:"1px dotted #ececec","border-radius":"8px"}},tt={class:"header-with-icon"},at={class:"icon-wrapper"},rt=["src"],ot={class:"search-with-button"},nt={class:"search-wrapper"},st={key:0,class:"search-results"},lt={key:0,class:"search-loading"},it={key:1,class:"results-list"},ut=["onClick"],ct={class:"result-header"},dt={class:"twin-name"},mt={class:"twin-mrn"},ft={class:"twin-dob"},pt={class:"result-details"},vt={key:0,class:"twin-gender"},ht={key:2,class:"no-results"},_t={key:1,class:"selected-twin"},gt={class:"selected-card"},yt={class:"selected-card-header"},Dt={class:"header-content"},bt={class:"selected-icon-wrapper"},Ft=["src"],wt={class:"selected-card-content"},Nt={class:"patient-info-grid"},St={class:"info-row"},It={class:"info-value"},kt={class:"info-row"},$t={class:"info-value"},Vt={key:0,class:"info-row"},Rt={class:"info-value"},Tt={key:1,class:"info-row"},Pt={class:"info-value"},Ct=U({__name:"TwinSearch",setup(f,{expose:w}){const t=Q(L),m=ue(),a=S(""),_=S(!1),e=S([]),s=S(null),o=S(!1),l=ee(()=>(t==null?void 0:t.hasTwin)==="Yes"),I=async()=>{if(!a.value||a.value.trim().length<2){e.value=[];return}_.value=!0;try{const v=a.value.trim();if(/^\d+$/.test(v))try{const c=await m.getPatientData(Number(v));if(c&&c.personInformation){const g=c.personInformation;e.value=[{patientID:g.person_id,firstName:g.given_name||"",middleName:g.middle_name||"",lastName:g.family_name||"",gender:g.gender,birthdate:g.birthdate}]}else e.value=[]}catch(c){console.error("Error searching by MRN:",c),e.value=[]}else{const c=v.split(" "),g={given_name:c[0],family_name:c[1]||"",page:"1",per_page:"20"},M=await Re.search(g);e.value=Array.isArray(M)?M.filter(P=>{const $=P.person;if(!$.birthdate)return!1;const G=new Date($.birthdate);return Math.floor((Date.now()-G.getTime())/(1e3*60*60*24))<=7}).map(P=>{var i;const $=P.person,G=((i=$.names)==null?void 0:i[0])||{};return{patientID:$.person_id,firstName:G.given_name||"",middleName:G.middle_name||"",lastName:G.family_name||"",gender:$.gender,birthdate:$.birthdate}}):[]}}catch(v){console.error("Error searching for twin:",v),e.value=[]}finally{_.value=!1}},q=v=>{s.value=v,a.value="",o.value=!1,t&&(t.twinPatientId=v.patientID,t.twinName="".concat(v.firstName," ").concat(v.middleName||""," ").concat(v.lastName).trim())},b=()=>{s.value=null,o.value=!1,t&&(t.twinPatientId=void 0,t.twinName=void 0)},r=()=>{o.value=!0,s.value=null,a.value="",t&&(t.twinPatientId=void 0,t.twinName=void 0)};V(()=>t==null?void 0:t.hasTwin,v=>{v!=="Yes"&&(b(),o.value=!1)});const y=v=>"".concat(v.firstName," ").concat(v.middleName||""," ").concat(v.lastName).trim(),T=v=>v?new Date(v).toLocaleDateString():"";return w({validateForm:()=>(t==null?void 0:t.hasTwin)==="Yes"&&!s.value&&!o.value?{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"}:null,getFormValues:()=>s.value?{twinPatientId:s.value.patientID,twinName:y(s.value)}:{}}),(v,c)=>l.value?(h(),D("div",Ze,[n("div",et,[p(u(Fe),null,{default:k(()=>[n("div",tt,[n("div",at,[n("img",{src:u(le).icons.twins,alt:"Twin",class:"header-icon"},null,8,rt),p(u(B),{icon:u(te),class:"search-badge-icon"},null,8,["icon"])]),n("div",null,[p(u(we),null,{default:k(()=>[...c[1]||(c[1]=[A("Twin Information",-1)])]),_:1}),p(u(Ne),null,{default:k(()=>[...c[2]||(c[2]=[A("Search for twin sibling",-1)])]),_:1})])])]),_:1}),p(u(Se),null,{default:k(()=>[p(u(Ie),{class:"info-note"},{default:k(()=>[...c[3]||(c[3]=[A(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),n("div",ot,[n("div",nt,[p(u(ke),{modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=g=>a.value=g),placeholder:"Search for twin's MRN or scan barcode",onIonInput:I,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),p(u(K),{color:"primary",onClick:r,class:"skip-btn"},{default:k(()=>[c[4]||(c[4]=A(" Skip ",-1)),p(u(B),{size:"small",icon:u(xe),slot:"end"},null,8,["icon"])]),_:1})]),a.value&&a.value.length>0&&!s.value?(h(),D("div",st,[_.value?(h(),D("div",lt,[(h(),D(ae,null,re(3,g=>n("div",{key:"skeleton-".concat(g),class:"result-item-skeleton"},[...c[5]||(c[5]=[n("div",{class:"skeleton-header"},[n("div",{class:"skeleton-name"}),n("div",{class:"skeleton-dob"})],-1)])])),64))])):e.value.length>0?(h(),D("div",it,[(h(!0),D(ae,null,re(e.value,(g,M)=>(h(),D("div",{key:g.patientID||M,class:"result-item",onClick:P=>q(g)},[n("div",ct,[n("span",dt,F(y(g)),1),n("span",mt,"MRN: "+F(g.patientID),1),n("span",ft,"DOB: "+F(T(g.birthdate)),1)]),n("div",pt,[g.gender?(h(),D("p",vt,[c[6]||(c[6]=n("strong",null,"Gender:",-1)),A(" "+F(g.gender),1)])):O("",!0)])],8,ut))),128))])):(h(),D("div",ht,[p(u(B),{icon:u(te),class:"no-results-icon"},null,8,["icon"]),n("p",null,'No patients found matching "'+F(a.value)+'"',1),c[7]||(c[7]=n("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):O("",!0),s.value?(h(),D("div",_t,[n("div",gt,[n("div",yt,[n("div",Dt,[n("div",bt,[n("img",{src:u(le).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,Ft)]),c[8]||(c[8]=n("div",{class:"header-separator"},null,-1)),c[9]||(c[9]=n("span",{class:"selected-subtitle"},"Twin Selected",-1))]),p(u(K),{fill:"clear",size:"small",onClick:b,class:"clear-selection-btn"},{default:k(()=>[p(u(B),{icon:u($e)},null,8,["icon"])]),_:1})]),n("div",wt,[n("div",Nt,[n("div",St,[c[10]||(c[10]=n("span",{class:"info-label"},"Full Name",-1)),n("span",It,F(y(s.value)),1)]),n("div",kt,[c[11]||(c[11]=n("span",{class:"info-label"},"MRN",-1)),n("span",$t,F(s.value.patientID),1)]),s.value.birthdate?(h(),D("div",Vt,[c[12]||(c[12]=n("span",{class:"info-label"},"Date of Birth",-1)),n("span",Rt,F(T(s.value.birthdate)),1)])):O("",!0),s.value.gender?(h(),D("div",Tt,[c[13]||(c[13]=n("span",{class:"info-label"},"Gender",-1)),n("span",Pt,F(s.value.gender),1)])):O("",!0)])])])])):O("",!0)]),_:1})])])):O("",!0)}}),At=oe(Ct,[["__scopeId","data-v-9ecea754"]]),R=f=>{var w,t,m;if(!(f==null||f==="")){if(typeof f=="string"||typeof f=="number")return f.toString();if(typeof f=="object"){const a=(m=(t=(w=f.label)!=null?w:f.value)!=null?t:f.name)!=null?m:f.title;if(a!=null&&a!=="")return a.toString()}}},Ce=f=>{if(!f)return[];if(Array.isArray(f))return f.map(t=>R(t)).filter(t=>!!t);const w=R(f);return w?[w]:[]},Y=f=>f==null?"":f.toString(),xt={class:"birth-details-wrapper"},Mt=U({__name:"BirthDetails",setup(f,{expose:w}){const t=S(null),m=S(null),a=S(null),_=x[0].formData,e=_.slice(0,1),s=_.slice(1),o=Q(L),l=S([]);ie(async()=>{try{const r=await Te.getAllFacilities();Array.isArray(r)?l.value=r:r!=null&&r.facilities&&Array.isArray(r.facilities)?l.value=r.facilities:r!=null&&r.records&&Array.isArray(r.records)?l.value=r.records:l.value=[]}catch(r){console.error("Error loading facilities:",r),l.value=[]}});const I=ee(()=>s.map(r=>r.name==="birthFacility"?{...r,options:l.value.map(y=>{const T=y.name||y.facility_name||"Unknown";return{name:T,label:T,value:y.id||y.facility_id||T,code:y.code||y.facility_code,district:y.district||y.district_name}})}:r)),q=r=>{o&&(o.hasTwin=r.hasTwin||"")},b=r=>{o&&(o.placeOfBirth=R(r.placeOfBirth)||"",o.nameOfBirthFacility=R(r.birthFacility)||"",o.typeOfBirth=R(r.typeOfBirth)||"",o.birthWeight=Y(r.birthWeight||""),o.timeOfBirth=Y(r.birthTime||""))};return V(()=>{var r;return(r=m.value)==null?void 0:r.formValues},r=>{r&&b(r)},{deep:!0}),V(()=>m.value,r=>{r!=null&&r.getFormValues&&b(r.getFormValues())},{immediate:!0}),V(()=>{var r;return(r=t.value)==null?void 0:r.formValues},r=>{r&&q(r)},{deep:!0}),V(()=>t.value,r=>{r!=null&&r.getFormValues&&q(r.getFormValues())},{immediate:!0}),w({getFormRef:()=>m.value,getTwinQuestionFormRef:()=>t.value,validateForm:()=>{var c,g,M,P,$,G;const r=((g=(c=t.value)==null?void 0:c.validateForm)==null?void 0:g.call(c))||null,y=((P=(M=m.value)==null?void 0:M.validateForm)==null?void 0:P.call(M))||null,T=((G=($=a.value)==null?void 0:$.validateForm)==null?void 0:G.call($))||null,v=[r,y,T].filter(Boolean);return v.length?v.reduce((i,d)=>({...i,...d}),{}):null},getFormValues:()=>{var v,c,g,M,P,$;const r=((c=(v=t.value)==null?void 0:v.getFormValues)==null?void 0:c.call(v))||{},y=((M=(g=m.value)==null?void 0:g.getFormValues)==null?void 0:M.call(g))||{},T=(($=(P=a.value)==null?void 0:P.getFormValues)==null?void 0:$.call(P))||{};return{...r,...y,...T}}}),(r,y)=>(h(),D("div",xt,[p(W,{formData:u(e),ref_key:"twinQuestionFormRef",ref:t,class:"twin-question-form"},null,8,["formData"]),p(At,{ref_key:"twinSearchRef",ref:a},null,512),p(W,{formData:I.value,ref_key:"formRef",ref:m,class:"main-form"},null,8,["formData"])]))}}),ve=oe(Mt,[["__scopeId","data-v-9a714757"]]),he=U({__name:"ReferralInformation",setup(f,{expose:w}){const t=S(null),m=x[1].formData,a=Q(L),_=S([]);ie(async()=>{try{const o=await Te.getAllFacilities();Array.isArray(o)?_.value=o:o!=null&&o.facilities&&Array.isArray(o.facilities)?_.value=o.facilities:o!=null&&o.records&&Array.isArray(o.records)?_.value=o.records:_.value=[]}catch(o){console.error("Error loading facilities:",o),_.value=[]}});const e=ee(()=>m.map(o=>o.name==="referringFacilityName"?{...o,options:_.value.map(l=>{const I=l.name||l.facility_name||"Unknown";return{name:I,label:I,value:l.id||l.facility_id||I,code:l.code||l.facility_code,district:l.district||l.district_name}})}:o)),s=o=>{if(!a)return;a.referredFromOtherFacility=o.referredFromAnotherFacility||"",a.referredFrom=R(o.referredFrom)||"";const l=o.referringFacilityName;a.referringFacilityName=(l==null?void 0:l.name)||Y(l||""),a.modeOfTransport=R(o.modeOfTransport)||"",a.admittedFrom=R(o.admittedFrom)||""};return V(()=>{var o;return(o=t.value)==null?void 0:o.formValues},o=>{o&&s(o)},{deep:!0}),V(()=>t.value,o=>{o!=null&&o.getFormValues&&s(o.getFormValues())},{immediate:!0}),w({getFormRef:()=>t.value,validateForm:()=>{var o,l;return((l=(o=t.value)==null?void 0:o.validateForm)==null?void 0:l.call(o))||null},getFormValues:()=>{var o,l;return((l=(o=t.value)==null?void 0:o.getFormValues)==null?void 0:l.call(o))||{}}}),(o,l)=>(h(),j(W,{formData:e.value,ref_key:"formRef",ref:t},null,8,["formData"]))}}),_e=U({__name:"BirthAssessment",setup(f,{expose:w}){const t=S(null),m=x[2].formData,a=Q(L),_=e=>{a&&(a.criedAfterBirth=e.criedAfterBirth||"",a.apgarScoreAt1=R(e.apgar1)||"",a.apgarScoreAt5=R(e.apgar5)||"",a.apgarScoreAt10=R(e.apgar10)||"",a.resuscitationMethods=Ce(e.resuscitationMethods))};return V(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>t.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),w({getFormRef:()=>t.value,validateForm:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.validateForm)==null?void 0:s.call(e))||null},getFormValues:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:s.call(e))||{}}}),(e,s)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Ot={class:"mother-search-container"},Bt={style:{border:"1px dotted #ececec","border-radius":"8px"}},Et={class:"header-with-icon"},Ht={class:"icon-wrapper"},zt=["src"],Gt={class:"search-with-button"},Qt={class:"search-wrapper"},Ut={class:"barcode-btn","aria-label":"Scan MRN"},Lt={key:0,class:"search-results"},qt={key:0,class:"search-loading"},Kt={key:1,class:"results-list"},Wt=["onClick"],Yt={class:"result-header"},jt={class:"mother-name"},Jt={class:"mother-dob"},Xt={class:"mother-gender"},Zt={class:"result-details"},ea={key:0,class:"mother-address"},ta={key:1,class:"mother-phone"},aa={key:0,class:"pagination"},ra={class:"page-info"},oa={key:2,class:"no-results"},na={key:1,class:"selected-mother"},sa={class:"selected-card"},la={class:"selected-card-header"},ia={class:"selected-header-with-button"},ua={class:"selected-card-content"},ca={class:"selected-info"},da={key:0},ma={key:1},se=10,fa=U({__name:"MotherSearch",setup(f,{expose:w}){const t=Ve(),m=Q(L),a=Pe(),_=ue(),e=S(""),s=S(!1),o=S([]),l=S(null),I=S(1);ie(async()=>{const i=a.getMotherPatientId;i&&a.shouldReturnToEnrollment&&(await q(i),a.clearEnrollmentContext())}),V(l,i=>{i&&m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")});const q=async i=>{var d,N;try{s.value=!0;const E=await _.getPatientData(i);if(E&&E.personInformation){const C=E.personInformation,H=((d=C.addresses)==null?void 0:d[0])||{},z=(N=C.person_attributes)==null?void 0:N.find(J=>{var X;return((X=J.person_attribute_type)==null?void 0:X.name)==="Cell Phone Number"}),ne={patientID:C.person_id||i,firstName:C.given_name||"",middleName:C.middle_name||"",lastName:C.family_name||"",gender:C.gender,birthdate:C.birthdate,nationalId:E.national_id||"",address:H,phone:(z==null?void 0:z.value)||""};l.value=ne}}catch(E){console.error("Error fetching mother data:",E)}finally{s.value=!1}},b=ee(()=>Math.ceil(o.value.length/se)),r=ee(()=>{const i=(I.value-1)*se,d=i+se;return o.value.slice(i,d)}),y=async()=>{if(!e.value||e.value.trim().length<2){o.value=[];return}s.value=!0,I.value=1;try{const d=e.value.trim().split(" "),N={given_name:d[0],family_name:d[1]||"",page:"1",per_page:"50"},E=await Re.search(N);o.value=Array.isArray(E)?E.filter(C=>{var z;const H=((z=C.person)==null?void 0:z.gender)||C.gender;return H==="F"||H==="Female"}).map(C=>{var X,ce,de;const H=C.person,z=((X=H.names)==null?void 0:X[0])||{},ne=((ce=H.addresses)==null?void 0:ce[0])||{},J=(de=H.person_attributes)==null?void 0:de.find(Ae=>{var me;return((me=Ae.person_attribute_type)==null?void 0:me.name)==="Cell Phone Number"});return{patientID:H.person_id,firstName:z.given_name||"",middleName:z.middle_name||"",lastName:z.family_name||"",gender:H.gender,birthdate:H.birthdate,nationalId:C.national_id||"",address:ne,phone:(J==null?void 0:J.value)||""}}):[]}catch(i){console.error("Error searching for mothers:",i),o.value=[]}finally{s.value=!1}},T=i=>{l.value=i,e.value="",m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")},v=()=>{l.value=null,m&&(m.motherPatientId=void 0,m.motherName=void 0,m.motherNationalId=void 0)},c=()=>{var d;const i=Q("patient");i&&((d=i.value)!=null&&d.patientID)&&a.setMotherCreationContext(i.value.patientID,4),t.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},g=()=>{I.value<b.value&&I.value++},M=()=>{I.value>1&&I.value--},P=i=>i?new Date(i).toLocaleDateString():"",$=i=>{if(!i)return"";if(typeof i=="string")return i;const d=[];return i.city_village&&d.push(i.city_village),i.township_division&&d.push(i.township_division),i.state_province&&d.push(i.state_province),d.join(", ")};return w({getFormRef:()=>({validate:()=>l.value!==null,getFormData:()=>{var i,d;return{motherPatientId:(i=l.value)==null?void 0:i.patientID,motherName:l.value?"".concat(l.value.firstName," ").concat(l.value.middleName||""," ").concat(l.value.lastName).trim():void 0,motherNationalId:(d=l.value)==null?void 0:d.nationalId}}}),validateForm:()=>l.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>l.value?{motherPatientId:l.value.patientID,motherName:"".concat(l.value.firstName," ").concat(l.value.middleName||""," ").concat(l.value.lastName).trim(),motherNationalId:l.value.nationalId}:{}}),(i,d)=>(h(),D("div",Ot,[n("div",Bt,[p(u(Fe),null,{default:k(()=>[n("div",Et,[n("div",Ht,[n("img",{src:u(le).icons.care,alt:"Care",class:"header-icon"},null,8,zt),p(u(B),{icon:u(te),class:"search-badge-icon"},null,8,["icon"])]),n("div",null,[p(u(we),null,{default:k(()=>[...d[1]||(d[1]=[A("Search for Mother",-1)])]),_:1}),p(u(Ne),null,{default:k(()=>[...d[2]||(d[2]=[A("Find mother's existing record",-1)])]),_:1})])])]),_:1}),p(u(Se),null,{default:k(()=>[p(u(Ie),{class:"info-note"},{default:k(()=>[...d[3]||(d[3]=[A(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),n("div",Gt,[n("div",Qt,[p(u(ke),{modelValue:e.value,"onUpdate:modelValue":d[0]||(d[0]=N=>e.value=N),placeholder:"Search for mother's Name or scan MRN",onIonInput:y,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),n("div",Ut,[p(u(B),{color:"primary",size:"small",icon:u(Me),slot:"icon-only"},null,8,["icon"])])]),p(u(K),{color:"success",onClick:c,class:"new-registration-btn"},{default:k(()=>[p(u(B),{icon:u(Oe),slot:"icon-only"},null,8,["icon"]),d[4]||(d[4]=A("New Registration ",-1))]),_:1})]),e.value&&e.value.length>0&&!l.value?(h(),D("div",Lt,[s.value?(h(),D("div",qt,[(h(),D(ae,null,re(3,N=>n("div",{key:"skeleton-".concat(N),class:"result-item-skeleton"},[...d[5]||(d[5]=[n("div",{class:"skeleton-header"},[n("div",{class:"skeleton-name"}),n("div",{class:"skeleton-dob"}),n("div",{class:"skeleton-gender"})],-1),n("div",{class:"skeleton-details"},[n("div",{class:"skeleton-address"}),n("div",{class:"skeleton-phone"})],-1)])])),64))])):o.value.length>0?(h(),D("div",Kt,[(h(!0),D(ae,null,re(r.value,(N,E)=>(h(),D("div",{key:N.patientID||E,class:"result-item",onClick:C=>T(N)},[n("div",Yt,[n("span",jt,F(N.firstName)+" "+F(N.middleName?N.middleName+" ":"")+F(N.lastName),1),n("span",Jt,"DOB "+F(P(N.birthdate)),1),n("span",Xt,F(N.gender==="F"?"Female":N.gender),1)]),n("div",Zt,[N.address?(h(),D("p",ea,[d[6]||(d[6]=n("strong",null,"Current Address:",-1)),A(" "+F($(N.address)),1)])):O("",!0),N.phone?(h(),D("p",ta,[p(u(B),{icon:u(Be)},null,8,["icon"]),A(" "+F(N.phone),1)])):O("",!0)])],8,Wt))),128)),b.value>1?(h(),D("div",aa,[p(u(K),{fill:"outline",size:"small",onClick:M,disabled:I.value===1},{default:k(()=>[p(u(B),{icon:u(Ee)},null,8,["icon"])]),_:1},8,["disabled"]),n("span",ra,"Page "+F(I.value)+" of "+F(b.value),1),p(u(K),{fill:"outline",size:"small",onClick:g,disabled:I.value===b.value},{default:k(()=>[p(u(B),{icon:u(He)},null,8,["icon"])]),_:1},8,["disabled"])])):O("",!0)])):(h(),D("div",oa,[p(u(B),{icon:u(te),class:"no-results-icon"},null,8,["icon"]),n("p",null,'No mothers found matching "'+F(e.value)+'"',1),p(u(K),{expand:"block",onClick:c},{default:k(()=>[...d[7]||(d[7]=[A("Register new mother",-1)])]),_:1})]))])):O("",!0),l.value?(h(),D("div",na,[n("div",sa,[n("div",la,[n("div",ia,[d[8]||(d[8]=n("span",{class:"selected-subtitle"},"Selected Mother",-1)),p(u(K),{fill:"clear",size:"small",color:"danger",onClick:v,class:"clear-selection-btn"},{default:k(()=>[p(u(B),{icon:u($e),slot:"icon-only"},null,8,["icon"])]),_:1})])]),n("div",ua,[n("div",ca,[n("h3",null,F(l.value.firstName)+" "+F(l.value.middleName?l.value.middleName+" ":"")+F(l.value.lastName),1),n("p",null,[d[9]||(d[9]=n("strong",null,"MRN:",-1)),A(" "+F(l.value.patientID),1)]),l.value.birthdate?(h(),D("p",da,[d[10]||(d[10]=n("strong",null,"DOB:",-1)),A(" "+F(P(l.value.birthdate)),1)])):O("",!0),l.value.address?(h(),D("p",ma,[d[11]||(d[11]=n("strong",null,"Address:",-1)),A(" "+F($(l.value.address)),1)])):O("",!0)])])])])):O("",!0)]),_:1})])]))}}),ge=oe(fa,[["__scopeId","data-v-d069ff5e"]]),ye=U({__name:"Pregnancy",setup(f,{expose:w}){const t=S(null),m=x[4].formData,a=Q(L),_=e=>{a&&(a.gestationWeeks=Y(e.gestationWeeks||""),a.steroidsGiven=e.steroidsGiven||"",a.gestationMethodAssessment=R(e.gestationMethodAssessment)||"",a.ultraSoundScanning=e.ultraSoundScanning||"",a.onsetOfLabor=Y(e.onsetOfLabor||""),a.ruptureOfMembranes=e.ruptureOfMembranes||"",a.durationOfRuptureMembranes=R(e.durationOfRuptureMembranes)||"",a.offensiveLiquor=e.offensiveLiquor||"",a.modeOfDelivery=R(e.modeOfDelivery)||"",a.meconiumPresent=e.meconiumPresent||"",a.maternalAnalgesia=e.maternalAnalgesia||"",a.analgesiasDrug=R(e.analgesiasDrug)||"",a.anesthesiaUsed=e.anesthesiaUsed||"",a.teo=e.teo||"",a.chlorohexidineCordCare=e.chlorohexidineCordCare||"",a.vitaminKGiven=e.vitaminKGiven||"",a.dextroseGiven=e.dextroseGiven||"")};return V(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>t.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),w({getFormRef:()=>t.value,validateForm:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.validateForm)==null?void 0:s.call(e))||null},getFormValues:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:s.call(e))||{}}}),(e,s)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:t},null,8,["formData"]))}}),De=U({__name:"MotherEnrollmentDetails",setup(f,{expose:w}){const t=S(null),m=x[5].formData,a=Q(L),_=e=>{a&&(a.motherStatus=e.motherStatus||"",a.motherHivStatus=R(e.motherHivStatus)||"",a.lastHivTestDate=Y(e.lastHivTestDate||""),a.doHivRetest=e.doHivRetest||"",a.babyGivenNvp=e.babyGivenNvp||"",a.motherVdrlResult=R(e.motherVdrlResult)||"",a.motherTreatedForVdrl=e.motherTreatedForVdrl||"",a.babyTestedForHepatitis=e.babyTestedForHepatitis||"",a.allThreeDosesCompleted=e.allThreeDosesCompleted||"",a.motherHepatitisResult=R(e.motherHepatitisResult)||"")};return V(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>t.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),w({getFormRef:()=>t.value,validateForm:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.validateForm)==null?void 0:s.call(e))||null},getFormValues:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:s.call(e))||{}}}),(e,s)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:t},null,8,["formData"]))}}),be=U({__name:"KnownMedicalConditions",setup(f,{expose:w}){const t=S(null),m=x[6].formData,a=Q(L),_=e=>{a&&(a.tetanusDiphtheria=Ce(e.tetanusDiphtheria))};return V(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>t.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),w({getFormRef:()=>t.value,validateForm:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.validateForm)==null?void 0:s.call(e))||null},getFormValues:()=>{var e,s;return((s=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:s.call(e))||{}}}),(e,s)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:t},null,8,["formData"]))}}),pa=U({name:"NeonatalEnrollment",components:{IonPage:Ge,IonContent:ze,Toolbar:Le,DemographicBar:Je,NeonatalStepper:Xe,BirthDetails:ve,ReferralInformation:he,BirthAssessment:_e,MotherSearch:ge,Pregnancy:ye,MotherEnrollmentDetails:De,KnownMedicalConditions:be},setup(){const f=Ve(),w=ue(),{patient:t}=Qe(w),m=S(!1),a=Pe(),_=b=>{const r=Number(b);return Number.isFinite(r)?r:null},e=()=>{var r;const b=_((r=t.value)==null?void 0:r.patientID);a.initializeEnrollmentForm(b)};e(),V(()=>{var b;return(b=t.value)==null?void 0:b.patientID},()=>e());const s=a.enrollmentForm;Ue(L,s),V(()=>a.enrollmentForm,()=>a.saveEnrollmentSnapshot(),{deep:!0});const o=S(x.map((b,r)=>({title:b.title,number:r+1,checked:!1,class:r===0?"open_step common_step":"common_step",last_step:r===x.length-1?"last_step":""}))),l=[{title:x[0].title,value:"1",component:ve},{title:x[1].title,value:"2",component:he},{title:x[2].title,value:"3",component:_e},{title:x[3].title,value:"4",component:ge},{title:x[4].title,value:"5",component:ye},{title:x[5].title,value:"6",component:De},{title:x[6].title,value:"7",component:be}];return{router:f,patient:t,enrollmentFormData:s,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:o,stepperData:l,updateStatus:b=>{b&&b.value&&o.value.forEach((r,y)=>{b.value===(y+1).toString()?(r.class="open_step common_step",r.checked=!1):y<parseInt(b.value)-1?(r.class="common_step color_white",r.checked=!0):(r.class="common_step",r.checked=!1)})},getSaveFunction:b=>b===l.length-1?async()=>{var r;if(!((r=t.value)!=null&&r.patientID)){fe("No patient selected");return}if(!m.value)try{if(m.value=!0,!s.birthWeight||!s.timeOfBirth){fe("Please complete required birth details"),m.value=!1;return}if(s.motherPatientId)try{const T=(await pe.getRelations()).find(v=>v.b_is_to_a==="Mother"||v.b_is_to_a==="Parent");T&&await pe.createRelation(t.value.patientID,s.motherPatientId,T.relationship_type_id)}catch(y){console.error("Failed to create mother-baby relationship",y)}await je.enrollNeonate(t.value.patientID,s,qe.sessionDate()),await Ke.userProgramData(t.value.patientID),We("Neonate enrolled successfully"),f.push("/neonatal/triage"),a.clearEnrollmentForm(t.value.patientID)}catch(y){console.error("Neonatal enrollment failed",y),Ye("Failed to enroll neonate. Please try again."),m.value=!1}}:null,isEnrolling:m}}});function va(f,w,t,m,a,_){const e=Z("Toolbar"),s=Z("DemographicBar"),o=Z("NeonatalStepper"),l=Z("ion-content"),I=Z("ion-page");return h(),j(I,{class:"neonatal-enrollment-page"},{default:k(()=>[p(e),p(l,{fullscreen:!0},{default:k(()=>[p(s),p(o,{wizardData:f.wizardData,StepperData:f.stepperData,stepperTitle:f.stepperTitle,openStepper:f.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:f.getSaveFunction,flowType:"enrollment",onUpdateStatus:f.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const ka=oe(pa,[["render",va],["__scopeId","data-v-069acd4b"]]);export{ka as default};
