import{d as Q,L as ze,Z as ka,bx as Aa,M as qe,W as g,_ as Ea,aj as Da,aU as Ha,aQ as Ta,cy as Na,aR as Ma,bq as Oa,a5 as w,a4 as C,bm as $a,a6 as Be,a3 as Ie,r as o,bA as Ra,a as Ue,w as pe,c as je,c2 as za,dY as qa,c7 as Ge,H as V,e as oe,f as v,l as a,J as t,O as U,k as r,K as x,F as fe,P as Ba,Q as _,u as s,aF as ja,m as R,aK as We,bl as de,d_ as He,bi as Ga,I as Wa,G as Te,E as we,c9 as Ke,a_ as Ne,N as Me,a2 as Ka,bn as Qa,R as Ja,bj as Ya,bM as Za}from"./vendor-ChpUWbYC.js";import{an as Qe,U as se,_ as ne,a0 as Xa,a8 as et,ao as Ve,L as le,B as Y,ap as at,aq as tt,ar as Oe,a2 as lt,as as $e,at as Re,s as st,au as ot,G as nt,T as rt,av as it}from"../index-rYNkOVTy.js";import{B as ut}from"./bottomNavBar-mp6MG93q.js";import{l as ce}from"./lodash-NJiRuGo9.js";import{N as dt}from"./NavigationMenu-v3Ck8eoL.js";import{E as ct}from"./EIRreportsStore-IODKEcL5.js";import{T as pt}from"./TableSkeletonLoader-DAYZ6Wc5.js";import"./apexcharts-Cj7xBElI.js";const ft=Q({name:"UserCardList",components:{IonContent:Ie,IonPage:Be,IonGrid:$a,IonRow:C,IonCol:w,IonCard:Oa,IonCardHeader:Ma,IonCardSubtitle:Na,IonCardTitle:Ta,IonCardContent:Ha,IonList:Da,IonItem:Ea,IonLabel:g,bottomNavBar:ut,IonFooter:qe,IonSpinner:Aa,IonText:ka,IonIcon:ze,editUserModal:Qe},props:{users:{type:Array,required:!0},filterValue:{type:String,required:!0},search:{type:String,required:!0}},setup(u,{emit:h}){const A=o(!1),L=Ra({page:1,itemsPerPage:10}),H=o(!0),E=o(""),d=o(""),m=o([]),y=o(0);Ue(()=>{I()}),pe(()=>u.search,(i,p)=>{i!==p&&(L.page=1,I())}),pe(()=>u.filterValue,()=>{});const I=async()=>{try{H.value=!0,E.value="";const i=await se.getAllUsers(L.page,L.itemsPerPage,u.search);y.value=i.count||0,m.value=i.results.map(p=>({userId:p.user_id,username:p.username,roles:M(p.roles),programs:q(p.programs),gender:p.person.gender,status:p.deactivated_on,firstName:Z(p.person.names),lastName:j(p.person.names)}))}catch(i){E.value="Failed to fetch users. Please try again later.",console.error("Error fetching users:",i),m.value=[],y.value=0}finally{H.value=!1}},T=({page:i,itemsPerPage:p})=>{L.page=i,L.itemsPerPage=p,I()},P=je(()=>{if(!u.filterValue)return m.value;const i=u.filterValue.toLowerCase();return m.value.filter(p=>p.username.toLowerCase().includes(i)||p.firstName.toLowerCase().includes(i)||p.lastName.toLowerCase().includes(i)||p.userId.toLowerCase().includes(i)||p.roles.some(G=>G.toLowerCase().includes(i))||p.programs.some(G=>G.toLowerCase().includes(i)))}),c=i=>{A.value=!0,d.value=i},N=()=>{A.value=!1,h("reload",A.value),I()},S=()=>{A.value=!1},M=i=>!i||!Array.isArray(i)?[]:i.map(p=>p.role||""),Z=i=>!i||!Array.isArray(i)||i.length===0?"":i[i.length-1].given_name||"",j=i=>!i||!Array.isArray(i)||i.length===0?"":i[i.length-1].family_name||"",q=i=>!i||!Array.isArray(i)?[]:i.map(p=>p.name||"");return{filteredUsers:P,pagination:L,handlePaginationUpdate:T,isLoading:H,error:E,personCircleOutline:Ge,createOutline:qa,appsOutline:za,openUserProfile:c,user_id:d,isPopoverOpen:A,modalClosed:N,softModalClosed:S,_items_:m,totalCount:y}}}),_t={class:"container"},mt={class:"user-lbl"},vt={class:"user-lbl"},gt={class:"user-lbl"},ht={class:"user-lbl"};function yt(u,h,A,L,H,E){const d=V("ion-text"),m=V("ion-col"),y=V("ion-row"),I=V("ion-spinner"),T=V("ion-icon"),P=V("ion-card-subtitle"),c=V("ion-card-title"),N=V("ion-card-header"),S=V("ion-label"),M=V("ion-item"),Z=V("ion-list"),j=V("ion-card-content"),q=V("ion-card"),i=V("ion-grid"),p=V("editUserModal"),G=V("bottomNavBar"),X=V("ion-footer");return v(),oe("div",_t,[a(i,{class:"dynamic-grid"},{default:t(()=>[u.error?(v(),U(y,{key:0},{default:t(()=>[a(m,{size:"12",class:"ion-text-center"},{default:t(()=>[a(d,{color:"danger"},{default:t(()=>[r("p",null,x(u.error),1)]),_:1})]),_:1})]),_:1})):u.isLoading?(v(),U(y,{key:1},{default:t(()=>[a(m,{size:"12",class:"ion-text-center"},{default:t(()=>[a(I,{name:"circular"}),h[0]||(h[0]=r("p",null,"Loading users...",-1))]),_:1})]),_:1})):u._items_.length===0?(v(),U(y,{key:2},{default:t(()=>[a(m,{size:"12",class:"ion-text-center"},{default:t(()=>[...h[1]||(h[1]=[r("p",null,"No users found.",-1)])]),_:1})]),_:1})):(v(),U(y,{key:3,class:"user-cards-row"},{default:t(()=>[(v(!0),oe(fe,null,Ba(u._items_,z=>(v(),U(m,{"size-xs":"12","size-sm":"6","size-md":"4","size-lg":"3",key:z.userId},{default:t(()=>[a(q,{class:"user-card"},{default:t(()=>[a(N,null,{default:t(()=>[a(P,null,{default:t(()=>[a(T,{icon:u.personCircleOutline,size:"small",style:{"margin-bottom":"-3px"}},null,8,["icon"]),_(" "+x(z.roles.join(", ")),1)]),_:2},1024),a(c,null,{default:t(()=>[_(x(z.firstName)+" "+x(z.lastName)+" ",1),a(T,{onClick:ee=>u.openUserProfile(z.userId),icon:u.createOutline,class:"edit-icon"},null,8,["onClick","icon"])]),_:2},1024)]),_:2},1024),a(j,null,{default:t(()=>[a(Z,null,{default:t(()=>[a(M,null,{default:t(()=>[a(S,null,{default:t(()=>[h[2]||(h[2]=r("h3",null,"User ID",-1)),r("p",mt,x(z.userId),1)]),_:2},1024)]),_:2},1024),a(M,null,{default:t(()=>[a(S,null,{default:t(()=>[h[3]||(h[3]=r("h3",null,"Username",-1)),r("p",vt,x(z.username),1)]),_:2},1024)]),_:2},1024),a(M,null,{default:t(()=>[a(S,null,{default:t(()=>[h[4]||(h[4]=r("h3",null,"Gender",-1)),r("p",gt,x(z.gender),1)]),_:2},1024)]),_:2},1024),a(M,null,{default:t(()=>[a(S,null,{default:t(()=>[r("h3",null,[a(T,{icon:u.appsOutline,size:"small",style:{"margin-bottom":"-3px"}},null,8,["icon"]),h[5]||(h[5]=_(" Programs ",-1))]),r("p",ht,x(z.programs.join(", ")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),a(p,{is_open:u.isPopoverOpen,user_id:u.user_id,onClosePopover:u.softModalClosed,onSave:u.modalClosed},null,8,["is_open","user_id","onClosePopover","onSave"]),a(X,{class:"sticky-footer"},{default:t(()=>[a(y,null,{default:t(()=>[a(m,null,{default:t(()=>[a(G,{totalItems:u.totalCount,currentPage:u.pagination.page,itemsPerPage:u.pagination.itemsPerPage,"onUpdate:pagination":u.handlePaginationUpdate},null,8,["totalItems","currentPage","itemsPerPage","onUpdate:pagination"])]),_:1})]),_:1})]),_:1})])}const bt=ne(ft,[["render",yt],["__scopeId","data-v-d67285b4"]]),wt=Q({watch:{},name:"xxxComponent"}),Vt=Q({...wt,props:{action:{}},emits:["saveEvent"],setup(u,{emit:h}){const A=o(),L=o(),H=o(),E=o(),d=o([]),m=o([]),y=[],I=[],T=[],P=[],c=[],N=["Password must be at least 8 characters long and include at least one uppercase letter, one number, and one special character (@#$%^&+=*!-), without spaces","Password does not match"],S=o(),M=o([]),Z=o("Select location"),j=o(!1),q=o(!1),i=o("Select village(s)"),p=o(!1),G=o("Select district(s)"),X=o(!1),z=o("Select TA(s)"),ee=o([]),Se=o([]),ae=o([]),re=o([]),_e=o(),xe=o(),me=o(),ie=o(!0),ue=o(!0),ve=Xa(),Pe=je(()=>ve.facilityLocation),ge=o(!0),Je=u;Ue(async()=>{await ua(),await da(),Se.value=await Sa(),ee.value=await xa(),ee.value.length>0&&await ta()}),pe(()=>Je.action,async l=>{await ra()}),pe(()=>ie.value,async l=>{ie.value==!1&&B(d.value)});async function Ye(l){const n={cell_phone_number:$e(b).phone_number,gender:Re($[0].dataValue.value)};return await new ot(n).update(l)}function Ce(l){const e=M.value.find(F=>F.code===l.code),n=e?ee.value.filter(F=>F.name===e.district):[];me.value=n,S.value=l}function Ze(l){T.length=0,l.forEach(e=>{T.push(e.village_id)})}function Xe(l){P.length=0,l.forEach(e=>{P.push(e.traditional_authority_id)}),l.forEach(e=>{Ca(e.district_id)})}function ea(l){c.length=0;const e=[];Se.value.forEach(n=>{l.name.toLowerCase()===n.name.toLowerCase()&&e.push(n)}),e.forEach(n=>{c.push(n.district_id)}),e.forEach(n=>{De(n.district_id)}),aa(l)}async function aa(l){M.value=[];try{const e=await le.getDistrictFacilities(l.name.toLowerCase());if(e)return;M.value.push(...e.facilities)}catch(e){console.error("Error fetching facilities for district ".concat(l.name,":"),e)}S.value=null}async function ta(){try{M.value.push(Pe.value),Ce(Pe.value)}catch(l){console.error(l)}}async function la(){try{const l=await se.getCurrentUser();if(l){const e=l.roles.map(n=>n.role);ve.setUserRoles(e),Le("Superuser,Superuser,")==!0&&(ge.value=!1),Le("Superuser,Superuser,")==!1&&(d.value=sa(d.value))}}catch(l){}}function Le(l){return ve.getUserRoles().some(n=>n.toLowerCase()===l.toLowerCase())}function sa(l){const e=l.findIndex(n=>typeof n.name=="string"&&n.name.toLowerCase()==="Superuser,Superuser,".toLowerCase());return e!==-1&&l.splice(e,1),l}async function oa(l){l.is_valid==!1&&(O[0].show_error.value=!0,E.value=l.phone,O[0].dataValue.value=l.phone,O[0].is_phone_valid.value=!1),l.is_valid==!0&&(O[0].show_error.value=!1,E.value=l.phone,O[0].dataValue.value=l.phone,O[0].is_phone_valid.value=!0)}async function na(l){ce.isEmpty(l)==!0,ce.isEmpty(l)==!1}async function ra(){const l=ke(),e=Ae(),n=Ve(b),F=Ee(),W=he(),J=ca(),k=fa(),ye=_a(),K=pa(),La=ma();if(n==!0&&W==!0&&F==!0&&l==!0&&e==!0&&J==!0&&k==!0&&ye==!0&&K==!0&&La==!0){const be=$e(b),Fa={family_name:be.last_name,given_name:be.firstname,username:be.username,must_append_roles:!1,password:D[0].dataValue.value,programs:I,villages:T,roles:y,gender:Re($[0].dataValue.value),location_id:S.value.code,phone:O[0].dataValue.value};try{const{user:te}=await se.createUser(Fa);te&&(await Ye(te.person.person_id),Fe(te.user_id))}catch(te){Fe(""),st(te,2e3)}}}const ia=h;function Fe(l){ia("saveEvent",l)}async function ua(){d.value=await se.getAllRoles();const l=[];d.value.forEach(e=>{l.push({name:e.role,other:e})}),d.value=l,await la()}function ke(){const l=[];if(y.length=0,d.value.forEach(e=>{e.selected==!0&&l.push(e)}),l.forEach(e=>{y.push(e.other.role)}),y.length>0)return f[0].show_error.value=!1,!0;if(y.length==0)return f[0].show_error.value=!0,!1}function Ae(){const l=[];if(I.length=0,m.value.forEach(e=>{e.selected==!0&&l.push(e)}),l.forEach(e=>{I.push(e.other.program_id)}),I.length>0)return f[1].show_error.value=!1,!0;if(I.length==0)return f[1].show_error.value=!0,!1}async function da(){m.value=await et.getAllPrograms();const l=[];m.value.forEach(e=>{l.push({name:e.name,other:e,selected:!1})}),m.value=l}function Ee(){let l=!1;return $[0].dataValue.value==null&&($[0].show_error.value=!0),$[0].dataValue.value!=null&&($[0].show_error.value=!1,l=!0),l}function ca(){if(ce.isEmpty(S.value)==!0)return j.value=!0,!1;if(ce.isEmpty(S.value)==!1)return j.value=!1,!0}function pa(){if(B(d.value)==!1)return!0;if(B(d.value)==!0){if(T.length==0)return q.value=!0,!1;if(T.length>0)return q.value=!1,!0}}function fa(){if(B(d.value)==!1)return!0;if(B(d.value)==!0){if(c.length==0)return p.value=!0,!1;if(c.length>0)return p.value=!1,!0}}function _a(){if(B(d.value)==!1)return!0;if(B(d.value)==!0){if(P.length==0)return X.value=!0,!1;if(P.length>0)return X.value=!1,!0}}function he(){const[l,e]=D.map(k=>k.dataValue.value),n=N[0],F=N[1];return D.forEach(k=>{k.error_message=n,k.show_error.value=!1}),D.map((k,ye)=>{const K=!k.dataValue.value;return k.show_error.value=K,K}).some(k=>k)||D.map((k,ye)=>{const K=lt(k.dataValue.value);return k.show_error.value=!K,K}).some(k=>!k)?!1:l!==e?(D.forEach(k=>{k.error_message=F,k.show_error.value=!0}),!1):!0}const b=[{placeHolder:"username",property_name:"username",dataHandler:ba,dataValue:o(),show_error:o(!1),error_message:"Input required, Only letters allowed"},{placeHolder:"firstname",property_name:"firstname",dataHandler:wa,dataValue:o(),show_error:o(!1),type:"text",error_message:"Input required, Only letters allowed"},{placeHolder:"last name",property_name:"last_name",dataHandler:Va,dataValue:o(),type:"text",show_error:o(!1),error_message:"Input required, Only letters allowed"}];function ma(){if(O[0].is_phone_valid.value==!1)return O[0].show_error.value=!0,!1;if(O[0].is_phone_valid.value==!0)return O[0].show_error.value=!1,!0}const O=[{placeHolder:"phone number",property_name:"phone_number",dataValue:o(),show_error:o(!1),error_message:"Input required, input is invalid",is_phone_valid:o(!1)}],D=[{placeHolder:"new password",dataHandler:Ia,dataValue:o(),show_error:o(!1),error_message:N[0]},{placeHolder:"repeat password",dataHandler:Ua,dataValue:o(),show_error:o(!1),error_message:N[0]}],f=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_3698",name_of_list:"Roles",placeHolder:"Search for a field",items:[],listUpdatedFN:va,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:o(!1),error_message:"please select a Role",disabled:o(!1)},{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Programs",placeHolder:"Search for programs",items:[],listUpdatedFN:ga,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:o(!1),error_message:"please select a Program",disabled:o(!1)}];function va(l){d.value=l,B(d.value),ke()}function B(l){const e=["HSA","Health Surveillance"];q.value=!1;let n=!1;return l.forEach(F=>{(F==null?void 0:F.selected)==!0&&e.includes(F==null?void 0:F.name)&&(ue.value=!1,n=!0)}),n==!1&&(q.value=!1,ue.value=!0),n}function ga(l){m.value=l,m.value.forEach(e=>{e.selected==!0}),Ae()}const $=[{labels:["Male","Female"],selectedOption:o(null),dataHandler:ha,dataValue:o(),show_error:o(!1),error_message:"Please make a selection"}];function ha(l){try{$[0].dataValue.value=l.label}catch(e){$[0].dataValue.value=void 0}Ee()}async function ya(l){try{if(l.length>0){const e=await se.doesUsernameExist(l);e.exists==!0?(b[0].show_error.value=!0,b[0].error_message="Username already exists"):e.exists==!1&&(b[0].show_error.value=!1,b[0].error_message="Input required, Only letters allowed")}}catch(e){console.error(e)}}async function ba(l){const e=l.target.value;b[0].dataValue.value=e,await ya(e)}function wa(l){const e=l.target.value;b[1].dataValue.value=e,Ve([b[1]])}function Va(l){const e=l.target.value;b[2].dataValue.value=e,Ve([b[2]])}function Ia(l){const e=l.target.value;D[0].dataValue.value=e,he()}function Ua(l){const e=l.target.value;D[1].dataValue.value=e,he()}async function Sa(){const l=[];for(let e of[1,2,3]){const n=await le.getDistricts(e);l.push(...n)}return l.forEach(e=>{c.push(e.district_id)}),l.forEach(e=>{De(e.district_id)}),l}async function xa(){return(await le.getFacilityDistricts()).districts}async function De(l,e){re.value=[];var n=await le.getTraditionalAuthorities(l,"");const F=n.map((W,J)=>({...W,assigned_id:J}));re.value=re.value.concat(F)}async function Pa(l,e){ae.value=[];var n=await le.getVillages(l,"");const F=n.map((W,J)=>({...W,assigned_id:J}));ae.value=ae.value.concat(F),ae.value.length>0&&(ie.value=!1)}function Ca(l){ie.value=!0,_e.value=[],Pa(l)}return(l,e)=>(v(),oe(fe,null,[a(s(C),null,{default:t(()=>[a(s(w),{size:"12","size-md":"6"},{default:t(()=>[a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[12]||(e[12]=[_("First name",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Y,{placeholder:b[1].placeHolder,icon:s(ja),inputValue:L.value,"onUpdate:inputValue":b[1].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r("div",null,[b[1].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(b[1].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[13]||(e[13]=[_("Last name",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Y,{placeholder:b[2].placeHolder,icon:s(We),inputValue:H.value,"onUpdate:inputValue":b[2].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r("div",null,[b[2].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(b[2].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[14]||(e[14]=[_("Username",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Y,{placeholder:b[0].placeHolder,icon:s(Ge),inputValue:A.value,"onUpdate:inputValue":b[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r("div",null,[b[0].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(b[0].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[15]||(e[15]=[_("Gender",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(at,{labels:$[0].labels,"selected-opt":$[0].selectedOption.value,onSelectionEvent:$[0].dataHandler},null,8,["labels","selected-opt","onSelectionEvent"]),r("div",null,[$[0].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x($[0].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(tt,{onValidateInput:oa}),r("div",null,[O[0].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(O[0].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1})]),_:1}),a(s(w),{size:"12","size-md":"6"},{default:t(()=>[a(s(C),null,{default:t(()=>[(v(),U(s(w),{key:0},{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[16]||(e[16]=[_("District(s)",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(s(de),{modelValue:me.value,"onUpdate:modelValue":[e[0]||(e[0]=n=>me.value=n),e[1]||(e[1]=n=>ea(n))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select District(s)",placeholder:"Find and select District(s)",selectLabel:"",label:"name",searchable:!0,onSearchChange:e[2]||(e[2]=()=>{}),"track-by":"name",options:ee.value,disabled:ge.value},null,8,["modelValue","options","disabled"]),r("div",null,[p.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(G.value),1)]),_:1})):R("",!0)])]),_:1}))]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[17]||(e[17]=[_("Facility name",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(s(de),{modelValue:S.value,"onUpdate:modelValue":[e[3]||(e[3]=n=>S.value=n),e[4]||(e[4]=n=>Ce(n))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select facility name",placeholder:"Find and select facility name",selectLabel:"",label:"name",searchable:!0,disabled:ge.value,onSearchChange:e[5]||(e[5]=n=>na(n)),"track-by":"code",options:M.value},null,8,["modelValue","disabled","options"]),r("div",null,[j.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(Z.value),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[18]||(e[18]=[_("TA(s)",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(s(de),{modelValue:xe.value,"onUpdate:modelValue":[e[6]||(e[6]=n=>xe.value=n),e[7]||(e[7]=n=>Xe(n))],multiple:!0,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select Traditional Authority (TA)",placeholder:"Find and select Traditional Authority (TA)",selectLabel:"",label:"name",searchable:!0,onSearchChange:e[8]||(e[8]=()=>{}),"track-by":"assigned_id",options:re.value,disabled:ue.value},null,8,["modelValue","options","disabled"]),r("div",null,[X.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(z.value),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[19]||(e[19]=[_("Village(s)",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(s(de),{modelValue:_e.value,"onUpdate:modelValue":[e[9]||(e[9]=n=>_e.value=n),e[10]||(e[10]=n=>Ze(n))],multiple:!0,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select village(s)",placeholder:"Find and select village(s)",selectLabel:"",label:"name",searchable:!0,onSearchChange:e[11]||(e[11]=()=>{}),"track-by":"assigned_id",options:ae.value,disabled:ue.value},null,8,["modelValue","options","disabled"]),r("div",null,[q.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(i.value),1)]),_:1})):R("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),{size:"12","size-md":"6"},{default:t(()=>[a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:t(()=>[...e[20]||(e[20]=[_("Role(s)",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Oe,{multiSelection:f[0].multi_Selection,show_label:f[0].show_list_label,uniqueId:f[0].unqueId,name_of_list:f[0].name_of_list,choose_place_holder:f[0].placeHolder,"items_-list":d.value,use_internal_filter:f[0].use_internal_filter,disabled:f[0].disabled.value,onItemListUpDated:f[0].listUpdatedFN,onItemListFiltered:f[0].listFilteredFN,onItemSearchText:f[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),r("div",null,[f[0].show_error.value?(v(),U(s(g),{key:0,class:"error-label",style:{"margin-top":"-10px"}},{default:t(()=>[_(x(f[0].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:t(()=>[...e[21]||(e[21]=[_("Program(s)",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Oe,{multiSelection:f[1].multi_Selection,show_label:f[1].show_list_label,uniqueId:f[1].unqueId,name_of_list:f[1].name_of_list,choose_place_holder:f[1].placeHolder,"items_-list":m.value,use_internal_filter:f[1].use_internal_filter,disabled:f[1].disabled.value,onItemListUpDated:f[1].listUpdatedFN,onItemListFiltered:f[1].listFilteredFN,onItemSearchText:f[1].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),r("div",null,[f[1].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(f[1].error_message),1)]),_:1})):R("",!0)])]),_:1}),a(s(w))]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[22]||(e[22]=[_("Password",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Y,{placeholder:D[0].placeHolder,icon:s(He),inputValue:D[0].dataValue.value,"onUpdate:inputValue":D[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r("div",null,[D[0].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(D[0].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(s(g),{style:{margin:"10px","margin-left":"0px","margin-top":"0px","margin-bottom":"10px",color:"grey"}},{default:t(()=>[...e[23]||(e[23]=[_("Repeat password",-1),r("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),a(Y,{placeholder:D[1].placeHolder,icon:s(He),inputValue:D[1].dataValue.value,"onUpdate:inputValue":D[1].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),r("div",null,[D[1].show_error.value?(v(),U(s(g),{key:0,class:"error-label"},{default:t(()=>[_(x(D[1].error_message),1)]),_:1})):R("",!0)])]),_:1})]),_:1})]),_:1}),a(s(w),{size:"12","size-md":"6"})]),_:1})],64))}}),It=ne(Vt,[["__scopeId","data-v-e9fe528b"]]),Ut={style:{display:"flex","align-items":"center"}},St={style:{"font-weight":"400","font-size":"19px"}},xt={style:{display:"flex","align-items":"center"}},Pt={class:""},Ct={class:"center text_12"},Lt={style:{"font-weight":"400","font-size":"20px"}},Ft={style:{display:"flex","align-items":"center"}},kt=Q({watch:{},name:"xxxComponent"}),At=Q({...kt,props:{is_open:{},user_id:{}},emits:["closePopover","updated","reload"],setup(u,{emit:h}){const A=o(""),L=o(!1),H=o(),E=h;function d(){A.value=T(100,3)}function m(){Ja.dismiss()}function y(){E("reload","")}function I(P){H.value=P,P&&nt("User created successfully with id: "+H),E("updated",P),m()}function T(P,c){const N=S=>{const M=S==="number"?48:S==="uppercase"?65:97;return String.fromCharCode(Math.floor(Math.random()*(S==="number"?10:26))+M)};return Array.from({length:P},()=>Array.from({length:c},()=>N(["number","uppercase","lowercase"][Math.floor(Math.random()*3)])).join(""))}return(P,c)=>{const N=V("ion-icon"),S=V("ion-row");return v(),oe(fe,null,[a(s(Ga),{"is-open":u.is_open,"show-backdrop":!0,onDidDismiss:c[1]||(c[1]=M=>P.$emit("closePopover",!1)),"keyboard-close":!1},{default:t(()=>[a(s(Wa),null,{default:t(()=>[a(s(Te),null,{default:t(()=>[a(s(we),null,{default:t(()=>[r("div",Ut,[a(N,{icon:s(Ke),class:"sub-menu-icon"},null,8,["icon"]),c[3]||(c[3]=r("b",{style:{"margin-left":"6px"}},"Add User",-1))])]),_:1}),a(s(Ne),{slot:"end"},{default:t(()=>[a(s(we),null,{default:t(()=>[a(s(Me),{onClick:c[0]||(c[0]=M=>P.$emit("closePopover",!1)),fill:"solid"},{default:t(()=>[r("span",St,[r("div",xt,[a(N,{icon:s(Ka),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),c[4]||(c[4]=r("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(s(Ie),{class:"ion-padding"},{default:t(()=>[r("div",Pt,[r("div",Ct,[a(S,null,{default:t(()=>[a(s(w),null,{default:t(()=>[a(It,{user_id:H.value,action:A.value,onSaveEvent:I},null,8,["user_id","action"])]),_:1})]),_:1})])])]),_:1}),a(s(qe),{translucent:!0},{default:t(()=>[a(s(Te),null,{default:t(()=>[a(s(Ne),{slot:"end"},{default:t(()=>[a(s(we),null,{default:t(()=>[a(s(Me),{onClick:d,fill:"solid",color:"success"},{default:t(()=>[r("span",Lt,[r("div",Ft,[a(N,{icon:s(Qa),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),c[5]||(c[5]=r("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]),a(Qe,{is_open:L.value,user_id:H.value,onClosePopover:c[2]||(c[2]=M=>L.value=!1),onUpdated:y},null,8,["is_open","user_id"])],64)}}}),Et=ne(At,[["__scopeId","data-v-515831df"]]),Dt=Q({__name:"usersTemplate",props:{items:{},search_fields:{}},emits:["reload","closeModal"],setup(u,{emit:h}){const A=o(""),L=o(!1),H=o(""),E={name:"add user",show:!0,fn:m,icon:Ke,show_icon:!0},d=[{placeHolder:"Search for username",dataHandler:y,dataValue:o(),show_error:o(!1),error_message:"Please provide a reason"}];function m(){L.value=!0,H.value=""}function y(c){A.value=c.target.value}function I(c){P("reload",c)}function T(c){P("closeModal",c)}const P=h;return(c,N)=>(v(),oe(fe,null,[a(s(C),{class:"search-container"},{default:t(()=>[a(s(C),{class:"search-row"},{default:t(()=>[a(s(w),{class:"input-col"},{default:t(()=>[a(Y,{placeholder:d[0].placeHolder,icon:s(Ya),inputValue:d[0].dataValue.value,"onUpdate:inputValue":d[0].dataHandler,minHeight:50,"-inner-action-btn-propeties":E,"onUpdate:InnerActionBtnPropetiesAction":E.fn},null,8,["placeholder","icon","inputValue","onUpdate:inputValue","onUpdate:InnerActionBtnPropetiesAction"])]),_:1})]),_:1})]),_:1}),a(s(C),null,{default:t(()=>[a(s(w),{size:"12"},{default:t(()=>[a(bt,{users:u.items,filterValue:A.value,onReload:T,search:A.value},null,8,["users","filterValue","search"])]),_:1})]),_:1}),a(Et,{is_open:L.value,user_id:H.value,onClosePopover:N[0]||(N[0]=S=>L.value=!1),onUpdated:I},null,8,["is_open","user_id"])],64))}}),Ht=ne(Dt,[["__scopeId","data-v-3c2cb1d1"]]),Tt=Q({name:"Users",components:{IonContent:Ie,IonPage:Be,IonRow:C,IonCol:w,IonIcon:ze,Toolbar:rt,usersTemplate:Ht,NavigationMenu:dt,TableSkeletonLoader:pt},setup(){const u=o(!1),h=o(!0),A=o([{value:"username",name:"username",selected:!0}]),L=o(""),H=o([]);Ue(async()=>{y(),await E()});async function E(){h.value=!1}function d(I){I==!1&&setTimeout(()=>{E()},500)}function m(I){it.push(I)}function y(){ct().setNavigationPayload("Manage Users",!0,!1,"/","home","")}return{isPopoverOpen:u,user_id:L,_items_:H,search_fields_:A,nav:m,chevronBackOutline:Za,initNavData:y,getUsers:E,isLoading:h,closeModal:d,peopleOutline:We}},watch:{$route:{async handler(u){u.name=="users"&&this.initNavData(),await this.getUsers()},deep:!0}}});function Nt(u,h,A,L,H,E){const d=V("NavigationMenu"),m=V("TableSkeletonLoader"),y=V("usersTemplate"),I=V("ion-content"),T=V("ion-page");return v(),U(T,null,{default:t(()=>[a(d,{"title-icon":u.peopleOutline},null,8,["title-icon"]),a(I,{fullscreen:!0},{default:t(()=>[u.isLoading?(v(),U(m,{key:0})):(v(),U(y,{key:1,items:u._items_,search_fields:u.search_fields_,onReload:u.getUsers,onCloseModal:u.closeModal},null,8,["items","search_fields","onReload","onCloseModal"]))]),_:1})]),_:1})}const Gt=ne(Tt,[["render",Nt],["__scopeId","data-v-76cb90fa"]]);export{Gt as default};
