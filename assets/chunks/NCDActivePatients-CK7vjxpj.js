import{d as O,N as G,P as Q,av as L,ad as S,au as W,b7 as Y,b4 as J,b5 as K,bH as X,ay as Z,az as ee,bq as M,K as te,L as j,cL as se,dU as ne,dV as ae,dW as oe,aQ as ie,b2 as le,E as re,ai as ce,aW as de,aV as ue,G as h,e as C,f as u,k as s,l as t,H as n,F as T,T as F,a3 as V,I as l,m as w,R as fe,Q as k,p as _e,cr as me,bh as pe,r as _,aj as ge,a as he,w as ve,i as B,u as v,as as be,v as H,b9 as ye}from"./vendor-CJ2tyHrn.js";import{N as xe}from"./NavigationMenu-Bt5ZMl5l.js";import{E as Ce}from"./EIRreportsStore-COMUTdOQ.js";import{P as q,u as Pe,_ as U,ab as De,B as we}from"../index-CPIhguZJ.js";import{B as Ie}from"./bottomNavBar-Bpb02USd.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BtvCa6MI.js";const ke=O({name:"ClientDetailsCard",components:{IonContent:j,IonHeader:te,IonPage:M,IonTitle:ee,IonToolbar:Z,IonCard:X,IonCardHeader:K,IonCardTitle:J,IonCardContent:Y,IonGrid:W,IonRow:S,IonCol:L,IonButton:Q,IonIcon:G},props:{clients:{type:Array,required:!0}},setup(){return{personOutline:ue,locationOutline:de,informationCircleOutline:ce,documentTextOutline:re,calendarOutline:le,heartOutline:ie,briefcaseOutline:oe,schoolOutline:ae,ribbonOutline:ne,openOutline:se}},methods:{calculateAge(e){const o=new Date,i=new Date(e);let m=o.getFullYear()-i.getFullYear();const N=o.getMonth()-i.getMonth();return(N<0||N===0&&o.getDate()<i.getDate())&&m--,m},formatDate(e){return new Date(e).toLocaleDateString()},findPersonAttribute(e,o){const i=e.person.person_attributes.find(m=>m.type.name===o);return i?i.value:"N/A"},toggleDetails(e){e.showDetails=!e.showDetails},async openClientProfile(e){e.forEach(async o=>{if(o.type.patient_identifier_type_id==3){const i=await q.findByNpid(o.identifier);Pe().setPatientRecord(i[0]),this.redirectUser()}})},redirectUser(){const e=JSON.parse(localStorage.getItem("userRoles")),o=e||[];o.some(i=>o.some(m=>m.role==="Pharmacist"))?this.$router.push("NCDDispensations"):this.$router.push("patientProfile")}},mounted(){this.clients.forEach(e=>{e.showDetails=!1})},emits:["view-profile"]}),Oe={class:"cards-container"},Ne={class:"flex items-center mb-3 ion-align-items-center"},ze={class:"flex flex-col overflow-hidden"},$e={class:"font-semibold text-gray-800 truncate"},Se={class:"flex items-center mb-3 ion-align-items-center"},Ae={class:"flex flex-col overflow-hidden"},Ve={class:"font-semibold text-gray-800 truncate"},Be={class:"mt-4"},He={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Le={class:"flex flex-col"},Ue={class:"font-semibold text-gray-800"},Ee={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Te={class:"flex flex-col"},Fe={class:"font-semibold text-gray-800"},Re={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Me={class:"flex flex-col"},je={class:"font-semibold text-gray-800"},qe={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Ge={class:"flex flex-col"},Qe={class:"font-semibold text-gray-800"},We={class:"flex items-center mb-3 p-2 hover:bg-indigo-100 rounded transition-colors duration-200"},Ye={class:"flex flex-col"},Je={class:"font-semibold text-gray-800"};function Ke(e,o,i,m,N,z){const P=h("ion-button"),I=h("ion-card-title"),f=h("ion-col"),r=h("ion-icon"),b=h("ion-row"),p=h("ion-card-header"),y=h("ion-grid"),x=h("ion-card-content"),A=h("ion-card");return u(),C("div",null,[s("div",Oe,[t(b,{class:"responsive-row"},{default:n(()=>[(u(!0),C(T,null,F(e.clients,a=>(u(),C("div",{key:a.patient_id,class:"card-wrapper"},[t(A,{class:"shadow-md hover:shadow-lg transition-shadow client-card"},{default:n(()=>[t(p,{class:"relative"},{default:n(()=>[t(b,{class:"ion-align-items-start"},{default:n(()=>[t(f,{size:"10",class:"ion-text-left"},{default:n(()=>[t(I,{class:"text-indigo-800 client-name-title"},{default:n(()=>[t(P,{fill:"clear",style:{"font-size":"1.4rem"},onClick:g=>e.openClientProfile(a.patient_identifiers)},{default:n(()=>[V(l(a.person.names[0].given_name)+" "+l(a.person.names[0].family_name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),t(f,{size:"2",class:"ion-text-right"},{default:n(()=>[t(P,{fill:"clear",class:"absolute top-0 right-0 z-10 text-indigo-600 open-icon-button",onClick:g=>e.openClientProfile(a.patient_identifiers),style:{"font-size":"1.4rem"}},{default:n(()=>[t(r,{icon:e.openOutline,style:{"font-size":"2rem"}},null,8,["icon"])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(x,{class:"card-content"},{default:n(()=>{var g,$;return[s("div",Ne,[t(r,{icon:e.personOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",ze,[s("span",$e,l(a.person.gender)+" | "+l(e.calculateAge(a.person.birthdate))+" years",1)])]),s("div",Se,[t(r,{icon:e.locationOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ae,[s("span",Ve,l((g=a.person.addresses[0])==null?void 0:g.city_village)+", "+l(($=a.person.addresses[0])==null?void 0:$.state_province),1)])]),s("div",Be,[t(P,{onClick:D=>e.toggleDetails(a),fill:"outline",size:"small",class:"border-indigo-600 text-indigo-600 hover:bg-indigo-50"},{default:n(()=>[t(r,{icon:e.informationCircleOutline,class:"mr-2"},null,8,["icon"]),V(" "+l(a.showDetails?"Hide Details":"Show More Details"),1)]),_:2},1032,["onClick"]),a.showDetails?(u(),C("div",{key:0,class:"mt-4 bg-indigo-50 p-4 rounded-lg border border-indigo-100 shadow-inner",style:fe({maxHeight:a.showDetails?"1000px":"0"})},[o[0]||(o[0]=s("h3",{class:"text-lg font-semibold mb-3 flex items-center text-indigo-800 border-b border-indigo-200 pb-2"}," Personal Information ",-1)),t(y,null,{default:n(()=>[t(b,null,{default:n(()=>[t(f,{size:"auto"},{default:n(()=>[s("div",He,[t(r,{icon:e.calendarOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Le,[s("span",Ue,l(e.formatDate(a.person.birthdate)),1)])])]),_:2},1024),t(f,{size:"auto"},{default:n(()=>[s("div",Ee,[t(r,{icon:e.heartOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Te,[s("span",Fe,l(e.findPersonAttribute(a,"Civil Status")),1)])])]),_:2},1024),t(f,{size:"auto"},{default:n(()=>[s("div",Re,[t(r,{icon:e.briefcaseOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Me,[s("span",je,l(e.findPersonAttribute(a,"Occupation")),1)])])]),_:2},1024),t(f,{size:"auto"},{default:n(()=>[s("div",qe,[t(r,{icon:e.schoolOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ge,[s("span",Qe,l(e.findPersonAttribute(a,"EDUCATION LEVEL")),1)])])]),_:2},1024),t(f,{size:"12","size-md":"6"},{default:n(()=>[s("div",We,[t(r,{icon:e.ribbonOutline,class:"mr-2 flex-shrink-0 text-indigo-600"},null,8,["icon"]),s("div",Ye,[s("span",Je,l(e.findPersonAttribute(a,"Religion")),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1024),o[1]||(o[1]=s("h3",{class:"text-lg font-semibold mt-3 mb-2"},"Identifiers",-1)),t(y,null,{default:n(()=>[t(b,null,{default:n(()=>[(u(!0),C(T,null,F(a.patient_identifiers,D=>(u(),k(f,{key:D.uuid,size:"auto"},{default:n(()=>[s("p",null,[s("strong",null,l(D.type.name)+":",1),V(" "+l(D.identifier),1)])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)],4)):w("",!0)])]}),_:2},1024)]),_:2},1024)]))),128))]),_:1})])])}const Xe=U(ke,[["render",Ke],["__scopeId","data-v-82a37352"]]),Ze={class:"loader-content"},et={key:0,class:"loader-message"},tt=O({name:"ModernLoader"}),st=O({...tt,props:{message:{type:String,default:"Loading..."},fullscreen:{type:Boolean,default:!1}},setup(e){return(o,i)=>(u(),C("div",{class:_e(["loader-container",{fullscreen:e.fullscreen,inline:!e.fullscreen}])},[s("div",Ze,[i[0]||(i[0]=s("div",{class:"spinner"},[s("div",{class:"spinner-ring"}),s("div",{class:"spinner-core"})],-1)),e.message?(u(),C("div",et,l(e.message),1)):w("",!0)])],2))}}),R=U(st,[["__scopeId","data-v-17c24025"]]),nt={class:"container"},at={key:1,class:"scrollable-content"},ot={class:"centered-content"},it=O({name:"xxxComponent"}),lt=O({...it,setup(e){const o=me(),i=De(),{userFacilityName:m,user_ID:N}=pe(i),z=_(""),P=_(0),I=_([]),f=_(""),r=_(""),b=_(""),p=ge({page:1,itemsPerPage:10}),y=_(!1),x=_(!0),A=({page:c,itemsPerPage:d})=>{p.page=c,p.itemsPerPage=d,a()},a=async(c=!0)=>{c&&(y.value=!0);try{const d=await q.getNCDClients(p.page,p.itemsPerPage,f.value,r.value,b.value);P.value=d.count,I.value=d.results}catch(d){}finally{c&&(y.value=!1,x.value=!1)}},g=[{placeHolder:"Search for client",dataHandler:$,dataValue:_(),show_error:_(!1),error_message:"Please provide a reason"}];async function $(c){try{z.value=c.target.value,f.value="",r.value="",b.value="",z.value.length>0?(D(z.value),p.page=1,await a()):await a(!1)}catch(d){await a(!1)}}function D(c){g[0].dataValue.value=c;const d=c.split(" ");f.value=d[0],r.value=d.length>=2?d[1]:"",b.value=d.length>=3?d[2]:""}const E=()=>{Ce().setNavigationPayload("NCD Active Patients (".concat(m.value,")"),!0,!1,"/","home",""),a()};return he(async()=>{E()}),ve(()=>o.name,c=>{c==="NCDActivePatients"&&E()},{immediate:!0}),(c,d)=>(u(),k(v(M),null,{default:n(()=>[t(xe),x.value?(u(),k(R,{key:0,fullscreen:!0,message:"Loading patient data..."})):w("",!0),B(t(v(j),null,{default:n(()=>[s("div",nt,[t(v(S),{class:"search-container"},{default:n(()=>[t(v(L),{class:"input-col",size:"12"},{default:n(()=>[t(we,{placeholder:g[0].placeHolder,icon:v(be),inputValue:g[0].dataValue.value,"onUpdate:inputValue":g[0].dataHandler,minHeight:50,"-inner-action-btn-propeties":""},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"])]),_:1})]),_:1}),y.value&&!x.value?(u(),k(R,{key:0,message:"Fetching patients..."})):w("",!0),y.value?w("",!0):B((u(),C("div",at,[s("div",ot,[!y.value||I.value.length>0?(u(),k(v(S),{key:0},{default:n(()=>[t(Xe,{clients:I.value},null,8,["clients"])]),_:1})):w("",!0)])],512)),[[H,!x.value]])])]),_:1},512),[[H,!x.value]]),B(t(v(ye),{class:"sticky-footer"},{default:n(()=>[t(v(S),null,{default:n(()=>[t(v(L),{size:"12"},{default:n(()=>[t(Ie,{totalItems:P.value,currentPage:p.page,itemsPerPage:p.itemsPerPage,"onUpdate:pagination":A},null,8,["totalItems","currentPage","itemsPerPage"])]),_:1})]),_:1})]),_:1},512),[[H,!x.value]])]),_:1}))}}),pt=U(lt,[["__scopeId","data-v-c5fa53b7"]]);export{pt as default};
