System.register(["./vendor-legacy-BV-WGgzk.js","../index-legacy-_J1usb-M.js","./patient_diagnosis_service-legacy-DzHy6Sa7.js","./DashBox-legacy-DpSSmf4D.js","./lodash-legacy-pOOc9Efu.js"],function(e,a){"use strict";var i,t,n,o,s,l,d,r,c,u,p,g,v,m,h,f,y,_,D,b,x,I,w,k,S,C,B,F,M,H,T,A,O,P,E,j,L,N,G,$,z,V,W,J,R,q;return{setters:[e=>{i=e.d,t=e.ah,n=e.G,o=e.E,s=e.ai,l=e.aj,d=e._,r=e.I,c=e.a3,u=e.R,p=e.be,g=e.aS,v=e.H,m=e.e,h=e.f,f=e.k,y=e.l,_=e.r,D=e.c,b=e.w,x=e.a,I=e.m,w=e.O,k=e.J,S=e.u,C=e.Q,B=e.F},e=>{F=e.b6,M=e.H,H=e.af,T=e.b8,A=e.b7,O=e.u,P=e._,E=e.bV,j=e.aB,L=e.l,N=e.aC,G=e.J,$=e.S,z=e.s,V=e.aX,W=e.G},e=>{J=e.P},e=>{R=e.D},e=>{q=e.l}],execute:function(){var a=document.createElement("style");a.textContent=".bmi_blood[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:190px}.graphBtn[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:90px}._active[data-v-88580898]{background-color:#ded;color:#006401;padding:5px;border-radius:4px}.iconBg[data-v-88580898]{background:#ded;padding:2px;border-radius:5px}#container[data-v-0ac31033]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-0ac31033]{font-size:20px;line-height:26px}#container p[data-v-0ac31033]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-0ac31033]{text-decoration:none}.action_buttons[data-v-0ac31033]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-0ac31033]{padding-left:20px}.item_no_border[data-v-0ac31033]{--border-color: transparent}.search_result[data-v-0ac31033]{padding:10px}.previousView[data-v-0ac31033]{margin-top:70px;margin-bottom:20px}\n/*$vite$:1*/",document.head.appendChild(a);const Q=i({name:"Menu",components:{IonContent:c,IonHeader:r,IonItem:d,IonList:l,IonMenu:s,IonTitle:o,IonToolbar:n,List:F},computed:{...t(O,["patient"])},data:()=>({valueNumericArray:[],obsDatetime:[],graphIcon:A(["#006401"]),listIcon:T(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}),setup:()=>({checkmark:g,pulseOutline:p}),async mounted(){const e=[...await H.getAll(this.patient.patientID,"Primary diagnosis")||[],...await H.getAll(this.patient.patientID,"Secondary diagnosis")||[],...await H.getAll(this.patient.patientID,"Attempted/ Differential diagnosis")||[]],a=q.isEmpty(e)?[]:Promise.all(e.map(async e=>({name:await H.getConceptName(e.value_coded),obs_date:e.obs_datetime})));this.setListData(await a)},methods:{dismiss(){u.dismiss()},handleIcon(){},setActivClass(e){this.activeHeight="",this.activeBMI="",this.activeWeight="","height"==e?this.activeHeight="_active":"weight"==e?this.activeWeight="_active":"BMI"==e&&(this.activeBMI="_active")},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),e.forEach(e=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[M.toStandardHisFormat(e.obs_date),e.name,""]})})}}}),X={class:"modal_wrapper"},Y=P(Q,[["render",function(e,a,i,t,n,o){const s=v("list");return h(),m("div",X,[f("div",null,[y(s,{listData:e.list},null,8,["listData"])])])}],["__scopeId","data-v-88580898"]]),K={class:"custom_card",style:{padding:"10px"}},U={key:0},Z={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},ee={class:"ion-padding",slot:"content"};e("O",P(i({__name:"OPDDiagnosis",setup(e,{expose:a}){const i=L,t=_(!0),n=_(!1),o=_(!0),s=_(!1),l=_(!0),r=_(""),c=_(""),u=_([]),p=_([]),g=_(),M=_(null);E();const T=D(()=>p.value.some(e=>6542===e.data.concept_id));b(p,()=>{X()},{deep:!0});const A=D(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:u.value,icon:i.search,onSearchChange:q,validation:j.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:u.value,icon:i.search,condition:e=>null==e?void 0:e.secondaryDiagnosisCheckbox,onSearchChange:q,validation:(e,a)=>O(a,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:u.value,icon:i.search,isMultiple:!0,condition:e=>null==e?void 0:e.differentialDiagnosisCheckbox,onSearchChange:q,validation:(e,a)=>O(a,"differentialDiagnosis")}]),O=(e,a)=>{var i,t,n;if(!e)return null;const o=null===(i=e.primaryDiagnosis)||void 0===i?void 0:i.name,s=(null===(t=e.secondaryDiagnosis)||void 0===t?void 0:t.map(e=>e.name))||[],l=(null===(n=e.differentialDiagnosis)||void 0===n?void 0:n.map(e=>e.name))||[];if("secondaryDiagnosis"===a&&s.includes(o))return`${o} is already the primary diagnosis`;if("differentialDiagnosis"===a&&l.includes(o))return`${o} is already the primary diagnosis`;const d=s.find(e=>l.includes(e));return d?`${d} cannot be both secondary and differential`:null},P=()=>{var e;const a=[],i=p.value.map(e=>e.name),t=(null===(e=M.value)||void 0===e?void 0:e.getFormValues())||{},n=t.primaryDiagnosis||[],o=t.secondaryDiagnosis||[],s=t.differentialDiagnosis||[];if(n.name&&!i.includes(n.name)){if(p.value.some(e=>6542===e.data.concept_id))return z("Only one primary diagnosis is allowed"),!1;a.push({actionBtn:!0,btn:["delete"],name:n.name,id:n.concept_id,display:[n.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:n.concept_id,obs_datetime:$.getSessionDate()}})}return o&&o.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:e.concept_id,obs_datetime:$.getSessionDate()}})}),s&&s.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:e.concept_id,obs_datetime:$.getSessionDate()}})}),a.length>0&&(p.value=[...p.value,...a]),!0},q=async e=>{const a=e.trim().toLowerCase()||"";return u.value=await J.getDiagnosis(a,1,15),u.value},Q=e=>{const a=p.value,i=e.name,t=a.filter(e=>e.display[0]!==i);p.value=t},X=()=>{p.value.length>0?(s.value=!0,t.value=!1):n.value||(t.value=!0),l.value=!T.value};return x(async()=>{X(),await q("")}),a({onSubmit:async()=>{if(p.value.length<=0)return;const e=p.value.flatMap(e=>e.data);e.length<=0||(await H.addObsToEncounterPatient(e,V.DIAGNOSIS),W("Diagnosis saved successful"),p.value=[])}}),(e,a)=>{const u=v("ion-row"),_=v("ion-label"),D=v("ion-accordion"),b=v("ion-accordion-group");return h(),m(B,null,[f("div",K,[y(R,{status:t.value,content:"No Diagnosis added"},null,8,["status"]),s.value?(h(),m("span",U,[y(F,{listData:p.value,"onClicked:delete":Q},null,8,["listData"]),T.value?(h(),m("div",Z," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):I("",!0)])):I("",!0),n.value?(h(),w(u,{key:1},{default:k(()=>{var e;return[f("div",null,[y(N,{formData:A.value,ref_key:"formRef",ref:M},null,8,["formData"])]),f("div",null,[y(G,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[0]||(a[0]=e=>(async()=>{var e;null==(null===(e=M.value)||void 0===e?void 0:e.validateForm())&&(P(),n.value=!1,s.value=!0,l.value=!0,o.value=!1)})()),name:"Save",disabled:null===(e=M.value)||void 0===e?void 0:e.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):I("",!0),l.value?(h(),w(u,{key:2,style:{"margin-top":"10px"}},{default:k(()=>[y(G,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[1]||(a[1]=e=>(c.value="",r.value="",t.value=!1,l.value=!1,void(n.value=!0))),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):I("",!0)]),y(u,null,{default:k(()=>[y(b,{ref_key:"accordionGroup",ref:g,class:"previousView"},{default:k(()=>[y(D,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:k(()=>[y(S(d),{slot:"header",color:"light"},{default:k(()=>[y(_,{class:"previousLabel"},{default:k(()=>[...a[2]||(a[2]=[C("Previous Diagnosis",-1)])]),_:1})]),_:1}),f("div",ee,[y(Y)])]),_:1})]),_:1},512)]),_:1})],64)}}}),[["__scopeId","data-v-0ac31033"]]))}}});
