System.register(["./vendor-legacy-CL4ddJgY.js","../index-legacy-ByfisDBi.js","./neonatal_service-legacy-D5HKi0yR.js","./DemographicBar-legacy-Dq95qcFf.js","./NeonatalStepper-legacy-Lz7bSJ2r.js","./enrollment-legacy-BWFKsMdA.js","./images-legacy-CpQcoUy5.js","./useNeonatalEnrollmentStore-legacy-C0T3aCSp.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-TrKVFpG0.js","./SaveProgressModal-legacy-C8l7wy-K.js"],function(e,a){"use strict";var t,r,l,n,i,o,s,d,c,u,m,v,f,p,g,h,b,y,w,x,k,_,F,N,D,I,S,V,T,z,A,R,P,E,M,O,C,$,j,B,L,H,G,U,q,K,W,Y,Q,Z,J,X,ee,ae,te,re,le,ne,ie,oe,se,de,ce;return{setters:[e=>{t=e.d,r=e.bH,l=e.r,n=e.c,i=e.w,o=e.e,s=e.m,d=e.f,c=e.k,u=e.l,m=e.u,v=e.aS,f=e.J,p=e.L,g=e.bp,h=e.cB,b=e.Q,y=e.aR,w=e.aV,x=e.Z,k=e.bO,_=e.N,F=e.b1,N=e.F,D=e.P,I=e.K,S=e.cM,V=e.a,T=e.O,z=e.ap,A=e.cr,R=e.fe,P=e.bq,E=e.ff,M=e.bT,O=e.de,C=e.a4,$=e.a7,j=e.b2,B=e.eS,L=e.H},e=>{H=e.u,G=e.P,U=e._,q=e.L,K=e.aG,W=e.T,Y=e.t,Q=e.Z,Z=e.H,J=e.b,X=e.S,ee=e.cf,ae=e.ag,te=e.K,re=e.w},e=>{le=e.N},e=>{ne=e.D},e=>{ie=e.c,oe=e.N},e=>{se=e.n},e=>{de=e.I},e=>{ce=e.u},null,null,null],execute:function(){var a=document.createElement("style");a.textContent=".twin-search-container[data-v-ed5f0376]{padding:0;margin-top:1rem;background-color:#fff}.header-with-icon[data-v-ed5f0376]{display:flex;align-items:center;gap:1rem}.icon-wrapper[data-v-ed5f0376]{position:relative;width:48px;height:48px}.header-icon[data-v-ed5f0376]{width:48px;height:48px;object-fit:contain}.search-badge-icon[data-v-ed5f0376]{position:absolute;bottom:-4px;right:-4px;font-size:18px;background:var(--ion-color-primary);color:#fff;border-radius:50%;padding:4px;box-shadow:0 2px 4px rgba(0,0,0,.2)}.info-note[data-v-ed5f0376]{display:block;margin-bottom:1rem;padding:.75rem;background:rgba(var(--ion-color-warning-rgb),.5);border-radius:4px;font-size:.9rem}.search-with-button[data-v-ed5f0376]{display:flex;align-items:center;gap:.5rem;margin:1rem 0}.skip-btn[data-v-ed5f0376]{flex-shrink:0;margin:0;--padding-start: 12px;--padding-end: 12px}.search-wrapper[data-v-ed5f0376]{width:100%;position:relative;display:flex;align-items:center}.search-input[data-v-ed5f0376]{width:100%;--border-radius: .5rem;--background: #f6f6f6;--color: #333}.search-results[data-v-ed5f0376]{margin-top:1rem}.search-loading[data-v-ed5f0376]{display:flex;flex-direction:column;gap:0}.result-item-skeleton[data-v-ed5f0376]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);background:#fff}.result-item-skeleton[data-v-ed5f0376]:first-child{border-top:none}.skeleton-header[data-v-ed5f0376]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.skeleton-name[data-v-ed5f0376]{height:20px;width:180px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-ed5f0376 1.5s infinite;border-radius:4px}.skeleton-dob[data-v-ed5f0376]{height:16px;width:100px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-ed5f0376 1.5s infinite;border-radius:4px}@keyframes shimmer-ed5f0376{0%{background-position:200% 0}to{background-position:-200% 0}}.results-list[data-v-ed5f0376]{margin-top:1rem}.result-item[data-v-ed5f0376]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);cursor:pointer;transition:all .2s;background:#fff}.result-item[data-v-ed5f0376]:first-child{border-top:none}.result-item[data-v-ed5f0376]:hover{background:var(--ion-color-light-tint)}.result-header[data-v-ed5f0376]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.twin-name[data-v-ed5f0376]{font-size:1.125rem;font-weight:600;color:var(--ion-color-dark);margin:0}.twin-mrn[data-v-ed5f0376],.twin-dob[data-v-ed5f0376]{font-size:.9rem;color:var(--ion-color-medium)}.result-details[data-v-ed5f0376]{padding-left:0}.twin-gender[data-v-ed5f0376]{margin:.5rem 0 0;font-size:.9rem;color:var(--ion-color-dark)}.twin-gender strong[data-v-ed5f0376]{font-weight:500}.no-results[data-v-ed5f0376]{text-align:center;padding:2rem}.no-results-icon[data-v-ed5f0376]{font-size:3rem;color:var(--ion-color-medium);margin-bottom:1rem}.info-text[data-v-ed5f0376]{font-size:.875rem;color:var(--ion-color-medium);margin-top:.5rem}.selected-twin[data-v-ed5f0376]{margin-top:1.5rem}.selected-card[data-v-ed5f0376]{border:1px solid #e5e5e5;border-radius:8px;overflow:hidden}.selected-card-header[data-v-ed5f0376]{display:flex;align-items:center;justify-content:space-between;padding:.875rem 1rem;background:#f8f8f8;border-bottom:1px solid #ececec}.header-content[data-v-ed5f0376]{display:flex;align-items:center;gap:.5rem;background:#fff;padding:.5rem;border-radius:50px;border:1px dotted #ececec}.selected-icon-wrapper[data-v-ed5f0376]{width:30px;height:30px;border-radius:50%;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(0,0,0,.1);flex-shrink:0}.selected-header-icon[data-v-ed5f0376]{width:15px;height:15px;object-fit:contain;filter:brightness(0) invert(1)}.header-separator[data-v-ed5f0376]{width:1px;height:24px;background:#d4d4d4;flex-shrink:0}.success-icon[data-v-ed5f0376]{font-size:1.25rem;color:#10b981}.selected-subtitle[data-v-ed5f0376]{font-size:.875rem;font-weight:500;color:#525252}.clear-selection-btn[data-v-ed5f0376]{margin:0;--padding-start: 6px;--padding-end: 6px;--color: var(--ion-color-medium-shade)}.clear-selection-btn[data-v-ed5f0376]:hover{--color: var(--ion-color-danger)}.clear-selection-btn ion-icon[data-v-ed5f0376]{font-size:1.5rem}.selected-card-content[data-v-ed5f0376]{padding:1.25rem}.patient-info-grid[data-v-ed5f0376]{display:flex;flex-direction:column;gap:1rem}.info-row[data-v-ed5f0376]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;border-bottom:none}.info-row[data-v-ed5f0376]:nth-child(odd){background:#ececec}.info-row[data-v-ed5f0376]:nth-child(2n){background:#fff}.info-label[data-v-ed5f0376]{font-size:.813rem;font-weight:400;color:#737373;text-transform:uppercase;letter-spacing:.5px}.info-value[data-v-ed5f0376]{font-size:.938rem;font-weight:600;color:#171717;text-align:right}.birth-details-wrapper[data-v-9a714757]{display:flex;flex-direction:column;gap:1rem}.mother-search-container[data-v-2bf8e305]{padding:0rem}.header-with-icon[data-v-2bf8e305]{display:flex;align-items:center;gap:1rem}.icon-wrapper[data-v-2bf8e305]{position:relative;width:48px;height:48px}.header-icon[data-v-2bf8e305]{width:48px;height:48px;object-fit:contain}.search-badge-icon[data-v-2bf8e305]{position:absolute;bottom:-4px;right:-4px;font-size:18px;background:var(--ion-color-primary);color:#fff;border-radius:50%;padding:4px;box-shadow:0 2px 4px rgba(0,0,0,.2)}.info-note[data-v-2bf8e305]{display:block;margin-bottom:1rem;padding:.75rem;background:rgba(var(--ion-color-warning-rgb),.3);border-radius:8px;font-size:.9rem}.search-with-button[data-v-2bf8e305]{display:flex;align-items:center;gap:.5rem;margin:1rem 0}.new-registration-btn[data-v-2bf8e305]{flex-shrink:0;margin:0;--padding-start: 12px;--padding-end: 12px}.search-input[data-v-2bf8e305]{flex:1;margin:0;padding:0}.search-results[data-v-2bf8e305]{margin-top:1rem}.search-loading[data-v-2bf8e305]{display:flex;flex-direction:column;gap:0}.result-item-skeleton[data-v-2bf8e305]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);background:#fff}.result-item-skeleton[data-v-2bf8e305]:first-child{border-top:none}.skeleton-header[data-v-2bf8e305]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.skeleton-name[data-v-2bf8e305]{height:20px;width:180px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-2bf8e305 1.5s infinite;border-radius:4px}.skeleton-dob[data-v-2bf8e305]{height:16px;width:100px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-2bf8e305 1.5s infinite;border-radius:4px}.skeleton-gender[data-v-2bf8e305]{height:16px;width:60px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-2bf8e305 1.5s infinite;border-radius:4px}.skeleton-details[data-v-2bf8e305]{display:flex;flex-direction:column;gap:.5rem}.skeleton-address[data-v-2bf8e305]{height:16px;width:250px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-2bf8e305 1.5s infinite;border-radius:4px}.skeleton-phone[data-v-2bf8e305]{height:16px;width:120px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-2bf8e305 1.5s infinite;border-radius:4px}@keyframes shimmer-2bf8e305{0%{background-position:200% 0}to{background-position:-200% 0}}.results-list[data-v-2bf8e305]{margin-top:1rem}.result-item[data-v-2bf8e305]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);cursor:pointer;transition:all .2s;background:#fff}.result-item[data-v-2bf8e305]:first-child{border-top:none}.result-item[data-v-2bf8e305]:hover{background:var(--ion-color-light-tint)}.result-header[data-v-2bf8e305]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.mother-name[data-v-2bf8e305]{font-size:1.125rem;font-weight:600;color:var(--ion-color-dark);margin:0}.mother-dob[data-v-2bf8e305],.mother-gender[data-v-2bf8e305]{font-size:.9rem;color:var(--ion-color-medium)}.result-details[data-v-2bf8e305]{padding-left:0}.mother-address[data-v-2bf8e305]{margin:.5rem 0;font-size:.9rem;color:var(--ion-color-dark)}.mother-address strong[data-v-2bf8e305]{font-weight:500}.mother-phone[data-v-2bf8e305]{display:flex;align-items:center;gap:.5rem;margin:.5rem 0 0;font-size:.9rem;color:var(--ion-color-dark)}.mother-phone ion-icon[data-v-2bf8e305]{font-size:1.1rem;color:var(--ion-color-medium)}.pagination[data-v-2bf8e305]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:1rem;padding:1rem}.page-info[data-v-2bf8e305]{font-size:.9rem;color:var(--ion-color-medium)}.no-results[data-v-2bf8e305]{text-align:center;padding:2rem}.no-results-icon[data-v-2bf8e305]{font-size:3rem;color:var(--ion-color-medium);margin-bottom:1rem}.selected-mother[data-v-2bf8e305]{margin-top:1rem}.selected-card[data-v-2bf8e305]{background:#fbfbfb;border:2px dotted var(--ion-color-medium);border-radius:8px;overflow:hidden}.selected-card-header[data-v-2bf8e305]{padding:1rem 1rem .5rem}.selected-card-content[data-v-2bf8e305]{padding:.5rem 1rem 1rem}.selected-subtitle[data-v-2bf8e305]{font-size:.875rem;font-weight:600;color:var(--ion-color-dark);text-transform:uppercase;letter-spacing:.5px}.selected-header-with-button[data-v-2bf8e305]{display:flex;align-items:center;justify-content:space-between}.clear-selection-btn[data-v-2bf8e305]{margin:0;--padding-start: 8px;--padding-end: 8px;opacity:1}.clear-selection-btn ion-icon[data-v-2bf8e305]{opacity:1;font-size:24px}.selected-info[data-v-2bf8e305]{margin-bottom:0}.selected-info h3[data-v-2bf8e305]{margin:0 0 .5rem;color:#000;text-transform:uppercase;font-size:1.125rem;font-weight:600}.selected-info p[data-v-2bf8e305]{margin:.25rem 0;font-size:.9rem}.search-wrapper[data-v-2bf8e305]{width:100%;position:relative;display:flex;align-items:center}.search-input[data-v-2bf8e305]{width:100%;--border-radius: .5rem;--background: #f6f6f6;--color: #333}.barcode-btn[data-v-2bf8e305]{position:absolute;right:0;top:26px;transform:translateY(-50%);height:34px;width:34px;z-index:2}.neonatal-enrollment-page[data-v-50ae1bd0]{min-height:100vh}\n/*$vite$:1*/",document.head.appendChild(a);const ue={key:0,class:"twin-search-container"},me={style:{border:"1px dotted #ececec","border-radius":"8px"}},ve={class:"header-with-icon"},fe={class:"icon-wrapper"},pe=["src"],ge={class:"search-with-button"},he={class:"search-wrapper"},be={key:0,class:"search-results"},ye={key:0,class:"search-loading"},we={key:1,class:"results-list"},xe=["onClick"],ke={class:"result-header"},_e={class:"twin-name"},Fe={class:"twin-mrn"},Ne={class:"twin-dob"},De={class:"result-details"},Ie={key:0,class:"twin-gender"},Se={key:2,class:"no-results"},Ve={key:1,class:"selected-twin"},Te={class:"selected-card"},ze={class:"selected-card-header"},Ae={class:"header-content"},Re={class:"selected-icon-wrapper"},Pe=["src"],Ee={class:"selected-card-content"},Me={class:"patient-info-grid"},Oe={class:"info-row"},Ce={class:"info-value"},$e={class:"info-row"},je={class:"info-value"},Be={key:0,class:"info-row"},Le={class:"info-value"},He={key:1,class:"info-row"},Ge={class:"info-value"},Ue=U(t({__name:"TwinSearch",setup(e,{expose:a}){const t=r(se),V=H(),T=l(""),z=l(!1),A=l([]),R=l(null),P=l(!1),E=n(()=>"Yes"===(null==t?void 0:t.hasTwin)),M=async()=>{if(!T.value||T.value.trim().length<2)A.value=[];else{z.value=!0;try{const a=T.value.trim();if(/^\d+$/.test(a))try{const e=await V.getPatientData(Number(a));if(e&&e.personInformation){const a=e.personInformation;A.value=[{patientID:a.person_id,firstName:a.given_name||"",middleName:a.middle_name||"",lastName:a.family_name||"",gender:a.gender,birthdate:a.birthdate}]}else A.value=[]}catch(e){console.error("Error searching by MRN:",e),A.value=[]}else{const e=a.split(" "),t={given_name:e[0],family_name:e[1]||"",page:"1",per_page:"20"},r=await G.search(t);A.value=Array.isArray(r)?r.filter(e=>{const a=e.person;if(!a.birthdate)return!1;const t=new Date(a.birthdate);return Math.floor((Date.now()-t.getTime())/864e5)<=7}).map(e=>{var a;const t=e.person,r=(null===(a=t.names)||void 0===a?void 0:a[0])||{};return{patientID:t.person_id,firstName:r.given_name||"",middleName:r.middle_name||"",lastName:r.family_name||"",gender:t.gender,birthdate:t.birthdate}}):[]}}catch(e){console.error("Error searching for twin:",e),A.value=[]}finally{z.value=!1}}},O=()=>{R.value=null,P.value=!1,t&&(t.twinPatientId=void 0,t.twinName=void 0)},C=()=>{P.value=!0,R.value=null,T.value="",t&&(t.twinPatientId=void 0,t.twinName=void 0)};i(()=>null==t?void 0:t.hasTwin,e=>{"Yes"!==e&&(O(),P.value=!1)});const $=e=>`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),j=e=>e?new Date(e).toLocaleDateString():"";return a({validateForm:()=>"Yes"!==(null==t?void 0:t.hasTwin)||R.value||P.value?null:{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"},getFormValues:()=>R.value?{twinPatientId:R.value.patientID,twinName:$(R.value)}:{}}),(e,a)=>E.value?(d(),o("div",ue,[c("div",me,[u(m(v),null,{default:f(()=>[c("div",ve,[c("div",fe,[c("img",{src:m(de).icons.twins,alt:"Twin",class:"header-icon"},null,8,pe),u(m(p),{icon:m(g),class:"search-badge-icon"},null,8,["icon"])]),c("div",null,[u(m(h),null,{default:f(()=>[...a[1]||(a[1]=[b("Twin Information",-1)])]),_:1}),u(m(y),null,{default:f(()=>[...a[2]||(a[2]=[b("Search for twin sibling",-1)])]),_:1})])])]),_:1}),u(m(w),null,{default:f(()=>[u(m(x),{class:"info-note"},{default:f(()=>[...a[3]||(a[3]=[b(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),c("div",ge,[c("div",he,[u(m(k),{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),placeholder:"Search for twin's MRN or scan barcode",onIonInput:M,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),u(m(_),{color:"primary",onClick:C,class:"skip-btn"},{default:f(()=>[a[4]||(a[4]=b(" Skip ",-1)),u(m(p),{size:"small",icon:m(F),slot:"end"},null,8,["icon"])]),_:1})]),T.value&&T.value.length>0&&!R.value?(d(),o("div",be,[z.value?(d(),o("div",ye,[(d(),o(N,null,D(3,e=>c("div",{key:`skeleton-${e}`,class:"result-item-skeleton"},[...a[5]||(a[5]=[c("div",{class:"skeleton-header"},[c("div",{class:"skeleton-name"}),c("div",{class:"skeleton-dob"})],-1)])])),64))])):A.value.length>0?(d(),o("div",we,[(d(!0),o(N,null,D(A.value,(e,r)=>(d(),o("div",{key:e.patientID||r,class:"result-item",onClick:a=>{return r=e,R.value=r,T.value="",P.value=!1,void(t&&(t.twinPatientId=r.patientID,t.twinName=`${r.firstName} ${r.middleName||""} ${r.lastName}`.trim()));var r}},[c("div",ke,[c("span",_e,I($(e)),1),c("span",Fe,"MRN: "+I(e.patientID),1),c("span",Ne,"DOB: "+I(j(e.birthdate)),1)]),c("div",De,[e.gender?(d(),o("p",Ie,[a[6]||(a[6]=c("strong",null,"Gender:",-1)),b(" "+I(e.gender),1)])):s("",!0)])],8,xe))),128))])):(d(),o("div",Se,[u(m(p),{icon:m(g),class:"no-results-icon"},null,8,["icon"]),c("p",null,'No patients found matching "'+I(T.value)+'"',1),a[7]||(a[7]=c("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):s("",!0),R.value?(d(),o("div",Ve,[c("div",Te,[c("div",ze,[c("div",Ae,[c("div",Re,[c("img",{src:m(de).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,Pe)]),a[8]||(a[8]=c("div",{class:"header-separator"},null,-1)),a[9]||(a[9]=c("span",{class:"selected-subtitle"},"Twin Selected",-1))]),u(m(_),{fill:"clear",size:"small",onClick:O,class:"clear-selection-btn"},{default:f(()=>[u(m(p),{icon:m(S)},null,8,["icon"])]),_:1})]),c("div",Ee,[c("div",Me,[c("div",Oe,[a[10]||(a[10]=c("span",{class:"info-label"},"Full Name",-1)),c("span",Ce,I($(R.value)),1)]),c("div",$e,[a[11]||(a[11]=c("span",{class:"info-label"},"MRN",-1)),c("span",je,I(R.value.patientID),1)]),R.value.birthdate?(d(),o("div",Be,[a[12]||(a[12]=c("span",{class:"info-label"},"Date of Birth",-1)),c("span",Le,I(j(R.value.birthdate)),1)])):s("",!0),R.value.gender?(d(),o("div",He,[a[13]||(a[13]=c("span",{class:"info-label"},"Gender",-1)),c("span",Ge,I(R.value.gender),1)])):s("",!0)])])])])):s("",!0)]),_:1})])])):s("",!0)}}),[["__scopeId","data-v-ed5f0376"]]),qe=e=>{if(null!=e&&""!==e){if("string"==typeof e||"number"==typeof e)return e.toString();if("object"==typeof e){var a,t,r;const l=null!==(a=null!==(t=null!==(r=e.label)&&void 0!==r?r:e.value)&&void 0!==t?t:e.name)&&void 0!==a?a:e.title;if(null!=l&&""!==l)return l.toString()}}},Ke=e=>{if(!e)return[];if(Array.isArray(e))return e.map(e=>qe(e)).filter(e=>!!e);const a=qe(e);return a?[a]:[]},We=e=>null==e?"":e.toString(),Ye={class:"birth-details-wrapper"},Qe=U(t({__name:"BirthDetails",setup(e,{expose:a}){const t=l(null),s=l(null),c=l(null),v=ie[0].formData,f=v.slice(0,1),p=v.slice(1),g=r(se),h=l([]);V(async()=>{try{const e=await q.getAllFacilities();Array.isArray(e)?h.value=e:null!=e&&e.facilities&&Array.isArray(e.facilities)?h.value=e.facilities:null!=e&&e.records&&Array.isArray(e.records)?h.value=e.records:h.value=[]}catch(e){console.error("Error loading facilities:",e),h.value=[]}});const b=n(()=>p.map(e=>"birthFacility"===e.name?{...e,options:h.value.map(e=>{const a=e.name||e.facility_name||"Unknown";return{name:a,label:a,value:e.id||e.facility_id||a,code:e.code||e.facility_code,district:e.district||e.district_name}})}:e)),y=e=>{g&&(g.hasTwin=e.hasTwin||"")},w=e=>{g&&(g.placeOfBirth=qe(e.placeOfBirth)||"",g.nameOfBirthFacility=qe(e.birthFacility)||"",g.typeOfBirth=qe(e.typeOfBirth)||"",g.birthWeight=We(e.birthWeight||""),g.timeOfBirth=We(e.birthTime||""))};return i(()=>{var e;return null===(e=s.value)||void 0===e?void 0:e.formValues},e=>{e&&w(e)},{deep:!0}),i(()=>s.value,e=>{null!=e&&e.getFormValues&&w(e.getFormValues())},{immediate:!0}),i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&y(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&y(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>s.value,getTwinQuestionFormRef:()=>t.value,validateForm:()=>{var e,a,r,l,n,i;const o=[(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null,(null===(r=s.value)||void 0===r||null===(l=r.validateForm)||void 0===l?void 0:l.call(r))||null,(null===(n=c.value)||void 0===n||null===(i=n.validateForm)||void 0===i?void 0:i.call(n))||null].filter(Boolean);return o.length?o.reduce((e,a)=>({...e,...a}),{}):null},getFormValues:()=>{var e,a,r,l,n,i;return{...(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{},...(null===(r=s.value)||void 0===r||null===(l=r.getFormValues)||void 0===l?void 0:l.call(r))||{},...(null===(n=c.value)||void 0===n||null===(i=n.getFormValues)||void 0===i?void 0:i.call(n))||{}}}}),(e,a)=>(d(),o("div",Ye,[u(K,{formData:m(f),ref_key:"twinQuestionFormRef",ref:t,class:"twin-question-form"},null,8,["formData"]),u(Ue,{ref_key:"twinSearchRef",ref:c},null,512),u(K,{formData:b.value,ref_key:"formRef",ref:s,class:"main-form"},null,8,["formData"])]))}}),[["__scopeId","data-v-9a714757"]]),Ze=t({__name:"ReferralInformation",setup(e,{expose:a}){const t=l(null),o=ie[1].formData,s=r(se),c=l([]);V(async()=>{try{const e=await q.getAllFacilities();Array.isArray(e)?c.value=e:null!=e&&e.facilities&&Array.isArray(e.facilities)?c.value=e.facilities:null!=e&&e.records&&Array.isArray(e.records)?c.value=e.records:c.value=[]}catch(e){console.error("Error loading facilities:",e),c.value=[]}});const u=n(()=>o.map(e=>"referringFacilityName"===e.name?{...e,options:c.value.map(e=>{const a=e.name||e.facility_name||"Unknown";return{name:a,label:a,value:e.id||e.facility_id||a,code:e.code||e.facility_code,district:e.district||e.district_name}})}:e)),m=e=>{if(!s)return;s.referredFromOtherFacility=e.referredFromAnotherFacility||"",s.referredFrom=qe(e.referredFrom)||"";const a=e.referringFacilityName;s.referringFacilityName=(null==a?void 0:a.name)||We(a||""),s.modeOfTransport=qe(e.modeOfTransport)||"",s.admittedFrom=qe(e.admittedFrom)||""};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&m(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&m(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),T(K,{formData:u.value,ref_key:"formRef",ref:t},null,8,["formData"]))}}),Je=t({__name:"BirthAssessment",setup(e,{expose:a}){const t=l(null),n=ie[2].formData,o=r(se),s=e=>{o&&(o.criedAfterBirth=e.criedAfterBirth||"",o.apgarScoreAt1=qe(e.apgar1)||"",o.apgarScoreAt5=qe(e.apgar5)||"",o.apgarScoreAt10=qe(e.apgar10)||"",o.resuscitationMethods=Ke(e.resuscitationMethods))};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),T(K,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Xe={class:"mother-search-container"},ea={style:{border:"1px dotted #ececec","border-radius":"8px"}},aa={class:"header-with-icon"},ta={class:"icon-wrapper"},ra=["src"],la={class:"search-with-button"},na={class:"search-wrapper"},ia={class:"barcode-btn","aria-label":"Scan MRN"},oa={key:0,class:"search-results"},sa={key:0,class:"search-loading"},da={key:1,class:"results-list"},ca=["onClick"],ua={class:"result-header"},ma={class:"mother-name"},va={class:"mother-dob"},fa={class:"mother-gender"},pa={class:"result-details"},ga={key:0,class:"mother-address"},ha={key:1,class:"mother-phone"},ba={key:0,class:"pagination"},ya={class:"page-info"},wa={key:2,class:"no-results"},xa={key:1,class:"selected-mother"},ka={class:"selected-card"},_a={class:"selected-card-header"},Fa={class:"selected-header-with-button"},Na={class:"selected-card-content"},Da={class:"selected-info"},Ia={key:0},Sa={key:1},Va=U(t({__name:"MotherSearch",setup(e,{expose:a}){const t=z(),F=A(),T=r(se),C=ce(),$=l(""),j=l(!1),B=l([]),L=l(null),H=l(1),U=async()=>{await new Promise(e=>setTimeout(e,50));const e=C.motherData;e&&e.patientID&&(L.value=e,await new Promise(e=>setTimeout(e,100)),C.clearEnrollmentContext())};V(async()=>{await U()}),i(()=>F.query.motherAdded,async e=>{e&&await U()}),i(L,e=>{e&&T&&(T.motherPatientId=e.patientID,T.motherName=`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),T.motherNationalId=e.nationalId||"")});const q=n(()=>Math.ceil(B.value.length/10)),K=n(()=>{const e=10*(H.value-1),a=e+10;return B.value.slice(e,a)}),W=async()=>{if(!$.value||$.value.trim().length<2)B.value=[];else{j.value=!0,H.value=1;try{const e=$.value.trim().split(" "),a={given_name:e[0],family_name:e[1]||"",page:"1",per_page:"50"},t=await G.search(a);B.value=Array.isArray(t)?t.filter(e=>{var a;const t=(null===(a=e.person)||void 0===a?void 0:a.gender)||e.gender;return"F"===t||"Female"===t}).map(e=>{var a,t,r;const l=e.person,n=(null===(a=l.names)||void 0===a?void 0:a[0])||{},i=(null===(t=l.addresses)||void 0===t?void 0:t[0])||{},o=null===(r=l.person_attributes)||void 0===r?void 0:r.find(e=>{var a;return"Cell Phone Number"===(null===(a=e.person_attribute_type)||void 0===a?void 0:a.name)});return{patientID:l.person_id,firstName:n.given_name||"",middleName:n.middle_name||"",lastName:n.family_name||"",gender:l.gender,birthdate:l.birthdate,nationalId:e.national_id||"",address:i,phone:(null==o?void 0:o.value)||""}}):[]}catch(e){console.error("Error searching for mothers:",e),B.value=[]}finally{j.value=!1}}},Y=()=>{L.value=null,T&&(T.motherPatientId=void 0,T.motherName=void 0,T.motherNationalId=void 0)},Q=()=>{var e;const a=r("patient");a&&null!==(e=a.value)&&void 0!==e&&e.patientID&&C.setMotherCreationContext(a.value.patientID,4),t.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},Z=()=>{H.value<q.value&&H.value++},J=()=>{H.value>1&&H.value--},X=e=>e?new Date(e).toLocaleDateString():"",ee=e=>{if(!e)return"";if("string"==typeof e)return e;const a=[];return e.city_village&&a.push(e.city_village),e.township_division&&a.push(e.township_division),e.state_province&&a.push(e.state_province),a.join(", ")};return a({getFormRef:()=>({validate:()=>null!==L.value,getFormData:()=>{var e,a;return{motherPatientId:null===(e=L.value)||void 0===e?void 0:e.patientID,motherName:L.value?`${L.value.firstName} ${L.value.middleName||""} ${L.value.lastName}`.trim():void 0,motherNationalId:null===(a=L.value)||void 0===a?void 0:a.nationalId}}}),validateForm:()=>L.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>L.value?{motherPatientId:L.value.patientID,motherName:`${L.value.firstName} ${L.value.middleName||""} ${L.value.lastName}`.trim(),motherNationalId:L.value.nationalId}:{}}),(e,a)=>(d(),o("div",Xe,[c("div",ea,[u(m(v),null,{default:f(()=>[c("div",aa,[c("div",ta,[c("img",{src:m(de).icons.care,alt:"Care",class:"header-icon"},null,8,ra),u(m(p),{icon:m(g),class:"search-badge-icon"},null,8,["icon"])]),c("div",null,[u(m(h),null,{default:f(()=>[...a[1]||(a[1]=[b("Search for Mother",-1)])]),_:1}),u(m(y),null,{default:f(()=>[...a[2]||(a[2]=[b("Find mother's existing record",-1)])]),_:1})])])]),_:1}),u(m(w),null,{default:f(()=>[u(m(x),{class:"info-note"},{default:f(()=>[...a[3]||(a[3]=[b(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),c("div",la,[c("div",na,[u(m(k),{modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value=e),placeholder:"Search for mother's Name or scan MRN",onIonInput:W,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),c("div",ia,[u(m(p),{color:"primary",size:"small",icon:m(R),slot:"icon-only"},null,8,["icon"])])]),u(m(_),{color:"success",onClick:Q,class:"new-registration-btn"},{default:f(()=>[u(m(p),{icon:m(P),slot:"icon-only"},null,8,["icon"]),a[4]||(a[4]=b("New Registration ",-1))]),_:1})]),$.value&&$.value.length>0&&!L.value?(d(),o("div",oa,[j.value?(d(),o("div",sa,[(d(),o(N,null,D(3,e=>c("div",{key:`skeleton-${e}`,class:"result-item-skeleton"},[...a[5]||(a[5]=[c("div",{class:"skeleton-header"},[c("div",{class:"skeleton-name"}),c("div",{class:"skeleton-dob"}),c("div",{class:"skeleton-gender"})],-1),c("div",{class:"skeleton-details"},[c("div",{class:"skeleton-address"}),c("div",{class:"skeleton-phone"})],-1)])])),64))])):B.value.length>0?(d(),o("div",da,[(d(!0),o(N,null,D(K.value,(e,t)=>(d(),o("div",{key:e.patientID||t,class:"result-item",onClick:a=>(e=>{L.value=e,$.value="",T&&(T.motherPatientId=e.patientID,T.motherName=`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),T.motherNationalId=e.nationalId||"")})(e)},[c("div",ua,[c("span",ma,I(e.firstName)+" "+I(e.middleName?e.middleName+" ":"")+I(e.lastName),1),c("span",va,"DOB "+I(X(e.birthdate)),1),c("span",fa,I("F"===e.gender?"Female":e.gender),1)]),c("div",pa,[e.address?(d(),o("p",ga,[a[6]||(a[6]=c("strong",null,"Current Address:",-1)),b(" "+I(ee(e.address)),1)])):s("",!0),e.phone?(d(),o("p",ha,[u(m(p),{icon:m(E)},null,8,["icon"]),b(" "+I(e.phone),1)])):s("",!0)])],8,ca))),128)),q.value>1?(d(),o("div",ba,[u(m(_),{fill:"outline",size:"small",onClick:J,disabled:1===H.value},{default:f(()=>[u(m(p),{icon:m(M)},null,8,["icon"])]),_:1},8,["disabled"]),c("span",ya,"Page "+I(H.value)+" of "+I(q.value),1),u(m(_),{fill:"outline",size:"small",onClick:Z,disabled:H.value===q.value},{default:f(()=>[u(m(p),{icon:m(O)},null,8,["icon"])]),_:1},8,["disabled"])])):s("",!0)])):(d(),o("div",wa,[u(m(p),{icon:m(g),class:"no-results-icon"},null,8,["icon"]),c("p",null,'No mothers found matching "'+I($.value)+'"',1),u(m(_),{expand:"block",onClick:Q},{default:f(()=>[...a[7]||(a[7]=[b("Register new mother",-1)])]),_:1})]))])):s("",!0),L.value?(d(),o("div",xa,[c("div",ka,[c("div",_a,[c("div",Fa,[a[8]||(a[8]=c("span",{class:"selected-subtitle"},"Selected Mother",-1)),u(m(_),{fill:"clear",size:"small",color:"danger",onClick:Y,class:"clear-selection-btn"},{default:f(()=>[u(m(p),{icon:m(S),slot:"icon-only"},null,8,["icon"])]),_:1})])]),c("div",Na,[c("div",Da,[c("h3",null,I(L.value.firstName)+" "+I(L.value.middleName?L.value.middleName+" ":"")+I(L.value.lastName),1),c("p",null,[a[9]||(a[9]=c("strong",null,"MRN:",-1)),b(" "+I(L.value.patientID),1)]),L.value.birthdate?(d(),o("p",Ia,[a[10]||(a[10]=c("strong",null,"DOB:",-1)),b(" "+I(X(L.value.birthdate)),1)])):s("",!0),L.value.address?(d(),o("p",Sa,[a[11]||(a[11]=c("strong",null,"Address:",-1)),b(" "+I(ee(L.value.address)),1)])):s("",!0)])])])])):s("",!0)]),_:1})])]))}}),[["__scopeId","data-v-2bf8e305"]]),Ta=t({__name:"Pregnancy",setup(e,{expose:a}){const t=l(null),n=ie[4].formData,o=r(se),s=e=>{o&&(o.gestationWeeks=We(e.gestationWeeks||""),o.steroidsGiven=e.steroidsGiven||"",o.gestationMethodAssessment=qe(e.gestationMethodAssessment)||"",o.ultraSoundScanning=e.ultraSoundScanning||"",o.onsetOfLabor=We(e.onsetOfLabor||""),o.ruptureOfMembranes=e.ruptureOfMembranes||"",o.durationOfRuptureMembranes=qe(e.durationOfRuptureMembranes)||"",o.offensiveLiquor=e.offensiveLiquor||"",o.modeOfDelivery=qe(e.modeOfDelivery)||"",o.meconiumPresent=e.meconiumPresent||"",o.maternalAnalgesia=e.maternalAnalgesia||"",o.analgesiasDrug=qe(e.analgesiasDrug)||"",o.anesthesiaUsed=e.anesthesiaUsed||"",o.teo=e.teo||"",o.chlorohexidineCordCare=e.chlorohexidineCordCare||"",o.vitaminKGiven=e.vitaminKGiven||"",o.dextroseGiven=e.dextroseGiven||"")};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),T(K,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),za=t({__name:"MotherEnrollmentDetails",setup(e,{expose:a}){const t=l(null),n=ie[5].formData,o=r(se),s=e=>{o&&(o.motherStatus=e.motherStatus||"",o.motherHivStatus=qe(e.motherHivStatus)||"",o.lastHivTestDate=We(e.lastHivTestDate||""),o.doHivRetest=e.doHivRetest||"",o.babyGivenNvp=e.babyGivenNvp||"",o.motherVdrlResult=qe(e.motherVdrlResult)||"",o.motherTreatedForVdrl=e.motherTreatedForVdrl||"",o.babyTestedForHepatitis=e.babyTestedForHepatitis||"",o.allThreeDosesCompleted=e.allThreeDosesCompleted||"",o.motherHepatitisResult=qe(e.motherHepatitisResult)||"")};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),T(K,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Aa=t({__name:"KnownMedicalConditions",setup(e,{expose:a}){const t=l(null),n=ie[6].formData,o=r(se),s=e=>{o&&(o.tetanusDiphtheria=Ke(e.tetanusDiphtheria))};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),T(K,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Ra=t({name:"NeonatalEnrollment",components:{IonPage:$,IonContent:C,Toolbar:W,DemographicBar:ne,NeonatalStepper:oe,BirthDetails:Qe,ReferralInformation:Ze,BirthAssessment:Je,MotherSearch:Va,Pregnancy:Ta,MotherEnrollmentDetails:za,KnownMedicalConditions:Aa},setup(){const e=z(),a=H(),{patient:t}=j(a),r=l(!1),n=ce(),o=()=>{var e;const a=(e=>{const a=Number(e);return Number.isFinite(a)?a:null})(null===(e=t.value)||void 0===e?void 0:e.patientID);n.initializeEnrollmentForm(a)};o(),i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.patientID},()=>o());const s=n.enrollmentForm;B(se,s),i(()=>n.enrollmentForm,()=>n.saveEnrollmentSnapshot(),{deep:!0});const d=l(ie.map((e,a)=>({title:e.title,number:a+1,checked:!1,class:0===a?"open_step common_step":"common_step",last_step:a===ie.length-1?"last_step":""}))),c=[{title:ie[0].title,value:"1",component:Qe},{title:ie[1].title,value:"2",component:Ze},{title:ie[2].title,value:"3",component:Je},{title:ie[3].title,value:"4",component:Va},{title:ie[4].title,value:"5",component:Ta},{title:ie[5].title,value:"6",component:za},{title:ie[6].title,value:"7",component:Aa}];return{router:e,patient:t,enrollmentFormData:s,stepperTitle:"Profiling",currentOpenStepper:"1",wizardData:d,stepperData:c,updateStatus:e=>{e&&e.value&&d.value.forEach((a,t)=>{e.value===(t+1).toString()?(a.class="open_step common_step",a.checked=!1):t<parseInt(e.value)-1?(a.class="common_step color_white",a.checked=!0):(a.class="common_step",a.checked=!1)})},getSaveFunction:a=>a===c.length-1?async()=>{var a;if(null!==(a=t.value)&&void 0!==a&&a.patientID){if(!r.value)try{if(r.value=!0,!s.birthWeight||!s.timeOfBirth)return Y("Please complete required birth details"),void(r.value=!1);if(s.motherPatientId)try{const e=(await Q.getRelations()).find(e=>"Mother"===e.b_is_to_a||"Parent"===e.b_is_to_a);e&&await Q.createRelation(t.value.patientID,s.motherPatientId,e.relationship_type_id)}catch(l){console.error("Failed to create mother-baby relationship",l)}const a=await le.buildEnrollmentObservations(s,Z.sessionDate());console.log("[Enrollment] observations count:",null==a?void 0:a.length),console.log("[Enrollment] saving encounter with ID:",J.NEONATAL_ENROLLMENT),console.log("[Enrollment] current program_id from Service.getProgramID():",X.getProgramID());const n=await ee(t.value.patientID,J.NEONATAL_ENROLLMENT,a);console.log("[Enrollment] save result:",n),console.log("[Enrollment] session date used:",Z.sessionDate()),await ae.userProgramData(t.value.patientID),te("Neonate enrolled successfully"),await new Promise(e=>setTimeout(e,1e3));const i=Z.sessionDate();console.log("[Enrollment] Checking saved encounters for date:",i);const o=await le.getSavedEncounters(t.value.patientID,i);console.log("[Enrollment] encountersResponse after delay:",o);const d=Array.isArray(null==o?void 0:o.encounters)?o.encounters:[];console.log("[Enrollment] encounters array:",d),console.log("[Enrollment] encounter type names:",d.map(e=>"string"==typeof e?e:(null==e?void 0:e.name)||e)),d.some(e=>"NEONATAL TRIAGE"===(null==e?void 0:e.trim().toUpperCase()))?e.push("/neonatal/patient-profile"):e.push("/neonatal/checkpoint")}catch(n){console.error("Neonatal enrollment failed",n),re("Failed to enroll neonate. Please try again."),r.value=!1}}else Y("No patient selected")}:null,isEnrolling:r}}});e("default",U(Ra,[["render",function(e,a,t,r,l,n){const i=L("Toolbar"),o=L("NeonatalStepper"),s=L("ion-content"),c=L("ion-page");return d(),T(c,{class:"neonatal-enrollment-page"},{default:f(()=>[u(i),u(s,{fullscreen:!0},{default:f(()=>[u(o,{wizardData:e.wizardData,StepperData:e.stepperData,stepperTitle:e.stepperTitle,openStepper:e.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:e.getSaveFunction,flowType:"enrollment",onUpdateStatus:e.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}],["__scopeId","data-v-50ae1bd0"]]))}}});
