import{d as B,r as G,a as F,w as T,e as b,f as p,k as I,F as L,P as M,l as c,J as m,Q as N,K as C,u,bv as Y,f6 as j,di as z,f7 as $,cf as J,c2 as W,f8 as X,f9 as K,O as E,a3 as Q,bp as w,aT as U,al as q,ak as Z,_ as f,m as y,L as ee,W as S,bw as ae,aj as te,by as le,Y as P,b1 as se,a6 as re}from"./vendor-BpjEhVym.js";import{_ as ne,$ as o,cb as i,T as ie,bG as ue}from"../index-CiSAd7V7.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DMAoEdNS.js";const de={class:"clinic-days-selector"},oe={class:"days-container"},ce=B({__name:"ClinicDaysSelector",props:{modelValue:{}},emits:["update:modelValue","change"],setup(H,{emit:l}){const v=H,_=l,A=[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],g=G([]);F(()=>{if(v.modelValue)try{try{const t=JSON.parse(v.modelValue);Array.isArray(t)?g.value=t:g.value=v.modelValue.split(",").map(e=>e.trim())}catch(t){g.value=v.modelValue.split(",").map(e=>e.trim())}}catch(t){console.error("Error parsing clinic days:",t),g.value=[]}});const a=t=>{const e=g.value.indexOf(t);e===-1?g.value.push(t):g.value.splice(e,1);const s=g.value.join(",");_("update:modelValue",s),_("change",s)};return T(()=>v.modelValue,t=>{if(t)try{try{const e=JSON.parse(t);Array.isArray(e)?g.value=e:g.value=t.split(",").map(s=>s.trim())}catch(e){g.value=t.split(",").map(s=>s.trim())}}catch(e){console.error("Error parsing clinic days:",e),g.value=[]}else g.value=[]}),(t,e)=>(p(),b("div",de,[I("div",oe,[(p(),b(L,null,M(A,s=>I("div",{key:s.value,class:"day-checkbox"},[c(u(Y),{value:s.value,checked:g.value.includes(s.value),onIonChange:n=>a(s.value),labelPlacement:"end"},{default:m(()=>[N(C(s.label),1)]),_:2},1032,["value","checked","onIonChange"])])),64))])]))}}),me=ne(ce,[["__scopeId","data-v-95b0e034"]]),ve={class:"ion-padding",slot:"content"},ge={key:0},_e={key:1},pe={key:2},ye={class:"ion-padding"},be={key:3},Ne={class:"ion-padding"},Ae=B({__name:"ARTPreferences",setup(H){const l=G({}),v=async(a,t,e)=>{if(l.value[e]){const s=!!a;l.value[e].data[t]=s,l.value[e].isLoading=!0,l.value[e].statusMessage=void 0;try{await o.set(t,s?"true":"false"),console.log("Successfully saved ".concat(t," with value: ").concat(s))}catch(n){console.error("Error saving ".concat(t,":"),n),l.value[e].statusMessage="Failed to save: ".concat(n instanceof Error?n.message:"Unknown error")}finally{l.value[e].isLoading=!1}}},_=async(a,t,e,s=!1)=>{if(l.value[e]){l.value[e].data[t]=a,l.value[e].isLoading=!0,l.value[e].statusMessage=void 0;try{let n=a;if(a&&typeof a=="object"&&"value"in a&&(n=a.label),s&&typeof n=="string"){const h=Number(n);if(isNaN(h)){l.value[e].statusMessage="Please enter a valid number",l.value[e].isLoading=!1;return}}await o.set(t,n)}catch(n){console.error("Error saving ".concat(t,":"),n),l.value[e].statusMessage="Failed to save: ".concat(n instanceof Error?n.message:"Unknown error")}finally{l.value[e].isLoading=!1}}},A=[{icon:j,title:"Filing Numbers",options:[{id:i.FILING_NUMBERS,title:"Enabled Filing Number",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.FILING_NUMBER_LIMIT,title:"Filing Number Limit",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<1||s>1e3){l.value[e].statusMessage="Filing number limit should be between 1 and 1000";return}_(a,t,e,!0)}}]},{icon:z,title:"Appointments",options:[{id:i.APPOINTMENT_LIMIT,title:"Appointment Limit",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<1||s>500){l.value[e].statusMessage="Appointment limit should be between 1 and 500";return}_(a,t,e,!0)}},{id:i.ADULT_CLINIC_DAYS,title:"Clinic days (adults: 18 yrs and over)",type:"clinic-days",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>_(a,t,e,!1)},{id:i.PEADS_CLINIC_DAYS,title:"Clinic days (children: Under 18 yrs)",type:"clinic-days",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>_(a,t,e,!1)}]},{icon:$,title:"Clinic Preferences",options:[{id:i.IS_DIC_SITE,title:"Is Military Site",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)}]},{icon:J,title:"Viral load Preferences",options:[{id:i.VL_ROUTINE_CHECK,title:"Activate VL routine check",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.CAN_SCAN_DBS_BARCODE,title:"Scan DBS barcode",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)}]},{icon:W,title:"Lab preferences",options:[{id:i.EXTENDED_LABS,title:"Activate Extended Labs",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.TARGET_LAB,title:"Target lab",type:"facility",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>_(a,t,e,!1)},{id:i.LAB_ORDER_PRINT_COPIES,title:"Specify number of copies to print after an order",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<1||s>10){l.value[e].statusMessage="Number of copies should be between 1 and 10";return}_(a,t,e,!0)}}]},{icon:X,title:"Hypertension Preferences",options:[{id:i.HTN_ENHANCEMENT,title:"Activate Hypertension screening",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.HTN_DIASTOLIC_THRESHOLD,title:"Set diastolic blood pressure minimum threshold",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<40||s>120){l.value[e].statusMessage="Diastolic BP should be between 40 and 120 mmHg";return}_(a,t,e,!0)}},{id:i.HTN_SYSTOLIC_THRESHOLD,title:"Set systolic blood pressure minimum threshold",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<70||s>220){l.value[e].statusMessage="Systolic BP should be between 70 and 220 mmHg";return}_(a,t,e,!0)}},{id:i.HTN_SCREENING_AGE_THRESHOLD,title:"Set HTN Age",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<10||s>100){l.value[e].statusMessage="Age threshold should be between 10 and 100 years";return}_(a,t,e,!0)}}]},{icon:K,title:"Cervical Cancer Preferences",onOpen:async()=>{var e;l.value["Cervical Cancer Preferences"].data={[i.CERVICAL_CANCER_AGE_BOUNDS]:await o.get(i.CERVICAL_CANCER_AGE_BOUNDS)||""};const[a,t]=((e=l.value["Cervical Cancer Preferences"].data[i.CERVICAL_CANCER_AGE_BOUNDS])!=null?e:"0:0").split(":").map(Number);l.value["Cervical Cancer Preferences"].data.min_cervical_age=a,l.value["Cervical Cancer Preferences"].data.max_cervical_age=t},options:[{id:i.CERVICAL_CANCER_SCREENING,title:"Activate Cervical Cancer Screening",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:"min_cervical_age",title:"Starting screening age",type:"input",get:()=>l.value["Cervical Cancer Preferences"].data.min_cervical_age||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter valid min age";return}if(s<10||s>100){l.value[e].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age";return}const n=l.value[e].data.max_cervical_age;if(n&&s>=Number(n)){l.value[e].statusMessage="Minimum age should be less than the maximum age";return}_("".concat(s,":").concat(n),i.CERVICAL_CANCER_AGE_BOUNDS,e,!1)}},{id:"max_cervical_age",title:"Maximum screening age",type:"input",get:()=>l.value["Cervical Cancer Preferences"].data.max_cervical_age||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter valid max age";return}if(s<10||s>100){l.value[e].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age";return}const n=l.value[e].data.min_cervical_age;if(n&&s<Number(n)){l.value[e].statusMessage="Maximum age should be less than the minimum age";return}_("".concat(n,":").concat(s),i.CERVICAL_CANCER_AGE_BOUNDS,e,!1)}}]},{icon:$,title:"Other Preferences",options:[{id:i.PILLS_REMAINING,title:"Ask pills remaining at home",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.THREE_HP_AUTO_SELECT,title:"Activate 3HP auto select",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.EXCLUDE_EXTERNAL_AND_DRUG_REFILLS,title:"(DATA CLEANING) Exclude External and Emergency supply",type:"toggle",get:a=>o.isProp("".concat(a,"=true")),dataHandler:(a,t,e)=>v(a,t,e)},{id:i.NOTIFICATION_PERIOD,title:"Set Auto Cleaning Alert Days",type:"input",get:a=>o.get(a)||"",dataHandler:(a,t,e)=>{const s=Number(a);if(isNaN(s)){l.value[e].statusMessage="Please enter a valid number";return}if(s<1||s>365){l.value[e].statusMessage="Notification period should be between 1 and 365 days";return}_(a,t,e,!0)}}]}];async function g(a){const t=A.find(e=>e.title===a);if(t){l.value[t.title]||(l.value[t.title]={isLoading:!1,data:{},statusMessage:void 0}),l.value[t.title].isLoading=!0,t.onOpen&&await t.onOpen().catch(s=>{console.error("Error loading ".concat(t.title," settings:"),s),l.value[t.title].statusMessage="Failed to load settings: ".concat(s instanceof Error?s.message:"Unknown error")});const e=await Promise.all(t.options.map(async s=>({[s.id]:await s.get(s.id)})));l.value[t.title].data={...l.value[t.title].data,...e.reduce((s,n)=>({...s,...n}),{})},l.value[t.title].isLoading=!1}}return(a,t)=>(p(),E(u(re),null,{default:m(()=>[c(ie),c(u(Q),{class:"ion-padding"},{default:m(()=>[c(u(w),{style:{margin:"0px auto",width:"70%"}},{default:m(()=>[c(u(U),null,{default:m(()=>[c(u(q),{onIonChange:t[0]||(t[0]=e=>g(e.detail.value))},{default:m(()=>[(p(),b(L,null,M(A,(e,s)=>c(u(Z),{key:s,class:"ion-padding",value:e.title},{default:m(()=>[c(u(f),{slot:"header"},{default:m(()=>{var n,h,r;return[c(u(ee),{size:"large",icon:e.icon},null,8,["icon"]),c(u(S),{style:{padding:"10px"}},{default:m(()=>[N(C(e.title),1)]),_:2},1024),(r=(h=(n=l.value)==null?void 0:n[e.title])==null?void 0:h.isLoading)!=null&&r?(p(),E(u(ae),{key:0,name:"dots",size:"small",slot:"end"})):y("",!0)]}),_:2},1024),I("div",ve,[c(u(w),null,{default:m(()=>[c(u(U),null,{default:m(()=>{var n,h;return[(h=(n=l.value)==null?void 0:n[e.title])!=null&&h.data?(p(),E(u(te),{key:0,style:{background:"white"}},{default:m(()=>[(p(!0),b(L,null,M(e.options,r=>{var V,D,R,k,O,x;return p(),b("div",{key:r.id},[r.type==="toggle"?(p(),b("div",ge,[c(u(f),{color:"light"},{default:m(()=>[c(u(S),null,{default:m(()=>[N(C(r.title),1)]),_:2},1024),c(u(le),{"onUpdate:modelValue":[d=>r.dataHandler(d,r.id,e.title),d=>l.value[e.title].data[r.id]=d],modelValue:l.value[e.title].data[r.id],size:"large",slot:"end","enable-on-off-labels":!0},null,8,["onUpdate:modelValue","modelValue"])]),_:2},1024),(V=l.value[e.title])!=null&&V.statusMessage?(p(),E(u(P),{key:0,color:"danger"},{default:m(()=>{var d;return[N(C((d=l.value[e.title])==null?void 0:d.statusMessage),1)]}),_:2},1024)):y("",!0)])):y("",!0),r.type==="input"?(p(),b("div",_e,[c(u(se),{"label-placement":"stacked",onIonChange:d=>r.dataHandler(d.detail.value,r.id,e.title),modelValue:l.value[e.title].data[r.id],"onUpdate:modelValue":d=>l.value[e.title].data[r.id]=d,style:{"margin-top":"20px"},label:r.title,fill:"outline",placeholder:"Enter value",slot:"end"},null,8,["onIonChange","modelValue","onUpdate:modelValue","label"]),(D=l.value[e.title])!=null&&D.statusMessage?(p(),E(u(P),{key:0,color:"danger"},{default:m(()=>{var d;return[N(C((d=l.value[e.title])==null?void 0:d.statusMessage),1)]}),_:2},1024)):y("",!0)])):y("",!0),r.type==="clinic-days"?(p(),b("div",pe,[c(u(f),{color:"light"},{default:m(()=>[c(u(S),null,{default:m(()=>[N(C(r.title),1)]),_:2},1024)]),_:2},1024),I("div",ye,[c(me,{modelValue:l.value[e.title].data[r.id],"onUpdate:modelValue":d=>l.value[e.title].data[r.id]=d,onChange:d=>r.dataHandler(d,r.id,e.title)},null,8,["modelValue","onUpdate:modelValue","onChange"]),(R=l.value[e.title])!=null&&R.statusMessage?(p(),E(u(P),{key:0,color:"danger"},{default:m(()=>{var d;return[N(C((d=l.value[e.title])==null?void 0:d.statusMessage),1)]}),_:2},1024)):y("",!0)])])):y("",!0),r.type==="facility"?(p(),b("div",be,[c(u(f),{color:"light"},{default:m(()=>[c(u(S),null,{default:m(()=>[N(C(r.title),1)]),_:2},1024)]),_:2},1024),I("div",Ne,[c(ue,{label:(O=(k=l.value[e.title].data[r.id])==null?void 0:k.label)!=null?O:l.value[e.title].data[r.id],modelValue:l.value[e.title].data[r.id],"onUpdate:modelValue":d=>l.value[e.title].data[r.id]=d,onOnChange:d=>r.dataHandler(d,r.id,e.title),"error-message":(x=l.value[e.title])==null?void 0:x.statusMessage},null,8,["label","modelValue","onUpdate:modelValue","onOnChange","error-message"])])])):y("",!0)])}),128))]),_:2},1024)):y("",!0)]}),_:2},1024)]),_:2},1024)])]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Ae as default};
