import{d as q,a4 as ze,a5 as xe,aP as ue,aS as Le,N as J,aZ as Te,aY as Ge,f7 as Ue,aU as We,bJ as Ie,H as z,O as G,f as v,J as F,l as p,k as a,K as S,e as y,F as X,P as ee,p as ve,m as A,i as qe,bS as Qe,Q as B,v as Ke,eO as Q,r as k,c as re,w as V,u as c,aR as Be,L as E,bj as se,cv as $e,aQ as Ce,Y as Re,bE as Ve,cG as Oe,a as Pe,an as Ae,f8 as je,bk as Je,f9 as Ze,d8 as Xe,a3 as et,a6 as tt,aV as at,bw as ot,eP as nt}from"./vendor-DoZkSJso.js";import{J as rt,i as st,m as _e,t as Me,_ as ne,l as I,u as me,P as Ye,aC as Z,L as it,T as lt,b4 as ye,H as ct,ab as dt,G as ut}from"../index-D-jLU0JI.js";import{N as mt}from"./neonatal_service-D5LGxKwh.js";import{D as pt}from"./DemographicBar-D0jn5OqL.js";import{S as ge}from"./SaveProgressModal-D7yb750N.js";import{I as de}from"./images-DCsUI3iU.js";import{u as ht}from"./NeonatalEnrollmentStore-CRXyCJpY.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BgIpHCiE.js";const ft=q({name:"NeonatalStepper",components:{IonButton:J,IonCard:Le,IonCardContent:ue,IonCol:xe,IonRow:ze,DynamicButton:rt},data(){return{currentStepIndex:0,stepRefs:new Map}},props:{wizardData:{default:[]},StepperData:{default:[]},stepperTitle:{type:String,default:""},openStepper:{type:String,default:"1"},backBtn:{type:String,default:"Back to profile"},backUrl:{type:String,default:""},getSaveFunction:{type:Function,required:!0}},setup(){return{chevronBackOutline:Ie,checkmark:We,closeOutline:Ue}},mounted(){const e=parseInt(this.openStepper)-1;this.currentStepIndex=e>=0?e:0},methods:{setStepRef(e,i){e&&this.stepRefs.set(i,e)},chevronBack(){return Ge},chevronForward(){return Te},openBackController(){this.backUrl?this.$router.push(this.backUrl):_e(ge)},async nextStep(e){const i=await this.validateCurrentStep(e);if(i){const n=Object.values(i).join(", ");Me("Please fix the following errors: ".concat(n));return}const o=this.getSaveFunction(e);o&&typeof o=="function"&&await o();const u=e+1;u<this.StepperData.length&&(this.currentStepIndex=u,this.updateWizardStatus(u),this.$emit("updateStatus",{value:this.StepperData[u].value}))},async validateCurrentStep(e){const i=this.stepRefs.get(e);return i?typeof i.validateForm=="function"?i.validateForm():null:(console.warn("No component instance found for step ".concat(e)),null)},previousStep(e){const i=e-1;i>=0&&(this.currentStepIndex=i,this.updateWizardStatus(i),this.$emit("updateStatus",{value:this.StepperData[i].value}))},async handleCancel(){await st("Are you sure you want to cancel? All unsaved progress will be lost.",{header:"Cancel Neonatal Enrollment",confirmBtnLabel:"Yes, Cancel",cancelBtnLabel:"No, Continue"})&&(this.backUrl?this.$router.push(this.backUrl):_e(ge))},updateWizardStatus(e){this.wizardData.forEach((i,o)=>{o===e?(i.class="open_step common_step",i.checked=!1):o<e?(i.class="common_step color_white",i.checked=!0):(i.class="common_step",i.checked=!1)})}}}),vt={class:"wizard_title"},_t={id:"wizard_verticle",class:"form_wizard wizard_verticle"},yt={class:"list-unstyled wizard_steps anchor"},gt={class:"done",isdone:"1",rel:"1"},bt={key:1,class:""},St={class:"wizard_text"},Ft={class:"back_profile"},wt={class:"stepper_content_wrapper"},Dt={class:"section_header"},Nt={class:"section_content"},kt={class:"button-row"},Tt={class:"left-button-group"},It={class:"right-button-group"};function Bt(e,i,o,u,n,_){const t=z("ion-icon"),l=z("ion-card-content"),r=z("ion-card"),s=z("ion-col"),w=z("DynamicButton"),h=z("ion-button"),C=z("ion-row");return v(),G(C,null,{default:F(()=>[p(s,{"size-md":"4","size-xl":"2.5","size-sm":"0","size-lg":"4","offset-sm":"0","offset-md":"0.4","offset-xl":"0.8",class:"displayNoneMobile"},{default:F(()=>[p(r,{class:"wizard_card"},{default:F(()=>[a("div",vt,[a("strong",null,S(e.stepperTitle),1)]),p(l,null,{default:F(()=>[a("div",_t,[a("ul",yt,[(v(!0),y(X,null,ee(e.wizardData,(T,D)=>(v(),y("li",{key:D,class:ve(T.last_step)},[a("a",gt,[a("span",{class:ve(T.class)},[T.checked?(v(),G(t,{key:0,icon:e.checkmark,class:"checked_step"},null,8,["icon"])):A("",!0),T.checked?A("",!0):(v(),y("span",bt,S(T.number),1)),a("span",St,S(T.title),1)],2)])],2))),128))])])]),_:1})]),_:1})]),_:1}),p(s,{"size-sm":"12","size-xl":"7","size-md":"7.2","size-lg":"7","offset-sm":"0","offset-md":"0.4","offset-xl":"0.8"},{default:F(()=>[a("div",Ft,[p(w,{name:e.backBtn,iconSlot:"start",fill:"clear",icon:e.chevronBackOutline,onClick:i[0]||(i[0]=T=>e.openBackController())},null,8,["name","icon"])]),a("div",wt,[(v(!0),y(X,null,ee(e.StepperData,(T,D)=>qe((v(),y("div",{key:D,class:"step_section"},[a("div",Dt,[a("h2",null,S(T.title),1)]),a("div",Nt,[(v(),G(Qe(T.component),{ref_for:!0,ref:R=>e.setStepRef(R,D)},null,512))]),a("div",kt,[a("div",Tt,[D===0?(v(),G(h,{key:0,class:"cancel-button",onClick:e.handleCancel},{default:F(()=>[p(t,{icon:e.closeOutline,slot:"start"},null,8,["icon"]),i[1]||(i[1]=B(" Cancel ",-1))]),_:1},8,["onClick"])):(v(),G(h,{key:1,class:"previous-button",onClick:R=>e.previousStep(D)},{default:F(()=>[p(t,{icon:e.chevronBack(),slot:"start"},null,8,["icon"]),i[2]||(i[2]=B(" Previous ",-1))]),_:1},8,["onClick"]))]),a("div",It,[p(h,{class:"next-button",onClick:R=>e.nextStep(D)},{default:F(()=>[B(S(D<e.StepperData.length-1?"Next":"Finish")+" ",1),p(t,{icon:D<e.StepperData.length-1?e.chevronForward():e.checkmark,slot:"end"},null,8,["icon"])]),_:2},1032,["onClick"])])])])),[[Ke,e.currentStepIndex===D]])),128))])]),_:1})]),_:1})}const $t=ne(ft,[["render",Bt],["__scopeId","data-v-21d48500"]]),Y=e=>e.map(i=>({value:i,label:i})),le=(e,i)=>Array.from({length:i-e+1},(o,u)=>{const n=(e+u).toString();return{value:n,label:n}}),Ct=["Stimulation","Suctioning","Oxygen","Bag Valve Mask Ventilation (BVM)","Cardio Pulmonary Resuscitation (CPR)","Unknown","None"],P=[{title:"Birth details",subtitle:"Capture the initial arrival information",formData:[{componentType:"radioButtonField",header:"Does the baby have a twin?",name:"hasTwin",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether the neonate has a twin"},{componentType:"multiSelectInputField",header:"Place of Birth",name:"placeOfBirth",placeholder:"Select type",icon:I.search,options:Y(["Hospital","Health Center","Home","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the place of birth"},{componentType:"multiSelectInputField",header:"Name of Birth Facility",name:"birthFacility",placeholder:"Select facility",icon:I.search,options:Y(["Lilongwe Central","Queen Elizabeth","District Hospital","Community Clinic"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select a facility"},{componentType:"multiSelectInputField",header:"Type of Birth",name:"typeOfBirth",placeholder:"Select type",icon:I.search,options:Y(["Singleton","Twin","Triplet"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the type of birth"},{componentType:"inputField",header:"Birth weight (grams)",name:"birthWeight",type:"number",placeholder:"Enter weight",validation:e=>Number(e)>0?null:"Provide the birth weight"},{componentType:"timeInputField",header:"Time of birth",name:"birthTime",placeholder:"HH:mm",validation:e=>e?null:"Capture the time of birth"}]},{title:"Referral information",subtitle:"Document how the neonate arrived",description:"Required when the baby was referred from another facility.",formData:[{componentType:"radioButtonField",header:"Is the baby referred from another facility?",name:"referredFromAnotherFacility",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Indicate whether the neonate was referred"},{componentType:"multiSelectInputField",header:"Referred from",name:"referredFrom",placeholder:"Select referee type",icon:I.search,options:Y(["District Hospital","Health Center","Private Clinic","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the referral source",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Name of facility",name:"referringFacilityName",placeholder:"Search and select facility",icon:I.search,options:[],trackBy:"name",validation:(e,i)=>(i==null?void 0:i.referredFromAnotherFacility)!=="Yes"||e!=null&&e.name||e?null:"Select the referring facility",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Mode of transport",name:"modeOfTransport",placeholder:"Select mode",icon:I.search,options:Y(["Ambulance","Private vehicle","Bicycle","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select how the neonate arrived",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Admitted from",name:"admittedFrom",placeholder:"Select origin",icon:I.search,options:Y(["Clinic","Home","Maternity Ward","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select where the baby was admitted from",condition:e=>e.referredFromAnotherFacility==="Yes"}]},{title:"Birth assessment",subtitle:"Capture the immediate clinical state",formData:[{componentType:"radioButtonField",header:"Did the baby cry straight after birth?",name:"criedAfterBirth",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Indicate whether the baby cried"},{componentType:"multiSelectInputField",header:"Apgar score at 1 minute",name:"apgar1",placeholder:"Select",icon:I.search,options:le(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 1 min"},{componentType:"multiSelectInputField",header:"Apgar score at 5 minutes",name:"apgar5",placeholder:"Select",icon:I.search,options:le(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 5 min"},{componentType:"multiSelectInputField",header:"Apgar score at 10 minutes",name:"apgar10",placeholder:"Select",icon:I.search,options:le(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 10 min"},{componentType:"multiSelectInputField",header:"Was resuscitation needed at birth?",name:"resuscitationMethods",placeholder:"Select the methods",icon:I.search,options:Y(Ct),trackBy:"value",isMultiple:!0,closeOnSelect:!1,validation:e=>e&&e.length?null:"Select at least one method"}]},{title:"Mother's Information",subtitle:"Search and link the mother's record",description:"Find the mother's existing record or register a new mother if not found.",formData:[]},{title:"Pregnancy",subtitle:"Pregnancy and delivery history",formData:[{componentType:"inputField",header:"Gestation in weeks",name:"gestationWeeks",type:"number",placeholder:"Weeks",validation:e=>{const i=Number(e);return i>0&&i<=45?null:"Enter valid gestation weeks (1-45)"}},{componentType:"radioButtonField",header:"Were steroids given?",name:"steroidsGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether steroids were given"},{componentType:"multiSelectInputField",header:"Gestation method assessment",name:"gestationMethodAssessment",placeholder:"Select method",icon:I.search,options:Y(["LMP","Ultrasound","Clinical Assessment","Ballard Score"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select gestation assessment method"},{componentType:"radioButtonField",header:"Ultra sound scanning - USS",name:"ultraSoundScanning",options:[{label:"Early",value:"Early"},{label:"Late",value:"Late"}],validation:e=>e?null:"Select ultrasound timing"},{componentType:"timeInputField",header:"Onset of labor",name:"onsetOfLabor",placeholder:"HH:mm",validation:e=>e?null:"Enter onset of labor time"},{componentType:"radioButtonField",header:"Rupture of membranes?",name:"ruptureOfMembranes",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify rupture of membranes status"},{componentType:"radioButtonField",header:"Duration of Rupture of Membranes",name:"durationOfRuptureMembranes",options:[{label:"< 18 hours",value:"< 18 hours"},{label:"18 hours >",value:"18 hours >"}],validation:e=>e?null:"Select duration",condition:e=>e.ruptureOfMembranes==="Yes"},{componentType:"radioButtonField",header:"Offensive Liquor?",name:"offensiveLiquor",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify offensive liquor status"},{componentType:"multiSelectInputField",header:"Mode of Delivery",name:"modeOfDelivery",placeholder:"Select mode",icon:I.search,options:Y(["Spontaneous Vaginal Delivery","Caesarean Section","Vacuum Extraction","Forceps Delivery","Breech Delivery"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select mode of delivery"},{componentType:"radioButtonField",header:"Meconium present?",name:"meconiumPresent",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify meconium presence"},{componentType:"radioButtonField",header:"Maternal Analgesia?",name:"maternalAnalgesia",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify maternal analgesia status"},{componentType:"multiSelectInputField",header:"Analgesia Drug",name:"analgesiasDrug",placeholder:"Select drug",icon:I.search,options:Y(["Paracetamol","Pethidine","Morphine","Epidural","Other"]),trackBy:"value",validation:(e,i)=>(i==null?void 0:i.maternalAnalgesia)!=="Yes"||e!=null&&e.value||e?null:"Select analgesia drug",condition:e=>e.maternalAnalgesia==="Yes"},{componentType:"radioButtonField",header:"Anesthesia used?",name:"anesthesiaUsed",options:[{label:"General",value:"General"},{label:"Spinal",value:"Spinal"},{label:"No",value:"No"}],validation:e=>e?null:"Specify anesthesia used"},{componentType:"radioButtonField",header:"TEO?",name:"teo",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify TEO status"},{componentType:"radioButtonField",header:"Chlorohexidine of cord care?",name:"chlorohexidineCordCare",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify chlorohexidine cord care"},{componentType:"radioButtonField",header:"Vitamin K given?",name:"vitaminKGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify Vitamin K status"},{componentType:"radioButtonField",header:"Dextrose 10% given?",name:"dextroseGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify Dextrose 10% status"}]},{title:"Mother's enrollment details",subtitle:"HIV, VDRL, and Hepatitis status",formData:[{componentType:"radioButtonField",header:"Mother's status",name:"motherStatus",options:[{label:"Alive",value:"Alive"},{label:"Died",value:"Died"}],validation:e=>e?null:"Select mother's status"},{componentType:"multiSelectInputField",header:"HIV Status",name:"motherHivStatus",placeholder:"Select status",icon:I.search,options:Y(["Reactive","Non-Reactive","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select HIV status"},{componentType:"dateInputField",header:"Last HIV Test Date",name:"lastHivTestDate",placeholder:"Select date",validation:e=>e?null:"Select the last HIV test date"},{componentType:"radioButtonField",header:"Do a HIV re-test?",name:"doHivRetest",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether to do HIV re-test"},{componentType:"radioButtonField",header:"Who baby given NVP?",name:"babyGivenNvp",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether baby was given NVP"},{componentType:"multiSelectInputField",header:"Mother's VDRL/Syphilis result",name:"motherVdrlResult",placeholder:"Select result",icon:I.search,options:Y(["Positive","Negative","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select VDRL/Syphilis result"},{componentType:"radioButtonField",header:"Who mother treated for VDRL/Syphilis?",name:"motherTreatedForVdrl",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether mother was treated"},{componentType:"radioButtonField",header:"Was the baby tested for Hepatitis?",name:"babyTestedForHepatitis",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether baby was tested"},{componentType:"radioButtonField",header:"Were all 3 doses of the treatment completed?",name:"allThreeDosesCompleted",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether all doses were completed"},{componentType:"multiSelectInputField",header:"Mother's Hepatitis result",name:"motherHepatitisResult",placeholder:"Select result",icon:I.search,options:Y(["Positive","Negative","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select Hepatitis result"}]},{title:"Known Medical Conditions",subtitle:"Tetanus vaccination history",formData:[{componentType:"multiSelectInputField",header:"Tetanus Diphtheria",name:"tetanusDiphtheria",placeholder:"Search and select",icon:I.search,options:Y(["Td1","Td2","Td3","Td4","Td5","Unknown","None"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select Tetanus Diphtheria status"}]}],Rt={motherPatientId:void 0,motherName:void 0,motherNationalId:void 0,hasTwin:"",twinPatientId:void 0,twinName:void 0,placeOfBirth:"",nameOfBirthFacility:"",typeOfBirth:"",birthWeight:"",timeOfBirth:"",referredFromOtherFacility:"",referredFrom:"",referringFacilityName:"",modeOfTransport:"",admittedFrom:"",criedAfterBirth:"",apgarScoreAt1:"",apgarScoreAt5:"",apgarScoreAt10:"",resuscitationMethods:[],gestationWeeks:"",steroidsGiven:"",gestationMethodAssessment:"",ultraSoundScanning:"",onsetOfLabor:"",ruptureOfMembranes:"",durationOfRuptureMembranes:"",offensiveLiquor:"",modeOfDelivery:"",meconiumPresent:"",maternalAnalgesia:"",analgesiasDrug:"",anesthesiaUsed:"",teo:"",chlorohexidineCordCare:"",vitaminKGiven:"",dextroseGiven:"",motherStatus:"",motherHivStatus:"",lastHivTestDate:"",doHivRetest:"",babyGivenNvp:"",motherVdrlResult:"",motherTreatedForVdrl:"",babyTestedForHepatitis:"",allThreeDosesCompleted:"",motherHepatitisResult:"",tetanusDiphtheria:[]},K=Symbol("neonatal-enrollment-form"),Vt={key:0,class:"twin-search-container"},Ot={style:{border:"1px dotted #ececec","border-radius":"8px"}},Pt={class:"header-with-icon"},At={class:"icon-wrapper"},Mt=["src"],Yt={class:"search-with-button"},Ht={class:"search-wrapper"},Et={key:0,class:"search-results"},zt={key:0,class:"search-loading"},xt={key:1,class:"results-list"},Lt=["onClick"],Gt={class:"result-header"},Ut={class:"twin-name"},Wt={class:"twin-mrn"},qt={class:"twin-dob"},Qt={class:"result-details"},Kt={key:0,class:"twin-gender"},jt={key:2,class:"no-results"},Jt={key:1,class:"selected-twin"},Zt={class:"selected-card"},Xt={class:"selected-card-header"},ea={class:"header-content"},ta={class:"selected-icon-wrapper"},aa=["src"],oa={class:"selected-card-content"},na={class:"patient-info-grid"},ra={class:"info-row"},sa={class:"info-value"},ia={class:"info-row"},la={class:"info-value"},ca={key:0,class:"info-row"},da={class:"info-value"},ua={key:1,class:"info-row"},ma={class:"info-value"},pa=q({__name:"TwinSearch",setup(e,{expose:i}){const o=Q(K),u=me(),n=k(""),_=k(!1),t=k([]),l=k(null),r=k(!1),s=re(()=>(o==null?void 0:o.hasTwin)==="Yes"),w=async()=>{if(!n.value||n.value.trim().length<2){t.value=[];return}_.value=!0;try{const g=n.value.trim();if(/^\d+$/.test(g))try{const m=await u.getPatientData(Number(g));if(m&&m.personInformation){const b=m.personInformation;t.value=[{patientID:b.person_id,firstName:b.given_name||"",middleName:b.middle_name||"",lastName:b.family_name||"",gender:b.gender,birthdate:b.birthdate}]}else t.value=[]}catch(m){console.error("Error searching by MRN:",m),t.value=[]}else{const m=g.split(" "),b={given_name:m[0],family_name:m[1]||"",page:"1",per_page:"20"},M=await Ye.search(b);t.value=Array.isArray(M)?M.filter(U=>{const H=U.person;if(!H.birthdate)return!1;const j=new Date(H.birthdate);return Math.floor((Date.now()-j.getTime())/(1e3*60*60*24))<=7}).map(U=>{var d;const H=U.person,j=((d=H.names)==null?void 0:d[0])||{};return{patientID:H.person_id,firstName:j.given_name||"",middleName:j.middle_name||"",lastName:j.family_name||"",gender:H.gender,birthdate:H.birthdate}}):[]}}catch(g){console.error("Error searching for twin:",g),t.value=[]}finally{_.value=!1}},h=g=>{l.value=g,n.value="",r.value=!1,o&&(o.twinPatientId=g.patientID,o.twinName="".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim())},C=()=>{l.value=null,r.value=!1,o&&(o.twinPatientId=void 0,o.twinName=void 0)},T=()=>{r.value=!0,l.value=null,n.value="",o&&(o.twinPatientId=void 0,o.twinName=void 0)};V(()=>o==null?void 0:o.hasTwin,g=>{g!=="Yes"&&(C(),r.value=!1)});const D=g=>"".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim(),R=g=>g?new Date(g).toLocaleDateString():"";return i({validateForm:()=>(o==null?void 0:o.hasTwin)==="Yes"&&!l.value&&!r.value?{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"}:null,getFormValues:()=>l.value?{twinPatientId:l.value.patientID,twinName:D(l.value)}:{}}),(g,m)=>s.value?(v(),y("div",Vt,[a("div",Ot,[p(c(Be),null,{default:F(()=>[a("div",Pt,[a("div",At,[a("img",{src:c(de).icons.twins,alt:"Twin",class:"header-icon"},null,8,Mt),p(c(E),{icon:c(se),class:"search-badge-icon"},null,8,["icon"])]),a("div",null,[p(c($e),null,{default:F(()=>[...m[1]||(m[1]=[B("Twin Information",-1)])]),_:1}),p(c(Ce),null,{default:F(()=>[...m[2]||(m[2]=[B("Search for twin sibling",-1)])]),_:1})])])]),_:1}),p(c(ue),null,{default:F(()=>[p(c(Re),{class:"info-note"},{default:F(()=>[...m[3]||(m[3]=[B(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),a("div",Yt,[a("div",Ht,[p(c(Ve),{modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=b=>n.value=b),placeholder:"Search for twin's MRN or scan barcode",onIonInput:w,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),p(c(J),{color:"primary",onClick:T,class:"skip-btn"},{default:F(()=>[m[4]||(m[4]=B(" Skip ",-1)),p(c(E),{size:"small",icon:c(Te),slot:"end"},null,8,["icon"])]),_:1})]),n.value&&n.value.length>0&&!l.value?(v(),y("div",Et,[_.value?(v(),y("div",zt,[(v(),y(X,null,ee(3,b=>a("div",{key:"skeleton-".concat(b),class:"result-item-skeleton"},[...m[5]||(m[5]=[a("div",{class:"skeleton-header"},[a("div",{class:"skeleton-name"}),a("div",{class:"skeleton-dob"})],-1)])])),64))])):t.value.length>0?(v(),y("div",xt,[(v(!0),y(X,null,ee(t.value,(b,M)=>(v(),y("div",{key:b.patientID||M,class:"result-item",onClick:U=>h(b)},[a("div",Gt,[a("span",Ut,S(D(b)),1),a("span",Wt,"MRN: "+S(b.patientID),1),a("span",qt,"DOB: "+S(R(b.birthdate)),1)]),a("div",Qt,[b.gender?(v(),y("p",Kt,[m[6]||(m[6]=a("strong",null,"Gender:",-1)),B(" "+S(b.gender),1)])):A("",!0)])],8,Lt))),128))])):(v(),y("div",jt,[p(c(E),{icon:c(se),class:"no-results-icon"},null,8,["icon"]),a("p",null,'No patients found matching "'+S(n.value)+'"',1),m[7]||(m[7]=a("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):A("",!0),l.value?(v(),y("div",Jt,[a("div",Zt,[a("div",Xt,[a("div",ea,[a("div",ta,[a("img",{src:c(de).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,aa)]),m[8]||(m[8]=a("div",{class:"header-separator"},null,-1)),m[9]||(m[9]=a("span",{class:"selected-subtitle"},"Twin Selected",-1))]),p(c(J),{fill:"clear",size:"small",onClick:C,class:"clear-selection-btn"},{default:F(()=>[p(c(E),{icon:c(Oe)},null,8,["icon"])]),_:1})]),a("div",oa,[a("div",na,[a("div",ra,[m[10]||(m[10]=a("span",{class:"info-label"},"Full Name",-1)),a("span",sa,S(D(l.value)),1)]),a("div",ia,[m[11]||(m[11]=a("span",{class:"info-label"},"MRN",-1)),a("span",la,S(l.value.patientID),1)]),l.value.birthdate?(v(),y("div",ca,[m[12]||(m[12]=a("span",{class:"info-label"},"Date of Birth",-1)),a("span",da,S(R(l.value.birthdate)),1)])):A("",!0),l.value.gender?(v(),y("div",ua,[m[13]||(m[13]=a("span",{class:"info-label"},"Gender",-1)),a("span",ma,S(l.value.gender),1)])):A("",!0)])])])])):A("",!0)]),_:1})])])):A("",!0)}}),ha=ne(pa,[["__scopeId","data-v-9ecea754"]]),$=e=>{var i,o,u;if(!(e==null||e==="")){if(typeof e=="string"||typeof e=="number")return e.toString();if(typeof e=="object"){const n=(u=(o=(i=e.label)!=null?i:e.value)!=null?o:e.name)!=null?u:e.title;if(n!=null&&n!=="")return n.toString()}}},He=e=>{if(!e)return[];if(Array.isArray(e))return e.map(o=>$(o)).filter(o=>!!o);const i=$(e);return i?[i]:[]},te=e=>e==null?"":e.toString(),fa={class:"birth-details-wrapper"},va=q({__name:"BirthDetails",setup(e,{expose:i}){const o=k(null),u=k(null),n=k(null),_=P[0].formData,t=_.slice(0,1),l=_.slice(1),r=Q(K),s=h=>{r&&(r.hasTwin=h.hasTwin||"")},w=h=>{r&&(r.placeOfBirth=$(h.placeOfBirth)||"",r.nameOfBirthFacility=$(h.birthFacility)||"",r.typeOfBirth=$(h.typeOfBirth)||"",r.birthWeight=te(h.birthWeight||""),r.timeOfBirth=te(h.birthTime||""))};return V(()=>{var h;return(h=u.value)==null?void 0:h.formValues},h=>{h&&w(h)},{deep:!0}),V(()=>u.value,h=>{h!=null&&h.getFormValues&&w(h.getFormValues())},{immediate:!0}),V(()=>{var h;return(h=o.value)==null?void 0:h.formValues},h=>{h&&s(h)},{deep:!0}),V(()=>o.value,h=>{h!=null&&h.getFormValues&&s(h.getFormValues())},{immediate:!0}),i({getFormRef:()=>u.value,getTwinQuestionFormRef:()=>o.value,validateForm:()=>{var R,g,m,b,M,U;const h=((g=(R=o.value)==null?void 0:R.validateForm)==null?void 0:g.call(R))||null,C=((b=(m=u.value)==null?void 0:m.validateForm)==null?void 0:b.call(m))||null,T=((U=(M=n.value)==null?void 0:M.validateForm)==null?void 0:U.call(M))||null,D=[h,C,T].filter(Boolean);return D.length?D.reduce((H,j)=>({...H,...j}),{}):null},getFormValues:()=>{var D,R,g,m,b,M;const h=((R=(D=o.value)==null?void 0:D.getFormValues)==null?void 0:R.call(D))||{},C=((m=(g=u.value)==null?void 0:g.getFormValues)==null?void 0:m.call(g))||{},T=((M=(b=n.value)==null?void 0:b.getFormValues)==null?void 0:M.call(b))||{};return{...h,...C,...T}}}),(h,C)=>(v(),y("div",fa,[p(Z,{formData:c(t),ref_key:"twinQuestionFormRef",ref:o,class:"twin-question-form"},null,8,["formData"]),p(ha,{ref_key:"twinSearchRef",ref:n},null,512),p(Z,{formData:c(l),ref_key:"formRef",ref:u,class:"main-form"},null,8,["formData"])]))}}),be=ne(va,[["__scopeId","data-v-1a647a53"]]),Se=q({__name:"ReferralInformation",setup(e,{expose:i}){const o=k(null),u=P[1].formData,n=Q(K),_=k([]);Pe(async()=>{try{const r=await it.getAllFacilities();Array.isArray(r)?_.value=r:r!=null&&r.facilities&&Array.isArray(r.facilities)?_.value=r.facilities:r!=null&&r.records&&Array.isArray(r.records)?_.value=r.records:_.value=[]}catch(r){console.error("Error loading facilities:",r),_.value=[]}});const t=re(()=>u.map(r=>r.name==="referringFacilityName"?{...r,options:_.value.map(s=>({name:s.name||s.facility_name||"Unknown",code:s.code||s.facility_code,district:s.district}))}:r)),l=r=>{if(!n)return;n.referredFromOtherFacility=r.referredFromAnotherFacility||"",n.referredFrom=$(r.referredFrom)||"";const s=r.referringFacilityName;n.referringFacilityName=(s==null?void 0:s.name)||te(s||""),n.modeOfTransport=$(r.modeOfTransport)||"",n.admittedFrom=$(r.admittedFrom)||""};return V(()=>{var r;return(r=o.value)==null?void 0:r.formValues},r=>{r&&l(r)},{deep:!0}),V(()=>o.value,r=>{r!=null&&r.getFormValues&&l(r.getFormValues())},{immediate:!0}),i({getFormRef:()=>o.value,validateForm:()=>{var r,s;return((s=(r=o.value)==null?void 0:r.validateForm)==null?void 0:s.call(r))||null},getFormValues:()=>{var r,s;return((s=(r=o.value)==null?void 0:r.getFormValues)==null?void 0:s.call(r))||{}}}),(r,s)=>(v(),G(Z,{formData:t.value,ref_key:"formRef",ref:o},null,8,["formData"]))}}),Fe=q({__name:"BirthAssessment",setup(e,{expose:i}){const o=k(null),u=P[2].formData,n=Q(K),_=t=>{n&&(n.criedAfterBirth=t.criedAfterBirth||"",n.apgarScoreAt1=$(t.apgar1)||"",n.apgarScoreAt5=$(t.apgar5)||"",n.apgarScoreAt10=$(t.apgar10)||"",n.resuscitationMethods=He(t.resuscitationMethods))};return V(()=>{var t;return(t=o.value)==null?void 0:t.formValues},t=>{t&&_(t)},{deep:!0}),V(()=>o.value,t=>{t!=null&&t.getFormValues&&_(t.getFormValues())},{immediate:!0}),i({getFormRef:()=>o.value,validateForm:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),G(Z,{formData:c(u),ref_key:"formRef",ref:o},null,8,["formData"]))}}),_a={class:"mother-search-container"},ya={style:{border:"1px dotted #ececec","border-radius":"8px"}},ga={class:"header-with-icon"},ba={class:"icon-wrapper"},Sa=["src"],Fa={class:"search-with-button"},wa={class:"search-wrapper"},Da={class:"barcode-btn","aria-label":"Scan MRN"},Na={key:0,class:"search-results"},ka={key:0,class:"search-loading"},Ta={key:1,class:"results-list"},Ia=["onClick"],Ba={class:"result-header"},$a={class:"mother-name"},Ca={class:"mother-dob"},Ra={class:"mother-gender"},Va={class:"result-details"},Oa={key:0,class:"mother-address"},Pa={key:1,class:"mother-phone"},Aa={key:0,class:"pagination"},Ma={class:"page-info"},Ya={key:2,class:"no-results"},Ha={key:1,class:"selected-mother"},Ea={class:"selected-card"},za={class:"selected-card-header"},xa={class:"selected-header-with-button"},La={class:"selected-card-content"},Ga={class:"selected-info"},Ua={key:0},Wa={key:1},ce=10,qa=q({__name:"MotherSearch",setup(e,{expose:i}){const o=Ae(),u=Q(K),n=ht(),_=me(),t=k(""),l=k(!1),r=k([]),s=k(null),w=k(1);Pe(async()=>{const d=n.getMotherPatientId;d&&n.shouldReturnToEnrollment&&(await h(d),n.clearEnrollmentContext())}),V(s,d=>{d&&u&&(u.motherPatientId=d.patientID,u.motherName="".concat(d.firstName," ").concat(d.middleName||""," ").concat(d.lastName).trim(),u.motherNationalId=d.nationalId||"")});const h=async d=>{var f,N;try{l.value=!0;const x=await _.getPatientData(d);if(x&&x.personInformation){const O=x.personInformation,L=((f=O.addresses)==null?void 0:f[0])||{},W=(N=O.person_attributes)==null?void 0:N.find(ae=>{var oe;return((oe=ae.person_attribute_type)==null?void 0:oe.name)==="Cell Phone Number"}),ie={patientID:O.person_id||d,firstName:O.given_name||"",middleName:O.middle_name||"",lastName:O.family_name||"",gender:O.gender,birthdate:O.birthdate,nationalId:x.national_id||"",address:L,phone:(W==null?void 0:W.value)||""};s.value=ie}}catch(x){console.error("Error fetching mother data:",x)}finally{l.value=!1}},C=re(()=>Math.ceil(r.value.length/ce)),T=re(()=>{const d=(w.value-1)*ce,f=d+ce;return r.value.slice(d,f)}),D=async()=>{if(!t.value||t.value.trim().length<2){r.value=[];return}l.value=!0,w.value=1;try{const f=t.value.trim().split(" "),N={given_name:f[0],family_name:f[1]||"",page:"1",per_page:"50"},x=await Ye.search(N);r.value=Array.isArray(x)?x.filter(O=>{var W;const L=((W=O.person)==null?void 0:W.gender)||O.gender;return L==="F"||L==="Female"}).map(O=>{var oe,pe,he;const L=O.person,W=((oe=L.names)==null?void 0:oe[0])||{},ie=((pe=L.addresses)==null?void 0:pe[0])||{},ae=(he=L.person_attributes)==null?void 0:he.find(Ee=>{var fe;return((fe=Ee.person_attribute_type)==null?void 0:fe.name)==="Cell Phone Number"});return{patientID:L.person_id,firstName:W.given_name||"",middleName:W.middle_name||"",lastName:W.family_name||"",gender:L.gender,birthdate:L.birthdate,nationalId:O.national_id||"",address:ie,phone:(ae==null?void 0:ae.value)||""}}):[]}catch(d){console.error("Error searching for mothers:",d),r.value=[]}finally{l.value=!1}},R=d=>{s.value=d,t.value="",u&&(u.motherPatientId=d.patientID,u.motherName="".concat(d.firstName," ").concat(d.middleName||""," ").concat(d.lastName).trim(),u.motherNationalId=d.nationalId||"")},g=()=>{s.value=null,u&&(u.motherPatientId=void 0,u.motherName=void 0,u.motherNationalId=void 0)},m=()=>{var f;const d=Q("patient");d&&((f=d.value)!=null&&f.patientID)&&n.setMotherCreationContext(d.value.patientID,4),o.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},b=()=>{w.value<C.value&&w.value++},M=()=>{w.value>1&&w.value--},U=d=>d?new Date(d).toLocaleDateString():"",H=d=>{if(!d)return"";if(typeof d=="string")return d;const f=[];return d.city_village&&f.push(d.city_village),d.township_division&&f.push(d.township_division),d.state_province&&f.push(d.state_province),f.join(", ")};return i({getFormRef:()=>({validate:()=>s.value!==null,getFormData:()=>{var d,f;return{motherPatientId:(d=s.value)==null?void 0:d.patientID,motherName:s.value?"".concat(s.value.firstName," ").concat(s.value.middleName||""," ").concat(s.value.lastName).trim():void 0,motherNationalId:(f=s.value)==null?void 0:f.nationalId}}}),validateForm:()=>s.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>s.value?{motherPatientId:s.value.patientID,motherName:"".concat(s.value.firstName," ").concat(s.value.middleName||""," ").concat(s.value.lastName).trim(),motherNationalId:s.value.nationalId}:{}}),(d,f)=>(v(),y("div",_a,[a("div",ya,[p(c(Be),null,{default:F(()=>[a("div",ga,[a("div",ba,[a("img",{src:c(de).icons.care,alt:"Care",class:"header-icon"},null,8,Sa),p(c(E),{icon:c(se),class:"search-badge-icon"},null,8,["icon"])]),a("div",null,[p(c($e),null,{default:F(()=>[...f[1]||(f[1]=[B("Search for Mother",-1)])]),_:1}),p(c(Ce),null,{default:F(()=>[...f[2]||(f[2]=[B("Find mother's existing record",-1)])]),_:1})])])]),_:1}),p(c(ue),null,{default:F(()=>[p(c(Re),{class:"info-note"},{default:F(()=>[...f[3]||(f[3]=[B(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),a("div",Fa,[a("div",wa,[p(c(Ve),{modelValue:t.value,"onUpdate:modelValue":f[0]||(f[0]=N=>t.value=N),placeholder:"Search for mother's Name or scan MRN",onIonInput:D,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),a("div",Da,[p(c(E),{color:"primary",size:"small",icon:c(je),slot:"icon-only"},null,8,["icon"])])]),p(c(J),{color:"success",onClick:m,class:"new-registration-btn"},{default:F(()=>[p(c(E),{icon:c(Je),slot:"icon-only"},null,8,["icon"]),f[4]||(f[4]=B("New Registration ",-1))]),_:1})]),t.value&&t.value.length>0&&!s.value?(v(),y("div",Na,[l.value?(v(),y("div",ka,[(v(),y(X,null,ee(3,N=>a("div",{key:"skeleton-".concat(N),class:"result-item-skeleton"},[...f[5]||(f[5]=[a("div",{class:"skeleton-header"},[a("div",{class:"skeleton-name"}),a("div",{class:"skeleton-dob"}),a("div",{class:"skeleton-gender"})],-1),a("div",{class:"skeleton-details"},[a("div",{class:"skeleton-address"}),a("div",{class:"skeleton-phone"})],-1)])])),64))])):r.value.length>0?(v(),y("div",Ta,[(v(!0),y(X,null,ee(T.value,(N,x)=>(v(),y("div",{key:N.patientID||x,class:"result-item",onClick:O=>R(N)},[a("div",Ba,[a("span",$a,S(N.firstName)+" "+S(N.middleName?N.middleName+" ":"")+S(N.lastName),1),a("span",Ca,"DOB "+S(U(N.birthdate)),1),a("span",Ra,S(N.gender==="F"?"Female":N.gender),1)]),a("div",Va,[N.address?(v(),y("p",Oa,[f[6]||(f[6]=a("strong",null,"Current Address:",-1)),B(" "+S(H(N.address)),1)])):A("",!0),N.phone?(v(),y("p",Pa,[p(c(E),{icon:c(Ze)},null,8,["icon"]),B(" "+S(N.phone),1)])):A("",!0)])],8,Ia))),128)),C.value>1?(v(),y("div",Aa,[p(c(J),{fill:"outline",size:"small",onClick:M,disabled:w.value===1},{default:F(()=>[p(c(E),{icon:c(Ie)},null,8,["icon"])]),_:1},8,["disabled"]),a("span",Ma,"Page "+S(w.value)+" of "+S(C.value),1),p(c(J),{fill:"outline",size:"small",onClick:b,disabled:w.value===C.value},{default:F(()=>[p(c(E),{icon:c(Xe)},null,8,["icon"])]),_:1},8,["disabled"])])):A("",!0)])):(v(),y("div",Ya,[p(c(E),{icon:c(se),class:"no-results-icon"},null,8,["icon"]),a("p",null,'No mothers found matching "'+S(t.value)+'"',1),p(c(J),{expand:"block",onClick:m},{default:F(()=>[...f[7]||(f[7]=[B("Register new mother",-1)])]),_:1})]))])):A("",!0),s.value?(v(),y("div",Ha,[a("div",Ea,[a("div",za,[a("div",xa,[f[8]||(f[8]=a("span",{class:"selected-subtitle"},"Selected Mother",-1)),p(c(J),{fill:"clear",size:"small",color:"danger",onClick:g,class:"clear-selection-btn"},{default:F(()=>[p(c(E),{icon:c(Oe),slot:"icon-only"},null,8,["icon"])]),_:1})])]),a("div",La,[a("div",Ga,[a("h3",null,S(s.value.firstName)+" "+S(s.value.middleName?s.value.middleName+" ":"")+S(s.value.lastName),1),a("p",null,[f[9]||(f[9]=a("strong",null,"MRN:",-1)),B(" "+S(s.value.patientID),1)]),s.value.birthdate?(v(),y("p",Ua,[f[10]||(f[10]=a("strong",null,"DOB:",-1)),B(" "+S(U(s.value.birthdate)),1)])):A("",!0),s.value.address?(v(),y("p",Wa,[f[11]||(f[11]=a("strong",null,"Address:",-1)),B(" "+S(H(s.value.address)),1)])):A("",!0)])])])])):A("",!0)]),_:1})])]))}}),we=ne(qa,[["__scopeId","data-v-0beac54f"]]),De=q({__name:"Pregnancy",setup(e,{expose:i}){const o=k(null),u=P[4].formData,n=Q(K),_=t=>{n&&(n.gestationWeeks=te(t.gestationWeeks||""),n.steroidsGiven=t.steroidsGiven||"",n.gestationMethodAssessment=$(t.gestationMethodAssessment)||"",n.ultraSoundScanning=t.ultraSoundScanning||"",n.onsetOfLabor=te(t.onsetOfLabor||""),n.ruptureOfMembranes=t.ruptureOfMembranes||"",n.durationOfRuptureMembranes=$(t.durationOfRuptureMembranes)||"",n.offensiveLiquor=t.offensiveLiquor||"",n.modeOfDelivery=$(t.modeOfDelivery)||"",n.meconiumPresent=t.meconiumPresent||"",n.maternalAnalgesia=t.maternalAnalgesia||"",n.analgesiasDrug=$(t.analgesiasDrug)||"",n.anesthesiaUsed=t.anesthesiaUsed||"",n.teo=t.teo||"",n.chlorohexidineCordCare=t.chlorohexidineCordCare||"",n.vitaminKGiven=t.vitaminKGiven||"",n.dextroseGiven=t.dextroseGiven||"")};return V(()=>{var t;return(t=o.value)==null?void 0:t.formValues},t=>{t&&_(t)},{deep:!0}),V(()=>o.value,t=>{t!=null&&t.getFormValues&&_(t.getFormValues())},{immediate:!0}),i({getFormRef:()=>o.value,validateForm:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),G(Z,{formData:c(u),ref_key:"formRef",ref:o},null,8,["formData"]))}}),Ne=q({__name:"MotherEnrollmentDetails",setup(e,{expose:i}){const o=k(null),u=P[5].formData,n=Q(K),_=t=>{n&&(n.motherStatus=t.motherStatus||"",n.motherHivStatus=$(t.motherHivStatus)||"",n.lastHivTestDate=te(t.lastHivTestDate||""),n.doHivRetest=t.doHivRetest||"",n.babyGivenNvp=t.babyGivenNvp||"",n.motherVdrlResult=$(t.motherVdrlResult)||"",n.motherTreatedForVdrl=t.motherTreatedForVdrl||"",n.babyTestedForHepatitis=t.babyTestedForHepatitis||"",n.allThreeDosesCompleted=t.allThreeDosesCompleted||"",n.motherHepatitisResult=$(t.motherHepatitisResult)||"")};return V(()=>{var t;return(t=o.value)==null?void 0:t.formValues},t=>{t&&_(t)},{deep:!0}),V(()=>o.value,t=>{t!=null&&t.getFormValues&&_(t.getFormValues())},{immediate:!0}),i({getFormRef:()=>o.value,validateForm:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),G(Z,{formData:c(u),ref_key:"formRef",ref:o},null,8,["formData"]))}}),ke=q({__name:"KnownMedicalConditions",setup(e,{expose:i}){const o=k(null),u=P[6].formData,n=Q(K),_=t=>{n&&(n.tetanusDiphtheria=He(t.tetanusDiphtheria))};return V(()=>{var t;return(t=o.value)==null?void 0:t.formValues},t=>{t&&_(t)},{deep:!0}),V(()=>o.value,t=>{t!=null&&t.getFormValues&&_(t.getFormValues())},{immediate:!0}),i({getFormRef:()=>o.value,validateForm:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=o.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),G(Z,{formData:c(u),ref_key:"formRef",ref:o},null,8,["formData"]))}}),Qa=q({name:"NeonatalEnrollment",components:{IonPage:tt,IonContent:et,Toolbar:lt,DemographicBar:pt,NeonatalStepper:$t,BirthDetails:be,ReferralInformation:Se,BirthAssessment:Fe,MotherSearch:we,Pregnancy:De,MotherEnrollmentDetails:Ne,KnownMedicalConditions:ke},setup(){const e=Ae(),i=me(),{patient:o}=at(i),u=ot({...Rt});nt(K,u);const n=k(P.map((r,s)=>({title:r.title,number:s+1,checked:!1,class:s===0?"open_step common_step":"common_step",last_step:s===P.length-1?"last_step":""}))),_=[{title:P[0].title,value:"1",component:be},{title:P[1].title,value:"2",component:Se},{title:P[2].title,value:"3",component:Fe},{title:P[3].title,value:"4",component:we},{title:P[4].title,value:"5",component:De},{title:P[5].title,value:"6",component:Ne},{title:P[6].title,value:"7",component:ke}];return{router:e,patient:o,enrollmentFormData:u,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:n,stepperData:_,updateStatus:r=>{r&&r.value&&n.value.forEach((s,w)=>{r.value===(w+1).toString()?(s.class="open_step common_step",s.checked=!1):w<parseInt(r.value)-1?(s.class="common_step color_white",s.checked=!0):(s.class="common_step",s.checked=!1)})},getSaveFunction:r=>r===_.length-1?async()=>{var s;if((s=o.value)!=null&&s.patientID)try{if(u.motherPatientId)try{const h=(await ye.getRelations()).find(C=>C.b_is_to_a==="Mother"||C.b_is_to_a==="Parent");h&&await ye.createRelation(o.value.patientID,u.motherPatientId,h.relationship_type_id)}catch(w){console.error("Failed to create mother-baby relationship",w)}await mt.enrollNeonate(o.value.patientID,u,ct.sessionDate()),await dt.userProgramData(o.value.patientID),ut("Neonate enrolled successfully"),e.push("/neonatal/triage")}catch(w){console.error("Neonatal enrollment failed",w),Me("Unable to enroll neonate at this time")}}:()=>{}}}});function Ka(e,i,o,u,n,_){const t=z("Toolbar"),l=z("DemographicBar"),r=z("NeonatalStepper"),s=z("ion-content"),w=z("ion-page");return v(),G(w,{class:"neonatal-enrollment-page"},{default:F(()=>[p(t),p(s,{fullscreen:!0},{default:F(()=>[p(l),p(r,{wizardData:e.wizardData,StepperData:e.stepperData,stepperTitle:e.stepperTitle,openStepper:e.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:e.getSaveFunction,onUpdateStatus:e.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const ro=ne(Qa,[["render",Ka],["__scopeId","data-v-1e8dda56"]]);export{ro as default};
