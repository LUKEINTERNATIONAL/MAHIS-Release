import{d as q,eO as L,r as N,c as ee,w as V,e as b,m as M,f as h,k as r,l as p,u,aR as Fe,J as k,L as E,bj as te,cv as we,Q as P,aQ as Ne,aP as Se,Y as ke,bF as Ie,N as K,aZ as Ae,F as ae,P as re,K as D,cG as $e,a as ie,O as j,an as Ve,f8 as Oe,bk as xe,f9 as Me,bK as Be,d8 as Ee,a3 as He,a6 as Ge,aV as ze,by as Qe,eP as Le,H as X}from"./vendor-ypQu15BZ.js";import{u as ue,P as Re,_ as oe,L as Te,aC as W,T as qe,t as fe,b4 as pe,H as Ue,ab as Ke,G as We,s as Ye}from"../index-BSR37024.js";import{N as je}from"./neonatal_service-DsioxO8h.js";import{D as Je}from"./DemographicBar-DOW7SAzM.js";import{n as U,a as C,N as Ze,d as Xe}from"./NeonatalStepper-DcnZmRSR.js";import{I as le}from"./images-CiU2O8T9.js";import{u as et}from"./NeonatalEnrollmentStore-CwfSBGBL.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DhCmsDNo.js";import"./SaveProgressModal-C-a5wGwY.js";const tt={key:0,class:"twin-search-container"},at={style:{border:"1px dotted #ececec","border-radius":"8px"}},rt={class:"header-with-icon"},ot={class:"icon-wrapper"},st=["src"],nt={class:"search-with-button"},lt={class:"search-wrapper"},it={key:0,class:"search-results"},ut={key:0,class:"search-loading"},ct={key:1,class:"results-list"},dt=["onClick"],mt={class:"result-header"},ft={class:"twin-name"},pt={class:"twin-mrn"},vt={class:"twin-dob"},ht={class:"result-details"},_t={key:0,class:"twin-gender"},gt={key:2,class:"no-results"},yt={key:1,class:"selected-twin"},bt={class:"selected-card"},Dt={class:"selected-card-header"},Ft={class:"header-content"},wt={class:"selected-icon-wrapper"},Nt=["src"],St={class:"selected-card-content"},kt={class:"patient-info-grid"},It={class:"info-row"},$t={class:"info-value"},Vt={class:"info-row"},Rt={class:"info-value"},Tt={key:0,class:"info-row"},Pt={class:"info-value"},Ct={key:1,class:"info-row"},At={class:"info-value"},Ot=q({__name:"TwinSearch",setup(f,{expose:F}){const a=L(U),m=ue(),t=N(""),_=N(!1),e=N([]),l=N(null),o=N(!1),s=ee(()=>(a==null?void 0:a.hasTwin)==="Yes"),v=async()=>{if(!t.value||t.value.trim().length<2){e.value=[];return}_.value=!0;try{const g=t.value.trim();if(/^\d+$/.test(g))try{const c=await m.getPatientData(Number(g));if(c&&c.personInformation){const y=c.personInformation;e.value=[{patientID:y.person_id,firstName:y.given_name||"",middleName:y.middle_name||"",lastName:y.family_name||"",gender:y.gender,birthdate:y.birthdate}]}else e.value=[]}catch(c){console.error("Error searching by MRN:",c),e.value=[]}else{const c=g.split(" "),y={given_name:c[0],family_name:c[1]||"",page:"1",per_page:"20"},O=await Re.search(y);e.value=Array.isArray(O)?O.filter(R=>{const I=R.person;if(!I.birthdate)return!1;const Q=new Date(I.birthdate);return Math.floor((Date.now()-Q.getTime())/(1e3*60*60*24))<=7}).map(R=>{var i;const I=R.person,Q=((i=I.names)==null?void 0:i[0])||{};return{patientID:I.person_id,firstName:Q.given_name||"",middleName:Q.middle_name||"",lastName:Q.family_name||"",gender:I.gender,birthdate:I.birthdate}}):[]}}catch(g){console.error("Error searching for twin:",g),e.value=[]}finally{_.value=!1}},A=g=>{l.value=g,t.value="",o.value=!1,a&&(a.twinPatientId=g.patientID,a.twinName="".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim())},x=()=>{l.value=null,o.value=!1,a&&(a.twinPatientId=void 0,a.twinName=void 0)},n=()=>{o.value=!0,l.value=null,t.value="",a&&(a.twinPatientId=void 0,a.twinName=void 0)};V(()=>a==null?void 0:a.hasTwin,g=>{g!=="Yes"&&(x(),o.value=!1)});const S=g=>"".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim(),B=g=>g?new Date(g).toLocaleDateString():"";return F({validateForm:()=>(a==null?void 0:a.hasTwin)==="Yes"&&!l.value&&!o.value?{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"}:null,getFormValues:()=>l.value?{twinPatientId:l.value.patientID,twinName:S(l.value)}:{}}),(g,c)=>s.value?(h(),b("div",tt,[r("div",at,[p(u(Fe),null,{default:k(()=>[r("div",rt,[r("div",ot,[r("img",{src:u(le).icons.twins,alt:"Twin",class:"header-icon"},null,8,st),p(u(E),{icon:u(te),class:"search-badge-icon"},null,8,["icon"])]),r("div",null,[p(u(we),null,{default:k(()=>[...c[1]||(c[1]=[P("Twin Information",-1)])]),_:1}),p(u(Ne),null,{default:k(()=>[...c[2]||(c[2]=[P("Search for twin sibling",-1)])]),_:1})])])]),_:1}),p(u(Se),null,{default:k(()=>[p(u(ke),{class:"info-note"},{default:k(()=>[...c[3]||(c[3]=[P(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),r("div",nt,[r("div",lt,[p(u(Ie),{modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=y=>t.value=y),placeholder:"Search for twin's MRN or scan barcode",onIonInput:v,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),p(u(K),{color:"primary",onClick:n,class:"skip-btn"},{default:k(()=>[c[4]||(c[4]=P(" Skip ",-1)),p(u(E),{size:"small",icon:u(Ae),slot:"end"},null,8,["icon"])]),_:1})]),t.value&&t.value.length>0&&!l.value?(h(),b("div",it,[_.value?(h(),b("div",ut,[(h(),b(ae,null,re(3,y=>r("div",{key:"skeleton-".concat(y),class:"result-item-skeleton"},[...c[5]||(c[5]=[r("div",{class:"skeleton-header"},[r("div",{class:"skeleton-name"}),r("div",{class:"skeleton-dob"})],-1)])])),64))])):e.value.length>0?(h(),b("div",ct,[(h(!0),b(ae,null,re(e.value,(y,O)=>(h(),b("div",{key:y.patientID||O,class:"result-item",onClick:R=>A(y)},[r("div",mt,[r("span",ft,D(S(y)),1),r("span",pt,"MRN: "+D(y.patientID),1),r("span",vt,"DOB: "+D(B(y.birthdate)),1)]),r("div",ht,[y.gender?(h(),b("p",_t,[c[6]||(c[6]=r("strong",null,"Gender:",-1)),P(" "+D(y.gender),1)])):M("",!0)])],8,dt))),128))])):(h(),b("div",gt,[p(u(E),{icon:u(te),class:"no-results-icon"},null,8,["icon"]),r("p",null,'No patients found matching "'+D(t.value)+'"',1),c[7]||(c[7]=r("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):M("",!0),l.value?(h(),b("div",yt,[r("div",bt,[r("div",Dt,[r("div",Ft,[r("div",wt,[r("img",{src:u(le).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,Nt)]),c[8]||(c[8]=r("div",{class:"header-separator"},null,-1)),c[9]||(c[9]=r("span",{class:"selected-subtitle"},"Twin Selected",-1))]),p(u(K),{fill:"clear",size:"small",onClick:x,class:"clear-selection-btn"},{default:k(()=>[p(u(E),{icon:u($e)},null,8,["icon"])]),_:1})]),r("div",St,[r("div",kt,[r("div",It,[c[10]||(c[10]=r("span",{class:"info-label"},"Full Name",-1)),r("span",$t,D(S(l.value)),1)]),r("div",Vt,[c[11]||(c[11]=r("span",{class:"info-label"},"MRN",-1)),r("span",Rt,D(l.value.patientID),1)]),l.value.birthdate?(h(),b("div",Tt,[c[12]||(c[12]=r("span",{class:"info-label"},"Date of Birth",-1)),r("span",Pt,D(B(l.value.birthdate)),1)])):M("",!0),l.value.gender?(h(),b("div",Ct,[c[13]||(c[13]=r("span",{class:"info-label"},"Gender",-1)),r("span",At,D(l.value.gender),1)])):M("",!0)])])])])):M("",!0)]),_:1})])])):M("",!0)}}),xt=oe(Ot,[["__scopeId","data-v-9ecea754"]]),$=f=>{var F,a,m;if(!(f==null||f==="")){if(typeof f=="string"||typeof f=="number")return f.toString();if(typeof f=="object"){const t=(m=(a=(F=f.label)!=null?F:f.value)!=null?a:f.name)!=null?m:f.title;if(t!=null&&t!=="")return t.toString()}}},Pe=f=>{if(!f)return[];if(Array.isArray(f))return f.map(a=>$(a)).filter(a=>!!a);const F=$(f);return F?[F]:[]},Y=f=>f==null?"":f.toString(),Mt={class:"birth-details-wrapper"},Bt=q({__name:"BirthDetails",setup(f,{expose:F}){const a=N(null),m=N(null),t=N(null),_=C[0].formData,e=_.slice(0,1),l=_.slice(1),o=L(U),s=N([]);ie(async()=>{try{const n=await Te.getAllFacilities();Array.isArray(n)?s.value=n:n!=null&&n.facilities&&Array.isArray(n.facilities)?s.value=n.facilities:n!=null&&n.records&&Array.isArray(n.records)?s.value=n.records:s.value=[]}catch(n){console.error("Error loading facilities:",n),s.value=[]}});const v=ee(()=>l.map(n=>n.name==="birthFacility"?{...n,options:s.value.map(S=>{const B=S.name||S.facility_name||"Unknown";return{name:B,label:B,value:S.id||S.facility_id||B,code:S.code||S.facility_code,district:S.district||S.district_name}})}:n)),A=n=>{o&&(o.hasTwin=n.hasTwin||"")},x=n=>{o&&(o.placeOfBirth=$(n.placeOfBirth)||"",o.nameOfBirthFacility=$(n.birthFacility)||"",o.typeOfBirth=$(n.typeOfBirth)||"",o.birthWeight=Y(n.birthWeight||""),o.timeOfBirth=Y(n.birthTime||""))};return V(()=>{var n;return(n=m.value)==null?void 0:n.formValues},n=>{n&&x(n)},{deep:!0}),V(()=>m.value,n=>{n!=null&&n.getFormValues&&x(n.getFormValues())},{immediate:!0}),V(()=>{var n;return(n=a.value)==null?void 0:n.formValues},n=>{n&&A(n)},{deep:!0}),V(()=>a.value,n=>{n!=null&&n.getFormValues&&A(n.getFormValues())},{immediate:!0}),F({getFormRef:()=>m.value,getTwinQuestionFormRef:()=>a.value,validateForm:()=>{var c,y,O,R,I,Q;const n=((y=(c=a.value)==null?void 0:c.validateForm)==null?void 0:y.call(c))||null,S=((R=(O=m.value)==null?void 0:O.validateForm)==null?void 0:R.call(O))||null,B=((Q=(I=t.value)==null?void 0:I.validateForm)==null?void 0:Q.call(I))||null,g=[n,S,B].filter(Boolean);return g.length?g.reduce((i,d)=>({...i,...d}),{}):null},getFormValues:()=>{var g,c,y,O,R,I;const n=((c=(g=a.value)==null?void 0:g.getFormValues)==null?void 0:c.call(g))||{},S=((O=(y=m.value)==null?void 0:y.getFormValues)==null?void 0:O.call(y))||{},B=((I=(R=t.value)==null?void 0:R.getFormValues)==null?void 0:I.call(R))||{};return{...n,...S,...B}}}),(n,S)=>(h(),b("div",Mt,[p(W,{formData:u(e),ref_key:"twinQuestionFormRef",ref:a,class:"twin-question-form"},null,8,["formData"]),p(xt,{ref_key:"twinSearchRef",ref:t},null,512),p(W,{formData:v.value,ref_key:"formRef",ref:m,class:"main-form"},null,8,["formData"])]))}}),ve=oe(Bt,[["__scopeId","data-v-9a714757"]]),he=q({__name:"ReferralInformation",setup(f,{expose:F}){const a=N(null),m=C[1].formData,t=L(U),_=N([]);ie(async()=>{try{const o=await Te.getAllFacilities();Array.isArray(o)?_.value=o:o!=null&&o.facilities&&Array.isArray(o.facilities)?_.value=o.facilities:o!=null&&o.records&&Array.isArray(o.records)?_.value=o.records:_.value=[]}catch(o){console.error("Error loading facilities:",o),_.value=[]}});const e=ee(()=>m.map(o=>o.name==="referringFacilityName"?{...o,options:_.value.map(s=>{const v=s.name||s.facility_name||"Unknown";return{name:v,label:v,value:s.id||s.facility_id||v,code:s.code||s.facility_code,district:s.district||s.district_name}})}:o)),l=o=>{if(!t)return;t.referredFromOtherFacility=o.referredFromAnotherFacility||"",t.referredFrom=$(o.referredFrom)||"";const s=o.referringFacilityName;t.referringFacilityName=(s==null?void 0:s.name)||Y(s||""),t.modeOfTransport=$(o.modeOfTransport)||"",t.admittedFrom=$(o.admittedFrom)||""};return V(()=>{var o;return(o=a.value)==null?void 0:o.formValues},o=>{o&&l(o)},{deep:!0}),V(()=>a.value,o=>{o!=null&&o.getFormValues&&l(o.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var o,s;return((s=(o=a.value)==null?void 0:o.validateForm)==null?void 0:s.call(o))||null},getFormValues:()=>{var o,s;return((s=(o=a.value)==null?void 0:o.getFormValues)==null?void 0:s.call(o))||{}}}),(o,s)=>(h(),j(W,{formData:e.value,ref_key:"formRef",ref:a},null,8,["formData"]))}}),_e=q({__name:"BirthAssessment",setup(f,{expose:F}){const a=N(null),m=C[2].formData,t=L(U),_=e=>{t&&(t.criedAfterBirth=e.criedAfterBirth||"",t.apgarScoreAt1=$(e.apgar1)||"",t.apgarScoreAt5=$(e.apgar5)||"",t.apgarScoreAt10=$(e.apgar10)||"",t.resuscitationMethods=Pe(e.resuscitationMethods))};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),Et={class:"mother-search-container"},Ht={style:{border:"1px dotted #ececec","border-radius":"8px"}},Gt={class:"header-with-icon"},zt={class:"icon-wrapper"},Qt=["src"],Lt={class:"search-with-button"},qt={class:"search-wrapper"},Ut={class:"barcode-btn","aria-label":"Scan MRN"},Kt={key:0,class:"search-results"},Wt={key:0,class:"search-loading"},Yt={key:1,class:"results-list"},jt=["onClick"],Jt={class:"result-header"},Zt={class:"mother-name"},Xt={class:"mother-dob"},ea={class:"mother-gender"},ta={class:"result-details"},aa={key:0,class:"mother-address"},ra={key:1,class:"mother-phone"},oa={key:0,class:"pagination"},sa={class:"page-info"},na={key:2,class:"no-results"},la={key:1,class:"selected-mother"},ia={class:"selected-card"},ua={class:"selected-card-header"},ca={class:"selected-header-with-button"},da={class:"selected-card-content"},ma={class:"selected-info"},fa={key:0},pa={key:1},ne=10,va=q({__name:"MotherSearch",setup(f,{expose:F}){const a=Ve(),m=L(U),t=et(),_=ue(),e=N(""),l=N(!1),o=N([]),s=N(null),v=N(1);ie(async()=>{const i=t.getMotherPatientId;i&&t.shouldReturnToEnrollment&&(await A(i),t.clearEnrollmentContext())}),V(s,i=>{i&&m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")});const A=async i=>{var d,w;try{l.value=!0;const H=await _.getPatientData(i);if(H&&H.personInformation){const T=H.personInformation,G=((d=T.addresses)==null?void 0:d[0])||{},z=(w=T.person_attributes)==null?void 0:w.find(J=>{var Z;return((Z=J.person_attribute_type)==null?void 0:Z.name)==="Cell Phone Number"}),se={patientID:T.person_id||i,firstName:T.given_name||"",middleName:T.middle_name||"",lastName:T.family_name||"",gender:T.gender,birthdate:T.birthdate,nationalId:H.national_id||"",address:G,phone:(z==null?void 0:z.value)||""};s.value=se}}catch(H){console.error("Error fetching mother data:",H)}finally{l.value=!1}},x=ee(()=>Math.ceil(o.value.length/ne)),n=ee(()=>{const i=(v.value-1)*ne,d=i+ne;return o.value.slice(i,d)}),S=async()=>{if(!e.value||e.value.trim().length<2){o.value=[];return}l.value=!0,v.value=1;try{const d=e.value.trim().split(" "),w={given_name:d[0],family_name:d[1]||"",page:"1",per_page:"50"},H=await Re.search(w);o.value=Array.isArray(H)?H.filter(T=>{var z;const G=((z=T.person)==null?void 0:z.gender)||T.gender;return G==="F"||G==="Female"}).map(T=>{var Z,ce,de;const G=T.person,z=((Z=G.names)==null?void 0:Z[0])||{},se=((ce=G.addresses)==null?void 0:ce[0])||{},J=(de=G.person_attributes)==null?void 0:de.find(Ce=>{var me;return((me=Ce.person_attribute_type)==null?void 0:me.name)==="Cell Phone Number"});return{patientID:G.person_id,firstName:z.given_name||"",middleName:z.middle_name||"",lastName:z.family_name||"",gender:G.gender,birthdate:G.birthdate,nationalId:T.national_id||"",address:se,phone:(J==null?void 0:J.value)||""}}):[]}catch(i){console.error("Error searching for mothers:",i),o.value=[]}finally{l.value=!1}},B=i=>{s.value=i,e.value="",m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")},g=()=>{s.value=null,m&&(m.motherPatientId=void 0,m.motherName=void 0,m.motherNationalId=void 0)},c=()=>{var d;const i=L("patient");i&&((d=i.value)!=null&&d.patientID)&&t.setMotherCreationContext(i.value.patientID,4),a.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},y=()=>{v.value<x.value&&v.value++},O=()=>{v.value>1&&v.value--},R=i=>i?new Date(i).toLocaleDateString():"",I=i=>{if(!i)return"";if(typeof i=="string")return i;const d=[];return i.city_village&&d.push(i.city_village),i.township_division&&d.push(i.township_division),i.state_province&&d.push(i.state_province),d.join(", ")};return F({getFormRef:()=>({validate:()=>s.value!==null,getFormData:()=>{var i,d;return{motherPatientId:(i=s.value)==null?void 0:i.patientID,motherName:s.value?"".concat(s.value.firstName," ").concat(s.value.middleName||""," ").concat(s.value.lastName).trim():void 0,motherNationalId:(d=s.value)==null?void 0:d.nationalId}}}),validateForm:()=>s.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>s.value?{motherPatientId:s.value.patientID,motherName:"".concat(s.value.firstName," ").concat(s.value.middleName||""," ").concat(s.value.lastName).trim(),motherNationalId:s.value.nationalId}:{}}),(i,d)=>(h(),b("div",Et,[r("div",Ht,[p(u(Fe),null,{default:k(()=>[r("div",Gt,[r("div",zt,[r("img",{src:u(le).icons.care,alt:"Care",class:"header-icon"},null,8,Qt),p(u(E),{icon:u(te),class:"search-badge-icon"},null,8,["icon"])]),r("div",null,[p(u(we),null,{default:k(()=>[...d[1]||(d[1]=[P("Search for Mother",-1)])]),_:1}),p(u(Ne),null,{default:k(()=>[...d[2]||(d[2]=[P("Find mother's existing record",-1)])]),_:1})])])]),_:1}),p(u(Se),null,{default:k(()=>[p(u(ke),{class:"info-note"},{default:k(()=>[...d[3]||(d[3]=[P(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),r("div",Lt,[r("div",qt,[p(u(Ie),{modelValue:e.value,"onUpdate:modelValue":d[0]||(d[0]=w=>e.value=w),placeholder:"Search for mother's Name or scan MRN",onIonInput:S,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),r("div",Ut,[p(u(E),{color:"primary",size:"small",icon:u(Oe),slot:"icon-only"},null,8,["icon"])])]),p(u(K),{color:"success",onClick:c,class:"new-registration-btn"},{default:k(()=>[p(u(E),{icon:u(xe),slot:"icon-only"},null,8,["icon"]),d[4]||(d[4]=P("New Registration ",-1))]),_:1})]),e.value&&e.value.length>0&&!s.value?(h(),b("div",Kt,[l.value?(h(),b("div",Wt,[(h(),b(ae,null,re(3,w=>r("div",{key:"skeleton-".concat(w),class:"result-item-skeleton"},[...d[5]||(d[5]=[r("div",{class:"skeleton-header"},[r("div",{class:"skeleton-name"}),r("div",{class:"skeleton-dob"}),r("div",{class:"skeleton-gender"})],-1),r("div",{class:"skeleton-details"},[r("div",{class:"skeleton-address"}),r("div",{class:"skeleton-phone"})],-1)])])),64))])):o.value.length>0?(h(),b("div",Yt,[(h(!0),b(ae,null,re(n.value,(w,H)=>(h(),b("div",{key:w.patientID||H,class:"result-item",onClick:T=>B(w)},[r("div",Jt,[r("span",Zt,D(w.firstName)+" "+D(w.middleName?w.middleName+" ":"")+D(w.lastName),1),r("span",Xt,"DOB "+D(R(w.birthdate)),1),r("span",ea,D(w.gender==="F"?"Female":w.gender),1)]),r("div",ta,[w.address?(h(),b("p",aa,[d[6]||(d[6]=r("strong",null,"Current Address:",-1)),P(" "+D(I(w.address)),1)])):M("",!0),w.phone?(h(),b("p",ra,[p(u(E),{icon:u(Me)},null,8,["icon"]),P(" "+D(w.phone),1)])):M("",!0)])],8,jt))),128)),x.value>1?(h(),b("div",oa,[p(u(K),{fill:"outline",size:"small",onClick:O,disabled:v.value===1},{default:k(()=>[p(u(E),{icon:u(Be)},null,8,["icon"])]),_:1},8,["disabled"]),r("span",sa,"Page "+D(v.value)+" of "+D(x.value),1),p(u(K),{fill:"outline",size:"small",onClick:y,disabled:v.value===x.value},{default:k(()=>[p(u(E),{icon:u(Ee)},null,8,["icon"])]),_:1},8,["disabled"])])):M("",!0)])):(h(),b("div",na,[p(u(E),{icon:u(te),class:"no-results-icon"},null,8,["icon"]),r("p",null,'No mothers found matching "'+D(e.value)+'"',1),p(u(K),{expand:"block",onClick:c},{default:k(()=>[...d[7]||(d[7]=[P("Register new mother",-1)])]),_:1})]))])):M("",!0),s.value?(h(),b("div",la,[r("div",ia,[r("div",ua,[r("div",ca,[d[8]||(d[8]=r("span",{class:"selected-subtitle"},"Selected Mother",-1)),p(u(K),{fill:"clear",size:"small",color:"danger",onClick:g,class:"clear-selection-btn"},{default:k(()=>[p(u(E),{icon:u($e),slot:"icon-only"},null,8,["icon"])]),_:1})])]),r("div",da,[r("div",ma,[r("h3",null,D(s.value.firstName)+" "+D(s.value.middleName?s.value.middleName+" ":"")+D(s.value.lastName),1),r("p",null,[d[9]||(d[9]=r("strong",null,"MRN:",-1)),P(" "+D(s.value.patientID),1)]),s.value.birthdate?(h(),b("p",fa,[d[10]||(d[10]=r("strong",null,"DOB:",-1)),P(" "+D(R(s.value.birthdate)),1)])):M("",!0),s.value.address?(h(),b("p",pa,[d[11]||(d[11]=r("strong",null,"Address:",-1)),P(" "+D(I(s.value.address)),1)])):M("",!0)])])])])):M("",!0)]),_:1})])]))}}),ge=oe(va,[["__scopeId","data-v-0beac54f"]]),ye=q({__name:"Pregnancy",setup(f,{expose:F}){const a=N(null),m=C[4].formData,t=L(U),_=e=>{t&&(t.gestationWeeks=Y(e.gestationWeeks||""),t.steroidsGiven=e.steroidsGiven||"",t.gestationMethodAssessment=$(e.gestationMethodAssessment)||"",t.ultraSoundScanning=e.ultraSoundScanning||"",t.onsetOfLabor=Y(e.onsetOfLabor||""),t.ruptureOfMembranes=e.ruptureOfMembranes||"",t.durationOfRuptureMembranes=$(e.durationOfRuptureMembranes)||"",t.offensiveLiquor=e.offensiveLiquor||"",t.modeOfDelivery=$(e.modeOfDelivery)||"",t.meconiumPresent=e.meconiumPresent||"",t.maternalAnalgesia=e.maternalAnalgesia||"",t.analgesiasDrug=$(e.analgesiasDrug)||"",t.anesthesiaUsed=e.anesthesiaUsed||"",t.teo=e.teo||"",t.chlorohexidineCordCare=e.chlorohexidineCordCare||"",t.vitaminKGiven=e.vitaminKGiven||"",t.dextroseGiven=e.dextroseGiven||"")};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),be=q({__name:"MotherEnrollmentDetails",setup(f,{expose:F}){const a=N(null),m=C[5].formData,t=L(U),_=e=>{t&&(t.motherStatus=e.motherStatus||"",t.motherHivStatus=$(e.motherHivStatus)||"",t.lastHivTestDate=Y(e.lastHivTestDate||""),t.doHivRetest=e.doHivRetest||"",t.babyGivenNvp=e.babyGivenNvp||"",t.motherVdrlResult=$(e.motherVdrlResult)||"",t.motherTreatedForVdrl=e.motherTreatedForVdrl||"",t.babyTestedForHepatitis=e.babyTestedForHepatitis||"",t.allThreeDosesCompleted=e.allThreeDosesCompleted||"",t.motherHepatitisResult=$(e.motherHepatitisResult)||"")};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),De=q({__name:"KnownMedicalConditions",setup(f,{expose:F}){const a=N(null),m=C[6].formData,t=L(U),_=e=>{t&&(t.tetanusDiphtheria=Pe(e.tetanusDiphtheria))};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&_(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&_(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.validateForm)==null?void 0:l.call(e))||null},getFormValues:()=>{var e,l;return((l=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:l.call(e))||{}}}),(e,l)=>(h(),j(W,{formData:u(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),ha=q({name:"NeonatalEnrollment",components:{IonPage:Ge,IonContent:He,Toolbar:qe,DemographicBar:Je,NeonatalStepper:Ze,BirthDetails:ve,ReferralInformation:he,BirthAssessment:_e,MotherSearch:ge,Pregnancy:ye,MotherEnrollmentDetails:be,KnownMedicalConditions:De},setup(){const f=Ve(),F=ue(),{patient:a}=ze(F),m=N(!1),t=Qe({...Xe});Le(U,t);const _=N(C.map((s,v)=>({title:s.title,number:v+1,checked:!1,class:v===0?"open_step common_step":"common_step",last_step:v===C.length-1?"last_step":""}))),e=[{title:C[0].title,value:"1",component:ve},{title:C[1].title,value:"2",component:he},{title:C[2].title,value:"3",component:_e},{title:C[3].title,value:"4",component:ge},{title:C[4].title,value:"5",component:ye},{title:C[5].title,value:"6",component:be},{title:C[6].title,value:"7",component:De}];return{router:f,patient:a,enrollmentFormData:t,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:_,stepperData:e,updateStatus:s=>{s&&s.value&&_.value.forEach((v,A)=>{s.value===(A+1).toString()?(v.class="open_step common_step",v.checked=!1):A<parseInt(s.value)-1?(v.class="common_step color_white",v.checked=!0):(v.class="common_step",v.checked=!1)})},getSaveFunction:s=>s===e.length-1?async()=>{var v;if(!((v=a.value)!=null&&v.patientID)){fe("No patient selected");return}if(!m.value)try{if(m.value=!0,!t.birthWeight||!t.timeOfBirth){fe("Please complete required birth details"),m.value=!1;return}if(t.motherPatientId)try{const x=(await pe.getRelations()).find(n=>n.b_is_to_a==="Mother"||n.b_is_to_a==="Parent");x&&await pe.createRelation(a.value.patientID,t.motherPatientId,x.relationship_type_id)}catch(A){console.error("Failed to create mother-baby relationship",A)}await je.enrollNeonate(a.value.patientID,t,Ue.sessionDate()),await Ke.userProgramData(a.value.patientID),We("Neonate enrolled successfully"),f.push("/neonatal/triage")}catch(A){console.error("Neonatal enrollment failed",A),Ye("Failed to enroll neonate. Please try again."),m.value=!1}}:null,isEnrolling:m}}});function _a(f,F,a,m,t,_){const e=X("Toolbar"),l=X("DemographicBar"),o=X("NeonatalStepper"),s=X("ion-content"),v=X("ion-page");return h(),j(v,{class:"neonatal-enrollment-page"},{default:k(()=>[p(e),p(s,{fullscreen:!0},{default:k(()=>[p(l),p(o,{wizardData:f.wizardData,StepperData:f.stepperData,stepperTitle:f.stepperTitle,openStepper:f.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:f.getSaveFunction,flowType:"enrollment",onUpdateStatus:f.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const $a=oe(ha,[["render",_a],["__scopeId","data-v-5456e187"]]);export{$a as default};
