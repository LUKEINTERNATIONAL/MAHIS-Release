import{d as U,eO as L,r as N,c as ee,w as V,e as b,m as O,f as v,k as s,l as p,u as c,aR as De,J as k,L as B,bj as te,cv as Fe,Q as P,aQ as we,aP as Ne,Y as Se,bF as ke,N as K,aZ as Ce,F as ae,P as re,K as D,cG as Ie,a as ie,O as j,an as $e,f7 as Ae,bk as xe,f8 as Oe,bK as Me,d8 as Be,a3 as Ee,a6 as He,aV as Ge,by as ze,eP as Qe,H as X}from"./vendor-BDGIuVwJ.js";import{u as ce,P as Ve,_ as oe,L as Re,aC as W,T as Le,b4 as fe,H as Ue,ab as qe,G as Ke,t as We}from"../index-lAUB1meQ.js";import{N as Ye}from"./neonatal_service-B3GyhEWL.js";import{D as je}from"./DemographicBar-1TmYJB4o.js";import{n as q,a as C,N as Je,d as Ze}from"./NeonatalStepper-DHAt1iKH.js";import{I as le}from"./images-DFClaPJu.js";import{u as Xe}from"./NeonatalEnrollmentStore-BzZSnKIK.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-XnpXrK8U.js";import"./SaveProgressModal-B9Ztxvaj.js";const et={key:0,class:"twin-search-container"},tt={style:{border:"1px dotted #ececec","border-radius":"8px"}},at={class:"header-with-icon"},rt={class:"icon-wrapper"},ot=["src"],st={class:"search-with-button"},nt={class:"search-wrapper"},lt={key:0,class:"search-results"},it={key:0,class:"search-loading"},ct={key:1,class:"results-list"},ut=["onClick"],dt={class:"result-header"},mt={class:"twin-name"},ft={class:"twin-mrn"},pt={class:"twin-dob"},vt={class:"result-details"},ht={key:0,class:"twin-gender"},_t={key:2,class:"no-results"},gt={key:1,class:"selected-twin"},yt={class:"selected-card"},bt={class:"selected-card-header"},Dt={class:"header-content"},Ft={class:"selected-icon-wrapper"},wt=["src"],Nt={class:"selected-card-content"},St={class:"patient-info-grid"},kt={class:"info-row"},It={class:"info-value"},$t={class:"info-row"},Vt={class:"info-value"},Rt={key:0,class:"info-row"},Tt={class:"info-value"},Pt={key:1,class:"info-row"},Ct={class:"info-value"},At=U({__name:"TwinSearch",setup(f,{expose:F}){const a=L(q),m=ce(),r=N(""),h=N(!1),e=N([]),n=N(null),t=N(!1),o=ee(()=>(a==null?void 0:a.hasTwin)==="Yes"),y=async()=>{if(!r.value||r.value.trim().length<2){e.value=[];return}h.value=!0;try{const _=r.value.trim();if(/^\d+$/.test(_))try{const u=await m.getPatientData(Number(_));if(u&&u.personInformation){const g=u.personInformation;e.value=[{patientID:g.person_id,firstName:g.given_name||"",middleName:g.middle_name||"",lastName:g.family_name||"",gender:g.gender,birthdate:g.birthdate}]}else e.value=[]}catch(u){console.error("Error searching by MRN:",u),e.value=[]}else{const u=_.split(" "),g={given_name:u[0],family_name:u[1]||"",page:"1",per_page:"20"},A=await Ve.search(g);e.value=Array.isArray(A)?A.filter(R=>{const I=R.person;if(!I.birthdate)return!1;const Q=new Date(I.birthdate);return Math.floor((Date.now()-Q.getTime())/(1e3*60*60*24))<=7}).map(R=>{var i;const I=R.person,Q=((i=I.names)==null?void 0:i[0])||{};return{patientID:I.person_id,firstName:Q.given_name||"",middleName:Q.middle_name||"",lastName:Q.family_name||"",gender:I.gender,birthdate:I.birthdate}}):[]}}catch(_){console.error("Error searching for twin:",_),e.value=[]}finally{h.value=!1}},z=_=>{n.value=_,r.value="",t.value=!1,a&&(a.twinPatientId=_.patientID,a.twinName="".concat(_.firstName," ").concat(_.middleName||""," ").concat(_.lastName).trim())},x=()=>{n.value=null,t.value=!1,a&&(a.twinPatientId=void 0,a.twinName=void 0)},l=()=>{t.value=!0,n.value=null,r.value="",a&&(a.twinPatientId=void 0,a.twinName=void 0)};V(()=>a==null?void 0:a.hasTwin,_=>{_!=="Yes"&&(x(),t.value=!1)});const S=_=>"".concat(_.firstName," ").concat(_.middleName||""," ").concat(_.lastName).trim(),M=_=>_?new Date(_).toLocaleDateString():"";return F({validateForm:()=>(a==null?void 0:a.hasTwin)==="Yes"&&!n.value&&!t.value?{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"}:null,getFormValues:()=>n.value?{twinPatientId:n.value.patientID,twinName:S(n.value)}:{}}),(_,u)=>o.value?(v(),b("div",et,[s("div",tt,[p(c(De),null,{default:k(()=>[s("div",at,[s("div",rt,[s("img",{src:c(le).icons.twins,alt:"Twin",class:"header-icon"},null,8,ot),p(c(B),{icon:c(te),class:"search-badge-icon"},null,8,["icon"])]),s("div",null,[p(c(Fe),null,{default:k(()=>[...u[1]||(u[1]=[P("Twin Information",-1)])]),_:1}),p(c(we),null,{default:k(()=>[...u[2]||(u[2]=[P("Search for twin sibling",-1)])]),_:1})])])]),_:1}),p(c(Ne),null,{default:k(()=>[p(c(Se),{class:"info-note"},{default:k(()=>[...u[3]||(u[3]=[P(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),s("div",st,[s("div",nt,[p(c(ke),{modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=g=>r.value=g),placeholder:"Search for twin's MRN or scan barcode",onIonInput:y,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),p(c(K),{color:"primary",onClick:l,class:"skip-btn"},{default:k(()=>[u[4]||(u[4]=P(" Skip ",-1)),p(c(B),{size:"small",icon:c(Ce),slot:"end"},null,8,["icon"])]),_:1})]),r.value&&r.value.length>0&&!n.value?(v(),b("div",lt,[h.value?(v(),b("div",it,[(v(),b(ae,null,re(3,g=>s("div",{key:"skeleton-".concat(g),class:"result-item-skeleton"},[...u[5]||(u[5]=[s("div",{class:"skeleton-header"},[s("div",{class:"skeleton-name"}),s("div",{class:"skeleton-dob"})],-1)])])),64))])):e.value.length>0?(v(),b("div",ct,[(v(!0),b(ae,null,re(e.value,(g,A)=>(v(),b("div",{key:g.patientID||A,class:"result-item",onClick:R=>z(g)},[s("div",dt,[s("span",mt,D(S(g)),1),s("span",ft,"MRN: "+D(g.patientID),1),s("span",pt,"DOB: "+D(M(g.birthdate)),1)]),s("div",vt,[g.gender?(v(),b("p",ht,[u[6]||(u[6]=s("strong",null,"Gender:",-1)),P(" "+D(g.gender),1)])):O("",!0)])],8,ut))),128))])):(v(),b("div",_t,[p(c(B),{icon:c(te),class:"no-results-icon"},null,8,["icon"]),s("p",null,'No patients found matching "'+D(r.value)+'"',1),u[7]||(u[7]=s("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):O("",!0),n.value?(v(),b("div",gt,[s("div",yt,[s("div",bt,[s("div",Dt,[s("div",Ft,[s("img",{src:c(le).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,wt)]),u[8]||(u[8]=s("div",{class:"header-separator"},null,-1)),u[9]||(u[9]=s("span",{class:"selected-subtitle"},"Twin Selected",-1))]),p(c(K),{fill:"clear",size:"small",onClick:x,class:"clear-selection-btn"},{default:k(()=>[p(c(B),{icon:c(Ie)},null,8,["icon"])]),_:1})]),s("div",Nt,[s("div",St,[s("div",kt,[u[10]||(u[10]=s("span",{class:"info-label"},"Full Name",-1)),s("span",It,D(S(n.value)),1)]),s("div",$t,[u[11]||(u[11]=s("span",{class:"info-label"},"MRN",-1)),s("span",Vt,D(n.value.patientID),1)]),n.value.birthdate?(v(),b("div",Rt,[u[12]||(u[12]=s("span",{class:"info-label"},"Date of Birth",-1)),s("span",Tt,D(M(n.value.birthdate)),1)])):O("",!0),n.value.gender?(v(),b("div",Pt,[u[13]||(u[13]=s("span",{class:"info-label"},"Gender",-1)),s("span",Ct,D(n.value.gender),1)])):O("",!0)])])])])):O("",!0)]),_:1})])])):O("",!0)}}),xt=oe(At,[["__scopeId","data-v-9ecea754"]]),$=f=>{var F,a,m;if(!(f==null||f==="")){if(typeof f=="string"||typeof f=="number")return f.toString();if(typeof f=="object"){const r=(m=(a=(F=f.label)!=null?F:f.value)!=null?a:f.name)!=null?m:f.title;if(r!=null&&r!=="")return r.toString()}}},Te=f=>{if(!f)return[];if(Array.isArray(f))return f.map(a=>$(a)).filter(a=>!!a);const F=$(f);return F?[F]:[]},Y=f=>f==null?"":f.toString(),Ot={class:"birth-details-wrapper"},Mt=U({__name:"BirthDetails",setup(f,{expose:F}){const a=N(null),m=N(null),r=N(null),h=C[0].formData,e=h.slice(0,1),n=h.slice(1),t=L(q),o=N([]);ie(async()=>{try{const l=await Re.getAllFacilities();Array.isArray(l)?o.value=l:l!=null&&l.facilities&&Array.isArray(l.facilities)?o.value=l.facilities:l!=null&&l.records&&Array.isArray(l.records)?o.value=l.records:o.value=[]}catch(l){console.error("Error loading facilities:",l),o.value=[]}});const y=ee(()=>n.map(l=>l.name==="birthFacility"?{...l,options:o.value.map(S=>{const M=S.name||S.facility_name||"Unknown";return{name:M,label:M,value:S.id||S.facility_id||M,code:S.code||S.facility_code,district:S.district||S.district_name}})}:l)),z=l=>{t&&(t.hasTwin=l.hasTwin||"")},x=l=>{t&&(t.placeOfBirth=$(l.placeOfBirth)||"",t.nameOfBirthFacility=$(l.birthFacility)||"",t.typeOfBirth=$(l.typeOfBirth)||"",t.birthWeight=Y(l.birthWeight||""),t.timeOfBirth=Y(l.birthTime||""))};return V(()=>{var l;return(l=m.value)==null?void 0:l.formValues},l=>{l&&x(l)},{deep:!0}),V(()=>m.value,l=>{l!=null&&l.getFormValues&&x(l.getFormValues())},{immediate:!0}),V(()=>{var l;return(l=a.value)==null?void 0:l.formValues},l=>{l&&z(l)},{deep:!0}),V(()=>a.value,l=>{l!=null&&l.getFormValues&&z(l.getFormValues())},{immediate:!0}),F({getFormRef:()=>m.value,getTwinQuestionFormRef:()=>a.value,validateForm:()=>{var u,g,A,R,I,Q;const l=((g=(u=a.value)==null?void 0:u.validateForm)==null?void 0:g.call(u))||null,S=((R=(A=m.value)==null?void 0:A.validateForm)==null?void 0:R.call(A))||null,M=((Q=(I=r.value)==null?void 0:I.validateForm)==null?void 0:Q.call(I))||null,_=[l,S,M].filter(Boolean);return _.length?_.reduce((i,d)=>({...i,...d}),{}):null},getFormValues:()=>{var _,u,g,A,R,I;const l=((u=(_=a.value)==null?void 0:_.getFormValues)==null?void 0:u.call(_))||{},S=((A=(g=m.value)==null?void 0:g.getFormValues)==null?void 0:A.call(g))||{},M=((I=(R=r.value)==null?void 0:R.getFormValues)==null?void 0:I.call(R))||{};return{...l,...S,...M}}}),(l,S)=>(v(),b("div",Ot,[p(W,{formData:c(e),ref_key:"twinQuestionFormRef",ref:a,class:"twin-question-form"},null,8,["formData"]),p(xt,{ref_key:"twinSearchRef",ref:r},null,512),p(W,{formData:y.value,ref_key:"formRef",ref:m,class:"main-form"},null,8,["formData"])]))}}),pe=oe(Mt,[["__scopeId","data-v-9a714757"]]),ve=U({__name:"ReferralInformation",setup(f,{expose:F}){const a=N(null),m=C[1].formData,r=L(q),h=N([]);ie(async()=>{try{const t=await Re.getAllFacilities();Array.isArray(t)?h.value=t:t!=null&&t.facilities&&Array.isArray(t.facilities)?h.value=t.facilities:t!=null&&t.records&&Array.isArray(t.records)?h.value=t.records:h.value=[]}catch(t){console.error("Error loading facilities:",t),h.value=[]}});const e=ee(()=>m.map(t=>t.name==="referringFacilityName"?{...t,options:h.value.map(o=>{const y=o.name||o.facility_name||"Unknown";return{name:y,label:y,value:o.id||o.facility_id||y,code:o.code||o.facility_code,district:o.district||o.district_name}})}:t)),n=t=>{if(!r)return;r.referredFromOtherFacility=t.referredFromAnotherFacility||"",r.referredFrom=$(t.referredFrom)||"";const o=t.referringFacilityName;r.referringFacilityName=(o==null?void 0:o.name)||Y(o||""),r.modeOfTransport=$(t.modeOfTransport)||"",r.admittedFrom=$(t.admittedFrom)||""};return V(()=>{var t;return(t=a.value)==null?void 0:t.formValues},t=>{t&&n(t)},{deep:!0}),V(()=>a.value,t=>{t!=null&&t.getFormValues&&n(t.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var t,o;return((o=(t=a.value)==null?void 0:t.validateForm)==null?void 0:o.call(t))||null},getFormValues:()=>{var t,o;return((o=(t=a.value)==null?void 0:t.getFormValues)==null?void 0:o.call(t))||{}}}),(t,o)=>(v(),j(W,{formData:e.value,ref_key:"formRef",ref:a},null,8,["formData"]))}}),he=U({__name:"BirthAssessment",setup(f,{expose:F}){const a=N(null),m=C[2].formData,r=L(q),h=e=>{r&&(r.criedAfterBirth=e.criedAfterBirth||"",r.apgarScoreAt1=$(e.apgar1)||"",r.apgarScoreAt5=$(e.apgar5)||"",r.apgarScoreAt10=$(e.apgar10)||"",r.resuscitationMethods=Te(e.resuscitationMethods))};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&h(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&h(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.validateForm)==null?void 0:n.call(e))||null},getFormValues:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:n.call(e))||{}}}),(e,n)=>(v(),j(W,{formData:c(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),Bt={class:"mother-search-container"},Et={style:{border:"1px dotted #ececec","border-radius":"8px"}},Ht={class:"header-with-icon"},Gt={class:"icon-wrapper"},zt=["src"],Qt={class:"search-with-button"},Lt={class:"search-wrapper"},Ut={class:"barcode-btn","aria-label":"Scan MRN"},qt={key:0,class:"search-results"},Kt={key:0,class:"search-loading"},Wt={key:1,class:"results-list"},Yt=["onClick"],jt={class:"result-header"},Jt={class:"mother-name"},Zt={class:"mother-dob"},Xt={class:"mother-gender"},ea={class:"result-details"},ta={key:0,class:"mother-address"},aa={key:1,class:"mother-phone"},ra={key:0,class:"pagination"},oa={class:"page-info"},sa={key:2,class:"no-results"},na={key:1,class:"selected-mother"},la={class:"selected-card"},ia={class:"selected-card-header"},ca={class:"selected-header-with-button"},ua={class:"selected-card-content"},da={class:"selected-info"},ma={key:0},fa={key:1},ne=10,pa=U({__name:"MotherSearch",setup(f,{expose:F}){const a=$e(),m=L(q),r=Xe(),h=ce(),e=N(""),n=N(!1),t=N([]),o=N(null),y=N(1);ie(async()=>{const i=r.getMotherPatientId;i&&r.shouldReturnToEnrollment&&(await z(i),r.clearEnrollmentContext())}),V(o,i=>{i&&m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")});const z=async i=>{var d,w;try{n.value=!0;const E=await h.getPatientData(i);if(E&&E.personInformation){const T=E.personInformation,H=((d=T.addresses)==null?void 0:d[0])||{},G=(w=T.person_attributes)==null?void 0:w.find(J=>{var Z;return((Z=J.person_attribute_type)==null?void 0:Z.name)==="Cell Phone Number"}),se={patientID:T.person_id||i,firstName:T.given_name||"",middleName:T.middle_name||"",lastName:T.family_name||"",gender:T.gender,birthdate:T.birthdate,nationalId:E.national_id||"",address:H,phone:(G==null?void 0:G.value)||""};o.value=se}}catch(E){console.error("Error fetching mother data:",E)}finally{n.value=!1}},x=ee(()=>Math.ceil(t.value.length/ne)),l=ee(()=>{const i=(y.value-1)*ne,d=i+ne;return t.value.slice(i,d)}),S=async()=>{if(!e.value||e.value.trim().length<2){t.value=[];return}n.value=!0,y.value=1;try{const d=e.value.trim().split(" "),w={given_name:d[0],family_name:d[1]||"",page:"1",per_page:"50"},E=await Ve.search(w);t.value=Array.isArray(E)?E.filter(T=>{var G;const H=((G=T.person)==null?void 0:G.gender)||T.gender;return H==="F"||H==="Female"}).map(T=>{var Z,ue,de;const H=T.person,G=((Z=H.names)==null?void 0:Z[0])||{},se=((ue=H.addresses)==null?void 0:ue[0])||{},J=(de=H.person_attributes)==null?void 0:de.find(Pe=>{var me;return((me=Pe.person_attribute_type)==null?void 0:me.name)==="Cell Phone Number"});return{patientID:H.person_id,firstName:G.given_name||"",middleName:G.middle_name||"",lastName:G.family_name||"",gender:H.gender,birthdate:H.birthdate,nationalId:T.national_id||"",address:se,phone:(J==null?void 0:J.value)||""}}):[]}catch(i){console.error("Error searching for mothers:",i),t.value=[]}finally{n.value=!1}},M=i=>{o.value=i,e.value="",m&&(m.motherPatientId=i.patientID,m.motherName="".concat(i.firstName," ").concat(i.middleName||""," ").concat(i.lastName).trim(),m.motherNationalId=i.nationalId||"")},_=()=>{o.value=null,m&&(m.motherPatientId=void 0,m.motherName=void 0,m.motherNationalId=void 0)},u=()=>{var d;const i=L("patient");i&&((d=i.value)!=null&&d.patientID)&&r.setMotherCreationContext(i.value.patientID,4),a.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},g=()=>{y.value<x.value&&y.value++},A=()=>{y.value>1&&y.value--},R=i=>i?new Date(i).toLocaleDateString():"",I=i=>{if(!i)return"";if(typeof i=="string")return i;const d=[];return i.city_village&&d.push(i.city_village),i.township_division&&d.push(i.township_division),i.state_province&&d.push(i.state_province),d.join(", ")};return F({getFormRef:()=>({validate:()=>o.value!==null,getFormData:()=>{var i,d;return{motherPatientId:(i=o.value)==null?void 0:i.patientID,motherName:o.value?"".concat(o.value.firstName," ").concat(o.value.middleName||""," ").concat(o.value.lastName).trim():void 0,motherNationalId:(d=o.value)==null?void 0:d.nationalId}}}),validateForm:()=>o.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>o.value?{motherPatientId:o.value.patientID,motherName:"".concat(o.value.firstName," ").concat(o.value.middleName||""," ").concat(o.value.lastName).trim(),motherNationalId:o.value.nationalId}:{}}),(i,d)=>(v(),b("div",Bt,[s("div",Et,[p(c(De),null,{default:k(()=>[s("div",Ht,[s("div",Gt,[s("img",{src:c(le).icons.care,alt:"Care",class:"header-icon"},null,8,zt),p(c(B),{icon:c(te),class:"search-badge-icon"},null,8,["icon"])]),s("div",null,[p(c(Fe),null,{default:k(()=>[...d[1]||(d[1]=[P("Search for Mother",-1)])]),_:1}),p(c(we),null,{default:k(()=>[...d[2]||(d[2]=[P("Find mother's existing record",-1)])]),_:1})])])]),_:1}),p(c(Ne),null,{default:k(()=>[p(c(Se),{class:"info-note"},{default:k(()=>[...d[3]||(d[3]=[P(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),s("div",Qt,[s("div",Lt,[p(c(ke),{modelValue:e.value,"onUpdate:modelValue":d[0]||(d[0]=w=>e.value=w),placeholder:"Search for mother's Name or scan MRN",onIonInput:S,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),s("div",Ut,[p(c(B),{color:"primary",size:"small",icon:c(Ae),slot:"icon-only"},null,8,["icon"])])]),p(c(K),{color:"success",onClick:u,class:"new-registration-btn"},{default:k(()=>[p(c(B),{icon:c(xe),slot:"icon-only"},null,8,["icon"]),d[4]||(d[4]=P("New Registration ",-1))]),_:1})]),e.value&&e.value.length>0&&!o.value?(v(),b("div",qt,[n.value?(v(),b("div",Kt,[(v(),b(ae,null,re(3,w=>s("div",{key:"skeleton-".concat(w),class:"result-item-skeleton"},[...d[5]||(d[5]=[s("div",{class:"skeleton-header"},[s("div",{class:"skeleton-name"}),s("div",{class:"skeleton-dob"}),s("div",{class:"skeleton-gender"})],-1),s("div",{class:"skeleton-details"},[s("div",{class:"skeleton-address"}),s("div",{class:"skeleton-phone"})],-1)])])),64))])):t.value.length>0?(v(),b("div",Wt,[(v(!0),b(ae,null,re(l.value,(w,E)=>(v(),b("div",{key:w.patientID||E,class:"result-item",onClick:T=>M(w)},[s("div",jt,[s("span",Jt,D(w.firstName)+" "+D(w.middleName?w.middleName+" ":"")+D(w.lastName),1),s("span",Zt,"DOB "+D(R(w.birthdate)),1),s("span",Xt,D(w.gender==="F"?"Female":w.gender),1)]),s("div",ea,[w.address?(v(),b("p",ta,[d[6]||(d[6]=s("strong",null,"Current Address:",-1)),P(" "+D(I(w.address)),1)])):O("",!0),w.phone?(v(),b("p",aa,[p(c(B),{icon:c(Oe)},null,8,["icon"]),P(" "+D(w.phone),1)])):O("",!0)])],8,Yt))),128)),x.value>1?(v(),b("div",ra,[p(c(K),{fill:"outline",size:"small",onClick:A,disabled:y.value===1},{default:k(()=>[p(c(B),{icon:c(Me)},null,8,["icon"])]),_:1},8,["disabled"]),s("span",oa,"Page "+D(y.value)+" of "+D(x.value),1),p(c(K),{fill:"outline",size:"small",onClick:g,disabled:y.value===x.value},{default:k(()=>[p(c(B),{icon:c(Be)},null,8,["icon"])]),_:1},8,["disabled"])])):O("",!0)])):(v(),b("div",sa,[p(c(B),{icon:c(te),class:"no-results-icon"},null,8,["icon"]),s("p",null,'No mothers found matching "'+D(e.value)+'"',1),p(c(K),{expand:"block",onClick:u},{default:k(()=>[...d[7]||(d[7]=[P("Register new mother",-1)])]),_:1})]))])):O("",!0),o.value?(v(),b("div",na,[s("div",la,[s("div",ia,[s("div",ca,[d[8]||(d[8]=s("span",{class:"selected-subtitle"},"Selected Mother",-1)),p(c(K),{fill:"clear",size:"small",color:"danger",onClick:_,class:"clear-selection-btn"},{default:k(()=>[p(c(B),{icon:c(Ie),slot:"icon-only"},null,8,["icon"])]),_:1})])]),s("div",ua,[s("div",da,[s("h3",null,D(o.value.firstName)+" "+D(o.value.middleName?o.value.middleName+" ":"")+D(o.value.lastName),1),s("p",null,[d[9]||(d[9]=s("strong",null,"MRN:",-1)),P(" "+D(o.value.patientID),1)]),o.value.birthdate?(v(),b("p",ma,[d[10]||(d[10]=s("strong",null,"DOB:",-1)),P(" "+D(R(o.value.birthdate)),1)])):O("",!0),o.value.address?(v(),b("p",fa,[d[11]||(d[11]=s("strong",null,"Address:",-1)),P(" "+D(I(o.value.address)),1)])):O("",!0)])])])])):O("",!0)]),_:1})])]))}}),_e=oe(pa,[["__scopeId","data-v-0beac54f"]]),ge=U({__name:"Pregnancy",setup(f,{expose:F}){const a=N(null),m=C[4].formData,r=L(q),h=e=>{r&&(r.gestationWeeks=Y(e.gestationWeeks||""),r.steroidsGiven=e.steroidsGiven||"",r.gestationMethodAssessment=$(e.gestationMethodAssessment)||"",r.ultraSoundScanning=e.ultraSoundScanning||"",r.onsetOfLabor=Y(e.onsetOfLabor||""),r.ruptureOfMembranes=e.ruptureOfMembranes||"",r.durationOfRuptureMembranes=$(e.durationOfRuptureMembranes)||"",r.offensiveLiquor=e.offensiveLiquor||"",r.modeOfDelivery=$(e.modeOfDelivery)||"",r.meconiumPresent=e.meconiumPresent||"",r.maternalAnalgesia=e.maternalAnalgesia||"",r.analgesiasDrug=$(e.analgesiasDrug)||"",r.anesthesiaUsed=e.anesthesiaUsed||"",r.teo=e.teo||"",r.chlorohexidineCordCare=e.chlorohexidineCordCare||"",r.vitaminKGiven=e.vitaminKGiven||"",r.dextroseGiven=e.dextroseGiven||"")};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&h(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&h(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.validateForm)==null?void 0:n.call(e))||null},getFormValues:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:n.call(e))||{}}}),(e,n)=>(v(),j(W,{formData:c(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),ye=U({__name:"MotherEnrollmentDetails",setup(f,{expose:F}){const a=N(null),m=C[5].formData,r=L(q),h=e=>{r&&(r.motherStatus=e.motherStatus||"",r.motherHivStatus=$(e.motherHivStatus)||"",r.lastHivTestDate=Y(e.lastHivTestDate||""),r.doHivRetest=e.doHivRetest||"",r.babyGivenNvp=e.babyGivenNvp||"",r.motherVdrlResult=$(e.motherVdrlResult)||"",r.motherTreatedForVdrl=e.motherTreatedForVdrl||"",r.babyTestedForHepatitis=e.babyTestedForHepatitis||"",r.allThreeDosesCompleted=e.allThreeDosesCompleted||"",r.motherHepatitisResult=$(e.motherHepatitisResult)||"")};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&h(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&h(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.validateForm)==null?void 0:n.call(e))||null},getFormValues:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:n.call(e))||{}}}),(e,n)=>(v(),j(W,{formData:c(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),be=U({__name:"KnownMedicalConditions",setup(f,{expose:F}){const a=N(null),m=C[6].formData,r=L(q),h=e=>{r&&(r.tetanusDiphtheria=Te(e.tetanusDiphtheria))};return V(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&h(e)},{deep:!0}),V(()=>a.value,e=>{e!=null&&e.getFormValues&&h(e.getFormValues())},{immediate:!0}),F({getFormRef:()=>a.value,validateForm:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.validateForm)==null?void 0:n.call(e))||null},getFormValues:()=>{var e,n;return((n=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:n.call(e))||{}}}),(e,n)=>(v(),j(W,{formData:c(m),ref_key:"formRef",ref:a},null,8,["formData"]))}}),va=U({name:"NeonatalEnrollment",components:{IonPage:He,IonContent:Ee,Toolbar:Le,DemographicBar:je,NeonatalStepper:Je,BirthDetails:pe,ReferralInformation:ve,BirthAssessment:he,MotherSearch:_e,Pregnancy:ge,MotherEnrollmentDetails:ye,KnownMedicalConditions:be},setup(){const f=$e(),F=ce(),{patient:a}=Ge(F),m=ze({...Ze});Qe(q,m);const r=N(C.map((t,o)=>({title:t.title,number:o+1,checked:!1,class:o===0?"open_step common_step":"common_step",last_step:o===C.length-1?"last_step":""}))),h=[{title:C[0].title,value:"1",component:pe},{title:C[1].title,value:"2",component:ve},{title:C[2].title,value:"3",component:he},{title:C[3].title,value:"4",component:_e},{title:C[4].title,value:"5",component:ge},{title:C[5].title,value:"6",component:ye},{title:C[6].title,value:"7",component:be}];return{router:f,patient:a,enrollmentFormData:m,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:r,stepperData:h,updateStatus:t=>{t&&t.value&&r.value.forEach((o,y)=>{t.value===(y+1).toString()?(o.class="open_step common_step",o.checked=!1):y<parseInt(t.value)-1?(o.class="common_step color_white",o.checked=!0):(o.class="common_step",o.checked=!1)})},getSaveFunction:t=>t===h.length-1?async()=>{var o;if((o=a.value)!=null&&o.patientID)try{if(m.motherPatientId)try{const z=(await fe.getRelations()).find(x=>x.b_is_to_a==="Mother"||x.b_is_to_a==="Parent");z&&await fe.createRelation(a.value.patientID,m.motherPatientId,z.relationship_type_id)}catch(y){console.error("Failed to create mother-baby relationship",y)}await Ye.enrollNeonate(a.value.patientID,m,Ue.sessionDate()),await qe.userProgramData(a.value.patientID),Ke("Neonate enrolled successfully"),f.push("/neonatal/triage")}catch(y){console.error("Neonatal enrollment failed",y),We("Unable to enroll neonate at this time")}}:()=>{}}}});function ha(f,F,a,m,r,h){const e=X("Toolbar"),n=X("DemographicBar"),t=X("NeonatalStepper"),o=X("ion-content"),y=X("ion-page");return v(),j(y,{class:"neonatal-enrollment-page"},{default:k(()=>[p(e),p(o,{fullscreen:!0},{default:k(()=>[p(n),p(t,{wizardData:f.wizardData,StepperData:f.stepperData,stepperTitle:f.stepperTitle,openStepper:f.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:f.getSaveFunction,flowType:"enrollment",onUpdateStatus:f.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const Ia=oe(va,[["render",ha],["__scopeId","data-v-33616cef"]]);export{Ia as default};
