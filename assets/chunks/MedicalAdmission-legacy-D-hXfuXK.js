System.register(["./vendor-legacy-CdypqbXP.js","../index-legacy-a_4iRUcf.js","./DemographicBar-legacy-CxKOxyu2.js","./useFormWizard-legacy-DczO6gxA.js","./ComplicationsStore-legacy-C6kh9Gm4.js","./nonPharmaTherapyStore-legacy-CIos6l4G.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-Yp36q8Ko.js","./usePatientProfile-legacy-CTY7g2IJ.js","./apexcharts-legacy-DPlv51y0.js","./drug_prescription_service-legacy-Bt1zalX2.js","./patient_diagnosis_service-legacy-B6wTHM2k.js","./Registration-legacy-y0qunijT.js","./useSetRegistrationValues-legacy-BX1Hth6U.js","./useLocation-legacy-jbXTMHh3.js","./vaccines_service-legacy-BnD5h3GQ.js","./sms_service-legacy-BEUUNZXG.js","./EIRreportsStore-legacy-CgG4vUEp.js","./Export-legacy-CIpkoeO6.js","./user_role_management-legacy-EpDa5FhZ.js","./useNeonatalEnrollmentStore-legacy-DHZSAMR0.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-DPqvv6wS.js","./wardsStore-legacy-Dp7v843R.js"],function(e,t){"use strict";var i,a,n,l,s,o,r,c,u,g,v,d,y,m,f,S,p,h,b,D,H,P,w,x,I,_,R,j,C,M,A,E,F,T,k,O,L,B,z,N,V,$,W,U,J,Q,Z,q,G,K,X,Y,ee,te,ie,ae,ne,le;return{setters:[e=>{i=e.d,a=e.am,n=e.cr,l=e.r,s=e.c,o=e.b2,r=e.w,c=e.a,u=e.H,g=e.O,v=e.f,d=e.J,y=e.l,m=e.u,f=e.ab,S=e.k,p=e.m,h=e.i,b=e.bT,D=e.v,H=e.ae,P=e.ba},e=>{w=e.b8,x=e.u,I=e.b9,_=e.ba,R=e.b0,j=e.bb,C=e.e,M=e.b1,A=e.i,E=e.a7,F=e.f,T=e.T,k=e.D,O=e.a1,L=e.H,B=e.b3,z=e.bc,N=e.C,V=e.bd,$=e.t,W=e.an,U=e.Z,J=e.be,Q=e.a9,Z=e.S},e=>{q=e.D},e=>{G=e.u,K=e._},e=>{X=e.u},e=>{Y=e.s,ee=e.c,te=e.u},e=>{ie=e.l},e=>{ae=e.f,ne=e.a},e=>{le=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const t={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},se={class:"back_profile"};e("default",i({__name:"MedicalAdmission",setup(e,{expose:i}){const{onTabBeforeChange:oe,currentTabIndex:re}=G();le();const ce=a(),ue=n();l([]),l([]),l(!1);const ge=l(!0),ve=l(!1),de=l(!1),ye=s(()=>({text:de.value?"Saving...":"Finish",icon:de.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:ve.value||de.value})),me=w(),fe=x(),Se=I(),pe=_();R();const he=j(),be=C();M();const De=A(),He=X(),Pe=E(),{patient:we}=o(fe),{vitals:xe}=o(me),{investigations:Ie}=o(Se),{diagnosis:_e}=o(pe),{substance:Re}=o(De),{selectedNCDMedicationList:je}=o(he),{FootScreening:Ce,visualScreening:Me,cvScreening:Ae}=o(He),{sessionDate:Ee}=o(Pe),{apiStatus:Fe}=o(F());r(ye,(e,t)=>{console.log("Done button options changed:",{from:t,to:e,currentStep:re.value,tabsLength:Oe.value.length}),e.disabled!==(null==t?void 0:t.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==t?void 0:t.text)&&console.log(`Done button text changed from "${null==t?void 0:t.text}" to "${e.text}"`)},{deep:!0}),r(de,(e,t)=>{e!==t&&(console.log(`Saving state changed: ${t} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Te=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},ke=()=>{let e=!1;return ze(),de.value&&(e=!0),ve.value=e,!e},Oe=l([{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]),Le=l(null),Be=l(null),ze=()=>{var e;if(!Oe.value||0===Oe.value.length)return console.log("Tabs not yet initialized"),null;const t=re.value>=0&&re.value<Oe.value.length?re.value:0;switch(null===(e=Oe.value[t])||void 0===e?void 0:e.title){case"Presenting Complaints":return"Presenting Complaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan";default:if(be.NCDActivities.length>0)switch(be.NCDActivities[0]){case"Presenting Complaints":return"PresentingComplaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan"}return null}},Ne=()=>{ge.value=!1,setTimeout(()=>{re.value=0,ge.value=!0},0)},Ve=()=>{const e=w();e.setVitals(e.getInitialVitals(we.value.ID))},$e=async()=>{const e=O(Ee.value,"sessionDate","value")||L.sessionDate(),t=B("vitals");for(let a=0;a<Oe.value.length;a++){const n=Oe.value[a];if("Vital Signs"===n.title)Oe.value[a].icon=We(e,t)?P:"";else if("Risk Assessment"===n.title){const t=B("substanceAbuse");Oe.value[a].icon=We(e,t)?P:""}else if("Investigations"===n.title){var i;const t=null==we||null===(i=we.value)||void 0===i||null===(i=i.labOrders)||void 0===i?void 0:i.saved,n=null==t?void 0:t.filter(t=>L.toStandardHisFormat(e)===L.toStandardHisFormat(t.order_date));Oe.value[a].icon=(null==n?void 0:n.length)>0?P:""}else if("Diagnosis"===n.title){const t=B("diagnosis");Oe.value[a].icon=We(e,t)?P:""}else if("Complications Screening"===n.title){const t=B("screening");Oe.value[a].icon=We(e,t)?P:""}else"Treatment Plan"===n.title&&(je.value.length>0?Oe.value[a].icon=z()?P:"":Oe.value[a].icon="")}ke()},We=(e,t)=>{const i=new Date(e);return i.setHours(0,0,0,0),t.some(e=>{const t=new Date(e.obs_datetime);return t.setHours(0,0,0,0),t.getTime()===i.getTime()})},Ue=async(e,t)=>{var i;const a=null===(i=Oe.value[t])||void 0===i?void 0:i.title;var n,l;e%1==0&&(re.value=e),"Vital Signs"==a&&(null===(n=Le.value)||void 0===n||n.onSubmit()),"Risk Assessment"==a&&(null===(l=Be.value)||void 0===l||l.onSubmit()),"Complications Screening"==a&&await(async()=>{const e=[],t=await ae(Me.value),i=await ne(Ce.value),a=await ae(Ae.value);var n,l,s,o;t.length>0&&e.push({concept_id:await W.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:W.getSessionDate(),child:t}),i.length>0&&e.push({concept_id:await W.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:W.getSessionDate(),child:i}),a.length>0&&e.push(...a),e.length>0?(null!==(l=(n=null!==(o=(s=we.value).screening)&&void 0!==o?o:s.screening={}).unsaved)&&void 0!==l||(n.unsaved=[]),we.value.screening.unsaved.push(...e),U("Complications saved successfully")):$("No complications data to save")})(),"Treatment Plan"==a&&await(async()=>{const e=J();if(!ie.isEmpty(e.selectedMedicalAllergiesList)){const t=Q(),i=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:Z.getSessionDate(),value_coded:e.concept_id,location_id:t.facilityLocation.code,value_text:e.name})),a=await Y(i);we.value=Object.assign(we.value,a),console.log("Allergies staged successfully:",we.value),e.clearSelectedMedicalAllergiesList()}const t=await ee();we.value=Object.assign(we.value,t);const i=await te().saveNonPharmaTherapyPatientData();we.value=Object.assign(we.value,i)})(),await N(we.value)},Je=async()=>{de.value=!0;try{await V(),await N(we.value),ce.push("/triageList")}catch(e){console.error("Error saving data:",e),$("Error occurred while saving data. Please try again.")}finally{de.value=!1}};return c(async()=>{0!==be.NCDActivities.length?(X().resetScreening(),Oe.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}],await $e(),(void 0===re.value||re.value<0)&&(re.value=0,console.log("Setting initial tab index to 0")),ve.value=!1,de.value=!1,ke()):ce.push("patientProfile")}),r(re,async()=>{await ke()}),r(xe,async()=>{await $e()},{deep:!0}),r(we,async()=>{X().resetScreening(),await $e()},{deep:!0}),r(Ee,async()=>{await $e()},{deep:!0}),r(Ie,async()=>{await $e()},{deep:!0}),r(_e,async()=>{await $e()},{deep:!0}),r(Re,async()=>{await $e()},{deep:!0}),r(je,async()=>{await $e()},{deep:!0}),r(ue,async e=>{Ne(),Ve(),Oe.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]},{deep:!0}),r(we,async(e,t)=>{e.ID!=t.ID&&(Ne(),Ve())},{deep:!0}),i({saveData:Je,markWizard:$e,refreshWizard:Ne,validateDoneButtonState:ke}),(e,i)=>{const a=u("PresentingComplaints"),n=u("DrugHistory"),l=u("PastMedicalHistory"),s=u("PastSurgicalHistory"),o=u("Allergy"),r=u("Intoxication"),c=u("SocialHistory"),P=u("FamilyHistory"),w=u("ReviewOfSystems"),x=u("PhysicalExamination"),I=u("Summary"),_=u("DifferentialDiagnosis"),R=u("Investigation"),j=u("ManagementPlan");return v(),g(m(H),null,{default:d(()=>[y(T),y(m(f),{fullscreen:!0},{default:d(()=>[y(q),S("div",t,[ge.value?(v(),g(K,{key:0,ref:"wizard",headingTitle:"Medical Inpatient Admission Sheet","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:ye.value,"custom-tabs":Oe.value,beforeChange:m(oe),onChange:Ue,"onComplete:wizard":i[1]||(i[1]=e=>Je()),onDoneButtonChanged:Te},{default:d(()=>[S("div",null,[S("div",se,[y(k,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:m(b),"font-weight":"600",onClick:i[0]||(i[0]=e=>{ce.push("/patientProfile")})},null,8,["icon"])])]),h(S("div",null,[y(a,{ref:"presentingComplaintsRef"},null,512)],512),[[D,"PresentingComplaints"==ze()]]),h(S("div",null,[y(n,{ref:"drugHistoryRef"},null,512)],512),[[D,"DrugHistory"==ze()]]),h(S("div",null,[y(l,{ref:"pastMedicalHistoryRef"},null,512)],512),[[D,"PastMedicalHistory"==ze()]]),h(S("div",null,[y(s,{ref:"pastSurgicalHistoryRef"},null,512)],512),[[D,"PastSurgicalHistory"==ze()]]),h(S("div",null,[y(o,{ref:"allergyRef"},null,512)],512),[[D,"Allergy"==ze()]]),h(S("div",null,[y(r,{ref:"IntoxicationRef"},null,512)],512),[[D,"Intoxication"==ze()]]),h(S("div",null,[y(c,{ref:"socialHistoryRef"},null,512)],512),[[D,"SocialHistory"==ze()]]),h(S("div",null,[y(P,{ref:"familyHistoryRef"},null,512)],512),[[D,"FamilyHistory"==ze()]]),h(S("div",null,[y(w,{ref:"reviewOfSystemsRef"},null,512)],512),[[D,"ReviewOfSystems"==ze()]]),h(S("div",null,[y(x,{ref:"physicalExaminationRef"},null,512)],512),[[D,"PhysicalExamination"==ze()]]),h(S("div",null,[y(I,{ref:"summaryRef"},null,512)],512),[[D,"Summary"==ze()]]),h(S("div",null,[y(_,{ref:"differentialDiagnosisRef"},null,512)],512),[[D,"DifferentialDiagnosis"==ze()]]),h(S("div",null,[y(R,{ref:"investigationRef"},null,512)],512),[[D,"Investigation"==ze()]]),h(S("div",null,[y(j,{ref:"managementPlanRef"},null,512)],512),[[D,"ManagementPlan"==ze()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):p("",!0)])]),_:1})]),_:1})}}}))}}});
