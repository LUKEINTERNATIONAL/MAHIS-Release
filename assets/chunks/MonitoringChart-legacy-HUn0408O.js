System.register(["./vendor-legacy-D3PRHnoP.js","../index-legacy-B3Vp8rl1.js","./DemographicBar-legacy-BAZf3HCV.js","./ReusableDataTable-legacy-lmVLfnsn.js","./useRespiratoryRateOxygenForm-legacy-Bywdv7jt.js","./nonPharmaTherapyStore-legacy-DchTqupt.js","./ComplicationsStore-legacy-BsdsCid4.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-DRG1LLSI.js","./usePatientProfile-legacy-BYXmxaZm.js","./apexcharts-legacy-BGLXb50r.js","./drug_prescription_service-legacy-BYaQj1m_.js","./patient_diagnosis_service-legacy-_vRNFuth.js","./Registration-legacy-BG3CGIQU.js","./useLocation-legacy-Bh-SgiVI.js","./vaccines_service-legacy-DB5ukpv6.js","./sms_service-legacy-o-GBSogh.js","./EIRreportsStore-legacy-DSdmtLNy.js","./Export-legacy-Bz92lUKn.js","./user_role_management-legacy-CU5iDn5f.js","./useNeonatalEnrollmentStore-legacy-lJ9QGEZy.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-D_Mq1TUl.js","./wardsStore-legacy-B91Hs9J5.js"],function(e,t){"use strict";var n,a,i,l,o,s,r,c,u,d,v,m,p,g,y,h,b,f,_,S,D,w,T,F,I,M,k,x,j,P,C,A,R,O,B,L,E,N,V,z,H,G,U,$,J,W,K,Q,q,X,Y,Z,ee,te,ne,ae,ie,le,oe,se,re,ce,ue,de,ve,me,pe,ge,ye,he;return{setters:[e=>{n=e.c,a=e.d,i=e.r,l=e.O,o=e.f,s=e.u,r=e.br,c=e.J,u=e.l,d=e.e,v=e.P,m=e.k,p=e.m,g=e.F,y=e.aV,h=e.H,b=e.Q,f=e.ap,_=e.cp,S=e.aW,D=e.w,w=e.a,T=e.a4,F=e.i,I=e.bM,M=e.v,k=e.a7,x=e.ba},e=>{j=e.l,P=e.aD,C=e.J,A=e.aI,R=e.u,O=e.aJ,B=e.aK,L=e.aL,E=e.aM,N=e.d,V=e.aN,z=e.g,H=e.$,G=e.e,U=e.T,$=e.N,J=e.H,W=e.aO,K=e.aP,Q=e.aQ,q=e.aR,X=e.t,Y=e.aT,Z=e.G,ee=e.aU,te=e.a1,ne=e.S},e=>{ae=e.D},e=>{ie=e.R},e=>{le=e.u,oe=e.a,se=e.b},e=>{re=e.u,ce=e._,ue=e.s,de=e.c,ve=e.a},e=>{me=e.u},e=>{pe=e.l},e=>{ge=e.a,ye=e.b},e=>{he=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const t=()=>{const e=n(()=>[{componentType:"multiSelectInputField",header:"Airway intervention(s)",name:"airway_interventions",isMultiple:!0,trackBy:"id",icon:j.search,options:[{id:1,name:"Positioning"},{id:2,name:"Suctioning"},{id:3,name:"Airway Adjuncts"},{id:4,name:"Advanced Airway"}]},{componentType:"multiSelectInputField",header:"Breathing intervention(s)",name:"breathing_interventions",isMultiple:!0,trackBy:"id",icon:j.search,options:[{id:1,name:"Oxygen Therapy"},{id:2,name:"Inhaled Medications"},{id:3,name:"Chest Decompression"},{id:4,name:"Mechanical Ventilation"}]},{componentType:"multiSelectInputField",header:"Circulation intervention(s)",name:"circulation_interventions",isMultiple:!0,trackBy:"id",icon:j.search,options:[{id:1,name:"IV/IO Access"},{id:2,name:"Fluid Resuscitation"},{id:3,name:"Medications"},{id:4,name:"Blood Products"}]},{componentType:"multiSelectInputField",header:"Disability intervention(s)",name:"disability_interventions",isMultiple:!0,trackBy:"id",icon:j.search,options:[{id:1,name:"Blood Glucose Administration"},{id:2,name:"Seizure Management"},{id:3,name:"Pain Management"}]},{componentType:"multiSelectInputField",header:"Exposure intervention(s)",name:"exposure_interventions",isMultiple:!0,trackBy:"id",icon:j.search,options:[{id:1,name:"Warming Measures"},{id:2,name:"Cooling Measures"},{id:3,name:"Thermal Protection"},{id:4,name:"Electrical Protection"}]}]);return{fluidsFormSection:n(()=>[{componentType:"Dashes"},{componentType:"multiSelectInputField",header:"Intake Fluid Type",name:"intake_fluid_type",isMultiple:!0,trackBy:"id",icon:j.search,grid:{s:"4"},options:[{id:1,name:"Normal Saline"},{id:2,name:"Ringer's Lactate"},{id:3,name:"Dextrose Solution"},{id:4,name:"Blood Products"}]},{componentType:"multiSelectInputField",header:"Output Fluid Type",name:"output_fluid_type",isMultiple:!0,trackBy:"id",icon:j.search,grid:{s:"4"},options:[{id:1,name:"Urine"},{id:2,name:"Vomitus"},{id:3,name:"Drainage"},{id:4,name:"Blood Loss"}]},{componentType:"inputField",header:"Fluid Balance",name:"fluid_balance",unit:"ml",grid:{s:"4"}},{componentType:"inputField",header:"Intake Fluid Amount",name:"intake_fluid_amount",unit:"ml",grid:{s:"4"}},{componentType:"inputField",header:"Output Fluid Amount",name:"output_fluid_amount",unit:"ml",grid:{s:"4"}}]),interventionsFormSection:e}},be=a({__name:"Interventions",setup(e){i(null);const a=i([]),h=t().interventionsFormSection,b=t().fluidsFormSection,f=i([n(()=>b.value)]);return(e,t)=>(o(),l(s(r),null,{default:c(()=>[u(s(y),null,{default:c(()=>[u(P,{formData:s(h),ref:"formRef"},null,8,["formData"]),(o(!0),d(g,null,v(f.value,(e,i)=>(o(),d("div",{key:i,style:{display:"flex","align-items":"center"}},[u(P,{formData:e.value,ref_for:!0,ref:e=>((e,t)=>{e&&(a.value[t]=e)})(e,i)},null,8,["formData"]),m("div",null,[u(C,{onClick:e=>(e=>{f.value.length>1&&(f.value.splice(e,1),a.value.splice(e,1))})(i),fill:"clear",icon:s(j).minus,disabled:1===f.value.length},null,8,["onClick","icon","disabled"]),i===f.value.length-1?(o(),l(C,{key:0,onClick:t[0]||(t[0]=e=>{f.value.push(n(()=>b.value))}),fill:"clear",icon:s(j).plus},null,8,["icon"])):p("",!0)])]))),128))]),_:1})]),_:1}))}}),fe=a({__name:"Medications",setup(e){const t=["Medication","Name","Dose","Frequency","Duration","Formulation","Prescriber"],n={responsive:!0,ordering:!1,layout:{topStart:"buttons",topEnd:"",bottomStart:"info",bottomEnd:"paging"},buttons:[{text:" <b> Print Medication </b>",className:"add-test text-white",action:async()=>{}}]},a=[["Antibiotic","Amoxicillin","500 mg","3 times a day","7 days","Capsule","Dr. Smith"],["Analgesic","Paracetamol","650 mg","4 times a day","5 days","Tablet","Dr. Johnson"],["Antihypertensive","Lisinopril","10 mg","Once daily","30 days","Tablet","Dr. Lee"]];return(e,i)=>{const d=h("ion-card-title");return o(),l(s(r),null,{default:c(()=>[u(s(y),null,{default:c(()=>[u(d,null,{default:c(()=>[...i[0]||(i[0]=[b("Prescribed Medication",-1)])]),_:1}),u(ie,{data:a,headers:t,options:n})]),_:1})]),_:1})}}}),_e=le(),Se=oe(),De=se(),we=n(()=>[{grid:{s:"3"}},{grid:{s:"9"},componentType:"Dashes"},..._e.bloodPressureFormSection.value,{grid:{s:"3"}},{grid:{s:"9"},componentType:"Dashes"},...Se.temperaturePulseRateForm.value,...De.respiratoryRateOxygenForm.value]),Te=a({__name:"Observations",setup(e){const t=i(null),a=n(()=>[...we.value,{componentType:"Dashes"},{componentType:"inputField",header:"Random Blood Glucose (RBG)",name:"random_blood_glucose",unit:"mg/dL"},{componentType:"inputField",header:"Urine Dipstick - Ketones",name:"urine_dipstick_ketones"},{componentType:"multiSelectInputField",header:"AVPU Scale",name:"avpu_scale",isMultiple:!1,trackBy:"id",icon:j.search,options:[{id:1,name:"Alert"},{id:2,name:"Verbal Response"},{id:3,name:"Pain Response"},{id:4,name:"Unresponsive"}]},{componentType:"inputField",header:"Peak Expiratory Flow Rate (PEFR)",name:"peak_expiratory_flow_rate",unit:"L/min"}]);return(e,n)=>(o(),l(s(r),null,{default:c(()=>[u(s(y),null,{default:c(()=>[u(P,{formData:s(a),ref_key:"formRef",ref:t},null,8,["formData"])]),_:1})]),_:1}))}}),Fe={style:{width:"90vw",margin:"0 auto","margin-top":"10px"}},Ie={class:"back_profile"};e("default",a({__name:"MonitoringChart",setup(e,{expose:t}){const{onTabBeforeChange:a,currentTabIndex:r}=re();he();const d=f(),v=_();i([]),i([]),i(!1);const g=i(!0),y=i(!1),h=i(!1),b=n(()=>({text:h.value?"Saving...":"Finish",icon:h.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:y.value||h.value})),j=A(),P=R(),ie=O(),le=B();L();const oe=E(),se=N();V();const _e=z(),Se=me(),De=H(),{patient:we}=S(P),{vitals:Me}=S(j),{investigations:ke}=S(ie),{diagnosis:xe}=S(le),{substance:je}=S(_e),{selectedNCDMedicationList:Pe}=S(oe),{FootScreening:Ce,visualScreening:Ae,cvScreening:Re}=S(Se),{sessionDate:Oe}=S(De),{apiStatus:Be}=S(G());D(b,(e,t)=>{console.log("Done button options changed:",{from:t,to:e,currentStep:r.value,tabsLength:Ne.value.length}),e.disabled!==(null==t?void 0:t.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==t?void 0:t.text)&&console.log(`Done button text changed from "${null==t?void 0:t.text}" to "${e.text}"`)},{deep:!0}),D(h,(e,t)=>{e!==t&&(console.log(`Saving state changed: ${t} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Le=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Ee=()=>{let e=!1;return He(),h.value&&(e=!0),y.value=e,!e},Ne=i([{title:"Observations",icon:""},{title:"Interventions",icon:""},{title:"Medications",icon:""}]),Ve=i(null),ze=i(null),He=()=>{var e;if(!Ne.value||0===Ne.value.length)return console.log("Tabs not yet initialized"),null;const t=r.value>=0&&r.value<Ne.value.length?r.value:0;switch(null===(e=Ne.value[t])||void 0===e?void 0:e.title){case"Observations":return"Observations";case"Interventions":return"Interventions";case"Medications":return"Medications";default:if(se.NCDActivities.length>0)switch(se.NCDActivities[0]){case"Observations":return"Observations";case"Interventions":return"Interventions";case"Medications":return"Medications"}return null}},Ge=()=>{g.value=!1,setTimeout(()=>{r.value=0,g.value=!0},0)},Ue=()=>{const e=A();e.setVitals(e.getInitialVitals(we.value.ID))},$e=async()=>{const e=$(Oe.value,"sessionDate","value")||J.sessionDate(),t=W("vitals");for(let a=0;a<Ne.value.length;a++){const i=Ne.value[a];if("Vital Signs"===i.title)Ne.value[a].icon=Je(e,t)?x:"";else if("Risk Assessment"===i.title){const t=W("substanceAbuse");Ne.value[a].icon=Je(e,t)?x:""}else if("Investigations"===i.title){var n;const t=null==we||null===(n=we.value)||void 0===n||null===(n=n.labOrders)||void 0===n?void 0:n.saved,i=null==t?void 0:t.filter(t=>J.toStandardHisFormat(e)===J.toStandardHisFormat(t.order_date));Ne.value[a].icon=(null==i?void 0:i.length)>0?x:""}else if("Diagnosis"===i.title){const t=W("diagnosis");Ne.value[a].icon=Je(e,t)?x:""}else if("Complications Screening"===i.title){const t=W("screening");Ne.value[a].icon=Je(e,t)?x:""}else"Treatment Plan"===i.title&&(Pe.value.length>0?Ne.value[a].icon=K()?x:"":Ne.value[a].icon="")}Ee()},Je=(e,t)=>{const n=new Date(e);return n.setHours(0,0,0,0),t.some(e=>{const t=new Date(e.obs_datetime);return t.setHours(0,0,0,0),t.getTime()===n.getTime()})},We=async(e,t)=>{var n;const a=null===(n=Ne.value[t])||void 0===n?void 0:n.title;var i,l;e%1==0&&(r.value=e),"Vital Signs"==a&&(null===(i=Ve.value)||void 0===i||i.onSubmit()),"Risk Assessment"==a&&(null===(l=ze.value)||void 0===l||l.onSubmit()),"Complications Screening"==a&&await(async()=>{const e=[],t=await ge(Ae.value),n=await ye(Ce.value),a=await ge(Re.value);var i,l,o,s;t.length>0&&e.push({concept_id:await Y.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:Y.getSessionDate(),child:t}),n.length>0&&e.push({concept_id:await Y.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:Y.getSessionDate(),child:n}),a.length>0&&e.push(...a),e.length>0?(null!==(l=(i=null!==(s=(o=we.value).screening)&&void 0!==s?s:o.screening={}).unsaved)&&void 0!==l||(i.unsaved=[]),we.value.screening.unsaved.push(...e),Z("Complications saved successfully")):X("No complications data to save")})(),"Treatment Plan"==a&&await(async()=>{const e=ee();if(!pe.isEmpty(e.selectedMedicalAllergiesList)){const t=te(),n=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:ne.getSessionDate(),value_coded:e.concept_id,location_id:t.facilityLocation.code,value_text:e.name})),a=await ue(n);we.value=Object.assign(we.value,a),console.log("Allergies staged successfully:",we.value),e.clearSelectedMedicalAllergiesList()}const t=await de();we.value=Object.assign(we.value,t);const n=await ve().saveNonPharmaTherapyPatientData();we.value=Object.assign(we.value,n)})(),await Q(we.value)},Ke=async()=>{h.value=!0;try{await q(),await Q(we.value),d.push("/triageList")}catch(e){console.error("Error saving data:",e),X("Error occurred while saving data. Please try again.")}finally{h.value=!1}};return w(async()=>{0!==se.NCDActivities.length?(me().resetScreening(),Ne.value=[{title:"Observations",icon:""},{title:"Interventions",icon:""},{title:"Medications",icon:""}],await $e(),(void 0===r.value||r.value<0)&&(r.value=0,console.log("Setting initial tab index to 0")),y.value=!1,h.value=!1,Ee()):d.push("patientProfile")}),D(r,async()=>{await Ee()}),D(Me,async()=>{await $e()},{deep:!0}),D(we,async()=>{me().resetScreening(),await $e()},{deep:!0}),D(Oe,async()=>{await $e()},{deep:!0}),D(ke,async()=>{await $e()},{deep:!0}),D(xe,async()=>{await $e()},{deep:!0}),D(je,async()=>{await $e()},{deep:!0}),D(Pe,async()=>{await $e()},{deep:!0}),D(v,async e=>{Ge(),Ue(),Ne.value=[{title:"Observations",icon:""},{title:"Interventions",icon:""},{title:"Medications",icon:""}]},{deep:!0}),D(we,async(e,t)=>{e.ID!=t.ID&&(Ge(),Ue())},{deep:!0}),t({saveData:Ke,markWizard:$e,refreshWizard:Ge,validateDoneButtonState:Ee}),(e,t)=>(o(),l(s(k),null,{default:c(()=>[u(U),u(s(T),{fullscreen:!0},{default:c(()=>[u(ae),m("div",Fe,[g.value?(o(),l(ce,{key:0,ref:"wizard",headingTitle:"Monitoring Chart","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:b.value,"custom-tabs":Ne.value,beforeChange:s(a),onChange:We,"onComplete:wizard":t[1]||(t[1]=e=>Ke()),onDoneButtonChanged:Le},{default:c(()=>[m("div",null,[m("div",Ie,[u(C,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:s(I),"font-weight":"600",onClick:t[0]||(t[0]=e=>{d.push("/patientProfile")})},null,8,["icon"])])]),F(m("div",null,[u(Te,{ref:"observationsRef"},null,512)],512),[[M,"Observations"==He()]]),F(m("div",null,[u(be,{ref:"interventionsRef"},null,512)],512),[[M,"Interventions"==He()]]),F(m("div",null,[u(fe,{ref:"medicationsRef"},null,512)],512),[[M,"Medications"==He()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):p("",!0)])]),_:1})]),_:1}))}}))}}});
