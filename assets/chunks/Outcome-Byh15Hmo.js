import{d as K,a2 as M,ad as $,a6 as ge,H as G,e as z,f,P as fe,O as v,J as a,l as o,Q as x,K as T,k as U,p as ce,F as ae,r as l,w as Z,u as e,e9 as be,m as I,bZ as we,a as ee,bw as te,aR as le,aS as oe,ac as R,br as ve,ed as he,bt as ne,aa as re,aV as se,N as De,b2 as Se,c as Ie,ah as ke}from"./vendor-BTebhqHt.js";import{k as Ve,a3 as Ce,n as Fe,_ as Q,B as _e,b2 as de,t as Y,g as Ae,aH as me,D as j,Z as Be,V as He,aX as Pe,a as Ue,aJ as xe,aK as Ne,aA as Ee,ah as Te,o as Re,b8 as $e,S as pe,H as ie,F as Oe}from"../index-DBQF-8Xn.js";import{u as Le}from"./wardsStore-DgQn54tV.js";import{l as Me}from"./lodash-NJiRuGo9.js";const qe=K({components:{IonItem:ge,IonCol:$,IonLabel:M},data(){return{iconsContent:Fe}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(u){const p=document.getElementById(u+"_lbl");p&&(p.style.color="#006401"),this.highlightActionBtns(u)},undoHighlightItem(u){const p=document.getElementById(u+"_lbl");p&&(p.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(u)},highlightActionBtns(u){const p=document.getElementsByClassName(u+"_spanlbl");for(let m=0;m<p.length;m++)p[m].style.display="block"},undohighlightActionBtns(u){const p=document.getElementsByClassName(u+"_spanlbl");for(let m=0;m<p.length;m++)p[m].style.display="none"},asignLblID(u){return u+"_lbl"},asignSpanLblID(u){return u+"_spanlbl"},async removeItemAtIndex(u,p){await Ce("Do you want to delete it?",p)&&this.$emit("update:removeItem",u)},async editItemAtIndex(u,p,m){await Ve("Do you want to edit it?",m)&&this.$emit("update:editItem",{index:u,item:p})},fomartDate(u){const p=u.year,m=(u.month<10?"0":"")+u.month,w=(u.day<10?"0":"")+u.day;return p+"-"+m+"-"+w}}});function We(u,p,m,w,k,h){const y=G("ion-label"),D=G("ion-col"),S=G("ion-icon"),b=G("ion-item");return f(!0),z(ae,null,fe(u.displayData,(r,d)=>(f(),v(b,{displayData:u.displayData,class:"ionLbltp",key:d,onMousemove:g=>u.highlightItem(d),onMouseout:g=>u.undoHighlightItem(d)},{default:a(()=>[o(D,{class:"col-st1"},{default:a(()=>[o(y,{id:u.asignLblID(d),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[x(T(r.type),1)]),_:2},1032,["id"])]),_:2},1024),o(D,{class:"col-st2"},{default:a(()=>[o(y,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[p[0]||(p[0]=U("span",{class:"spaceBetween"},null,-1)),x(" "+T(r.name)+" ",1),p[1]||(p[1]=U("span",{class:"spaceBetween"},null,-1)),x(T(r.reason),1),p[2]||(p[2]=U("span",{class:"spaceBetween"},null,-1)),x(T(u.fomartDate(r.date)),1)]),_:2},1024)]),_:2},1024),o(D,{class:"action_buttons"},{default:a(()=>[o(y,{class:ce(u.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:g=>u.editItemAtIndex(d,r,g)},{default:a(()=>[o(S,{icon:u.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),o(y,{class:ce(u.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:g=>u.removeItemAtIndex(d,g)},{default:a(()=>[o(S,{icon:u.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const Ke=Q(qe,[["render",We],["__scopeId","data-v-4346bf77"]]),ye=K({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(u,{emit:p}){const m=l(),w=l({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),k=l(),h={name:"Now",show:!0,fn:O},y=l(!0),D=l(!1),S=l(0),b=u;Z(()=>b.time_prop,P=>{P&&(m.value=P.time)},{immediate:!0,deep:!0});const r=p;function d(){r("timeUpDated",k.value)}function g(P){D.value==!0?(y.value=!1,D.value=!1):y.value=!0,w.value.isOpen=!0,w.value.event=P}function H(P){m.value=P.detail.value;const A=F(m.value);if(N(A)==!0){O();return}m.value=A}function N(P){return P.indexOf("NaN")!==-1}function F(P){let A=new Date(P),B=A.getHours(),q=A.getMinutes(),L=B>=12?"PM":"AM";B=B%12,B=B||12;let i=B.toString().padStart(2,"0")+":"+q.toString().padStart(2,"0")+" "+L;return k.value={time:i,meridian:L},d(),i}function O(){D.value=!0,m.value=F(new Date),y.value=!1,S.value++}return(P,A)=>{const B=G("ion-popover");return f(),z(ae,null,[(f(),v(_e,{placeholder:b.place_holder.default,inputValue:m.value,icon:e(be),"-inner-action-btn-propeties":h,"onClicked:inputValue":g,"onUpdate:InnerActionBtnPropetiesAction":h.fn,key:S.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),o(B,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":w.value.isOpen,event:w.value.event,side:"top",onDidDismiss:A[0]||(A[0]=q=>w.value.isOpen=!1)},{default:a(()=>[y.value?(f(),v(e(we),{key:0,onIonChange:H,id:"datetime",presentation:"time","show-default-buttons":!0})):I("",!0)]),_:1},8,["is-open","event"])],64)}}}),Je=K({name:"xxxComponent"}),Ze=K({...Je,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l([]),w=de(),k=l(NaN),h=l(!1),y=l(),D=l(!1);ee(async()=>{A(),H()});const S=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:B},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:C}],b=[{placeHolder:"Reason",dataHandler:O,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],r=[{placeHolder:{default:"Enter date"},dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],d=[{placeHolder:{default:"Enter time of admission"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"error"}],g=u;Z(()=>g.selected_ward_prop,_=>{_&&(y.value=_)},{immediate:!0,deep:!0}),Z(()=>g.admitted_other_props,_=>{_&&(b[0].dataValue.value=_.reason,d[0].dataValue.value=_.time,r[0].dataValue.value=_.date)},{immediate:!0,deep:!0});function H(_=!0){D.value=_}function N(_){d[0].dataValue.value=_,B(!1)}function F(_){const n={day:_.value.day,month:_.value.month,year:_.value.year,formattedDate:_.value.formattedDate};r[0].dataValue.value=n,B(!1)}function O(_){const n=_.target.value;b[0].dataValue.value=n,P(),H(!1)}function P(){D.value==!0&&Y("Remember to press the SAVE button",1e4)}async function A(_){try{m.value=await Ae("wards"),m.value.length==0&&(m.value=Le().wards),m.value.forEach(n=>{const c={name:n.name,selected:!1,other:n,location_ward_id:n.other.location_id};m.value.push(c)})}catch(n){console.error("err: ",n)}}function B(_=!0){q(),L(),V(),W(),r[0].show_error.value==!1&&d[0].show_error.value==!1&&b[0].show_error.value==!1&&h.value==!1?i():_&&Y("Please enter correct data values",4e3)}function q(){y.value===void 0||y.value==""?h.value=!0:h.value=!1}function L(){b[0].dataValue.value==""||b[0].dataValue.value===void 0?b[0].show_error.value=!0:b[0].show_error.value=!1}async function i(){const _={name:y.value.name,type:"Admitted for short stay",ward_name:y.value.name,date:r[0].dataValue,time:d[0].dataValue,reason:b[0].dataValue,other:y.value,selected:!0};await w.addOutcomeData(_,k.value)&&s({dataSaved:!1})}const t=p;function s(_={dataSaved:!0}){t("dataSaved",_)}function C(){s()}function V(){r[0].dataValue.value===void 0||r[0].dataValue.value==""?r[0].show_error.value=!0:r[0].show_error.value=!1}function W(){d[0].dataValue.value===void 0||r[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}const X=_=>{y.value=_,H(),B(!1)};return(_,n)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),{onClick:n[0]||(n[0]=c=>A("dd"))},{default:a(()=>[...n[4]||(n[4]=[x("Admitted for Short Stay",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(ve),{modelValue:y.value,"onUpdate:modelValue":[n[1]||(n[1]=c=>y.value=c),n[2]||(n[2]=c=>X(c))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:n[3]||(n[3]=c=>c={}),"track-by":"location_ward_id",options:m.value},null,8,["modelValue","options"]),U("div",null,[h.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[...n[5]||(n[5]=[x(T("Please select a ward"),-1)])]),_:1})):I("",!0)])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:r[0].placeHolder,onDateUpDated:r[0].dataHandler,date_prop:r[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:d[0].placeHolder,onTimeUpDated:d[0].dataHandler,time_prop:d[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[d[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(d[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:b[0].placeHolder,icon:e(he),inputValue:b[0].dataValue.value,"onUpdate:inputValue":b[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[b[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(b[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),S[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[S[0].addItemButton?(f(),v(j,{key:0,name:S[0].name,fill:S[0].btnFill,icon:e(ne),"onClicked:btn":S[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),S[1].addItemButton?(f(),v(j,{key:1,name:S[1].name,fill:S[1].btnFill,icon:e(re),"onClicked:btn":S[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),je=Q(Ze,[["__scopeId","data-v-2508fb5d"]]),ze=K({name:"xxxComponent"}),Qe=K({...ze,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l(NaN),w=l(null),k=de(),h=l(!1),y=l([]),D=l({}),S=l(!0),b={location_data:{}},r=[{placeHolder:"Reason",dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],d=[{placeHolder:{default:"Enter date"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],g=[{placeHolder:{default:"Enter time of referral"},dataHandler:P,dataValue:l(),show_error:l(!1),error_message:"error"}],H=u;Z(()=>H.selected_other_referral_data,n=>{n&&(r[0].dataValue.value=n.reason,d[0].dataValue.value=n.date,g[0].dataValue.value=n.time)},{immediate:!0,deep:!0}),Z(()=>H.selected_referral_data,n=>{if(!n)return;w.value=n.selected_location,b.location_data=n;const c=Array.isArray(n.selected_district_ids)?[...n.selected_district_ids]:[],E=n.selected_location?{...n.selected_location}:null;y.value=c,D.value=E},{immediate:!0,deep:!0}),ee(()=>{t()});function N(n){const c={day:n.value.day,month:n.value.month,year:n.value.year,formattedDate:n.value.formattedDate};d[0].dataValue.value=c,A(!1)}function F(n){const c=n.target.value;r[0].dataValue.value=c,O(),t(!1)}function O(){S.value==!0&&Y("Remember to press the SAVE button",1e4)}function P(n){g[0].dataValue.value=n,A(!1)}function A(n=!0){i(),B(),q(),L(),d[0].show_error.value==!1&&g[0].show_error.value==!1&&r[0].show_error.value==!1&&h.value==!1?C():n&&Y("Please enter correct data values",4e3)}function B(){r[0].dataValue.value==""||r[0].dataValue.value===void 0?r[0].show_error.value=!0:r[0].show_error.value=!1}function q(){d[0].dataValue.value===void 0||d[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}function L(){g[0].dataValue.value===void 0||d[0].dataValue.value==""?g[0].show_error.value=!0:g[0].show_error.value=!1}function i(){w.value?h.value=!1:h.value=!0}function t(n=!0){S.value=n}const s=n=>{w.value=n.selected_location,i(),b.location_data=n,t(),A(!1)},C=async()=>{const n={name:w.value.name,facility_code:w.value.code,facility_name:w.value.name,facility_district:w.value.district,type:"Referred out",selected:!0,date:d[0].dataValue,time:g[0].dataValue,reason:r[0].dataValue},c={...n,other:{ref_data:n,location_data:b.location_data}};await k.addOutcomeData(c,m.value)&&X({dataSaved:!1})},V=()=>{X()},W=p;function X(n={dataSaved:!0}){W("dataSaved",n)}const _=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:A},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:V}];return(n,c)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...c[0]||(c[0]=[x("Referred Out",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(Be,{show_error:h.value,onFacilitySelected:s,selected_district_ids:y.value,selected_location:D.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:d[0].placeHolder,onDateUpDated:d[0].dataHandler,date_prop:d[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[d[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(d[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:g[0].placeHolder,onTimeUpDated:g[0].dataHandler,time_prop:g[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[g[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(g[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:r[0].placeHolder,icon:e(he),inputValue:r[0].dataValue.value,"onUpdate:inputValue":r[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),_[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[_[0].addItemButton?(f(),v(j,{key:0,name:_[0].name,fill:_[0].btnFill,icon:e(ne),"onClicked:btn":_[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),_[1].addItemButton?(f(),v(j,{key:1,name:_[1].name,fill:_[1].btnFill,icon:e(re),"onClicked:btn":_[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),Xe=Q(Qe,[["__scopeId","data-v-7b6ec0cf"]]),Ge=K({name:"xxxComponent"}),Ye=K({...Ge,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l(NaN),w=l([]),k=de(),h=l();ee(async()=>{N("")});const y=[{placeHolder:"Reason",dataHandler:r,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],D=[{placeHolder:{default:"Enter date"},dataHandler:b,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],S=u;Z(()=>S.selected_discharged_prop,t=>{t&&(h.value=t)},{immediate:!0,deep:!0}),Z(()=>S.selected_discharged_data,t=>{t&&(D[0].dataValue.value=t.date||"",t.reason&&(y[0].dataValue.value=t.reason))},{immediate:!0,deep:!0});function b(t){const s={day:t.value.day,month:t.value.month,year:t.value.year,formattedDate:t.value.formattedDate};D[0].dataValue.value=s,O(!1)}function r(t){const s=t.target.value;y[0].dataValue.value=s}w.value,l(!1),l(!1);const d=[{placeHolder:{default:"Enter time of referral"},dataHandler:g,dataValue:l(),show_error:l(!1),error_message:"error"}];function g(t){d[0].dataValue.value=t}const H=new Set;async function N(t){const s=t,C=await He.getFacilities({name:s});C||C.forEach(V=>{H.has(V.location_id)||(H.add(V.location_id),Me.isEmpty(V.name)==!1&&w.value.push({name:V.name,selected:!1,other:V}))})}function F(t){w.value=t}function O(t=!0){P(),D[0].show_error.value?t&&Y("Please enter a valid date",4e3):A()}function P(){D[0].dataValue.value===void 0||D[0].dataValue.value==""?D[0].show_error.value=!0:D[0].show_error.value=!1}async function A(){const t={type:"Discharged Home",date:D[0].dataValue,reason:y[0].dataValue.value,selected:!0};await k.addOutcomeData(t,m.value)&&L({dataSaved:!1})}function B(){L()}const q=p;function L(t={dataSaved:!0}){q("dataSaved",t)}const i=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:O},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:B}];return(t,s)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...s[0]||(s[0]=[x("Discharged Home",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:D[0].placeHolder,onDateUpDated:D[0].dataHandler,date_prop:D[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[D[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(D[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),i[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[i[0].addItemButton?(f(),v(j,{key:0,name:i[0].name,fill:i[0].btnFill,icon:e(ne),"onClicked:btn":i[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),i[1].addItemButton?(f(),v(j,{key:1,name:i[1].name,fill:i[1].btnFill,icon:e(re),"onClicked:btn":i[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),ea=Q(Ye,[["__scopeId","data-v-e39df163"]]),aa={class:"date-results-container"},ta={class:"date-buttons-container"},la={key:0,class:"validation-message"},oa={__name:"DatePillSelector",props:{availableDates:{type:Array,required:!0,default:()=>[]}},emits:["dateSelected"],setup(u,{expose:p,emit:m}){const w=u,k=m,h=l(null),y=l(!1),D=d=>{h.value=d,y.value=!1,k("dateSelected",{date:w.availableDates[d],index:d})},S=d=>{const g=new Date(d),H={weekday:"short",month:"short",day:"numeric"};return isNaN(g)?d:g.toLocaleDateString("en-US",H)};return p({validateSelection:()=>h.value===null?(y.value=!0,!1):(y.value=!1,!0),getSelectedDate:()=>h.value!==null?w.availableDates[h.value]:null}),(d,g)=>(f(),z("div",aa,[U("div",ta,[(f(!0),z(ae,null,fe(u.availableDates,(H,N)=>(f(),v(e(De),{key:N,class:ce(["date-button",{selected:h.value===N,"error-border":y.value&&h.value!==N}]),fill:"outline",shape:"round",onClick:F=>D(N)},{default:a(()=>[x(T(S(H)),1)]),_:2},1032,["class","onClick"]))),128))]),y.value?(f(),z("p",la," ⚠️ Please select an available date to proceed. ")):I("",!0)]))}},na=Q(oa,[["__scopeId","data-v-1e34f199"]]);class ra extends Pe{constructor(p,m){super(p,114,m)}}const sa=K({__name:"ReferToAnotherClinic",emits:["programDateSelected","referralDataReady","dataSaved"],setup(u,{emit:p}){const m=p,w=l([]),k=l([]),h=l([]),y=Ue(),D=xe(),{activeProgram:S}=Se(y),b=l(!1),r=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Clinics",placeHolder:"Search for programs",items:[],listUpdatedFN:P,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:l(!1),error_message:"Please select one or more clinics/programs to refer to.",disabled:l(!1)}],d=async()=>{b.value=!1;const i=k.value.length>0;if(r[0].show_error.value=!i,!i){console.log("Validation Failed: No programs selected.");return}let t=!0;h.value=[];for(const s of k.value)if(s.dateSelectorRef)if(!s.dateSelectorRef.validateSelection())t=!1;else{const V=s.dateSelectorRef.getSelectedDate();V?h.value.push({programId:s.id,programName:s.name,date:V}):t=!1}else t=!1,console.error("Date Selector ref is missing for program ".concat(s.name));if(!t){b.value=!0,console.log("Validation Failed: Not all dates selected.");return}console.log("Validation Passed! Ready to refer patient with data:",h.value),m("referralDataReady",h.value),await L(h.value,g)},g=async i=>{try{const t=pe.getUserID(),s=pe.getPatientID(),C=new ra(s,t);await C.createEncounter();const V=i.map(W=>({concept_id:2227,value_numeric:W.programId,obs_datetime:ie.sessionDate(),child:[{concept_id:11242,value_text:ie.toStandardHisFormat(W.date),obs_datetime:ie.sessionDate()}]}));await C.saveObservationList(V),Oe("Patient referral saved successfully"),N()}catch(t){Y("Error saving referral data. Please try again.",4e3),console.error("Error in sub_refferal_data:",t)}},H=()=>{N()};function N(i={dataSaved:!0}){m("dataSaved",i)}const F=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:d},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:H}],O=(i,t,s)=>{m("programDateSelected",{programId:t,programName:s,date:i}),b.value=!1;const C=h.value.findIndex(W=>W.programId===t),V={programId:t,programName:s,date:i};C>-1?h.value[C]=V:h.value.push(V)};async function P(i){w.value=i,A(),b.value=!1,await B()}function A(){const i=[];w.value.forEach(s=>{s.selected==!0&&i.push(s.other)});const t=i.map(s=>s.program_id);k.value=k.value.filter(s=>t.includes(s.id)),h.value=h.value.filter(s=>t.includes(s.programId)),i.forEach(s=>{k.value.some(C=>C.id===s.program_id)||k.value.push({id:s.program_id,name:s.name,dates:[],dateSelectorRef:null})}),r[0].show_error.value=i.length===0}const B=async()=>{const i=k.value.map(async t=>{try{const s=D.getAvailableDatesByProgramId(t.id,90,!0,4);t.dates=s}catch(s){console.error("Error fetching dates for program ".concat(t.name,":"),s),t.dates=[]}});await Promise.all(i)};async function q(){const i=S.value.program_id,t=await Te.getAllPrograms(),s=[];t.forEach(C=>{C.program_id!==i&&s.push({name:C.name,other:C,selected:!1})}),w.value=s}const L=async(i,t)=>{Re($e,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Referral(s)?"},{cancel:W=>{},confirm:async W=>{W.detail==!0&&await t(i)}})};return ee(async()=>{await q(),Ne()}),(i,t)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...t[0]||(t[0]=[x("Refer to another clinic",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:a(()=>[...t[1]||(t[1]=[x(" Program(s)",-1),U("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),o(Ee,{multiSelection:r[0].multi_Selection,show_label:r[0].show_list_label,uniqueId:r[0].unqueId,name_of_list:r[0].name_of_list,choose_place_holder:r[0].placeHolder,"items_-list":w.value,use_internal_filter:r[0].use_internal_filter,disabled:r[0].disabled.value,onItemListUpDated:r[0].listUpdatedFN,onItemListFiltered:r[0].listFilteredFN,onItemSearchText:r[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),(f(!0),z(ae,null,fe(k.value,(s,C)=>(f(),v(e(R),{key:s.id},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-top":"20px","font-weight":"bold",display:"block"}},{default:a(()=>[t[2]||(t[2]=U("span",{style:{color:"gray"}},"Available Dates for:",-1)),x(" "+T(s.name),1)]),_:2},1024),o(na,{availableDates:s.dates,onDateSelected:V=>O(V,s.id,s.name),ref_for:!0,ref:V=>{V&&(s.dateSelectorRef=V)}},null,8,["availableDates","onDateSelected"])]),_:2},1024)]),_:2},1024))),128)),b.value?(f(),v(e(R),{key:0,style:{"margin-top":"-10px"}},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{class:"error-label"},{default:a(()=>[...t[3]||(t[3]=[x(" ⚠️ Please select an available date for all selected programs. ",-1)])]),_:1})]),_:1})]),_:1})):I("",!0),o(e(R),{class:"action-buttons"},{default:a(()=>[o(e($),{class:"ion-text-end"},{default:a(()=>[F[1].addItemButton?(f(),v(j,{key:0,name:F[1].name,fill:F[1].btnFill,icon:e(re),"onClicked:btn":F[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),k.value.length>0?(f(),v(j,{key:1,name:F[0].name,fill:F[0].btnFill,icon:e(ne),"onClicked:btn":F[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),da=Q(sa,[["__scopeId","data-v-721c6ae2"]]),ua={class:"dash_box"},ia={key:0,style:{"margin-top":"100px"}},ca=K({name:"xxxComponent"}),fa=K({...ca,setup(u){const p=l("No outcome created yet"),m=l(!1),w=l(!0),k=l(""),h=l(!0),y=l(!1),D=de(),S=Ie(()=>D.outcomes),b=l(!1),r=l(!1),d=l(!1),g=l(!1),H=l(!1),N=l(!1),F=l(),O=l(null),P=l(null),A=l(null),B=l(null),q=l(null),L=l(null),i=l([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]);function t(c){i.value.forEach(E=>{c.selected==!0&&(c.name==E.name||c.type==E.name)&&(k.value=E.name)})}ee(async()=>{C()}),Z(()=>k.value,async c=>{b.value==!0?b.value=!1:X()}),Z(()=>S.value.length,async c=>{C()});function s(){i.value.forEach(c=>{c.selected=!1}),k.value=""}function C(){S.value.length>0?h.value=!1:S.value.length==0&&y.value==!1&&(h.value=!0)}function V(c){S.value.splice(c,1)}const W=c=>{V(c.index),t(c.item),O.value=c.item.other.location_data,P.value={reason:c.item.reason,date:c.item.date,time:c.item.time},A.value=c.item.other,B.value=c.item,c.item.type==="Discharged Home"&&(q.value=c.item,L.value={reason:c.item.reason,date:c.item.date})};async function X(c=!0){const E=k.value;k.value=E;const J=k.value;J==i.value[0].name?d.value=!0:d.value=!1,J==i.value[1].name?g.value=!0:g.value=!1,J==i.value[2].name?H.value=!0:H.value=!1,J==i.value[3].name?N.value=!0:N.value=!1}function _(){r.value=!1,d.value=!1,H.value=!1,g.value=!1,s()}const n=c=>{i.value.forEach(E=>{E.selected=!1}),F.value=c,F.value.selected=!0,t(F.value)};return(c,E)=>{const J=G("ion-row");return f(),v(e(ke),null,{default:a(()=>[o(J,null,{default:a(()=>[o(e($),null,{default:a(()=>[(f(),v(Ke,{key:0,"onUpdate:removeItem":V,"onUpdate:editItem":W,displayData:S.value},null,8,["displayData"]))]),_:1})]),_:1}),h.value?(f(),v(J,{key:0},{default:a(()=>[U("span",ua,T(p.value),1)]),_:1})):I("",!0),o(J,null,{default:a(()=>[o(e($),null,{default:a(()=>[w.value?(f(),z("div",ia,[o(J,null,{default:a(()=>[o(e(ve),{modelValue:F.value,"onUpdate:modelValue":[E[0]||(E[0]=ue=>F.value=ue),E[1]||(E[1]=ue=>n(ue))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:i.value},null,8,["modelValue","options"]),U("div",null,[m.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[...E[2]||(E[2]=[x(T("please select a type"),-1)])]),_:1})):I("",!0)])]),_:1})])):I("",!0)]),_:1})]),_:1}),d.value?(f(),v(je,{key:1,onDataSaved:_,selected_ward_prop:A.value,admitted_other_props:B.value},null,8,["selected_ward_prop","admitted_other_props"])):I("",!0),g.value?(f(),v(Xe,{key:2,onDataSaved:_,selected_referral_data:O.value,selected_other_referral_data:P.value},null,8,["selected_referral_data","selected_other_referral_data"])):I("",!0),H.value?(f(),v(ea,{key:3,onDataSaved:_,selected_discharged_prop:q.value,selected_discharged_data:L.value},null,8,["selected_discharged_prop","selected_discharged_data"])):I("",!0),N.value?(f(),v(da,{key:4,onDataSaved:_})):I("",!0)]),_:1})}}}),ha=Q(fa,[["__scopeId","data-v-2873182f"]]);export{je as A,Ke as D,ha as O,Xe as R,ye as _,ea as a,da as b};
