import{d as W,eO as U,r as D,c as ae,w as k,e as b,m as A,f as v,k as r,l as f,u as s,aR as Ne,J as w,L as H,bj as oe,cv as De,Q as R,aQ as we,aP as Te,Y as Ie,bF as ke,N as Q,aZ as Pe,F as ne,P as re,K as S,cG as Be,a as Ve,O as Z,an as Re,f7 as Ae,bk as Me,f8 as Ye,bK as He,d8 as xe,a3 as Ee,a6 as Ge,aV as Le,bx as Ue,eP as We,H as te}from"./vendor-D6KKOjhr.js";import{l as T,u as ue,P as $e,_ as ie,aC as j,L as qe,T as ze,b4 as fe,H as Ke,ab as Qe,G as je,t as Je}from"../index-evqeH03j.js";import{N as Ze}from"./neonatal_service-CH3CkWl9.js";import{D as Xe}from"./DemographicBar-DOpT2psm.js";import{N as et}from"./NeonatalStepper-DxCNvJd1.js";import{I as de}from"./images-DCsUI3iU.js";import{u as tt}from"./NeonatalEnrollmentStore-Gpqrd0oB.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DipIgGe9.js";import"./SaveProgressModal-lL4Hez_h.js";const C=e=>e.map(p=>({value:p,label:p})),se=(e,p)=>Array.from({length:p-e+1},(n,u)=>{const a=(e+u).toString();return{value:a,label:a}}),at=["Stimulation","Suctioning","Oxygen","Bag Valve Mask Ventilation (BVM)","Cardio Pulmonary Resuscitation (CPR)","Unknown","None"],$=[{title:"Birth details",subtitle:"Capture the initial arrival information",formData:[{componentType:"radioButtonField",header:"Does the baby have a twin?",name:"hasTwin",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether the neonate has a twin"},{componentType:"multiSelectInputField",header:"Place of Birth",name:"placeOfBirth",placeholder:"Select type",icon:T.search,options:C(["Hospital","Health Center","Home","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the place of birth"},{componentType:"multiSelectInputField",header:"Name of Birth Facility",name:"birthFacility",placeholder:"Select facility",icon:T.search,options:C(["Lilongwe Central","Queen Elizabeth","District Hospital","Community Clinic"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select a facility"},{componentType:"multiSelectInputField",header:"Type of Birth",name:"typeOfBirth",placeholder:"Select type",icon:T.search,options:C(["Singleton","Twin","Triplet"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the type of birth"},{componentType:"inputField",header:"Birth weight (grams)",name:"birthWeight",type:"number",placeholder:"Enter weight",validation:e=>Number(e)>0?null:"Provide the birth weight"},{componentType:"timeInputField",header:"Time of birth",name:"birthTime",placeholder:"HH:mm",validation:e=>e?null:"Capture the time of birth"}]},{title:"Referral information",subtitle:"Document how the neonate arrived",description:"Required when the baby was referred from another facility.",formData:[{componentType:"radioButtonField",header:"Is the baby referred from another facility?",name:"referredFromAnotherFacility",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Indicate whether the neonate was referred"},{componentType:"multiSelectInputField",header:"Referred from",name:"referredFrom",placeholder:"Select referee type",icon:T.search,options:C(["District Hospital","Health Center","Private Clinic","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the referral source",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Name of facility",name:"referringFacilityName",placeholder:"Search and select facility",icon:T.search,options:[],trackBy:"name",validation:(e,p)=>(p==null?void 0:p.referredFromAnotherFacility)!=="Yes"||e!=null&&e.name||e?null:"Select the referring facility",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Mode of transport",name:"modeOfTransport",placeholder:"Select mode",icon:T.search,options:C(["Ambulance","Private vehicle","Bicycle","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select how the neonate arrived",condition:e=>e.referredFromAnotherFacility==="Yes"},{componentType:"multiSelectInputField",header:"Admitted from",name:"admittedFrom",placeholder:"Select origin",icon:T.search,options:C(["Clinic","Home","Maternity Ward","Other"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select where the baby was admitted from",condition:e=>e.referredFromAnotherFacility==="Yes"}]},{title:"Birth assessment",subtitle:"Capture the immediate clinical state",formData:[{componentType:"radioButtonField",header:"Did the baby cry straight after birth?",name:"criedAfterBirth",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Indicate whether the baby cried"},{componentType:"multiSelectInputField",header:"Apgar score at 1 minute",name:"apgar1",placeholder:"Select",icon:T.search,options:se(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 1 min"},{componentType:"multiSelectInputField",header:"Apgar score at 5 minutes",name:"apgar5",placeholder:"Select",icon:T.search,options:se(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 5 min"},{componentType:"multiSelectInputField",header:"Apgar score at 10 minutes",name:"apgar10",placeholder:"Select",icon:T.search,options:se(0,10),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select the Apgar score at 10 min"},{componentType:"multiSelectInputField",header:"Was resuscitation needed at birth?",name:"resuscitationMethods",placeholder:"Select the methods",icon:T.search,options:C(at),trackBy:"value",isMultiple:!0,closeOnSelect:!1,validation:e=>e&&e.length?null:"Select at least one method"}]},{title:"Mother's Information",subtitle:"Search and link the mother's record",description:"Find the mother's existing record or register a new mother if not found.",formData:[]},{title:"Pregnancy",subtitle:"Pregnancy and delivery history",formData:[{componentType:"inputField",header:"Gestation in weeks",name:"gestationWeeks",type:"number",placeholder:"Weeks",validation:e=>{const p=Number(e);return p>0&&p<=45?null:"Enter valid gestation weeks (1-45)"}},{componentType:"radioButtonField",header:"Were steroids given?",name:"steroidsGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether steroids were given"},{componentType:"multiSelectInputField",header:"Gestation method assessment",name:"gestationMethodAssessment",placeholder:"Select method",icon:T.search,options:C(["LMP","Ultrasound","Clinical Assessment","Ballard Score"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select gestation assessment method"},{componentType:"radioButtonField",header:"Ultra sound scanning - USS",name:"ultraSoundScanning",options:[{label:"Early",value:"Early"},{label:"Late",value:"Late"}],validation:e=>e?null:"Select ultrasound timing"},{componentType:"timeInputField",header:"Onset of labor",name:"onsetOfLabor",placeholder:"HH:mm",validation:e=>e?null:"Enter onset of labor time"},{componentType:"radioButtonField",header:"Rupture of membranes?",name:"ruptureOfMembranes",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify rupture of membranes status"},{componentType:"radioButtonField",header:"Duration of Rupture of Membranes",name:"durationOfRuptureMembranes",options:[{label:"< 18 hours",value:"< 18 hours"},{label:"18 hours >",value:"18 hours >"}],validation:e=>e?null:"Select duration",condition:e=>e.ruptureOfMembranes==="Yes"},{componentType:"radioButtonField",header:"Offensive Liquor?",name:"offensiveLiquor",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify offensive liquor status"},{componentType:"multiSelectInputField",header:"Mode of Delivery",name:"modeOfDelivery",placeholder:"Select mode",icon:T.search,options:C(["Spontaneous Vaginal Delivery","Caesarean Section","Vacuum Extraction","Forceps Delivery","Breech Delivery"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select mode of delivery"},{componentType:"radioButtonField",header:"Meconium present?",name:"meconiumPresent",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify meconium presence"},{componentType:"radioButtonField",header:"Maternal Analgesia?",name:"maternalAnalgesia",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify maternal analgesia status"},{componentType:"multiSelectInputField",header:"Analgesia Drug",name:"analgesiasDrug",placeholder:"Select drug",icon:T.search,options:C(["Paracetamol","Pethidine","Morphine","Epidural","Other"]),trackBy:"value",validation:(e,p)=>(p==null?void 0:p.maternalAnalgesia)!=="Yes"||e!=null&&e.value||e?null:"Select analgesia drug",condition:e=>e.maternalAnalgesia==="Yes"},{componentType:"radioButtonField",header:"Anesthesia used?",name:"anesthesiaUsed",options:[{label:"General",value:"General"},{label:"Spinal",value:"Spinal"},{label:"No",value:"No"}],validation:e=>e?null:"Specify anesthesia used"},{componentType:"radioButtonField",header:"TEO?",name:"teo",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify TEO status"},{componentType:"radioButtonField",header:"Chlorohexidine of cord care?",name:"chlorohexidineCordCare",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify chlorohexidine cord care"},{componentType:"radioButtonField",header:"Vitamin K given?",name:"vitaminKGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify Vitamin K status"},{componentType:"radioButtonField",header:"Dextrose 10% given?",name:"dextroseGiven",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify Dextrose 10% status"}]},{title:"Mother's enrollment details",subtitle:"HIV, VDRL, and Hepatitis status",formData:[{componentType:"radioButtonField",header:"Mother's status",name:"motherStatus",options:[{label:"Alive",value:"Alive"},{label:"Died",value:"Died"}],validation:e=>e?null:"Select mother's status"},{componentType:"multiSelectInputField",header:"HIV Status",name:"motherHivStatus",placeholder:"Select status",icon:T.search,options:C(["Reactive","Non-Reactive","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select HIV status"},{componentType:"dateInputField",header:"Last HIV Test Date",name:"lastHivTestDate",placeholder:"Select date",validation:e=>e?null:"Select the last HIV test date"},{componentType:"radioButtonField",header:"Do a HIV re-test?",name:"doHivRetest",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether to do HIV re-test"},{componentType:"radioButtonField",header:"Who baby given NVP?",name:"babyGivenNvp",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether baby was given NVP"},{componentType:"multiSelectInputField",header:"Mother's VDRL/Syphilis result",name:"motherVdrlResult",placeholder:"Select result",icon:T.search,options:C(["Positive","Negative","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select VDRL/Syphilis result"},{componentType:"radioButtonField",header:"Who mother treated for VDRL/Syphilis?",name:"motherTreatedForVdrl",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether mother was treated"},{componentType:"radioButtonField",header:"Was the baby tested for Hepatitis?",name:"babyTestedForHepatitis",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether baby was tested"},{componentType:"radioButtonField",header:"Were all 3 doses of the treatment completed?",name:"allThreeDosesCompleted",options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}],validation:e=>e?null:"Specify whether all doses were completed"},{componentType:"multiSelectInputField",header:"Mother's Hepatitis result",name:"motherHepatitisResult",placeholder:"Select result",icon:T.search,options:C(["Positive","Negative","Unknown"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select Hepatitis result"}]},{title:"Known Medical Conditions",subtitle:"Tetanus vaccination history",formData:[{componentType:"multiSelectInputField",header:"Tetanus Diphtheria",name:"tetanusDiphtheria",placeholder:"Search and select",icon:T.search,options:C(["Td1","Td2","Td3","Td4","Td5","Unknown","None"]),trackBy:"value",validation:e=>e!=null&&e.value||e?null:"Select Tetanus Diphtheria status"}]}],ot={motherPatientId:void 0,motherName:void 0,motherNationalId:void 0,hasTwin:"",twinPatientId:void 0,twinName:void 0,placeOfBirth:"",nameOfBirthFacility:"",typeOfBirth:"",birthWeight:"",timeOfBirth:"",referredFromOtherFacility:"",referredFrom:"",referringFacilityName:"",modeOfTransport:"",admittedFrom:"",criedAfterBirth:"",apgarScoreAt1:"",apgarScoreAt5:"",apgarScoreAt10:"",resuscitationMethods:[],gestationWeeks:"",steroidsGiven:"",gestationMethodAssessment:"",ultraSoundScanning:"",onsetOfLabor:"",ruptureOfMembranes:"",durationOfRuptureMembranes:"",offensiveLiquor:"",modeOfDelivery:"",meconiumPresent:"",maternalAnalgesia:"",analgesiasDrug:"",anesthesiaUsed:"",teo:"",chlorohexidineCordCare:"",vitaminKGiven:"",dextroseGiven:"",motherStatus:"",motherHivStatus:"",lastHivTestDate:"",doHivRetest:"",babyGivenNvp:"",motherVdrlResult:"",motherTreatedForVdrl:"",babyTestedForHepatitis:"",allThreeDosesCompleted:"",motherHepatitisResult:"",tetanusDiphtheria:[]},q=Symbol("neonatal-enrollment-form"),nt={key:0,class:"twin-search-container"},rt={style:{border:"1px dotted #ececec","border-radius":"8px"}},it={class:"header-with-icon"},lt={class:"icon-wrapper"},st=["src"],ct={class:"search-with-button"},dt={class:"search-wrapper"},ut={key:0,class:"search-results"},mt={key:0,class:"search-loading"},pt={key:1,class:"results-list"},ht=["onClick"],ft={class:"result-header"},vt={class:"twin-name"},yt={class:"twin-mrn"},gt={class:"twin-dob"},_t={class:"result-details"},bt={key:0,class:"twin-gender"},St={key:2,class:"no-results"},Ft={key:1,class:"selected-twin"},Nt={class:"selected-card"},Dt={class:"selected-card-header"},wt={class:"header-content"},Tt={class:"selected-icon-wrapper"},It=["src"],kt={class:"selected-card-content"},Bt={class:"patient-info-grid"},Vt={class:"info-row"},Rt={class:"info-value"},$t={class:"info-row"},Ot={class:"info-value"},Ct={key:0,class:"info-row"},Pt={class:"info-value"},At={key:1,class:"info-row"},Mt={class:"info-value"},Yt=W({__name:"TwinSearch",setup(e,{expose:p}){const n=U(q),u=ue(),a=D(""),y=D(!1),t=D([]),l=D(null),o=D(!1),i=ae(()=>(n==null?void 0:n.hasTwin)==="Yes"),F=async()=>{if(!a.value||a.value.trim().length<2){t.value=[];return}y.value=!0;try{const g=a.value.trim();if(/^\d+$/.test(g))try{const d=await u.getPatientData(Number(g));if(d&&d.personInformation){const _=d.personInformation;t.value=[{patientID:_.person_id,firstName:_.given_name||"",middleName:_.middle_name||"",lastName:_.family_name||"",gender:_.gender,birthdate:_.birthdate}]}else t.value=[]}catch(d){console.error("Error searching by MRN:",d),t.value=[]}else{const d=g.split(" "),_={given_name:d[0],family_name:d[1]||"",page:"1",per_page:"20"},O=await $e.search(_);t.value=Array.isArray(O)?O.filter(G=>{const Y=G.person;if(!Y.birthdate)return!1;const z=new Date(Y.birthdate);return Math.floor((Date.now()-z.getTime())/(1e3*60*60*24))<=7}).map(G=>{var c;const Y=G.person,z=((c=Y.names)==null?void 0:c[0])||{};return{patientID:Y.person_id,firstName:z.given_name||"",middleName:z.middle_name||"",lastName:z.family_name||"",gender:Y.gender,birthdate:Y.birthdate}}):[]}}catch(g){console.error("Error searching for twin:",g),t.value=[]}finally{y.value=!1}},h=g=>{l.value=g,a.value="",o.value=!1,n&&(n.twinPatientId=g.patientID,n.twinName="".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim())},B=()=>{l.value=null,o.value=!1,n&&(n.twinPatientId=void 0,n.twinName=void 0)},K=()=>{o.value=!0,l.value=null,a.value="",n&&(n.twinPatientId=void 0,n.twinName=void 0)};k(()=>n==null?void 0:n.hasTwin,g=>{g!=="Yes"&&(B(),o.value=!1)});const P=g=>"".concat(g.firstName," ").concat(g.middleName||""," ").concat(g.lastName).trim(),M=g=>g?new Date(g).toLocaleDateString():"";return p({validateForm:()=>(n==null?void 0:n.hasTwin)==="Yes"&&!l.value&&!o.value?{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"}:null,getFormValues:()=>l.value?{twinPatientId:l.value.patientID,twinName:P(l.value)}:{}}),(g,d)=>i.value?(v(),b("div",nt,[r("div",rt,[f(s(Ne),null,{default:w(()=>[r("div",it,[r("div",lt,[r("img",{src:s(de).icons.twins,alt:"Twin",class:"header-icon"},null,8,st),f(s(H),{icon:s(oe),class:"search-badge-icon"},null,8,["icon"])]),r("div",null,[f(s(De),null,{default:w(()=>[...d[1]||(d[1]=[R("Twin Information",-1)])]),_:1}),f(s(we),null,{default:w(()=>[...d[2]||(d[2]=[R("Search for twin sibling",-1)])]),_:1})])])]),_:1}),f(s(Te),null,{default:w(()=>[f(s(Ie),{class:"info-note"},{default:w(()=>[...d[3]||(d[3]=[R(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),r("div",ct,[r("div",dt,[f(s(ke),{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=_=>a.value=_),placeholder:"Search for twin's MRN or scan barcode",onIonInput:F,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),f(s(Q),{color:"primary",onClick:K,class:"skip-btn"},{default:w(()=>[d[4]||(d[4]=R(" Skip ",-1)),f(s(H),{size:"small",icon:s(Pe),slot:"end"},null,8,["icon"])]),_:1})]),a.value&&a.value.length>0&&!l.value?(v(),b("div",ut,[y.value?(v(),b("div",mt,[(v(),b(ne,null,re(3,_=>r("div",{key:"skeleton-".concat(_),class:"result-item-skeleton"},[...d[5]||(d[5]=[r("div",{class:"skeleton-header"},[r("div",{class:"skeleton-name"}),r("div",{class:"skeleton-dob"})],-1)])])),64))])):t.value.length>0?(v(),b("div",pt,[(v(!0),b(ne,null,re(t.value,(_,O)=>(v(),b("div",{key:_.patientID||O,class:"result-item",onClick:G=>h(_)},[r("div",ft,[r("span",vt,S(P(_)),1),r("span",yt,"MRN: "+S(_.patientID),1),r("span",gt,"DOB: "+S(M(_.birthdate)),1)]),r("div",_t,[_.gender?(v(),b("p",bt,[d[6]||(d[6]=r("strong",null,"Gender:",-1)),R(" "+S(_.gender),1)])):A("",!0)])],8,ht))),128))])):(v(),b("div",St,[f(s(H),{icon:s(oe),class:"no-results-icon"},null,8,["icon"]),r("p",null,'No patients found matching "'+S(a.value)+'"',1),d[7]||(d[7]=r("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):A("",!0),l.value?(v(),b("div",Ft,[r("div",Nt,[r("div",Dt,[r("div",wt,[r("div",Tt,[r("img",{src:s(de).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,It)]),d[8]||(d[8]=r("div",{class:"header-separator"},null,-1)),d[9]||(d[9]=r("span",{class:"selected-subtitle"},"Twin Selected",-1))]),f(s(Q),{fill:"clear",size:"small",onClick:B,class:"clear-selection-btn"},{default:w(()=>[f(s(H),{icon:s(Be)},null,8,["icon"])]),_:1})]),r("div",kt,[r("div",Bt,[r("div",Vt,[d[10]||(d[10]=r("span",{class:"info-label"},"Full Name",-1)),r("span",Rt,S(P(l.value)),1)]),r("div",$t,[d[11]||(d[11]=r("span",{class:"info-label"},"MRN",-1)),r("span",Ot,S(l.value.patientID),1)]),l.value.birthdate?(v(),b("div",Ct,[d[12]||(d[12]=r("span",{class:"info-label"},"Date of Birth",-1)),r("span",Pt,S(M(l.value.birthdate)),1)])):A("",!0),l.value.gender?(v(),b("div",At,[d[13]||(d[13]=r("span",{class:"info-label"},"Gender",-1)),r("span",Mt,S(l.value.gender),1)])):A("",!0)])])])])):A("",!0)]),_:1})])])):A("",!0)}}),Ht=ie(Yt,[["__scopeId","data-v-9ecea754"]]),I=e=>{var p,n,u;if(!(e==null||e==="")){if(typeof e=="string"||typeof e=="number")return e.toString();if(typeof e=="object"){const a=(u=(n=(p=e.label)!=null?p:e.value)!=null?n:e.name)!=null?u:e.title;if(a!=null&&a!=="")return a.toString()}}},Oe=e=>{if(!e)return[];if(Array.isArray(e))return e.map(n=>I(n)).filter(n=>!!n);const p=I(e);return p?[p]:[]},J=e=>e==null?"":e.toString(),xt={class:"birth-details-wrapper"},Et=W({__name:"BirthDetails",setup(e,{expose:p}){const n=D(null),u=D(null),a=D(null),y=$[0].formData,t=y.slice(0,1),l=y.slice(1),o=U(q),i=h=>{o&&(o.hasTwin=h.hasTwin||"")},F=h=>{o&&(o.placeOfBirth=I(h.placeOfBirth)||"",o.nameOfBirthFacility=I(h.birthFacility)||"",o.typeOfBirth=I(h.typeOfBirth)||"",o.birthWeight=J(h.birthWeight||""),o.timeOfBirth=J(h.birthTime||""))};return k(()=>{var h;return(h=u.value)==null?void 0:h.formValues},h=>{h&&F(h)},{deep:!0}),k(()=>u.value,h=>{h!=null&&h.getFormValues&&F(h.getFormValues())},{immediate:!0}),k(()=>{var h;return(h=n.value)==null?void 0:h.formValues},h=>{h&&i(h)},{deep:!0}),k(()=>n.value,h=>{h!=null&&h.getFormValues&&i(h.getFormValues())},{immediate:!0}),p({getFormRef:()=>u.value,getTwinQuestionFormRef:()=>n.value,validateForm:()=>{var M,g,d,_,O,G;const h=((g=(M=n.value)==null?void 0:M.validateForm)==null?void 0:g.call(M))||null,B=((_=(d=u.value)==null?void 0:d.validateForm)==null?void 0:_.call(d))||null,K=((G=(O=a.value)==null?void 0:O.validateForm)==null?void 0:G.call(O))||null,P=[h,B,K].filter(Boolean);return P.length?P.reduce((Y,z)=>({...Y,...z}),{}):null},getFormValues:()=>{var P,M,g,d,_,O;const h=((M=(P=n.value)==null?void 0:P.getFormValues)==null?void 0:M.call(P))||{},B=((d=(g=u.value)==null?void 0:g.getFormValues)==null?void 0:d.call(g))||{},K=((O=(_=a.value)==null?void 0:_.getFormValues)==null?void 0:O.call(_))||{};return{...h,...B,...K}}}),(h,B)=>(v(),b("div",xt,[f(j,{formData:s(t),ref_key:"twinQuestionFormRef",ref:n,class:"twin-question-form"},null,8,["formData"]),f(Ht,{ref_key:"twinSearchRef",ref:a},null,512),f(j,{formData:s(l),ref_key:"formRef",ref:u,class:"main-form"},null,8,["formData"])]))}}),ve=ie(Et,[["__scopeId","data-v-1a647a53"]]),ye=W({__name:"ReferralInformation",setup(e,{expose:p}){const n=D(null),u=$[1].formData,a=U(q),y=D([]);Ve(async()=>{try{const o=await qe.getAllFacilities();Array.isArray(o)?y.value=o:o!=null&&o.facilities&&Array.isArray(o.facilities)?y.value=o.facilities:o!=null&&o.records&&Array.isArray(o.records)?y.value=o.records:y.value=[]}catch(o){console.error("Error loading facilities:",o),y.value=[]}});const t=ae(()=>u.map(o=>o.name==="referringFacilityName"?{...o,options:y.value.map(i=>({name:i.name||i.facility_name||"Unknown",code:i.code||i.facility_code,district:i.district}))}:o)),l=o=>{if(!a)return;a.referredFromOtherFacility=o.referredFromAnotherFacility||"",a.referredFrom=I(o.referredFrom)||"";const i=o.referringFacilityName;a.referringFacilityName=(i==null?void 0:i.name)||J(i||""),a.modeOfTransport=I(o.modeOfTransport)||"",a.admittedFrom=I(o.admittedFrom)||""};return k(()=>{var o;return(o=n.value)==null?void 0:o.formValues},o=>{o&&l(o)},{deep:!0}),k(()=>n.value,o=>{o!=null&&o.getFormValues&&l(o.getFormValues())},{immediate:!0}),p({getFormRef:()=>n.value,validateForm:()=>{var o,i;return((i=(o=n.value)==null?void 0:o.validateForm)==null?void 0:i.call(o))||null},getFormValues:()=>{var o,i;return((i=(o=n.value)==null?void 0:o.getFormValues)==null?void 0:i.call(o))||{}}}),(o,i)=>(v(),Z(j,{formData:t.value,ref_key:"formRef",ref:n},null,8,["formData"]))}}),ge=W({__name:"BirthAssessment",setup(e,{expose:p}){const n=D(null),u=$[2].formData,a=U(q),y=t=>{a&&(a.criedAfterBirth=t.criedAfterBirth||"",a.apgarScoreAt1=I(t.apgar1)||"",a.apgarScoreAt5=I(t.apgar5)||"",a.apgarScoreAt10=I(t.apgar10)||"",a.resuscitationMethods=Oe(t.resuscitationMethods))};return k(()=>{var t;return(t=n.value)==null?void 0:t.formValues},t=>{t&&y(t)},{deep:!0}),k(()=>n.value,t=>{t!=null&&t.getFormValues&&y(t.getFormValues())},{immediate:!0}),p({getFormRef:()=>n.value,validateForm:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),Z(j,{formData:s(u),ref_key:"formRef",ref:n},null,8,["formData"]))}}),Gt={class:"mother-search-container"},Lt={style:{border:"1px dotted #ececec","border-radius":"8px"}},Ut={class:"header-with-icon"},Wt={class:"icon-wrapper"},qt=["src"],zt={class:"search-with-button"},Kt={class:"search-wrapper"},Qt={class:"barcode-btn","aria-label":"Scan MRN"},jt={key:0,class:"search-results"},Jt={key:0,class:"search-loading"},Zt={key:1,class:"results-list"},Xt=["onClick"],ea={class:"result-header"},ta={class:"mother-name"},aa={class:"mother-dob"},oa={class:"mother-gender"},na={class:"result-details"},ra={key:0,class:"mother-address"},ia={key:1,class:"mother-phone"},la={key:0,class:"pagination"},sa={class:"page-info"},ca={key:2,class:"no-results"},da={key:1,class:"selected-mother"},ua={class:"selected-card"},ma={class:"selected-card-header"},pa={class:"selected-header-with-button"},ha={class:"selected-card-content"},fa={class:"selected-info"},va={key:0},ya={key:1},ce=10,ga=W({__name:"MotherSearch",setup(e,{expose:p}){const n=Re(),u=U(q),a=tt(),y=ue(),t=D(""),l=D(!1),o=D([]),i=D(null),F=D(1);Ve(async()=>{const c=a.getMotherPatientId;c&&a.shouldReturnToEnrollment&&(await h(c),a.clearEnrollmentContext())}),k(i,c=>{c&&u&&(u.motherPatientId=c.patientID,u.motherName="".concat(c.firstName," ").concat(c.middleName||""," ").concat(c.lastName).trim(),u.motherNationalId=c.nationalId||"")});const h=async c=>{var m,N;try{l.value=!0;const x=await y.getPatientData(c);if(x&&x.personInformation){const V=x.personInformation,E=((m=V.addresses)==null?void 0:m[0])||{},L=(N=V.person_attributes)==null?void 0:N.find(X=>{var ee;return((ee=X.person_attribute_type)==null?void 0:ee.name)==="Cell Phone Number"}),le={patientID:V.person_id||c,firstName:V.given_name||"",middleName:V.middle_name||"",lastName:V.family_name||"",gender:V.gender,birthdate:V.birthdate,nationalId:x.national_id||"",address:E,phone:(L==null?void 0:L.value)||""};i.value=le}}catch(x){console.error("Error fetching mother data:",x)}finally{l.value=!1}},B=ae(()=>Math.ceil(o.value.length/ce)),K=ae(()=>{const c=(F.value-1)*ce,m=c+ce;return o.value.slice(c,m)}),P=async()=>{if(!t.value||t.value.trim().length<2){o.value=[];return}l.value=!0,F.value=1;try{const m=t.value.trim().split(" "),N={given_name:m[0],family_name:m[1]||"",page:"1",per_page:"50"},x=await $e.search(N);o.value=Array.isArray(x)?x.filter(V=>{var L;const E=((L=V.person)==null?void 0:L.gender)||V.gender;return E==="F"||E==="Female"}).map(V=>{var ee,me,pe;const E=V.person,L=((ee=E.names)==null?void 0:ee[0])||{},le=((me=E.addresses)==null?void 0:me[0])||{},X=(pe=E.person_attributes)==null?void 0:pe.find(Ce=>{var he;return((he=Ce.person_attribute_type)==null?void 0:he.name)==="Cell Phone Number"});return{patientID:E.person_id,firstName:L.given_name||"",middleName:L.middle_name||"",lastName:L.family_name||"",gender:E.gender,birthdate:E.birthdate,nationalId:V.national_id||"",address:le,phone:(X==null?void 0:X.value)||""}}):[]}catch(c){console.error("Error searching for mothers:",c),o.value=[]}finally{l.value=!1}},M=c=>{i.value=c,t.value="",u&&(u.motherPatientId=c.patientID,u.motherName="".concat(c.firstName," ").concat(c.middleName||""," ").concat(c.lastName).trim(),u.motherNationalId=c.nationalId||"")},g=()=>{i.value=null,u&&(u.motherPatientId=void 0,u.motherName=void 0,u.motherNationalId=void 0)},d=()=>{var m;const c=U("patient");c&&((m=c.value)!=null&&m.patientID)&&a.setMotherCreationContext(c.value.patientID,4),n.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},_=()=>{F.value<B.value&&F.value++},O=()=>{F.value>1&&F.value--},G=c=>c?new Date(c).toLocaleDateString():"",Y=c=>{if(!c)return"";if(typeof c=="string")return c;const m=[];return c.city_village&&m.push(c.city_village),c.township_division&&m.push(c.township_division),c.state_province&&m.push(c.state_province),m.join(", ")};return p({getFormRef:()=>({validate:()=>i.value!==null,getFormData:()=>{var c,m;return{motherPatientId:(c=i.value)==null?void 0:c.patientID,motherName:i.value?"".concat(i.value.firstName," ").concat(i.value.middleName||""," ").concat(i.value.lastName).trim():void 0,motherNationalId:(m=i.value)==null?void 0:m.nationalId}}}),validateForm:()=>i.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>i.value?{motherPatientId:i.value.patientID,motherName:"".concat(i.value.firstName," ").concat(i.value.middleName||""," ").concat(i.value.lastName).trim(),motherNationalId:i.value.nationalId}:{}}),(c,m)=>(v(),b("div",Gt,[r("div",Lt,[f(s(Ne),null,{default:w(()=>[r("div",Ut,[r("div",Wt,[r("img",{src:s(de).icons.care,alt:"Care",class:"header-icon"},null,8,qt),f(s(H),{icon:s(oe),class:"search-badge-icon"},null,8,["icon"])]),r("div",null,[f(s(De),null,{default:w(()=>[...m[1]||(m[1]=[R("Search for Mother",-1)])]),_:1}),f(s(we),null,{default:w(()=>[...m[2]||(m[2]=[R("Find mother's existing record",-1)])]),_:1})])])]),_:1}),f(s(Te),null,{default:w(()=>[f(s(Ie),{class:"info-note"},{default:w(()=>[...m[3]||(m[3]=[R(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),r("div",zt,[r("div",Kt,[f(s(ke),{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=N=>t.value=N),placeholder:"Search for mother's Name or scan MRN",onIonInput:P,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),r("div",Qt,[f(s(H),{color:"primary",size:"small",icon:s(Ae),slot:"icon-only"},null,8,["icon"])])]),f(s(Q),{color:"success",onClick:d,class:"new-registration-btn"},{default:w(()=>[f(s(H),{icon:s(Me),slot:"icon-only"},null,8,["icon"]),m[4]||(m[4]=R("New Registration ",-1))]),_:1})]),t.value&&t.value.length>0&&!i.value?(v(),b("div",jt,[l.value?(v(),b("div",Jt,[(v(),b(ne,null,re(3,N=>r("div",{key:"skeleton-".concat(N),class:"result-item-skeleton"},[...m[5]||(m[5]=[r("div",{class:"skeleton-header"},[r("div",{class:"skeleton-name"}),r("div",{class:"skeleton-dob"}),r("div",{class:"skeleton-gender"})],-1),r("div",{class:"skeleton-details"},[r("div",{class:"skeleton-address"}),r("div",{class:"skeleton-phone"})],-1)])])),64))])):o.value.length>0?(v(),b("div",Zt,[(v(!0),b(ne,null,re(K.value,(N,x)=>(v(),b("div",{key:N.patientID||x,class:"result-item",onClick:V=>M(N)},[r("div",ea,[r("span",ta,S(N.firstName)+" "+S(N.middleName?N.middleName+" ":"")+S(N.lastName),1),r("span",aa,"DOB "+S(G(N.birthdate)),1),r("span",oa,S(N.gender==="F"?"Female":N.gender),1)]),r("div",na,[N.address?(v(),b("p",ra,[m[6]||(m[6]=r("strong",null,"Current Address:",-1)),R(" "+S(Y(N.address)),1)])):A("",!0),N.phone?(v(),b("p",ia,[f(s(H),{icon:s(Ye)},null,8,["icon"]),R(" "+S(N.phone),1)])):A("",!0)])],8,Xt))),128)),B.value>1?(v(),b("div",la,[f(s(Q),{fill:"outline",size:"small",onClick:O,disabled:F.value===1},{default:w(()=>[f(s(H),{icon:s(He)},null,8,["icon"])]),_:1},8,["disabled"]),r("span",sa,"Page "+S(F.value)+" of "+S(B.value),1),f(s(Q),{fill:"outline",size:"small",onClick:_,disabled:F.value===B.value},{default:w(()=>[f(s(H),{icon:s(xe)},null,8,["icon"])]),_:1},8,["disabled"])])):A("",!0)])):(v(),b("div",ca,[f(s(H),{icon:s(oe),class:"no-results-icon"},null,8,["icon"]),r("p",null,'No mothers found matching "'+S(t.value)+'"',1),f(s(Q),{expand:"block",onClick:d},{default:w(()=>[...m[7]||(m[7]=[R("Register new mother",-1)])]),_:1})]))])):A("",!0),i.value?(v(),b("div",da,[r("div",ua,[r("div",ma,[r("div",pa,[m[8]||(m[8]=r("span",{class:"selected-subtitle"},"Selected Mother",-1)),f(s(Q),{fill:"clear",size:"small",color:"danger",onClick:g,class:"clear-selection-btn"},{default:w(()=>[f(s(H),{icon:s(Be),slot:"icon-only"},null,8,["icon"])]),_:1})])]),r("div",ha,[r("div",fa,[r("h3",null,S(i.value.firstName)+" "+S(i.value.middleName?i.value.middleName+" ":"")+S(i.value.lastName),1),r("p",null,[m[9]||(m[9]=r("strong",null,"MRN:",-1)),R(" "+S(i.value.patientID),1)]),i.value.birthdate?(v(),b("p",va,[m[10]||(m[10]=r("strong",null,"DOB:",-1)),R(" "+S(G(i.value.birthdate)),1)])):A("",!0),i.value.address?(v(),b("p",ya,[m[11]||(m[11]=r("strong",null,"Address:",-1)),R(" "+S(Y(i.value.address)),1)])):A("",!0)])])])])):A("",!0)]),_:1})])]))}}),_e=ie(ga,[["__scopeId","data-v-0beac54f"]]),be=W({__name:"Pregnancy",setup(e,{expose:p}){const n=D(null),u=$[4].formData,a=U(q),y=t=>{a&&(a.gestationWeeks=J(t.gestationWeeks||""),a.steroidsGiven=t.steroidsGiven||"",a.gestationMethodAssessment=I(t.gestationMethodAssessment)||"",a.ultraSoundScanning=t.ultraSoundScanning||"",a.onsetOfLabor=J(t.onsetOfLabor||""),a.ruptureOfMembranes=t.ruptureOfMembranes||"",a.durationOfRuptureMembranes=I(t.durationOfRuptureMembranes)||"",a.offensiveLiquor=t.offensiveLiquor||"",a.modeOfDelivery=I(t.modeOfDelivery)||"",a.meconiumPresent=t.meconiumPresent||"",a.maternalAnalgesia=t.maternalAnalgesia||"",a.analgesiasDrug=I(t.analgesiasDrug)||"",a.anesthesiaUsed=t.anesthesiaUsed||"",a.teo=t.teo||"",a.chlorohexidineCordCare=t.chlorohexidineCordCare||"",a.vitaminKGiven=t.vitaminKGiven||"",a.dextroseGiven=t.dextroseGiven||"")};return k(()=>{var t;return(t=n.value)==null?void 0:t.formValues},t=>{t&&y(t)},{deep:!0}),k(()=>n.value,t=>{t!=null&&t.getFormValues&&y(t.getFormValues())},{immediate:!0}),p({getFormRef:()=>n.value,validateForm:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),Z(j,{formData:s(u),ref_key:"formRef",ref:n},null,8,["formData"]))}}),Se=W({__name:"MotherEnrollmentDetails",setup(e,{expose:p}){const n=D(null),u=$[5].formData,a=U(q),y=t=>{a&&(a.motherStatus=t.motherStatus||"",a.motherHivStatus=I(t.motherHivStatus)||"",a.lastHivTestDate=J(t.lastHivTestDate||""),a.doHivRetest=t.doHivRetest||"",a.babyGivenNvp=t.babyGivenNvp||"",a.motherVdrlResult=I(t.motherVdrlResult)||"",a.motherTreatedForVdrl=t.motherTreatedForVdrl||"",a.babyTestedForHepatitis=t.babyTestedForHepatitis||"",a.allThreeDosesCompleted=t.allThreeDosesCompleted||"",a.motherHepatitisResult=I(t.motherHepatitisResult)||"")};return k(()=>{var t;return(t=n.value)==null?void 0:t.formValues},t=>{t&&y(t)},{deep:!0}),k(()=>n.value,t=>{t!=null&&t.getFormValues&&y(t.getFormValues())},{immediate:!0}),p({getFormRef:()=>n.value,validateForm:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),Z(j,{formData:s(u),ref_key:"formRef",ref:n},null,8,["formData"]))}}),Fe=W({__name:"KnownMedicalConditions",setup(e,{expose:p}){const n=D(null),u=$[6].formData,a=U(q),y=t=>{a&&(a.tetanusDiphtheria=Oe(t.tetanusDiphtheria))};return k(()=>{var t;return(t=n.value)==null?void 0:t.formValues},t=>{t&&y(t)},{deep:!0}),k(()=>n.value,t=>{t!=null&&t.getFormValues&&y(t.getFormValues())},{immediate:!0}),p({getFormRef:()=>n.value,validateForm:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.validateForm)==null?void 0:l.call(t))||null},getFormValues:()=>{var t,l;return((l=(t=n.value)==null?void 0:t.getFormValues)==null?void 0:l.call(t))||{}}}),(t,l)=>(v(),Z(j,{formData:s(u),ref_key:"formRef",ref:n},null,8,["formData"]))}}),_a=W({name:"NeonatalEnrollment",components:{IonPage:Ge,IonContent:Ee,Toolbar:ze,DemographicBar:Xe,NeonatalStepper:et,BirthDetails:ve,ReferralInformation:ye,BirthAssessment:ge,MotherSearch:_e,Pregnancy:be,MotherEnrollmentDetails:Se,KnownMedicalConditions:Fe},setup(){const e=Re(),p=ue(),{patient:n}=Le(p),u=Ue({...ot});We(q,u);const a=D($.map((o,i)=>({title:o.title,number:i+1,checked:!1,class:i===0?"open_step common_step":"common_step",last_step:i===$.length-1?"last_step":""}))),y=[{title:$[0].title,value:"1",component:ve},{title:$[1].title,value:"2",component:ye},{title:$[2].title,value:"3",component:ge},{title:$[3].title,value:"4",component:_e},{title:$[4].title,value:"5",component:be},{title:$[5].title,value:"6",component:Se},{title:$[6].title,value:"7",component:Fe}];return{router:e,patient:n,enrollmentFormData:u,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:a,stepperData:y,updateStatus:o=>{o&&o.value&&a.value.forEach((i,F)=>{o.value===(F+1).toString()?(i.class="open_step common_step",i.checked=!1):F<parseInt(o.value)-1?(i.class="common_step color_white",i.checked=!0):(i.class="common_step",i.checked=!1)})},getSaveFunction:o=>o===y.length-1?async()=>{var i;if((i=n.value)!=null&&i.patientID)try{if(u.motherPatientId)try{const h=(await fe.getRelations()).find(B=>B.b_is_to_a==="Mother"||B.b_is_to_a==="Parent");h&&await fe.createRelation(n.value.patientID,u.motherPatientId,h.relationship_type_id)}catch(F){console.error("Failed to create mother-baby relationship",F)}await Ze.enrollNeonate(n.value.patientID,u,Ke.sessionDate()),await Qe.userProgramData(n.value.patientID),je("Neonate enrolled successfully"),e.push("/neonatal/triage")}catch(F){console.error("Neonatal enrollment failed",F),Je("Unable to enroll neonate at this time")}}:()=>{}}}});function ba(e,p,n,u,a,y){const t=te("Toolbar"),l=te("DemographicBar"),o=te("NeonatalStepper"),i=te("ion-content"),F=te("ion-page");return v(),Z(F,{class:"neonatal-enrollment-page"},{default:w(()=>[f(t),f(i,{fullscreen:!0},{default:w(()=>[f(l),f(o,{wizardData:e.wizardData,StepperData:e.stepperData,stepperTitle:e.stepperTitle,openStepper:e.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:e.getSaveFunction,onUpdateStatus:e.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const Ra=ie(_a,[["render",ba],["__scopeId","data-v-1e8dda56"]]);export{Ra as default};
