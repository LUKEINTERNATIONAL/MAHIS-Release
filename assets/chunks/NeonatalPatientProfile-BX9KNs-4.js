import{d as ge,am as Te,b2 as _e,r as y,a as he,w as te,e as ne,f as C,k as r,l as n,u as e,bs as Ae,J as o,ac as Q,ad as $,bw as B,O as ae,m as H,bu as be,Q as v,K as p,aV as Y,dt as F,a5 as W,c as Se,H as Ce,p as Ie,d1 as we,d_ as Me,aj as ke,ai as R,a6 as E,a2 as P,ah as De,bF as j,b6 as Re}from"./vendor-Do1wNTJR.js";import{l as Pe}from"./lodash-NJiRuGo9.js";import{u as xe}from"./usePatientProfile-6ZICyv69.js";import Ve from"./WeightHeightChart-zJTWXx6e.js";import{u as Oe,b as O,t as Z,_ as ye,l as Ge,bp as Ue,S as $e,J as Be,H as h,P as Ye}from"../index-BqlopBXU.js";import{N as ee}from"./neonatal_service-D3uAgGDd.js";import{g as Ee}from"./admissionWorkflow-C1e4oic-.js";import"./Registration-DRaXAKuS.js";import"./useSetRegistrationValues-CoSqKgac.js";import"./useLocation-WMW2VHVN.js";import"./vaccines_service-BO3F9ruh.js";import"./sms_service-DuP6pPZ4.js";import"./EIRreportsStore-CnL9gIOz.js";import"./Export-D0315q-g.js";import"./user_role_management-DrxozZtd.js";import"./useNeonatalEnrollmentStore-D2AuqvtG.js";import"./enrollment-DU-PLRUa.js";import"./Outcome-Cnh2ivTK.js";import"./wardsStore-hISXNANX.js";import"./chartjs-CO8SDpjp.js";import"./apexcharts-CCt-rnNp.js";const Fe={class:"neonatal-home-component"},We={class:"icon-container"},He={class:"icon-container"},ze={class:"icon-container"},Xe={class:"icon-container"},qe=ge({__name:"NeonatalCare",setup(Le){const m=Te(),z=Oe(),{patient:f}=_e(z),g=y(""),N=y(""),L=i=>"src/apps/Neonatal/public/patient_profile_imgs/".concat(i),w=i=>{const l={discharge:{path:"/neonatal/discharge"},"neonatal-opd":{path:"/neonatal/opd"},"in-patient":{path:"/neonatal/in-patient"},"emergency-triage":{path:"/neonatal/triage",query:{source:"profile"}},"instruction-guides":{path:"/neonatal/guides"},checkpoint:{path:"/neonatal/checkpoint"}}[i];l?m.push({path:l.path,query:l.query}):console.warn("Route not found for: ".concat(i))},c=i=>(i!=null?i:"").trim().toUpperCase(),d=[{encounterType:O.NEONATAL_SIGNS_SYMPTOMS,route:"/neonatal/signs-symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS"],title:"Signs & Symptoms"},{encounterType:O.NEONATAL_REVIEW_OF_SYSTEMS,route:"/neonatal/review-of-systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"],title:"Review of Systems"},{encounterType:O.PHYSICAL_EXAMINATION_BABY,route:"/neonatal/general-examination",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"],title:"General Exam"},{encounterType:O.VITALS,route:"/neonatal/vitals",encounterNames:["VITALS","NEONATAL VITALS"],title:"Vitals"},{encounterType:O.NEONATAL_SYSTEMIC_EXAMINATION,route:"/neonatal/SystemicExamination",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"],title:"Systemic Exam"},{encounterType:O.NEONATAL_ADMISSION_OUTCOMES,route:"/neonatal/admission-outcomes",encounterNames:["NEONATAL ADMISSION OUTCOMES"],title:"Outcomes"}],A=d[0].route,X=d[d.length-1].route,q=i=>{const a=Ee(i,d),l=d[a];return l?l.route:X},x=i=>{const a=Ee(i,d),l=d[a];return l?l.title:""},K=async i=>{try{const a=await ee.getSavedEncounters(i),l=Array.isArray(a==null?void 0:a.encounters)?a.encounters:[],T=q(l);await m.push(T)}catch(a){console.error("Error determining neonatal admission workflow:",a),Z("Unable to determine next admission step. Starting from Signs & Symptoms."),await m.push(A)}},V=i=>{const a=c("NEONATAL ENROLLMENT");return i.some(l=>c(l)===a)},G=i=>{const a=c("NEONATAL TRIAGE");return i.some(l=>c(l)===a)},u=[{title:"Triage",encounterNames:["NEONATAL TRIAGE"]},{title:"Profiling",encounterNames:["NEONATAL ENROLLMENT"]},{title:"Signs & Symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS","NEONATAL SIGNS SYMPTOMS"]},{title:"Review of Systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"]},{title:"General Exam",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"]},{title:"Vitals",encounterNames:["VITALS","NEONATAL VITALS"]},{title:"Systemic Exam",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"]},{title:"Diagnosis",encounterNames:["DIAGNOSIS","NEONATAL DIAGNOSIS"]},{title:"Investigations",encounterNames:["INVESTIGATION","NEONATAL INVESTIGATION","LAB ORDERS","LAB RESULTS"]},{title:"Treatment",encounterNames:["TREATMENT","NEONATAL TREATMENT PLAN"]},{title:"Outcomes",encounterNames:["NEONATAL ADMISSION OUTCOMES","ADMISSION OUTCOMES"]}],b=async()=>{var i;if(!((i=f.value)!=null&&i.patientID)){g.value="",N.value="";return}try{const a=await ee.getSavedEncounters(f.value.patientID),l=Array.isArray(a==null?void 0:a.encounters)?a.encounters:[],T=new Set(l.map(s=>c(s))),M=s=>s.some(t=>T.has(c(t)));let _=null;for(const s of u)if(!M(s.encounterNames)){_=s;break}_?N.value=_.title:N.value="Complete";const k=V(l),U=G(l);if(!k)g.value="Enrollment";else if(!U)g.value="Triage";else{const s=x(l);g.value=s||"Completed"}}catch(a){console.error("Error loading next encounter badge:",a),g.value="",N.value=""}},J=async()=>{var i;if(!((i=f.value)!=null&&i.patientID)){Z("No patient selected");return}try{const a=await ee.getSavedEncounters(f.value.patientID),l=Array.isArray(a==null?void 0:a.encounters)?a.encounters:[],T=new Set(l.map(s=>c(s))),M=s=>s.some(t=>T.has(c(t)));if(u.every(s=>M(s.encounterNames))){m.push("/neonatal/checkpoint");return}if(!G(l)){m.push("/neonatal/triage");return}if(!V(l)){m.push("/neonatal/enrollment");return}await K(f.value.patientID)}catch(a){console.error("Error in handleAdmit:",a),Z("Unable to check admission status")}};return he(()=>{b()}),te(()=>{var i;return(i=f.value)==null?void 0:i.patientID},()=>{b()}),(i,a)=>(C(),ne("div",Fe,[a[7]||(a[7]=r("div",{class:"section-header"},[r("h2",null,"Activities")],-1)),n(e(Ae),null,{default:o(()=>[n(e(Q),null,{default:o(()=>[n(e($),{size:"6"},{default:o(()=>[n(e(B),{button:"",onClick:J,class:"activity-card admit-card"},{default:o(()=>[N.value?(C(),ae(e(be),{key:0,class:"admit-badge",color:"primary"},{default:o(()=>[v(p(N.value),1)]),_:1})):H("",!0),n(e(Y),{class:"card-content"},{default:o(()=>[r("div",We,[n(e(F),{src:L("cry_baby.png"),alt:"Admit",class:"activity-icon"},null,8,["src"])]),n(e(W),{class:"card-label"},{default:o(()=>[...a[3]||(a[3]=[r("p",null,"Clinical Review",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),n(e($),{size:"6"},{default:o(()=>[n(e(B),{button:"",onClick:a[0]||(a[0]=l=>w("discharge")),class:"activity-card"},{default:o(()=>[n(e(Y),{class:"card-content"},{default:o(()=>[r("div",He,[n(e(F),{src:L("baby_transport.png"),alt:"Discharge",class:"activity-icon"},null,8,["src"])]),n(e(W),{class:"card-label"},{default:o(()=>[...a[4]||(a[4]=[r("p",null,"Discharge",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(e(Q),null,{default:o(()=>[n(e($),{size:"6"},{default:o(()=>[n(e(B),{button:"",onClick:a[1]||(a[1]=l=>w("in-patient")),class:"activity-card"},{default:o(()=>[n(e(Y),{class:"card-content"},{default:o(()=>[r("div",ze,[n(e(F),{src:L("med_clinic.png"),alt:"Clinical Review",class:"activity-icon"},null,8,["src"])]),n(e(W),{class:"card-label"},{default:o(()=>[...a[5]||(a[5]=[r("p",null,"In-Patient",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a[8]||(a[8]=r("div",{class:"section-header",style:{"margin-top":"24px"}},[r("h2",null,"Quick Actions")],-1)),n(e(Ae),null,{default:o(()=>[n(e(Q),null,{default:o(()=>[n(e($),{size:"6"},{default:o(()=>[n(e(B),{button:"",onClick:a[2]||(a[2]=l=>w("instruction-guides")),class:"activity-card"},{default:o(()=>[n(e(Y),{class:"card-content"},{default:o(()=>[r("div",Xe,[n(e(F),{src:L("info.png"),alt:"Instruction Guides",class:"activity-icon"},null,8,["src"])]),n(e(W),{class:"card-label"},{default:o(()=>[...a[6]||(a[6]=[r("p",null,"Instruction Guides",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Ke=ye(qe,[["__scopeId","data-v-2166bbb3"]]),Je={class:"profile-container"},Qe={class:"profile-wrapper"},je={class:"demographics-card"},Ze={class:"profile-content"},et={class:"avatar-section"},tt={class:"info-section"},nt={class:"name-row"},at={class:"patient-name"},st={class:"name-line"},ot={class:"name-line"},rt={class:"meta-row"},it={key:0,class:"detail-row"},lt={class:"field-value scrollable-address"},ut={class:"detail-row"},ct={class:"field-value"},dt={class:"detail-row"},pt={class:"graphSection"},mt={style:{width:"100%","min-width":"0"}},ft={class:"ion-padding",slot:"content"},vt=ge({__name:"NeonatalPatientProfile",setup(Le){const m=Te(),{event:z,popoverOpen:f,openPopover:g,openPIM:N,printVisitSummary:L,printID:w,formatCurrentAddress:c}=xe(),d=y(!1),A=y(7),X=y([]),q=y([]),x=y([]),K=Se(()=>{switch(A.value){case 7:return"Admitted";case 6:return"Discharged";case 3:return"Died";default:return"Unknown"}}),V=Se(()=>{switch(A.value){case 7:return"status-admitted";case 6:return"status-discharged";case 3:return"status-died";default:return"status-unknown"}}),G=Oe(),{patient:u}=_e(G),b=async s=>{A.value=s},J=()=>{var t,S;if(!((S=(t=u.value)==null?void 0:t.personInformation)!=null&&S.birthdate))return!1;const s=h.dateDiffInDays(h.sessionDate(),u.value.personInformation.birthdate);return s>=0&&s<=28},i=()=>{if(!J()){console.warn("[NeonatalPatientProfile] Patient is not a neonate, redirecting to home"),m.push("/home");return}},a=async()=>{try{const s=await Ue.getLabResults(u.value);x.value=(s==null?void 0:s.results)||[]}catch(s){console.error("Error fetching lab results:",s),x.value=[]}},l=async()=>{var s;q.value=await $e.getJson("/hts_referral_orders",{patient_id:(s=u.value)==null?void 0:s.patientID,filter_by_lab_result:!0})},T=async()=>{var t;const s=await Be.getObsByEncounterId(O.REFERRAL);X.value=((t=s[0])==null?void 0:t.obs)||[]},M=s=>h.calculateDisplayAge(h.toStandardHisFormat(s)),_=()=>{var s,t,S,D;Pe.isEmpty((t=(s=u.value)==null?void 0:s.personInformation)==null?void 0:t.birthdate)||(d.value=h.dateDiffInDays(h.sessionDate(),(D=(S=u.value)==null?void 0:S.personInformation)==null?void 0:D.birthdate)<42)},k=()=>!!new Ye().isUnderFive(),U=()=>{var s,t;return h.toStandardHisDisplayFormat((t=(s=u.value)==null?void 0:s.personInformation)==null?void 0:t.birthdate)};return te(()=>m.currentRoute.value,async s=>{(s.name=="patientProfile"||s.name=="neonatalPatientProfile")&&u.value.patientID&&i()}),te(()=>{var s;return(s=u.value)==null?void 0:s.patientID},async(s,t)=>{s&&t!==void 0&&s!==t&&(_(),i(),await a(),await l())}),he(async()=>{_(),i(),await T(),await l(),await a()}),(s,t)=>{var D,se,oe,re,ie,le,ue,ce,de,pe,me,fe,ve,Ne;const S=Ce("ion-icon");return C(),ne("div",Je,[r("div",Qe,[r("div",je,[r("div",Ze,[r("div",et,[r("div",{class:Ie(["avatar-box",((se=(D=e(u))==null?void 0:D.personInformation)==null?void 0:se.gender)=="M"?"male-avatar":"female-avatar"])},[n(S,{icon:e(we),class:"avatar-icon"},null,8,["icon"])],2)]),r("div",tt,[r("div",nt,[r("h2",at,[r("span",st,p((re=(oe=e(u))==null?void 0:oe.personInformation)==null?void 0:re.given_name)+" "+p((le=(ie=e(u))==null?void 0:ie.personInformation)==null?void 0:le.middle_name),1),r("span",ot,p((ce=(ue=e(u))==null?void 0:ue.personInformation)==null?void 0:ce.family_name),1)]),r("div",{class:"menu-trigger",onClick:t[0]||(t[0]=I=>e(g)(I))},[n(S,{icon:e(Me)},null,8,["icon"])])]),r("div",rt,[r("span",null,p(((pe=(de=e(u))==null?void 0:de.personInformation)==null?void 0:pe.gender)=="M"?"Male":"Female"),1),t[9]||(t[9]=r("span",{class:"separator"},"•",-1)),r("span",null,p(M((fe=(me=e(u))==null?void 0:me.personInformation)==null?void 0:fe.birthdate))+" old",1),t[10]||(t[10]=r("span",{class:"separator"},"•",-1)),r("span",null,p(U()),1)]),(Ne=(ve=e(u))==null?void 0:ve.personInformation)!=null&&Ne.current_district?(C(),ne("div",it,[t[11]||(t[11]=r("span",{class:"field-label"},"Current Address:",-1)),r("span",lt,p(e(c)(e(u))),1)])):H("",!0),r("div",ut,[t[12]||(t[12]=r("span",{class:"field-label"},"MRN:",-1)),r("span",ct,p(e(u).ID),1)]),r("div",dt,[t[13]||(t[13]=r("span",{class:"field-label"},"Outcome:",-1)),r("span",{class:Ie(["outcome-badge",V.value])},p(K.value),3)])])])]),r("div",pt,[r("div",mt,[k()?(C(),ae(Ve,{key:0,checkUnderSixWeeks:d.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):H("",!0),k()?H("",!0):(C(),ae(Ge,{key:1}))])]),n(Ke),n(e(Re),{class:"menu-popover","is-open":e(f),"show-backdrop":!1,event:e(z),onDidDismiss:t[8]||(t[8]=I=>f.value=!1)},{default:o(()=>[r("div",null,[n(e(ke),{multiple:!0},{default:o(()=>[n(e(R),{value:"first","toggle-icon":"",onClick:t[1]||(t[1]=I=>e(N)())},{default:o(()=>[n(e(E),{slot:"header",color:"light"},{default:o(()=>[n(e(P),null,{default:o(()=>[...t[14]||(t[14]=[v("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),n(e(R),{value:"first","toggle-icon":"",onClick:t[2]||(t[2]=()=>{})},{default:o(()=>[n(e(E),{slot:"header",color:"light"},{default:o(()=>[n(e(P),null,{default:o(()=>[...t[15]||(t[15]=[v("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),n(e(R),{value:"second","toggle-icon":"",onClick:t[3]||(t[3]=I=>e(L)())},{default:o(()=>[n(e(E),{slot:"header",color:"light"},{default:o(()=>[n(e(P),null,{default:o(()=>[...t[16]||(t[16]=[v("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),n(e(R),{value:"third","toggle-icon":"",onClick:t[4]||(t[4]=I=>e(w)())},{default:o(()=>[n(e(E),{slot:"header",color:"light"},{default:o(()=>[n(e(P),null,{default:o(()=>[...t[17]||(t[17]=[v("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),n(e(R),{value:"fourth"},{default:o(()=>[n(e(E),{slot:"header",color:"light"},{default:o(()=>[n(e(P),null,{default:o(()=>[...t[18]||(t[18]=[v("Update outcome",-1)])]),_:1})]),_:1}),r("div",ft,[n(e(De),null,{default:o(()=>[n(e(E),null,{default:o(()=>[n(e(j),{checked:A.value==7,value:"active",onIonChange:t[5]||(t[5]=I=>b(7))},{default:o(()=>[...t[19]||(t[19]=[v(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),n(e(E),null,{default:o(()=>[n(e(j),{checked:A.value==6,value:"inactive",onIonChange:t[6]||(t[6]=I=>b(6))},{default:o(()=>[...t[20]||(t[20]=[v(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),n(e(E),null,{default:o(()=>[n(e(j),{checked:A.value==3,value:"died",onIonChange:t[7]||(t[7]=I=>b(3))},{default:o(()=>[...t[21]||(t[21]=[v(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])])}}}),Vt=ye(vt,[["__scopeId","data-v-410d2fd4"]]);export{Vt as default};
