import{D as je,d as V,af as U,G as Y,E as ie,ag as ye,ah as j,a6 as R,I as Z,ab as K,R as Ce,bb as Ae,aU as $e,H as l,e as v,f as u,k as a,l as e,b7 as _e,b6 as Te,b3 as le,J as o,Q as k,F,b2 as ge,r as S,cr as Fe,w as Ne,a as re,n as Ve,P as B,K as E,u as c,cY as We,am as ze,L as W,a2 as O,bK as Ke,ad as de,ac as X,ae as ve,cs as Qe,aC as qe,m as H,O as G,p as Q,bw as ee,bp as Ye,bC as Ee,aV as we,aR as xe,N as Se,aS as Me,c as oe,aK as Ze,aa as Xe,av as et,da as tt,ep as nt,eq as ot,er as st,cg as Ie,br as at,M as it,aj as se,ai as ae,c6 as lt,bB as rt,dg as he,df as dt}from"./vendor-CAxM8KGs.js";import{n as te,aY as Be,H as q,F as ne,a_ as ct,aZ as ut,u as z,_ as x,D as pt,B as He,bf as _t,a0 as ue,g as gt,C as Re,Z as mt,w as Ge,ba as ft,o as Je,I as vt,an as ht,bg as bt,bh as Dt,bi as Pe,bj as Oe,bk as be,bb as me,bl as De,bm as yt,b0 as fe,$ as Ct,d as $t,bn as wt,T as St}from"../index-CSiBRz_H.js";import{P as Mt}from"./patient_diagnosis_service-Dowtzk-J.js";import{D as It}from"./DashBox-G-5QVoMj.js";import{B as pe}from"./BasicForm-B0bC2Yzg.js";import{l as kt}from"./lodash-NJiRuGo9.js";import{f as Nt}from"./formatServerData-CZ0pe3c6.js";import{v as Pt}from"./group_validation-BX0sevkQ.js";import{u as Ot}from"./ComplicationsStore-D7KGR3rm.js";import{g as Lt,P as ke}from"./nonPharmaTherapyStore-6O0q0--b.js";import{D as At,a as Tt,A as Ft}from"./NextAppointment-BeXC72UE.js";const Le=je("NCDDiagnosisStore",{state:()=>({diagnosis:[{selectedData:[],isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Diagnosis",icon:te.search,value:"",name:"diagnosis",eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"name",valueType:"coded",multiSelectData:[],id:"",validationFunctionName:"required"}]}]}}]}),actions:{setDiagnosis(t){this.diagnosis=t}}}),Vt=V({name:"Menu",components:{IonContent:K,IonHeader:Z,IonItem:R,IonList:j,IonMenu:ye,IonTitle:ie,IonToolbar:Y,List:Be},computed:{...U(z,["patient"])},data(){return{valueNumericArray:[],obsDatetime:[],graphIcon:ut(["#006401"]),listIcon:ct(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}},setup(){return{checkmark:$e,pulseOutline:Ae}},async mounted(){const t=await ne.getAll(this.patient.patientID,"Primary diagnosis"),n=await ne.getAll(this.patient.patientID,"Secondary diagnosis"),g=await ne.getAll(this.patient.patientID,"Attempted/ Differential diagnosis"),f=[...t||[],...n||[],...g||[]],h=kt.isEmpty(f)?[]:Promise.all(f.map(async s=>({name:await ne.getConceptName(s.value_coded),obs_date:s.obs_datetime})));this.setListData(await h)},methods:{dismiss(){Ce.dismiss()},handleIcon(){},setActivClass(t){this.activeHeight="",this.activeBMI="",this.activeWeight="",t=="height"?this.activeHeight="_active":t=="weight"?this.activeWeight="_active":t=="BMI"&&(this.activeBMI="_active")},setListData(t){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),t.forEach(n=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[q.toStandardHisFormat(n.obs_date),n.name,""]})})}}}),Et={class:"modal_wrapper"};function xt(t,n,g,f,h,s){const i=l("list");return u(),v("div",Et,[a("div",null,[e(i,{listData:t.list},null,8,["listData"])])])}const Bt=x(Vt,[["render",xt],["__scopeId","data-v-5665ae64"]]),Ht=V({name:"Menu",components:{IonContent:K,IonHeader:Z,IonItem:R,IonList:j,IonMenu:ye,IonTitle:ie,IonToolbar:Y,IonInput:le,IonPopover:Te,DashBox:It,SelectionPopover:_t,BasicInputField:He,List:Be,BasicForm:pe,DynamicButton:pt,previousDiagnosis:Bt,DataTable:_e},data(){return{iconsContent:te,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",conditionStatus:"",data:[],diagnosisData:[],popoverOpen:!1,event:"",selectedCondition:""}},setup(){return{checkmark:$e,pulseOutline:Ae}},computed:{...U(Le,["diagnosis"]),...U(z,["patient"])},async mounted(){await this.getDiagnosis("")},methods:{async getDiagnosis(t){let n=await Mt.getDiagnosis(t,1,15);ue(this.diagnosis,"diagnosis","multiSelectData",n)},dismiss(){Ce.dismiss()},async addNewRow(){var t,n,g,f,h,s,i,r;if(await Pt(this.diagnosis)){ue(this.diagnosis,"diagnosis","alertsErrorMassage","");const d=await Nt(this.diagnosis);let m="";if(this.diagnosis&&this.diagnosis.length>0){const p=this.diagnosis[0];(h=(f=(g=(n=(t=p==null?void 0:p.data)==null?void 0:t.rowData)==null?void 0:n[0])==null?void 0:g.colData)==null?void 0:f[0])!=null&&h.value&&(m=p.data.rowData[0].colData[0].value.name||"")}if(!m&&d.length>0&&d[0].value_coded)try{const p=await gt("concept_names",{selector:{concept_id:d[0].value_coded}});p&&(m=p.name)}catch(p){console.error("Could not fetch from PouchDB:",p)}const _=d.map(p=>({...p,diagnosis_name:m||"Unknown Diagnosis",obs_datetime:p.obs_datetime||q.sessionDate()})),$=z(),w=JSON.parse(JSON.stringify($.patient));(r=(i=(s=w.diagnosis)!=null?s:w.diagnosis={}).unsaved)!=null||(i.unsaved=[]),w.diagnosis.unsaved.push(..._);try{await Re(w),await new Promise(p=>setTimeout(p,500)),mt("Diagnosis successfully saved"),this.dismiss()}catch(p){console.error(" Error saving diagnosis:",p),Ge("Failed to save diagnosis. Please try again.")}}else ue(this.diagnosis,"diagnosis","alertsErrorMassage","Please select diagnosis from the list")},updateDiagnosisStores(){Le().setDiagnosis(this.diagnosis)},async handleInputData(t){ue(this.diagnosis,"diagnosis","alertsErrorMassage","")}}}),Rt={class:"modal_wrapper"},Gt={class:""};function Jt(t,n,g,f,h,s){const i=l("ion-title"),r=l("ion-icon"),d=l("ion-header"),m=l("basic-form"),_=l("ion-content"),$=l("DynamicButton"),w=l("ion-col"),p=l("ion-row"),y=l("ion-footer");return u(),v(F,null,[e(d,{style:{display:"flex","justify-content":"space-between"}},{default:o(()=>[e(i,{class:"modalTitle"},{default:o(()=>[...n[2]||(n[2]=[k("Add Diagnosis",-1)])]),_:1}),e(r,{onClick:n[0]||(n[0]=C=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),e(_,{fullscreen:!0,style:{"--background":"#fff"}},{default:o(()=>[a("div",Rt,[a("div",Gt,[e(m,{contentData:t.diagnosis,onSearchChange:t.getDiagnosis,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onSearchChange","onUpdate:inputValue"])])])]),_:1}),e(y,{collapse:"fade",class:"ion-no-border"},{default:o(()=>[e(p,null,{default:o(()=>[e(w,null,{default:o(()=>[e($,{onClick:n[1]||(n[1]=C=>t.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const Ut=x(Ht,[["render",Jt],["__scopeId","data-v-a39d0e4b"]]),jt={class:"table-responsive"},Wt=V({__name:"Diagnosis",setup(t){const n=ft(),g=z(),{diagnosis:f}=ge(n),{patient:h}=ge(g),s=S(null),i=S([]),r=S(te),d=["Diagnosis","Date","Action"],m={responsive:!0,select:!1,layout:{topStart:"buttons",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1,buttons:[{text:" <b>+ Add diagnosis </b>",className:"add-test text-white",action:async()=>{await _()}}]},_=async()=>{await Je(Ut,{class:"lab-results-modal"},!0),await p()},$=async C=>C.length>0?await Promise.all(C.map(async M=>{let P=M.diagnosis_name||M.name;!P&&M.value_coded&&(P=await ne.getConceptName(M.value_coded));const N=M.obs_datetime;return[P||"",q.toStandardHisFormat(N),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify({id:M.obs_id,value_coded:M.value_coded,name:P,obs_date:N}),"'>").concat(r.value.delete2,"</button>")]})):[],w=async(C,M)=>{var N;if(await vt("Do you want to delete ".concat(C.name," ?"),M)){const b=JSON.parse(JSON.stringify(h.value)),D=b.diagnosis;C!=null&&C.id?(D.saved=D.saved.filter(I=>!(I.value_coded===C.value_coded&&I.obs_datetime===C.obs_date)),(N=D.voided)!=null||(D.voided=[]),D.voided.push(C)):D.unsaved=D.unsaved.filter(I=>!(I.value_coded===C.value_coded&&I.obs_datetime===C.obs_date)),await Re(b)}},p=async()=>{var P,N;const C=JSON.parse(JSON.stringify(h.value)),M=[...((P=C==null?void 0:C.diagnosis)==null?void 0:P.unsaved)||[],...((N=C==null?void 0:C.diagnosis)==null?void 0:N.saved)||[]];i.value=await $(M),_e.use(We)},y=Fe();return Ne(()=>y,async()=>{await p()},{deep:!0}),Ne(()=>h,async()=>{await p()},{deep:!0}),re(async()=>{await p(),Ve(()=>{const C=s.value.dt;C.columns.adjust().draw(),C.on("click",".delete-btn",M=>{const P=M.target.getAttribute("data-id");w(JSON.parse(P),M)})})}),(C,M)=>(u(),v("div",jt,[e(c(_e),{ref_key:"dataTableRef",ref:s,options:m,data:i.value,class:"display nowrap modern-table",width:"100%"},{default:o(()=>[a("thead",null,[a("tr",null,[(u(),v(F,null,B(d,P=>a("th",{key:P},E(P),1)),64))])])]),_:1},8,["data"])]))}}),So=x(Wt,[["__scopeId","data-v-13544ebc"]]),zt={class:"sub_item_body"},Kt={class:"ion-padding",slot:"content"},Qt={class:"table-responsive"},qt=V({__name:"ComplicationsScreening",setup(t){ze();const n=Ot(),{FootScreening:g,visualScreening:f,cvScreening:h}=ge(n),s=z(),{patient:i}=ge(s);Fe();const r=S(null),d=S([]);S(!1),S(!1),S("");const m=S("");S({btnColor:"secondary",btnName:"No risk"});const _=S(te),$=["Condition","Result","Date","Action"],w={responsive:!0,select:!1,layout:{topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},p=async()=>{var N,b;const M=JSON.parse(JSON.stringify(i.value)),P=[...((N=M==null?void 0:M.screening)==null?void 0:N.unsaved)||[],...((b=M==null?void 0:M.screening)==null?void 0:b.saved)||[]];d.value=await y(P)},y=async M=>M.length===0?[]:(await Promise.all(M.map(async N=>N.concept_name==="Visual acuity"?N.children.map(b=>[b.concept_name,b.value_text,q.toStandardHisFormat(b.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(b),"'>\n                        ").concat(_.value.delete2,"</button>")]):N.concept_name==="Foot check"?Promise.all(N.children.map(async b=>[b.concept_name,await ht.getConceptName(b.value_coded),q.toStandardHisFormat(b.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(b),"'>\n                            ").concat(_.value.delete2,"</button>")])):N.concept_name==="Cardiovascular disease"?[["CVD %",N.value_text,q.toStandardHisFormat(N.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(N),"'>\n                            ").concat(_.value.delete2,"</button>")]]:[]))).flat(),C=M=>{};return re(async()=>{await p(),Ve(()=>{const M=r.value.dt;M.columns.adjust().draw(),M.on("click",".delete-btn",P=>{const N=P.target.getAttribute("data-id");C(JSON.parse(N))})})}),(M,P)=>{const N=l("ion-label"),b=l("ion-accordion"),D=l("ion-accordion-group"),I=l("ion-row");return u(),v(F,null,[e(pe,{contentData:c(f)},null,8,["contentData"]),e(c(j),null,{default:o(()=>[e(c(R),{lines:m.value,class:"dashed_bottom_border textSectionFormat"},{default:o(()=>[...P[0]||(P[0]=[a("span",{style:{display:"flex","align-items":"center",gap:"10px"}}," Foot screening ",-1)])]),_:1},8,["lines"]),a("div",zt,[e(pe,{contentData:c(g)},null,8,["contentData"])])]),_:1}),e(pe,{contentData:c(h)},null,8,["contentData"]),e(I,null,{default:o(()=>[e(D,{ref:"accordionGroup",class:"previousView"},{default:o(()=>[e(b,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(c(R),{slot:"header",color:"light"},{default:o(()=>[e(N,{class:"previousLabel"},{default:o(()=>[...P[1]||(P[1]=[k("Previous Visits",-1)])]),_:1})]),_:1}),a("div",Kt,[a("div",Qt,[e(c(_e),{ref_key:"dataTableRef",ref:r,options:w,data:d.value,class:"display nowrap",width:"100%"},{default:o(()=>[a("thead",null,[a("tr",null,[(u(),v(F,null,B($,A=>a("th",{key:A},E(A),1)),64))])])]),_:1},8,["data"])])])]),_:1})]),_:1},512)]),_:1})],64)}}}),Mo=x(qt,[["__scopeId","data-v-f3420ad0"]]),Yt=V({name:"Home",components:{IonContent:K,IonHeader:Z,IonMenuButton:Qe,IonPage:ve,IonTitle:ie,IonToolbar:Y,IonRow:X,IonCol:de,IonChip:Ke,IonLabel:O,IonIcon:W},computed:{...U(z,["patient"])},data(){const t=S([]),n=S([]),g=async()=>{try{const s=this.patient;Dt(s.ID);const i=S(!1),r=_=>{i.value=_};t.value=await Lt();const d=t.value.some(_=>_.toLowerCase().includes("hypertension")),m=t.value.some(_=>_.toLowerCase().includes("diabetes"));d&&(r(!0),Pe()),m&&(r(!0),Oe()),i.value==!1}catch(s){}},f=async()=>{const s=n.value.some(r=>r.toLowerCase().includes("hypertension")),i=n.value.some(r=>r.toLowerCase().includes("diabetes"));s&&await Pe(),i&&await Oe()};return{diagnoses:t,selectedDiagnoses:n,medkitOutline:qe,initC:g,toggleDiagnosisSelection:s=>{const i=n.value.indexOf(s);i===-1?(n.value.push(s),be(),f()):(n.value.splice(i,1),be(),f()),n.value.length===0&&(be(),g())}}},async mounted(){this.initC()},watch:{patient:{handler(){bt(this.patient.ID),this.initC()},deep:!0}}}),Zt={key:0,class:"diagnosis-container"},Xt={class:"heading"},en={class:"diagnosis-list"};function tn(t,n,g,f,h,s){const i=l("ion-icon"),r=l("ion-label"),d=l("ion-chip"),m=l("ion-col"),_=l("ion-row");return t.diagnoses.length>0?(u(),v("div",Zt,[a("div",Xt,[e(i,{icon:t.medkitOutline,class:"diagnosis-icon"},null,8,["icon"]),n[0]||(n[0]=a("h2",null,"Diagnosis",-1))]),e(_,null,{default:o(()=>[e(m,null,{default:o(()=>[a("div",en,[(u(!0),v(F,null,B(t.diagnoses,($,w)=>(u(),G(d,{key:w,class:Q({"diagnosis-chip-selected":t.selectedDiagnoses.includes($)}),onClick:p=>t.toggleDiagnosisSelection($)},{default:o(()=>[e(r,null,{default:o(()=>[k(E($),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),_:1})])):H("",!0)}const nn=x(Yt,[["render",tn],["__scopeId","data-v-2bd0f8ca"]]),on=V({name:"MedicationSearch",components:{IonContent:K,IonPage:ve,IonItem:R,IonLabel:O,IonInput:le,IonIcon:W,BasicInputField:He,IonCard:ee},setup(){const t=S(""),n=me();return{searchText:t,searchTextUpdated:f=>{const h=f.target;t.value=h.value;const s=n.medications.filter(i=>i.name.toLowerCase().includes(t.value.toLowerCase()));n.setFilteredMedications(s)},searchOutline:Ye}}});function sn(t,n,g,f,h,s){const i=l("BasicInputField"),r=l("ion-card");return u(),v("div",null,[a("div",null,[e(r,null,{default:o(()=>[e(i,{placeholder:"Filter medication list by name",icon:t.searchOutline,inputValue:t.searchText,"onUpdate:inputValue":t.searchTextUpdated,minHeight:50},null,8,["icon","inputValue","onUpdate:inputValue"])]),_:1})])])}const an=x(on,[["render",sn]]),ln=V({name:"medication",components:{IonCard:ee,IonCardHeader:Me,IonButton:Se,IonCardTitle:xe,IonCardContent:we,IonInput:le,IonIcon:W,IonCol:de,IonRow:X,IonCheckbox:Ee,PreviousNCDDiagnosis:nn,MedicationSearchInput:an},computed:{...U(me,["medications","filteredMedications"]),...U(De,["otherNCDMedications"]),activeMedications(){return this.useDefaultStores?this.filteredMedications:this.otherNCDMedications}},props:{useDefaultStores:{type:Boolean,default:!0}},setup(t){const n=me();n.initMedications();const g=oe(()=>n.selectedNCDMedicationList),f=De(),h=oe(()=>f.selectedOtherNCDMedicationList),s=oe(()=>t.useDefaultStores?g.value:h.value),i=S(!1),r=S({});let d=null;const m=()=>{i.value=!1,d&&(clearTimeout(d),d=null)},_=b=>{r.value={...r.value,[b]:!0},i.value=!0,d&&clearTimeout(d),d=window.setTimeout(()=>{i.value=!1,d=null},3e3),window.setTimeout(()=>{const D={...r.value};delete D[b],r.value=D},3e3)},$=b=>/^\d*$/.test(b),w=(b,D,I)=>{let A=I.target.value;const J="".concat(b,"-").concat(D);if(A!==""&&!$(A)){_(J);const L=s.value.find(ce=>ce.drug_id===b);A=(L==null?void 0:L.dosage[D])||"",setTimeout(()=>{const ce=I.target;ce&&(ce.value=A)},0);return}if(A!==""){const L=parseInt(A);isNaN(L)||L<0?A="0":A=Math.floor(L).toString()}const T=s.value.findIndex(L=>L.drug_id===b);if(T>-1){const L={...s.value[T]};L.dosage={...L.dosage,[D]:A},s.value[T]=L}},p=(b,D)=>{let I=D.target.value;const A="".concat(b,"-duration");if(I!==""&&!$(I)){_(A);const T=s.value.find(L=>L.drug_id===b);I=(T==null?void 0:T.duration)||"",setTimeout(()=>{const L=D.target;L&&(L.value=I)},0);return}if(I!==""){const T=parseInt(I);isNaN(T)||T<1?I="1":I=Math.floor(T).toString()}const J=s.value.findIndex(T=>T.drug_id===b);if(J>-1){const T={...s.value[J]};T.duration=I,s.value[J]=T}},y=b=>s.value.some(D=>D.drug_id===b);return{medkit:Ie,sunny:st,partlySunny:ot,moon:nt,timeOutline:tt,alertCircleOutline:et,closeCircleOutline:Xe,updateDosage:w,updateDuration:p,getDosage:(b,D)=>{const I=s.value.find(A=>A.drug_id===b);return(I==null?void 0:I.dosage[D])||""},getDuration:b=>{const D=s.value.find(I=>I.drug_id===b);return(D==null?void 0:D.duration)||""},calculateQuantity:b=>{const D=s.value.find(J=>J.drug_id===b);if(!D||!D.dosage||!D.duration)return"";const I=["morning","afternoon","evening"].reduce((J,T)=>{const L=parseInt(D.dosage[T])||0;return J+L},0),A=parseInt(D.duration)||0;return(I*A).toString()},isActive:y,toggleMedication:async b=>{try{if(y(b)){const D=s.value.findIndex(I=>I.drug_id===b);D>-1&&s.value.splice(D,1)}else{const D=await yt(b);t.useDefaultStores==!1?f.setSelectedNCDMedicationList(D):n.setSelectedNCDMedicationList(D)}}catch(D){Ge("Error toggling medication: "+D)}},cubeOutline:Ze,showErrorMessage:i,errorFields:r,hideErrorMessage:m}}}),rn={key:0},dn={key:0,class:"error-message"},cn={class:"table-container"},un={class:"prescription-table"},pn=["onClick"],_n=["onClick"],gn={class:"med-kit-font"};function mn(t,n,g,f,h,s){const i=l("PreviousNCDDiagnosis"),r=l("ion-col"),d=l("MedicationSearchInput"),m=l("ion-row"),_=l("ion-icon"),$=l("ion-button"),w=l("ion-checkbox"),p=l("ion-input");return u(),v(F,null,[e(m,null,{default:o(()=>[e(r,{size:"5"},{default:o(()=>[t.useDefaultStores?(u(),G(i,{key:0})):H("",!0)]),_:1}),e(r,null,{default:o(()=>[t.useDefaultStores&&t.medications.length>0?(u(),G(d,{key:0,style:{"margin-top":"0px","font-weight":"600","font-size":"16px"}})):H("",!0)]),_:1})]),_:1}),t.activeMedications.length>0?(u(),v("div",rn,[t.showErrorMessage?(u(),v("div",dn,[e(_,{icon:t.alertCircleOutline,color:"danger"},null,8,["icon"]),n[0]||(n[0]=a("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),e($,{fill:"clear",size:"small",onClick:t.hideErrorMessage},{default:o(()=>[e(_,{icon:t.closeCircleOutline},null,8,["icon"])]),_:1},8,["onClick"])])):H("",!0),a("div",cn,[a("table",un,[a("thead",null,[a("tr",null,[n[6]||(n[6]=a("th",{class:"checkbox-col"},"Select",-1)),n[7]||(n[7]=a("th",null,"Medication",-1)),a("th",null,[e(_,{icon:t.partlySunny},null,8,["icon"]),n[1]||(n[1]=k(" Morning",-1))]),a("th",null,[e(_,{icon:t.sunny},null,8,["icon"]),n[2]||(n[2]=k(" Noon",-1))]),a("th",null,[e(_,{icon:t.moon},null,8,["icon"]),n[3]||(n[3]=k(" Night",-1))]),a("th",null,[e(_,{icon:t.timeOutline},null,8,["icon"]),n[4]||(n[4]=k(" Duration",-1))]),a("th",null,[e(_,{icon:t.cubeOutline},null,8,["icon"]),n[5]||(n[5]=k(" Quantity",-1))])])]),a("tbody",null,[(u(!0),v(F,null,B(t.activeMedications,y=>(u(),v("tr",{key:y.id,class:Q({"active-row":t.isActive(y.drug_id)})},[a("td",{class:"checkbox-col",onClick:C=>t.toggleMedication(y.drug_id)},[e(w,{checked:t.isActive(y.drug_id),style:{"--size":"26px"}},null,8,["checked"])],8,pn),a("td",{style:{cursor:"pointer"},onClick:C=>t.toggleMedication(y.drug_id)},[a("span",gn,E(y.name),1)],8,_n),a("td",null,[e(p,{type:"text",class:Q(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(y.drug_id,"-morning")]}]),disabled:!t.isActive(y.drug_id),value:t.getDosage(y.drug_id,"morning"),onIonInput:C=>t.updateDosage(y.drug_id,"morning",C),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),a("td",null,[e(p,{type:"text",class:Q(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(y.drug_id,"-afternoon")]}]),disabled:!t.isActive(y.drug_id),value:t.getDosage(y.drug_id,"afternoon"),onIonInput:C=>t.updateDosage(y.drug_id,"afternoon",C),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),a("td",null,[e(p,{type:"text",class:Q(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(y.drug_id,"-evening")]}]),disabled:!t.isActive(y.drug_id),value:t.getDosage(y.drug_id,"evening"),onIonInput:C=>t.updateDosage(y.drug_id,"evening",C),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),a("td",null,[e(p,{type:"text",class:Q(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(y.drug_id,"-duration")]}]),disabled:!t.isActive(y.drug_id),value:t.getDuration(y.drug_id),onIonInput:C=>t.updateDuration(y.drug_id,C),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),a("td",null,[e(p,{type:"text",class:"dose-input bordered-input med-kit-font",readonly:"",value:t.calculateQuantity(y.drug_id),placeholder:"0"},null,8,["value"])])],2))),128))])])])])):H("",!0)],64)}const Ue=x(ln,[["render",mn],["__scopeId","data-v-c9584f56"]]),fn=V({name:"DrugSelector",components:{IonContent:K,IonHeader:Z,IonItem:R,IonList:j,IonMenu:ye,IonTitle:ie,IonToolbar:Y,IonInput:le,IonPopover:Te,VueMultiselect:at,IonLabel:O,IonCol:de,IonRow:X},emits:["drug-selected"],data(){const t=h=>{this.$emit("drug-selected",h)},n=async h=>{const s=fe(),i=h,_=(await Ct.getOfflineOPDDrugs({name:i,page:1,page_size:20})).map($=>({label:$.name,value:$.name,other:$,...$}));s.setPartialOPDdrugList(_)},g=oe(()=>this.partialOPDdrugList);return{selected_drug:S(null),selectedDrugName:t,FindDrugName:n,OPDDrugList:g}},computed:{...U(fe,["partialOPDdrugList"])}});function vn(t,n,g,f,h,s){const i=l("VueMultiselect"),r=l("ion-col"),d=l("ion-row");return u(),v("div",null,[e(d,null,{default:o(()=>[e(r,null,{default:o(()=>[e(i,{modelValue:t.selected_drug,"onUpdate:modelValue":[n[0]||(n[0]=m=>t.selected_drug=m),t.selectedDrugName],multiple:!1,taggable:!1,"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Select medication",placeholder:"Select medication",selectLabel:"",label:"name",searchable:!0,onSearchChange:t.FindDrugName,"track-by":"uuid",options:t.OPDDrugList},null,8,["modelValue","onUpdate:modelValue","onSearchChange","options"])]),_:1})]),_:1})])}const hn=x(fn,[["render",vn],["__scopeId","data-v-e33f5b73"]]),bn=V({name:"Home",mixins:[$t],components:{IonContent:K,IonHeader:Z,IonPage:ve,IonToolbar:Y,IonRow:X,IonTitle:ie,IonIcon:W,IonFooter:it,OPDMedications:hn,Medication:Ue,IonCol:de,IonButton:Se},data(){const t=De(),n=()=>{Ce.dismiss()};return{iconsContent:te,dismiss:n,addSearchedDrug:h=>{t.addSearchedDrug(h)},medkit:Ie,checkmark:$e,onAdd:()=>{wt(),t.clearOtherNCDMedications(),n()}}},computed:{},$route:{async handler(){},deep:!0},watch:{},async mounted(){},methods:{}}),Dn={class:"medication-list"},yn={class:"modal_wrapper"},Cn={class:""};function $n(t,n,g,f,h,s){const i=l("ion-icon"),r=l("ion-title"),d=l("ion-header"),m=l("OPDMedications"),_=l("Medication"),$=l("ion-content"),w=l("ion-button"),p=l("ion-col"),y=l("ion-row"),C=l("ion-footer");return u(),v(F,null,[e(d,{style:{display:"flex","justify-content":"space-between"}},{default:o(()=>[e(r,{class:"modalTitle"},{default:o(()=>[a("div",Dn,[e(i,{icon:t.medkit,class:"ion-margin-end"},null,8,["icon"]),n[1]||(n[1]=a("span",null,"Add Other Medication",-1))])]),_:1}),e(i,{onClick:n[0]||(n[0]=M=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),e($,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:o(()=>[a("div",yn,[a("div",Cn,[e(m,{onDrugSelected:t.addSearchedDrug},null,8,["onDrugSelected"]),e(_,{"use-default-stores":!1})])])]),_:1}),e(C,{collapse:"fade",class:"ion-no-border"},{default:o(()=>[e(y,null,{default:o(()=>[e(p,null,{default:o(()=>[e(w,{onClick:t.onAdd,color:"primary",style:{float:"right","margin-bottom":"20px","margin-right":"20px"}},{default:o(()=>[e(i,{icon:t.checkmark,slot:"start"},null,8,["icon"]),n[2]||(n[2]=k(" Add ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})],64)}const wn=x(bn,[["render",$n],["__scopeId","data-v-dee50533"]]),Sn=V({name:"Home",components:{IonContent:K,IonHeader:Z,IonPage:ve,IonToolbar:Y,Toolbar:St,IonRow:X,IonAccordion:ae,IonAccordionGroup:se,IonItem:R,IonLabel:O,DynamicList:At,IonCard:ee},data(){const t=S(0),n=S("Show more medications"),g=S(!1),f=S();return{componentKey:t,accordionGroupChange:r=>{const d=r.detail.value;d!==void 0?d=="second"&&(n.value="Show less medications",g.value=!g.value):(n.value="Show more medications",g.value=!g.value)},showMoreMedicationsMsg:n,itemWasExpanded:g,accordionGroupChangeFn1:r=>{},PreviuosSelectedMedicalDrugsList:f,loadPreviousMedications:async()=>{const r=new ke,{previousDrugPrescriptions:d}=await r.getPatientEncounters();f.value=d}}},computed:{...U(z,["patient"]),...U(me,["selectedNCDMedicationList"])},$route:{async handler(){},deep:!0},watch:{patient:{handler(){this.loadPreviousMedications()},deep:!0},selectedNCDMedicationList:{handler(){this.loadPreviousMedications()},deep:!0}},async mounted(){this.loadPreviousMedications()}}),Mn={style:{}},In={class:"ion-padding",slot:"content"},kn={key:0},Nn={class:"previousSecDrgs"},Pn={class:"ion-padding",slot:"content"},On={key:0},Ln={class:"previousSecDrgs"};function An(t,n,g,f,h,s){const i=l("ion-label"),r=l("ion-item"),d=l("dynamic-list"),m=l("ion-accordion"),_=l("ion-accordion-group"),$=l("ion-card");return u(),G($,null,{default:o(()=>[a("div",Mn,[e(_,{ref:"accordionGroup",class:"previousView",onIonChange:t.accordionGroupChangeFn1},{default:o(()=>[e(m,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(r,{slot:"header",color:"light"},{default:o(()=>[e(i,{class:"previousLabel"},{default:o(()=>[...n[0]||(n[0]=[k("Documented medications timeline",-1)])]),_:1})]),_:1}),a("div",In,[(u(!0),v(F,null,B(t.PreviuosSelectedMedicalDrugsList,(w,p)=>(u(),v("div",{class:"ionLbltp",key:p},[p==0?(u(),v("div",kn,[a("div",null,[e(i,{class:"previousLabelDate"},{default:o(()=>[k(E(w.prescriptionDate),1)]),_:2},1024)]),a("div",Nn,[(u(),G(d,{_selectedMedicalDrugsList:w.previousPrescriptions,show_actions_buttons:!1,key:t.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):H("",!0)]))),128)),e(_,{onIonChange:t.accordionGroupChange},{default:o(()=>[e(m,{value:"second","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(r,{slot:"header",color:"light"},{default:o(()=>[e(i,{class:"",color:"primary"},{default:o(()=>[k(E(t.showMoreMedicationsMsg),1)]),_:1})]),_:1}),a("div",Pn,[(u(!0),v(F,null,B(t.PreviuosSelectedMedicalDrugsList,(w,p)=>(u(),v("div",{class:"ionLbltp",key:p},[t.itemWasExpanded&&p>0?(u(),v("div",On,[a("div",null,[e(i,{class:"previousLabelDate"},{default:o(()=>[k(E(w.prescriptionDate),1)]),_:2},1024)]),a("div",Ln,[(u(),G(d,{_selectedMedicalDrugsList:w.previousPrescriptions,show_actions_buttons:!1,key:t.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):H("",!0)]))),128))])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})}const Tn=x(Sn,[["render",An],["__scopeId","data-v-1db96250"]]),Fn=V({name:"PrescriptionTable",components:{IonCard:ee,IonCardHeader:Me,IonButton:Se,IonCardTitle:xe,IonCardContent:we,IonInput:le,IonIcon:W,IonCol:de,IonRow:X,IonCheckbox:Ee,Medication:Ue,MedicationHistory:Tn},setup(){return{openAddOtherOPDMedicationModal:async()=>{await Je(wn,{class:"large-modal"},!0,{})},medkit:Ie}}});function Vn(t,n,g,f,h,s){const i=l("Medication"),r=l("ion-icon"),d=l("ion-button"),m=l("ion-col"),_=l("ion-row"),$=l("MedicationHistory"),w=l("IonCol"),p=l("ion-card-content"),y=l("ion-card");return u(),G(y,null,{default:o(()=>[e(p,null,{default:o(()=>[e(i),e(_,null,{default:o(()=>[e(m,null,{default:o(()=>[e(d,{onClick:t.openAddOtherOPDMedicationModal,color:"primary",style:{float:"right"}},{default:o(()=>[e(r,{icon:t.medkit,slot:"start"},null,8,["icon"]),n[0]||(n[0]=a("span",{style:{"margin-left":"10px","font-size":"16px","font-weight":"600"}}," ADD Other Medication",-1))]),_:1},8,["onClick"])]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(w,null,{default:o(()=>[e($)]),_:1})]),_:1})]),_:1})]),_:1})}const En=x(Fn,[["render",Vn],["__scopeId","data-v-a4ad7088"]]),xn={style:{"margin-top":"14px","margin-left":"10px"}},Bn={class:"ion-padding",slot:"content"},Hn={key:0},Rn={class:"previousSecDrgs"},Gn={class:"ion-padding",slot:"content"},Jn={class:"previousSecDrgs"},Un=V({watch:{},name:"xxxComponent"}),jn=V({...Un,setup(t){const n=S(),g=S(),f=S(!1),h=S(!1),s=S("Show more notes");re(async()=>{const d=new ke,{previousClinicalNotes:m}=await d.getPatientEncounters();n.value=Object.entries(m)[0];const[,..._]=Object.entries(m);g.value=_});function i(d){const m=d.detail.value;m!==void 0?m=="third"&&(s.value="Show less notes",h.value=!f.value):(s.value="Show more notes",h.value=!f.value)}function r(d){return d[1]}return(d,m)=>(u(),G(c(ee),null,{default:o(()=>[a("div",xn,[e(c(se),{ref:"accordionGroup",class:"previousView"},{default:o(()=>[e(c(ae),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(c(R),{slot:"header",color:"light"},{default:o(()=>[e(c(O),{class:"previousLabel"},{default:o(()=>[...m[0]||(m[0]=[k("Previous visits notes",-1)])]),_:1})]),_:1}),a("div",Bn,[(u(!0),v(F,null,B(n.value,(_,$)=>(u(),v("div",{class:"ionLbltp",key:$},[$==1?(u(),v("div",Hn,[(u(!0),v(F,null,B(_,(w,p)=>(u(),v("div",{key:p},[a("div",null,[e(c(O),{class:"previousLabelDate"},{default:o(()=>[k(E(w.date),1)]),_:2},1024)]),a("div",Rn,[e(c(j),null,{default:o(()=>[e(c(O),{class:"notes_p"},{default:o(()=>[k(E(w.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))])):H("",!0)]))),128)),e(c(se),{onIonChange:i},{default:o(()=>[e(c(ae),{value:"third","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(c(R),{slot:"header",color:"light"},{default:o(()=>[e(c(O),{class:"",color:"primary"},{default:o(()=>[k(E(s.value),1)]),_:1})]),_:1}),a("div",Gn,[(u(!0),v(F,null,B(g.value,(_,$)=>(u(),v("div",{class:"ionLbltp",key:$},[(u(!0),v(F,null,B(r(_),(w,p)=>(u(),v("div",{key:p},[a("div",null,[e(c(O),{class:"previousLabelDate"},{default:o(()=>[k(E(w.date),1)]),_:2},1024)]),a("div",Jn,[e(c(j),null,{default:o(()=>[e(c(O),{class:"notes_p"},{default:o(()=>[k(E(w.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)])]),_:1}))}}),Wn=x(jn,[["__scopeId","data-v-994df42d"]]),zn={style:{"margin-top":"14px","margin-left":"10px"}},Kn=V({watch:{},name:"xxxComponent"}),Qn=V({...Kn,setup(t){const n=fe(),g=te,f=oe(()=>n.nonPharmalogicalTherapyAndOtherNotes);function h(i){let r=i.target.value;s(r)}function s(i){fe().setNonPharmalogicalTherapyAndOtherNotes(i)}return(i,r)=>(u(),G(c(ee),null,{default:o(()=>[e(c(Me),null,{default:o(()=>[e(c(O),{class:"tpStndCls"},{default:o(()=>[e(c(W),{icon:c(lt),class:"header-icon","aria-hidden":"true"},null,8,["icon"]),r[1]||(r[1]=k(" Non-pharmalogical therapy and other notes ",-1))]),_:1})]),_:1}),e(c(we),null,{default:o(()=>[a("div",null,[e(Tt),e(c(R),{class:"input_item",style:{"min-height":"120px","margin-top":"14px"}},{default:o(()=>[e(c(O),null,{default:o(()=>[e(c(W),{slot:"start",icon:c(g).editPen,"aria-hidden":"true"},null,8,["icon"])]),_:1}),e(c(rt),{onIonInput:h,modelValue:f.value,"onUpdate:modelValue":r[0]||(r[0]=d=>f.value=d),style:{"min-height":"120px"},class:"inputTpln","auto-grow":!0,fill:"outline"},null,8,["modelValue"])]),_:1})]),a("div",zn,[e(Wn)])]),_:1})]),_:1}))}}),qn=x(Qn,[["__scopeId","data-v-fd19ec21"]]),Yn={class:"ion-padding",slot:"content"},Zn={key:0},Xn={class:"previousSecDrgs"},eo={class:"ion-padding",slot:"content"},to={class:"previousSecDrgs"},no=V({watch:{},name:"xxxComponent"}),oo=V({...no,setup(t){const n=S(!1),g=S(!1),f=S("Show more allergies"),h=S(),s=S();re(async()=>{const d=new ke,{previousDrugAllergies:m}=await d.getPatientEncounters();h.value=Object.entries(m)[0];const[,..._]=Object.entries(m);s.value=_});function i(d){const m=d.detail.value;m!==void 0?m=="fith"&&(f.value="Show less allegies",g.value=!n.value):(f.value="Show more allegies",g.value=!n.value)}function r(d){return d[1]}return(d,m)=>{const _=l("ion-card");return u(),G(_,null,{default:o(()=>[e(c(se),{ref:"accordionGroup",class:"previousView"},{default:o(()=>[e(c(ae),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(c(R),{slot:"header",color:"light"},{default:o(()=>[e(c(O),{class:"previousLabel"},{default:o(()=>[...m[0]||(m[0]=[k("Documented allergies timeline",-1)])]),_:1})]),_:1}),a("div",Yn,[(u(!0),v(F,null,B(h.value,($,w)=>(u(),v("div",{class:"ionLbltp",key:w},[w==1?(u(),v("div",Zn,[a("div",null,[e(c(O),{class:"previousLabelDate"},{default:o(()=>[k(E($[0].date),1)]),_:2},1024)]),(u(!0),v(F,null,B($,(p,y)=>(u(),v("div",{key:y},[a("div",Xn,[e(c(j),null,{default:o(()=>[e(c(O),{class:"notes_p"},{default:o(()=>[k(E(p.value),1)]),_:2},1024)]),_:2},1024)])]))),128))])):H("",!0)]))),128)),e(c(se),{onIonChange:i},{default:o(()=>[e(c(ae),{value:"fith","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:o(()=>[e(c(R),{slot:"header",color:"light"},{default:o(()=>[e(c(O),{class:"",color:"primary"},{default:o(()=>[k(E(f.value),1)]),_:1})]),_:1}),a("div",eo,[(u(!0),v(F,null,B(s.value,($,w)=>(u(),v("div",{class:"ionLbltp",key:w},[a("div",null,[e(c(O),{class:"previousLabelDate"},{default:o(()=>[k(E($[0]),1)]),_:2},1024)]),(u(!0),v(F,null,B(r($),(p,y)=>(u(),v("div",{key:y},[a("div",to,[e(c(j),null,{default:o(()=>[e(c(O),{class:"notes_p"},{default:o(()=>[k(E(p.value),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)]),_:1})}}}),so=x(oo,[["__scopeId","data-v-358c5959"]]),ao={class:"background"},io={key:0},lo={style:{margin:"10px"}},ro={key:1},co={style:{margin:"10px"}},uo={key:2},po={style:{margin:"10px"}},_o=V({__name:"TreatmentPlan",setup(t){const n=S(["medications","allergies","other_notes"]),g=S(n.value[0]);re(()=>{f(n.value[0])});function f(h){g.value=h}return(h,s)=>(u(),v("div",ao,[e(c(dt),{value:g.value,style:{"margin-top":"5px"}},{default:o(()=>[e(c(he),{value:"medications",onClick:s[0]||(s[0]=i=>f(n.value[0]))},{default:o(()=>[e(c(O),null,{default:o(()=>[...s[3]||(s[3]=[k("Medications",-1)])]),_:1})]),_:1}),e(c(he),{value:"allergies",onClick:s[1]||(s[1]=i=>f(n.value[1]))},{default:o(()=>[e(c(O),null,{default:o(()=>[...s[4]||(s[4]=[k("Allergies",-1)])]),_:1})]),_:1}),e(c(he),{value:"other_notes",onClick:s[2]||(s[2]=i=>f(n.value[2]))},{default:o(()=>[e(c(O),null,{default:o(()=>[...s[5]||(s[5]=[k("Non-pharmalogical therapy and other notes",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),g.value===n.value[0]?(u(),v("div",io,[a("div",lo,[e(En)])])):H("",!0),g.value===n.value[1]?(u(),v("div",ro,[a("div",co,[e(Ft),e(so,{style:{"margin-top":"10px"}})])])):H("",!0),g.value===n.value[2]?(u(),v("div",uo,[a("div",po,[e(qn)])])):H("",!0)]))}}),Io=x(_o,[["__scopeId","data-v-d844be41"]]);export{Mo as C,So as D,Io as T};
