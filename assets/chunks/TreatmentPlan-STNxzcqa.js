import{D as Ge,d as E,ah as j,b6 as ue,b5 as Ne,b2 as oe,G as se,E as me,ai as Pe,aj as U,_ as R,I as ae,a3 as Q,R as Oe,bf as je,aT as Le,H as r,e as b,f as u,l as e,J as n,Q as k,k as s,F as V,aV as pe,r as w,cI as Te,w as we,a as ie,n as Ae,P as x,K as F,u as d,cW as Ue,ao as ze,L as z,W as O,bD as We,a5 as le,a4 as q,a6 as fe,cp as Ke,aE as Qe,m as H,O as J,p as W,bq as X,bj as qe,bw as Ve,aU as De,aQ as Fe,N as ye,aR as Ce,c as Z,aM as Xe,a2 as Ye,ax as Ze,d8 as et,en as tt,eo as nt,ep as ot,ce as Se,bl as st,M as at,al as te,ak as ne,b$ as it,bv as lt,de as ve,dd as rt}from"./vendor-ChpUWbYC.js";import{l as Y,J as ct,b4 as dt,B as Ee,bd as ut,M as ce,o as xe,H as ee,u as K,aP as Be,G as pt,s as He,_ as B,aJ as _t,m as Re,V as gt,ag as mt,aS as ft,be as vt,bf as ht,bg as Me,bh as Ie,bi as he,aL as _e,bj as be,bk as bt,aK as ge,K as Dt,c as yt,bl as Ct,T as St}from"../index-DySoFw7y.js";import{P as $t}from"./patient_diagnosis_service-D9o5yX6D.js";import{D as wt}from"./DashBox-CCj1U8mx.js";import{B as de}from"./BasicForm-DcfZDxc8.js";import{p as Mt}from"./previousDiagnosis-hdFmb2nc.js";import{a as It}from"./formatServerData-DeP5Pq1y.js";import{v as kt}from"./group_validation-CsIOTkfZ.js";import{a as Nt,g as Pt,P as $e}from"./nonPharmaTherapyStore-D7gnOkBt.js";import{D as Ot,a as Lt,A as Tt}from"./NextAppointment-BVc0gG9u.js";const ke=Ge("NCDDiagnosisStore",{state:()=>({diagnosis:[{selectedData:[],isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Diagnosis",icon:Y.search,value:"",name:"diagnosis",eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",valueType:"coded",multiSelectData:[],id:"",validationFunctionName:"required"}]}]}}]}),actions:{setDiagnosis(t){this.diagnosis=t}}}),At=E({name:"Menu",components:{IonContent:Q,IonHeader:ae,IonItem:R,IonList:U,IonMenu:Pe,IonTitle:me,IonToolbar:se,IonInput:oe,IonPopover:Ne,DashBox:wt,SelectionPopover:ut,BasicInputField:Ee,List:dt,BasicForm:de,DynamicButton:ct,previousDiagnosis:Mt,DataTable:ue},data(){return{iconsContent:Y,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",conditionStatus:"",data:[],diagnosisData:[],popoverOpen:!1,event:"",selectedCondition:""}},setup(){return{checkmark:Le,pulseOutline:je}},computed:{...j(ke,["diagnosis"]),...j(K,["patient"])},async mounted(){await this.getDiagnosis("")},methods:{async getDiagnosis(t){let o=await $t.getDiagnosis(t,1,15);ce(this.diagnosis,"diagnosis","multiSelectData",o)},dismiss(){Oe.dismiss()},async addNewRow(){var t,o,h,y,C,a,i,l;if(await kt(this.diagnosis)){ce(this.diagnosis,"diagnosis","alertsErrorMassage","");const c=await It(this.diagnosis);let g="";if(this.diagnosis&&this.diagnosis.length>0){const p=this.diagnosis[0];(C=(y=(h=(o=(t=p==null?void 0:p.data)==null?void 0:t.rowData)==null?void 0:o[0])==null?void 0:h.colData)==null?void 0:y[0])!=null&&C.value&&(g=p.data.rowData[0].colData[0].value.name||"")}if(!g&&c.length>0&&c[0].value_coded)try{const v=(await xe("concept_names")).find(D=>D.concept_id===c[0].value_coded);v&&(g=v.name)}catch(p){console.error("Could not fetch from PouchDB:",p)}const _=c.map(p=>({...p,diagnosis_name:g||"Unknown Diagnosis",obs_datetime:p.obs_datetime||ee.sessionDate()})),S=K(),$=JSON.parse(JSON.stringify(S.patient));(l=(i=(a=$.diagnosis)!=null?a:$.diagnosis={}).unsaved)!=null||(i.unsaved=[]),$.diagnosis.unsaved.push(..._);try{await Be($),await new Promise(p=>setTimeout(p,500)),pt("Diagnosis successfully saved"),this.dismiss()}catch(p){console.error(" Error saving diagnosis:",p),He("Failed to save diagnosis. Please try again.")}}else ce(this.diagnosis,"diagnosis","alertsErrorMassage","Please select diagnosis from the list")},updateDiagnosisStores(){ke().setDiagnosis(this.diagnosis)},async handleInputData(t){ce(this.diagnosis,"diagnosis","alertsErrorMassage","")}}}),Vt={class:"modal_wrapper"},Ft={class:""};function Et(t,o,h,y,C,a){const i=r("ion-title"),l=r("ion-icon"),c=r("ion-header"),g=r("basic-form"),_=r("ion-content"),S=r("DynamicButton"),$=r("ion-col"),p=r("ion-row"),v=r("ion-footer");return u(),b(V,null,[e(c,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[e(i,{class:"modalTitle"},{default:n(()=>[...o[2]||(o[2]=[k("Add Diagnosis",-1)])]),_:1}),e(l,{onClick:o[0]||(o[0]=D=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),e(_,{fullscreen:!0,style:{"--background":"#fff"}},{default:n(()=>[s("div",Vt,[s("div",Ft,[e(g,{contentData:t.diagnosis,onSearchChange:t.getDiagnosis,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onSearchChange","onUpdate:inputValue"])])])]),_:1}),e(v,{collapse:"fade",class:"ion-no-border"},{default:n(()=>[e(p,null,{default:n(()=>[e($,null,{default:n(()=>[e(S,{onClick:o[1]||(o[1]=D=>t.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}const xt=B(At,[["render",Et],["__scopeId","data-v-ce46b048"]]),Bt={class:"table-responsive"},Ht=E({__name:"Diagnosis",setup(t){const o=_t(),h=K(),{diagnosis:y}=pe(o),{patient:C}=pe(h),a=w(null),i=w([]),l=w(Y),c=["Diagnosis","Date","Action"],g={responsive:!0,select:!1,layout:{topStart:"buttons",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1,buttons:[{text:" <b>+ Add diagnosis </b>",className:"add-test text-white",action:async()=>{await _()}}]},_=async()=>{await Re(xt,{class:"lab-results-modal"},!0),await p()},S=async D=>D.length>0?await Promise.all(D.map(async M=>{let N=M.diagnosis_name||M.name;if(!N&&M.value_coded)try{const f=(await xe("concept_names")).find(I=>I.concept_id===M.value_coded);f?N=f.name:N=await mt.getConceptName(M.value_coded)}catch(m){console.error("Error fetching concept name:",m),N=N}const P=M.obs_datetime;return[N,ee.toStandardHisFormat(P),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify({id:M.obs_id,value_coded:M.value_coded,name:N,obs_date:P}),"'>").concat(l.value.delete2,"</button>")]})):[],$=async(D,M)=>{var P;if(await gt("Do you want to delete ".concat(D.name," ?"),M)){const m=JSON.parse(JSON.stringify(C.value)),f=m.diagnosis;D!=null&&D.id?(f.saved=f.saved.filter(I=>!(I.value_coded===D.value_coded&&I.obs_datetime===D.obs_date)),(P=f.voided)!=null||(f.voided=[]),f.voided.push(D)):f.unsaved=f.unsaved.filter(I=>!(I.value_coded===D.value_coded&&I.obs_datetime===D.obs_date)),await Be(m)}},p=async()=>{var N,P;const D=JSON.parse(JSON.stringify(C.value)),M=[...((N=D==null?void 0:D.diagnosis)==null?void 0:N.unsaved)||[],...((P=D==null?void 0:D.diagnosis)==null?void 0:P.saved)||[]];i.value=await S(M),ue.use(Ue)},v=Te();return we(()=>v,async()=>{await p()},{deep:!0}),we(()=>C,async()=>{await p()},{deep:!0}),ie(async()=>{await p(),Ae(()=>{const D=a.value.dt;D.columns.adjust().draw(),D.on("click",".delete-btn",M=>{const N=M.target.getAttribute("data-id");$(JSON.parse(N),M)})})}),(D,M)=>(u(),b("div",Bt,[e(d(ue),{ref_key:"dataTableRef",ref:a,options:g,data:i.value,class:"display nowrap modern-table",width:"100%"},{default:n(()=>[s("thead",null,[s("tr",null,[(u(),b(V,null,x(c,N=>s("th",{key:N},F(N),1)),64))])])]),_:1},8,["data"])]))}}),ho=B(Ht,[["__scopeId","data-v-50defa3e"]]),Rt={class:"sub_item_body"},Jt={class:"ion-padding",slot:"content"},Gt={class:"table-responsive"},jt=E({__name:"ComplicationsScreening",setup(t){ze();const o=Nt(),{FootScreening:h,visualScreening:y,cvScreening:C}=pe(o),a=K(),{patient:i}=pe(a);Te();const l=w(null),c=w([]);w(!1),w(!1),w("");const g=w("");w({btnColor:"secondary",btnName:"No risk"});const _=w(Y),S=["Condition","Result","Date","Action"],$={responsive:!0,select:!1,layout:{topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},p=async()=>{var P,m;const M=JSON.parse(JSON.stringify(i.value)),N=[...((P=M==null?void 0:M.screening)==null?void 0:P.unsaved)||[],...((m=M==null?void 0:M.screening)==null?void 0:m.saved)||[]];c.value=await v(N)},v=async M=>M.length===0?[]:(await Promise.all(M.map(async P=>P.concept_name==="Visual acuity"?P.children.map(m=>[m.concept_name,m.value_text,ee.toStandardHisFormat(m.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(m),"'>\n                        ").concat(_.value.delete2,"</button>")]):P.concept_name==="Foot check"?Promise.all(P.children.map(async m=>[m.concept_name,await ft.getConceptName(m.value_coded),ee.toStandardHisFormat(m.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(m),"'>\n                            ").concat(_.value.delete2,"</button>")])):P.concept_name==="Cardiovascular disease"?[["CVD %",P.value_text,ee.toStandardHisFormat(P.obs_datetime),'<button class="btn btn-outline-danger btn-sm delete-btn" data-id=\''.concat(JSON.stringify(P),"'>\n                            ").concat(_.value.delete2,"</button>")]]:[]))).flat(),D=M=>{};return ie(async()=>{await p(),Ae(()=>{const M=l.value.dt;M.columns.adjust().draw(),M.on("click",".delete-btn",N=>{const P=N.target.getAttribute("data-id");D(JSON.parse(P))})})}),(M,N)=>{const P=r("ion-label"),m=r("ion-accordion"),f=r("ion-accordion-group"),I=r("ion-row");return u(),b(V,null,[e(de,{contentData:d(y)},null,8,["contentData"]),e(d(U),null,{default:n(()=>[e(d(R),{lines:g.value,class:"dashed_bottom_border textSectionFormat"},{default:n(()=>[...N[0]||(N[0]=[s("span",{style:{display:"flex","align-items":"center",gap:"10px"}}," Foot screening ",-1)])]),_:1},8,["lines"]),s("div",Rt,[e(de,{contentData:d(h)},null,8,["contentData"])])]),_:1}),e(de,{contentData:d(C)},null,8,["contentData"]),e(I,null,{default:n(()=>[e(f,{ref:"accordionGroup",class:"previousView"},{default:n(()=>[e(m,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(d(R),{slot:"header",color:"light"},{default:n(()=>[e(P,{class:"previousLabel"},{default:n(()=>[...N[1]||(N[1]=[k("Previous Visits",-1)])]),_:1})]),_:1}),s("div",Jt,[s("div",Gt,[e(d(ue),{ref_key:"dataTableRef",ref:l,options:$,data:c.value,class:"display nowrap",width:"100%"},{default:n(()=>[s("thead",null,[s("tr",null,[(u(),b(V,null,x(S,T=>s("th",{key:T},F(T),1)),64))])])]),_:1},8,["data"])])])]),_:1})]),_:1},512)]),_:1})],64)}}}),bo=B(jt,[["__scopeId","data-v-f3420ad0"]]),Ut=E({name:"Home",components:{IonContent:Q,IonHeader:ae,IonMenuButton:Ke,IonPage:fe,IonTitle:me,IonToolbar:se,IonRow:q,IonCol:le,IonChip:We,IonLabel:O,IonIcon:z},computed:{...j(K,["patient"])},data(){const t=w([]),o=w([]),h=async()=>{try{const a=this.patient;ht(a.ID);const i=w(!1),l=_=>{i.value=_};t.value=await Pt();const c=t.value.some(_=>_.toLowerCase().includes("hypertension")),g=t.value.some(_=>_.toLowerCase().includes("diabetes"));c&&(l(!0),Me()),g&&(l(!0),Ie()),i.value==!1}catch(a){}},y=async()=>{const a=o.value.some(l=>l.toLowerCase().includes("hypertension")),i=o.value.some(l=>l.toLowerCase().includes("diabetes"));a&&await Me(),i&&await Ie()};return{diagnoses:t,selectedDiagnoses:o,medkitOutline:Qe,initC:h,toggleDiagnosisSelection:a=>{const i=o.value.indexOf(a);i===-1?(o.value.push(a),he(),y()):(o.value.splice(i,1),he(),y()),o.value.length===0&&(he(),h())}}},async mounted(){this.initC()},watch:{patient:{handler(){vt(this.patient.ID),this.initC()},deep:!0}}}),zt={key:0,class:"diagnosis-container"},Wt={class:"heading"},Kt={class:"diagnosis-list"};function Qt(t,o,h,y,C,a){const i=r("ion-icon"),l=r("ion-label"),c=r("ion-chip"),g=r("ion-col"),_=r("ion-row");return t.diagnoses.length>0?(u(),b("div",zt,[s("div",Wt,[e(i,{icon:t.medkitOutline,class:"diagnosis-icon"},null,8,["icon"]),o[0]||(o[0]=s("h2",null,"Diagnosis",-1))]),e(_,null,{default:n(()=>[e(g,null,{default:n(()=>[s("div",Kt,[(u(!0),b(V,null,x(t.diagnoses,(S,$)=>(u(),J(c,{key:$,class:W({"diagnosis-chip-selected":t.selectedDiagnoses.includes(S)}),onClick:p=>t.toggleDiagnosisSelection(S)},{default:n(()=>[e(l,null,{default:n(()=>[k(F(S),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),_:1})])):H("",!0)}const qt=B(Ut,[["render",Qt],["__scopeId","data-v-2bd0f8ca"]]),Xt=E({name:"MedicationSearch",components:{IonContent:Q,IonPage:fe,IonItem:R,IonLabel:O,IonInput:oe,IonIcon:z,BasicInputField:Ee,IonCard:X},setup(){const t=w(""),o=_e();return{searchText:t,searchTextUpdated:y=>{const C=y.target;t.value=C.value;const a=o.medications.filter(i=>i.name.toLowerCase().includes(t.value.toLowerCase()));o.setFilteredMedications(a)},searchOutline:qe}}});function Yt(t,o,h,y,C,a){const i=r("BasicInputField"),l=r("ion-card");return u(),b("div",null,[s("div",null,[e(l,null,{default:n(()=>[e(i,{placeholder:"Filter medication list by name",icon:t.searchOutline,inputValue:t.searchText,"onUpdate:inputValue":t.searchTextUpdated,minHeight:50},null,8,["icon","inputValue","onUpdate:inputValue"])]),_:1})])])}const Zt=B(Xt,[["render",Yt]]),en=E({name:"medication",components:{IonCard:X,IonCardHeader:Ce,IonButton:ye,IonCardTitle:Fe,IonCardContent:De,IonInput:oe,IonIcon:z,IonCol:le,IonRow:q,IonCheckbox:Ve,PreviousNCDDiagnosis:qt,MedicationSearchInput:Zt},computed:{...j(_e,["medications","filteredMedications"]),...j(be,["otherNCDMedications"]),activeMedications(){return this.useDefaultStores?this.filteredMedications:this.otherNCDMedications}},props:{useDefaultStores:{type:Boolean,default:!0}},setup(t){const o=_e();o.initMedications();const h=Z(()=>o.selectedNCDMedicationList),y=be(),C=Z(()=>y.selectedOtherNCDMedicationList),a=Z(()=>t.useDefaultStores?h.value:C.value),i=w(!1),l=w({});let c=null;const g=()=>{i.value=!1,c&&(clearTimeout(c),c=null)},_=m=>{l.value={...l.value,[m]:!0},i.value=!0,c&&clearTimeout(c),c=window.setTimeout(()=>{i.value=!1,c=null},3e3),window.setTimeout(()=>{const f={...l.value};delete f[m],l.value=f},3e3)},S=m=>/^\d*$/.test(m),$=(m,f,I)=>{let T=I.target.value;const G="".concat(m,"-").concat(f);if(T!==""&&!S(T)){_(G);const L=a.value.find(re=>re.drug_id===m);T=(L==null?void 0:L.dosage[f])||"",setTimeout(()=>{const re=I.target;re&&(re.value=T)},0);return}if(T!==""){const L=parseInt(T);isNaN(L)||L<0?T="0":T=Math.floor(L).toString()}const A=a.value.findIndex(L=>L.drug_id===m);if(A>-1){const L={...a.value[A]};L.dosage={...L.dosage,[f]:T},a.value[A]=L}},p=(m,f)=>{let I=f.target.value;const T="".concat(m,"-duration");if(I!==""&&!S(I)){_(T);const A=a.value.find(L=>L.drug_id===m);I=(A==null?void 0:A.duration)||"",setTimeout(()=>{const L=f.target;L&&(L.value=I)},0);return}if(I!==""){const A=parseInt(I);isNaN(A)||A<1?I="1":I=Math.floor(A).toString()}const G=a.value.findIndex(A=>A.drug_id===m);if(G>-1){const A={...a.value[G]};A.duration=I,a.value[G]=A}},v=m=>a.value.some(f=>f.drug_id===m);return{medkit:Se,sunny:ot,partlySunny:nt,moon:tt,timeOutline:et,alertCircleOutline:Ze,closeCircleOutline:Ye,updateDosage:$,updateDuration:p,getDosage:(m,f)=>{const I=a.value.find(T=>T.drug_id===m);return(I==null?void 0:I.dosage[f])||""},getDuration:m=>{const f=a.value.find(I=>I.drug_id===m);return(f==null?void 0:f.duration)||""},calculateQuantity:m=>{const f=a.value.find(G=>G.drug_id===m);if(!f||!f.dosage||!f.duration)return"";const I=["morning","afternoon","evening"].reduce((G,A)=>{const L=parseInt(f.dosage[A])||0;return G+L},0),T=parseInt(f.duration)||0;return(I*T).toString()},isActive:v,toggleMedication:async m=>{try{if(v(m)){const f=a.value.findIndex(I=>I.drug_id===m);f>-1&&a.value.splice(f,1)}else{const f=await bt(m);t.useDefaultStores==!1?y.setSelectedNCDMedicationList(f):o.setSelectedNCDMedicationList(f)}}catch(f){He("Error toggling medication: "+f)}},cubeOutline:Xe,showErrorMessage:i,errorFields:l,hideErrorMessage:g}}}),tn={key:0},nn={key:0,class:"error-message"},on={class:"table-container"},sn={class:"prescription-table"},an=["onIonChange"],ln=["onClick"],rn={class:"med-kit-font"};function cn(t,o,h,y,C,a){const i=r("PreviousNCDDiagnosis"),l=r("ion-col"),c=r("MedicationSearchInput"),g=r("ion-row"),_=r("ion-icon"),S=r("ion-button"),$=r("ion-checkbox"),p=r("ion-input");return u(),b(V,null,[e(g,null,{default:n(()=>[e(l,{size:"5"},{default:n(()=>[t.useDefaultStores?(u(),J(i,{key:0})):H("",!0)]),_:1}),e(l,null,{default:n(()=>[t.useDefaultStores&&t.medications.length>0?(u(),J(c,{key:0,style:{"margin-top":"0px","font-weight":"600","font-size":"16px"}})):H("",!0)]),_:1})]),_:1}),t.activeMedications.length>0?(u(),b("div",tn,[t.showErrorMessage?(u(),b("div",nn,[e(_,{icon:t.alertCircleOutline,color:"danger"},null,8,["icon"]),o[0]||(o[0]=s("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),e(S,{fill:"clear",size:"small",onClick:t.hideErrorMessage},{default:n(()=>[e(_,{icon:t.closeCircleOutline},null,8,["icon"])]),_:1},8,["onClick"])])):H("",!0),s("div",on,[s("table",sn,[s("thead",null,[s("tr",null,[o[6]||(o[6]=s("th",{class:"checkbox-col"},"Select",-1)),o[7]||(o[7]=s("th",null,"Medication",-1)),s("th",null,[e(_,{icon:t.partlySunny},null,8,["icon"]),o[1]||(o[1]=k(" Morning",-1))]),s("th",null,[e(_,{icon:t.sunny},null,8,["icon"]),o[2]||(o[2]=k(" Noon",-1))]),s("th",null,[e(_,{icon:t.moon},null,8,["icon"]),o[3]||(o[3]=k(" Night",-1))]),s("th",null,[e(_,{icon:t.timeOutline},null,8,["icon"]),o[4]||(o[4]=k(" Duration",-1))]),s("th",null,[e(_,{icon:t.cubeOutline},null,8,["icon"]),o[5]||(o[5]=k(" Quantity",-1))])])]),s("tbody",null,[(u(!0),b(V,null,x(t.activeMedications,v=>(u(),b("tr",{key:v.id,class:W({"active-row":t.isActive(v.drug_id)})},[s("td",{class:"checkbox-col",onIonChange:D=>t.toggleMedication(v.drug_id)},[e($,{checked:t.isActive(v.drug_id),style:{"--size":"26px"}},null,8,["checked"])],40,an),s("td",{style:{cursor:"pointer"},onClick:D=>t.toggleMedication(v.drug_id)},[s("span",rn,F(v.name),1)],8,ln),s("td",null,[e(p,{type:"text",class:W(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(v.drug_id,"-morning")]}]),disabled:!t.isActive(v.drug_id),value:t.getDosage(v.drug_id,"morning"),onIonInput:D=>t.updateDosage(v.drug_id,"morning",D),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),s("td",null,[e(p,{type:"text",class:W(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(v.drug_id,"-afternoon")]}]),disabled:!t.isActive(v.drug_id),value:t.getDosage(v.drug_id,"afternoon"),onIonInput:D=>t.updateDosage(v.drug_id,"afternoon",D),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),s("td",null,[e(p,{type:"text",class:W(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(v.drug_id,"-evening")]}]),disabled:!t.isActive(v.drug_id),value:t.getDosage(v.drug_id,"evening"),onIonInput:D=>t.updateDosage(v.drug_id,"evening",D),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),s("td",null,[e(p,{type:"text",class:W(["dose-input bordered-input med-kit-font",{"error-input":t.errorFields["".concat(v.drug_id,"-duration")]}]),disabled:!t.isActive(v.drug_id),value:t.getDuration(v.drug_id),onIonInput:D=>t.updateDuration(v.drug_id,D),placeholder:"0",inputmode:"numeric"},null,8,["class","disabled","value","onIonInput"])]),s("td",null,[e(p,{type:"text",class:"dose-input bordered-input med-kit-font",readonly:"",value:t.calculateQuantity(v.drug_id),placeholder:"0"},null,8,["value"])])],2))),128))])])])])):H("",!0)],64)}const Je=B(en,[["render",cn],["__scopeId","data-v-eab13dae"]]),dn=E({name:"DrugSelector",components:{IonContent:Q,IonHeader:ae,IonItem:R,IonList:U,IonMenu:Pe,IonTitle:me,IonToolbar:se,IonInput:oe,IonPopover:Ne,VueMultiselect:st,IonLabel:O,IonCol:le,IonRow:q},emits:["drug-selected"],data(){const t=C=>{this.$emit("drug-selected",C)},o=async C=>{const a=ge(),i=C,_=(await Dt.getOfflineOPDDrugs({name:i,page:1,page_size:20})).map(S=>({label:S.name,value:S.name,other:S,...S}));a.setPartialOPDdrugList(_)},h=Z(()=>this.partialOPDdrugList);return{selected_drug:w(null),selectedDrugName:t,FindDrugName:o,OPDDrugList:h}},computed:{...j(ge,["partialOPDdrugList"])}});function un(t,o,h,y,C,a){const i=r("VueMultiselect"),l=r("ion-col"),c=r("ion-row");return u(),b("div",null,[e(c,null,{default:n(()=>[e(l,null,{default:n(()=>[e(i,{modelValue:t.selected_drug,"onUpdate:modelValue":[o[0]||(o[0]=g=>t.selected_drug=g),t.selectedDrugName],multiple:!1,taggable:!1,"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Select medication",placeholder:"Select medication",selectLabel:"",label:"name",searchable:!0,onSearchChange:t.FindDrugName,"track-by":"uuid",options:t.OPDDrugList},null,8,["modelValue","onUpdate:modelValue","onSearchChange","options"])]),_:1})]),_:1})])}const pn=B(dn,[["render",un],["__scopeId","data-v-e33f5b73"]]),_n=E({name:"Home",mixins:[yt],components:{IonContent:Q,IonHeader:ae,IonPage:fe,IonToolbar:se,IonRow:q,IonTitle:me,IonIcon:z,IonFooter:at,OPDMedications:pn,Medication:Je,IonCol:le,IonButton:ye},data(){const t=be(),o=()=>{Oe.dismiss()};return{iconsContent:Y,dismiss:o,addSearchedDrug:C=>{t.addSearchedDrug(C)},medkit:Se,checkmark:Le,onAdd:()=>{Ct(),t.clearOtherNCDMedications(),o()}}},computed:{},$route:{async handler(){},deep:!0},watch:{},async mounted(){},methods:{}}),gn={class:"medication-list"},mn={class:"modal_wrapper"},fn={class:""};function vn(t,o,h,y,C,a){const i=r("ion-icon"),l=r("ion-title"),c=r("ion-header"),g=r("OPDMedications"),_=r("Medication"),S=r("ion-content"),$=r("ion-button"),p=r("ion-col"),v=r("ion-row"),D=r("ion-footer");return u(),b(V,null,[e(c,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[e(l,{class:"modalTitle"},{default:n(()=>[s("div",gn,[e(i,{icon:t.medkit,class:"ion-margin-end"},null,8,["icon"]),o[1]||(o[1]=s("span",null,"Add Other Medication",-1))])]),_:1}),e(i,{onClick:o[0]||(o[0]=M=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),e(S,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:n(()=>[s("div",mn,[s("div",fn,[e(g,{onDrugSelected:t.addSearchedDrug},null,8,["onDrugSelected"]),e(_,{"use-default-stores":!1})])])]),_:1}),e(D,{collapse:"fade",class:"ion-no-border"},{default:n(()=>[e(v,null,{default:n(()=>[e(p,null,{default:n(()=>[e($,{onClick:t.onAdd,color:"primary",style:{float:"right","margin-bottom":"20px","margin-right":"20px"}},{default:n(()=>[e(i,{icon:t.checkmark,slot:"start"},null,8,["icon"]),o[2]||(o[2]=k(" Add ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})],64)}const hn=B(_n,[["render",vn],["__scopeId","data-v-dee50533"]]),bn=E({name:"Home",components:{IonContent:Q,IonHeader:ae,IonPage:fe,IonToolbar:se,Toolbar:St,IonRow:q,IonAccordion:ne,IonAccordionGroup:te,IonItem:R,IonLabel:O,DynamicList:Ot,IonCard:X},data(){const t=w(0),o=w("Show more medications"),h=w(!1),y=w();return{componentKey:t,accordionGroupChange:l=>{const c=l.detail.value;c!==void 0?c=="second"&&(o.value="Show less medications",h.value=!h.value):(o.value="Show more medications",h.value=!h.value)},showMoreMedicationsMsg:o,itemWasExpanded:h,accordionGroupChangeFn1:l=>{},PreviuosSelectedMedicalDrugsList:y,loadPreviousMedications:async()=>{const l=new $e,{previousDrugPrescriptions:c}=await l.getPatientEncounters();y.value=c}}},computed:{...j(K,["patient"]),...j(_e,["selectedNCDMedicationList"])},$route:{async handler(){},deep:!0},watch:{patient:{handler(){this.loadPreviousMedications()},deep:!0},selectedNCDMedicationList:{handler(){this.loadPreviousMedications()},deep:!0}},async mounted(){this.loadPreviousMedications()}}),Dn={style:{}},yn={class:"ion-padding",slot:"content"},Cn={key:0},Sn={class:"previousSecDrgs"},$n={class:"ion-padding",slot:"content"},wn={key:0},Mn={class:"previousSecDrgs"};function In(t,o,h,y,C,a){const i=r("ion-label"),l=r("ion-item"),c=r("dynamic-list"),g=r("ion-accordion"),_=r("ion-accordion-group"),S=r("ion-card");return u(),J(S,null,{default:n(()=>[s("div",Dn,[e(_,{ref:"accordionGroup",class:"previousView",onIonChange:t.accordionGroupChangeFn1},{default:n(()=>[e(g,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(l,{slot:"header",color:"light"},{default:n(()=>[e(i,{class:"previousLabel"},{default:n(()=>[...o[0]||(o[0]=[k("Documented medications timeline",-1)])]),_:1})]),_:1}),s("div",yn,[(u(!0),b(V,null,x(t.PreviuosSelectedMedicalDrugsList,($,p)=>(u(),b("div",{class:"ionLbltp",key:p},[p==0?(u(),b("div",Cn,[s("div",null,[e(i,{class:"previousLabelDate"},{default:n(()=>[k(F($.prescriptionDate),1)]),_:2},1024)]),s("div",Sn,[(u(),J(c,{_selectedMedicalDrugsList:$.previousPrescriptions,show_actions_buttons:!1,key:t.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):H("",!0)]))),128)),e(_,{onIonChange:t.accordionGroupChange},{default:n(()=>[e(g,{value:"second","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(l,{slot:"header",color:"light"},{default:n(()=>[e(i,{class:"",color:"primary"},{default:n(()=>[k(F(t.showMoreMedicationsMsg),1)]),_:1})]),_:1}),s("div",$n,[(u(!0),b(V,null,x(t.PreviuosSelectedMedicalDrugsList,($,p)=>(u(),b("div",{class:"ionLbltp",key:p},[t.itemWasExpanded&&p>0?(u(),b("div",wn,[s("div",null,[e(i,{class:"previousLabelDate"},{default:n(()=>[k(F($.prescriptionDate),1)]),_:2},1024)]),s("div",Mn,[(u(),J(c,{_selectedMedicalDrugsList:$.previousPrescriptions,show_actions_buttons:!1,key:t.componentKey},null,8,["_selectedMedicalDrugsList"]))])])):H("",!0)]))),128))])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})]),_:1},8,["onIonChange"])])]),_:1})}const kn=B(bn,[["render",In],["__scopeId","data-v-1db96250"]]),Nn=E({name:"PrescriptionTable",components:{IonCard:X,IonCardHeader:Ce,IonButton:ye,IonCardTitle:Fe,IonCardContent:De,IonInput:oe,IonIcon:z,IonCol:le,IonRow:q,IonCheckbox:Ve,Medication:Je,MedicationHistory:kn},setup(){return{openAddOtherOPDMedicationModal:async()=>{await Re(hn,{class:"large-modal"},!0,{})},medkit:Se}}});function Pn(t,o,h,y,C,a){const i=r("Medication"),l=r("ion-icon"),c=r("ion-button"),g=r("ion-col"),_=r("ion-row"),S=r("MedicationHistory"),$=r("IonCol"),p=r("ion-card-content"),v=r("ion-card");return u(),J(v,null,{default:n(()=>[e(p,null,{default:n(()=>[e(i),e(_,null,{default:n(()=>[e(g,null,{default:n(()=>[e(c,{onClick:t.openAddOtherOPDMedicationModal,color:"primary",style:{float:"right"}},{default:n(()=>[e(l,{icon:t.medkit,slot:"start"},null,8,["icon"]),o[0]||(o[0]=s("span",{style:{"margin-left":"10px","font-size":"16px","font-weight":"600"}}," ADD Other Medication",-1))]),_:1},8,["onClick"])]),_:1})]),_:1}),e(_,null,{default:n(()=>[e($,null,{default:n(()=>[e(S)]),_:1})]),_:1})]),_:1})]),_:1})}const On=B(Nn,[["render",Pn],["__scopeId","data-v-a4ad7088"]]),Ln={style:{"margin-top":"14px","margin-left":"10px"}},Tn={class:"ion-padding",slot:"content"},An={key:0},Vn={class:"previousSecDrgs"},Fn={class:"ion-padding",slot:"content"},En={class:"previousSecDrgs"},xn=E({watch:{},name:"xxxComponent"}),Bn=E({...xn,setup(t){const o=w(),h=w(),y=w(!1),C=w(!1),a=w("Show more notes");ie(async()=>{const c=new $e,{previousClinicalNotes:g}=await c.getPatientEncounters();o.value=Object.entries(g)[0];const[,..._]=Object.entries(g);h.value=_});function i(c){const g=c.detail.value;g!==void 0?g=="third"&&(a.value="Show less notes",C.value=!y.value):(a.value="Show more notes",C.value=!y.value)}function l(c){return c[1]}return(c,g)=>(u(),J(d(X),null,{default:n(()=>[s("div",Ln,[e(d(te),{ref:"accordionGroup",class:"previousView"},{default:n(()=>[e(d(ne),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(d(R),{slot:"header",color:"light"},{default:n(()=>[e(d(O),{class:"previousLabel"},{default:n(()=>[...g[0]||(g[0]=[k("Previous visits notes",-1)])]),_:1})]),_:1}),s("div",Tn,[(u(!0),b(V,null,x(o.value,(_,S)=>(u(),b("div",{class:"ionLbltp",key:S},[S==1?(u(),b("div",An,[(u(!0),b(V,null,x(_,($,p)=>(u(),b("div",{key:p},[s("div",null,[e(d(O),{class:"previousLabelDate"},{default:n(()=>[k(F($.date),1)]),_:2},1024)]),s("div",Vn,[e(d(U),null,{default:n(()=>[e(d(O),{class:"notes_p"},{default:n(()=>[k(F($.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))])):H("",!0)]))),128)),e(d(te),{onIonChange:i},{default:n(()=>[e(d(ne),{value:"third","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(d(R),{slot:"header",color:"light"},{default:n(()=>[e(d(O),{class:"",color:"primary"},{default:n(()=>[k(F(a.value),1)]),_:1})]),_:1}),s("div",Fn,[(u(!0),b(V,null,x(h.value,(_,S)=>(u(),b("div",{class:"ionLbltp",key:S},[(u(!0),b(V,null,x(l(_),($,p)=>(u(),b("div",{key:p},[s("div",null,[e(d(O),{class:"previousLabelDate"},{default:n(()=>[k(F($.date),1)]),_:2},1024)]),s("div",En,[e(d(U),null,{default:n(()=>[e(d(O),{class:"notes_p"},{default:n(()=>[k(F($.notes),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)])]),_:1}))}}),Hn=B(Bn,[["__scopeId","data-v-994df42d"]]),Rn={style:{"margin-top":"14px","margin-left":"10px"}},Jn=E({watch:{},name:"xxxComponent"}),Gn=E({...Jn,setup(t){const o=ge(),h=Y,y=Z(()=>o.nonPharmalogicalTherapyAndOtherNotes);function C(i){let l=i.target.value;a(l)}function a(i){ge().setNonPharmalogicalTherapyAndOtherNotes(i)}return(i,l)=>(u(),J(d(X),null,{default:n(()=>[e(d(Ce),null,{default:n(()=>[e(d(O),{class:"tpStndCls"},{default:n(()=>[e(d(z),{icon:d(it),class:"header-icon","aria-hidden":"true"},null,8,["icon"]),l[1]||(l[1]=k(" Non-pharmalogical therapy and other notes ",-1))]),_:1})]),_:1}),e(d(De),null,{default:n(()=>[s("div",null,[e(Lt),e(d(R),{class:"input_item",style:{"min-height":"120px","margin-top":"14px"}},{default:n(()=>[e(d(O),null,{default:n(()=>[e(d(z),{slot:"start",icon:d(h).editPen,"aria-hidden":"true"},null,8,["icon"])]),_:1}),e(d(lt),{onIonInput:C,modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=c=>y.value=c),style:{"min-height":"120px"},class:"inputTpln","auto-grow":!0,fill:"outline"},null,8,["modelValue"])]),_:1})]),s("div",Rn,[e(Hn)])]),_:1})]),_:1}))}}),jn=B(Gn,[["__scopeId","data-v-fd19ec21"]]),Un={class:"ion-padding",slot:"content"},zn={key:0},Wn={class:"previousSecDrgs"},Kn={class:"ion-padding",slot:"content"},Qn={class:"previousSecDrgs"},qn=E({watch:{},name:"xxxComponent"}),Xn=E({...qn,setup(t){const o=w(!1),h=w(!1),y=w("Show more allergies"),C=w(),a=w();ie(async()=>{const c=new $e,{previousDrugAllergies:g}=await c.getPatientEncounters();C.value=Object.entries(g)[0];const[,..._]=Object.entries(g);a.value=_});function i(c){const g=c.detail.value;g!==void 0?g=="fith"&&(y.value="Show less allegies",h.value=!o.value):(y.value="Show more allegies",h.value=!o.value)}function l(c){return c[1]}return(c,g)=>{const _=r("ion-card");return u(),J(_,null,{default:n(()=>[e(d(te),{ref:"accordionGroup",class:"previousView"},{default:n(()=>[e(d(ne),{value:"fourth","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(d(R),{slot:"header",color:"light"},{default:n(()=>[e(d(O),{class:"previousLabel"},{default:n(()=>[...g[0]||(g[0]=[k("Documented allergies timeline",-1)])]),_:1})]),_:1}),s("div",Un,[(u(!0),b(V,null,x(C.value,(S,$)=>(u(),b("div",{class:"ionLbltp",key:$},[$==1?(u(),b("div",zn,[s("div",null,[e(d(O),{class:"previousLabelDate"},{default:n(()=>[k(F(S[0].date),1)]),_:2},1024)]),(u(!0),b(V,null,x(S,(p,v)=>(u(),b("div",{key:v},[s("div",Wn,[e(d(U),null,{default:n(()=>[e(d(O),{class:"notes_p"},{default:n(()=>[k(F(p.value),1)]),_:2},1024)]),_:2},1024)])]))),128))])):H("",!0)]))),128)),e(d(te),{onIonChange:i},{default:n(()=>[e(d(ne),{value:"fith","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:n(()=>[e(d(R),{slot:"header",color:"light"},{default:n(()=>[e(d(O),{class:"",color:"primary"},{default:n(()=>[k(F(y.value),1)]),_:1})]),_:1}),s("div",Kn,[(u(!0),b(V,null,x(a.value,(S,$)=>(u(),b("div",{class:"ionLbltp",key:$},[s("div",null,[e(d(O),{class:"previousLabelDate"},{default:n(()=>[k(F(S[0]),1)]),_:2},1024)]),(u(!0),b(V,null,x(l(S),(p,v)=>(u(),b("div",{key:v},[s("div",Qn,[e(d(U),null,{default:n(()=>[e(d(O),{class:"notes_p"},{default:n(()=>[k(F(p.value),1)]),_:2},1024)]),_:2},1024)])]))),128))]))),128))])]),_:1})]),_:1})])]),_:1})]),_:1},512)]),_:1})}}}),Yn=B(Xn,[["__scopeId","data-v-358c5959"]]),Zn={class:"background"},eo={key:0},to={style:{margin:"10px"}},no={key:1},oo={style:{margin:"10px"}},so={key:2},ao={style:{margin:"10px"}},io=E({__name:"TreatmentPlan",setup(t){const o=w(["medications","allergies","other_notes"]),h=w(o.value[0]);ie(()=>{y(o.value[0])});function y(C){h.value=C}return(C,a)=>(u(),b("div",Zn,[e(d(rt),{value:h.value,style:{"margin-top":"5px"}},{default:n(()=>[e(d(ve),{value:"medications",onClick:a[0]||(a[0]=i=>y(o.value[0]))},{default:n(()=>[e(d(O),null,{default:n(()=>[...a[3]||(a[3]=[k("Medications",-1)])]),_:1})]),_:1}),e(d(ve),{value:"allergies",onClick:a[1]||(a[1]=i=>y(o.value[1]))},{default:n(()=>[e(d(O),null,{default:n(()=>[...a[4]||(a[4]=[k("Allergies",-1)])]),_:1})]),_:1}),e(d(ve),{value:"other_notes",onClick:a[2]||(a[2]=i=>y(o.value[2]))},{default:n(()=>[e(d(O),null,{default:n(()=>[...a[5]||(a[5]=[k("Non-pharmalogical therapy and other notes",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),h.value===o.value[0]?(u(),b("div",eo,[s("div",to,[e(On)])])):H("",!0),h.value===o.value[1]?(u(),b("div",no,[s("div",oo,[e(Tt),e(Yn,{style:{"margin-top":"10px"}})])])):H("",!0),h.value===o.value[2]?(u(),b("div",so,[s("div",ao,[e(jn)])])):H("",!0)]))}}),Do=B(io,[["__scopeId","data-v-d844be41"]]);export{bo as C,ho as D,Do as T};
