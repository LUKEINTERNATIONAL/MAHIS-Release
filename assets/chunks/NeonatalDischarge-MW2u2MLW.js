import{d as H,b2 as ge,r as F,c as T,a as Q,e as p,f as r,k as e,p as U,l as $,u as d,c$ as we,L as O,K as D,Q as J,eQ as j,w as x,bs as oe,m as P,O as B,F as E,P as A,fa as se,i as X,bk as _e,b9 as ee,ba as K,J as ne,Z as Se,bu as ye,b8 as ke,aw as le,aP as ce,bb as $e,D as Ce,a4 as Ie,a7 as Ne,ap as Oe,eR as Ve,H as W}from"./vendor-CxrCa3Dl.js";import{u as ie,H as z,cj as Pe,P as Te,_ as L,ag as re,aE as be,T as Me,t as ae,G as Re,s as Ee}from"../index-Bez2ogcw.js";import{N as De}from"./neonatal_service-BVzqfR5W.js";import{D as Ae}from"./DemographicBar-2mVYGPEw.js";import{c as G,e as R,f as qe,N as xe}from"./NeonatalStepper-CvKjMSJG.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-aekSR0UU.js";import"./SaveProgressModal-BSZAlcgf.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const He={class:"profile-card"},Le={class:"profile-content"},Ue={class:"avatar-column"},Be={class:"details-column"},Ge={class:"patient-name"},ze={class:"bio-line"},je={key:0,class:"info-row"},We={class:"value"},Je={class:"info-row"},Ke={class:"value"},Qe={class:"mother-name-section"},Ye=H({__name:"ProfileInformation",setup(g){const C=ie(),{patient:t}=ge(C),a=F(""),u=F(""),b=T(()=>{var o,s;return((s=(o=t.value)==null?void 0:o.personInformation)==null?void 0:s.gender)==="M"?"male-bg":"female-bg"}),l=T(()=>{var s,v;const o=(v=(s=t.value)==null?void 0:s.personInformation)==null?void 0:v.gender;return o==="M"?"Male":o==="F"?"Female":o}),c=T(()=>{var s,v;const o=(v=(s=t.value)==null?void 0:s.personInformation)==null?void 0:v.birthdate;return o?z.calculateDisplayAge(z.toStandardHisFormat(o)):""}),m=T(()=>{var s,v;const o=(v=(s=t.value)==null?void 0:s.personInformation)==null?void 0:v.birthdate;return o?z.toStandardHisDisplayFormat(o):""}),h=T(()=>({header:"Mother's Full Name",value:u.value,disabled:!0,type:"text",placeholder:"Searching..."})),n=async()=>{var s,v;const o=(s=t.value)==null?void 0:s.patientID;if(o)try{const S=await De.checkEnrollment(o);S&&((v=S.enrollment_data)!=null&&v.date_enrolled)&&(a.value=z.toStandardHisDisplayFormat(S.enrollment_data.date_enrolled))}catch(S){console.error("Failed to fetch admission date",S)}},f=async()=>{try{const s=await new Te().getGuardian();if(s&&s.length>0){const v=s.find(S=>{var w;const V=((w=S.type)==null?void 0:w.b_is_to_a)||"";return V==="Mother"||V==="Parent"});if(v&&v.relation&&v.relation.names&&v.relation.names.length>0){const S=v.relation.names[0];u.value=[S.given_name,S.middle_name,S.family_name].filter(Boolean).join(" ")}else u.value="N/A"}else u.value="N/A"}catch(o){console.error("Failed to fetch mother's name",o),u.value="Unknown"}};return Q(()=>{n(),f()}),(o,s)=>{var v,S,V,w,I;return r(),p("div",He,[e("div",Le,[e("div",Ue,[e("div",{class:U(["avatar-box",b.value])},[$(d(O),{icon:d(we),class:"avatar-icon"},null,8,["icon"])],2)]),e("div",Be,[e("div",Ge,[e("div",null,D((S=(v=d(t))==null?void 0:v.personInformation)==null?void 0:S.given_name),1),e("div",null,D((w=(V=d(t))==null?void 0:V.personInformation)==null?void 0:w.family_name),1)]),e("div",ze,[J(D(l.value)+" ",1),s[0]||(s[0]=e("span",{class:"bullet"},"•",-1)),J(" "+D(c.value)+" ",1),s[1]||(s[1]=e("span",{class:"bullet"},"•",-1)),J(" "+D(m.value),1)]),(r(),p("div",je,[s[2]||(s[2]=e("span",{class:"label"},"Admission Date:",-1)),e("span",We,D(a.value),1)])),e("div",Je,[s[3]||(s[3]=e("span",{class:"label"},"MRN:",-1)),e("span",Ke,D((I=d(t))==null?void 0:I.ID),1)])])]),s[4]||(s[4]=e("div",{class:"form-title"},"DISCHARGE FORM",-1)),e("div",Qe,[$(Pe,{config:h.value,allFormValues:{}},null,8,["config"])])])}}}),Ze=L(Ye,[["__scopeId","data-v-de193189"]]),Xe={class:"discharge-vitals-wrapper"},et={class:"vitals-header"},tt={class:"detail-row"},at={class:"detail-value status-value"},st={class:"detail-row"},nt={class:"weight-box"},ot={class:"weight-value"},it={class:"weight-date"},lt={class:"section-subtitle"},ct=0,rt=H({__name:"DischargeVitals",setup(g,{expose:C}){const t=R[ct],a=F(null),u=j(G),b=ie(),l=F(""),c=F(""),m=F("");Q(async()=>{var f,o;const n=(f=b.patient)==null?void 0:f.patientID;if(n)try{const s=await re.getFirstObs(n,"Mother HIV status");if(s){let S=s.value_text;!S&&s.value_coded&&(S=String(s.value_coded)),l.value=S||"Unknown"}else l.value="Unknown";const v=await re.getFirstObs(n,"Birth weight");v&&(c.value=((o=v.value_numeric)==null?void 0:o.toString())||"",v.obs_datetime&&(m.value=z.toStandardHisDisplayFormat(v.obs_datetime)))}catch(s){console.error("Error fetching vitals details",s)}});const h=n=>{u&&(u.weight=n.weight,u.heartRate=n.heartRate,u.respiratoryRate=n.respiratoryRate,u.oxygenSaturation=n.oxygenSaturation,u.temperature=n.temperature)};return x(()=>{var n;return(n=a.value)==null?void 0:n.formValues},n=>{n&&h(n)},{deep:!0}),x(()=>a.value,n=>{n!=null&&n.getFormValues&&h(n.getFormValues())},{immediate:!0}),C({getFormValues:()=>{var n,f;return((f=(n=a.value)==null?void 0:n.getFormValues)==null?void 0:f.call(n))||{}},validateForm:()=>{var n,f;return((f=(n=a.value)==null?void 0:n.validateForm)==null?void 0:f.call(n))||null}}),(n,f)=>(r(),p("div",Xe,[e("div",et,[e("div",tt,[f[0]||(f[0]=e("span",{class:"detail-label"},"HIV status",-1)),e("span",at,D(l.value||"Loading..."),1)]),e("div",st,[f[2]||(f[2]=e("span",{class:"detail-label"},"Birth Weight",-1)),e("div",nt,[e("span",ot,D(c.value?c.value+" kg":"..."),1),f[1]||(f[1]=e("span",{class:"weight-separator"},"|",-1)),e("span",it,"Date: "+D(m.value||"..."),1)])]),e("div",lt,D(d(t).subtitle),1)]),$(be,{formData:d(t).formData,ref_key:"formRef",ref:a},null,8,["formData"])]))}}),ue=L(rt,[["__scopeId","data-v-23fe5c08"]]),ut={class:"searchable-dropdown-wrapper"},dt={key:0,class:"required"},pt={key:1,class:"selected-items-container"},vt={class:"item-label"},mt=["onClick"],ht={key:2,class:"selected-item single-chip"},ft={class:"item-label"},gt=["placeholder","disabled"],_t={key:3,class:"dropdown-container"},yt={class:"dropdown-header"},bt={class:"dropdown-list"},Dt=["onClick"],Ft=H({__name:"SearchableDropdown",props:{config:{},allFormValues:{}},emits:["update:value","field-changed"],setup(g,{expose:C,emit:t}){const a=g,u=t,b=F(""),l=F(!1),c=F(!1),m=F(null),h=F(a.config.initialValue||a.config.value||null),n=F(a.config.initialValue||a.config.value||[]),f=F([...a.config.options||[]]),o=T(()=>{if(typeof a.config.disabled=="boolean")return a.config.disabled;if(typeof a.config.disabled=="function")try{return a.config.disabled(a.allFormValues)}catch(i){return console.warn("Disabled function error:",i),!1}return!1}),s=T(()=>{if(a.config.condition&&typeof a.config.condition=="function")try{return a.config.condition(a.allFormValues)}catch(i){return console.warn("Condition function error:",i),!1}return!0}),v=T(()=>{var y,N;if(!s.value||o.value)return null;const i=a.config.multiple?n.value:h.value;return((N=(y=a.config).validation)==null?void 0:N.call(y,i))||null}),S=i=>{var y;return a.config.multiple?n.value.some(N=>N.value===i.value):((y=h.value)==null?void 0:y.value)===i.value},V=()=>{l.value=!0,c.value=!0},w=i=>{i.stopPropagation(),l.value=!0},I=()=>{const i=b.value.toLowerCase();i?f.value=(a.config.options||[]).filter(y=>y.label.toLowerCase().includes(i)):f.value=[...a.config.options||[]],l.value=!0},q=i=>{if(a.config.multiple){const y=n.value.findIndex(N=>N.value===i.value);y>-1?n.value.splice(y,1):n.value.push(i)}else h.value=i,l.value=!1,b.value="",f.value=[...a.config.options||[]]},Y=i=>{a.config.multiple&&(n.value=n.value.filter(y=>y.value!==i.value))},k=()=>{h.value=null},_=i=>{const y=i.target;m.value&&!m.value.contains(y)&&!y.closest(".dropdown-container")&&(l.value=!1)};return Q(()=>{document.addEventListener("click",_)}),oe(()=>{document.removeEventListener("click",_)}),x(h,i=>{a.config.multiple||(u("update:value",i),u("field-changed",{fieldName:a.config.name||a.config.header,value:i,config:a.config,newValue:i}))}),x(n,i=>{a.config.multiple&&(u("update:value",i),u("field-changed",{fieldName:a.config.name||a.config.header,value:i,config:a.config}))},{deep:!0}),C({getValue:()=>a.config.multiple?n.value:h.value,setValue:i=>{a.config.multiple?n.value=i||[]:h.value=i},isValid:T(()=>o.value||v.value===null),validate:()=>o.value?null:(c.value=!0,v.value),shouldShow:s,markAsTouched:()=>{c.value=!0},resetTouched:()=>{c.value=!1}}),(i,y)=>{var N,te;return r(),p("div",ut,[g.config.header?(r(),p("h6",{key:0,class:U({"is-bold":g.config.bold})},[J(D(g.config.header)+" ",1),((te=(N=g.config).validation)==null?void 0:te.call(N,""))!=null?(r(),p("span",dt,"*")):P("",!0)],2)):P("",!0),g.config.multiple&&n.value.length>0?(r(),p("div",pt,[(r(!0),p(E,null,A(n.value,M=>(r(),p("div",{key:M.value,class:"selected-item chip"},[e("span",vt,D(M.label),1),e("button",{onClick:Fe=>Y(M),class:"delete-btn",type:"button","aria-label":"Remove item"},[$(d(O),{icon:d(se),class:"remove-icon"},null,8,["icon"])],8,mt)]))),128))])):P("",!0),!g.config.multiple&&h.value?(r(),p("div",ht,[e("span",ft,D(h.value.label),1),e("button",{onClick:k,class:"delete-btn",type:"button","aria-label":"Remove item"},[$(d(O),{icon:d(se),class:"remove-icon"},null,8,["icon"])])])):P("",!0),e("div",{class:"search-wrapper",ref_key:"searchWrapperRef",ref:m},[$(d(O),{icon:d(_e),class:"search-icon"},null,8,["icon"]),X(e("input",{type:"text","onUpdate:modelValue":y[0]||(y[0]=M=>b.value=M),placeholder:g.config.placeholder||"Search",class:"search-input",onInput:I,onFocus:V,onClick:w,disabled:o.value},null,40,gt),[[ee,b.value]])],512),l.value&&f.value.length>0?(r(),p("div",_t,[e("div",yt,D(g.config.dropdownHeader||"Select ONE"),1),e("div",bt,[(r(!0),p(E,null,A(f.value,M=>(r(),p("div",{key:M.value,class:U(["dropdown-item",{selected:S(M)}]),onClick:Fe=>q(M)},[e("span",null,D(M.label),1),S(M)?(r(),B(d(O),{key:0,icon:d(K),class:"check-icon"},null,8,["icon"])):P("",!0)],10,Dt))),128))])])):P("",!0),v.value&&c.value?(r(),B(d(Se),{key:4,class:"error-note"},{default:ne(()=>[J(D(v.value),1)]),_:1})):P("",!0)])}}}),de=L(Ft,[["__scopeId","data-v-39221bca"]]),wt={class:"discharge-diagnosis-wrapper"},St={class:"diagnosis-section"},kt={class:"diagnosis-section"},$t={key:0,class:"validation-error"},Ct=H({__name:"DischargeDiagnosis",setup(g,{expose:C}){const t=j(G),a=F(null),u=F(null),b=F(null),l=[{label:"Hypoglycaemia (symptomatic)",value:"Hypoglycaemia1"},{label:"Abscess",value:"Abscess"},{label:"Fever",value:"Fever"},{label:"Birth Asphyxia",value:"Asphyxia"},{label:"Neonatal Sepsis (Early onset - Symptomatic)",value:"Neonatal Sepsis - Early Onset"},{label:"Prematurity with Respiratory Distress",value:"Prematurity with RDS"},{label:"Suspected Neonatal Sepsis",value:"Sepsis_Sus"},{label:"Possible Meconium Aspiration",value:"Meconium Aspiration"}],c=T(()=>({componentType:"searchableDropdown",header:"Select the Discharge Diagnosis",name:"mainDiagnosis",placeholder:"Search",dropdownHeader:"Select ONE",options:l,multiple:!1,bold:!0,initialValue:(t==null?void 0:t.mainDiagnosis)||null,validation:o=>o?null:"A main Discharge Diagnosis is required."})),m=T(()=>({componentType:"searchableDropdown",header:"Other problems (If any)",name:"otherProblems",placeholder:"Search",dropdownHeader:"Select problems",options:l,multiple:!0,bold:!0,initialValue:(t==null?void 0:t.otherProblems)||[]})),h=o=>{t&&(t.mainDiagnosis=o.value,a.value=null)},n=o=>{t&&(t.otherProblems=o.value)};return C({validateForm:()=>t!=null&&t.mainDiagnosis?(a.value=null,null):(a.value="A main Discharge Diagnosis is required.",{mainDiagnosis:"Required"}),getFormValues:()=>({})}),(o,s)=>(r(),p("div",wt,[e("div",St,[$(de,{config:c.value,allFormValues:{},onFieldChanged:h,ref_key:"mainDiagnosisRef",ref:u},null,8,["config"])]),e("div",kt,[$(de,{config:m.value,allFormValues:{},onFieldChanged:n,ref_key:"otherProblemsRef",ref:b},null,8,["config"])]),a.value?(r(),p("div",$t,D(a.value),1)):P("",!0)]))}}),pe=L(Ct,[["__scopeId","data-v-fe875052"]]),It={class:"discharge-medications-wrapper"},Nt={class:"section"},Ot={key:0,class:"past-history-list"},Vt={key:1,class:"empty-message"},Pt={class:"section"},Tt={key:0,class:"final-medications-list"},Mt={class:"med-name"},Rt=["onClick"],Et={key:1,class:"empty-message"},At={key:0,class:"section"},qt={class:"prescription-table"},xt={class:"med-name-cell"},Ht={class:"frequency-cell"},Lt=["onClick"],Ut=["value"],Bt={key:0,class:"frequency-dropdown-container"},Gt=["onClick"],zt={class:"dosage-cell"},jt=["onUpdate:modelValue"],Wt=["onClick"],Jt={class:"section"},Kt={class:"search-wrapper"},Qt={key:0,class:"dropdown-container"},Yt=["onClick"],Zt=H({__name:"DischargeMedications",setup(g,{expose:C}){const t=j(G),a=["Paracetamol","Gentamicin","Wrapped","KMC","Resuscitaire","BVM Ventilation","Nasal Cannulae Oxygen","Amoxicillin","Ampicillin","Penicillin","Ceftriaxone","Nevirapine","Zidovudine","Multivitamin"],u=F(["Gentamicin"]),b=F([]),l=["once a day","twice a day","3 times a day","4 times a day"],c=F(null),m=T(()=>!t||!t.medications?[]:t.medications),h=F(""),n=F(!1),f=F([...a]),o=()=>{const k=h.value.toLowerCase();k?f.value=a.filter(_=>_.toLowerCase().includes(k)):f.value=[...a]},s=k=>b.value.some(_=>_.name===k),v=k=>{s(k)||(b.value.push({name:k,frequency:"once a day",dosage:""}),n.value=!1,h.value="",f.value=[...a])},S=k=>{c.value===k?c.value=null:c.value=k},V=(k,_)=>{b.value[k].frequency=_,c.value=null},w=k=>{const _=b.value[k];if(!_.dosage||_.dosage.trim()===""){alert("Please enter dosage before adding");return}if(!t){console.error("Discharge form not found");return}t.medications||(t.medications=[]),t.medications.push({name:_.name,frequency:_.frequency,dosage:_.dosage}),console.log("Added medication:",_.name),console.log("Total medications:",t.medications.length),console.log("Medications array:",t.medications),b.value.splice(k,1)},I=k=>{t&&t.medications&&t.medications.splice(k,1)},q=k=>{const _=k.target;!_.closest(".search-wrapper")&&!_.closest(".dropdown-container")&&(n.value=!1),!_.closest(".custom-frequency-wrapper")&&!_.closest(".frequency-dropdown-container")&&(c.value=null)};return Q(()=>{document.addEventListener("click",q)}),oe(()=>{document.removeEventListener("click",q)}),C({validateForm:()=>null,getFormValues:()=>({})}),(k,_)=>(r(),p("div",It,[e("div",Nt,[_[2]||(_[2]=e("h3",{class:"section-title"},"Past Medical History",-1)),u.value.length>0?(r(),p("div",Ot,[(r(!0),p(E,null,A(u.value,(i,y)=>(r(),p("div",{key:y,class:"history-item"},D(i),1))),128))])):(r(),p("div",Vt,"No past medical history"))]),e("div",Pt,[_[3]||(_[3]=e("h3",{class:"section-title"},"Medications given on discharge",-1)),m.value.length>0?(r(),p("div",Tt,[(r(!0),p(E,null,A(m.value,(i,y)=>(r(),p("div",{key:y,class:"final-med-item"},[e("span",Mt,D(i.name),1),e("button",{onClick:N=>I(y),class:"delete-btn",type:"button"},[$(d(O),{icon:d(se),class:"trash-icon"},null,8,["icon"])],8,Rt)]))),128))])):(r(),p("div",Et,"No medications added yet"))]),b.value.length>0?(r(),p("div",At,[_[5]||(_[5]=e("h3",{class:"section-title"},"Prescription Details",-1)),e("div",qt,[_[4]||(_[4]=e("div",{class:"table-header"},[e("span",null,"Name"),e("span",null,"Frequency"),e("span",null,"Dosage")],-1)),(r(!0),p(E,null,A(b.value,(i,y)=>(r(),p("div",{key:y,class:"table-row"},[e("span",xt,D(i.name),1),e("div",Ht,[e("div",{class:"custom-frequency-wrapper",onClick:N=>S(y)},[e("input",{type:"text",value:i.frequency,readonly:"",class:"frequency-select"},null,8,Ut),$(d(O),{icon:d(ye),class:"dropdown-icon"},null,8,["icon"])],8,Lt),c.value===y?(r(),p("div",Bt,[(r(),p(E,null,A(l,N=>e("div",{key:N,class:U(["frequency-dropdown-item",{selected:i.frequency===N}]),onClick:te=>V(y,N)},[e("span",null,D(N),1),i.frequency===N?(r(),B(d(O),{key:0,icon:d(K),class:"check-icon"},null,8,["icon"])):P("",!0)],10,Gt)),64))])):P("",!0)]),e("div",zt,[X(e("input",{type:"text","onUpdate:modelValue":N=>i.dosage=N,placeholder:"Enter dosage",class:"dosage-input"},null,8,jt),[[ee,i.dosage]]),e("button",{onClick:N=>w(y),class:"add-btn",type:"button"},[$(d(O),{icon:d(ke),class:"add-icon"},null,8,["icon"])],8,Wt)])]))),128))])])):P("",!0),e("div",Jt,[e("div",Kt,[$(d(O),{icon:d(_e),class:"search-icon"},null,8,["icon"]),X(e("input",{type:"text","onUpdate:modelValue":_[0]||(_[0]=i=>h.value=i),placeholder:"Search",class:"search-input",onInput:o,onFocus:_[1]||(_[1]=i=>n.value=!0)},null,544),[[ee,h.value]])]),n.value&&f.value.length>0?(r(),p("div",Qt,[(r(!0),p(E,null,A(f.value,i=>(r(),p("div",{key:i,class:U(["dropdown-item",{selected:s(i)}]),onClick:y=>v(i)},[e("span",null,D(i),1),s(i)?(r(),B(d(O),{key:0,icon:d(K),class:"check-icon"},null,8,["icon"])):P("",!0)],10,Yt))),128))])):P("",!0)])]))}}),ve=L(Zt,[["__scopeId","data-v-5243432a"]]),Xt={class:"clinic-follow-up-wrapper"},ea={key:0,class:"saved-appointments"},ta={class:"appointment-header"},aa={class:"clinic-info"},sa={class:"clinic-name"},na={class:"appointment-date"},oa={class:"clinic-type"},ia={class:"add-clinic-section"},la={class:"form-container"},ca={class:"clinic-label"},ra={class:"form-field"},ua=["value"],da={key:0,class:"dropdown-container"},pa=["onClick"],va={class:"form-field date-field"},ma=["disabled"],ha=H({__name:"ClinicFollowUp",setup(g,{expose:C}){const t=j(G),a=T(()=>!t||!t.appointments?[]:t.appointments),u=T(()=>a.value.length+1),b=T(()=>"Clinic ".concat(u.value)),l=["Health Center follow up","Specialist Clinic","General Outpatient","Immunization"],c=F(!1),m=F({clinicName:"",clinicType:"",date:""}),h=()=>{c.value=!c.value},n=V=>{m.value.clinicType=V,c.value=!1},f=T(()=>m.value.clinicType!==""&&m.value.date!==""),o=V=>{if(!V)return"";const w=new Date(V),I=w.getDate(),q=w.toLocaleString("en-US",{month:"short"}),Y=w.getFullYear();return"".concat(I," ").concat(q," ").concat(Y)},s=()=>{!f.value||!t||(t.appointments||(t.appointments=[]),t.appointments.push({clinicName:b.value,clinicType:m.value.clinicType,date:m.value.date}),m.value={clinicName:"",clinicType:"",date:""})},v=V=>{const w=V.target;!w.closest(".custom-select-wrapper")&&!w.closest(".dropdown-container")&&(c.value=!1)};return Q(()=>{document.addEventListener("click",v)}),oe(()=>{document.removeEventListener("click",v)}),C({validateForm:()=>null,getFormValues:()=>({})}),(V,w)=>(r(),p("div",Xt,[w[3]||(w[3]=e("div",{class:"info-banner"},"You can assign clinic days for the baby.",-1)),a.value.length>0?(r(),p("div",ea,[w[1]||(w[1]=e("h3",{class:"section-title"},"Saved Appointments",-1)),(r(!0),p(E,null,A(a.value,(I,q)=>(r(),p("div",{key:q,class:"appointment-item"},[e("div",ta,[e("div",aa,[$(d(O),{icon:d(le),class:"clinic-icon"},null,8,["icon"]),e("span",sa,D(I.clinicName),1)]),e("div",na,[e("span",null,D(o(I.date)),1),$(d(O),{icon:d(ce),class:"calendar-icon"},null,8,["icon"])])]),e("div",oa,D(I.clinicType),1)]))),128))])):P("",!0),e("div",ia,[w[2]||(w[2]=e("h3",{class:"section-title"},"Add a clinic day",-1)),e("div",la,[e("div",ca,[$(d(O),{icon:d(le),class:"label-icon"},null,8,["icon"]),e("span",null,D(b.value),1)]),e("div",ra,[e("div",{class:"custom-select-wrapper",onClick:h},[e("input",{type:"text",value:m.value.clinicType||"Select clinic type",readonly:"",class:U(["clinic-select",{placeholder:!m.value.clinicType}])},null,10,ua),$(d(O),{icon:d(ye),class:"dropdown-icon"},null,8,["icon"])]),c.value?(r(),p("div",da,[(r(),p(E,null,A(l,I=>e("div",{key:I,class:U(["dropdown-item",{selected:m.value.clinicType===I}]),onClick:q=>n(I)},[e("span",null,D(I),1),m.value.clinicType===I?(r(),B(d(O),{key:0,icon:d(K),class:"check-icon"},null,8,["icon"])):P("",!0)],10,pa)),64))])):P("",!0)]),e("div",va,[X(e("input",{type:"date","onUpdate:modelValue":w[0]||(w[0]=I=>m.value.date=I),placeholder:"Clinic date",class:"date-input"},null,512),[[ee,m.value.date]]),$(d(O),{icon:d(ce),class:"date-icon"},null,8,["icon"])]),e("button",{onClick:s,disabled:!f.value,class:"save-button",type:"button"},"save appointment",8,ma)])])]))}}),me=L(ha,[["__scopeId","data-v-ed7c5ffd"]]),fa={class:"health-education-content"},ga=H({__name:"HealthEducation",setup(g,{expose:C}){const t=F(null),a=R[4].formData,u=j(G),b=l=>{u&&(u.healthEducationGiven=l.healthEducationGiven||"",u.insecticideTreatedNetGiven=l.insecticideTreatedNetGiven||"")};return x(()=>{var l;return(l=t.value)==null?void 0:l.formValues},l=>{l&&b(l)},{deep:!0}),x(()=>t.value,l=>{l!=null&&l.getFormValues&&b(l.getFormValues())},{immediate:!0}),C({getFormRef:()=>t.value,validateForm:()=>{var l,c;return((c=(l=t.value)==null?void 0:l.validateForm)==null?void 0:c.call(l))||null},getFormValues:()=>{var l,c;return((c=(l=t.value)==null?void 0:l.getFormValues)==null?void 0:c.call(l))||{}}}),(l,c)=>(r(),p("div",fa,[c[0]||(c[0]=$e('<div class="info-banner" data-v-a276f232>Please educate the mother on the following:</div><div class="education-section" data-v-a276f232><h3 class="section-title" data-v-a276f232>1. Danger Signs</h3><ul class="education-list" data-v-a276f232><li data-v-a276f232>Jaundice</li><li data-v-a276f232>Convulsions</li><li data-v-a276f232>Not able to breast feed</li><li data-v-a276f232>Difficulties in breathing</li><li data-v-a276f232>Lethargic</li><li data-v-a276f232>Fever</li><li data-v-a276f232>Hypothermia</li><li data-v-a276f232>Abdominal distention</li><li data-v-a276f232>Bleeding from the cord and what to do if any</li></ul></div><div class="education-section" data-v-a276f232><h3 class="section-title" data-v-a276f232>1. GENERAL EDUCATION</h3><ul class="education-list" data-v-a276f232><li data-v-a276f232>Immunization</li><li data-v-a276f232>Family planning</li><li data-v-a276f232>Hygiene</li><li data-v-a276f232>Keeping baby warm</li><li data-v-a276f232>Malaria Prevention</li></ul></div>',3)),$(be,{class:"padding",formData:d(a),ref_key:"formRef",ref:t},null,8,["formData"])]))}}),he=L(ga,[["__scopeId","data-v-a276f232"]]),_a={class:"discharge-outcome-wrapper"},ya={class:"outcome-list padding"},ba=["onClick"],Da={class:"option-text"},Fa=H({__name:"DischargeOutcome",setup(g,{expose:C}){const t=j(G),a=["Discharged","Death (at LESS than 24 hours of age)","Death (at MORE than 24 hours of age)","Died during Admission","Absconded","Transferred to another ward","Transferred to another hospital","Discharged on request","Discharged on palliative care","Brought in dead - BID","Stillbirth"],u=F("");t&&(u.value=t.outcome||"");const b=c=>{u.value=c};return x(u,c=>{t&&(t.outcome=c)}),C({validateForm:()=>u.value?null:{outcome:"Please select an outcome"},getFormValues:()=>({outcome:u.value})}),(c,m)=>(r(),p("div",_a,[m[0]||(m[0]=e("div",{class:"question-banner"},"What happened to the baby?",-1)),m[1]||(m[1]=e("div",{class:"select-label padding"},"Select one",-1)),e("div",ya,[(r(),p(E,null,A(a,h=>e("div",{key:h,class:U(["outcome-option",{selected:u.value===h}]),onClick:n=>b(h)},[e("span",Da,D(h),1),u.value===h?(r(),B(d(O),{key:0,icon:d(K),class:"check-icon"},null,8,["icon"])):P("",!0)],10,ba)),64))])]))}}),fe=L(Fa,[["__scopeId","data-v-da5e6123"]]),Z=()=>JSON.parse(JSON.stringify(qe)),wa=Ce("neonatalDischargeStore",{state:()=>({activePatientId:null,dischargeForm:Z(),dischargeFormCache:{}}),actions:{initializeDischargeForm(g){if(g==null){this.activePatientId=null,Object.assign(this.dischargeForm,Z());return}this.activePatientId=g;const C=this.dischargeFormCache[String(g)];C?Object.assign(this.dischargeForm,C):Object.assign(this.dischargeForm,Z()),this.saveDischargeSnapshot()},saveDischargeSnapshot(){this.activePatientId!=null&&(this.dischargeFormCache[String(this.activePatientId)]=JSON.parse(JSON.stringify(this.dischargeForm)))},resetDischargeForm(){Object.assign(this.dischargeForm,Z()),this.saveDischargeSnapshot()},clearDischargeForm(g){delete this.dischargeFormCache[String(g)],this.activePatientId===g&&this.resetDischargeForm()}},persist:{paths:["activePatientId","dischargeForm","dischargeFormCache"]}}),Sa=H({name:"NeonatalDischarge",components:{IonPage:Ne,IonContent:Ie,Toolbar:Me,DemographicBar:Ae,ProfileInformation:Ze,NeonatalStepper:xe,DischargeVitals:ue,DischargeDiagnosis:pe,DischargeMedications:ve,ClinicFollowUp:me,HealthEducation:he,DischargeOutcome:fe},setup(){const g=Oe(),C=ie(),{patient:t}=ge(C),a=F(!1),u=wa(),b=o=>{const s=Number(o);return Number.isFinite(s)?s:null},l=()=>{var s;const o=b((s=t.value)==null?void 0:s.patientID);u.initializeDischargeForm(o)};l(),x(()=>{var o;return(o=t.value)==null?void 0:o.patientID},()=>l());const c=u.dischargeForm;Ve(G,c),x(()=>u.dischargeForm,()=>u.saveDischargeSnapshot(),{deep:!0});const m=F(R.map((o,s)=>({title:o.title,number:s+1,checked:!1,class:s===0?"open_step common_step":"common_step",last_step:s===R.length-1?"last_step":""}))),h=[{title:R[0].title,value:"1",component:ue},{title:R[1].title,value:"2",component:pe},{title:R[2].title,value:"3",component:ve},{title:R[3].title,value:"4",component:me},{title:R[4].title,value:"5",component:he},{title:R[5].title,value:"6",component:fe}];return{router:g,patient:t,dischargeFormData:c,stepperTitle:"Neonatal Discharge",currentOpenStepper:"1",wizardData:m,stepperData:h,updateStatus:o=>{o&&o.value&&m.value.forEach((s,v)=>{o.value===(v+1).toString()?(s.class="open_step common_step",s.checked=!1):v<parseInt(o.value)-1?(s.class="common_step color_white",s.checked=!0):(s.class="common_step",s.checked=!1)})},getSaveFunction:o=>o===h.length-1?async()=>{var s;if(!((s=t.value)!=null&&s.patientID)){ae("No patient selected");return}if(!a.value)try{if(a.value=!0,!c.mainDiagnosis){ae("Please select a discharge diagnosis"),a.value=!1;return}if(!c.outcome){ae("Please select a discharge outcome"),a.value=!1;return}await De.dischargeNeonate(t.value.patientID,c,z.sessionDate()),Re("Neonate discharged successfully"),u.clearDischargeForm(t.value.patientID),g.push("/patientProfile")}catch(v){console.error("Neonatal discharge failed",v),Ee("Failed to discharge neonate. Please try again."),a.value=!1}}:null,isDischarging:a}}});function ka(g,C,t,a,u,b){const l=W("Toolbar"),c=W("ProfileInformation"),m=W("NeonatalStepper"),h=W("ion-content"),n=W("ion-page");return r(),B(n,{class:"neonatal-discharge-page"},{default:ne(()=>[$(l),$(h,{fullscreen:!0},{default:ne(()=>[$(c),$(m,{wizardData:g.wizardData,StepperData:g.stepperData,stepperTitle:g.stepperTitle,openStepper:g.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:g.getSaveFunction,flowType:"discharge",headerStyle:"discharge-header",onUpdateStatus:g.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const Ea=L(Sa,[["render",ka],["__scopeId","data-v-2edcd2ef"]]);export{Ea as default};
