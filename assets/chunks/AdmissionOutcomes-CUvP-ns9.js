import{d as F,r as p,bH as P,w as v,e as T,f as O,l as d,u as g,ab as $,ae as H,am as x,b2 as B,eV as E,H as S,O as U,J as A}from"./vendor-Do41i3tR.js";import{z as C,_ as D,T as j,u as J,t as I,H as K,F as L,w as W}from"../index-MoYXGJcQ.js";import{j as V,v as f,N as q,k as w,w as G}from"./NeonatalStepper-BDRiTpdt.js";import{P as N,u as M}from"./useNeonatalAdmissionOutcomesStore-BjsoLIcD.js";import{N as Q}from"./neonatal_service-B5FsMhZx.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DB4uOJSt.js";import"./SaveProgressModal-B4rI0h6q.js";import"./enrollment-DU-PLRUa.js";import"./images-142qstiX.js";import"./useNeonatalEnrollmentStore-BNxshxEW.js";import"./useSignsSymptomsStore-e3a7OXSt.js";import"./useNeonatalVitalsStore-CZQVGYVd.js";const X={class:"admission-outcome-wrapper"},Y=F({__name:"AdmissionOutcomeSection",setup(a,{expose:u}){const o=p(null),n=f[0],r=n.formData,l=n.subtitle,m=P(V),c=e=>{m&&(m.admissionOutcome=e.admissionOutcome||"")};return v(()=>{var e;return(e=o.value)==null?void 0:e.formValues},e=>{e&&c(e)},{deep:!0}),v(()=>o.value,e=>{e!=null&&e.getFormValues&&c(e.getFormValues())},{immediate:!0}),u({getFormRef:()=>o.value,validateForm:()=>{var e,i;return((i=(e=o.value)==null?void 0:e.validateForm)==null?void 0:i.call(e))||null},getFormValues:()=>{var e,i;return((i=(e=o.value)==null?void 0:e.getFormValues)==null?void 0:i.call(e))||{}}}),(e,i)=>(O(),T("div",X,[d(C,{formData:g(r),subtitle:g(l),ref_key:"formRef",ref:o,class:"main-form"},null,8,["formData","subtitle"])]))}}),k=D(Y,[["__scopeId","data-v-e078a6a9"]]),Z={class:"safeguard-concerns-wrapper"},ee=F({__name:"SafeguardConcernsSection",setup(a,{expose:u}){const o=p(null),n=f[1],r=n.formData,l=n.subtitle;return u({getFormRef:()=>o.value,validateForm:()=>null,getFormValues:()=>({})}),(m,c)=>(O(),T("div",Z,[d(C,{formData:g(r),subtitle:g(l),ref_key:"formRef",ref:o,class:"main-form"},null,8,["formData","subtitle"])]))}}),y=D(ee,[["__scopeId","data-v-d06dc727"]]),te=F({name:"NeonatalAdmissionOutcomes",components:{IonPage:H,IonContent:$,Toolbar:j,NeonatalStepper:q,AdmissionOutcomeSection:k,SafeguardConcernsSection:y,PrintSummarySection:N},setup(){const a=x(),u=J(),{patient:o}=B(u),n=p(!1),r=M(),l=s=>{const t=Number(s);return Number.isFinite(t)?t:null},m=()=>{var t;const s=l((t=o.value)==null?void 0:t.patientID);r.initializeAdmissionOutcomesForm(s)};m(),v(()=>{var s;return(s=o.value)==null?void 0:s.patientID},()=>m());const c=r.admissionOutcomesForm;E(V,c),v(()=>r.admissionOutcomesForm,()=>r.saveAdmissionOutcomesSnapshot(),{deep:!0});const e=p("1"),i=[...f,w[1]],h=p(i.map((s,t)=>({title:s.title,number:t+1,checked:!1,class:t===0?"open_step common_step":"common_step",last_step:t===i.length-1?"last_step":""}))),b=[{title:f[0].title,value:"1",component:k,configIndex:0},{title:f[1].title,value:"2",component:y,configIndex:1},{title:w[1].title,value:"3",component:N,configIndex:3,buttonText:"SAVE & PRINT"}],R=s=>{s&&s.value&&h.value.forEach((t,_)=>{s.value===(_+1).toString()?(t.class="open_step common_step",t.checked=!1):_<parseInt(s.value)-1?(t.class="common_step color_white",t.checked=!0):(t.class="common_step",t.checked=!1)})},z=b.length-1;return{router:a,patient:o,admissionOutcomesFormData:c,stepperTitle:"Admission Outcomes",currentOpenStepper:e,wizardData:h,stepperData:b,updateStatus:R,getSaveFunction:s=>s===z?async()=>{var t;if(!((t=o.value)!=null&&t.patientID)){I("No patient selected");return}if(!n.value)try{if(n.value=!0,!c.admissionOutcome){I("Please select an admission outcome"),n.value=!1;return}await Q.saveAdmissionOutcomes(o.value.patientID,c,K.sessionDate()),L("Admission outcomes saved successfully"),r.clearAdmissionOutcomesForm(o.value.patientID),a.push({name:"neonatalAdmissionSignOff"})}catch(_){console.error("Failed to save admission outcomes",_),W("Failed to save admission outcomes. Please try again.")}finally{n.value=!1}}:null,isSaving:n,neonatalAdmissionOutcomesSections:G}}});function oe(a,u,o,n,r,l){const m=S("Toolbar"),c=S("NeonatalStepper"),e=S("ion-content"),i=S("ion-page");return O(),U(i,{class:"neonatal-admission-outcomes-page"},{default:A(()=>[d(m),d(e,{fullscreen:!0},{default:A(()=>[d(c,{wizardData:a.wizardData,StepperData:a.stepperData,stepperTitle:a.stepperTitle,openStepper:a.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:a.getSaveFunction,flowType:"admissionOutcomes",sectionsConfig:a.neonatalAdmissionOutcomesSections,useSkipLogic:!0,onUpdateStatus:a.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","sectionsConfig","onUpdateStatus"])]),_:1})]),_:1})}const ve=D(te,[["render",oe],["__scopeId","data-v-61c78177"]]);export{ve as default};
