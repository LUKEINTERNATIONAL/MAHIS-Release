var Dt=Object.defineProperty;var bt=(e,n,t)=>n in e?Dt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Be=(e,n,t)=>bt(e,typeof n!="symbol"?n+"":n,t);import{O as re,bm as Ye,t as me,aU as ee,l as de,_ as oe,bn as It,bo as Ct,a$ as be,M as B,b1 as Re,ag as J,G as Ne,S as G,J as Te,b4 as et,B as tt,bd as St,o as Pe,af as V,aK as Ue,H as U,u as _e,bp as At,aD as we,aC as wt,aE as Et,b2 as Me,L as Ot,bq as Lt,br as Tt,bs as Pt,bt as Ht,bu as kt,bv as Nt,bw as Bt,P as nt,bx as $e,by as Rt,bz as Mt,bA as $t,bB as xt,s as Vt,d as Ft,$ as Ut,N as Gt,aP as Wt,bc as zt,m as at,aR as qt,V as Yt,aV as jt,a1 as Qt,bC as Kt,bD as Xt,as as Jt,bE as se,A as Ee,bF as Zt,aT as en,e as tn,aA as xe,z as nn,aB as an,a as je}from"../index-B4PcD-tN.js";import{d as K,b2 as ge,r as w,a as pe,H,O as Q,f as y,J as r,l as s,k as _,e as T,F as ce,P as Se,m as F,u as g,w as Z,ai as he,b6 as sn,b3 as He,G as st,E as it,aj as ot,ak as We,$ as ve,I as lt,a4 as ze,bg as on,aU as ln,Q as Y,c as te,bA as Qe,aV as rt,bn as Ve,a5 as Ie,a6 as le,am as rn,al as dn,X as Ae,K as q,bD as un,bx as dt,_ as cn,br as ut,z as Ce,ap as ct,cp as pt,a3 as mt,R as Ke,i as Oe,v as Le,L as Ge,p as fe,aS as pn,ay as mn,N as Xe,bp as gn,bS as vn,aP as fn}from"./vendor-g-7mo7AQ.js";import gt from"./LabOrdersList-B_Y32l1G.js";import{v as ke}from"./group_validation-DZMNyv83.js";import{u as hn}from"./RadiologyStore-CFTyQt1n.js";import{B as ie}from"./BasicForm-4b-86afG.js";import{c as _n,f as yn,a as Dn}from"./formatServerData-ByJuAUOI.js";import{D as vt}from"./DashBox-MNF8nhJK.js";import{p as bn}from"./previousComplaints-CUpEqf9P.js";import{P as In}from"./patient_complaints_service-DVfu5TFL.js";import{u as Cn,_ as Sn,a as An,b as Je}from"./nonPharmaTherapyStore-C28gRMVp.js";import{a as Ze}from"./user_role_management-Bx6yzc30.js";import{u as wn}from"./useUserActivities-C--fuos_.js";import{l as En}from"./lodash-NJiRuGo9.js";import{A as On}from"./ncd_appointment_service-3cxR7kZF.js";import{D as Ln}from"./DateInputField-BDLp8vpZ.js";class ft extends re{constructor(){super()}async postActivities(n,t){const l=t.location_id,d=await new Ye(parseInt(n),-1,l).createEncounter();if(d){const f=await re.buildLabOrders(d,t.orders||t);if(!await re.saveOrdersArray(d.encounter_id,f))return me("Unable to save lab orders")}}async postAHDActivities(n,t){const l=t.location_id,d=await new Ye(parseInt(n),-1,l).createEncounter(ee.AHD_LAB_ORDERS);if(d){const f=await re.buildLabOrders(d,t.orders||t);if(!await re.saveOrdersArray(d.encounter_id,f))return me("Unable to save lab orders")}}}const Tn=["innerHTML"],Pn={class:"scrollable-container"},Hn={key:0,class:"form-section"},kn={key:1,class:"form-section"},Nn={key:2,class:"form-section"},Bn={key:3,class:"form-section"},Rn={key:4,class:"form-section"},Mn={key:5,class:"form-section"},$n={key:6,class:"form-section"},xn={key:7,class:"form-section"},Vn=K({__name:"RadiologyInvestigation",setup(e){const n=hn(),{head:t,neck:l,chest:c,abdomen:d,upper_extremity:f,spine:i,pelvis:L,lower_extremity:S}=ge(n),h=w(de),A=w([]),E=(O,D,R)=>{document.querySelectorAll("#".concat(O," path")).forEach(b=>{b.classList.toggle("white-fill")}),document.querySelectorAll("#".concat(D," line")).forEach(b=>{b.classList.toggle("dark-green-stroke")}),document.querySelectorAll("#".concat(D," rect")).forEach(b=>{b.classList.toggle("bright-green-fill"),b.classList.toggle("dark-green-stroke")}),document.querySelectorAll("#".concat(D," path")).forEach(b=>{b.classList.toggle("dark-green-fill")}),document.querySelectorAll("#".concat(D," circle")).forEach(b=>{b.classList.toggle("bright-green-fill")});const W=A.value.findIndex(b=>b.id===R);W>=0?A.value.splice(W,1):A.value.unshift({id:R,active:!0})},$=()=>{const O=document.getElementById("SPINE");O.style.display==="none"||O.style.display==""?O.style.display="block":O.style.display="none",E("SPINE","SPINE_LABEL-2","spine")};return pe(()=>{const O=document.getElementById("HEAD");O&&O.addEventListener("click",()=>{E("HEAD","LABEL-6","head")});const D=document.getElementById("NECK");D&&D.addEventListener("click",()=>{E("NECK","LABEL-5","neck")});const R=document.getElementById("CHEST");R&&R.addEventListener("click",()=>{E("CHEST","LABEL-4","chest")});const W=document.getElementById("ABDOMEN_LABEL");W&&W.addEventListener("click",()=>{const C=document.getElementById("ABDOMEN-2");C.style.display==="none"||C.style.display==""?C.style.display="block":C.style.display="none",E("ABDOMEN","ABDOMEN_LABEL-2","abdomen")});const b=document.getElementById("UPPER_EXTRMITY");b&&b.addEventListener("click",()=>{E("UPPER_EXTRMITY","LABEL-3","upper_extremity")});const z=document.getElementById("SPINE"),k=document.getElementById("SPINE_LABEL"),v=document.getElementById("LOWER_SPINE_INACTIVE");z&&z.addEventListener("click",()=>{$()}),k&&k.addEventListener("click",()=>{$()}),v&&v.addEventListener("click",()=>{$()});const m=document.getElementById("PELVIS");m&&m.addEventListener("click",()=>{E("PELVIS","LABEL-2","pelvis")});const u=document.getElementById("LOWER_EXTREMITY");u&&u.addEventListener("click",()=>{E("LOWER_EXTREMITY","LABEL","lower_extremity")})}),(O,D)=>{const R=H("ion-col"),W=H("ion-row");return y(),Q(W,null,{default:r(()=>[s(R,{size:"7"},{default:r(()=>[_("div",{innerHTML:h.value.full_body_sk},null,8,Tn)]),_:1}),s(R,{size:"5",class:"form-column"},{default:r(()=>[_("div",Pn,[(y(!0),T(ce,null,Se(A.value,b=>(y(),T(ce,null,[b.id==="head"?(y(),T("div",Hn,[D[0]||(D[0]=_("h6",null,"Body Part: Head",-1)),s(ie,{contentData:g(t)},null,8,["contentData"])])):b.id==="neck"?(y(),T("div",kn,[D[1]||(D[1]=_("h6",null,"Body Part: Neck",-1)),s(ie,{contentData:g(l)},null,8,["contentData"])])):b.id==="chest"?(y(),T("div",Nn,[D[2]||(D[2]=_("h6",null,"Body Part: Chest",-1)),s(ie,{contentData:g(c)},null,8,["contentData"])])):b.id==="abdomen"?(y(),T("div",Bn,[D[3]||(D[3]=_("h6",null,"Body Part: Abdomen",-1)),s(ie,{contentData:g(d)},null,8,["contentData"])])):b.id==="upper_extremity"?(y(),T("div",Rn,[D[4]||(D[4]=_("h6",null,"Body Part: Upper Extremity",-1)),s(ie,{contentData:g(f)},null,8,["contentData"])])):b.id==="spine"?(y(),T("div",Mn,[D[5]||(D[5]=_("h6",null,"Body Part: Spine",-1)),s(ie,{contentData:g(i)},null,8,["contentData"])])):b.id==="pelvis"?(y(),T("div",$n,[D[6]||(D[6]=_("h6",null,"Body Part: Pelvis",-1)),s(ie,{contentData:g(L)},null,8,["contentData"])])):b.id==="lower_extremity"?(y(),T("div",xn,[D[7]||(D[7]=_("h6",null,"Body Part: Lower Extremity",-1)),s(ie,{contentData:g(S)},null,8,["contentData"])])):F("",!0)],64))),256))])]),_:1})]),_:1})}}}),ht=oe(Vn,[["__scopeId","data-v-5ab54fe8"]]),Fn={class:"modal_wrapper"},Un={class:"uniform_columns"},Gn=K({__name:"AHDPastMedicalHistory",setup(e,{expose:n}){const t=It(),{pastMedicalHistory:l}=ge(t),c=w([]);pe(()=>{c.value=t.getInitial(),d()}),Z(l,()=>{d()},{deep:!0});const d=()=>{var h;const S=["TB","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Epilepsy","Previous stroke","Peptic Ulcer Disease (PUD)","Mental disorder","Bleeding disorders","Hypertension","HIV Positive","Diabetes Mellitus"];(h=Ct(l.value,"None"))!=null&&h.checked?S.forEach(A=>{be(l.value,"TB treatment","displayNone",!0),B(l.value,"TB drugs","displayNone",!0),B(l.value,"TB drug start date","displayNone",!0),be(l.value,"Hypertension medication","displayNone",!0),B(l.value,"Current hypertension treatment regimen","displayNone",!0),be(l.value,"HIV status","displayNone",!0),B(l.value,"ARV start date","displayNone",!0),be(l.value,"Diabetes","displayNone",!0),be(l.value,"Controlled by","displayNone",!0),Re(l.value,A,"checked",!1),Re(l.value,A,"disabled",!0)}):S.forEach(A=>{Re(l.value,A,"disabled",!1)})},f=S=>{B(l.value,"TB drugs","popOverData",{filterData:!0,data:[{name:"Auramine 'O' (C.I. 41000) 50g"},{name:"Bedaquilline 100mg"},{name:"Clofazimine 100mg"},{name:"Clofazimine 50mg"},{name:"Cycloserine 125mg"},{name:"Cycloserine 250mg"},{name:"Delamanid 50mg"},{name:"Ethambutol 100mg"},{name:"Ethambutol 400mg"},{name:"Ethionamide 250mg"},{name:"Isoniazid 100mg "},{name:"Isoniazid 300mg"},{name:"Isoniazid / Rifapentine 300mg / 300mg"},{name:"Levofloxacin 100mg"},{name:"Levofloxacin 250mg"},{name:"Linezolid 600mg"},{name:"Moxifloxacin 400mg"},{name:"Pyrazinamide 400mg"},{name:"Rifabutin 150mg Capsules"},{name:"Rifampicin 150mg/isoniazid 75mg"},{name:"Rifampicin 75mg+INH 50mg dispersible"},{name:"Rifampicin 75mg+INH 50mg+Pyrazinamide 150mg dispersible"},{name:"Rifampicin150mg/Isoniazid75mg/Pyrazinamide 400mg/Ethambutol"}]}),B(l.value,"Current hypertension treatment regimen","popOverData",{filterData:!0,data:[{name:"Captopril 12.5mg"},{name:"Aspirin 75mg"},{name:"Hydrochlorothiazide 25mg"},{name:"Enalapril Meleate 5mg"},{name:"Enalapril Maleate 10mg"}]})},i=async()=>[...await _n(l.value),...await yn(l.value),...await Dn(l.value)];return n({onSubmit:async()=>{const S=await i();if(S.length===0){me("No past medical history data to save");return}await J.addObsToEncounterPatient(S,ee.AHD_PAST_MEDICAL_HISTORY),Ne("Past medical history saved successful")}}),(S,h)=>(y(),T("div",Fn,[_("div",Un,[s(ie,{contentData:g(l),initialData:c.value,"onUpdate:inputValue":f,"onUpdate:selected":f},null,8,["contentData","initialData"])])]))}}),Wn=oe(Gn,[["__scopeId","data-v-e5153372"]]),zn=K({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(e){this.userRole=G.getUserRoles();const n=G.getProgramID(),t=G.getProgramName();this.userRole=="Lab"&&n==14&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),n==14&&this.userRole!="Lab"&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),n==12&&(this.userRoleSettings={url:"contact",btnName:"Back"}),t=="LABOUR AND DELIVERY PROGRAM"&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),t=="PNC PROGRAM"&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}}),qn=K({name:"Menu",mixins:[zn],components:{IonContent:ze,IonHeader:lt,IonItem:ve,IonList:We,IonMenu:ot,IonTitle:it,IonToolbar:st,IonInput:He,IonPopover:sn,DashBox:vt,SelectionPopover:St,BasicInputField:tt,BasicForm:ie,List:et,DynamicButton:Te,LabOrdersList:gt,RadiologyInvestigation:ht},data(){return{segmentContent:"Lab Investigations",iconsContent:de,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}},setup(){return{checkmark:ln,pulseOutline:on}},computed:{...he(Ue,["investigations"]),...he(_e,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){var e;(e=this.patient)!=null&&e.labOrders&&(this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved])},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{setSegmentContent(e){this.segmentContent=e},async getTests(){let e;G.getPouchDbStatus()&&G.getLanConnectionStatus()?e=await Pe("test_types"):e=await re.getTestTypes(),B(this.investigations,"test","multiSelectData",e)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){var n;if(!((n=this.patient)!=null&&n.labOrders))return;this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const e=await this.labOrders.filter(t=>U.toStandardHisFormat(U.sessionDate())===U.toStandardHisFormat(t.order_date));e.length>0?this.investigations[0].selectedData=e:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard(),Ue().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return ke(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(B(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(B(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){ke(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard()},isNameInData(e,n){for(let t of n)for(let l of t.tests)if(l.name===e)return!0;return!1},async saveTest(){await new ft().postAHDActivities(this.patient.patientID,[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await V.getConceptID(this.inputFields[1].value.name,!0)}]),B(this.investigations,"specimen","disabled",!0),this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},async handleInputData(e){if(e.inputHeader=="Test"&&this.checkTest(),B(this.investigations,"specimen","alertsErrorMassage",""),e.inputHeader=="Test"&&e.value){let n;G.getPouchDbStatus()&&G.getLanConnectionStatus()?n=await Pe("specimens"):n=await re.getSpecimens("",1e3),this.specimen=await V.getConceptSet(e.value.name,"",{names:n.map(t=>t.name)}),this.specimen.length==1?(B(this.investigations,"specimen","value",this.specimen[0]),B(this.investigations,"specimen","disabled",!0)):(B(this.investigations,"specimen","value",""),B(this.investigations,"specimen","disabled",!1)),B(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(e){return await this.labOrders.filter(n=>n.name.toLowerCase().includes(e.toLowerCase()))},async filterSpecimen(e){var n;return(n=this.specimen[0])!=null&&n.name&&e?await this.specimen.filter(t=>t==null?void 0:t.name.toLowerCase().includes(e.toLowerCase())):[]},setTest(e){this.selectedText=e.name,this.inputFields[1].inputHeader=="Test"?this.investigations[0].data.rowData[0].colData[0].value=e.name:this.investigations[0].data.rowData[0].colData[1].value=e.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),Yn={class:"background"},jn={key:0},Qn={key:1},Kn={key:2},Xn={class:"",slot:"content",style:{"margin-bottom":"125px","margin-top":"2px"}},Jn={key:3},Zn={class:"ion-padding",slot:"content"},ea={key:4};function ta(e,n,t,l,c,d){const f=H("ion-label"),i=H("ion-segment-button"),L=H("ion-segment"),S=H("VisitsHistory"),h=H("LabOrdersList"),A=H("RadiologyInvestigation");return y(),T("div",Yn,[s(L,{value:e.segmentContent,style:{"margin-top":"5px"}},{default:r(()=>[s(i,{value:"Lab Investigations",onClick:n[0]||(n[0]=E=>e.setSegmentContent("Lab Investigations"))},{default:r(()=>[s(f,null,{default:r(()=>[...n[3]||(n[3]=[Y("Lab Investigations",-1)])]),_:1})]),_:1}),s(i,{value:"Radiology Investigation",onClick:n[1]||(n[1]=E=>e.setSegmentContent("Radiology Investigation"))},{default:r(()=>[s(f,null,{default:r(()=>[...n[4]||(n[4]=[Y("Radiology Investigation",-1)])]),_:1})]),_:1}),s(i,{value:"Other Investigation",onClick:n[2]||(n[2]=E=>e.setSegmentContent("Other Investigation"))},{default:r(()=>[s(f,null,{default:r(()=>[...n[5]||(n[5]=[Y("Other Investigation",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),e.segmentContent=="Radiology Investigation"?(y(),T("div",jn,[s(S)])):F("",!0),e.segmentContent=="Other Investigation"?(y(),T("div",Qn)):F("",!0),e.segmentContent=="Lab Investigations"?(y(),T("div",Kn,[_("div",Xn,[_("span",null,[s(h,{propOrders:e.labOrders},null,8,["propOrders"])])])])):F("",!0),e.segmentContent=="Radiology Investigation"?(y(),T("div",Jn,[_("div",Zn,[s(A)])])):F("",!0),e.segmentContent=="Other Investigation"?(y(),T("div",ea)):F("",!0)])}const na=oe(qn,[["render",ta],["__scopeId","data-v-67ff1a61"]]),aa={key:0},sa={style:{"align-content":"center"}},ia={class:"ion-padding",slot:"content"},oa=K({__name:"AHDPresentingComplaints",setup(e,{expose:n}){const t=At(),{presentingComplaints:l}=ge(t),c=w(de),d=w(!0),f=w(!1),i=w(!0),L=w(!1),S=w([]),h=w([]),A=w(),E=te(()=>[{componentType:"multiSelectInputField",header:"Presenting Complaints",name:"PresentingComplaints",trackBy:"concept_id",icon:de.search,hideSelected:!0,validation:v=>b(v==null?void 0:v.name,S.value)?"Presenting complaint already added":we.required(v),options:h.value,grid:{s:"6"}},{componentType:"inputField",header:"Duration",name:"duration",icon:de.time,validation:v=>we.isNotEmptyandNumber(v),grid:{s:"6"},unitOptions:[{label:"Hours",value:"Hours"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"}],unitValidation:v=>!v||v===""?"Please select a unit.":null},{componentType:"inputField",header:"Specify the presenting complaint(s)",name:"Other (specify)",icon:de.editPen,validation:v=>b(v,S.value)?"Presenting complaint already added":we.required(v),condition:v=>{var m;return((m=v==null?void 0:v.PresentingComplaints)==null?void 0:m.name)==="Other"}},{componentType:"Alert",condition:v=>{var m;return we.required((m=v==null?void 0:v.PresentingComplaints)==null?void 0:m.name)!=null},backgroundColor:"lightyellow",textColor:"black",value:"Please search thoroughly for the complaint. If it is not listed, search and select the 'Other' option to specify the complaint.",name:"noMatchAlert"}]),{formRef:$}=wt(),O=async()=>{h.value=await In.getComplaintsList("Presenting complaint"),B(l.value,"PresentingComplaints","multiSelectData",h.value)},D=()=>{d.value=!1,i.value=!1,f.value=!0},R=async()=>{var u,C;const v=(u=$.value)==null?void 0:u.getFormValues();((C=$.value)==null?void 0:C.validateForm())==null&&(W(v),f.value=!1,i.value=!0)},W=v=>{var x;const m=v.duration+" "+v.duration_unit,u=v.PresentingComplaints,C=u.name==="Other"?v["Other (specify)"]:u.name;S.value.push({actionBtn:!0,btn:["delete"],name:C,concept_id:u.concept_id,duration:u.duration,durationUnits:u.duration_unit,display:[C,m],data:[{concept_id:8578,value_coded:u.concept_id,obs_datetime:G.getSessionDate(),child:[{concept_id:u.concept_id,value_text:m,obs_datetime:G.getSessionDate()}]}]}),(x=$.value)==null||x.resetForm(),L.value=!0},b=(v,m)=>m.some(u=>u.name===v),z=v=>{S.value=S.value.filter(m=>m.display[0]!==v.name)},k=async()=>{const v=S.value.flatMap(m=>m.data);if(v.length<=0)return me("Presenting complaints is required");v.length<=0||(await J.addObsToEncounterPatient(v,ee.AHD_PRESENTING_COMPLAINTS),Ne("Presenting complaints saved successful"),S.value=[])};return pe(async()=>{await O()}),n({onSubmit:k}),(v,m)=>{const u=H("ion-row"),C=H("ion-label"),x=H("ion-accordion"),I=H("ion-accordion-group");return y(),T(ce,null,[s(vt,{status:d.value,content:"No presenting complaints added"},null,8,["status"]),L.value?(y(),T("span",aa,[s(et,{listData:S.value,"onClicked:delete":z},null,8,["listData"])])):F("",!0),f.value?(y(),Q(u,{key:1},{default:r(()=>[s(Et,{formData:E.value,ref_key:"formRef",ref:$},null,8,["formData"]),_("div",sa,[s(Te,{fill:"clear",icon:c.value.plus,iconSlot:"icon-only","onClicked:btn":m[0]||(m[0]=a=>R()),name:"Save"},null,8,["icon"])])]),_:1})):F("",!0),i.value?(y(),Q(u,{key:2,style:{"margin-top":"10px"}},{default:r(()=>[s(Te,{fill:"clear",icon:c.value.plus,iconSlot:"icon-only","onClicked:btn":m[1]||(m[1]=a=>D()),name:"Add new presenting complaints"},null,8,["icon"])]),_:1})):F("",!0),s(u,null,{default:r(()=>[s(I,{ref_key:"accordionGroup",ref:A,class:"previousView"},{default:r(()=>[s(x,{value:"first","toggle-icon-slot":"start",style:{"border-radius":"10px","background-color":"#fff"}},{default:r(()=>[s(g(ve),{slot:"header",color:"light"},{default:r(()=>[s(C,{class:"previousLabel"},{default:r(()=>[...m[2]||(m[2]=[Y("Previous presenting complaints",-1)])]),_:1})]),_:1}),_("div",ia,[s(bn)])]),_:1})]),_:1},512)]),_:1})],64)}}}),la=oe(oa,[["__scopeId","data-v-04755951"]]);class Fe extends Me{constructor(t,l,c){super(t,ee.AHD_HIV_STAGING,c);Be(this,"age");Be(this,"confirmatoryTest");this.age=l,this.confirmatoryTest=null}isAdult(){return this.age>=15}isPedaid(){return this.age<=14}setAge(t){this.age=t}getFacilities(t=""){return Ot.getFacilities({name:t})}getConfirmatoryTestType(){return this.confirmatoryTest}cd4CountIsValid(t){try{return!!t.match(/^(=|<|>)([0-9]*)$/m)}catch(l){return!1}}getAlertGuidelines(){return Lt}getWhoStageGuidelines(){return this.isAdult()?Tt:Pt}getProgramEligibilityGuidelines(){return this.isAdult()?Ht:kt}getRecommendedConditionGuidelines(){return this.isAdult()?Nt:Bt}getStagingConditions(t){const l=this.getStagingCategoryByNum(t);return Me.getConceptsByCategory(l)}buildWhoStageObs(t){return this.buildValueCoded("Who stage",t)}buildWhoCriteriaObs(t){return this.buildValueCoded("Who stages criteria present",t)}buildReasonForArtObs(t){return this.buildValueCoded("Reason for ART eligibility",t)}getStagingCategoryByNum(t){switch(t){case 1:return this.isAdult()?"stage_1_conditions_adults":"stage_1_conditions_pedaids";case 2:return this.isAdult()?"stage_2_conditions_adults":"stage_2_conditions_pedaids";case 3:return this.isAdult()?"stage_3_conditions_adults":"stage_3_conditions_pedaids";case 4:return this.isAdult()?"stage_4_conditions_adults":"stage_4_conditions_pedaids";default:return""}}async loadHivConfirmatoryTestType(){const t=await Me.getFirstValueCoded(this.patientID,"Confirmatory hiv test type");t&&(this.confirmatoryTest=t)}}const ra={key:0,class:"ion-padding"},da={class:"accordion_group ion-padding"},ua={style:{"font-weight":"bold"}},ca={class:"error"},pa={class:"ion-padding",slot:"content"},ma={class:"ion-padding"},ga={class:"ion-padding"},va={key:0,class:"ion-padding"},fa={class:"ion-padding",style:{"border-bottom":"dashed #ccc"}},ha=K({__name:"AHDStaging",props:{hideSubmit:{type:Boolean,default:!1},date:{default:Fe.getSessionDate()}},setup(e,{expose:n}){const t=e,l=new nt,c=w({}),d=new Fe(l.getID(),l.getAge(),-1);Z(()=>t.date,a=>{var N;const o=(N=a==null?void 0:a.standardDate)!=null?N:Fe.getSessionDate(),p=Ce(o).diff(l.getBirthdate(),"years");d.setAge(p),d.setDate(o)},{deep:!0,immediate:!0});const f=Qe({stage_4_conditions:{title:"Stage 4 Conditions",options:[]},stage_3_conditions:{title:"Stage 3 Conditions",options:[]},stage_2_conditions:{title:"Stage 2 Conditions",options:[]},stage_1_conditions:{title:"Stage 1 Conditions",options:[]}}),i=Qe({cd4:"",cd4Date:"",isChildBearing:!1,reasonForArt:"",pregnant:"",breastFeeding:"",cd4Available:"",cd4Modifier:"",cd4Location:"",whoStage:"",staging:[],confirmatoryTest:""}),L={reasonForArt:{buildObs:()=>d.buildReasonForArtObs(i.reasonForArt),suggestAvalue:()=>({"PRESUMED SEVERE HIV":{priority:1,condition:()=>l.getAgeInMonths()<12&&i.confirmatoryTest==="HIV rapid test"&&V.getConceptsByCategory("pshd_condition").some(a=>W().includes(a.name))},"WHO STAGE IV PEDS":{priority:2,condition:()=>d.isPedaid()&&h(["stage_4_conditions"])},"WHO STAGE III PEDS":{priority:3,condition:()=>d.isPedaid()&&h(["stage_3_conditions"])},"HIV DNA polymerase chain reaction":{priority:4,condition:()=>l.getAgeInMonths()<12&&i.confirmatoryTest==="HIV DNA polymerase chain reaction"},"CD4 COUNT LESS THAN OR EQUAL TO 750":{priority:5,condition:()=>D(750)&&R()&&A()&&l.ageInMonths()>=24&&l.ageInMonths()<=56},"CD4 COUNT LESS THAN OR EQUAL TO 500":{priority:6,condition:()=>d.isPedaid()&&D(500)&&R()&&A()},"HIV infected":{priority:7,condition:()=>l.getAgeInMonths()<24||l.getAge()<=5},"WHO STAGE IV ADULT":{priority:1,condition:()=>{const a=V.getConceptsByCategory("severe_hiv_wasting_syndrome");return d.isAdult()&&(h(["stage_4_conditions"])||a.filter(o=>W().includes(o.name)).length>=2)}},"WHO STAGE III ADULT":{priority:2,condition:()=>d.isAdult()&&h(["stage_3_conditions"])},"cd4 less than or equal to 350":{priority:3,condition:()=>d.isAdult()&&D(350)&&A()},"cd4 less than or equal to 250":{priority:4,condition:()=>d.isAdult()&&D(250)&&A()},"cd4 less than or equal to 500":{priority:4,condition:()=>d.isAdult()&&D(500)&&A()},BREASTFEEDING:{priority:5,condition:()=>d.isAdult()&&i.breastFeeding==="Yes"&&R()},"PATIENT PREGNANT":{priority:6,condition:()=>d.isAdult()&&i.pregnant==="Yes"&&R()},Asymptomatic:{priority:7,condition:()=>R()}})},whoStage:{buildObs:()=>d.buildWhoStageObs(i.whoStage),suggestAvalue:()=>({"WHO STAGE IV ADULT":{priority:1,condition:()=>d.isAdult()&&h(["stage_4_conditions"])},"WHO STAGE III ADULT":{priority:2,condition:()=>d.isAdult()&&h(["stage_3_conditions"])},"WHO STAGE II ADULT":{priority:3,condition:()=>d.isAdult()&&h(["stage_2_conditions"])},"WHO STAGE I ADULT":{priority:4,condition:()=>d.isAdult()&&h(["stage_1_conditions"])},"WHO STAGE IV PEDS":{priority:1,condition:()=>d.isPedaid()&&(h(["stage_4_conditions"])||i.reasonForArt==="WHO STAGE IV PEDS")},"WHO STAGE III PEDS":{priority:2,condition:()=>d.isPedaid()&&h(["stage_3_conditions"])},"WHO STAGE II PEDS":{priority:3,condition:()=>d.isPedaid()&&h(["stage_2_conditions"])},"WHO STAGE I PEDS":{priority:4,condition:()=>d.isPedaid()&&h(["stage_1_conditions"])}})},cd4Available:{required:()=>!0,dataHandler:a=>{a!="Yes"&&(i.cd4="",i.cd4Date=""),c.value.cd4="",c.value.cd4Modifier="",c.value.cd4Date="",c.value.cd4Location=""}},pregnant:{required:()=>i.isChildBearing,buildObs:()=>d.buildValueCoded("Is patient pregnant?",i.pregnant)},breastFeeding:{required:()=>i.isChildBearing,buildObs:()=>d.buildValueCoded("Is patient breast feeding?",i.breastFeeding)},cd4:{required:()=>i.cd4Available==="Yes",validation:()=>{if(!O()){c.value.cd4="A number is required";return}$()>1e4&&(c.value.cd4="CD4 value cannot exceed 10,000")},buildObs:()=>d.buildValueNumber("CD4 count",$(),E())},cd4Modifier:{required:()=>i.cd4Available==="Yes",validation:()=>{i.cd4Modifier||(c.value.cd4Modifier="Please select modifier")},dataHandler:a=>i.cd4Modifier=a,options:[{label:"=",value:"="},{label:">",value:">"},{label:"<",value:"<"}]},cd4Date:{required:()=>i.cd4Available==="Yes",dataHandler:a=>{a&&(i.cd4Date=Ce(a).format("YYYY-MM-DD"))},validation:()=>{if(isNaN(new Date(i.cd4Date).getTime())){c.value.cd4Date="Invalid CD4 date";return}const a=Ce(i.cd4Date);if(a.isAfter(Ce(d.getDate()))){c.value.cd4Date="Cd4 result date can't be greater than ".concat(d.getDate());return}a.isBefore(Ce(l.getBirthdate()))&&(c.value.cd4Date="CD4 date must not be earlier than birthdate")},buildObs:()=>d.buildValueDate("Cd4 count datetime",i.cd4Date)},cd4Location:{required:()=>i.cd4Available==="Yes",dataHandler:a=>i.cd4Location=a,buildObs:()=>d.buildValueText("Cd4 count location",i.cd4Location)},staging:{validation:()=>{if(Object.keys(f).every(N=>v(N)<=0)){c.value.staging="Please select one or more staging conditions";return}const o=["stage_4_conditions","stage_3_conditions","stage_2_conditions"].some(N=>v(N)>0);f.stage_1_conditions.options.some(N=>/asymptomatic/i.test(N.name)&&N.checked)&&o&&(c.value.staging="Asymptomatic cannot be selected with other staging conditions")},buildObs:()=>Object.keys(f).reduce((o,p)=>(f[p].options.forEach(N=>{N.checked&&o.push(N.name)}),o),[]).map(o=>d.buildWhoCriteriaObs(o))}};function S(){Object.keys(i).forEach(a=>{typeof i[a]=="boolean"?i[a]=!1:Array.isArray(i[a])?i[a]=[]:i[a]=""}),Object.keys(c.value).forEach(a=>c.value[a]=""),C()}function h(a){return a.some(o=>v(o)>0)}function A(){return new Date(i.cd4Date)<=new Date("2016-04-30")}function E(){return i.cd4Modifier}function $(){return parseInt("".concat(i.cd4))}function O(){return/^\d+$/i.test("".concat(i.cd4))}function D(a){if(!O())return!1;const o=E(),p=$();return o==="="&&a===p||o==="<"&&p<=a||o===">"&&p>=a}function R(){return h(["stage_2_conditions","stage_1_conditions"])}function W(){return Object.keys(f).reduce((a,o)=>(f[o].options.forEach(p=>p.checked&&a.push(p.name)),a),[])}function b(a){if(c.value[a]="",typeof L[a].required=="function"&&L[a].required()&&!i[a]){c.value[a]="This field is required";return}i[a]&&typeof L[a].validation=="function"&&L[a].validation()}function z(a){var o,p,N;if(L[a]&&"suggestAvalue"in L[a]){i[a]="";const j=L[a].suggestAvalue(),ne=Object.keys(j).reduce((ae,ue)=>{const ye=j[ue];return typeof ye.condition=="function"&&ye.condition()?[...ae,{value:ue,priority:ye.priority}]:ae},[]);i[a]=(N=(p=(o=ne.sort((ae,ue)=>ae.priority-ue.priority))==null?void 0:o[0])==null?void 0:p.value)!=null?N:""}}function k(){return Object.keys(i).reduce((a,o)=>{if(o in L&&i[o]&&typeof L[o].buildObs=="function"){const p=L[o].buildObs();return Array.isArray(p)?[...a,...p]:[...a,p]}return a},[])}function v(a){return f[a].options.filter(o=>o.checked).length}async function m(){await d.loadHivConfirmatoryTestType(),i.confirmatoryTest=d.getConfirmatoryTestType(),i.isChildBearing=l.isChildBearing()}function u(a,o){a in L&&typeof L[a].dataHandler=="function"&&L[a].dataHandler(o),b(a),Object.keys(L).forEach(p=>z(p))}function C(){Object.keys(f).forEach(a=>{var N,j;const o=Number((j=(N=a.match(/\d+/))==null?void 0:N[0])!=null?j:0),p=d.getStagingConditions(o);f[a].options=p.map(ne=>({checked:!1,name:ne.name,concept_id:ne.concept_id}))})}function x(){return Object.keys(L).forEach(a=>b(a)),Object.keys(c.value).every(a=>"".concat(c.value[a]).length<=0)}async function I(){if(console.log("Submitting staging"),!x())return me("Please review form for errors"),!1;try{const a=await Promise.all(k());return await J.addObsToEncounterPatient(a,ee.AHD_HIV_STAGING),Ne("Staging Observations saved!"),!0}catch(a){return console.error(a),Vt("Error has occured while saving observations"),!1}}return Z(()=>t.date,a=>{d.setDate(a),l.date=a,S()}),pe(async()=>{await m(),C()}),n({validateStagingForm:x,buildPayload:k,onSubmit:I}),(a,o)=>(y(),Q(g(ut),null,{default:r(()=>[s(g(rt),null,{default:r(()=>[i.isChildBearing?(y(),T("div",ra,[s(g(Ve),null,{default:r(()=>[s(g(Ie),null,{default:r(()=>[s(g(le),null,{default:r(()=>[s($e,{label:"Pregnant?",modelValue:i.pregnant,"onUpdate:modelValue":o[0]||(o[0]=p=>i.pregnant=p),onIonChange:o[1]||(o[1]=p=>u("pregnant",p)),"error-message":c.value.pregnant},null,8,["modelValue","error-message"])]),_:1}),s(g(le),null,{default:r(()=>[s($e,{label:"Breastfeeding?",modelValue:i.breastFeeding,"onUpdate:modelValue":o[2]||(o[2]=p=>i.breastFeeding=p),onOnChange:o[3]||(o[3]=p=>u("breastFeeding",p)),"error-message":c.value.breastFeeding},null,8,["modelValue","error-message"])]),_:1})]),_:1})]),_:1})])):F("",!0),_("div",da,[s(g(rn),{color:"light"},{default:r(()=>[(y(!0),T(ce,null,Se(f,(p,N)=>(y(),Q(g(dn),{key:N},{default:r(()=>[s(g(ve),{color:"light",slot:"header"},{default:r(()=>[s(g(Ae),{style:{color:"grey","font-size":"17px"},class:"ion-padding"},{default:r(()=>[_("b",ua,[Y(q(p.title)+" ",1),s(g(un),{color:v("".concat(N))>0?"primary":void 0},{default:r(()=>[Y(" Selected: "+q(v("".concat(N))),1)]),_:2},1032,["color"])]),_("p",ca,q(c.value.staging),1)]),_:2},1024)]),_:2},1024),_("div",pa,[s(g(We),null,{default:r(()=>[(y(!0),T(ce,null,Se(p.options,(j,ne)=>(y(),Q(g(ve),{key:ne},{default:r(()=>[s(g(dt),{modelValue:j.checked,"onUpdate:modelValue":ae=>j.checked=ae,onIonChange:ae=>u("staging",{stage_type:N,raw:ae,option:j})},null,8,["modelValue","onUpdate:modelValue","onIonChange"]),s(g(Ae),{style:{margin:"13px"}},{default:r(()=>[Y(q(j.name),1)]),_:2},1024),o[15]||(o[15]=_("p",null,null,-1)),j.description?(y(),Q(g(cn),{key:0,color:j.color},{default:r(()=>[Y(q(j.text),1)]),_:2},1032,["color"])):F("",!0)]),_:2},1024))),128))]),_:2},1024)])]),_:2},1024))),128))]),_:1})]),_("div",ma,[_("div",ga,[s($e,{label:"Recent CD4 count results available?",modelValue:i.cd4Available,"onUpdate:modelValue":o[4]||(o[4]=p=>i.cd4Available=p),onOnChange:o[5]||(o[5]=p=>u("cd4Available",p)),"error-message":c.value.cd4Available},null,8,["modelValue","error-message"])]),i.cd4Available==="Yes"?(y(),T("div",va,[s(g(Ve),{class:"ion-padding"},{default:r(()=>[s(g(Ie),null,{default:r(()=>[s(g(le),null,{default:r(()=>[s(Rt,{label:"CD4 Count Date",modelValue:i.cd4Date,"onUpdate:modelValue":o[6]||(o[6]=p=>i.cd4Date=p),required:i.cd4Available==="Yes","error-message":c.value.cd4Date,onOnChange:o[7]||(o[7]=p=>u("cd4Date",p))},null,8,["modelValue","required","error-message"])]),_:1})]),_:1}),s(g(Ie),null,{default:r(()=>[s(g(le),{size:"2"},{default:r(()=>[s(Mt,{label:"CD4 Result Modifier",required:i.cd4Available==="Yes","error-message":c.value.cd4Modifier,options:L.cd4Modifier.options,onOnChange:o[8]||(o[8]=p=>u("cd4Modifier",p.value))},null,8,["required","error-message","options"])]),_:1}),s(g(le),{size:"10"},{default:r(()=>[s($t,{label:"CD4 Count",modelValue:i.cd4,"onUpdate:modelValue":o[9]||(o[9]=p=>i.cd4=p),type:"number",onOnChange:o[10]||(o[10]=p=>u("cd4",p)),placeholder:"Enter CD4 Count","error-message":c.value.cd4},null,8,["modelValue","error-message"])]),_:1})]),_:1}),s(g(Ie),{style:{"margin-top":"15px"}},{default:r(()=>[s(g(le),null,{default:r(()=>[s(xt,{label:"CD4 Count Location",modelValue:i.cd4Location,"onUpdate:modelValue":o[11]||(o[11]=p=>i.cd4Location=p),required:i.cd4Available==="Yes","error-message":c.value.cd4Location,show_error:!1,selected_district_ids:[],selected_location:i.cd4Location,onOnChange:o[12]||(o[12]=p=>{u("cd4Location",p)})},null,8,["modelValue","required","error-message","selected_location"])]),_:1})]),_:1})]),_:1})])):F("",!0)]),_("div",fa,[s(g(Ve),null,{default:r(()=>[s(g(Ie),null,{default:r(()=>[s(g(le),null,{default:r(()=>[s(g(He),{readonly:"",placeholder:"N/A",label:"REASON FOR ART:",modelValue:i.reasonForArt,"onUpdate:modelValue":o[13]||(o[13]=p=>i.reasonForArt=p)},null,8,["modelValue"])]),_:1}),s(g(le),null,{default:r(()=>[s(g(He),{readonly:"",placeholder:"N/A",label:"WHO STAGE:",modelValue:i.whoStage,"onUpdate:modelValue":o[14]||(o[14]=p=>i.whoStage=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}))}}),_a=oe(ha,[["__scopeId","data-v-f482cf99"]]),ya={style:{display:"flex","align-items":"center"}},Da={style:{width:"90vw",margin:"0 auto","margin-top":"10px"}},ba=K({__name:"AHDWorkflow",props:{closeModalOnFinish:{type:Boolean,default:!1}},setup(e,{expose:n}){const{onTabBeforeChange:t,currentTabIndex:l}=Cn();ct();const c=pt(),d=w(!0),f=w(!1),i=w(!1),L=w(null),S=w(null),h=w(null),A=te(()=>({text:i.value?"Saving...":"Finish",icon:i.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:f.value||i.value})),E=_e(),$=Ft(),O=Ut(),{patient:D}=ge(E),{sessionDate:R}=ge(O);Z(A,(I,a)=>{console.log("Done button options changed:",{from:a,to:I,currentStep:l.value,tabsLength:k.value.length}),I.disabled!==(a==null?void 0:a.disabled)&&console.log("Done button ".concat(I.disabled?"disabled":"enabled")),I.text!==(a==null?void 0:a.text)&&console.log('Done button text changed from "'.concat(a==null?void 0:a.text,'" to "').concat(I.text,'"'))},{deep:!0}),Z(i,(I,a)=>{I!==a&&(console.log("Saving state changed: ".concat(a," -> ").concat(I)),console.log(I?"Starting save process...":"Save process completed"))});const W=I=>{console.log("Done button change received from wizard:",I),I.newOptions.disabled&&console.log("Done button has been disabled"),I.isLastStep&&console.log("User is on the last step, done button should be visible")},b=()=>{let I=!1;return v(),i.value&&(I=!0),f.value=I,!I},z=()=>[{title:"Presenting Complaints",icon:""},{title:"Past Medical History",icon:""},{title:"WHO",icon:""},{title:"Investigation",icon:""}],k=w(z());w(null),w(null);const v=()=>{var o;if(!k.value||k.value.length===0)return console.log("Tabs not yet initialized"),null;const I=l.value>=0&&l.value<k.value.length?l.value:0;switch((o=k.value[I])==null?void 0:o.title){case"Presenting Complaints":return"Presenting Complaints";case"Past Medical History":return"Past Medical History";case"WHO":return"WHO";case"Investigation":return"Investigation";default:if($.NCDActivities.length>0)switch($.NCDActivities[0]){case"Presenting Complaints":return"Presenting Complaints";case"Past Medical History":return"Past Medical History";case"WHO":return"WHO";case"Investigation":return"Investigation"}return null}},m=()=>{d.value=!1,setTimeout(()=>{l.value=0,d.value=!0},0)},u=async()=>{Gt(R.value,"sessionDate","value")||U.sessionDate(),Wt("vitals");for(let I=0;I<k.value.length;I++)k.value[I];b()},C=async(I,a)=>{var o;(o=k.value[a])==null||o.title,I%1===0&&(l.value=I)},x=async()=>{var I,a,o;i.value=!0;try{(I=L.value)==null||I.onSubmit(),(a=S.value)==null||a.onSubmit(),(o=h.value)==null||o.onSubmit(),Ke.dismiss()}catch(p){console.error("Error saving data:",p),me("Error occurred while saving data. Please try again.")}finally{i.value=!1}};return pe(async()=>{k.value=z(),await u(),(l.value===void 0||l.value<0)&&(l.value=0,console.log("Setting initial tab index to 0")),f.value=!1,i.value=!1,b()}),Z(l,async()=>{await b()}),Z(R,async()=>{await u()},{deep:!0}),Z(c,async I=>{m(),k.value=z()},{deep:!0}),Z(D,async(I,a)=>{await u(),I.ID!=a.ID&&m()},{deep:!0}),n({saveData:x,markWizard:u,refreshWizard:m,validateDoneButtonState:b}),(I,a)=>{const o=H("ion-icon"),p=H("ion-title"),N=H("ion-toolbar"),j=H("ion-header");return y(),T(ce,null,[s(j,null,{default:r(()=>[s(N,{class:"modal-title"},{default:r(()=>[s(p,null,{default:r(()=>[_("div",ya,[s(o,{icon:g(de).demographics,class:"sub-menu-icon",style:{"font-size":"1.4rem"}},null,8,["icon"]),a[2]||(a[2]=_("b",{style:{"margin-left":"6px"}},"Advance HIV Disease",-1))])]),_:1}),s(o,{slot:"end",onClick:a[0]||(a[0]=ne=>g(Ke).dismiss()),style:{"font-size":"30px","padding-right":"10px"},icon:g(mt)},null,8,["icon"])]),_:1})]),_:1}),s(g(ze),{class:"ion-padding"},{default:r(()=>[_("div",Da,[d.value?(y(),Q(Sn,{key:0,ref:"wizard",headingTitle:"AHD Screening","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:A.value,"custom-tabs":k.value,beforeChange:g(t),onChange:C,"onComplete:wizard":a[1]||(a[1]=ne=>x()),onDoneButtonChanged:W},{default:r(()=>[Oe(_("div",null,[s(la,{ref_key:"AHDPresentingComplaintsRef",ref:L},null,512)],512),[[Le,v()=="Presenting Complaints"]]),Oe(_("div",null,[s(Wn,{ref_key:"AHDPastMedicalHistoryRef",ref:S},null,512)],512),[[Le,v()=="Past Medical History"]]),Oe(_("div",null,[s(_a,{ref_key:"AHDStagingRef",ref:h},null,512)],512),[[Le,v()=="WHO"]]),Oe(_("div",null,[s(na,{ref:"investigationRef"},null,512)],512),[[Le,v()=="Investigation"]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):F("",!0)])]),_:1})],64)}}}),Ia=async()=>{const{hasWaitingList:e}=wn(),n=await J.getObsByEncounterIdAndDate(ee.PRESENTING_COMPLAINTS),t=await J.getObsByEncounterId(ee.HIV_CLINIC_REGISTRATION),l=await J.getObsByEncounterId(ee.PAST_MEDICAL_HISTORY),c=await J.getObsByEncounterId(ee.HIV_STATUS_AT_ENROLLMENT),d=await J.getObsByEncounterId(ee.PATIENT_OUTCOME),f=await V.getConceptID("Slow onset severe headache"),i=await V.getConceptID("Confusion"),L=await V.getConceptID("Fever"),S=await V.getConceptID("Neck stiffness"),h=await V.getConceptID("Persistent fever/drenching night sweats"),A=await V.getConceptID("Weight loss or failure to thrive"),E=await V.getConceptID("Anaemia<8gdl"),$=await V.getConceptID("Enlarged nodes"),O=await V.getConceptID("Meningits signs"),D=await V.getConceptID("Cough"),R=await V.getConceptID("Yes"),W=await V.getConceptID("Reactive"),b=await V.getConceptID("New Positive"),z=await V.getConceptID("HIV status"),k=await V.getConceptID("Presenting complaint"),v=J.isValueCodedAvailable(n,[f,i,L,S,h,A,E,$,O,D],k),m=J.isValueCodedAvailable(l,[R],z),u=J.isValueCodedAvailable(c,[W],z),C=J.isValueCodedAvailable(d,[R],b);return console.log("ðŸš€ ~ isQualifiedAHD ~ hasCoughComplaint:",v),console.log("ðŸš€ ~ isQualifiedAHD ~ isClinician():",Ze()),console.log('ðŸš€ ~ isQualifiedAHD ~ hasWaitingList("Waiting for Consultation")) :',e("Waiting for Consultation")),console.log("ðŸš€ ~ isQualifiedAHD ~ hasHIVHistory:",m),(Ze()||e("Waiting for Consultation"))&&v&&(m||C||u||t.length>0)},Ca={class:"background"},Sa={key:0},Aa={key:1},wa={key:2},Ea={class:"",slot:"content",style:{"margin-bottom":"125px","margin-top":"2px"}},Oa={key:3},La={class:"ion-padding",slot:"content"},Ta={key:4},Pa=K({__name:"Investigations",setup(e,{expose:n}){const t=w("Lab Investigations"),l=w(!1);w(!0);const c=w(!1),d=w(!1),f=w(!0),i=w(""),L=w("");w("");const S=w("");w(""),w([]),w(!1);const h=w(!1);w("");const A=w("");w(!1),w(!1);const E=Ue(),$=_e(),{investigations:O}=ge(E),{patient:D}=ge($),R=pt(),W=ct(),b=te(()=>O.value[0].data.rowData[0].colData),z=P=>{t.value=P},k=async()=>{let P;G.getPouchDbStatus()&&G.getLanConnectionStatus()?P=await Pe("test_types"):P=await re.getTestTypes(),B(O.value,"test","multiSelectData",P)},v=()=>{h.value=!h.value},m=async()=>{var M;if(!((M=D.value)!=null&&M.labOrders))return;S.value=[...D.value.labOrders.saved,...D.value.labOrders.unsaved];const P=await S.value.filter(X=>U.toStandardHisFormat(U.sessionDate())===U.toStandardHisFormat(X.order_date));P.length>0?O.value[0].selectedData=P:O.value[0].selectedData=""},u=async()=>{await m(),E.setInvestigations(O.value)},C=()=>{L.value="",i.value="",l.value=!1,f.value=!1,c.value=!0},x=async()=>ke(O.value),I=async()=>await o(b.value[0].value.name,await O.value[0].selectedData)?(B(O.value,"test","alertsErrorMassage","Lab order already selected"),!1):(B(O.value,"test","alertsErrorMassage",""),!0),a=async()=>{ke(O.value)&&await I()&&(await p(),O.value[0].data.rowData[0].colData[0].value="",O.value[0].data.rowData[0].colData[1].value="",c.value=!1,d.value=!0,f.value=!0),m()},o=(P,M)=>{for(let X of M)for(let De of X.tests)if(De.name===P)return!0;return!1},p=async()=>{await new ft().postActivities(D.value.patientID,[{concept_id:b.value[0].value.concept_id,name:b.value[0].value.name,specimen:b.value[1].value.name,reason:"Routine",specimenConcept:await V.getConceptID(b.value[1].value.name,!0)}]),B(O.value,"specimen","disabled",!0),S.value=[...D.value.labOrders.saved,...D.value.labOrders.unsaved]},N=async P=>{if(P.inputHeader=="Test"&&I(),B(O.value,"specimen","alertsErrorMassage",""),P.inputHeader=="Test"&&P.value){let M;G.getPouchDbStatus()&&G.getLanConnectionStatus()?M=await Pe("specimens"):M=await re.getSpecimens("",1e3),A.value=await V.getConceptSet(P.value.name,"",{names:M.map(X=>X.name)}),A.value.length==1?(B(O.value,"specimen","value",A.value[0]),B(O.value,"specimen","disabled",!0)):(B(O.value,"specimen","value",""),B(O.value,"specimen","disabled",!1)),B(O.value,"specimen","multiSelectData",A.value)}},j=async P=>await S.value.filter(M=>M.name.toLowerCase().includes(P.toLowerCase())),ne=async P=>{var M;return(M=A.value[0])!=null&&M.name&&P?await A.value.filter(X=>X==null?void 0:X.name.toLowerCase().includes(P.toLowerCase())):[]},ae=P=>{i.value=P.name,b.value[1].inputHeader=="Test"?O.value[0].data.rowData[0].colData[0].value=P.name:O.value[0].data.rowData[0].colData[1].value=P.name,u()},ue=()=>{(b.value[1].value||b.value[0].value)&&(f.value=!1,c.value=!0,l.value=!1),O.value[0].selectedData.length>0?(d.value=!0,l.value=!1):c.value||(l.value=!0)},ye=async()=>{await Ia()&&W.currentRoute.value.name=="OPDConsultationPlan"&&await zt("Do you want to do AHD screening?")&&(await at(ba,{class:"fullScreenModal"}),await qt(D.value))};return Z(O,()=>{ue()},{deep:!0}),Z(D,async()=>{var P;(P=D.value)!=null&&P.labOrders&&(S.value=[...D.value.labOrders.saved,...D.value.labOrders.unsaved])},{deep:!0}),Z(R,async()=>{await k()},{deep:!0}),pe(async()=>{await k(),u(),ue(),m()}),n({openAHDModal:ye,setSegmentContent:z,getTests:k,toggleLabOrderStatus:v,updateInvestigationWizard:m,updateInvestigationsStores:u,displayInputFields:C,validateRowData:x,checkTest:I,addNewRow:a,isNameInData:o,saveTest:p,handleInputData:N,filterTest:j,filterSpecimen:ne,setTest:ae,setDashedBox:ue}),(P,M)=>{const X=H("ion-label"),De=H("ion-segment-button"),_t=H("ion-segment"),yt=H("VisitsHistory");return y(),T("div",Ca,[s(_t,{value:t.value,style:{"margin-top":"5px"}},{default:r(()=>[s(De,{value:"Lab Investigations",onClick:M[0]||(M[0]=qe=>z("Lab Investigations"))},{default:r(()=>[s(X,null,{default:r(()=>[...M[3]||(M[3]=[Y("Lab Investigations",-1)])]),_:1})]),_:1}),s(De,{value:"Radiology Investigation",onClick:M[1]||(M[1]=qe=>z("Radiology Investigation"))},{default:r(()=>[s(X,null,{default:r(()=>[...M[4]||(M[4]=[Y("Radiology Investigation",-1)])]),_:1})]),_:1}),s(De,{value:"Other Investigation",onClick:M[2]||(M[2]=qe=>z("Other Investigation"))},{default:r(()=>[s(X,null,{default:r(()=>[...M[5]||(M[5]=[Y("Other Investigation",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),t.value=="Radiology Investigation"?(y(),T("div",Sa,[s(yt)])):F("",!0),t.value=="Other Investigation"?(y(),T("div",Aa)):F("",!0),t.value=="Lab Investigations"?(y(),T("div",wa,[_("div",Ea,[_("span",null,[s(gt,{propOrders:S.value},null,8,["propOrders"])])])])):F("",!0),t.value=="Radiology Investigation"?(y(),T("div",Oa,[_("div",La,[s(ht)])])):F("",!0),t.value=="Other Investigation"?(y(),T("div",Ta)):F("",!0)])}}}),_s=oe(Pa,[["__scopeId","data-v-a8c898e3"]]),Ha=K({created(){},components:{IonItem:ve,IonCol:le,IonLabel:Ae,IonIcon:Ge},data(){return{iconsContent:de,localMedicalDrugsList:[...this.$props._selectedMedicalDrugsList]}},props:{_selectedMedicalDrugsList:{type:Array,default:[]},show_actions_buttons:{type:Boolean,default:!0},highLightBackground:{type:String,default:"item-native"}},watch:{},methods:{highlightItem(e){const n=document.getElementById(e+"_lbl");n&&(n.style.color="#006401"),this.highlightActionBtns(e)},undoHighlightItem(e){const n=document.getElementById(e+"_lbl");n&&(n.style.color="#636363"),this.undohighlightActionBtns(e)},highlightActionBtns(e){const n=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<n.length;t++)n[t].style.display="inline-block"},undohighlightActionBtns(e){const n=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<n.length;t++)n[t].style.display="none"},asignLblID(e){return e+"_lbl"},asignSpanLblID(e){return e+"_spanlbl"},async removeItemAtIndex(e,n){await Yt("Do you want to delete it?",n)&&this.$emit("remove-item",e)},editItemAtIndex(e){this.$emit("edit-item",e)},highLightBnd(e){if(e){if(e.highlightbackground!==void 0&&e.highlightbackground==!0)return this.$props.highLightBackground}else return!1}}}),ka=["onMousemove","onMouseout"],Na={class:"route-label"};function Ba(e,n,t,l,c,d){const f=H("ion-label"),i=H("ion-col"),L=H("ion-row"),S=H("ion-icon");return y(!0),T(ce,null,Se(e.localMedicalDrugsList,(h,A)=>(y(),T("div",{id:"df",class:"medication-item",key:A,onMousemove:E=>e.highlightItem(A),onMouseout:E=>e.undoHighlightItem(A)},[s(L,{class:"medication-header"},{default:r(()=>[s(i,{class:fe(["ion-text-wrap",e.highLightBnd(h)])},{default:r(()=>[s(f,{id:e.asignLblID(A),class:"medication-name"},{default:r(()=>[Y(q(h.drugName),1)]),_:2},1032,["id"])]),_:2},1032,["class"])]),_:2},1024),s(L,{class:"medication-details"},{default:r(()=>[s(i,{size:"10",class:fe(["ion-text-wrap details-col",e.highLightBnd(h)])},{default:r(()=>[s(f,{class:"details-text"},{default:r(()=>[Y(q(h.dose)+" / "+q(h.frequency)+" / daily / "+q(h.duration)+" / until "+q(h.prescription)+" ",1),_("span",Na,q(h.route_name),1)]),_:2},1024)]),_:2},1032,["class"]),e.show_actions_buttons?(y(),Q(i,{key:0,class:fe([e.highLightBnd(h),"actions-col"]),size:"2"},{default:r(()=>[s(f,{class:fe(["action-button",e.asignSpanLblID(A)]),onClick:E=>e.editItemAtIndex(A)},{default:r(()=>[s(S,{icon:e.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),s(f,{class:fe(["action-button",e.asignSpanLblID(A)]),onClick:E=>e.removeItemAtIndex(A,E)},{default:r(()=>[s(S,{icon:e.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1032,["class"])):F("",!0)]),_:2},1024)],40,ka))),128)}const ys=oe(Ha,[["render",Ba],["__scopeId","data-v-01c693a3"]]),Ra={key:0,class:"custom-allergy-container"},Ma={class:"button-group"},$a=K({watch:{},name:"AllergiesComponent"}),xa=K({...$a,setup(e,{expose:n}){const t=jt(),l=_e(),c=Qt(),d=te(()=>t.selectedMedicalAllergiesList),f=te(()=>l.patient),i=te(()=>t.medicalAllergiesList),L=w(b(8,"item-")),S=te(()=>t.selectedMedicalAllergiesList),h=w(""),A=w(!1),E=[{multi_Selection:!0,show_list_label:!0,unqueId:L.value,name_of_list:"Add/Remove allergies",placeHolder:"Search for an allergy",items:[],listUpdatedFN:D,listFilteredFN:()=>{},searchTextFN:R,use_internal_filter:!0,show_error:w(!1),error_message:"please select a User",disabled:w(!1)}],$=w(!1);pe(async()=>{O()});const O=()=>{t.current_patient.ID!=f.value.ID&&(t.clearSelectedMedicalAllergiesList(),t.setCurrentPatient(f.value))};function D(m){m.forEach(u=>{u.selected==!0&&u.name==="Other"&&(A.value=u.name==="Other"),u.selected==!1&&u.name==="Other"&&k()}),t.setSelectedMedicalAllergiesList(m),W()}async function R(m){const u=m,C=await V.getConceptSet("OPD Medication",u);if(!C)return;C.map(o=>({label:o.name,value:o.name,other:o}));const x=Kt(u),a=Xt(x,C).sort((o,p)=>o.name.localeCompare(p.name));t.setMedicalAllergiesList(a),W()}function W(){const m=i.value;d.value.forEach(C=>{let x=!1;m.forEach((I,a)=>{I.concept_id==C.concept_id&&C.selected===!0&&(m[a]=C,x=!0)}),!x&&C.selected===!0&&m.push(C)});const u=m.filter((C,x,I)=>x===I.findIndex(a=>(a==null?void 0:a.concept_id)===(C==null?void 0:C.concept_id)));t.setMedicalAllergiesList(u)}function b(m=8,u=""){const C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let x=u;for(let I=0;I<m;I++)x+=C.charAt(Math.floor(Math.random()*C.length));return x+="-".concat(Date.now()),x}async function z(m){try{const u=m.trim();if(u){const C={name:u,selected:!0,concept_id:b(8,"12"),concept_name_id:b(8,"34")};t.setMedicalAllergiesList([...i.value,C]),t.setSelectedMedicalAllergiesList(C),A.value=!1,$.value=!0,h.value="";const x=t.findSelectedAllergyByName("Other");t.unselectOther(x)}}catch(u){console.error(u)}}const k=()=>{A.value=!1,h.value="",$.value=!1;const m=t.findSelectedAllergyByName("Other");m&&t.unselectOther(m)};return n({onSubmit:async()=>{try{if(En.isEmpty(S.value))return;const m=await V.getConceptID("Allergic"),u=S.value.map(C=>({concept_id:m,obs_datetime:G.getSessionDate(),value_coded:C.concept_id,location_id:c.facilityLocation.code,value_text:C.name}));await J.addObsToEncounterPatient(u,ee.MEDICAL_HISTORY),Ne("Allergies appended to patient record successfully")}catch(m){me("Failed to save allergies")}}}),(m,u)=>(y(),Q(g(ut),null,{default:r(()=>[s(g(pn),null,{default:r(()=>[s(g(Ae),{class:"header-container"},{default:r(()=>[s(g(Ge),{icon:g(mn),class:"allergy-icon"},null,8,["icon"]),u[3]||(u[3]=_("span",{style:{"font-size":"16px","font-weight":"600"}}," Allergies (Medication, Healthcare items, Environment and Food) ",-1))]),_:1})]),_:1}),s(g(rt),null,{default:r(()=>[s(Jt,{multiSelection:E[0].multi_Selection,show_label:E[0].show_list_label,uniqueId:E[0].unqueId,name_of_list:E[0].name_of_list,choose_place_holder:E[0].placeHolder,"items_-list":i.value,use_internal_filter:E[0].use_internal_filter,disabled:E[0].disabled.value,onItemListUpDated:E[0].listUpdatedFN,onItemListFiltered:E[0].listFilteredFN,onItemSearchText:E[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),A.value?(y(),T("div",Ra,[s(g(He),{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=C=>h.value=C),placeholder:"Please specify the allergy",fill:"outline",class:"custom-input"},null,8,["modelValue"]),_("div",Ma,[s(g(Xe),{onClick:u[1]||(u[1]=C=>z(h.value)),class:"addCustomAllergyBtn"},{default:r(()=>[...u[4]||(u[4]=[Y(" Add Allergy ",-1)])]),_:1}),s(g(Xe),{onClick:u[2]||(u[2]=C=>k()),fill:"clear",class:"cancelBtn"},{default:r(()=>[s(g(Ge),{icon:g(mt),slot:"icon-only"},null,8,["icon"])]),_:1})])])):F("",!0)]),_:1})]),_:1}))}}),Ds=oe(xa,[["__scopeId","data-v-d63cacc6"]]),Va={class:"checklist-container"},Fa=K({watch:{},name:"xxxComponent"}),Ua=K({...Fa,setup(e){const n=_e(),t=te(()=>n.patient),l=An(),c=l.items;pe(async()=>{d()});const d=()=>{l.current_patient.ID!=t.value.ID&&(l.clearSelectednonPharmaTherapyStore(),l.setCurrentPatient(t.value))};return Z(()=>t.value,async f=>{}),(f,i)=>(y(),T("div",Va,[(y(!0),T(ce,null,Se(g(c),L=>(y(),Q(g(ve),{key:L.id,class:"no-border"},{default:r(()=>[s(g(dt),{id:L.id,modelValue:L.checked,"onUpdate:modelValue":S=>L.checked=S,slot:"start"},null,8,["id","modelValue","onUpdate:modelValue"]),s(g(Ae),{style:{"font-size":"16px","font-weight":"600"}},{default:r(()=>[Y(q(L.label),1)]),_:2},1024)]),_:2},1024))),128))]))}}),bs=oe(Ua,[["__scopeId","data-v-371e920f"]]),Ga=K({components:{IonContent:ze,IonHeader:lt,IonItem:ve,IonList:We,IonMenu:ot,IonTitle:it,IonToolbar:st,BasicInputField:tt,IonDatetime:vn,IonBadge:gn,DateInputField:Ln,DynamicButton:Te},props:{showPeripheral:{type:Boolean,default:!0}},setup(e){const n=xe(),t=w(0),l=te(()=>n.getDisabledDates()),c=te(()=>n.getAssignedAppointments()),d=w(),f=te(()=>e.showPeripheral);return{disabledDates:l,datesCounts:c,appointment_count:t,calendarOutline:fn,inputPRDate:d,show_peripheral:f}},data(){return se(),je(),{iconsContent:de,date:new Date(G.getSessionDate()),tomorrow:new Date(G.getSessionDate()).getDate()+1,appointment:"",drugRunoutDate:"",nextAppointmentDate:"",minDate:new Date(G.getSessionDate())}},computed:{...he(se,["nextAppointment","appointmentCountsCache","currentSelectedNextAppointmentDate"]),...he(xe,["maximumNumberOfDaysForEachDay","assignedAppointmentsDates"]),...he(_e,["patient"]),...he(je,["activeProgram"]),calendarDate(){const e=se();return e.currentSelectedNextAppointmentDate?U.toStandardHisDisplayFormat(e.currentSelectedNextAppointmentDate):""},runOutDate(){var n;const e=se();return((n=this.activeProgram)==null?void 0:n.program_id)===14?Je():e.getAppointmentMedicationRunOutDate()}},watch:{calendarDate:{handler(){this.updateNextAppointment()},deep:!0},"$service.sessionDate":{handler(){this.updateMinDate()},immediate:!0},"patient.ID":{async handler(e,n){e!==n&&(this.cleanCurrentNextAppointmentDate(),this.checkIfSamePatientInContext(),this.clearNextAppointment())}}},async mounted(){this.checkIfSamePatientInContext(),await this.getAppointmentMents(this.runOutDate.date),await nn().loadGlobalProperty(),this.validateAppointmentCountsCache(),await this.preloadAppointmentCounts(),an();const e=G.getUserID(),n=new nt;this.appointment=new Ee(n.getID(),e),this.nextAppointmentDate=this.appointment.date,this.supposedRunOutDate(),window.addEventListener("storage",this.handleStorageChange),Je()},beforeUnmount(){window.removeEventListener("storage",this.handleStorageChange)},methods:{handleStorageChange(e){e.key==="sessionDate"&&this.updateMinDate()},updateMinDate(){this.date=new Date(G.getSessionDate()),this.minDate=new Date(G.getSessionDate())},updateNextAppointment(){se().setNextAppointment(this.calendarDate)},async handleDateUpdate(e){e&&(xe().setAssignedAppointmentsDates(e,!0),this.calendarDate=U.toStandardHisDisplayFormat(e),await this.save(),await this.getAppointmentMents(e),await this.updateAppointmentCache(e),se().setCurrentSelectedNextAppointmentDate(e,this.patient.ID))},async getAppointmentMents(e){if(tn().apiStatus)try{const t=await Ee.getDailyAppointments(U.toStandardHisFormat(e),U.toStandardHisFormat(e));this.appointment_count=t.length}catch(t){}},getCounter(e){const n=U.toStandardHisFormat(e);return this.appointmentCountsCache[n]||""},async save(){if(this.assignedAppointmentsDates.length>0)try{const n=await new On().createOfflineAppointment()}catch(e){}},async openCornfirmModal(e){this.calendarDate=U.toStandardHisDisplayFormat(e),await this.getAppointmentMents(e),at(en,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Appointment?"},{cancel:c=>{},confirm:async c=>{c.detail==!0&&await this.handleDateUpdate(e)}})},async handleInput(e){this.inputPRDate=U.toStandardHisDisplayFormat(e),await this.openCornfirmModal(e)},async supposedRunOutDate(){await Zt.getLastDrugsReceived(this.patient.patientID)},async preloadAppointmentCounts(){try{const e=new Date(G.getSessionDate());e.setDate(1);const n=new Date(G.getSessionDate());n.setMonth(n.getMonth()+2),n.setDate(0);try{const t=await Ee.getDailyAppointments(U.toStandardHisFormat(e),U.toStandardHisFormat(n));if(!t)return;const l=this.filterUniqueAppointments(t),c={};l.forEach(d=>{const f=new Date(d.appointment_date),i=U.toStandardHisFormat(f);c[i]||(c[i]=0),c[i]++}),Object.keys(c).forEach(d=>{this.appointmentCountsCache[d]=c[d]})}catch(t){console.error("Error fetching appointments for date range:",t)}}catch(e){console.error("Error in preload process:",e)}},filterUniqueAppointments(e){const n=new Map;return e.forEach(t=>{const l="".concat(t.given_name,"_").concat(t.family_name,"_").concat(t.birthdate,"_").concat(t.appointment_date);n.has(l)||n.set(l,t)}),Array.from(n.values())},async updateAppointmentCache(e){try{const n=U.toStandardHisFormat(e),t=await Ee.getDailyAppointments(U.toStandardHisFormat(e),U.toStandardHisFormat(e));if(!t)return;this.appointmentCountsCache[n]=t.length}catch(n){console.error("Error updating appointment cache:",n)}},validateAppointmentCountsCache(){se().checkCurrentLocationIfInContext()},isRunOutDate(e){return!this.runOutDate||!this.runOutDate.date?!1:U.toStandardHisFormat(e)===U.toStandardHisFormat(this.runOutDate.date)},cleanCurrentNextAppointmentDate(){se().cleanCurrentSelectedNextAppointmentDate()},checkIfSamePatientInContext(){const e=se();e.current_patient.ID!=this.patient.ID&&(this.cleanCurrentNextAppointmentDate(),e.setCurrentPatient(this.patient))},clearNextAppointment(){se().clearAppointmentMedicationRunOutDate()}}}),Wa={class:"card_content"},za={class:"count-badge"},qa={class:"dates_title"},Ya={class:"sub_data"},ja={class:"dates_title"},Qa={class:"sub_data"},Ka={class:"dates_title"},Xa={class:"sub_data"},Ja={class:"dates_title"},Za={class:"sub_data"};function es(e,n,t,l,c,d){const f=H("VueDatePicker"),i=H("ion-col"),L=H("DynamicButton"),S=H("ion-item"),h=H("ion-row"),A=H("DateInputField");return y(),T("div",Wa,[s(h,null,{default:r(()=>[s(i,{"size-sm":"12","size-md":"12","size-lg":"12","size-xl":"8"},{default:r(()=>[s(f,{class:"calender",onDateUpdate:e.openCornfirmModal,inline:"","auto-apply":"","enable-time-picker":!1,"disabled-dates":e.disabledDates,"min-date":e.minDate,modelValue:e.runOutDate.date,"onUpdate:modelValue":n[0]||(n[0]=E=>e.runOutDate.date=E)},{day:r(({day:E,date:$})=>[(y(),T("p",{key:0,class:fe({"run-out-date":e.isRunOutDate($)}),style:{"font-weight":"600","font-size":"20px"}},[_("span",null,[Y(q(E),1),_("sup",za,q(e.getCounter($)),1)])],2))]),_:1},8,["onDateUpdate","disabled-dates","min-date","modelValue"])]),_:1}),e.show_peripheral?(y(),Q(i,{key:0},{default:r(()=>[s(S,null,{default:r(()=>[_("div",qa,[n[3]||(n[3]=_("div",null,[Y("Suggested Next Appointment Date "),_("span",{style:{"font-size":"16px"}},"(Medication run out date)")],-1)),_("div",Ya,[Y(q(e.runOutDate.formattedDate||"No run out date available")+" ",1),e.runOutDate.formattedDate?(y(),Q(L,{key:0,onClick:n[1]||(n[1]=E=>e.handleDateUpdate(e.runOutDate.date)),name:"Set Next Appt.",fill:"solid",iconSlot:"icon-only",style:{float:"right"}})):F("",!0)])])]),_:1}),s(S,null,{default:r(()=>[_("div",ja,[n[4]||(n[4]=_("div",null,"User set appointment date",-1)),_("div",Qa,q(e.calendarDate),1)])]),_:1}),s(S,null,{default:r(()=>[_("div",Ka,[n[5]||(n[5]=_("div",null,"Appointments",-1)),_("div",Xa,q(e.appointment_count),1)])]),_:1}),s(S,null,{default:r(()=>[_("div",Ja,[n[6]||(n[6]=_("div",null,"Appointment limit (per/day)",-1)),_("div",Za,q(e.appointment_count)+"/"+q(e.maximumNumberOfDaysForEachDay),1)])]),_:1})]),_:1})):F("",!0)]),_:1}),e.show_peripheral?(y(),Q(h,{key:0},{default:r(()=>[s(i,{size:"4"},{default:r(()=>[s(A,{inputHeader:"Preferred Next Appointment Date",bold:"600",fontSize:"17px",placeholderFontSize:"17px",placeholderFontWeight:"600",unit:"",icon:e.calendarOutline,placeholder:"press to select date",iconRight:"",inputWidth:"100%",inputValue:e.inputPRDate,eventType:"",minDate:e.minDate,maxDate:"",disabled:!1,"onUpdate:rawDateValue":n[2]||(n[2]=E=>e.handleInput(E))},null,8,["icon","inputValue","minDate"])]),_:1})]),_:1})):F("",!0)])}const Is=oe(Ga,[["render",es],["__scopeId","data-v-4e58e0bc"]]);export{Ds as A,ys as D,_s as I,ft as L,Is as N,ba as _,bs as a,zn as b,Ia as i};
