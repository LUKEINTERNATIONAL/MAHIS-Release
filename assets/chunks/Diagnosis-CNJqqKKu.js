var se=Object.defineProperty;var ie=(e,i,o)=>i in e?se(e,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[i]=o;var B=(e,i,o)=>ie(e,typeof i!="symbol"?i+"":i,o);import{_ as V,u as U,aa as te,F as ae,w as O,aX as q,T as ne}from"../index-DBQF-8Xn.js";import{d as T,br as E,e as v,f as h,m as C,k as u,l as A,j as K,J as M,Q as H,K as _,u as y,r as I,w as z,c as w,O as G,p as J,cD as oe,ff as le,D as Z,b2 as Q,b$ as re,F as Y,P as x,bM as F,by as j,am as ue,ab as ce,ae as pe}from"./vendor-BTebhqHt.js";import{u as de,N as ge}from"./NeonatalStepper-8Oe2Qew7.js";import{I as me}from"./images-Zb0Yk5XL.js";import{u as he}from"./useNeonatalVitalsStore-D_8xjpBW.js";import{u as fe}from"./useReviewOfSystemsStore-CdTM05eI.js";import{u as ve}from"./useNeonatalExamStore-iGhj7wjk.js";import{u as ye}from"./useSystemicExaminationStore-D6E222cM.js";import{u as De}from"./useSignsSymptomsStore-DEd14AcB.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-no8IW45T.js";import"./SaveProgressModal-D_8NFGJ1.js";import"./enrollment-DU-PLRUa.js";const be={class:"multiselect-header-wrapper"},Se={key:0,class:"question-header"},_e={class:"selection-instruction"},we=T({name:"VueMultiselectStyledHeader",components:{VueMultiselect:E},__name:"VueMultiselectStaticList",props:{options:{type:Array,required:!0,validator:e=>e.every(i=>"label"in i&&"value"in i)},modelValue:{type:[Object,null],default:null}},emits:["update:modelValue"],setup(e,{emit:i}){const o=i,a=()=>{o("update:modelValue",null)};return(d,t)=>(h(),v("div",be,[d.$slots.header?(h(),v("div",Se,[K(d.$slots,"header",{},void 0,!0)])):C("",!0),u("div",_e,[t[1]||(t[1]=u("span",null,"Select one.",-1)),e.modelValue?(h(),v("button",{key:0,onClick:a,class:"clear-button",type:"button"},"Clear")):C("",!0)]),A(y(E),{"model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=g=>o("update:modelValue",g)),options:e.options,"track-by":"value",label:"label",searchable:!1,"allow-empty":!0,"show-labels":!1,"close-on-select":!0},{option:M(({option:g})=>[H(_(g.label),1)]),singleLabel:M(({option:g})=>[H(_(g.label),1)]),_:1},8,["model-value","options"])]))}}),ke=V(we,[["__scopeId","data-v-349ad15d"]]),Ce={class:"multiselect-header-wrapper"},Re={key:0,class:"question-header"},Ae={class:"selection-instruction"},Pe={class:"custom__tag"},He=["onClick"],Me=T({name:"VueMultiselectStyledMulti",components:{VueMultiselect:E},__name:"VueMultiselectStyledMulti",props:{options:{type:Array,required:!0,validator:e=>e.every(i=>"label"in i&&"value"in i)},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:i}){const o=i,a=()=>{o("update:modelValue",[])};return(d,t)=>(h(),v("div",Ce,[d.$slots.header?(h(),v("div",Re,[K(d.$slots,"header",{},void 0,!0)])):C("",!0),u("div",Ae,[t[1]||(t[1]=u("span",null,"Select one or more.",-1)),e.modelValue.length>0?(h(),v("button",{key:0,onClick:a,class:"clear-button",type:"button"},"Clear All")):C("",!0)]),A(y(E),{"model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=g=>o("update:modelValue",g)),options:e.options,"track-by":"value",label:"label",searchable:!0,multiple:!0,"close-on-select":!1,"hide-selected":!0},{tag:M(({option:g,remove:l})=>[u("span",Pe,[u("span",null,_(g.label),1),u("span",{class:"custom__remove",onClick:f=>l(g)},"âŒ",8,He)])]),placeholder:M(()=>[...t[2]||(t[2]=[H(" Select the appropriate diagnosis... ",-1)])]),_:1},8,["model-value","options"])]))}}),Ie=V(Me,[["__scopeId","data-v-bce8dfd3"]]),Te={class:"selected-diagnoses-list"},Ve={key:0,class:"empty-state"},Le=["src"],Be={key:1,class:"rank-number"},$e={class:"item-label"},Ee=["onClick","aria-label","title"],Ne=T({__name:"SelectedDiagnosisDisplay",props:{items:{default:()=>[]},isDifferential:{type:Boolean,default:!1},allowDragging:{type:Boolean,default:!1}},emits:["remove-item","update:items"],setup(e,{emit:i}){const o=e,a=i,d=I([]),t=I(null);z(()=>o.items,m=>{m?d.value=[...m]:d.value=[]},{immediate:!0,deep:!0});const g=w(()=>({animation:250,disabled:!o.allowDragging||!o.isDifferential,ghostClass:"ghost",dragClass:"dragging-element",forceFallback:!0,fallbackTolerance:5,touchStartThreshold:5,delay:0,delayOnTouchOnly:!0})),l=m=>o.allowDragging&&o.isDifferential,f=m=>{m.oldIndex!==void 0&&d.value[m.oldIndex]&&(t.value=d.value[m.oldIndex].value)},n=m=>{a("update:items",d.value),t.value=null},D=m=>{a("remove-item",m)};return(m,k)=>(h(),v("div",Te,[!e.items||e.items.length===0?(h(),v("div",Ve,[u("p",null,"No "+_(e.isDifferential?"differential":"working")+" diagnosis selected",1)])):(h(),G(y(le),oe({key:1,modelValue:d.value,"onUpdate:modelValue":k[0]||(k[0]=s=>d.value=s),"item-key":"value",handle:".drag-handle-wrapper",onStart:f,onEnd:n},g.value,{move:l}),{item:M(({element:s,index:c})=>[u("div",{class:J(["selected-item",{differential:e.isDifferential,"is-dragging":t.value===s.value,"draggable-enabled":e.allowDragging&&e.isDifferential}])},[e.allowDragging&&e.isDifferential?(h(),v("div",{key:0,class:J(["drag-handle-wrapper",{"is-active":t.value===s.value}]),title:"Drag to reorder"},[u("img",{src:y(me).icons.dragIcon,alt:"Drag to reorder",class:"drag-icon"},null,8,Le)],2)):C("",!0),e.isDifferential?(h(),v("span",Be,"#"+_(c+1),1)):C("",!0),u("span",$e,_(s.label),1),u("button",{onClick:R=>D(s),class:"remove-button",type:"button","aria-label":"Remove "+s.label,title:"Remove "+s.label},[...k[1]||(k[1]=[u("span",{class:"trash-icon"},"ðŸ—‘ï¸",-1)])],8,Ee)],2)]),_:1},16,["modelValue"]))]))}}),N=V(Ne,[["__scopeId","data-v-6f381d34"]]),L=Z("diagnosisStore",{state:()=>({workingDiagnosis:null,differentialDiagnoses:[],diagnosisNotes:"",current_patient_ID:null}),actions:{setWorkingDiagnosis(e){this.workingDiagnosis=e},setDifferentialDiagnoses(e){this.differentialDiagnoses=e},addDifferentialDiagnosis(e){this.differentialDiagnoses.some(i=>i.value===e.value)||this.differentialDiagnoses.push(e)},removeDifferentialDiagnosis(e){this.differentialDiagnoses=this.differentialDiagnoses.filter(i=>i.value!==e.value)},setDiagnosisNotes(e){this.diagnosisNotes=e},resetDiagnosisData(){this.$reset(),console.log("Diagnosis Store Data has been reset.")},setCurrentPatientID(e){this.current_patient_ID!==e?(this.workingDiagnosis=null,this.differentialDiagnoses=[],this.diagnosisNotes="",this.current_patient_ID=e,console.log("Patient ID changed to: ".concat(e,". All diagnosis selections have been cleared."))):console.log("Patient ID unchanged: ".concat(e,". Diagnosis data retained."))}},persist:!0}),Oe={class:"diagnosis-selection-panel"},Ye={class:"diagnosis-section"},xe={class:"diagnosis-section"},Ge={key:0,class:"validation-error"},We=T({__name:"DiagnosisSelection",setup(e,{expose:i}){const o=ke,a=L(),d=U(),{patient:t}=Q(d),g=I(null),l=p=>p==null?null:String(p);z(()=>{var p;return(p=t.value)==null?void 0:p.patientID},p=>{const r=l(p);a.setCurrentPatientID(r)},{immediate:!0});const f=[{label:"Hypoglycaemia (symptomatic)",value:"Hypoglycaemia1"},{label:"Abscess",value:"Abscess"},{label:"Fever",value:"Fever"},{label:"Birth Asphyxia",value:"Asphyxia"},{label:"Neonatal Sepsis (Early onset - Symptomatic)",value:"Neonatal Sepsis - Early Onset"},{label:"Prematurity with Respiratory Distress",value:"Prematurity with RDS"},{label:"Suspected Neonatal Sepsis",value:"Sepsis_Sus"},{label:"Possible Meconium Aspiration",value:"Meconium Aspiration"},{label:"Possible Meconium Aspiration",value:"MAP"},{label:"Suspected neonatal sepsis",value:"NSep"},{label:"Difficulty Feeding",value:"DF"},{label:"Dehydration",value:"Dhyd"},{label:"Congenital Heart Disease",value:"CHD"},{label:"Anaemia",value:"An"},{label:"Congenital Abnormality",value:"Cong"},{label:"Pneumonia / Bronchiolitis",value:"PnBch"},{label:"Transient Tachypnoea of Newborn (TTN)",value:"TTN"},{label:"Umbilical Hernia",value:"UH"},{label:"Meningitis",value:"Mgts"},{label:"Ambiguous Genetalia",value:"AG"},{label:"Untreated Maternal Syphilis",value:"UMS"},{label:"Abdominal obstruction",value:"AbObs"},{label:"Risk factors for sepsis (Not symptomatic)",value:"Risk"},{label:"Birth Trauma",value:"BT"},{label:"Apnoea of prematurity",value:"Apn"},{label:"Birth Asphyxia",value:"BA"},{label:"Convulsions",value:"Conv"},{label:"Low Birth Weight (1500-2499g)",value:"LBW"},{label:"Very Low Birth Weight (1000-1499g)",value:"VLBW"},{label:"Extremely Low Birth Weight (<1000g)",value:"ExLBW"},{label:"High Birth Weight (>4000g at birth)",value:"HBW"},{label:"Mild Hypothermia",value:"MiHypo"},{label:"Moderate Hypothermia",value:"ModHypo"},{label:"Severe Hypothermia",value:"SHypo"},{label:"Hyperthermia",value:"Hyperth"},{label:"Premature (32-36 weeks)",value:"Prem"},{label:"Very Premature (28-31 weeks)",value:"VPrem"},{label:"Extremely Premature (<28 weeks)",value:"ExPrem"},{label:"Hypoglycaemia (symptomatic)",value:"HypogSy"},{label:"Hypoglycaemia (NOT symptomatic)",value:"HypogAs"},{label:"At Risk of Hypoglycaemia",value:"RiHypog"},{label:"HIV Unknown",value:"HIVU"},{label:"HIV Low Risk",value:"HIVLR"},{label:"HIV High Risk",value:"HIVHR"},{label:"Physiological Jaundice",value:"MJ"},{label:"Pathological Jaundice",value:"DJ"},{label:"Prolonged Jaundice",value:"PJaundice"},{label:"Hypoxic Ischaemic Encephalopathy",value:"HIE"},{label:"Suspected Hypoxic Ischaemic Encephalopathy",value:"sHIE"},{label:"Prematurity with Respiratory Distress",value:"PremRD"},{label:"Term baby with Respiratory Distress",value:"TermRD"},{label:"Gastroschisis",value:"GSchis"},{label:"Omphalocele",value:"Omph"},{label:"Cleft lip and/or palate with RD",value:"CleftRD"},{label:"Cleft lip",value:"CleftLip"},{label:"Cleft lip and/or palate",value:"CleftLipPalate"},{label:"Myelomeningocele",value:"Myelo"},{label:"Congenital dislocation of the hip (CDH)",value:"CDH"},{label:"Moderate Talipes (club foot)",value:"MoTalipes"},{label:"Mild Talipes (club foot)",value:"MiTalipes"}],n=w(()=>a.workingDiagnosis?f.filter(p=>{var r;return p.value!==((r=a.workingDiagnosis)==null?void 0:r.value)}):f),D=w(()=>{if(a.differentialDiagnoses.length===0)return f;const p=a.differentialDiagnoses.map(r=>r.value);return f.filter(r=>!p.includes(r.value))}),m=w({get:()=>a.workingDiagnosis,set:p=>{g.value=null,a.setWorkingDiagnosis(p)}}),k=w(()=>a.workingDiagnosis?[a.workingDiagnosis]:[]),s=()=>{a.setWorkingDiagnosis(null)},c=w({get:()=>a.differentialDiagnoses,set:p=>{g.value=null,a.setDifferentialDiagnoses(p)}}),R=w(()=>a.differentialDiagnoses),P=p=>{a.removeDifferentialDiagnosis(p)};function S(){const p=!!a.workingDiagnosis,r={};return p?(g.value=null,console.log("Validation Success: Diagnosis Selection passed.")):(g.value="A Primary Diagnosis (Working Diagnosis) is required to proceed to the next step.",r.primaryDiagnosisRequired=g.value,console.error("Validation Error: Primary Diagnosis is missing.")),Object.keys(r).length>0?r:null}return i({validateForm:S}),(p,r)=>(h(),v("div",Oe,[u("div",Ye,[r[3]||(r[3]=u("div",{class:"description-box"}," Select the diagnoses you think the baby has (you can select more than 1) ",-1)),r[4]||(r[4]=u("h3",{class:"diagnosis-section-title"},"Your Selected Working Diagnosis",-1)),A(N,{items:k.value,onRemoveItem:s},null,8,["items"]),(h(),G(re(y(o)),{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=b=>m.value=b),options:D.value,class:"multiselect-component"},{header:M(()=>[...r[2]||(r[2]=[H(" Primary Diagnosis (Select ONE) ",-1)])]),_:1},8,["modelValue","options"]))]),r[7]||(r[7]=u("hr",{class:"separator"},null,-1)),u("div",xe,[r[6]||(r[6]=u("h3",{class:"diagnosis-section-title"},"Your Selected Differential Diagnosis",-1)),A(N,{items:R.value,"is-differential":!0,onRemoveItem:P},null,8,["items"]),A(Ie,{modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=b=>c.value=b),options:n.value,class:"multiselect-component"},{header:M(()=>[...r[5]||(r[5]=[H(" Differential Diagnoses ",-1)])]),_:1},8,["modelValue","options"]),g.value?(h(),v("div",Ge,_(g.value),1)):C("",!0)])]))}}),Je=V(We,[["__scopeId","data-v-f467a363"]]),$=e=>e.RR>60||e.DangerSigns==="Grun"||e.DangerSigns==="Cyan"||e.SatsAIr<90||e.SatsO2<90||e.RespSR!==""||e.SignsRD!=="",Fe=e=>e.MecPresent==="Yes";function je(e){if(!e)return[];const i=[];e.EDLIZSummaryTableScore>.9&&i.push({label:"Suspected neonatal sepsis",value:"NSep",severity:1,details:"EDLIZ risk score of ".concat(e.EDLIZSummaryTableScore," is high, triggering the sepsis protocol.")}),$(e)&&Fe(e)&&i.push({label:"Possible Meconium Aspiration",value:"MA",severity:1,details:"Respiratory distress present with meconium risk factors. Requires urgent stabilization."}),(e.DangerSigns==="Conv"||e.SymptomReviewNeurology==="Convulsions"||e.Activity==="Convulsions"||e.AdmReason==="Convulsions")&&i.push({label:"Convulsions",value:"Conv",severity:1,details:"Convulsions have been observed on examination or reported in history."}),(e.BloodSugarmmol<2.5||e.BloodSugarmg<45)&&e.HypoSymptoms===!0&&i.push({label:"Hypoglycaemia (symptomatic)",value:"HypogSy",severity:1,details:"Blood sugar is low and the baby is showing symptoms."}),e.BirthWeight<1e3&&i.push({label:"Extremely Low Birth Weight (<1000g)",value:"ExLBW",severity:1,details:"Birth weight is critically low at ".concat(e.BirthWeight,"g.")}),e.Temperature<32&&i.push({label:"Severe Hypothermia",value:"SHypo",severity:1,details:"Baby's temperature is critically low (< 32.0Â°C)."}),e.Gestation<28&&i.push({label:"Extremely Premature (<28 weeks)",value:"ExPrem",severity:1,details:"Gestation is ".concat(e.Gestation," weeks, requiring immediate high-level care.")}),e.ThompScore>=11&&i.push({label:"Hypoxic Ischaemic Encephalopathy",value:"HIE",severity:1,details:"Thompson Score is ".concat(e.ThompScore," or higher, indicating severe encephalopathy.")}),e.Gestation<37&&$(e)&&i.push({label:"Prematurity with Respiratory Distress",value:"PremRD",severity:1,details:"Preterm infant (".concat(e.Gestation," weeks) showing signs of respiratory distress.")}),e.Gestation>=37&&$(e)&&i.push({label:"Term baby with Respiratory Distress",value:"TermRD",severity:1,details:"Term infant (".concat(e.Gestation," weeks) showing signs of respiratory distress.")}),e.Gestation<37&&e.RespSR==="Apn"&&i.push({label:"Apnoea of prematurity",value:"Apn",severity:2,details:"Apnoeic episodes observed in a premature infant."}),e.BirthWeight>999&&e.BirthWeight<1500&&i.push({label:"Very Low Birth Weight (1000-1499g)",value:"VLBW",severity:2,details:"Birth weight is between 1000g and 1499g."}),e.Temperature>31.9&&e.Temperature<36&&i.push({label:"Moderate Hypothermia",value:"ModHypo",severity:2,details:"Baby's temperature is low (32.0Â°C to 35.9Â°C)."}),e.Temperature>37.5&&i.push({label:"Hyperthermia",value:"Hyperth",severity:2,details:"Baby's temperature is high (> 37.5Â°C)."}),e.Gestation>31.9&&e.Gestation<36.1&&i.push({label:"Premature (32-36 weeks)",value:"Prem",severity:2,details:"Baby's gestation is ".concat(e.Gestation," weeks.")}),(e.BloodSugarmmol<2.5||e.BloodSugarmg<45)&&e.HypoSymptoms===!1&&i.push({label:"Hypoglycaemia (NOT symptomatic)",value:"HypogAs",severity:2,details:"Blood sugar is low, but baby is currently asymptomatic."}),e.ThompScore>0&&e.ThompScore<=10&&i.push({label:"Suspected Hypoxic Ischaemic Encephalopathy",value:"sHIE",severity:2,details:"Thompson Score is ".concat(e.ThompScore,", indicating suspected encephalopathy.")}),e.GSCvsOM==="GSCH"&&i.push({label:"Gastroschisis",value:"GSchis",severity:2,details:"Abdominal wall defect observed."}),e.GSCvsOM==="OMPH"&&i.push({label:"Omphalocele",value:"Omph",severity:2,details:"Abdominal wall defect observed."}),(e.Palate==="Lip"||e.Palate==="Cleft"||e.Palate==="LipPalate")&&$(e)&&i.push({label:"Cleft lip and/or palate with RD",value:"CleftRD",severity:2,details:"Cleft observed; respiratory distress suggests potential airway compromise."}),e.EDLIZSummaryTableScore>0&&e.EDLIZSummaryTableScore<=.9&&i.push({label:"Risk factors for sepsis (Not symptomatic)",value:"Risk",severity:3,details:"EDLIZ risk score of ".concat(e.EDLIZSummaryTableScore," indicates risk factors are present.")}),e.BirthWeight>1499&&e.BirthWeight<2500&&i.push({label:"Low Birth Weight (1500-2499g)",value:"LBW",severity:3,details:"Birth weight is between 1500g and 2499g."}),e.BirthWeight>4e3&&i.push({label:"High Birth Weight (>4000g at birth)",value:"HBW",severity:3,details:"Birth weight is greater than 4000g."}),e.Temperature>35.9&&e.Temperature<36.5&&i.push({label:"Mild Hypothermia",value:"MiHypo",severity:3,details:"Baby's temperature is slightly low (36.0Â°C to 36.4Â°C)."}),(e.BirthWeight<2500||e.BirthWeight>4e3||e.Gestation<37||e.PregConditions==="DM"||e.ANSteroids==="Y"||e.AdmReason==="NE")&&i.push({label:"At Risk of Hypoglycaemia",value:"RiHypog",severity:3,details:"Risk factors like low birth weight, prematurity, or maternal diabetes present."});const g=e.MatHIVtest===!1,l=e.MatHIVtest===!0&&(e.HIVtestResult==="R"||e.HIVtestResult==="U")&&(e.LengthHAART==="1stTrim"||e.LengthHAART==="2ndTrim"||e.LengthHAART==="3rdTrim"),f=e.MatHIVtest===!0&&(e.HIVtestResult==="R"||e.HIVtestResult==="U")&&(e.HAART==="N"||e.LengthHAART==="Late");g&&i.push({label:"HIV Unknown",value:"HIVU",severity:3,details:"Maternal HIV status is unknown or untested."}),l&&i.push({label:"HIV Low Risk",value:"HIVLR",severity:3,details:"Maternal HIV reactive/unknown, but HAART started early."}),f&&i.push({label:"HIV High Risk",value:"HIVHR",severity:3,details:"Maternal HIV reactive/unknown, with no/late HAART."}),e.Palate==="Lip"&&i.push({label:"Cleft lip",value:"CleftLip",severity:3,details:"Cleft lip observed."}),e.Palate==="Cleft"&&i.push({label:"Cleft lip and/or palate",value:"CleftLipPalate",severity:3,details:"Cleft palate/lip and palate observed."}),e.Spine==="NTD"&&i.push({label:"Myelomeningocele",value:"Myelo",severity:3,details:"Neural Tube Defect (NTD) observed on the spine or head."});const n=e.YColour==="Y"&&e.Age<24||e.YColour==="Y"&&e.Age>=24&&(e.Age<336&&e.Gestation>36.6||e.Age<504&&e.Gestation<37)&&(e.Jaundice==="DJ"||e.Temperature>37||e.BirthWeight<2500||e.Colour==="White");return n&&i.push({label:"Pathological Jaundice",value:"DJ",severity:4,details:"Jaundice with signs of pathology (early onset, deep jaundice, or risk factors)."}),e.Jaundice==="MJ"&&e.Age>24&&(e.Gestation>36.6&&e.Age<336||e.Gestation<37&&e.Age<504)&&!n&&i.push({label:"Physiological Jaundice",value:"MJ",severity:5,details:"Common, non-pathological jaundice (appears > 24 hours, no danger signs)."}),e.YColour==="Y"&&(e.Age>336&&e.Gestation>36.9||e.Age>504&&e.Gestation<36.6)&&i.push({label:"Prolonged Jaundice",value:"PJaundice",severity:5,details:"Jaundice persisting beyond 14 days term or >21 days preterm infants."}),(e.Presentation==="Breech"||e.MatComorbidities==="CDH"||e.MSKproblems==="Legs"||e.Skin==="Folds"||e.Ortolani==="Yes")&&i.push({label:"Congenital dislocation of the hip (CDH)",value:"CDH",severity:6,details:"Risk factors (e.g., breech) or positive Ortolani/Barlow test."}),e.TalipesSev==="No"&&i.push({label:"Moderate Talipes (club foot)",value:"MoTalipes",severity:7,details:"Foot held in abnormal position and cannot be passively corrected."}),e.TalipesSev==="Yes"&&i.push({label:"Mild Talipes (club foot)",value:"MiTalipes",severity:8,details:"Foot held in abnormal position and CAN be passively corrected."}),i.sort((c,R)=>c.severity-R.severity),i.filter((c,R,P)=>R===P.findIndex(S=>S.value===c.value))}function Ue(e){console.log("we here",e.value);const i=L(),o=I([]),a=w(()=>je(e.value)),d=w(()=>a.value.filter(s=>{const c=i.differentialDiagnoses.some(P=>P.value===s.value),R=o.value.some(P=>P.value===s.value);return!c&&!R})),t=s=>{i.addDifferentialDiagnosis({label:s.label,value:s.value})},g=s=>{o.value.push(s)},l=s=>{o.value=o.value.filter(c=>c.value!==s.value)},f=()=>{o.value=[]},n=s=>o.value.some(c=>c.value===s),D=s=>d.value.some(c=>c.value===s),m=w(()=>d.value.length),k=w(()=>o.value.length);return{suggestedDiagnoses:d,rejectedDiagnoses:o,allSuggestions:a,suggestionCount:m,rejectedCount:k,acceptSuggestion:t,rejectSuggestion:g,undoReject:l,clearRejections:f,isRejected:n,isSuggested:D}}const qe=Z("suggestedDiagnosisStore",{state:()=>({patientData:{}}),actions:{setPatientData(){var k;const i=he().formData;i.temperature&&(this.patientData.Temperature=i.temperature),i.blood_sugar&&(this.patientData.BloodSugarmg=i.blood_sugar),i.respiratory_rate&&(this.patientData.RR=i.respiratory_rate),i.oxygen_saturation&&(this.patientData.SatsAIr=i.oxygen_saturation);const a=de().formValues;a.oxygen_saturation&&(this.patientData.SatsAIr=a.oxygen_saturation),a.respiratory_rate&&(this.patientData.RR=a.respiratory_rate),a.temperature&&(this.patientData.Temperature=a.temperature),a.birth_weight&&(this.patientData.BirthWeight=a.birth_weight),a.admission_weight&&(this.patientData.AdmissionWeight=a.admission_weight),a.saturation_in_oxygen&&(this.patientData.SatsO2=a.saturation_in_oxygen),a.convulsions&&(this.patientData.DangerSigns="Conv"),a.central_cyanosis&&(this.patientData.DangerSigns="Cyan"),a.blood_sugar&&(a.bloodSugar_unit==="mmol/L"?this.patientData.BloodSugarmmol=a.blood_sugar:this.patientData.BloodSugarmg=a.blood_sugar);const t=fe().formData;t.convulsions==="Yes"&&(this.patientData.Activity="Convulsions",this.patientData.SymptomReviewNeurology="Convulsions"),t.jaundice==="Yes"&&(this.patientData.Jaundice="MJ",this.patientData.YColour="Y"),t.baby_grunting==="Yes"&&(this.patientData.SignsRD="GR",this.patientData.DangerSigns="Grun"),t.nasal_flaring==="Yes"&&(this.patientData.SignsRD="NFL"),t.cyanosis==="Yes"&&(this.patientData.DangerSigns="Cyan"),t.gasping==="Yes"&&(this.patientData.SignsRD="Gasp"),t.difficulty_breathing==="Yes"&&(this.patientData.RespSR="DIB"),(t.color_of_stools==="White"||t.color_of_stools==="Clay-colored"||t.color_of_stools==="Pale")&&(this.patientData.Colour="White",this.patientData.Jaundice="DJ"),t.vomiting==="Yes"||t.is_baby_vomiting,t.vomiting_bile_stained==="Yes"||t.color_of_vomit==="Green"||t.color_of_vomit,(t.talipes==="Yes"||t.club_foot==="Yes")&&(this.patientData.TalipesSev="Yes"),t.spinal_bifida==="Yes"&&(this.patientData.Spine="NTD"),(t.skin_rash==="Yes"||t.pustules==="Yes"||t.peeling==="Yes")&&(this.patientData.Skin=t.skin_rash||t.pustules||t.peeling||""),t.activity&&(t.activity.toLowerCase().includes("convuls")||t.activity.toLowerCase().includes("seizure"))&&(this.patientData.Activity="Convulsions"),t.is_baby_passing_urine==="No"||t.number_of_wet_nappies==="0"||t.hydration_urination,(t.passage_of_meconium==="Yes"||t.stool_passed_meconium==="Yes")&&(this.patientData.MecPresent="Yes"),t.abdominal_distension,t.bleeding==="Yes"||t.blood_in_stools,t.does_baby_have_tongue_tie;const l=ve();if(l.activityAssessment){const s=l.activityAssessment.toLowerCase();(s.includes("convuls")||s.includes("seizure")||s.includes("fitting"))&&(this.patientData.Activity="Convulsions",this.patientData.DangerSigns="Conv")}if(l.isBabyYellow===!0&&(this.patientData.YColour="Y",this.patientData.Jaundice||(this.patientData.Jaundice="MJ")),l.hasBabyCyanosis===!0&&(this.patientData.DangerSigns="Cyan"),l.isBabyPallorPink,l.hasBabyOedema,l.fontanelleAssessment){const s=l.fontanelleAssessment.toLowerCase();s.includes("bulging")||s.includes("tense"),s.includes("sunken")||s.includes("depressed")}if(l.massInHeadAssessment){const s=l.massInHeadAssessment.toLowerCase();s.includes("caput")||s.includes("cephalohematoma")||s.includes("subgaleal")}if(l.hasCardiacAbnormality,l.heartSoundsAssessment&&l.heartSoundsAssessment.toLowerCase().includes("murmur"),l.capillaryRefillTime){const s=l.capillaryRefillTime.toLowerCase();s.includes("prolonged")||s.includes(">3")||s.includes("delayed")}if(l.femoralPulses){const s=l.femoralPulses.toLowerCase();s.includes("absent")||s.includes("weak")||s.includes("decreased")}if(l.hasCleftLip===!0&&l.hasCleftPalate===!0)this.patientData.Palate="LipPalate";else if(l.hasCleftLip===!0)this.patientData.Palate="Lip";else if(l.hasCleftPalate===!0)this.patientData.Palate="Cleft";else if(l.cleftAssessment){const s=l.cleftAssessment.toLowerCase();s.includes("lip")&&s.includes("palate")?this.patientData.Palate="LipPalate":s.includes("lip")?this.patientData.Palate="Lip":s.includes("palate")&&(this.patientData.Palate="Cleft")}if(l.genitaliaAssessment){const s=l.genitaliaAssessment.toLowerCase();s.includes("ambiguous")&&(this.patientData.MSKproblems?this.patientData.MSKproblems+="; Ambiguous genitalia":this.patientData.MSKproblems="Ambiguous genitalia"),s.includes("hypospadias")||s.includes("undescended")}if(l.anusAssessment){const s=l.anusAssessment.toLowerCase();s.includes("imperforate")||s.includes("absent")||s.includes("atresia")}if(l.hasMeconiumPassed===!0||l.hasMeconiumPassed,l.hasCongenitalAbnormalities===!0&&l.abnormalitiesNotes){const s=l.abnormalitiesNotes.toLowerCase();s.includes("gastroschisis")?this.patientData.GSCvsOM="GSCH":(s.includes("omphalocele")||s.includes("omphalo"))&&(this.patientData.GSCvsOM="OMPH"),(s.includes("spina bifida")||s.includes("myelomeningocele")||s.includes("meningocele"))&&(this.patientData.Spine="NTD"),(s.includes("talipes")||s.includes("club foot")||s.includes("clubfoot"))&&(this.patientData.TalipesSev="Yes"),(s.includes("skin")||s.includes("nevus")||s.includes("birthmark"))&&(this.patientData.Skin=l.abnormalitiesNotes),(s.includes("limb")||s.includes("digit")||s.includes("polydactyly")||s.includes("syndactyly"))&&(this.patientData.MSKproblems=l.abnormalitiesNotes)}const n=ye().formData;if(n.grunting===!0&&(this.patientData.SignsRD="GR",this.patientData.DangerSigns="Grun"),n.nasalFlaring===!0&&(this.patientData.SignsRD="NFL"),n.chestIndrawing===!0&&(this.patientData.SignsRD="CHI"),n.stridor===!0&&(this.patientData.SignsRD="ST"),n.gasping===!0&&(this.patientData.SignsRD="Gasp"),(n.respiratoryDistress==="Yes"||n.respiratoryDistress==="Severe")&&(this.patientData.RespSR="DIB"),n.colorBlue===!0&&(this.patientData.DangerSigns="Cyan"),n.colorYellow===!0&&(this.patientData.YColour="Y",this.patientData.Jaundice||(this.patientData.Jaundice="MJ")),n.colorPale,n.crt3OrMore,n.femoralPulseWeak===!0||n.femoralPulseDifficult,n.murmurExtraSounds,n.abdomenWallDefect===!0&&n.abdomenSummaryNotes){const s=n.abdomenSummaryNotes.toLowerCase();s.includes("gastroschisis")?this.patientData.GSCvsOM="GSCH":(s.includes("omphalocele")||s.includes("omphalo"))&&(this.patientData.GSCvsOM="OMPH")}if(n.pruneBellySyndrome,n.abdomenDistended,n.hepatomegaly,n.splenomegaly,n.umbilicusBleeding===!0||n.umbilicusRedSkin,n.umbilicalHernia,n.genitaliaAmbiguous===!0&&(this.patientData.MSKproblems?this.patientData.MSKproblems+="; Ambiguous genitalia":this.patientData.MSKproblems="Ambiguous genitalia"),n.genitaliaMaleAbnormal===!0||n.genitaliaFemaleAbnormal,n.anusImperforate,n.toneAssessment){const s=n.toneAssessment.toLowerCase();s.includes("hypotonic")||s.includes("floppy")||s.includes("decreased"),s.includes("hypertonic")||s.includes("increased")||s.includes("rigid")}if(n.suckReflex==="Absent"||n.suckReflex,n.MoreReflex==="Absent"||n.MoreReflex,n.birthAsphyxiaSuspected==="Yes"){const s={thompsonRespirationScore:parseInt(n.thompsonRespirationScore||"0"),thompsonSuckScore:parseInt(n.thompsonSuckScore||"0"),thompsonMoroScore:parseInt(n.thompsonMoroScore||"0"),thompsonGraspScore:parseInt(n.thompsonGraspScore||"0"),thompsonFontanelleScore:parseInt(n.thompsonFontanelleScore||"0"),thompsonToneScore:parseInt(n.thompsonToneScore||"0"),thompsonConsciousnessScore:parseInt(n.thompsonConsciousnessScore||"0"),thompsonFitsScore:parseInt(n.thompsonFitsScore||"0"),thompsonPostureScore:parseInt(n.thompsonPostureScore||"0")};this.patientData.ThompScore=s.thompsonRespirationScore+s.thompsonSuckScore+s.thompsonMoroScore+s.thompsonGraspScore+s.thompsonFontanelleScore+s.thompsonToneScore+s.thompsonConsciousnessScore+s.thompsonFitsScore+s.thompsonPostureScore,this.patientData.ThompScore>=6&&(this.patientData.AdmReason="NE")}n.musculoskeletalDeformities&&n.musculoskeletalDeformities.length>0&&n.musculoskeletalDeformities.forEach(s=>{const c=s.toLowerCase();(c.includes("talipes")||c.includes("club foot")||c.includes("clubfoot"))&&(c.includes("correctable")||c.includes("mild")||c.includes("flexible")?this.patientData.TalipesSev="Yes":c.includes("rigid")||c.includes("severe")||c.includes("fixed")?this.patientData.TalipesSev="No":this.patientData.TalipesSev="Yes"),(c.includes("spina bifida")||c.includes("myelomeningocele")||c.includes("meningocele")||c.includes("neural tube"))&&(this.patientData.Spine="NTD"),c.includes("hip")&&(c.includes("clunk")||c.includes("disloc"))&&(this.patientData.Ortolani="Yes"),(c.includes("limb")||c.includes("digit")||c.includes("polydactyly")||c.includes("syndactyly")||c.includes("fracture")||c.includes("erb")||c.includes("brachial plexus"))&&(this.patientData.MSKproblems?this.patientData.MSKproblems+="; ".concat(s):this.patientData.MSKproblems=s)}),n.skinFindings&&n.skinFindings.length>0&&(this.patientData.Skin=n.skinFindings.join("; ")),n.unequalAirEntry===!0||n.unilateralCrackles,n.bilateralCracklesWheeze;const m=De().formData;if(m.presenting_complaints&&m.presenting_complaints.length>0&&m.presenting_complaints.forEach(s=>{var c;switch(s){case"convulsions":this.patientData.Activity="Convulsions",this.patientData.SymptomReviewNeurology="Convulsions",this.patientData.DangerSigns="Conv",this.patientData.AdmReason="Convulsions";break;case"cyanosis":this.patientData.DangerSigns="Cyan";break;case"jaundice":this.patientData.YColour="Y",this.patientData.Jaundice||(this.patientData.Jaundice="MJ"),(c=m.symptom_severity)!=null&&c.toLowerCase().includes("severe")&&(this.patientData.Jaundice="DJ");break;case"apnoea":this.patientData.RespSR="Apn";break;case"difficulty_breathing":this.patientData.RespSR="DIB";break;case"fever":break;case"hypothermia":break;case"lethargy":(!this.patientData.Activity||this.patientData.Activity!=="Convulsions")&&(this.patientData.Activity="Lethargy");break;case"irritability":(!this.patientData.Activity||this.patientData.Activity!=="Convulsions")&&(this.patientData.Activity="Irritable");break;case"poor_feeding":case"not_tolerating_feeds":break;case"vomiting":break;case"abdominal_distension":break;case"diarrhoea":break;case"umbilical_discharge":break;case"eye_discharge":break;case"skin_rash":this.patientData.Skin?this.patientData.Skin+="; Rash noted on presentation":this.patientData.Skin="Rash noted on presentation";break;case"bleeding":break;case"pallor":break;default:console.warn("Unhandled presenting complaint: ".concat(s));break}}),m.detailed_assessment_notes){const s=m.detailed_assessment_notes.toLowerCase();(s.includes("orange")||s.includes("deep yellow"))&&this.patientData.Jaundice,(s.includes("bile")||s.includes("green")||s.includes("bilious"))&&((k=m.presenting_complaints)!=null&&k.includes("vomiting")),s.includes("status epilepticus")||s.includes("continuous"),s.includes("grunting")&&!this.patientData.SignsRD&&(this.patientData.SignsRD="GR",this.patientData.DangerSigns="Grun"),s.includes("nasal flaring")&&!this.patientData.SignsRD&&(this.patientData.SignsRD="NFL"),s.includes("chest indrawing")&&!this.patientData.SignsRD&&(this.patientData.SignsRD="CHI"),(s.includes("maternal diabetes")||s.includes("diabetic mother"))&&(this.patientData.PregConditions="DM"),(s.includes("maternal hiv")||s.includes("hiv positive mother"))&&(this.patientData.MatHIVtest=!0,this.patientData.HIVtestResult="R"),s.includes("prom")||s.includes("prolonged rupture"),s.includes("meconium")&&s.includes("stained")&&(this.patientData.MecPresent="Yes"),(s.includes("birth asphyxia")||s.includes("poor apgar")||s.includes("resuscitation"))&&(this.patientData.AdmReason="NE"),s.includes("gastroschisis")&&(this.patientData.GSCvsOM="GSCH"),s.includes("omphalocele")&&(this.patientData.GSCvsOM="OMPH"),(s.includes("spina bifida")||s.includes("myelomeningocele"))&&(this.patientData.Spine="NTD"),(s.includes("talipes")||s.includes("club foot"))&&(this.patientData.TalipesSev="Yes"),s.includes("cleft lip")?s.includes("palate")?this.patientData.Palate="LipPalate":this.patientData.Palate="Lip":s.includes("cleft palate")&&(this.patientData.Palate="Cleft")}if(m.symptom_onset_time){const s=m.symptom_onset_time.toLowerCase();s.includes("birth")||s.includes("delivery")||s.includes("immediately")}if(m.symptom_severity){const s=m.symptom_severity.toLowerCase();(s.includes("severe")||s.includes("critical"))&&this.patientData.Jaundice==="MJ"&&(this.patientData.Jaundice="DJ"),s.includes("mild"),s.includes("moderate")}m.is_readmission},resetPatientData(){this.patientData={}}},persist:!0}),Ke={class:"systems-suggestions-panel"},ze={class:"diagnosis-section"},Ze={class:"diagnosis-section"},Qe={key:0,class:"validation-error"},Xe={class:"suggestion-instruction"},es={key:0,class:"pending-review-notice"},ss={class:"suggested-diagnosis-section"},is={class:"suggested-title"},ts={key:0,class:"suggestion-count-badge"},as={key:0,class:"empty-suggestions"},ns=["onClick","aria-label","onKeydown"],os={class:"suggestion-content"},ls={class:"suggestion-label"},rs={class:"suggestion-details"},us=["onClick","title","aria-label"],cs={key:0,class:"rejected-diagnosis-section"},ps={class:"rejected-content"},ds={class:"rejected-label"},gs={class:"rejected-details"},ms=["onClick","title","aria-label"],hs=T({__name:"SystemsSuggestions",setup(e,{expose:i}){const o=L(),a=qe();a.resetPatientData(),a.setPatientData();const d=w(()=>a.patientData);I({Gestation:30.5,BirthWeight:1200,AdmissionWeight:1200,Age:5,Temperature:31.5,RR:65,SatsAIr:95,SatsO2:98,DangerSigns:"Cyan",SignsRD:"GR",RespSR:"",SymptomReviewNeurology:"",Activity:"",AdmReason:"",EDLIZSummaryTableScore:.95,BloodSugarmmol:2,BloodSugarmg:36,HypoSymptoms:!0,PregConditions:"",ANSteroids:"N",ThompScore:0,Jaundice:"",YColour:"N",Colour:"",GSCvsOM:"",Palate:"",Spine:"",Presentation:"",MatComorbidities:"",MSKproblems:"",Skin:"",Ortolani:"No",TalipesSev:"",MecPresent:"No",MatHIVtest:!0,HIVtestResult:"N",HAART:"N",LengthHAART:""});const{suggestedDiagnoses:t,rejectedDiagnoses:g,acceptSuggestion:l,rejectSuggestion:f,undoReject:n}=Ue(d),D=I(null),m=w(()=>o.workingDiagnosis?[o.workingDiagnosis]:[]),k=()=>{o.setWorkingDiagnosis(null),D.value=null},s=S=>{o.removeDifferentialDiagnosis(S),D.value=null},c=S=>{o.setDifferentialDiagnoses(S),D.value=null},R=S=>{l(S),D.value=null};function P(){const S={};if(!!!o.workingDiagnosis){const b="A Primary Diagnosis (Working Diagnosis) must be confirmed before reviewing and submitting the final diagnosis.";D.value=b,S.primaryDiagnosisRequired=b,console.error("Validation Error: Primary Diagnosis removed or missing at review stage.")}if(t.value.length>0){const b=t.value.length,X=t.value.map(ee=>ee.label).join(", "),W="You have ".concat(b," unreviewed suggestion").concat(b>1?"s":"",": ").concat(X,". Please either add ").concat(b>1?"them":"it"," to your differential diagnosis or reject ").concat(b>1?"them":"it"," before proceeding.");D.value=W,S.unreviewedSuggestions=W,console.error("Validation Error: ".concat(b," unreviewed suggestion(s) remaining."),t.value)}return Object.keys(S).length===0&&(D.value=null,console.log("Validation Success: All suggestions reviewed and working diagnosis confirmed.")),Object.keys(S).length>0?S:null}return i({validateForm:P}),(S,p)=>(h(),v("div",Ke,[u("div",ze,[p[0]||(p[0]=u("h3",{class:"diagnosis-section-title"},"Your Selected Working Diagnosis",-1)),A(N,{items:m.value,"allow-dragging":!1,onRemoveItem:k},null,8,["items"])]),u("div",Ze,[p[1]||(p[1]=u("h3",{class:"diagnosis-section-title"},"Your Selected Differential Diagnosis",-1)),A(N,{items:y(o).differentialDiagnoses,"is-differential":!0,"allow-dragging":!0,onRemoveItem:s,"onUpdate:items":c},null,8,["items"]),D.value?(h(),v("div",Qe,_(D.value),1)):C("",!0)]),u("p",Xe,[p[2]||(p[2]=H(" Please consider the suggested diagnoses below. ",-1)),p[3]||(p[3]=u("strong",null,"Click on a suggestion to add it to your differential diagnosis",-1)),p[4]||(p[4]=H(", or click the âŒ button to reject it. ",-1)),y(t).length>0?(h(),v("span",es," âš ï¸ You must review all "+_(y(t).length)+" suggestion(s) before proceeding. ",1)):C("",!0)]),u("div",ss,[u("h3",is,[p[5]||(p[5]=H(" Suggested Diagnosis ",-1)),y(t).length>0?(h(),v("span",ts,_(y(t).length)+" pending ",1)):C("",!0)]),y(t).length===0?(h(),v("div",as,[...p[6]||(p[6]=[u("p",null,"âœ“ All suggestions have been reviewed",-1)])])):C("",!0),(h(!0),v(Y,null,x(y(t),r=>(h(),v("div",{key:r.value,class:"suggestion-item",onClick:b=>R(r),role:"button",tabindex:"0","aria-label":"Add ".concat(r.label," to differential diagnosis"),onKeydown:[F(b=>R(r),["enter"]),F(j(b=>R(r),["prevent"]),["space"])]},[u("div",os,[u("p",ls,[p[7]||(p[7]=u("span",{class:"add-indicator"},"+",-1)),H(" "+_(r.label),1)]),u("p",rs,_(r.details),1)]),u("button",{onClick:j(b=>y(f)(r),["stop"]),class:"suggestion-action-button reject-button",title:"Reject ".concat(r.label),"aria-label":"Reject ".concat(r.label)},[...p[8]||(p[8]=[u("span",{class:"cross-icon"},"âŒ",-1)])],8,us)],40,ns))),128))]),y(g).length>0?(h(),v("div",cs,[p[10]||(p[10]=u("h3",{class:"rejected-title"},"Rejected Diagnosis",-1)),(h(!0),v(Y,null,x(y(g),r=>(h(),v("div",{key:r.value,class:"rejected-item"},[u("div",ps,[u("p",ds,_(r.label),1),u("p",gs,_(r.details),1)]),u("button",{onClick:b=>y(n)(r),class:"suggestion-action-button undo-button",title:"Restore ".concat(r.label),"aria-label":"Restore ".concat(r.label," to suggestions")},[...p[9]||(p[9]=[u("span",{class:"undo-icon"},"â†»",-1)])],8,ms)]))),128))])):C("",!0)]))}}),fs=V(hs,[["__scopeId","data-v-61bed52f"]]),vs={class:"diagnosis-summary-panel"},ys={class:"summary-section"},Ds={class:"diagnosis-list"},bs={class:"diagnosis-item primary-item"},Ss={class:"summary-section"},_s={class:"diagnosis-list"},ws={key:0,class:"no-data-item"},ks=T({__name:"DiagnosisSummary",setup(e){const i=L(),o=w(()=>{var d;return((d=i.workingDiagnosis)==null?void 0:d.label)||"(None selected)"}),a=w(()=>i.differentialDiagnoses);return(d,t)=>(h(),v("div",vs,[u("div",ys,[t[0]||(t[0]=u("h2",{class:"section-title"},"Primary Diagnosis",-1)),u("div",Ds,[u("p",bs,_(o.value),1)])]),u("div",Ss,[t[1]||(t[1]=u("h2",{class:"section-title"},"Differential Diagnosis",-1)),u("div",_s,[(h(!0),v(Y,null,x(a.value,g=>(h(),v("p",{key:g.value,class:"diagnosis-item differential-item"},_(g.label),1))),128)),a.value.length?C("",!0):(h(),v("p",ws," (None selected) "))])])]))}}),Cs=V(ks,[["__scopeId","data-v-60387580"]]);class Rs extends q{constructor(i,o){super(i,41,o)}}class As extends q{constructor(o,a){super(o,41,a);B(this,"diagnosis_service");B(this,"computeParentObservation",async o=>({tag:o,obs:await this.diagnosis_service.buildValueCoded(o,o)}));B(this,"childObservation",async o=>await this.diagnosis_service.buildValueCoded(o,o));this.diagnosis_service=new Rs(o,a)}async ensureEncounterExists(){if(this.encounterID)return;const o=await this.diagnosis_service.createEncounter();if(!o)throw new Error("Failed to create encounter");if(this.encounterID=o.encounter_id,o.patient_id!==this.patientID)throw new Error("Encounter created for the wrong patient! Context inconsistency detected.")}async onSubmit(o){await this.ensureEncounterExists(),this.saveObservationList(o)}}const Ps=async e=>{try{const i=L();if(!i.workingDiagnosis)throw O("Diagnosis is required"),new Error("Diagnosis is required");const a={primaryDiagnosisObservation:await e.computeParentObservation("Primary diagnosis")},d=await e.childObservation(i.workingDiagnosis.value);if(!d)throw O("Primary diagnosis observations are required"),new Error("Primary diagnosis observations are required");d&&(a.primaryDiagnosisObservation.obs.child=[d]),await e.onSubmit([a.primaryDiagnosisObservation.obs]),i.setWorkingDiagnosis(null),console.log("PrimaryDiagnosisData",a)}catch(i){throw i}},Hs=async e=>{try{const i=L(),a={secondaryDiagnosisObservation:await e.computeParentObservation("Secondary diagnosis")},d=i.differentialDiagnoses.map(async g=>await e.childObservation(g.value)),t=await Promise.all(d);if(t.length>0)a.secondaryDiagnosisObservation.obs.child=t;else{console.log("No secondary diagnoses to save.");return}await e.onSubmit([a.secondaryDiagnosisObservation.obs]),i.setDifferentialDiagnoses([]),console.log("SecondaryDiagnosisData",a)}catch(i){throw i}},Ms=async()=>{try{const e=U(),{patient:i}=Q(e),o=te(),a=new As(i.value.patientID,o.user_ID);await Promise.all([Ps(a),Hs(a)]),console.log("SUCCESS: All Diagnosis sections saved successfully!"),ae("Diagnosis saved successfully")}catch(e){console.error("FAILED to save diagnosis:",e),O("Failed to save diagnosis. Please try again.")}},Fs=T({__name:"Diagnosis",setup(e){const i=I("1"),o=ue(),a=[{title:"Diagnosis",value:"1",component:Je},{title:"Systems Suggestions",value:"2",component:fs},{title:"Summary",value:"3",component:Cs}],d=I(a.map((l,f)=>({title:l.title,number:f+1,checked:!1,class:f===0?"open_step common_step":"common_step",last_step:f===a.length-1?"last_step":""}))),t=l=>{l&&l.value&&d.value.forEach((f,n)=>{l.value===(n+1).toString()?(f.class="open_step common_step",f.checked=!1):n<parseInt(l.value)-1?(f.class="common_step color_white",f.checked=!0):(f.class="common_step",f.checked=!1)})},g=l=>{const f=a.length-1;return l===f?async()=>{await Ms(),o.push("/neonatal/checkpoint")}:()=>Promise.resolve()};return(l,f)=>(h(),G(y(pe),{class:"neonatal-enrollment-page"},{default:M(()=>[A(ne),A(y(ce),{fullscreen:!0},{default:M(()=>[A(ge,{wizardData:d.value,StepperData:a,stepperTitle:"General Examination",openStepper:i.value,backUrl:"/patientProfile",getSaveFunction:g,onUpdateStatus:t,"flow-type":"enrollment","show-componet-title":!0},null,8,["wizardData","openStepper"])]),_:1})]),_:1}))}});export{Fs as default};
