System.register(["./vendor-legacy-DiKnuFk3.js","../index-legacy-8OuuotwM.js","./DemographicBar-legacy-CzEtFaiO.js","./nonPharmaTherapyStore-legacy-B8I7bTCU.js","./ComplicationsStore-legacy-DlHVl64s.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-CXz9IwJF.js","./usePatientProfile-legacy-CcUSsjAT.js","./apexcharts-legacy-OrDB9Kfl.js","./drug_prescription_service-legacy-D4qbuvDk.js","./patient_diagnosis_service-legacy-DBfFzIkg.js","./Registration-legacy-ZdvJme4q.js","./useLocation-legacy-CAP2fHlW.js","./vaccines_service-legacy-Gga7wv6U.js","./sms_service-legacy-DoshwECO.js","./EIRreportsStore-legacy-BXKNwSb9.js","./Export-legacy-C-tm2945.js","./user_role_management-legacy-CipdEksX.js","./useNeonatalEnrollmentStore-legacy-BYCoHHOa.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-D4mY5587.js","./wardsStore-legacy-BWAHEFIc.js"],function(e,t){"use strict";var i,a,n,l,s,o,r,c,u,g,v,d,y,m,f,p,S,h,D,H,P,b,w,x,I,_,R,M,C,j,A,E,F,O,T,k,L,N,B,z,V,$,J,U,W,G,K,Q,Z,q,X,Y,ee,te,ie,ae,ne,le;return{setters:[e=>{i=e.d,a=e.ap,n=e.cp,l=e.r,s=e.c,o=e.b2,r=e.w,c=e.a,u=e.H,g=e.O,v=e.f,d=e.J,y=e.l,m=e.u,f=e.a4,p=e.k,S=e.m,h=e.i,D=e.bM,H=e.v,P=e.a7,b=e.ba},e=>{w=e.aJ,x=e.u,I=e.aK,_=e.aL,R=e.aM,M=e.aN,C=e.d,j=e.aO,A=e.g,E=e.$,F=e.e,O=e.T,T=e.J,k=e.N,L=e.H,N=e.aP,B=e.aQ,z=e.aR,V=e.aS,$=e.t,J=e.af,U=e.G,W=e.aV,G=e.a1,K=e.S},e=>{Q=e.D},e=>{Z=e.u,q=e._,X=e.s,Y=e.c,ee=e.a},e=>{te=e.u},e=>{ie=e.l},e=>{ae=e.a,ne=e.b},e=>{le=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const t={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},se={class:"back_profile"};e("default",i({__name:"MedicalAdmission",setup(e,{expose:i}){const{onTabBeforeChange:oe,currentTabIndex:re}=Z();le();const ce=a(),ue=n();l([]),l([]),l(!1);const ge=l(!0),ve=l(!1),de=l(!1),ye=s(()=>({text:de.value?"Saving...":"Finish",icon:de.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:ve.value||de.value})),me=w(),fe=x(),pe=I(),Se=_();R();const he=M(),De=C();j();const He=A(),Pe=te(),be=E(),{patient:we}=o(fe),{vitals:xe}=o(me),{investigations:Ie}=o(pe),{diagnosis:_e}=o(Se),{substance:Re}=o(He),{selectedNCDMedicationList:Me}=o(he),{FootScreening:Ce,visualScreening:je,cvScreening:Ae}=o(Pe),{sessionDate:Ee}=o(be),{apiStatus:Fe}=o(F());r(ye,(e,t)=>{console.log("Done button options changed:",{from:t,to:e,currentStep:re.value,tabsLength:ke.value.length}),e.disabled!==(null==t?void 0:t.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==t?void 0:t.text)&&console.log(`Done button text changed from "${null==t?void 0:t.text}" to "${e.text}"`)},{deep:!0}),r(de,(e,t)=>{e!==t&&(console.log(`Saving state changed: ${t} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Oe=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Te=()=>{let e=!1;return Be(),de.value&&(e=!0),ve.value=e,!e},ke=l([{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]),Le=l(null),Ne=l(null),Be=()=>{var e;if(!ke.value||0===ke.value.length)return console.log("Tabs not yet initialized"),null;const t=re.value>=0&&re.value<ke.value.length?re.value:0;switch(null===(e=ke.value[t])||void 0===e?void 0:e.title){case"Presenting Complaints":return"Presenting Complaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan";default:if(De.NCDActivities.length>0)switch(De.NCDActivities[0]){case"Presenting Complaints":return"PresentingComplaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan"}return null}},ze=()=>{ge.value=!1,setTimeout(()=>{re.value=0,ge.value=!0},0)},Ve=()=>{const e=w();e.setVitals(e.getInitialVitals(we.value.ID))},$e=async()=>{const e=k(Ee.value,"sessionDate","value")||L.sessionDate(),t=N("vitals");for(let a=0;a<ke.value.length;a++){const n=ke.value[a];if("Vital Signs"===n.title)ke.value[a].icon=Je(e,t)?b:"";else if("Risk Assessment"===n.title){const t=N("substanceAbuse");ke.value[a].icon=Je(e,t)?b:""}else if("Investigations"===n.title){var i;const t=null==we||null===(i=we.value)||void 0===i||null===(i=i.labOrders)||void 0===i?void 0:i.saved,n=null==t?void 0:t.filter(t=>L.toStandardHisFormat(e)===L.toStandardHisFormat(t.order_date));ke.value[a].icon=(null==n?void 0:n.length)>0?b:""}else if("Diagnosis"===n.title){const t=N("diagnosis");ke.value[a].icon=Je(e,t)?b:""}else if("Complications Screening"===n.title){const t=N("screening");ke.value[a].icon=Je(e,t)?b:""}else"Treatment Plan"===n.title&&(Me.value.length>0?ke.value[a].icon=B()?b:"":ke.value[a].icon="")}Te()},Je=(e,t)=>{const i=new Date(e);return i.setHours(0,0,0,0),t.some(e=>{const t=new Date(e.obs_datetime);return t.setHours(0,0,0,0),t.getTime()===i.getTime()})},Ue=async(e,t)=>{var i;const a=null===(i=ke.value[t])||void 0===i?void 0:i.title;var n,l;e%1==0&&(re.value=e),"Vital Signs"==a&&(null===(n=Le.value)||void 0===n||n.onSubmit()),"Risk Assessment"==a&&(null===(l=Ne.value)||void 0===l||l.onSubmit()),"Complications Screening"==a&&await(async()=>{const e=[],t=await ae(je.value),i=await ne(Ce.value),a=await ae(Ae.value);var n,l,s,o;t.length>0&&e.push({concept_id:await J.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:J.getSessionDate(),child:t}),i.length>0&&e.push({concept_id:await J.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:J.getSessionDate(),child:i}),a.length>0&&e.push(...a),e.length>0?(null!==(l=(n=null!==(o=(s=we.value).screening)&&void 0!==o?o:s.screening={}).unsaved)&&void 0!==l||(n.unsaved=[]),we.value.screening.unsaved.push(...e),U("Complications saved successfully")):$("No complications data to save")})(),"Treatment Plan"==a&&await(async()=>{const e=W();if(!ie.isEmpty(e.selectedMedicalAllergiesList)){const t=G(),i=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:K.getSessionDate(),value_coded:e.concept_id,location_id:t.facilityLocation.code,value_text:e.name})),a=await X(i);we.value=Object.assign(we.value,a),console.log("Allergies staged successfully:",we.value),e.clearSelectedMedicalAllergiesList()}const t=await Y();we.value=Object.assign(we.value,t);const i=await ee().saveNonPharmaTherapyPatientData();we.value=Object.assign(we.value,i)})(),await z(we.value)},We=async()=>{de.value=!0;try{await V(),await z(we.value),ce.push("/triageList")}catch(e){console.error("Error saving data:",e),$("Error occurred while saving data. Please try again.")}finally{de.value=!1}};return c(async()=>{0!==De.NCDActivities.length?(te().resetScreening(),ke.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}],await $e(),(void 0===re.value||re.value<0)&&(re.value=0,console.log("Setting initial tab index to 0")),ve.value=!1,de.value=!1,Te()):ce.push("patientProfile")}),r(re,async()=>{await Te()}),r(xe,async()=>{await $e()},{deep:!0}),r(we,async()=>{te().resetScreening(),await $e()},{deep:!0}),r(Ee,async()=>{await $e()},{deep:!0}),r(Ie,async()=>{await $e()},{deep:!0}),r(_e,async()=>{await $e()},{deep:!0}),r(Re,async()=>{await $e()},{deep:!0}),r(Me,async()=>{await $e()},{deep:!0}),r(ue,async e=>{ze(),Ve(),ke.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]},{deep:!0}),r(we,async(e,t)=>{e.ID!=t.ID&&(ze(),Ve())},{deep:!0}),i({saveData:We,markWizard:$e,refreshWizard:ze,validateDoneButtonState:Te}),(e,i)=>{const a=u("PresentingComplaints"),n=u("DrugHistory"),l=u("PastMedicalHistory"),s=u("PastSurgicalHistory"),o=u("Allergy"),r=u("Intoxication"),c=u("SocialHistory"),b=u("FamilyHistory"),w=u("ReviewOfSystems"),x=u("PhysicalExamination"),I=u("Summary"),_=u("DifferentialDiagnosis"),R=u("Investigation"),M=u("ManagementPlan");return v(),g(m(P),null,{default:d(()=>[y(O),y(m(f),{fullscreen:!0},{default:d(()=>[y(Q),p("div",t,[ge.value?(v(),g(q,{key:0,ref:"wizard",headingTitle:"Medical Inpatient Admission Sheet","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:ye.value,"custom-tabs":ke.value,beforeChange:m(oe),onChange:Ue,"onComplete:wizard":i[1]||(i[1]=e=>We()),onDoneButtonChanged:Oe},{default:d(()=>[p("div",null,[p("div",se,[y(T,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:m(D),"font-weight":"600",onClick:i[0]||(i[0]=e=>{ce.push("/patientProfile")})},null,8,["icon"])])]),h(p("div",null,[y(a,{ref:"presentingComplaintsRef"},null,512)],512),[[H,"PresentingComplaints"==Be()]]),h(p("div",null,[y(n,{ref:"drugHistoryRef"},null,512)],512),[[H,"DrugHistory"==Be()]]),h(p("div",null,[y(l,{ref:"pastMedicalHistoryRef"},null,512)],512),[[H,"PastMedicalHistory"==Be()]]),h(p("div",null,[y(s,{ref:"pastSurgicalHistoryRef"},null,512)],512),[[H,"PastSurgicalHistory"==Be()]]),h(p("div",null,[y(o,{ref:"allergyRef"},null,512)],512),[[H,"Allergy"==Be()]]),h(p("div",null,[y(r,{ref:"IntoxicationRef"},null,512)],512),[[H,"Intoxication"==Be()]]),h(p("div",null,[y(c,{ref:"socialHistoryRef"},null,512)],512),[[H,"SocialHistory"==Be()]]),h(p("div",null,[y(b,{ref:"familyHistoryRef"},null,512)],512),[[H,"FamilyHistory"==Be()]]),h(p("div",null,[y(w,{ref:"reviewOfSystemsRef"},null,512)],512),[[H,"ReviewOfSystems"==Be()]]),h(p("div",null,[y(x,{ref:"physicalExaminationRef"},null,512)],512),[[H,"PhysicalExamination"==Be()]]),h(p("div",null,[y(I,{ref:"summaryRef"},null,512)],512),[[H,"Summary"==Be()]]),h(p("div",null,[y(_,{ref:"differentialDiagnosisRef"},null,512)],512),[[H,"DifferentialDiagnosis"==Be()]]),h(p("div",null,[y(R,{ref:"investigationRef"},null,512)],512),[[H,"Investigation"==Be()]]),h(p("div",null,[y(M,{ref:"managementPlanRef"},null,512)],512),[[H,"ManagementPlan"==Be()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):S("",!0)])]),_:1})]),_:1})}}}))}}});
