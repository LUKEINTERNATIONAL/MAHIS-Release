import{d as A,r as y,eT as O,c as F,b as X,w as S,e as w,f as b,k as H,l as T,K as U,u as x,a3 as G,a6 as j,ao as K,aV as J,eU as q,H as W,O as Q,J as Y}from"./vendor-BolvhNQv.js";import{aD as M,_ as R,T as Z,u as ee,b3 as E,t as z,ag as I,ci as te,G as ae}from"../index-vq0ibwVO.js";import{a as N,b as D,N as oe}from"./NeonatalStepper-ztU0tzZn.js";import{u as ne}from"./useNeonatalVitalsStore-B1UJFJSv.js";import{N as re}from"./neonatal_service-Dy3BMrpX.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-Go-aTq24.js";import"./SaveProgressModal-Dtf40CfH.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const se={class:"neonatal-vitals-section"},ie={class:"respiratory-timer-body"},ue={class:"respiratory-timer-time"},le={class:"respiratory-timer-instruction"},$=60,ce=A({__name:"VitalSignsSection",setup(_,{expose:g}){const a=y(null),u=N.find(r=>r.title==="Vital Signs");if(!u)throw new Error("[VitalSignsSection] Missing configuration for Vital Signs section");const n=O(D),c=y($),s=y(!1),l=y(!1);let e=null;const t=F(()=>{const r=Math.floor(c.value/60).toString().padStart(2,"0"),o=(c.value%60).toString().padStart(2,"0");return"".concat(r,":").concat(o)}),v=F(()=>s.value?"TAP TO PAUSE COUNTDOWN":c.value===$?"TAP TO START COUNTDOWN":c.value===0?"TAP TO RESTART COUNTDOWN":"TAP TO RESUME COUNTDOWN"),f=()=>{e===null&&(s.value=!0,l.value=!1,e=window.setInterval(()=>{c.value>0?c.value-=1:(s.value=!1,l.value=!0,e!==null&&(clearInterval(e),e=null))},1e3))},d=()=>{e!==null&&(clearInterval(e),e=null),s.value=!1},V=()=>{d(),c.value=$,l.value=!1},h=()=>{s.value?d():(c.value===0&&V(),f())};X(()=>{e!==null&&clearInterval(e)});const k=F(()=>u.formData.map(r=>{var m,p;if(!r.name||!n)return{...r};const o=n[r.name],i=r.componentType==="switchField"?o!=null?o:null:(p=(m=o!=null?o:r.initialValue)!=null?m:r.value)!=null?p:"";return{...r,initialValue:i}})),C=u.conditionalRules||[],L=r=>{var o,i;n&&(n.respiratory_rate=r.respiratory_rate||"",n.heart_rate=r.heart_rate||"",n.can_measure_oxygen_saturation=(o=r.can_measure_oxygen_saturation)!=null?o:null,n.oxygen_saturation=r.oxygen_saturation||"",n.can_measure_temperature=(i=r.can_measure_temperature)!=null?i:null,n.temperature=r.temperature||"")};return S(()=>{var r;return(r=a.value)==null?void 0:r.formValues},r=>{r&&L(r)},{deep:!0}),S(()=>a.value,r=>{r!=null&&r.getFormValues&&L(r.getFormValues())},{immediate:!0}),g({getFormRef:()=>a.value,validateForm:()=>{var r,o;return((o=(r=a.value)==null?void 0:r.validateForm)==null?void 0:o.call(r))||null},getFormValues:()=>{var r,o;return((o=(r=a.value)==null?void 0:r.getFormValues)==null?void 0:o.call(r))||{}}}),(r,o)=>(b(),w("div",se,[H("div",{class:"respiratory-timer-card",onClick:h},[H("div",ie,[H("div",ue,U(t.value),1),H("div",le,U(v.value),1)])]),T(M,{formData:k.value,conditionalRules:x(C),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),me=R(ce,[["__scopeId","data-v-19d42943"]]),pe={class:"neonatal-vitals-section"},_e=A({__name:"WeightMeasurementsSection",setup(_,{expose:g}){const a=y(null),u=N.find(e=>e.title==="Weight Measurements");if(!u)throw new Error("[WeightMeasurementsSection] Missing configuration for Weight Measurements section");const n=O(D),c=F(()=>u.formData.map(e=>{var v,f;if(!e.name||!n)return{...e};const t=n[e.name];return{...e,initialValue:(f=(v=t!=null?t:e.initialValue)!=null?v:e.value)!=null?f:""}})),s=u.conditionalRules||[],l=e=>{n&&(n.current_weight=e.current_weight||"",n.head_circumference=e.head_circumference||"")};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),g({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(b(),w("div",pe,[T(M,{formData:c.value,conditionalRules:x(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),fe=R(_e,[["__scopeId","data-v-7a8515ce"]]),ge={class:"neonatal-vitals-section"},de=A({__name:"BloodSugarSection",setup(_,{expose:g}){const a=y(null),u=N.find(e=>e.title==="Blood Sugar");if(!u)throw new Error("[BloodSugarSection] Missing configuration for Blood Sugar section");const n=O(D),c=F(()=>u.formData.map(e=>{var f,d,V,h;if(!e.name||!n)return{...e};const t=n[e.name];if(e.name==="blood_sugar")return{...e,initialValue:(d=(f=t!=null?t:e.initialValue)!=null?f:e.value)!=null?d:"",initialUnit:n.blood_sugar_unit||e.initialUnit||"mg/dL"};const v=e.componentType==="switchField"?t!=null?t:null:(h=(V=t!=null?t:e.initialValue)!=null?V:e.value)!=null?h:"";return{...e,initialValue:v}})),s=u.conditionalRules||[],l=e=>{var t;n&&(n.can_measure_blood_sugar=(t=e.can_measure_blood_sugar)!=null?t:null,n.blood_sugar=e.blood_sugar||"",n.blood_sugar_unit=e.blood_sugar_unit||n.blood_sugar_unit||"mg/dL")};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),g({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(b(),w("div",ge,[T(M,{formData:c.value,conditionalRules:x(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),ve=R(de,[["__scopeId","data-v-bfd75302"]]),Se={class:"neonatal-vitals-section"},ye=A({__name:"HypoglycemiaSymptomaticSection",setup(_,{expose:g}){const a=y(null),u=N.find(e=>e.title==="Hypoglycemia-Symptomatic");if(!u)throw new Error("[HypoglycemiaSymptomaticSection] Missing configuration for Hypoglycemia-Symptomatic section");const n=O(D),c=F(()=>u.formData.map(e=>{var f,d;if(!e.name||!n)return{...e};const t=n[e.name],v=e.componentType==="switchField"?t!=null?t:null:(d=(f=t!=null?t:e.initialValue)!=null?f:e.value)!=null?d:"";return{...e,initialValue:v}})),s=u.conditionalRules||[],l=e=>{n&&Object.assign(n,e)};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),g({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(b(),w("div",Se,[T(M,{formData:c.value,conditionalRules:x(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),Ne=R(ye,[["__scopeId","data-v-34b36eb5"]]),he={class:"neonatal-vitals-section"},Te=A({__name:"HypoglycemiaAsymptomaticSection",setup(_,{expose:g}){const a=y(null),u=N.find(e=>e.title==="Hypoglycemia-Asymptomatic");if(!u)throw new Error("[HypoglycemiaAsymptomaticSection] Missing configuration for Hypoglycemia-Asymptomatic section");const n=O(D),c=F(()=>u.formData.map(e=>{var f,d;if(!e.name||!n)return{...e};const t=n[e.name],v=e.componentType==="switchField"?t!=null?t:null:(d=(f=t!=null?t:e.initialValue)!=null?f:e.value)!=null?d:"";return{...e,initialValue:v}})),s=u.conditionalRules||[],l=e=>{n&&Object.assign(n,e)};return S(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),S(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),g({getFormRef:()=>a.value,validateForm:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.validateForm)==null?void 0:t.call(e))||null},getFormValues:()=>{var e,t;return((t=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:t.call(e))||{}}}),(e,t)=>(b(),w("div",he,[T(M,{formData:c.value,conditionalRules:x(s),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),Fe=R(Te,[["__scopeId","data-v-a5dcc574"]]),Ve={class:"neonatal-vitals-section"},Ie=A({__name:"VitalsSummarySection",setup(_,{expose:g}){const a=y(null),u=N.find(s=>s.title==="Vitals Summary");if(!u)throw new Error("[VitalsSummarySection] Missing configuration for Vitals Summary section");const n=O(D),c=F(()=>u.formData.map(s=>{if(s.componentType!=="summaryField"||!n)return{...s};const l=s.builder;return{...s,builder:e=>{if(typeof l!="function")return[];const t={...n||{},...e};return l(t)}}}));return g({getFormRef:()=>a.value,validateForm:()=>null,getFormValues:()=>({...n||{}})}),(s,l)=>(b(),w("div",Ve,[T(M,{formData:c.value,ref_key:"formRef",ref:a},null,8,["formData"])]))}}),Ae=R(Ie,[["__scopeId","data-v-fbe7c51f"]]),be=A({name:"NeonatalVitals",components:{IonPage:j,IonContent:G,Toolbar:Z,NeonatalStepper:oe},setup(){const _=K(),g=ee(),{patient:a}=J(g),u=ne(),n=o=>{const i=Number(o);return Number.isFinite(i)?i:null},c=()=>{var i;const o=n((i=a.value)==null?void 0:i.patientID);u.initializeForPatient(o)};c(),S(()=>{var o;return(o=a.value)==null?void 0:o.patientID},()=>c());const s=u.formData;q(D,s),S(()=>u.formData,()=>u.saveSnapshot(),{deep:!0});const l=y(N.map((o,i)=>({title:o.title,number:i+1,checked:!1,class:i===0?"open_step common_step":"common_step",last_step:i===N.length-1?"last_step":""}))),e=o=>N.findIndex(i=>i.title===o),t=[{title:"Vital Signs",value:"1",component:me,configIndex:e("Vital Signs")},{title:"Weight Measurements",value:"2",component:fe,configIndex:e("Weight Measurements")},{title:"Blood Sugar",value:"3",component:ve,configIndex:e("Blood Sugar")},{title:"Hypoglycemia-Symptomatic",value:"4",component:Ne,configIndex:e("Hypoglycemia-Symptomatic")},{title:"Hypoglycemia-Asymptomatic",value:"5",component:Fe,configIndex:e("Hypoglycemia-Asymptomatic")},{title:"Vitals Summary",value:"6",component:Ae,configIndex:e("Vitals Summary")}],v="Neonatal Vital Signs",f=y("1"),d=o=>{o&&o.value&&l.value.forEach((i,m)=>{o.value===(m+1).toString()?(i.class="open_step common_step",i.checked=!1):m<parseInt(o.value)-1?(i.class="common_step color_white",i.checked=!0):(i.class="common_step",i.checked=!1)})},V=o=>(o!=null?o:"").trim().toUpperCase(),h=[{encounterType:E.NEONATAL_SIGNS_SYMPTOMS,route:"/neonatal/signs-symptoms",encounterNames:["NEONATAL SIGNS & SYMPTOMS"]},{encounterType:E.NEONATAL_REVIEW_OF_SYSTEMS,route:"/neonatal/review-of-systems",encounterNames:["NEONATAL REVIEW OF SYSTEMS"]},{encounterType:E.PHYSICAL_EXAMINATION_BABY,route:"/neonatal/general-examination",encounterNames:["PHYSICAL EXAMINATION BABY","NEONATAL GENERAL EXAMINATION"]},{encounterType:E.VITALS,route:"/neonatal/vitals",encounterNames:["VITALS","NEONATAL VITALS"]},{encounterType:E.NEONATAL_SYSTEMIC_EXAMINATION,route:"/neonatal/SystemicExamination",encounterNames:["NEONATAL SYSTEMIC EXAMINATION"]}],k=h[h.length-1].route,C=new Map;h.forEach(o=>{o.encounterNames.forEach(i=>{C.set(V(i),o.encounterType)})});const L=o=>{const i=new Set;o.forEach(p=>{const P=V(p),B=C.get(P);B!==void 0&&i.add(B)});const m=h.find(p=>!i.has(p.encounterType));return m?m.route:k};return{wizardData:l,stepperData:t,stepperTitle:v,currentOpenStepper:f,updateStatus:d,getSaveFunction:o=>o===t.length-1?async()=>{var i;if(!((i=a.value)!=null&&i.patientID)){z("No patient selected");return}try{const m=[];if(s.respiratory_rate&&m.push(await I.buildValueNumber("Respiratory rate",Number(s.respiratory_rate))),s.heart_rate&&m.push(await I.buildValueNumber("Pulse",Number(s.heart_rate))),s.oxygen_saturation&&m.push(await I.buildValueNumber("Oxygen saturation",Number(s.oxygen_saturation))),s.temperature&&m.push(await I.buildValueNumber("Temperature (C)",Number(s.temperature))),s.current_weight&&m.push(await I.buildValueNumber("Weight (kg)",Number(s.current_weight)/1e3)),s.head_circumference&&m.push(await I.buildValueNumber("Head circumference",Number(s.head_circumference))),s.blood_sugar){let p=Number(s.blood_sugar);(s.blood_sugar_unit||"mg/dL")==="mmol/L"&&(p=p*18.018),m.push(await I.buildValueNumber("Blood sugar",p))}await te(a.value.patientID,E.VITALS,m),ae("Vital signs recorded successfully"),u.clearPatient(a.value.patientID);try{const p=await re.getSavedEncounters(a.value.patientID),P=Array.isArray(p==null?void 0:p.encounters)?p.encounters:[],B=L(P);_.push(B)}catch(p){console.error("Error determining next admission step:",p),_.push({path:"/patientProfile"})}}catch(m){console.error("Failed to save vital signs",m),z("Failed to save vital signs")}}:null,neonatalVitalsSections:N}}});function Re(_,g,a,u,n,c){const s=W("Toolbar"),l=W("NeonatalStepper"),e=W("ion-content"),t=W("ion-page");return b(),Q(t,{class:"neonatal-vitals-page"},{default:Y(()=>[T(s),T(e,{fullscreen:!0},{default:Y(()=>[T(l,{wizardData:_.wizardData,StepperData:_.stepperData,stepperTitle:_.stepperTitle,openStepper:_.currentOpenStepper,backUrl:"/patientProfile",flowType:"vitals",getSaveFunction:_.getSaveFunction,sectionsConfig:_.neonatalVitalsSections,onUpdateStatus:_.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","sectionsConfig","onUpdateStatus"])]),_:1})]),_:1})}const He=R(be,[["render",Re],["__scopeId","data-v-5f1f2ad2"]]);export{He as default};
