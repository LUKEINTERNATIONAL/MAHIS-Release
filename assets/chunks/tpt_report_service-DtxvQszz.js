import{R as u,cz as p}from"../index-EMelXwFr.js";import{A as l}from"./age_groups-BkW1n_F5.js";import{l as m}from"./lodash-NJiRuGo9.js";const c={"3HP_new":"3H (Started New on ART)","6H_new":"6H (Started New on ART)","3HP_prev":"3H (Started Previously on ART)","6H_prev":"6H (Started Previously on ART)"},g={started_tpt_new:"Started TPT (New on ART)",started_tpt_prev:"Started TPT (Previous on ART)",completed_tpt_new:"Completed TPT(New on ART)",completed_tpt_prev:"Completed TPT(Previous on ART)",not_completed_tpt:"Not completed TPT",died:"Died",defaulted:"Defaulted",stopped:"Stopped ART",transfer_out:"Transfered Out",confirmed_tb:"Confirmed TB",pregnant:"Pregnant",breast_feeding:"Breastfeeding",skin_rash:"Skin rash",peripheral_neuropathy:"Peripheral neuropathy",yellow_eyes:"Yellow eyes",nausea:"Nausea",dizziness:"Dizziness"};class h extends u{constructor(){super()}async getTtpOutcomes(){var s;const e=(s=await this.getReport("programs/".concat(this.programId,"/reports/tpt_outcome")))!=null?s:[],t=this.aggregateTptOutcomes(e),o=this.getTotalTptOutcomeFemales(t.females);return[...p(this.tptOutcomesBuilder(e),"tpt_type"),{age_group:"All",tpt_type:"M",...t.males},...o]}async getCohort(){const e=await this.getReport("moh_tpt");return p(e!=null?e:[],"gender")}async getTptNewInitiations(){return this.tptInitiationBuilder(await this.getReport("programs/".concat(this.programId,"/reports/tpt_newly_initiated")))}tptOutcomesBuilder(e){return e.map(t=>Object.entries(t).reduce((o,[r,s])=>(o[r]=typeof s=="string"?s:s.map(({patient_id:n})=>n),o),{}))}getTotalTptOutcomeFemales(e){return["FP","FNP","FBf"].map(t=>{const o={age_group:"All",tpt_type:t};for(const r in g)o[r]=e[r].filter(s=>t==="FP"?e.pregnant.includes(s):t==="FBf"?e.breast_feeding.includes(s):![...e.pregnant,e.breast_feeding].includes(s));return o})}aggregateTptOutcomes(e){return e.reduce((t,o)=>{for(const r in g)r in t.males||(t.males[r]=[]),r in t.females||(t.females[r]=[]),!m.isEmpty(o[r])&&o[r].forEach(s=>{s.gender==="F"?t.females[r].push(s.patient_id):t.males[r].push(s.patient_id)});return t},{males:{},females:{}})}aggregateTptInitiationData(e,t,o,r){var s;r[e].aggregate[t]=[...(s=r[e].aggregate[t])!=null?s:[],...o]}tptInitiationBuilder(e={}){const t={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return l.reduce((o,r)=>{const s=Object.entries(e[r]).reduce((n,[a,i])=>(this.aggregateTptInitiationData("M",a,i.M,o),this.aggregateTptInitiationData("F",a,i.F,o),n.M[a]=i.M,n.F[a]=i.F,n),{M:{gender:"M",location:e.Location,ageGroup:r},F:{gender:"F",location:e.Location,ageGroup:r}});return o.F.rows.push(s.F),o.M.rows.push(s.M),o},t)}}export{h as T,c as a,g as b};
