var Pe=Object.defineProperty;var pe=(n,d,r)=>d in n?Pe(n,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[d]=r;var O=(n,d,r)=>pe(n,typeof d!="symbol"?d+"":d,r);import{d as T,O as k,f as l,u as i,aS as U,p,J as m,l as o,aP as Q,k as a,e as g,m as _e,K as v,c as j,Q as G,bi as ze,I as Ee,G as Re,E as Fe,a_ as He,N as Oe,L as je,aT as Ge,a3 as ve,j as Ke,an as Ue,r as M,a as Qe,a4 as me,F as L,P as B,a5 as ge,bm as fe,dO as P,a6 as We}from"./vendor-Cjwp4qqF.js";import{_ as A,u as Je,T as qe}from"../index-BRRnYvJt.js";import{N as Xe}from"./neonatal_service-DpjBGweV.js";import{I as C}from"./images-DJIykHYW.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-H6sKa3PN.js";const I=class I{constructor(){O(this,"statusColorMap",{admitted:"primary",discharged:"success",critical:"warning"})}getStatusColor(d){var r;return(r=this.statusColorMap[d.toLowerCase()])!=null?r:"medium"}formatWeight(d){return"".concat((d/1e3).toFixed(2)," kg")}static getInstance(){return I.instance||(I.instance=new I),I.instance}};O(I,"instance");let K=I;const Ye=K.getInstance(),E=[{label:"Triaged without Registration",key:"enrolled",iconSrc:C.icons.triaged},{label:"Admitted Today",key:"admitted",iconSrc:C.icons.newborn},{label:"Discharged Today",key:"discharged",iconSrc:C.icons.babyCarriage},{label:"Critical",key:"critical",iconSrc:C.icons.warningSign,isCritical:!0}],Ze=[{label:"Start Emergency Triage",iconSrc:C.icons.electrocardiogram,iconClass:"emergency-icon",route:"/neonatal/triage"},{label:"Instruction Guides",iconSrc:C.icons.info,route:"/neonatal/guides"}],Ve={class:"stat-icon-wrapper"},ye=["innerHTML"],et=["src","alt"],tt={class:"stat-label"},st=T({__name:"card",props:{label:{},value:{},iconSrc:{},svgIcon:{},isCritical:{type:Boolean},clickable:{type:Boolean}},emits:["click"],setup(n,{emit:d}){const r=n,b=d,f=()=>{r.clickable&&b("click")};return(_,$)=>(l(),k(i(U),{class:p(["stat-card",{"is-clickable":n.clickable}]),onClick:f},{default:m(()=>[o(i(Q),{class:"stat-content"},{default:m(()=>[a("div",Ve,[n.svgIcon?(l(),g("div",{key:0,innerHTML:n.svgIcon,class:"stat-icon"},null,8,ye)):n.iconSrc?(l(),g("img",{key:1,src:n.iconSrc,class:"stat-icon critical-icon",alt:n.label},null,8,et)):_e("",!0)]),a("div",tt,v(n.label),1),a("div",{class:p(["stat-value",{"critical-value":n.isCritical}])},v(n.value),3)]),_:1})]),_:1},8,["class"]))}}),nt=A(st,[["__scopeId","data-v-cc8c780a"]]),it={class:"action-icon-wrapper"},at=["innerHTML"],ot=["src","alt"],ct={class:"action-label"},lt=T({__name:"action-card",props:{label:{},svgIcon:{},iconSrc:{},iconClass:{}},emits:["click"],setup(n,{emit:d}){const r=d,b=()=>{r("click")};return(f,_)=>(l(),k(i(U),{class:"action-card",onClick:b},{default:m(()=>[o(i(Q),{class:"action-content"},{default:m(()=>[a("div",it,[n.svgIcon?(l(),g("div",{key:0,innerHTML:n.svgIcon,class:p(["action-icon",n.iconClass])},null,10,at)):n.iconSrc?(l(),g("img",{key:1,src:n.iconSrc,class:p(["action-icon",n.iconClass]),alt:n.label},null,10,ot)):_e("",!0)]),a("div",ct,v(n.label),1)]),_:1})]),_:1}))}}),rt=A(lt,[["__scopeId","data-v-fc22b927"]]),ut={class:"neonate-info"},dt={class:"neonate-name"},mt={class:"neonate-mrn"},gt={class:"neonate-details"},ft={class:"detail-item"},ht=["src"],_t={class:"detail-item"},vt=["src"],bt={class:"neonate-status"},kt=T({__name:"neonate-card",props:{neonate:{},getStatusColor:{type:Function}},emits:["click"],setup(n,{emit:d}){const r=n,b=d,f=j(()=>r.getStatusColor(r.neonate.status)),_=()=>{b("click",r.neonate.id)};return($,x)=>(l(),k(i(U),{class:"neonate-card",onClick:_},{default:m(()=>[o(i(Q),{class:"neonate-content"},{default:m(()=>[a("div",ut,[a("div",dt,v(n.neonate.name),1),a("div",mt,v(n.neonate.mrn),1),a("div",gt,[a("span",ft,[a("img",{src:i(C).icons.deliveryTime,class:"detail-icon"},null,8,ht),G(" "+v(n.neonate.age),1)]),a("span",_t,[a("img",{src:i(C).icons.babyWeight,class:"detail-icon"},null,8,vt),G(" "+v(n.neonate.weight),1)])])]),a("div",bt,[a("div",{class:p(["status-badge","status-".concat(f.value)])},v(n.neonate.status),3)])]),_:1})]),_:1}))}}),he=A(kt,[["__scopeId","data-v-60eeda47"]]),Ct={class:"drilldown-content"},St={key:0,class:"empty-drilldown"},$t={key:1,class:"drilldown-list"},It=T({__name:"DrilldownModal",props:{isOpen:{type:Boolean},title:{},isEmpty:{type:Boolean,default:!1},emptyMessage:{default:"No items available."}},emits:["close","dismiss"],setup(n,{emit:d}){const r=d,b=Ge,f=()=>{r("close")},_=()=>{r("dismiss")};return($,x)=>(l(),k(i(ze),{"is-open":n.isOpen,onDidDismiss:_,class:"drilldown-modal"},{default:m(()=>[o(i(Ee),null,{default:m(()=>[o(i(Re),null,{default:m(()=>[o(i(Fe),null,{default:m(()=>[G(v(n.title),1)]),_:1}),o(i(He),{slot:"end"},{default:m(()=>[o(i(Oe),{fill:"clear",onClick:f},{default:m(()=>[o(i(je),{slot:"icon-only",icon:i(b)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(i(ve),null,{default:m(()=>[a("div",Ct,[n.isEmpty?(l(),g("div",St,v(n.emptyMessage),1)):(l(),g("div",$t,[Ke($.$slots,"default",{},void 0,!0)]))])]),_:3})]),_:3},8,["is-open"]))}}),wt=A(It,[["__scopeId","data-v-912ed09a"]]),Nt={class:"neonatal-dashboard"},Tt={class:"header-image"},At=["src"],xt={class:"section-container"},Dt={class:"section-container"},Mt={class:"section-container"},Lt={key:0,class:"neonates-list"},Bt={class:"skeleton-content"},Pt={key:1,class:"neonates-list"},pt={key:2,class:"empty-neonates"},zt=T({__name:"LandingPage",setup(n){const d={enrolled:"In patient",admitted:"Admitted",discharged:"Discharged",critical:"Critical"},r=()=>E.reduce((e,t)=>(e[t.key]={count:0,neonates:[]},e),{}),b=Ue(),f=M(r()),_=M([]),$=M(!0),x=M(!1),w=M(null),z=j(()=>{var e,t;return w.value?(t=(e=f.value[w.value])==null?void 0:e.neonates)!=null?t:[]:[]}),be=e=>{var t,s;return e&&(s=(t=E.find(c=>c.key===e))==null?void 0:t.label)!=null?s:"Neonates"},ke=j(()=>{const e=be(w.value);return z.value.length?"".concat(e," (").concat(z.value.length,")"):e}),Ce=e=>{var t,s;return(s=(t=f.value[e])==null?void 0:t.count)!=null?s:0},W=e=>{var t,s;return((s=(t=f.value[e])==null?void 0:t.neonates.length)!=null?s:0)>0},Se=e=>{W(e)&&(w.value=e,x.value=!0)},J=()=>{x.value=!1,w.value=null},R=e=>{b.push({path:e})},q=async e=>{try{await Je().setPatientRecord({patientID:Number(e)}),R("/patientProfile?id=".concat(e))}catch(t){console.error("[NeonatalLanding] Failed to load patient:",t),R("/patientProfile?id=".concat(e))}},X=e=>Ye.getStatusColor(e),$e=async()=>{try{$.value=!0;const e=await Xe.getStatistics();f.value=Ie(e),e.recent_neonates&&Array.isArray(e.recent_neonates)?_.value=e.recent_neonates.map(t=>({id:String(t.id||t.patient_id||""),name:t.name||"Unknown Neonate",mrn:t.mrn||"N/A",age:t.age||"—",weight:t.weight||"—",status:t.status||"In patient"})):xe()}catch(e){console.error("[NeonatalLanding] Failed to load statistics",e),f.value=r(),_.value=[]}finally{$.value=!1}},Ie=e=>{const t=r();return E.forEach(s=>{var S,N;const c=s.key,h=(N=e==null?void 0:e[c])!=null?N:(S=e==null?void 0:e.stats)==null?void 0:S[c],u=we(e,c);t[c]=Ne(h,u,c)}),t},we=(e,t)=>{var c,h,u,S,N;return e?(N=[(c=e==null?void 0:e.neonates)==null?void 0:c[t],(h=e==null?void 0:e.details)==null?void 0:h[t],e==null?void 0:e["".concat(t,"_neonates")],e==null?void 0:e["".concat(t,"_patients")],e==null?void 0:e["".concat(t,"_records")],(u=e==null?void 0:e[t])==null?void 0:u.neonates,(S=e==null?void 0:e[t])==null?void 0:S.patients].find(H=>Array.isArray(H)))!=null?N:[]:[]},Ne=(e,t,s)=>{if(typeof e=="number")return{count:e,neonates:F(t,s)};if(e&&typeof e=="object"){const h=Array.isArray(e.neonates)?e.neonates:Array.isArray(e.patients)?e.patients:t,u=F(h,s);return{count:typeof e.count=="number"?e.count:typeof e.total=="number"?e.total:typeof e.value=="number"?e.value:u.length,neonates:u}}const c=F(t,s);return{count:c.length,neonates:c}},F=(e,t)=>Array.isArray(e)?e.map((s,c)=>Te(s,t,c)):[],Te=(e,t,s)=>{var Y,Z,V,y,ee,te,se,ne,ie,ae,oe,ce,le,re,ue,de;const c=d[t],h="".concat(t,"-").concat(s);if(e!=null&&e.name&&(e!=null&&e.mrn))return{id:String((Y=e.id)!=null?Y:h),name:e.name,mrn:e.mrn,age:(Z=e.age)!=null?Z:"—",weight:(V=e.weight)!=null?V:"—",status:(y=e.status)!=null?y:c};const u=(ee=e==null?void 0:e.patient)!=null?ee:e,S=(ne=(se=(te=e==null?void 0:e.id)!=null?te:e==null?void 0:e.patient_id)!=null?se:u==null?void 0:u.patient_id)!=null?ne:h,H=[e==null?void 0:e.name,u==null?void 0:u.given_name,u==null?void 0:u.family_name].filter(Boolean).join(" ").trim()||"Unknown Neonate",De=(oe=(ae=(ie=e==null?void 0:e.mrn)!=null?ie:e==null?void 0:e.identifier)!=null?ae:u==null?void 0:u.identifier)!=null?oe:"N/A",Me=(le=(ce=e==null?void 0:e.age)!=null?ce:Ae(u==null?void 0:u.birthdate))!=null?le:"—",D=(ue=(re=e==null?void 0:e.weight)!=null?re:e==null?void 0:e.latest_weight)!=null?ue:e==null?void 0:e.weight_kg,Le=typeof D=="number"?"".concat(D.toFixed(2)," Kg"):D!=null?D:"—",Be=(de=e==null?void 0:e.status)!=null?de:c;return{id:String(S),name:H,mrn:De,age:Me,weight:Le,status:Be}},Ae=e=>{if(!e)return null;const t=new Date(e);if(Number.isNaN(t.getTime()))return null;const s=Date.now()-t.getTime(),c=Math.floor(s/(1e3*60*60));if(c<24)return"".concat(c," hrs old");const h=Math.floor(c/24);return h<1?"Today":"".concat(h," day").concat(h===1?"":"s"," old")},xe=()=>{const e=Object.values(f.value).flatMap(t=>t.neonates).slice(0,5);_.value=e};return Qe(()=>{$e()}),(e,t)=>(l(),g("div",Nt,[a("div",Tt,[a("img",{src:i(C).banners.babyHand,alt:"baby-hand-banner",style:{"object-fit":"cover"}},null,8,At)]),a("div",xt,[t[0]||(t[0]=a("h2",{class:"section-title"},"Today's Stats",-1)),o(i(fe),{class:"stats-grid"},{default:m(()=>[o(i(me),null,{default:m(()=>[(l(!0),g(L,null,B(i(E),s=>(l(),k(i(ge),{key:s.key,size:"6","size-md":"3"},{default:m(()=>[o(nt,{label:s.label,value:Ce(s.key),"icon-src":s.iconSrc,"svg-icon":s.svgIcon,"is-critical":s.isCritical,clickable:W(s.key),onClick:c=>Se(s.key)},null,8,["label","value","icon-src","svg-icon","is-critical","clickable","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),a("div",Dt,[t[1]||(t[1]=a("h2",{class:"section-title"},"Quick Actions",-1)),o(i(fe),{class:"actions-grid"},{default:m(()=>[o(i(me),null,{default:m(()=>[(l(!0),g(L,null,B(i(Ze),s=>(l(),k(i(ge),{key:s.route,size:"6","size-md":"6"},{default:m(()=>[o(rt,{label:s.label,"svg-icon":s.svgIcon,"icon-src":s.iconSrc,"icon-class":s.iconClass,onClick:c=>R(s.route)},null,8,["label","svg-icon","icon-src","icon-class","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),a("div",Mt,[t[2]||(t[2]=a("h2",{class:"section-title"},"Recent Neonates",-1)),$.value?(l(),g("div",Lt,[(l(),g(L,null,B(5,s=>a("div",{key:"skeleton-".concat(s),class:"neonate-skeleton"},[o(i(P),{animated:!0,style:{width:"60px",height:"60px","border-radius":"50%"}}),a("div",Bt,[o(i(P),{animated:!0,style:{width:"70%",height:"20px","margin-bottom":"8px"}}),o(i(P),{animated:!0,style:{width:"50%",height:"16px","margin-bottom":"4px"}}),o(i(P),{animated:!0,style:{width:"40%",height:"16px"}})]),o(i(P),{animated:!0,style:{width:"80px",height:"24px","border-radius":"12px"}})])),64))])):_.value.length?(l(),g("div",Pt,[(l(!0),g(L,null,B(_.value,s=>(l(),k(he,{key:s.id,neonate:s,"get-status-color":X,onClick:q},null,8,["neonate"]))),128))])):(l(),g("div",pt,"No recent neonates to display."))]),o(wt,{"is-open":x.value,title:ke.value,"is-empty":!z.value.length,"empty-message":"No neonates available for this statistic.",onClose:J,onDismiss:J},{default:m(()=>[(l(!0),g(L,null,B(z.value,s=>(l(),k(he,{key:"".concat(w.value,"-").concat(s.id),neonate:s,"get-status-color":X,onClick:q},null,8,["neonate"]))),128))]),_:1},8,["is-open","title","is-empty"])]))}}),Et=A(zt,[["__scopeId","data-v-116bf665"]]),Rt=T({__name:"NeonatalHome",setup(n){return(d,r)=>(l(),k(i(We),null,{default:m(()=>[o(qe),o(i(ve),{fullscreen:!0},{default:m(()=>[o(Et)]),_:1})]),_:1}))}}),Qt=A(Rt,[["__scopeId","data-v-052dae1c"]]);export{Qt as default};
