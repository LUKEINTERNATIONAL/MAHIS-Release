import{d as ne,av as Ze,r as S,c as se,e as V,f as k,bF as Pe,p as ue,bs as et,k as a,l as s,F as ve,P as me,V as tt,J as n,u as e,a5 as K,L as ye,W as j,K as C,a4 as ee,H as ce,Q as v,R as Ye,a as be,aV as xe,O as J,m as te,bc as ge,N as Y,aZ as st,bD as Ee,_ as U,d0 as nt,bi as Ae,I as Le,G as Ue,E as We,a_ as qe,a3 as ze,M as at,ao as lt,w as Ke,c$ as ot,dV as it,al as rt,ak as re,aj as ut,bz as _e,b5 as dt}from"./vendor-DXb7_Vik.js";import{l as ct}from"./lodash-NJiRuGo9.js";import{_ as ae,aB as X,aC as pe,l as Te,H as le,S as de,af as je,b2 as Je,G as he,u as ke,t as we,aS as fe,bm as oe,m as G,O as Ge,J as pt,j as vt,P as mt}from"../index-BTzlHWti.js";import{N as ft}from"./vaccines_service-ClIn1bil.js";import{u as _t}from"./usePatientProfile-Sa7_6IKd.js";import yt from"./WeightHeightChart-N9wP3cN3.js";import{O as gt,w as ht}from"./weightAndHeight-54H7z3It.js";import"./apexcharts-BuY4MMmo.js";import"./sms_service-6uMMsQoU.js";import"./EIRreportsStore-BZue7Psd.js";import"./Export-CsyA_qG4.js";import"./Registration-BkEh1pO3.js";import"./useLocation-Cp0h58AO.js";import"./useNeonatalEnrollmentStore-CKsTgfLA.js";import"./enrollment-DU-PLRUa.js";import"./chartjs-DFB7jCJt.js";import"./BasicForm-D7ict4Ee.js";import"./DateInputField-CIHQbTmV.js";import"./customDatePicker-BmMQeL4x.js";import"./VitalsMixin.vue_vue_type_script_lang-DVgf17WP.js";import"./formatServerData-7qThvcTY.js";const wt=["onKeydown"],bt={class:"ripple-container"},xt=["onAnimationend"],Tt={class:"status-badge"},kt={class:"ion-text-wrap"},Ct=ne({__name:"ReferralCard",props:{icon:{type:String,default:Ze},status:{type:String,default:"Referred OPD"},title:{type:String,required:!0},type:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},emits:["pressed","click"],setup(N,{emit:b}){const T=N,$=b,h=S(!1),m=S(null),y=S([]);let f=0;const L=se(()=>{if(T.disabled)return"timeline-item-disabled";switch(T.type){case"hiv":return"timeline-item-hiv";case"hepatitis":return"timeline-item-hepatitis";default:return"timeline-item-default"}}),W=se(()=>{if(T.disabled)return"icon-container-disabled";switch(T.type){case"hiv":return"icon-container-hiv";case"hepatitis":return"icon-container-hepatitis";default:return"icon-container-default"}}),B=l=>{if(T.disabled||!m.value)return;const d=m.value.getBoundingClientRect(),w=Math.max(d.width,d.height)*2;let O,q;if(l.type==="keydown")O=d.width/2-w/2,q=d.height/2-w/2;else{const r=l.type.includes("touch")?l.touches[0].clientX:l.clientX,o=l.type.includes("touch")?l.touches[0].clientY:l.clientY;O=r-d.left-w/2,q=o-d.top-w/2}const Q={id:f++,x:O,y:q,size:w,duration:600};y.value.push(Q)},D=l=>{const d=y.value.findIndex(w=>w.id===l);d>-1&&y.value.splice(d,1)},_=l=>{T.disabled||(B(l),$("pressed",{type:T.type,title:T.title,status:T.status,event:l}),$("click",l))},x=l=>{T.disabled||(h.value=!0,B(l))},F=()=>{h.value=!1},H=()=>{h.value=!1},u=l=>{T.disabled||(h.value=!0,B(l))},c=()=>{h.value=!1};return(l,d)=>(k(),V("div",{class:ue(["timeline-item",L.value,{"timeline-item-pressed":h.value}]),onClick:_,onMousedown:x,onMouseup:F,onMouseleave:H,onTouchstart:u,onTouchend:c,role:"button",tabindex:"0",onKeydown:[Pe(_,["enter"]),Pe(et(_,["prevent"]),["space"])],ref_key:"timelineElement",ref:m},[a("div",bt,[(k(!0),V(ve,null,me(y.value,w=>(k(),V("div",{key:w.id,class:"ripple",style:tt({left:w.x+"px",top:w.y+"px",width:w.size+"px",height:w.size+"px",animationDuration:w.duration+"ms"}),onAnimationend:O=>D(w.id)},null,44,xt))),128))]),s(e(ee),null,{default:n(()=>[s(e(K),{class:"ion-text-center"},{default:n(()=>[a("div",null,[s(e(ye),{class:ue(["icon-container",W.value]),icon:N.icon,"aria-hidden":"true"},null,8,["class","icon"])])]),_:1}),s(e(K),{class:"ion-text-center"},{default:n(()=>[s(e(j),null,{default:n(()=>[a("span",Tt,C(N.status),1)]),_:1})]),_:1}),s(e(K),{class:"ion-text-center"},{default:n(()=>[s(e(j),null,{default:n(()=>[a("h2",kt,C(N.title),1)]),_:1})]),_:1})]),_:1})],42,wt))}}),It=ae(Ct,[["__scopeId","data-v-897e90a9"]]),Rt={style:{"padding-left":"10px","padding-right":"10px"}},St={style:{display:"flex","justify-content":"space-between",padding:"10px"}},$t=ne({__name:"RiskCategoryFollowUpModal",setup(N){const b=S(null),T=se(()=>[{componentType:"multiSelectInputField",header:"Risk Category",name:"risk_category",trackBy:"id",validation:X.required,options:[{id:"1",name:"Sex worker"},{id:"2",name:"MSM"},{id:"3",name:"AGYW"},{id:"4",name:"Client of sex workers"},{id:"5",name:"Female sex workers"},{id:"6",name:"Risk age group"},{id:"7",name:"None"}]}]),$=async()=>{var m,y;const h=(m=b.value)==null?void 0:m.getFormValues();console.log("ðŸš€ ~ save ~ result:",h),await Ye.dismiss((y=h==null?void 0:h.risk_category)==null?void 0:y.name)};return(h,m)=>{const y=ce("ion-button");return k(),V("div",Rt,[m[3]||(m[3]=a("div",{class:"content"},[a("h4",null,"Risk Category & Follow-up")],-1)),a("div",null,[s(pe,{formData:T.value,ref_key:"formRef",ref:b},null,8,["formData"])]),a("div",St,[s(y,{color:"danger"},{default:n(()=>[...m[1]||(m[1]=[v("Cancel",-1)])]),_:1}),s(y,{onClick:m[0]||(m[0]=f=>$())},{default:n(()=>[...m[2]||(m[2]=[v("Save",-1)])]),_:1})])])}}}),Ft=ae($t,[["__scopeId","data-v-fdbc4375"]]),Ht={style:{"padding-left":"10px","padding-right":"10px"}},Dt={class:"content"},Vt={style:{"margin-top":"10px"}},Ot={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Mt=ne({__name:"OutcomeSummaryModal",setup(N){const b=S(""),T=async()=>{b.value=le.toStandardHisDisplayFormat(await de.getApiDate())},$=S(null),h=[{header:"Outcome Summary",componentType:"textAreaField",name:"Outcome",icon:Te.editPen,obsValueType:"value_text"},{componentType:"radioButtonField",header:"Is new positive?",name:"New Positive",obsValueType:"value_text",validation:X.required,type:"inline",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{componentType:"radioButtonField",header:"Refer patient to ART clinic?",name:"ART referral",obsValueType:"value_text",validation:X.required,type:"inline",grid:{s:"6"},options:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]}],m=async()=>{var f;const y=(f=$.value)==null?void 0:f.getFormValues();await je.buildSaveObs(y,Je.PATIENT_OUTCOME),await Ye.dismiss(),he("Outcome summary saved successfully.")};return be(async()=>{await T()}),(y,f)=>{const L=ce("ion-button");return k(),V("div",Ht,[a("div",Dt,[f[2]||(f[2]=a("h4",null,"Patient Outcome",-1)),a("div",null,[f[1]||(f[1]=a("span",null,"Todays Date : ",-1)),a("span",null,C(b.value),1)])]),a("div",Vt,[s(pe,{formData:h,ref_key:"formRef",ref:$},null,512)]),a("div",Ot,[s(L,{onClick:f[0]||(f[0]=W=>m())},{default:n(()=>[...f[3]||(f[3]=[v("Complete",-1)])]),_:1})])])}}}),Nt=ae(Mt,[["__scopeId","data-v-62e554aa"]]),Bt={style:{"padding-left":"10px","padding-right":"10px"}},Pt={class:"content"},Et={style:{"text-align":"center",padding:"15px"}},At={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Lt=ne({__name:"HIVTestingModal",props:{order:{}},setup(N){const b=S(null),T=ke(),{patient:$}=xe(T),h=S([]),m=S(""),y=S(""),f=S(""),L=N,W=se(()=>[{componentType:"radioButtonField",header:"Test Type",name:"test_type",obsValueType:"value_text",type:"inline",validation:X.required,onChange:r=>{D()},options:[{label:"Detremin",value:"Detremin"},{label:"Unigold",value:"Unigold"},{label:"Bioline",value:"Bioline"}]},{componentType:"inputField",header:"Test Kit Serial Number",name:"test_kit_serial_number",obsValueType:"value_text",icon:Te.scanner,onChange:r=>{D()},validation:X.required},{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:X.required,type:"inline",onChange:r=>{D()},options:[{label:"Reactive",value:"Reactive"},{label:"Non reactive",value:"Non reactive"}]}]),B=()=>de.getSessionDate(),D=()=>{var I;const r=(I=b.value)==null?void 0:I.getFormValues();if(!(r!=null&&r.test_results)){y.value="",f.value="";return}const o=r.test_type,p=r.test_results;o==="Detremin"?p==="Non reactive"?(y.value="risk_category",f.value="Continue to Risk Category"):p==="Reactive"&&(y.value="unigold",f.value="Continue to Unigold"):o==="Unigold"?p==="Non reactive"?(y.value="repeat_determine",f.value="Repeat Determine Test"):p==="Reactive"&&(y.value="bioline",f.value="Continue to Bioline"):o==="Bioline"&&(p==="Non reactive"?(y.value="inconclusive",f.value="Schedule Inconclusive Follow-up"):p==="Reactive"&&(y.value="Outcome summary",f.value="Continue to Summary"))},_=r=>{if(r!=null&&r.tests)return r.tests[0].name},x=async()=>{var i,t;if(((i=b.value)==null?void 0:i.validateForm())!=null){we("Please fill in all required fields");return}const r=(t=b.value)==null?void 0:t.getFormValues(),o=r.test_type;h.value.push({type:o,result:r.test_results});let p=L.order,I="";const P=_(p)||p.value_text,R=await fe.getConceptID(P,!0);p!=null&&p.new_order&&(I=await Q(R,P,"Blood"));const M=await oe.buildResults([{name:"HIV test",concept_id:R,value:"".concat(o,"-").concat(r.test_results)}]);await oe.saveResults($.value,M,p.tests[0].id,I,m.value),l(o,r.test_results)?await d(o,r.test_results):he("Test result saved")},F=async()=>{var r,o,p,I,P,R,M;if(((r=b.value)==null?void 0:r.validateForm())!=null){we("Please fill in all required fields");return}switch(await x(),y.value){case"risk_category":await c();const i=await G(Ft,{class:"mediumAutoHeightModal"});i=="None"?await H():i&&(await u(),await H());break;case"unigold":(o=b.value)==null||o.resetForm(),(p=b.value)==null||p.setFormValue("test_type","Unigold");break;case"repeat_determine":(I=b.value)==null||I.resetForm(),(P=b.value)==null||P.setFormValue("test_type","Detremin");break;case"bioline":(R=b.value)==null||R.resetForm(),(M=b.value)==null||M.setFormValue("test_type","Bioline"),D();break;case"inconclusive":await O();break;case"Outcome summary":await H();break}},H=async()=>{await c(),await G(Nt,{class:"mediumAutoHeightModal"})},u=async()=>(await c(),await G(ft,{class:"mediumAutoHeightModal"})),c=async()=>{await ge.getTop()&&await ge.dismiss()},l=(r,o)=>r==="Detremin"&&o==="Non reactive"?!1:[...h.value].length>=3,d=async(r,o)=>{const p=h.value,I=p.find(M=>M.type==="Detremin"),P=p.find(M=>M.type==="Unigold"),R=p.find(M=>M.type==="Bioline");(I==null?void 0:I.result)==="Reactive"&&(P==null?void 0:P.result)==="Reactive"&&(R==null?void 0:R.result)==="Reactive"?await w():(R==null?void 0:R.result)==="Non reactive"&&await O()},w=async()=>{await c(),he("Positive result confirmed. Proceeding to ART enrollment.")},O=async()=>{await u(),await H()},q=async()=>{var r;try{const o=await oe.getLabResults($.value,9);if((r=o==null?void 0:o.latestTest)!=null&&r.value){const I=o.latestTest.value.split("-");I.length===2&&(h.value=[{type:I[0],result:I[1]}])}}catch(o){console.error("Error loading previous tests:",o)}},Q=async(r,o,p)=>{var M,i,t,E,z,Z;const I=[{order_type_id:9,concept_id:r,name:o,specimen:p,reason:"Routine",specimenConcept:await fe.getConceptID(p,!0)}],P=await Ge.buildLabOrders("",I,m.value),R=JSON.parse(JSON.stringify($.value));return(t=(i=(M=R.labOrders)!=null?M:R.labOrders={}).unsaved)!=null||(i.unsaved=[]),(Z=(z=(E=R.labOrders)!=null?E:R.labOrders={}).saved)!=null||(z.saved=[]),R.labOrders.unsaved.push(...P),$.value=R,P[0].offline_id};return be(async()=>{var r;m.value=(r=L.order)==null?void 0:r.past_date,await q(),D()}),(r,o)=>{const p=ce("ion-button");return k(),V("div",Bt,[a("div",Pt,[o[3]||(o[3]=a("h4",null,"HIV Testing",-1)),a("div",null,[o[2]||(o[2]=a("span",null,"Todays Date : ",-1)),a("span",null,C(B()),1)])]),a("div",null,[s(pe,{formData:W.value,ref_key:"formRef",ref:b},null,8,["formData"])]),a("div",Et,[o[4]||(o[4]=a("span",null,"Reported by: ",-1)),a("span",null,C(e(de).getUserName()),1)]),a("div",At,[s(p,{onClick:o[0]||(o[0]=I=>x())},{default:n(()=>[...o[5]||(o[5]=[v("Complete",-1)])]),_:1}),y.value?(k(),J(p,{key:0,onClick:o[1]||(o[1]=I=>F())},{default:n(()=>[v(C(f.value),1)]),_:1})):te("",!0)])])}}}),Xe=ae(Lt,[["__scopeId","data-v-72ae10d0"]]),Ut={style:{"padding-left":"10px","padding-right":"10px"}},Wt={class:"content"},qt={style:{"text-align":"center",padding:"15px"}},zt={style:{display:"flex","justify-content":"center",padding:"10px"}},Kt=ne({__name:"HepatitisModal",props:{order:{}},setup(N){const b=S(null);let T=S({});const $=ke(),{patient:h}=xe($),m=S(""),y=N,f=se(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:X.required,type:"inline",options:[{label:"Positive",value:"Positive"},{label:"Negative",value:"Negative"},{label:"Inconclusive",value:"Inconclusive"}]}]),L=()=>de.getSessionDate(),W=_=>{var x;if(_!=null&&_.tests)return(x=_==null?void 0:_.tests[0])==null?void 0:x.name},B=async()=>{var l,d,w,O;if(((l=b.value)==null?void 0:l.validateForm())!=null){we("Please fill in all required fields");return}let _=y.order;m.value=_.past_date;let x="";const F=W(_)||(_==null?void 0:_.value_text),H=await fe.getConceptID(F,!0);T.value=(d=b.value)==null?void 0:d.getFormValues(),_!=null&&_.new_order&&(x=await D(H,F,"Blood"));const u=await oe.buildResults([{name:F,concept_id:H,value:T.value.test_results}]),c=((O=(w=_==null?void 0:_.tests)==null?void 0:w[0])==null?void 0:O.id)||"";await oe.saveResults(h.value,u,c,x,m.value),await ge.dismiss()},D=async(_,x,F)=>{var l,d,w,O,q,Q;const H=[{order_type_id:9,concept_id:_,name:x,specimen:F,reason:"Routine",specimenConcept:await fe.getConceptID(F,!0)}],u=await Ge.buildLabOrders("",H,m.value);console.log("ðŸš€ ~ createLabOrder ~ data:=======------",u);const c=JSON.parse(JSON.stringify(h.value));return(w=(d=(l=c.labOrders)!=null?l:c.labOrders={}).unsaved)!=null||(d.unsaved=[]),(Q=(q=(O=c.labOrders)!=null?O:c.labOrders={}).saved)!=null||(q.saved=[]),c.labOrders.unsaved.push(...u),h.value=c,u[0].offline_id};return(_,x)=>{const F=ce("ion-button");return k(),V("div",Ut,[a("div",Wt,[a("h4",null,C(N.order.value_text)+" Testing",1),a("div",null,[x[1]||(x[1]=a("span",null,"Todays Date : ",-1)),a("span",null,C(L()),1)])]),a("div",null,[s(pe,{formData:f.value,ref_key:"formRef",ref:b},null,8,["formData"])]),a("div",qt,[x[2]||(x[2]=a("span",null,"Reported by: ",-1)),a("span",null,C(e(de).getUserName()),1)]),a("div",zt,[s(F,{onClick:x[0]||(x[0]=H=>B())},{default:n(()=>[...x[3]||(x[3]=[v("Complete",-1)])]),_:1})])])}}}),Qe=ae(Kt,[["__scopeId","data-v-c8a25de3"]]),Yt={class:"past-test-results"},jt={class:"header"},Jt={class:"test-results-list"},Gt={class:"test-info"},Xt={class:"test-name"},Qt={class:"test-date"},Zt={class:"add-results-section"},es={class:"modal-test-results-list"},ts={class:"test-info"},ss={class:"test-name"},ns={class:"test-date"},as=ne({__name:"PastTestResults",props:{results:{default:()=>[]}},emits:["seeFullHistory","enterKnownResults"],setup(N,{emit:b}){const T=N,$=b,h=S(!1),m=S(!1),y=S(null),f=se(()=>T.results||[]),L=se(()=>f.value.slice(0,3)),W=se(()=>[{componentType:"radioButtonField",header:"Select test",name:"test",obsValueType:"value_text",validation:X.required,type:"standard",options:[{label:"Hepatitis B Test",value:"Hepatitis B Test"},{label:"Hepatitis C Test",value:"Hepatitis C Test"},{label:"HIV test",value:"HIV test"},{label:"Syphilis",value:"Syphilis"}]},{componentType:"dateInputField",header:"Past Date",name:"past_date",validation:X.required}]),B=c=>{const l=c.toLowerCase();return l.includes("reactive")&&!l.includes("non reactive")||l.includes("positive")?"reactive":l.includes("non reactive")||l.includes("negative")?"non-reactive":(l.includes("inconclusive"),"default")},D=async()=>{var d;const c=(d=y.value)==null?void 0:d.getFormValues(),l={value_text:c.test,new_order:!0,past_date:c.past_date};u(),await _(l)},_=async c=>{c.value_text=="HIV test"&&await G(Xe,{class:"otherVitalsModal"},!0,{order:c}),(c.value_text=="Syphilis"||c.value_text=="Hepatitis B Test"||c.value_text=="Hepatitis C Test")&&await G(Qe,{class:"otherVitalsModal"},!0,{order:c})},x=()=>{m.value=!0},F=()=>{h.value=!0,$("seeFullHistory")},H=()=>{h.value=!1},u=()=>{m.value=!1};return(c,l)=>(k(),V("div",Yt,[a("div",jt,[l[2]||(l[2]=a("h2",{class:"header-title"},"PAST TEST RESULTS",-1)),s(e(Y),{fill:"clear",size:"small",class:"see-history-btn",onClick:F},{default:n(()=>[l[1]||(l[1]=v(" See full History ",-1)),s(e(ye),{icon:e(st),slot:"end"},null,8,["icon"])]),_:1})]),a("div",Jt,[(k(!0),V(ve,null,me(L.value,(d,w)=>(k(),J(e(U),{key:w,class:"test-result-item",lines:"none"},{default:n(()=>[a("div",Gt,[a("h3",Xt,C(d.name),1),a("p",Qt,C(d.date),1)]),s(e(Ee),{class:ue(["result-chip",B(d.value)]),slot:"end"},{default:n(()=>[v(C(d.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),a("div",Zt,[s(e(Y),{fill:"clear",size:"default",class:"add-results-btn",onClick:l[0]||(l[0]=d=>x())},{default:n(()=>[s(e(ye),{icon:e(nt),slot:"start"},null,8,["icon"]),l[3]||(l[3]=v(" Enter Known Past Results ",-1))]),_:1})]),s(e(Ae),{"is-open":h.value,onDidDismiss:H,class:"history-modal"},{default:n(()=>[s(e(Le),null,{default:n(()=>[s(e(Ue),null,{default:n(()=>[s(e(We),null,{default:n(()=>[v("Full Test History ("+C(f.value.length)+")",1)]),_:1}),s(e(qe),{slot:"end"},{default:n(()=>[s(e(Y),{onClick:H},{default:n(()=>[...l[4]||(l[4]=[v("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(e(ze),{class:"modal-content"},{default:n(()=>[a("div",es,[(k(!0),V(ve,null,me(f.value,(d,w)=>(k(),J(e(U),{key:"modal-".concat(w),class:"test-result-item",lines:"none"},{default:n(()=>[a("div",ts,[a("h3",ss,C(d.name),1),a("p",ns,C(d.date),1)]),s(e(Ee),{class:ue(["result-chip",B(d.value)]),slot:"end"},{default:n(()=>[v(C(d.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))])]),_:1})]),_:1},8,["is-open"]),s(e(Ae),{"is-open":m.value,onDidDismiss:u,class:"history-modal"},{default:n(()=>[s(e(Le),null,{default:n(()=>[s(e(Ue),null,{default:n(()=>[s(e(We),null,{default:n(()=>[...l[5]||(l[5]=[v("Select Test and Date",-1)])]),_:1}),s(e(qe),{slot:"end"},{default:n(()=>[s(e(Y),{onClick:u},{default:n(()=>[...l[6]||(l[6]=[v("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(e(ze),{class:"modal-content"},{default:n(()=>[s(pe,{formData:W.value,ref_key:"formRef",ref:y},null,8,["formData"])]),_:1}),s(e(at),{style:{padding:"10px"}},{default:n(()=>[s(pt,{style:{float:"right"},name:"Cont.",onClick:D})]),_:1})]),_:1},8,["is-open"])]))}}),ls=ae(as,[["__scopeId","data-v-b2ac8efe"]]),os={style:{"max-width":"900px",margin:"auto"}},is={style:{"--background":"#fff"}},rs={class:"demographics"},us={style:{"text-overflow":"ellipsis"}},ds={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},cs={style:{"margin-right":"5px"}},ps={style:{"margin-top":"5px"}},vs={class:"demographicsFirstRow"},ms={class:"name custom-name-container"},fs={class:"demographicsOtherRow",style:{"margin-top":"10px"}},_s={class:"demographicsText",style:{display:"flex","flex-wrap":"wrap"}},ys={style:{"flex-shrink":"0"}},gs={style:{"flex-shrink":"0"}},hs={key:0,class:"demographicsOtherRow"},ws={class:"demographicsText mediumFontColor"},bs={key:1,class:"demographicsOtherRow"},xs={class:"demographicsText mediumFontColor"},Ts={class:"demographicsOtherRow"},ks={class:"demographicsText smallFont"},Cs={class:"mediumFontColor"},Is={style:{background:"transparent"}},Rs={class:"graphSection"},Ss={class:"graphBtn",style:{"margin-bottom":"5px"}},$s={class:"weightHeightGraphBtns"},Fs={key:0},Hs={key:1},Ds={class:"test-results-container"},Vs={class:"test-buttons-container"},Os={style:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},Ms={class:"ion-padding",slot:"content"},Ns=ne({__name:"HTSPatientProfile",setup(N){const{event:b,popoverOpen:T,openPopover:$,openPIM:h,printVisitSummary:m,printID:y,formatCurrentAddress:f}=_t(),L=lt(),W=Te,B=S(!1),D=S(7),_=S([]),x=S([]),F=S([]),H=ke(),{patient:u}=xe(H),c=async i=>{D.value=i},l=async()=>{const i=oe.getLabResults(u.value,9);F.value=i.results},d=async()=>{var t,E,z,Z;const i=[...(E=(t=u.value)==null?void 0:t.labOrders)==null?void 0:E.saved,...(Z=(z=u.value)==null?void 0:z.labOrders)==null?void 0:Z.unsaved];x.value=i.filter(ie=>ie.order_type_id===9&&!ie.tests[0].result)},w=async()=>{var t;const i=await je.getObsByEncounterId(Je.REFERRAL);_.value=((t=i[0])==null?void 0:t.obs)||[]},O=i=>le.calculateDisplayAge(le.toStandardHisFormat(i)),q=()=>{var i,t,E,z;ct.isEmpty((t=(i=u.value)==null?void 0:i.personInformation)==null?void 0:t.birthdate)||(B.value=le.dateDiffInDays(le.sessionDate(),(z=(E=u.value)==null?void 0:E.personInformation)==null?void 0:z.birthdate)<42)},Q=()=>{G(gt,{class:"otherVitalsModal"})},r=()=>{G(ht,{class:"otherVitalsModal"})},o=i=>{var t;if(i!=null&&i.tests)return(t=i==null?void 0:i.tests[0])==null?void 0:t.name},p=async i=>{const t=o(i)||i.value_text;t=="HIV test"&&await G(Xe,{class:"otherVitalsModal"},!0,{order:i}),(t=="Syphilis"||t=="Hepatitis B Test"||t=="Hepatitis C Test")&&await G(Qe,{class:"otherVitalsModal"},!0,{order:i})},I=()=>!!new mt().isUnderFive(),P=()=>{console.log("Navigate to full history")},R=()=>{console.log("Enter known results")},M=()=>{var i,t;return le.toStandardHisDisplayFormat((t=(i=u.value)==null?void 0:i.personInformation)==null?void 0:t.birthdate)};return Ke(()=>L.currentRoute.value,async i=>{i.name=="patientProfile"&&u.value.patientID}),Ke(u,async()=>{u&&(q(),await l(),await d())}),be(async()=>{q(),await w(),await d(),await l()}),(i,t)=>{var z,Z,ie,Ce,Ie,Re,Se,$e,Fe,He,De,Ve,Oe,Me,Ne,Be;const E=ce("ion-icon");return k(),V("div",os,[a("div",is,[a("div",rs,[a("div",us,[a("div",ds,[a("div",cs,[s(e(ee),null,{default:n(()=>[s(e(K),null,{default:n(()=>{var g,A;return[a("div",{class:ue(((A=(g=e(u))==null?void 0:g.personInformation)==null?void 0:A.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor"),style:{display:"flex","flex-direction":"column","align-items":"center"}},[s(E,{style:{color:"#fff","font-size":"100px"},icon:e(ot)},null,8,["icon"])],2)]}),_:1})]),_:1}),s(e(ee),null,{default:n(()=>[s(e(K),null,{default:n(()=>[...t[15]||(t[15]=[a("span",{class:"pill-text"},"Returning Client",-1)])]),_:1})]),_:1})]),a("div",ps,[a("div",vs,[a("div",ms,[(Z=(z=e(u))==null?void 0:z.personInformation)!=null&&Z.given_name?(k(),J(e(ee),{key:0,class:"custom-name-row"},{default:n(()=>[s(e(K),{class:"custom-name-col"},{default:n(()=>{var g,A;return[v(C((A=(g=e(u))==null?void 0:g.personInformation)==null?void 0:A.given_name),1)]}),_:1})]),_:1})):te("",!0),(Ce=(ie=e(u))==null?void 0:ie.personInformation)!=null&&Ce.middle_name?(k(),J(e(ee),{key:1,class:"custom-name-row"},{default:n(()=>[s(e(K),{class:"custom-name-col"},{default:n(()=>{var g,A;return[v(C((A=(g=e(u))==null?void 0:g.personInformation)==null?void 0:A.middle_name),1)]}),_:1})]),_:1})):te("",!0),(Re=(Ie=e(u))==null?void 0:Ie.personInformation)!=null&&Re.family_name?(k(),J(e(ee),{key:2,class:"custom-name-row"},{default:n(()=>[s(e(K),{class:"custom-name-col"},{default:n(()=>{var g,A;return[v(C((A=(g=e(u))==null?void 0:g.personInformation)==null?void 0:A.family_name),1)]}),_:1})]),_:1})):te("",!0)])]),a("div",fs,[a("div",_s,[a("span",ys,C((($e=(Se=e(u))==null?void 0:Se.personInformation)==null?void 0:$e.gender)=="M"?"Male":"Female"),1),t[16]||(t[16]=a("span",{style:{"flex-shrink":"0"}},".",-1)),a("span",gs,C(O((He=(Fe=e(u))==null?void 0:Fe.personInformation)==null?void 0:He.birthdate))+" ("+C(M())+")",1)])]),(Ve=(De=e(u))==null?void 0:De.personInformation)!=null&&Ve.current_district?(k(),V("div",hs,[t[17]||(t[17]=a("div",{class:"demographicsText"},"Current Address:",-1)),a("div",ws,C(e(f)(e(u))),1)])):te("",!0),(Me=(Oe=e(u))==null?void 0:Oe.personInformation)!=null&&Me.country?(k(),V("div",bs,[t[18]||(t[18]=a("div",{class:"demographicsText"},"Country:",-1)),a("div",xs,C((Be=(Ne=e(u))==null?void 0:Ne.personInformation)==null?void 0:Be.country),1)])):te("",!0),a("div",Ts,[a("div",ks,[t[19]||(t[19]=v(" MRN: ",-1)),a("span",Cs,C(e(u).ID),1)])])])])]),a("div",Is,[s(e(ee),{class:"no-wrap-row",style:{"align-items":"center"}},{default:n(()=>[s(e(K),{style:{flex:"1","min-width":"0"}},{default:n(()=>[s(e(Y),{class:"deactivate-button",fill:"solid",shape:"round"},{default:n(()=>[...t[20]||(t[20]=[v(" Deactivate Visit ",-1)])]),_:1})]),_:1}),s(e(K),{size:"auto",style:{"flex-shrink":"0"}},{default:n(()=>[a("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:t[0]||(t[0]=g=>e($)(g))},[s(E,{icon:e(it)},null,8,["icon"])])]),_:1})]),_:1})])]),a("div",Rs,[a("div",null,[I()?(k(),J(yt,{key:0,checkUnderSixWeeks:B.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):te("",!0),I()?te("",!0):(k(),J(vt,{key:1}))]),a("div",Ss,[a("div",$s,[a("div",null,[s(e(Y),{class:"btnText",fill:"solid",onClick:t[1]||(t[1]=g=>r())},{default:n(()=>[B.value?(k(),V("span",Hs," Enter Weight")):(k(),V("span",Fs," Enter Weight/Height")),s(E,{slot:"end",size:"small",icon:e(W).whiteHeightWeight},null,8,["icon"])]),_:1})]),a("div",null,[s(e(Y),{class:"btnText",fill:"solid",onClick:t[2]||(t[2]=g=>Q())},{default:n(()=>[t[21]||(t[21]=v(" Enter Other Vitals ",-1)),s(E,{slot:"end",size:"small",icon:e(W).whiteVitals},null,8,["icon"])]),_:1})])])])]),a("div",null,[s(e(U),{class:"new-orders-header"},{default:n(()=>[s(e(j),{class:"new-orders-label"},{default:n(()=>[...t[22]||(t[22]=[v(" NEW ORDERS ",-1)])]),_:1})]),_:1}),a("div",Ds,[a("div",Vs,[s(e(Y),{class:"test-button",fill:"outline",shape:"round",onClick:t[3]||(t[3]=g=>p({value_text:"HIV test",new_order:!0}))},{default:n(()=>[...t[23]||(t[23]=[v(" HIV ",-1)])]),_:1}),s(e(Y),{class:"test-button",fill:"outline",shape:"round",onClick:t[4]||(t[4]=g=>p({value_text:"Syphilis",new_order:!0}))},{default:n(()=>[...t[24]||(t[24]=[v(" Syphilis ",-1)])]),_:1}),s(e(Y),{class:"test-button",fill:"outline",shape:"round",onClick:t[5]||(t[5]=g=>p({value_text:"Hepatitis B Test",new_order:!0}))},{default:n(()=>[...t[25]||(t[25]=[v(" Hepatitis B ",-1)])]),_:1}),s(e(Y),{class:"test-button",fill:"outline",shape:"round",onClick:t[6]||(t[6]=g=>p({value_text:"Hepatitis C Test",new_order:!0}))},{default:n(()=>[...t[26]||(t[26]=[v(" Hepatitis C ",-1)])]),_:1})]),s(ls,{results:F.value,onSeeFullHistory:P,onEnterKnownResults:R},null,8,["results"])]),s(e(U),{class:"new-orders-header",style:{"margin-top":"10px"}},{default:n(()=>[s(e(j),{class:"new-orders-label"},{default:n(()=>[...t[27]||(t[27]=[v(" ORDERS FROM OTHER CLINICS ",-1)])]),_:1})]),_:1}),a("div",Os,[(k(!0),V(ve,null,me(x.value,(g,A)=>(k(),J(e(ee),{key:A,style:{"margin-bottom":"10px"}},{default:n(()=>[s(e(K),null,{default:n(()=>[s(It,{title:o(g),status:"Referred ".concat(g.program_name),type:"hiv",onPressed:Bs=>p(g)},null,8,["title","status","onPressed"])]),_:2},1024)]),_:2},1024))),128))])])]),s(e(dt),{style:{"--offset-x":"-10px"},"is-open":e(T),"show-backdrop":!1,event:e(b),onDidDismiss:t[14]||(t[14]=g=>T.value=!1)},{default:n(()=>[a("div",null,[s(e(rt),{multiple:!0},{default:n(()=>[s(e(re),{value:"first","toggle-icon":"",onClick:t[7]||(t[7]=g=>e(h)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(j),null,{default:n(()=>[...t[28]||(t[28]=[v("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),s(e(re),{value:"first","toggle-icon":"",onClick:t[8]||(t[8]=()=>{})},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(j),null,{default:n(()=>[...t[29]||(t[29]=[v("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),s(e(re),{value:"second","toggle-icon":"",onClick:t[9]||(t[9]=g=>e(m)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(j),null,{default:n(()=>[...t[30]||(t[30]=[v("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),s(e(re),{value:"third","toggle-icon":"",onClick:t[10]||(t[10]=g=>e(y)())},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(j),null,{default:n(()=>[...t[31]||(t[31]=[v("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),s(e(re),{value:"fourth"},{default:n(()=>[s(e(U),{slot:"header",color:"light"},{default:n(()=>[s(e(j),null,{default:n(()=>[...t[32]||(t[32]=[v("Update outcome",-1)])]),_:1})]),_:1}),a("div",Ms,[s(e(ut),null,{default:n(()=>[s(e(U),null,{default:n(()=>[s(e(_e),{checked:D.value==7,value:"active",onIonChange:t[11]||(t[11]=g=>c(7))},{default:n(()=>[...t[33]||(t[33]=[v(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),s(e(U),null,{default:n(()=>[s(e(_e),{checked:D.value==6,value:"inactive",onIonChange:t[12]||(t[12]=g=>c(6))},{default:n(()=>[...t[34]||(t[34]=[v(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),s(e(U),null,{default:n(()=>[s(e(_e),{checked:D.value==3,value:"died",onIonChange:t[13]||(t[13]=g=>c(3))},{default:n(()=>[...t[35]||(t[35]=[v(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])}}}),ln=ae(Ns,[["__scopeId","data-v-9267cfb3"]]);export{ln as default};
