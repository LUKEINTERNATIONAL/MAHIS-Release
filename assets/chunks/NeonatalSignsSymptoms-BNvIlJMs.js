import{D as A,d as y,r as S,eN as R,w as d,e as V,f as b,l as g,u as h,a3 as O,a6 as T,an as $,aV as z,eO as B,H as _,O as j,J as I}from"./vendor-BEL70p3B.js";import{l as J,aC as k,_ as D,T as H,u as E,t as N,H as U,G as K}from"../index-BjLfgbqX.js";import{N as x}from"./neonatal_service-BKwvve1N.js";import{D as W}from"./DemographicBar-Cjs2Yzqw.js";import{N as Y}from"./NeonatalStepper-DD2J9kSA.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-c-NAnVx0.js";import"./SaveProgressModal-B15ElzrU.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const f=[{title:"Admission",subtitle:"Initial admission assessment",formData:[{componentType:"yesNoQuestion",name:"is_readmission",header:"Is this a re-admission?",validation:t=>t?null:"Please select Yes or No"}]},{title:"Signs/Symptoms",formData:[{componentType:"Alert",name:"presenting_complaints_banner",type:"warning",backgroundColor:"#FEDF89",textColor:"#B54708",message:"Reason for Admission / Presenting complaints"},{componentType:"multiSelectInputField",name:"presenting_complaints",header:"Your Selection",placeholder:"Search",icon:J.search,isMultiple:!0,closeOnSelect:!1,searchable:!0,trackBy:"value",options:[{label:"Lethargy",value:"lethargy"},{label:"Difficulty breathing",value:"difficulty_breathing"},{label:"Fever",value:"fever"},{label:"Irritability",value:"irritability"},{label:"Not tolerating feeds",value:"not_tolerating_feeds"},{label:"Vomiting",value:"vomiting"},{label:"Eye Discharge",value:"eye_discharge"},{label:"Diarrhoea",value:"diarrhoea"},{label:"Jaundice",value:"jaundice"},{label:"Convulsions",value:"convulsions"},{label:"Hypothermia",value:"hypothermia"},{label:"Poor feeding",value:"poor_feeding"},{label:"Cyanosis",value:"cyanosis"},{label:"Bleeding",value:"bleeding"},{label:"Abdominal distension",value:"abdominal_distension"},{label:"Umbilical discharge",value:"umbilical_discharge"},{label:"Skin rash",value:"skin_rash"},{label:"Pallor",value:"pallor"},{label:"Apnoea",value:"apnoea"}],validation:t=>!t||!Array.isArray(t)||t.length===0?"Please select at least one presenting complaint":null}]}],G={is_readmission:"",presenting_complaints:[],detailed_assessment_notes:"",symptom_onset_time:"",symptom_severity:""},F=Symbol("neonatalSignsSymptomsForm"),v=()=>JSON.parse(JSON.stringify(G)),L=A("neonatalSignsSymptomsStore",{state:()=>({activePatientId:null,formData:v(),formCache:{}}),actions:{initializeForPatient(t){if(t==null){this.activePatientId=null,Object.assign(this.formData,v());return}this.activePatientId=t;const c=String(t),a=this.formCache[c];a?Object.assign(this.formData,a):Object.assign(this.formData,v()),this.saveSnapshot()},saveSnapshot(){if(this.activePatientId==null)return;const t=String(this.activePatientId);this.formCache[t]=JSON.parse(JSON.stringify(this.formData))},resetActiveForm(){Object.assign(this.formData,v()),this.saveSnapshot()},clearPatient(t){delete this.formCache[String(t)],this.activePatientId===t&&this.resetActiveForm()}},persist:{paths:["activePatientId","formData","formCache"]}}),M={class:"signs-symptoms-section-wrapper"},Q=y({__name:"AdmissionSection",setup(t,{expose:c}){const a=S(null),i=f[0],p=i.formData,m=i.conditionalRules||[],r=R(F),l=e=>{r&&(r.is_readmission=e.is_readmission||"")};return d(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),d(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),c({getFormRef:()=>a.value,validateForm:()=>{var e,o;return((o=(e=a.value)==null?void 0:e.validateForm)==null?void 0:o.call(e))||null},getFormValues:()=>{var e,o;return((o=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:o.call(e))||{}}}),(e,o)=>(b(),V("div",M,[g(k,{formData:h(p),conditionalRules:h(m),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),P=D(Q,[["__scopeId","data-v-312c3ac7"]]),q={class:"signs-symptoms-section-wrapper"},X=y({__name:"PresentingComplaintsSection",setup(t,{expose:c}){const a=S(null),i=f[1],p=i.formData,m=i.conditionalRules||[],r=R(F),l=e=>{r&&(r.presenting_complaints=e.presenting_complaints||[])};return d(()=>{var e;return(e=a.value)==null?void 0:e.formValues},e=>{e&&l(e)},{deep:!0}),d(()=>a.value,e=>{e!=null&&e.getFormValues&&l(e.getFormValues())},{immediate:!0}),c({getFormRef:()=>a.value,validateForm:()=>{var e,o;return((o=(e=a.value)==null?void 0:e.validateForm)==null?void 0:o.call(e))||null},getFormValues:()=>{var e,o;return((o=(e=a.value)==null?void 0:e.getFormValues)==null?void 0:o.call(e))||{}}}),(e,o)=>(b(),V("div",q,[g(k,{formData:h(p),conditionalRules:h(m),ref_key:"formRef",ref:a},null,8,["formData","conditionalRules"])]))}}),C=D(X,[["__scopeId","data-v-2ad14f66"]]),Z=y({name:"NeonatalSignsSymptoms",components:{IonPage:T,IonContent:O,Toolbar:H,DemographicBar:W,NeonatalStepper:Y,AdmissionSection:P,PresentingComplaintsSection:C},setup(){const t=$(),c=E(),{patient:a}=z(c),i=L(),p=n=>{const s=Number(n);return Number.isFinite(s)?s:null},m=()=>{var s;const n=p((s=a.value)==null?void 0:s.patientID);i.initializeForPatient(n)};m(),d(()=>{var n;return(n=a.value)==null?void 0:n.patientID},()=>m());const r=i.formData;B(F,r),d(()=>i.formData,()=>i.saveSnapshot(),{deep:!0});const l=S(f.map((n,s)=>({title:n.title,number:s+1,checked:!1,class:s===0?"open_step common_step":"common_step",last_step:s===f.length-1?"last_step":""}))),e=[{title:f[0].title,value:"1",component:P,configIndex:0},{title:f[1].title,value:"2",component:C,configIndex:1}],o="Signs & Symptoms Assessment",w=S("1");return{wizardData:l,stepperData:e,stepperTitle:o,currentOpenStepper:w,updateStatus:n=>{n&&n.value&&l.value.forEach((s,u)=>{n.value===(u+1).toString()?(s.class="open_step common_step",s.checked=!1):u<parseInt(n.value)-1?(s.class="common_step color_white",s.checked=!0):(s.class="common_step",s.checked=!1)})},getSaveFunction:n=>n===e.length-1?async()=>{var s;if(!((s=a.value)!=null&&s.patientID)){N("No patient selected");return}try{const u=U.sessionDate();await x.saveSignsSymptomsAssessment(a.value.patientID,r,u),K("Signs & symptoms assessment saved successfully"),i.clearPatient(a.value.patientID),t.push({path:"/neonatal/review-of-systems"})}catch(u){console.error("Failed to save signs/symptoms assessment",u),N("Failed to save signs/symptoms assessment")}}:null}}});function ee(t,c,a,i,p,m){const r=_("Toolbar"),l=_("NeonatalStepper"),e=_("ion-content"),o=_("ion-page");return b(),j(o,{class:"neonatal-signs-symptoms-page"},{default:I(()=>[g(r),g(e,{fullscreen:!0},{default:I(()=>[g(l,{wizardData:t.wizardData,StepperData:t.stepperData,stepperTitle:t.stepperTitle,openStepper:t.currentOpenStepper,backUrl:"/NeonatalHome",getSaveFunction:t.getSaveFunction,flowType:"signsSymptoms",onUpdateStatus:t.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}const fe=D(Z,[["render",ee],["__scopeId","data-v-c92f7cbc"]]);export{fe as default};
