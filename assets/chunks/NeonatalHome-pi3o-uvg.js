var Pe=Object.defineProperty;var Re=(n,d,r)=>d in n?Pe(n,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[d]=r;var H=(n,d,r)=>Re(n,typeof d!="symbol"?d+"":d,r);import{d as T,O as k,f as l,u as a,bp as q,p as P,J as m,l as o,aT as K,k as i,e as g,m as _e,K as b,c as O,Q as j,bh as ze,I as Ee,G as Fe,E as He,aZ as Oe,N as je,L as Ge,aR as qe,a3 as ve,j as Ke,an as Qe,r as M,a as Ue,a4 as me,F as L,P as p,a5 as ge,bl as he,dQ as B,a6 as We}from"./vendor-BpjEhVym.js";import{_ as A,u as Je,T as Ze}from"../index-w7et50Z9.js";import{N as Xe}from"./neonatal_service-CbdxkhlY.js";import{I as C}from"./images-DJIykHYW.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-DMAoEdNS.js";const I=class I{constructor(){H(this,"statusColorMap",{admitted:"primary",discharged:"success",critical:"warning"})}getStatusColor(d){var r;return(r=this.statusColorMap[d.toLowerCase()])!=null?r:"medium"}formatWeight(d){return"".concat((d/1e3).toFixed(2)," kg")}static getInstance(){return I.instance||(I.instance=new I),I.instance}};H(I,"instance");let G=I;const Ye=G.getInstance(),z=[{label:"Triaged without Registration",key:"enrolled",iconSrc:C.icons.triaged},{label:"Admitted Today",key:"admitted",iconSrc:C.icons.newborn},{label:"Discharged Today",key:"discharged",iconSrc:C.icons.babyCarriage},{label:"Critical",key:"critical",iconSrc:C.icons.warningSign,isCritical:!0}],Ve=[{label:"Start Emergency Triage",iconSrc:C.icons.electrocardiogram,iconClass:"emergency-icon",route:"/neonatal/triage",query:{source:"dashboard"}},{label:"Instruction Guides",iconSrc:C.icons.info,route:"/neonatal/guides"}],ye={class:"stat-icon-wrapper"},et=["innerHTML"],tt=["src","alt"],st={class:"stat-label"},nt=T({__name:"card",props:{label:{},value:{},iconSrc:{},svgIcon:{},isCritical:{type:Boolean},clickable:{type:Boolean}},emits:["click"],setup(n,{emit:d}){const r=n,v=d,h=()=>{r.clickable&&v("click")};return(_,$)=>(l(),k(a(q),{class:P(["stat-card",{"is-clickable":n.clickable}]),onClick:h},{default:m(()=>[o(a(K),{class:"stat-content"},{default:m(()=>[i("div",ye,[n.svgIcon?(l(),g("div",{key:0,innerHTML:n.svgIcon,class:"stat-icon"},null,8,et)):n.iconSrc?(l(),g("img",{key:1,src:n.iconSrc,class:"stat-icon critical-icon",alt:n.label},null,8,tt)):_e("",!0)]),i("div",st,b(n.label),1),i("div",{class:P(["stat-value",{"critical-value":n.isCritical}])},b(n.value),3)]),_:1})]),_:1},8,["class"]))}}),at=A(nt,[["__scopeId","data-v-cc8c780a"]]),it={class:"action-icon-wrapper"},ot=["innerHTML"],ct=["src","alt"],lt={class:"action-label"},rt=T({__name:"action-card",props:{label:{},svgIcon:{},iconSrc:{},iconClass:{}},emits:["click"],setup(n,{emit:d}){const r=d,v=()=>{r("click")};return(h,_)=>(l(),k(a(q),{class:"action-card",onClick:v},{default:m(()=>[o(a(K),{class:"action-content"},{default:m(()=>[i("div",it,[n.svgIcon?(l(),g("div",{key:0,innerHTML:n.svgIcon,class:P(["action-icon",n.iconClass])},null,10,ot)):n.iconSrc?(l(),g("img",{key:1,src:n.iconSrc,class:P(["action-icon",n.iconClass]),alt:n.label},null,10,ct)):_e("",!0)]),i("div",lt,b(n.label),1)]),_:1})]),_:1}))}}),ut=A(rt,[["__scopeId","data-v-fc22b927"]]),dt={class:"neonate-info"},mt={class:"neonate-name"},gt={class:"neonate-mrn"},ht={class:"neonate-details"},ft={class:"detail-item"},_t=["src"],vt={class:"detail-item"},bt=["src"],kt={class:"neonate-status"},Ct=T({__name:"neonate-card",props:{neonate:{},getStatusColor:{type:Function}},emits:["click"],setup(n,{emit:d}){const r=n,v=d,h=O(()=>r.getStatusColor(r.neonate.status)),_=()=>{v("click",r.neonate.id)};return($,x)=>(l(),k(a(q),{class:"neonate-card",onClick:_},{default:m(()=>[o(a(K),{class:"neonate-content"},{default:m(()=>[i("div",dt,[i("div",mt,b(n.neonate.name),1),i("div",gt,b(n.neonate.mrn),1),i("div",ht,[i("span",ft,[i("img",{src:a(C).icons.deliveryTime,class:"detail-icon"},null,8,_t),j(" "+b(n.neonate.age),1)]),i("span",vt,[i("img",{src:a(C).icons.babyWeight,class:"detail-icon"},null,8,bt),j(" "+b(n.neonate.weight),1)])])]),i("div",kt,[i("div",{class:P(["status-badge","status-".concat(h.value)])},b(n.neonate.status),3)])]),_:1})]),_:1}))}}),fe=A(Ct,[["__scopeId","data-v-60eeda47"]]),St={class:"drilldown-content"},$t={key:0,class:"empty-drilldown"},It={key:1,class:"drilldown-list"},wt=T({__name:"DrilldownModal",props:{isOpen:{type:Boolean},title:{},isEmpty:{type:Boolean,default:!1},emptyMessage:{default:"No items available."}},emits:["close","dismiss"],setup(n,{emit:d}){const r=d,v=qe,h=()=>{r("close")},_=()=>{r("dismiss")};return($,x)=>(l(),k(a(ze),{"is-open":n.isOpen,onDidDismiss:_,class:"drilldown-modal"},{default:m(()=>[o(a(Ee),null,{default:m(()=>[o(a(Fe),null,{default:m(()=>[o(a(He),null,{default:m(()=>[j(b(n.title),1)]),_:1}),o(a(Oe),{slot:"end"},{default:m(()=>[o(a(je),{fill:"clear",onClick:h},{default:m(()=>[o(a(Ge),{slot:"icon-only",icon:a(v)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(a(ve),null,{default:m(()=>[i("div",St,[n.isEmpty?(l(),g("div",$t,b(n.emptyMessage),1)):(l(),g("div",It,[Ke($.$slots,"default",{},void 0,!0)]))])]),_:3})]),_:3},8,["is-open"]))}}),Nt=A(wt,[["__scopeId","data-v-912ed09a"]]),Tt={class:"neonatal-dashboard"},At={class:"header-image"},xt=["src"],Dt={class:"section-container"},Mt={class:"section-container"},Lt={class:"section-container"},pt={key:0,class:"neonates-list"},Bt={class:"skeleton-content"},Pt={key:1,class:"neonates-list"},Rt={key:2,class:"empty-neonates"},zt=T({__name:"LandingPage",setup(n){const d={enrolled:"In patient",admitted:"Admitted",discharged:"Discharged",critical:"Critical"},r=()=>z.reduce((e,t)=>(e[t.key]={count:0,neonates:[]},e),{}),v=Qe(),h=M(r()),_=M([]),$=M(!0),x=M(!1),w=M(null),R=O(()=>{var e,t;return w.value?(t=(e=h.value[w.value])==null?void 0:e.neonates)!=null?t:[]:[]}),be=e=>{var t,s;return e&&(s=(t=z.find(c=>c.key===e))==null?void 0:t.label)!=null?s:"Neonates"},ke=O(()=>{const e=be(w.value);return R.value.length?"".concat(e," (").concat(R.value.length,")"):e}),Ce=e=>{var t,s;return(s=(t=h.value[e])==null?void 0:t.count)!=null?s:0},Q=e=>{var t,s;return((s=(t=h.value[e])==null?void 0:t.neonates.length)!=null?s:0)>0},Se=e=>{Q(e)&&(w.value=e,x.value=!0)},U=()=>{x.value=!1,w.value=null},$e=e=>{v.push({path:e.route,query:e.query})},W=e=>{v.push({path:e})},J=async e=>{try{await Je().setPatientRecord({patientID:Number(e)}),W("/patientProfile?id=".concat(e))}catch(t){console.error("[NeonatalLanding] Failed to load patient:",t),W("/patientProfile?id=".concat(e))}},Z=e=>Ye.getStatusColor(e),Ie=async()=>{try{$.value=!0;const e=await Xe.getStatistics();h.value=we(e),e.recent_neonates&&Array.isArray(e.recent_neonates)?_.value=e.recent_neonates.map(t=>({id:String(t.id||t.patient_id||""),name:t.name||"Unknown Neonate",mrn:t.mrn||"N/A",age:t.age||"—",weight:t.weight||"—",status:t.status||"In patient"})):De()}catch(e){console.error("[NeonatalLanding] Failed to load statistics",e),h.value=r(),_.value=[]}finally{$.value=!1}},we=e=>{const t=r();return z.forEach(s=>{var S,N;const c=s.key,f=(N=e==null?void 0:e[c])!=null?N:(S=e==null?void 0:e.stats)==null?void 0:S[c],u=Ne(e,c);t[c]=Te(f,u,c)}),t},Ne=(e,t)=>{var c,f,u,S,N;return e?(N=[(c=e==null?void 0:e.neonates)==null?void 0:c[t],(f=e==null?void 0:e.details)==null?void 0:f[t],e==null?void 0:e["".concat(t,"_neonates")],e==null?void 0:e["".concat(t,"_patients")],e==null?void 0:e["".concat(t,"_records")],(u=e==null?void 0:e[t])==null?void 0:u.neonates,(S=e==null?void 0:e[t])==null?void 0:S.patients].find(F=>Array.isArray(F)))!=null?N:[]:[]},Te=(e,t,s)=>{if(typeof e=="number")return{count:e,neonates:E(t,s)};if(e&&typeof e=="object"){const f=Array.isArray(e.neonates)?e.neonates:Array.isArray(e.patients)?e.patients:t,u=E(f,s);return{count:typeof e.count=="number"?e.count:typeof e.total=="number"?e.total:typeof e.value=="number"?e.value:u.length,neonates:u}}const c=E(t,s);return{count:c.length,neonates:c}},E=(e,t)=>Array.isArray(e)?e.map((s,c)=>Ae(s,t,c)):[],Ae=(e,t,s)=>{var X,Y,V,y,ee,te,se,ne,ae,ie,oe,ce,le,re,ue,de;const c=d[t],f="".concat(t,"-").concat(s);if(e!=null&&e.name&&(e!=null&&e.mrn))return{id:String((X=e.id)!=null?X:f),name:e.name,mrn:e.mrn,age:(Y=e.age)!=null?Y:"—",weight:(V=e.weight)!=null?V:"—",status:(y=e.status)!=null?y:c};const u=(ee=e==null?void 0:e.patient)!=null?ee:e,S=(ne=(se=(te=e==null?void 0:e.id)!=null?te:e==null?void 0:e.patient_id)!=null?se:u==null?void 0:u.patient_id)!=null?ne:f,F=[e==null?void 0:e.name,u==null?void 0:u.given_name,u==null?void 0:u.family_name].filter(Boolean).join(" ").trim()||"Unknown Neonate",Me=(oe=(ie=(ae=e==null?void 0:e.mrn)!=null?ae:e==null?void 0:e.identifier)!=null?ie:u==null?void 0:u.identifier)!=null?oe:"N/A",Le=(le=(ce=e==null?void 0:e.age)!=null?ce:xe(u==null?void 0:u.birthdate))!=null?le:"—",D=(ue=(re=e==null?void 0:e.weight)!=null?re:e==null?void 0:e.latest_weight)!=null?ue:e==null?void 0:e.weight_kg,pe=typeof D=="number"?"".concat(D.toFixed(2)," Kg"):D!=null?D:"—",Be=(de=e==null?void 0:e.status)!=null?de:c;return{id:String(S),name:F,mrn:Me,age:Le,weight:pe,status:Be}},xe=e=>{if(!e)return null;const t=new Date(e);if(Number.isNaN(t.getTime()))return null;const s=Date.now()-t.getTime(),c=Math.floor(s/(1e3*60*60));if(c<24)return"".concat(c," hrs old");const f=Math.floor(c/24);return f<1?"Today":"".concat(f," day").concat(f===1?"":"s"," old")},De=()=>{const e=Object.values(h.value).flatMap(t=>t.neonates).slice(0,5);_.value=e};return Ue(()=>{Ie()}),(e,t)=>(l(),g("div",Tt,[i("div",At,[i("img",{src:a(C).banners.babyHand,alt:"baby-hand-banner",style:{"object-fit":"cover"}},null,8,xt)]),i("div",Dt,[t[0]||(t[0]=i("h2",{class:"section-title"},"Today's Stats",-1)),o(a(he),{class:"stats-grid"},{default:m(()=>[o(a(me),null,{default:m(()=>[(l(!0),g(L,null,p(a(z),s=>(l(),k(a(ge),{key:s.key,size:"6","size-md":"3"},{default:m(()=>[o(at,{label:s.label,value:Ce(s.key),"icon-src":s.iconSrc,"svg-icon":s.svgIcon,"is-critical":s.isCritical,clickable:Q(s.key),onClick:c=>Se(s.key)},null,8,["label","value","icon-src","svg-icon","is-critical","clickable","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),i("div",Mt,[t[1]||(t[1]=i("h2",{class:"section-title"},"Quick Actions",-1)),o(a(he),{class:"actions-grid"},{default:m(()=>[o(a(me),null,{default:m(()=>[(l(!0),g(L,null,p(a(Ve),s=>(l(),k(a(ge),{key:s.route,size:"6","size-md":"6"},{default:m(()=>[o(ut,{label:s.label,"svg-icon":s.svgIcon,"icon-src":s.iconSrc,"icon-class":s.iconClass,onClick:c=>$e(s)},null,8,["label","svg-icon","icon-src","icon-class","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),i("div",Lt,[t[2]||(t[2]=i("h2",{class:"section-title"},"Recent Neonates",-1)),$.value?(l(),g("div",pt,[(l(),g(L,null,p(5,s=>i("div",{key:"skeleton-".concat(s),class:"neonate-skeleton"},[o(a(B),{animated:!0,style:{width:"60px",height:"60px","border-radius":"50%"}}),i("div",Bt,[o(a(B),{animated:!0,style:{width:"70%",height:"20px","margin-bottom":"8px"}}),o(a(B),{animated:!0,style:{width:"50%",height:"16px","margin-bottom":"4px"}}),o(a(B),{animated:!0,style:{width:"40%",height:"16px"}})]),o(a(B),{animated:!0,style:{width:"80px",height:"24px","border-radius":"12px"}})])),64))])):_.value.length?(l(),g("div",Pt,[(l(!0),g(L,null,p(_.value,s=>(l(),k(fe,{key:s.id,neonate:s,"get-status-color":Z,onClick:J},null,8,["neonate"]))),128))])):(l(),g("div",Rt,"No recent neonates to display."))]),o(Nt,{"is-open":x.value,title:ke.value,"is-empty":!R.value.length,"empty-message":"No neonates available for this statistic.",onClose:U,onDismiss:U},{default:m(()=>[(l(!0),g(L,null,p(R.value,s=>(l(),k(fe,{key:"".concat(w.value,"-").concat(s.id),neonate:s,"get-status-color":Z,onClick:J},null,8,["neonate"]))),128))]),_:1},8,["is-open","title","is-empty"])]))}}),Et=A(zt,[["__scopeId","data-v-f305a4c6"]]),Ft=T({__name:"NeonatalHome",setup(n){return(d,r)=>(l(),k(a(We),null,{default:m(()=>[o(Ze),o(a(ve),{fullscreen:!0},{default:m(()=>[o(Et)]),_:1})]),_:1}))}}),Ut=A(Ft,[["__scopeId","data-v-052dae1c"]]);export{Ut as default};
