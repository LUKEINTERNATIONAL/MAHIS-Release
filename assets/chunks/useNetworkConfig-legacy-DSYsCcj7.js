System.register(["../index-legacy-qAAykQ1T.js","./vendor-legacy-Bsps4SCm.js"],function(o,e){"use strict";var r,n,t,c,a,i;return{setters:[o=>{r=o.y,n=o.a1,t=o.t,c=o.S,a=o.G},o=>{i=o.r}],execute:function(){o("u",function(){const o=r(),e=n(),l=i(!1),s=i(!1),u=async e=>{try{l.value=!0;const r={...e,configuredBy:c.getUserName(),configuredAt:(new Date).toISOString(),locationId:c.getUserLocationId()};return await o.setGlobalProperty("facility_network_config",JSON.stringify(r)),f(e),a("Network configuration saved for entire facility!",3e3),!0}catch(r){return console.error("Error saving global network config:",r),t("Failed to save global configuration. Saved locally only."),!1}finally{l.value=!1}},g=async()=>{try{l.value=!0;const o=await c.getJson("global_properties",{property:"facility_network_config"});if(o&&o.facility_network_config){const e=JSON.parse(o.facility_network_config);if(e.locationId===c.getUserLocationId())return e}return null}catch(o){return console.error("Error loading global network config:",o),null}finally{l.value=!1}},f=o=>{e.setConfig(o)},y=()=>e.loadFromLocalStorage()?e.config:null,d=()=>{const o=c.getUserRoles()||[];return o.includes("Superuser")||o.includes("Superuser,Superuser,")};return{isLoading:l,saveAsGlobalProperty:u,loadFromGlobalProperty:g,saveToLocalStorage:f,loadFromLocalStorage:y,autoDiscoverConfig:async()=>{if(s.value)return{success:!1,config:null,source:"none"};s.value=!0;try{const o=await g();if(o)return e.setConfig({...o,configSource:"global_property"}),a("Network configuration loaded from facility settings",4e3),{success:!0,config:o,source:"global_property"};const r=y();return r?{success:!0,config:r,source:"local_storage"}:{success:!1,config:null,source:"none"}}catch(o){return console.error("Error during auto-discovery:",o),{success:!1,config:null,source:"none"}}},hasGlobalConfig:async()=>null!==await g(),getConfigSource:()=>localStorage.getItem("network_config_source")||"manual",isSuperUser:d,syncLocalToGlobal:async()=>{if(!d())return t("Only super users can save facility-wide network configurations"),!1;const o=y();return o?await u(o):(t("No local configuration found to sync"),!1)}}})}}});
