!function(){function e(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./vendor-legacy-IGuUoRYO.js","../index-legacy-CPN3hcLt.js"],function(t,n){"use strict";var a,i,s,l,o,r,u,d,m,c,f,p,v,y,g,h,_,b,D,I,T,w,C,x,P,S,k,R,L,B,E,N,j,F,M;return{setters:[e=>{a=e.d,i=e.r,s=e.aF,l=e.bh,o=e.a,r=e.G,u=e.e,d=e.f,m=e.F,c=e.l,f=e.u,p=e.K,v=e.H,y=e.ay,g=e.az,h=e.k,_=e.I,b=e.b8,D=e.P,I=e.J,T=e.L,w=e.b9,C=e.bE,x=e.M},e=>{P=e.aY,S=e.O,k=e.u,R=e.n,L=e.C,B=e.S,E=e.g,N=e.aq,j=e.bq,F=e.G,M=e._}],execute:function(){var n=document.createElement("style");n.textContent="ion-footer[data-v-9a2f68e9]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-9a2f68e9]{--width: 90%;--height: 94%}\n/*$vite$:1*/",document.head.appendChild(n);class H extends P{constructor(t){super(t,32),e(this,"patientID",void 0),e(this,"testTypeID",void 0),e(this,"resultDate",void 0),e(this,"testID",void 0),this.patientID=t,this.testTypeID=-1,this.resultDate="",this.testID=-1}createLabResult(e){return P.postJson(`lab/tests/${this.testID}/results`,{encounter_id:this.encounterID,date:this.resultDate,measures:e})}getTestID(){return this.testID}getTestTypeID(){return this.testTypeID}setTestTypeID(e){this.testTypeID=e}setResultDate(e){this.resultDate=e}setTestID(e){this.testID=e}getTestsWithoutResults(){return S.getOrders(this.patientID,{status:"drawn"})}getTestIndicators(){return S.getJson("lab/test_result_indicators",{test_type_id:this.testTypeID})}static getTestIndicatorsWithID(e){return S.getJson("lab/test_result_indicators",{test_type_id:e})}}const O={style:{display:"flex","align-items":"center"}},V={style:{"margin-left":"6px"}},z={style:{"font-weight":"400","font-size":"19px"}},J={style:{display:"flex","align-items":"center"}},K={style:{"font-weight":"400","font-size":"20px"}},W={style:{display:"flex","align-items":"center"}},$=a({__name:"EnterLabResultsModal",props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:()=>({})},popoverOpen:{type:Boolean,default:!1},event:{default:""},title:{default:""},test_data:{}},emits:["closePopoover","closeModal","saved"],setup(e,{emit:t}){var n,a;const P=e;let S=i([]);s();const M=k(),{patient:$}=l(M),q=i(null),A=i((null===(n=P.test_data)||void 0===n?void 0:n.tests[0])||{}),G=i((null===(a=A.value)||void 0===a?void 0:a.name)||""),U=()=>{x.dismiss()},Y=async()=>{var e,t,n;const a=null===(e=q.value)||void 0===e?void 0:e.getFormValues(),i=await Promise.all(Object.entries(a).map(async([e,t])=>({name:e,concept_id:await N.getConceptID(e,!0),value:(null==t?void 0:t.name)||t}))),s=await j.buildResults(i);await j.saveResults($.value,s,null===(t=A.value)||void 0===t?void 0:t.id,null===(n=P.test_data)||void 0===n?void 0:n.offline_id),F("Lab results saved successfully"),U()};return o(async()=>{await(async e=>{let t;t=B.getPouchDbStatus()||B.getLanConnectionStatus()?await E("test_result_indicators",{selector:{concept_id:e.concept_id}}):await H.getTestIndicatorsWithID(e.concept_id),t.forEach(e=>{let t={componentType:"inputField",name:e.name,header:e.name,grid:{s:"3"}};if("RBS"!=e.name&&"FBS"!=e.name||(t={...t,unit:"mg/dl"}),"MRDT"==e.name||"Tuberculosis program"==e.name||"Vdrl"==e.name||"Hepatitis B"==e.name||"Lam"==e.name||"CrAg"==e.name||"CD4 count"==e.name||"Leukocytes"==e.name||"Protein"==e.name||"Nitrite"==e.name||"Urine Ketones"==e.name||"HIV test"==e.name){let n=[];"MRDT"!=e.name&&"Vdrl"!=e.name&&"Hepatitis B"!=e.name&&"CrAg"!=e.name&&"Lam"!=e.name||(n=[{id:"1",name:"Positive"},{id:"2",name:"Negative"},{id:"3",name:"Invalid"}]),"Tuberculosis program"==e.name&&(n=[{id:"1",name:"Scanty"},{id:"2",name:"Negative"},{id:"3",name:"1+"},{id:"4",name:"2+"},{id:"5",name:"3+"}]),"CD4 count"==e.name&&(n=[{id:"1",name:"below reference line"},{id:"2",name:"above reference line"}]),"Leukocytes"!=e.name&&"Protein"!=e.name&&"Nitrite"!=e.name&&"Ketones"!=e.name&&"Urine Ketones"!=e.name||(n=[{id:"2",name:"Negative"},{id:"1",name:"Trace"},{id:"3",name:"1+"},{id:"4",name:"2+"},{id:"5",name:"3+"},{id:"6",name:"4+"}]),"HIV test"==e.name&&(n=[{id:"2",name:"Positive"},{id:"1",name:"Negative"},{id:"3",name:"Invalid"}]),t={componentType:"multiSelectInputField",header:e.name,name:e.name,trackBy:"id",icon:R.search,options:n}}S.value.push(t)})})(A.value)}),(e,t)=>{const n=r("ion-icon");return d(),u(m,null,[c(f(p),null,{default:v(()=>[c(f(y),null,{default:v(()=>[c(f(g),null,{default:v(()=>[h("div",O,[c(n,{icon:f(R).saveWhite,class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),h("b",V,"Enter lab results for "+_(G.value),1)])]),_:1}),c(f(b),{slot:"end"},{default:v(()=>[c(f(g),null,{default:v(()=>[c(f(D),{onClick:t[0]||(t[0]=e=>U()),fill:"solid"},{default:v(()=>[h("span",z,[h("div",J,[c(n,{icon:f(I),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[1]||(t[1]=h("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),c(f(T),{class:"ion-padding"},{default:v(()=>[c(L,{formData:f(S),ref_key:"formRef",ref:q},null,8,["formData"])]),_:1}),c(f(w),null,{default:v(()=>[c(f(y),null,{default:v(()=>[c(f(b),{slot:"end"},{default:v(()=>[c(f(g),null,{default:v(()=>[c(f(D),{onClick:Y,color:"primary",fill:"solid"},{default:v(()=>[h("span",K,[h("div",W,[c(n,{icon:f(C),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[2]||(t[2]=h("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});t("E",M($,[["__scopeId","data-v-9a2f68e9"]]))}}})}();
