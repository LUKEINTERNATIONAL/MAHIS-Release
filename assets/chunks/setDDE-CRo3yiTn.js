import{d as P,af as g,bF as F,ae as $,M as k,G as L,E as M,ag as B,ah as V,a6 as T,I as N,ab as U,z as A,H as i,O as Y,f as u,J as t,e as c,m as S,l as a,k as r,Q as n,K as l,p as G}from"./vendor-BTebhqHt.js";import{D as z}from"./OutcomeModal-CB53xOzq.js";import{D as Q,T as j,H as J,a1 as y,S as D,F as b,t as E,a0 as K,a6 as O,o as R,a7 as W,Q as _,a8 as q,n as X,_ as Z}from"../index-CdDTX_Tr.js";import{B as x}from"./BasicForm-DxE5nNay.js";import{F as aa}from"./FacilityInformationBar-CazoS-bf.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-no8IW45T.js";import"./DateInputField-B7-Va1Ic.js";const ta=P({name:"Menu",components:{IonContent:U,IonHeader:N,IonItem:T,IonList:V,IonMenu:B,IonTitle:M,IonToolbar:L,BasicForm:x,Toolbar:j,DynamicButton:Q,IonFooter:k,IonPage:$,FacilityInformationBar:aa,IonToggle:F},data(){return{cardData:{},inputField:"",isDDEEnabled:!0,setName:"",initialPersonalData:[],iconsContent:X,apiDate:"",date:"",DDE:{},isLoading:!1}},computed:{...g(q,["sessionDate"]),...g(_,["globalPropertyStore"])},watch:{globalPropertyStore:{async handler(){await this.setDDEStatus()},deep:!0},$route:{async handler(){await this.ddeData()},deep:!0}},async mounted(){try{this.isLoading=!1,await _().loadDDEStatus(),this.apiDate=await D.getApiDate(),await this.ddeData(),this.date=y(this.sessionDate,"sessionDate","value"),this.isLoading=!1}catch(s){console.log(s)}},methods:{async setDDEStatus(){await _().setGlobalProperty("dde_enabled","".concat(this.globalPropertyStore.dde_enabled)),await this.ddeData()},async ddeData(){if(this.globalPropertyStore.dde_enabled==="true")try{const e=(await W.getRemainingNpids()).npid_status[0],p=e.unassigned,f=e.avg_consumption_rate_per_day||1;this.DDE={id:e.location_id,avg:f,unassigned:e.unassigned,assigned:e.assigned,daysLeft:Math.floor(p/f),allocated:e.allocated,unallocated:e.unallocated,lastUpdated:A(e.date_last_updated).format("DD/MMM/YYYY HH:mm:ss"),title:e.location_name+" DDE NPID Status"}}catch(s){}},openModal(){R(z)},S(s){return O(this.sessionDate,s.name,this[s.name])},handleInputData(){},async resetSessionDate(){K(this.sessionDate,"sessionDate","value","");try{await D.resetSessionDate(),b("Session date has been reset to ".concat(this.formatDate(this.apiDate))),this.redirect()}catch(s){E("".concat(s))}},redirect(){this.$router.back()},async onSubmit(){this.date=y(this.sessionDate,"sessionDate","value");try{await D.setSessionDate(this.date),b("Successfully Back dated to ".concat(this.formatDate(this.date))),this.redirect()}catch(s){E("".concat(s))}},formatDate(s){return J.toStandardHisDisplayFormat(s)}}}),ea={key:0,class:"spinner-overlay"},sa={key:0,class:"positionCenter"},oa={class:"card_content"},na={key:1,class:"positionCenter"},da={class:"card_content"},la={class:"card_hearder"},ia={key:2};function ra(s,e,p,f,ua,ca){const h=i("ion-spinner"),v=i("Toolbar"),C=i("ion-toggle"),m=i("ion-card"),o=i("ion-row"),d=i("ion-col"),I=i("ion-content"),w=i("ion-page");return u(),Y(w,{class:G({loading:s.isLoading})},{default:t(()=>[s.isLoading?(u(),c("div",ea,[a(h,{name:"bubbles"}),e[1]||(e[1]=r("div",{class:"loading-text"},"Please wait...",-1))])):S("",!0),a(v),a(I,{fullscreen:!0},{default:t(()=>[s.globalPropertyStore.dde_enabled?S("",!0):(u(),c("div",sa,[a(m,{class:"registration_ion_card"},{default:t(()=>[r("div",oa,[e[3]||(e[3]=r("div",{class:"card_hearder"},"Set DDE",-1)),a(C,{"enable-on-off-labels":!0,modelValue:s.globalPropertyStore.dde_enabled,"onUpdate:modelValue":e[0]||(e[0]=H=>s.globalPropertyStore.dde_enabled=H)},{default:t(()=>[...e[2]||(e[2]=[n("Enable DDE",-1)])]),_:1},8,["modelValue"])])]),_:1})])),s.globalPropertyStore.dde_enabled=="true"?(u(),c("div",na,[a(m,{class:"registration_ion_card"},{default:t(()=>[r("div",da,[r("div",la,l(s.DDE.title),1),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[4]||(e[4]=[n("Location ID",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.id),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[5]||(e[5]=[n("Estimated days left",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.avg),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[6]||(e[6]=[n("Unassigned",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.unassigned),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[7]||(e[7]=[n("Assigned",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.assigned),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[8]||(e[8]=[n("Unallocated",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.unallocated),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[9]||(e[9]=[n("Allocated",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.allocated),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[10]||(e[10]=[n("Average consumption per day",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.daysLeft),1)]),_:1})]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(d,null,{default:t(()=>[a(o,{class:"ddeStatusHeader"},{default:t(()=>[...e[11]||(e[11]=[n("Last update",-1)])]),_:1})]),_:1}),a(d,null,{default:t(()=>[a(o,{class:"ddeStatusContent"},{default:t(()=>[n(l(s.DDE.lastUpdated),1)]),_:1})]),_:1})]),_:1})])]),_:1})])):(u(),c("div",ia,[...e[12]||(e[12]=[r("div",{class:"card_hearder"},"DDE is disabled",-1)])]))]),_:1})]),_:1},8,["class"])}const ba=Z(ta,[["render",ra],["__scopeId","data-v-8831d8d6"]]);export{ba as default};
