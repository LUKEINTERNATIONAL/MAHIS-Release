import{d as J,X as M,a6 as $,$ as ge,H as Y,e as G,f,P as fe,O as v,J as a,l as o,Q as x,K as T,k as U,p as ce,F as ae,r as l,w as j,u as e,e4 as be,m as I,bS as De,a as ee,br as te,aR as le,aS as oe,a5 as R,bm as ve,ea as he,bo as ne,a3 as re,aV as se,N as we,b2 as Se,c as Ie,ak as ke}from"./vendor-CzFJ4KTZ.js";import{i as Ve,V as Ce,l as Fe,_ as Q,B as _e,aO as de,t as Z,o as Be,ay as me,J as z,F as Ae,L as He,b2 as Pe,a as Ue,aA as xe,aB as Ne,as as Ee,a8 as Te,m as Re,aT as $e,S as pe,H as ie,G as Oe}from"../index-DnsBo8A8.js";import{u as Le}from"./wardsStore-CyAxQrz_.js";import{l as Me}from"./lodash-NJiRuGo9.js";const qe=J({components:{IonItem:ge,IonCol:$,IonLabel:M},data(){return{iconsContent:Fe}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(u){const p=document.getElementById(u+"_lbl");p&&(p.style.color="#006401"),this.highlightActionBtns(u)},undoHighlightItem(u){const p=document.getElementById(u+"_lbl");p&&(p.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(u)},highlightActionBtns(u){const p=document.getElementsByClassName(u+"_spanlbl");for(let m=0;m<p.length;m++)p[m].style.display="block"},undohighlightActionBtns(u){const p=document.getElementsByClassName(u+"_spanlbl");for(let m=0;m<p.length;m++)p[m].style.display="none"},asignLblID(u){return u+"_lbl"},asignSpanLblID(u){return u+"_spanlbl"},async removeItemAtIndex(u,p){await Ce("Do you want to delete it?",p)&&this.$emit("update:removeItem",u)},async editItemAtIndex(u,p,m){await Ve("Do you want to edit it?",m)&&this.$emit("update:editItem",{index:u,item:p})},fomartDate(u){const p=u.year,m=(u.month<10?"0":"")+u.month,S=(u.day<10?"0":"")+u.day;return p+"-"+m+"-"+S}}});function We(u,p,m,S,k,h){const g=Y("ion-label"),D=Y("ion-col"),w=Y("ion-icon"),b=Y("ion-item");return f(!0),G(ae,null,fe(u.displayData,(r,d)=>(f(),v(b,{displayData:u.displayData,class:"ionLbltp",key:d,onMousemove:y=>u.highlightItem(d),onMouseout:y=>u.undoHighlightItem(d)},{default:a(()=>[o(D,{class:"col-st1"},{default:a(()=>[o(g,{id:u.asignLblID(d),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[x(T(r.type),1)]),_:2},1032,["id"])]),_:2},1024),o(D,{class:"col-st2"},{default:a(()=>[o(g,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[p[0]||(p[0]=U("span",{class:"spaceBetween"},null,-1)),x(" "+T(r.name)+" ",1),p[1]||(p[1]=U("span",{class:"spaceBetween"},null,-1)),x(T(r.reason),1),p[2]||(p[2]=U("span",{class:"spaceBetween"},null,-1)),x(T(u.fomartDate(r.date)),1)]),_:2},1024)]),_:2},1024),o(D,{class:"action_buttons"},{default:a(()=>[o(g,{class:ce(u.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:y=>u.editItemAtIndex(d,r,y)},{default:a(()=>[o(w,{icon:u.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),o(g,{class:ce(u.asignSpanLblID(d)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:y=>u.removeItemAtIndex(d,y)},{default:a(()=>[o(w,{icon:u.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const Je=Q(qe,[["render",We],["__scopeId","data-v-4346bf77"]]),ye=J({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(u,{emit:p}){const m=l(),S=l({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),k=l(),h={name:"Now",show:!0,fn:O},g=l(!0),D=l(!1),w=l(0),b=u;j(()=>b.time_prop,P=>{P&&(m.value=P.time)},{immediate:!0,deep:!0});const r=p;function d(){r("timeUpDated",k.value)}function y(P){D.value==!0?(g.value=!1,D.value=!1):g.value=!0,S.value.isOpen=!0,S.value.event=P}function H(P){m.value=P.detail.value;const B=F(m.value);if(N(B)==!0){O();return}m.value=B}function N(P){return P.indexOf("NaN")!==-1}function F(P){let B=new Date(P),A=B.getHours(),q=B.getMinutes(),L=A>=12?"PM":"AM";A=A%12,A=A||12;let i=A.toString().padStart(2,"0")+":"+q.toString().padStart(2,"0")+" "+L;return k.value={time:i,meridian:L},d(),i}function O(){D.value=!0,m.value=F(new Date),g.value=!1,w.value++}return(P,B)=>{const A=Y("ion-popover");return f(),G(ae,null,[(f(),v(_e,{placeholder:b.place_holder.default,inputValue:m.value,icon:e(be),"-inner-action-btn-propeties":h,"onClicked:inputValue":y,"onUpdate:InnerActionBtnPropetiesAction":h.fn,key:w.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),o(A,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":S.value.isOpen,event:S.value.event,side:"top",onDidDismiss:B[0]||(B[0]=q=>S.value.isOpen=!1)},{default:a(()=>[g.value?(f(),v(e(De),{key:0,onIonChange:H,id:"datetime",presentation:"time","show-default-buttons":!0})):I("",!0)]),_:1},8,["is-open","event"])],64)}}}),Ke=J({name:"xxxComponent"}),je=J({...Ke,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l([]),S=de(),k=l(NaN),h=l(!1),g=l(),D=l(!1);ee(async()=>{B(),H()});const w=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:A},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:C}],b=[{placeHolder:"Reason",dataHandler:O,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],r=[{placeHolder:{default:"Enter date"},dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],d=[{placeHolder:{default:"Enter time of admission"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"error"}],y=u;j(()=>y.selected_ward_prop,_=>{_&&(g.value=_)},{immediate:!0,deep:!0}),j(()=>y.admitted_other_props,_=>{_&&(b[0].dataValue.value=_.reason,d[0].dataValue.value=_.time,r[0].dataValue.value=_.date)},{immediate:!0,deep:!0});function H(_=!0){D.value=_}function N(_){d[0].dataValue.value=_,A(!1)}function F(_){const n={day:_.value.day,month:_.value.month,year:_.value.year,formattedDate:_.value.formattedDate};r[0].dataValue.value=n,A(!1)}function O(_){const n=_.target.value;b[0].dataValue.value=n,P(),H(!1)}function P(){D.value==!0&&Z("Remember to press the SAVE button",1e4)}async function B(_){try{m.value=await Be("wards"),m.value.length==0&&(m.value=Le().wards),m.value.forEach(n=>{const c={name:n.name,selected:!1,other:n,location_ward_id:n.other.location_id};m.value.push(c)})}catch(n){console.error("err: ",n)}}function A(_=!0){q(),L(),V(),W(),r[0].show_error.value==!1&&d[0].show_error.value==!1&&b[0].show_error.value==!1&&h.value==!1?i():_&&Z("Please enter correct data values",4e3)}function q(){g.value===void 0||g.value==""?h.value=!0:h.value=!1}function L(){b[0].dataValue.value==""||b[0].dataValue.value===void 0?b[0].show_error.value=!0:b[0].show_error.value=!1}async function i(){const _={name:g.value.name,type:"Admitted for short stay",date:r[0].dataValue,time:d[0].dataValue,reason:b[0].dataValue,other:g.value,selected:!0};await S.addOutcomeData(_,k.value)&&s({dataSaved:!1})}const t=p;function s(_={dataSaved:!0}){t("dataSaved",_)}function C(){s()}function V(){r[0].dataValue.value===void 0||r[0].dataValue.value==""?r[0].show_error.value=!0:r[0].show_error.value=!1}function W(){d[0].dataValue.value===void 0||r[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}const X=_=>{g.value=_,H(),A(!1)};return(_,n)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),{onClick:n[0]||(n[0]=c=>B("dd"))},{default:a(()=>[...n[4]||(n[4]=[x("Admitted for Short Stay",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(ve),{modelValue:g.value,"onUpdate:modelValue":[n[1]||(n[1]=c=>g.value=c),n[2]||(n[2]=c=>X(c))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:n[3]||(n[3]=c=>c={}),"track-by":"location_ward_id",options:m.value},null,8,["modelValue","options"]),U("div",null,[h.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[...n[5]||(n[5]=[x(T("Please select a ward"),-1)])]),_:1})):I("",!0)])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:r[0].placeHolder,onDateUpDated:r[0].dataHandler,date_prop:r[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:d[0].placeHolder,onTimeUpDated:d[0].dataHandler,time_prop:d[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[d[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(d[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:b[0].placeHolder,icon:e(he),inputValue:b[0].dataValue.value,"onUpdate:inputValue":b[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[b[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(b[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),w[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[w[0].addItemButton?(f(),v(z,{key:0,name:w[0].name,fill:w[0].btnFill,icon:e(ne),"onClicked:btn":w[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),w[1].addItemButton?(f(),v(z,{key:1,name:w[1].name,fill:w[1].btnFill,icon:e(re),"onClicked:btn":w[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),ze=Q(je,[["__scopeId","data-v-04bbeeaa"]]),Ge=J({name:"xxxComponent"}),Qe=J({...Ge,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l(NaN),S=l(null),k=de(),h=l(!1),g=l([]),D=l({}),w=l(!0),b={location_data:{}},r=[{placeHolder:"Reason",dataHandler:F,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],d=[{placeHolder:{default:"Enter date"},dataHandler:N,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],y=[{placeHolder:{default:"Enter time of referral"},dataHandler:P,dataValue:l(),show_error:l(!1),error_message:"error"}],H=u;j(()=>H.selected_other_referral_data,n=>{n&&(r[0].dataValue.value=n.reason,d[0].dataValue.value=n.date,y[0].dataValue.value=n.time)},{immediate:!0,deep:!0}),j(()=>H.selected_referral_data,n=>{if(!n)return;S.value=n.selected_location,b.location_data=n;const c=Array.isArray(n.selected_district_ids)?[...n.selected_district_ids]:[],E=n.selected_location?{...n.selected_location}:null;g.value=c,D.value=E},{immediate:!0,deep:!0}),ee(()=>{t()});function N(n){const c={day:n.value.day,month:n.value.month,year:n.value.year,formattedDate:n.value.formattedDate};d[0].dataValue.value=c,B(!1)}function F(n){const c=n.target.value;r[0].dataValue.value=c,O(),t(!1)}function O(){w.value==!0&&Z("Remember to press the SAVE button",1e4)}function P(n){y[0].dataValue.value=n,B(!1)}function B(n=!0){i(),A(),q(),L(),d[0].show_error.value==!1&&y[0].show_error.value==!1&&r[0].show_error.value==!1&&h.value==!1?C():n&&Z("Please enter correct data values",4e3)}function A(){r[0].dataValue.value==""||r[0].dataValue.value===void 0?r[0].show_error.value=!0:r[0].show_error.value=!1}function q(){d[0].dataValue.value===void 0||d[0].dataValue.value==""?d[0].show_error.value=!0:d[0].show_error.value=!1}function L(){y[0].dataValue.value===void 0||d[0].dataValue.value==""?y[0].show_error.value=!0:y[0].show_error.value=!1}function i(){S.value?h.value=!1:h.value=!0}function t(n=!0){w.value=n}const s=n=>{S.value=n.selected_location,i(),b.location_data=n,t(),B(!1)},C=async()=>{const n={name:S.value.name,type:"Referred out",selected:!0,date:d[0].dataValue,time:y[0].dataValue,reason:r[0].dataValue},c={...n,other:{ref_data:n,location_data:b.location_data}};await k.addOutcomeData(c,m.value)&&X({dataSaved:!1})},V=()=>{X()},W=p;function X(n={dataSaved:!0}){W("dataSaved",n)}const _=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:B},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:V}];return(n,c)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...c[0]||(c[0]=[x("Referred Out",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(Ae,{show_error:h.value,onFacilitySelected:s,selected_district_ids:g.value,selected_location:D.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:d[0].placeHolder,onDateUpDated:d[0].dataHandler,date_prop:d[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[d[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(d[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:y[0].placeHolder,onTimeUpDated:y[0].dataHandler,time_prop:y[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[y[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(y[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:r[0].placeHolder,icon:e(he),inputValue:r[0].dataValue.value,"onUpdate:inputValue":r[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),_[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[_[0].addItemButton?(f(),v(z,{key:0,name:_[0].name,fill:_[0].btnFill,icon:e(ne),"onClicked:btn":_[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),_[1].addItemButton?(f(),v(z,{key:1,name:_[1].name,fill:_[1].btnFill,icon:e(re),"onClicked:btn":_[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),Xe=Q(Qe,[["__scopeId","data-v-f25626fb"]]),Ye=J({name:"xxxComponent"}),Ze=J({...Ye,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(u,{emit:p}){const m=l(NaN),S=l([]),k=de(),h=l();ee(async()=>{N("")});const g=[{placeHolder:"Reason",dataHandler:r,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],D=[{placeHolder:{default:"Enter date"},dataHandler:b,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],w=u;j(()=>w.selected_discharged_prop,t=>{t&&(h.value=t)},{immediate:!0,deep:!0}),j(()=>w.selected_discharged_data,t=>{t&&(D[0].dataValue.value=t.date||"",t.reason&&(g[0].dataValue.value=t.reason))},{immediate:!0,deep:!0});function b(t){const s={day:t.value.day,month:t.value.month,year:t.value.year,formattedDate:t.value.formattedDate};D[0].dataValue.value=s,O(!1)}function r(t){const s=t.target.value;g[0].dataValue.value=s}S.value,l(!1),l(!1);const d=[{placeHolder:{default:"Enter time of referral"},dataHandler:y,dataValue:l(),show_error:l(!1),error_message:"error"}];function y(t){d[0].dataValue.value=t}const H=new Set;async function N(t){const s=t,C=await He.getFacilities({name:s});C||C.forEach(V=>{H.has(V.location_id)||(H.add(V.location_id),Me.isEmpty(V.name)==!1&&S.value.push({name:V.name,selected:!1,other:V}))})}function F(t){S.value=t}function O(t=!0){P(),D[0].show_error.value?t&&Z("Please enter a valid date",4e3):B()}function P(){D[0].dataValue.value===void 0||D[0].dataValue.value==""?D[0].show_error.value=!0:D[0].show_error.value=!1}async function B(){const t={type:"Discharged Home",date:D[0].dataValue,reason:g[0].dataValue.value};await k.addOutcomeData(t,m.value)&&L({dataSaved:!1})}function A(){L()}const q=p;function L(t={dataSaved:!0}){q("dataSaved",t)}const i=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:O},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:A}];return(t,s)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...s[0]||(s[0]=[x("Discharged Home",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:D[0].placeHolder,onDateUpDated:D[0].dataHandler,date_prop:D[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[D[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(D[0].error_message),1)]),_:1})):I("",!0)])])]),_:1})]),_:1}),i[0].showAddItemButton?(f(),v(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[i[0].addItemButton?(f(),v(z,{key:0,name:i[0].name,fill:i[0].btnFill,icon:e(ne),"onClicked:btn":i[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),i[1].addItemButton?(f(),v(z,{key:1,name:i[1].name,fill:i[1].btnFill,icon:e(re),"onClicked:btn":i[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})):I("",!0)]),_:1})]),_:1}))}}),ea=Q(Ze,[["__scopeId","data-v-c55ed5f5"]]),aa={class:"date-results-container"},ta={class:"date-buttons-container"},la={key:0,class:"validation-message"},oa={__name:"DatePillSelector",props:{availableDates:{type:Array,required:!0,default:()=>[]}},emits:["dateSelected"],setup(u,{expose:p,emit:m}){const S=u,k=m,h=l(null),g=l(!1),D=d=>{h.value=d,g.value=!1,k("dateSelected",{date:S.availableDates[d],index:d})},w=d=>{const y=new Date(d),H={weekday:"short",month:"short",day:"numeric"};return isNaN(y)?d:y.toLocaleDateString("en-US",H)};return p({validateSelection:()=>h.value===null?(g.value=!0,!1):(g.value=!1,!0),getSelectedDate:()=>h.value!==null?S.availableDates[h.value]:null}),(d,y)=>(f(),G("div",aa,[U("div",ta,[(f(!0),G(ae,null,fe(u.availableDates,(H,N)=>(f(),v(e(we),{key:N,class:ce(["date-button",{selected:h.value===N,"error-border":g.value&&h.value!==N}]),fill:"outline",shape:"round",onClick:F=>D(N)},{default:a(()=>[x(T(w(H)),1)]),_:2},1032,["class","onClick"]))),128))]),g.value?(f(),G("p",la," ⚠️ Please select an available date to proceed. ")):I("",!0)]))}},na=Q(oa,[["__scopeId","data-v-1e34f199"]]);class ra extends Pe{constructor(p,m){super(p,114,m)}}const sa=J({__name:"ReferToAnotherClinic",emits:["programDateSelected","referralDataReady","dataSaved"],setup(u,{emit:p}){const m=p,S=l([]),k=l([]),h=l([]),g=Ue(),D=xe(),{activeProgram:w}=Se(g),b=l(!1),r=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Clinics",placeHolder:"Search for programs",items:[],listUpdatedFN:P,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:l(!1),error_message:"Please select one or more clinics/programs to refer to.",disabled:l(!1)}],d=async()=>{b.value=!1;const i=k.value.length>0;if(r[0].show_error.value=!i,!i){console.log("Validation Failed: No programs selected.");return}let t=!0;h.value=[];for(const s of k.value)if(s.dateSelectorRef)if(!s.dateSelectorRef.validateSelection())t=!1;else{const V=s.dateSelectorRef.getSelectedDate();V?h.value.push({programId:s.id,programName:s.name,date:V}):t=!1}else t=!1,console.error("Date Selector ref is missing for program ".concat(s.name));if(!t){b.value=!0,console.log("Validation Failed: Not all dates selected.");return}console.log("Validation Passed! Ready to refer patient with data:",h.value),m("referralDataReady",h.value),await L(h.value,y)},y=async i=>{try{const t=pe.getUserID(),s=pe.getPatientID(),C=new ra(s,t);await C.createEncounter();const V=i.map(W=>({concept_id:2227,value_numeric:W.programId,obs_datetime:ie.sessionDate(),child:[{concept_id:11242,value_text:ie.toStandardHisFormat(W.date),obs_datetime:ie.sessionDate()}]}));await C.saveObservationList(V),Oe("Patient referral saved successfully"),N()}catch(t){Z("Error saving referral data. Please try again.",4e3),console.error("Error in sub_refferal_data:",t)}},H=()=>{N()};function N(i={dataSaved:!0}){m("dataSaved",i)}const F=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:d},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:H}],O=(i,t,s)=>{m("programDateSelected",{programId:t,programName:s,date:i}),b.value=!1;const C=h.value.findIndex(W=>W.programId===t),V={programId:t,programName:s,date:i};C>-1?h.value[C]=V:h.value.push(V)};async function P(i){S.value=i,B(),b.value=!1,await A()}function B(){const i=[];S.value.forEach(s=>{s.selected==!0&&i.push(s.other)});const t=i.map(s=>s.program_id);k.value=k.value.filter(s=>t.includes(s.id)),h.value=h.value.filter(s=>t.includes(s.programId)),i.forEach(s=>{k.value.some(C=>C.id===s.program_id)||k.value.push({id:s.program_id,name:s.name,dates:[],dateSelectorRef:null})}),r[0].show_error.value=i.length===0}const A=async()=>{const i=k.value.map(async t=>{try{const s=D.getAvailableDatesByProgramId(t.id,90,!0,4);t.dates=s}catch(s){console.error("Error fetching dates for program ".concat(t.name,":"),s),t.dates=[]}});await Promise.all(i)};async function q(){const i=w.value.program_id,t=await Te.getAllPrograms(),s=[];t.forEach(C=>{C.program_id!==i&&s.push({name:C.name,other:C,selected:!1})}),S.value=s}const L=async(i,t)=>{Re($e,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Referral(s)?"},{cancel:W=>{},confirm:async W=>{W.detail==!0&&await t(i)}})};return ee(async()=>{await q(),Ne()}),(i,t)=>(f(),v(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...t[0]||(t[0]=[x("Refer to another clinic",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:a(()=>[...t[1]||(t[1]=[x(" Program(s)",-1),U("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),o(Ee,{multiSelection:r[0].multi_Selection,show_label:r[0].show_list_label,uniqueId:r[0].unqueId,name_of_list:r[0].name_of_list,choose_place_holder:r[0].placeHolder,"items_-list":S.value,use_internal_filter:r[0].use_internal_filter,disabled:r[0].disabled.value,onItemListUpDated:r[0].listUpdatedFN,onItemListFiltered:r[0].listFilteredFN,onItemSearchText:r[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),U("div",null,[r[0].show_error.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[x(T(r[0].error_message),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),(f(!0),G(ae,null,fe(k.value,(s,C)=>(f(),v(e(R),{key:s.id},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-top":"20px","font-weight":"bold",display:"block"}},{default:a(()=>[t[2]||(t[2]=U("span",{style:{color:"gray"}},"Available Dates for:",-1)),x(" "+T(s.name),1)]),_:2},1024),o(na,{availableDates:s.dates,onDateSelected:V=>O(V,s.id,s.name),ref_for:!0,ref:V=>{V&&(s.dateSelectorRef=V)}},null,8,["availableDates","onDateSelected"])]),_:2},1024)]),_:2},1024))),128)),b.value?(f(),v(e(R),{key:0,style:{"margin-top":"-10px"}},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{class:"error-label"},{default:a(()=>[...t[3]||(t[3]=[x(" ⚠️ Please select an available date for all selected programs. ",-1)])]),_:1})]),_:1})]),_:1})):I("",!0),o(e(R),{class:"action-buttons"},{default:a(()=>[o(e($),{class:"ion-text-end"},{default:a(()=>[F[1].addItemButton?(f(),v(z,{key:0,name:F[1].name,fill:F[1].btnFill,icon:e(re),"onClicked:btn":F[1].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0),k.value.length>0?(f(),v(z,{key:1,name:F[0].name,fill:F[0].btnFill,icon:e(ne),"onClicked:btn":F[0].fn},null,8,["name","fill","icon","onClicked:btn"])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),da=Q(sa,[["__scopeId","data-v-721c6ae2"]]),ua={class:"dash_box"},ia={key:0,style:{"margin-top":"100px"}},ca=J({name:"xxxComponent"}),fa=J({...ca,setup(u){const p=l("No outcome created yet"),m=l(!1),S=l(!0),k=l(""),h=l(!0),g=l(!1),D=de(),w=Ie(()=>D.outcomes),b=l(!1),r=l(!1),d=l(!1),y=l(!1),H=l(!1),N=l(!1),F=l(),O=l(null),P=l(null),B=l(null),A=l(null),q=l(null),L=l(null),i=l([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]);function t(c){i.value.forEach(E=>{c.selected==!0&&(c.name==E.name||c.type==E.name)&&(k.value=E.name)})}ee(async()=>{C()}),j(()=>k.value,async c=>{b.value==!0?b.value=!1:X()}),j(()=>w.value.length,async c=>{C()});function s(){i.value.forEach(c=>{c.selected=!1}),k.value=""}function C(){w.value.length>0?h.value=!1:w.value.length==0&&g.value==!1&&(h.value=!0)}function V(c){w.value.splice(c,1)}const W=c=>{V(c.index),t(c.item),O.value=c.item.other.location_data,P.value={reason:c.item.reason,date:c.item.date,time:c.item.time},B.value=c.item.other,A.value=c.item,c.item.type==="Discharged Home"&&(q.value=c.item,L.value={reason:c.item.reason,date:c.item.date})};async function X(c=!0){const E=k.value;k.value=E;const K=k.value;K==i.value[0].name?d.value=!0:d.value=!1,K==i.value[1].name?y.value=!0:y.value=!1,K==i.value[2].name?H.value=!0:H.value=!1,K==i.value[3].name?N.value=!0:N.value=!1}function _(){r.value=!1,d.value=!1,H.value=!1,y.value=!1,s()}const n=c=>{i.value.forEach(E=>{E.selected=!1}),F.value=c,F.value.selected=!0,t(F.value)};return(c,E)=>{const K=Y("ion-row");return f(),v(e(ke),null,{default:a(()=>[o(K,null,{default:a(()=>[o(e($),null,{default:a(()=>[(f(),v(Je,{key:0,"onUpdate:removeItem":V,"onUpdate:editItem":W,displayData:w.value},null,8,["displayData"]))]),_:1})]),_:1}),h.value?(f(),v(K,{key:0},{default:a(()=>[U("span",ua,T(p.value),1)]),_:1})):I("",!0),o(K,null,{default:a(()=>[o(e($),null,{default:a(()=>[S.value?(f(),G("div",ia,[o(K,null,{default:a(()=>[o(e(ve),{modelValue:F.value,"onUpdate:modelValue":[E[0]||(E[0]=ue=>F.value=ue),E[1]||(E[1]=ue=>n(ue))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:i.value},null,8,["modelValue","options"]),U("div",null,[m.value?(f(),v(e(M),{key:0,class:"error-label"},{default:a(()=>[...E[2]||(E[2]=[x(T("please select a type"),-1)])]),_:1})):I("",!0)])]),_:1})])):I("",!0)]),_:1})]),_:1}),d.value?(f(),v(ze,{key:1,onDataSaved:_,selected_ward_prop:B.value,admitted_other_props:A.value},null,8,["selected_ward_prop","admitted_other_props"])):I("",!0),y.value?(f(),v(Xe,{key:2,onDataSaved:_,selected_referral_data:O.value,selected_other_referral_data:P.value},null,8,["selected_referral_data","selected_other_referral_data"])):I("",!0),H.value?(f(),v(ea,{key:3,onDataSaved:_,selected_discharged_prop:q.value,selected_discharged_data:L.value},null,8,["selected_discharged_prop","selected_discharged_data"])):I("",!0),N.value?(f(),v(da,{key:4,onDataSaved:_})):I("",!0)]),_:1})}}}),ha=Q(fa,[["__scopeId","data-v-2873182f"]]);export{ze as A,Je as D,ha as O,Xe as R,ye as _,ea as a,da as b};
