System.register(["./vendor-legacy-Cq2l6A5w.js","../index-legacy-B3Gp81QJ.js","./neonatal_service-legacy-oFvePx1J.js","./DemographicBar-legacy-C5bf6xKs.js","./NeonatalStepper-legacy-veVR5xXw.js","./images-legacy-B07cw_V2.js","./NeonatalEnrollmentStore-legacy-rXhIMK1K.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-SkrGX_tE.js","./SaveProgressModal-legacy-B_D3kpD9.js"],function(e,a){"use strict";var t,r,l,n,i,o,s,d,c,u,m,v,p,f,g,h,b,y,w,x,k,_,F,N,D,I,S,V,z,R,T,A,P,C,M,O,$,j,B,E,G,H,U,L,K,W,Y,q,Q,J,Z,X,ee,ae,te,re,le,ne,ie,oe,se;return{setters:[e=>{t=e.d,r=e.eO,l=e.r,n=e.c,i=e.w,o=e.e,s=e.m,d=e.f,c=e.k,u=e.l,m=e.u,v=e.aR,p=e.J,f=e.L,g=e.bj,h=e.cv,b=e.Q,y=e.aQ,w=e.aP,x=e.Y,k=e.bF,_=e.N,F=e.aZ,N=e.F,D=e.P,I=e.K,S=e.cG,V=e.a,z=e.O,R=e.an,T=e.f9,A=e.bk,P=e.fa,C=e.bK,M=e.d8,O=e.a3,$=e.a6,j=e.aV,B=e.by,E=e.eP,G=e.H},e=>{H=e.u,U=e.P,L=e._,K=e.L,W=e.aC,Y=e.T,q=e.t,Q=e.b4,J=e.H,Z=e.ab,X=e.G,ee=e.s},e=>{ae=e.N},e=>{te=e.D},e=>{re=e.n,le=e.a,ne=e.N,ie=e.d},e=>{oe=e.I},e=>{se=e.u},null,null,null],execute:function(){var a=document.createElement("style");a.textContent=".twin-search-container[data-v-9ecea754]{padding:0;margin-top:1rem}.header-with-icon[data-v-9ecea754]{display:flex;align-items:center;gap:1rem}.icon-wrapper[data-v-9ecea754]{position:relative;width:48px;height:48px}.header-icon[data-v-9ecea754]{width:48px;height:48px;object-fit:contain}.search-badge-icon[data-v-9ecea754]{position:absolute;bottom:-4px;right:-4px;font-size:18px;background:var(--ion-color-primary);color:#fff;border-radius:50%;padding:4px;box-shadow:0 2px 4px rgba(0,0,0,.2)}.info-note[data-v-9ecea754]{display:block;margin-bottom:1rem;padding:.75rem;background:rgba(var(--ion-color-warning-rgb),.1);border-radius:4px;font-size:.9rem}.search-with-button[data-v-9ecea754]{display:flex;align-items:center;gap:.5rem;margin:1rem 0}.skip-btn[data-v-9ecea754]{flex-shrink:0;margin:0;--padding-start: 12px;--padding-end: 12px}.search-wrapper[data-v-9ecea754]{width:100%;position:relative;display:flex;align-items:center}.search-input[data-v-9ecea754]{width:100%;--border-radius: .5rem;--background: #f6f6f6;--color: #333}.search-results[data-v-9ecea754]{margin-top:1rem}.search-loading[data-v-9ecea754]{display:flex;flex-direction:column;gap:0}.result-item-skeleton[data-v-9ecea754]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);background:#fff}.result-item-skeleton[data-v-9ecea754]:first-child{border-top:none}.skeleton-header[data-v-9ecea754]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.skeleton-name[data-v-9ecea754]{height:20px;width:180px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-9ecea754 1.5s infinite;border-radius:4px}.skeleton-dob[data-v-9ecea754]{height:16px;width:100px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-9ecea754 1.5s infinite;border-radius:4px}@keyframes shimmer-9ecea754{0%{background-position:200% 0}to{background-position:-200% 0}}.results-list[data-v-9ecea754]{margin-top:1rem}.result-item[data-v-9ecea754]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);cursor:pointer;transition:all .2s;background:#fff}.result-item[data-v-9ecea754]:first-child{border-top:none}.result-item[data-v-9ecea754]:hover{background:var(--ion-color-light-tint)}.result-header[data-v-9ecea754]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.twin-name[data-v-9ecea754]{font-size:1.125rem;font-weight:600;color:var(--ion-color-dark);margin:0}.twin-mrn[data-v-9ecea754],.twin-dob[data-v-9ecea754]{font-size:.9rem;color:var(--ion-color-medium)}.result-details[data-v-9ecea754]{padding-left:0}.twin-gender[data-v-9ecea754]{margin:.5rem 0 0;font-size:.9rem;color:var(--ion-color-dark)}.twin-gender strong[data-v-9ecea754]{font-weight:500}.no-results[data-v-9ecea754]{text-align:center;padding:2rem}.no-results-icon[data-v-9ecea754]{font-size:3rem;color:var(--ion-color-medium);margin-bottom:1rem}.info-text[data-v-9ecea754]{font-size:.875rem;color:var(--ion-color-medium);margin-top:.5rem}.selected-twin[data-v-9ecea754]{margin-top:1.5rem}.selected-card[data-v-9ecea754]{border:1px solid #e5e5e5;border-radius:8px;overflow:hidden}.selected-card-header[data-v-9ecea754]{display:flex;align-items:center;justify-content:space-between;padding:.875rem 1rem;background:#f8f8f8;border-bottom:1px solid #ececec}.header-content[data-v-9ecea754]{display:flex;align-items:center;gap:.5rem;background:#fff;padding:.5rem;border-radius:50px;border:1px dotted #ececec}.selected-icon-wrapper[data-v-9ecea754]{width:30px;height:30px;border-radius:50%;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(0,0,0,.1);flex-shrink:0}.selected-header-icon[data-v-9ecea754]{width:15px;height:15px;object-fit:contain;filter:brightness(0) invert(1)}.header-separator[data-v-9ecea754]{width:1px;height:24px;background:#d4d4d4;flex-shrink:0}.success-icon[data-v-9ecea754]{font-size:1.25rem;color:#10b981}.selected-subtitle[data-v-9ecea754]{font-size:.875rem;font-weight:500;color:#525252}.clear-selection-btn[data-v-9ecea754]{margin:0;--padding-start: 6px;--padding-end: 6px;--color: var(--ion-color-medium-shade)}.clear-selection-btn[data-v-9ecea754]:hover{--color: var(--ion-color-danger)}.clear-selection-btn ion-icon[data-v-9ecea754]{font-size:1.5rem}.selected-card-content[data-v-9ecea754]{padding:1.25rem}.patient-info-grid[data-v-9ecea754]{display:flex;flex-direction:column;gap:1rem}.info-row[data-v-9ecea754]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;border-bottom:none}.info-row[data-v-9ecea754]:nth-child(odd){background:#ececec}.info-row[data-v-9ecea754]:nth-child(2n){background:#fff}.info-label[data-v-9ecea754]{font-size:.813rem;font-weight:400;color:#737373;text-transform:uppercase;letter-spacing:.5px}.info-value[data-v-9ecea754]{font-size:.938rem;font-weight:600;color:#171717;text-align:right}.birth-details-wrapper[data-v-9a714757]{display:flex;flex-direction:column;gap:1rem}.mother-search-container[data-v-0beac54f]{padding:0rem}.header-with-icon[data-v-0beac54f]{display:flex;align-items:center;gap:1rem}.icon-wrapper[data-v-0beac54f]{position:relative;width:48px;height:48px}.header-icon[data-v-0beac54f]{width:48px;height:48px;object-fit:contain}.search-badge-icon[data-v-0beac54f]{position:absolute;bottom:-4px;right:-4px;font-size:18px;background:var(--ion-color-primary);color:#fff;border-radius:50%;padding:4px;box-shadow:0 2px 4px rgba(0,0,0,.2)}.info-note[data-v-0beac54f]{display:block;margin-bottom:1rem;padding:.75rem;background:rgba(var(--ion-color-warning-rgb),.3);border-radius:8px;font-size:.9rem}.search-with-button[data-v-0beac54f]{display:flex;align-items:center;gap:.5rem;margin:1rem 0}.new-registration-btn[data-v-0beac54f]{flex-shrink:0;margin:0;--padding-start: 12px;--padding-end: 12px}.search-input[data-v-0beac54f]{flex:1;margin:0;padding:0}.search-results[data-v-0beac54f]{margin-top:1rem}.search-loading[data-v-0beac54f]{display:flex;flex-direction:column;gap:0}.result-item-skeleton[data-v-0beac54f]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);background:#fff}.result-item-skeleton[data-v-0beac54f]:first-child{border-top:none}.skeleton-header[data-v-0beac54f]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.skeleton-name[data-v-0beac54f]{height:20px;width:180px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-0beac54f 1.5s infinite;border-radius:4px}.skeleton-dob[data-v-0beac54f]{height:16px;width:100px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-0beac54f 1.5s infinite;border-radius:4px}.skeleton-gender[data-v-0beac54f]{height:16px;width:60px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-0beac54f 1.5s infinite;border-radius:4px}.skeleton-details[data-v-0beac54f]{display:flex;flex-direction:column;gap:.5rem}.skeleton-address[data-v-0beac54f]{height:16px;width:250px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-0beac54f 1.5s infinite;border-radius:4px}.skeleton-phone[data-v-0beac54f]{height:16px;width:120px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:shimmer-0beac54f 1.5s infinite;border-radius:4px}@keyframes shimmer-0beac54f{0%{background-position:200% 0}to{background-position:-200% 0}}.results-list[data-v-0beac54f]{margin-top:1rem}.result-item[data-v-0beac54f]{padding:1.25rem 1rem;border-top:1px dashed var(--ion-color-light-shade);cursor:pointer;transition:all .2s;background:#fff}.result-item[data-v-0beac54f]:first-child{border-top:none}.result-item[data-v-0beac54f]:hover{background:var(--ion-color-light-tint)}.result-header[data-v-0beac54f]{display:flex;align-items:center;gap:1rem;margin-bottom:.75rem;flex-wrap:wrap}.mother-name[data-v-0beac54f]{font-size:1.125rem;font-weight:600;color:var(--ion-color-dark);margin:0}.mother-dob[data-v-0beac54f],.mother-gender[data-v-0beac54f]{font-size:.9rem;color:var(--ion-color-medium)}.result-details[data-v-0beac54f]{padding-left:0}.mother-address[data-v-0beac54f]{margin:.5rem 0;font-size:.9rem;color:var(--ion-color-dark)}.mother-address strong[data-v-0beac54f]{font-weight:500}.mother-phone[data-v-0beac54f]{display:flex;align-items:center;gap:.5rem;margin:.5rem 0 0;font-size:.9rem;color:var(--ion-color-dark)}.mother-phone ion-icon[data-v-0beac54f]{font-size:1.1rem;color:var(--ion-color-medium)}.pagination[data-v-0beac54f]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:1rem;padding:1rem}.page-info[data-v-0beac54f]{font-size:.9rem;color:var(--ion-color-medium)}.no-results[data-v-0beac54f]{text-align:center;padding:2rem}.no-results-icon[data-v-0beac54f]{font-size:3rem;color:var(--ion-color-medium);margin-bottom:1rem}.selected-mother[data-v-0beac54f]{margin-top:1rem}.selected-card[data-v-0beac54f]{background:#fbfbfb;border:2px dotted var(--ion-color-medium);border-radius:8px;overflow:hidden}.selected-card-header[data-v-0beac54f]{padding:1rem 1rem .5rem}.selected-card-content[data-v-0beac54f]{padding:.5rem 1rem 1rem}.selected-subtitle[data-v-0beac54f]{font-size:.875rem;font-weight:600;color:var(--ion-color-dark);text-transform:uppercase;letter-spacing:.5px}.selected-header-with-button[data-v-0beac54f]{display:flex;align-items:center;justify-content:space-between}.clear-selection-btn[data-v-0beac54f]{margin:0;--padding-start: 8px;--padding-end: 8px;opacity:1}.clear-selection-btn ion-icon[data-v-0beac54f]{opacity:1;font-size:24px}.selected-info[data-v-0beac54f]{margin-bottom:0}.selected-info h3[data-v-0beac54f]{margin:0 0 .5rem;color:#000;text-transform:uppercase;font-size:1.125rem;font-weight:600}.selected-info p[data-v-0beac54f]{margin:.25rem 0;font-size:.9rem}.search-wrapper[data-v-0beac54f]{width:100%;position:relative;display:flex;align-items:center}.search-input[data-v-0beac54f]{width:100%;--border-radius: .5rem;--background: #f6f6f6;--color: #333}.barcode-btn[data-v-0beac54f]{position:absolute;right:0;top:26px;transform:translateY(-50%);height:34px;width:34px;z-index:2}.neonatal-enrollment-page[data-v-5456e187]{min-height:100vh}\n/*$vite$:1*/",document.head.appendChild(a);const de={key:0,class:"twin-search-container"},ce={style:{border:"1px dotted #ececec","border-radius":"8px"}},ue={class:"header-with-icon"},me={class:"icon-wrapper"},ve=["src"],pe={class:"search-with-button"},fe={class:"search-wrapper"},ge={key:0,class:"search-results"},he={key:0,class:"search-loading"},be={key:1,class:"results-list"},ye=["onClick"],we={class:"result-header"},xe={class:"twin-name"},ke={class:"twin-mrn"},_e={class:"twin-dob"},Fe={class:"result-details"},Ne={key:0,class:"twin-gender"},De={key:2,class:"no-results"},Ie={key:1,class:"selected-twin"},Se={class:"selected-card"},Ve={class:"selected-card-header"},ze={class:"header-content"},Re={class:"selected-icon-wrapper"},Te=["src"],Ae={class:"selected-card-content"},Pe={class:"patient-info-grid"},Ce={class:"info-row"},Me={class:"info-value"},Oe={class:"info-row"},$e={class:"info-value"},je={key:0,class:"info-row"},Be={class:"info-value"},Ee={key:1,class:"info-row"},Ge={class:"info-value"},He=L(t({__name:"TwinSearch",setup(e,{expose:a}){const t=r(re),V=H(),z=l(""),R=l(!1),T=l([]),A=l(null),P=l(!1),C=n(()=>"Yes"===(null==t?void 0:t.hasTwin)),M=async()=>{if(!z.value||z.value.trim().length<2)T.value=[];else{R.value=!0;try{const a=z.value.trim();if(/^\d+$/.test(a))try{const e=await V.getPatientData(Number(a));if(e&&e.personInformation){const a=e.personInformation;T.value=[{patientID:a.person_id,firstName:a.given_name||"",middleName:a.middle_name||"",lastName:a.family_name||"",gender:a.gender,birthdate:a.birthdate}]}else T.value=[]}catch(e){console.error("Error searching by MRN:",e),T.value=[]}else{const e=a.split(" "),t={given_name:e[0],family_name:e[1]||"",page:"1",per_page:"20"},r=await U.search(t);T.value=Array.isArray(r)?r.filter(e=>{const a=e.person;if(!a.birthdate)return!1;const t=new Date(a.birthdate);return Math.floor((Date.now()-t.getTime())/864e5)<=7}).map(e=>{var a;const t=e.person,r=(null===(a=t.names)||void 0===a?void 0:a[0])||{};return{patientID:t.person_id,firstName:r.given_name||"",middleName:r.middle_name||"",lastName:r.family_name||"",gender:t.gender,birthdate:t.birthdate}}):[]}}catch(e){console.error("Error searching for twin:",e),T.value=[]}finally{R.value=!1}}},O=()=>{A.value=null,P.value=!1,t&&(t.twinPatientId=void 0,t.twinName=void 0)},$=()=>{P.value=!0,A.value=null,z.value="",t&&(t.twinPatientId=void 0,t.twinName=void 0)};i(()=>null==t?void 0:t.hasTwin,e=>{"Yes"!==e&&(O(),P.value=!1)});const j=e=>`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),B=e=>e?new Date(e).toLocaleDateString():"";return a({validateForm:()=>"Yes"!==(null==t?void 0:t.hasTwin)||A.value||P.value?null:{twinSelection:"Select the twin record or tap Skip if the twin is not yet registered"},getFormValues:()=>A.value?{twinPatientId:A.value.patientID,twinName:j(A.value)}:{}}),(e,a)=>C.value?(d(),o("div",de,[c("div",ce,[u(m(v),null,{default:p(()=>[c("div",ue,[c("div",me,[c("img",{src:m(oe).icons.twins,alt:"Twin",class:"header-icon"},null,8,ve),u(m(f),{icon:m(g),class:"search-badge-icon"},null,8,["icon"])]),c("div",null,[u(m(h),null,{default:p(()=>[...a[1]||(a[1]=[b("Twin Information",-1)])]),_:1}),u(m(y),null,{default:p(()=>[...a[2]||(a[2]=[b("Search for twin sibling",-1)])]),_:1})])])]),_:1}),u(m(w),null,{default:p(()=>[u(m(x),{class:"info-note"},{default:p(()=>[...a[3]||(a[3]=[b(" This baby has a twin. Please search for the twin's record or register if not found. ",-1)])]),_:1}),c("div",pe,[c("div",fe,[u(m(k),{modelValue:z.value,"onUpdate:modelValue":a[0]||(a[0]=e=>z.value=e),placeholder:"Search for twin's MRN or scan barcode",onIonInput:M,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"])]),u(m(_),{color:"primary",onClick:$,class:"skip-btn"},{default:p(()=>[a[4]||(a[4]=b(" Skip ",-1)),u(m(f),{size:"small",icon:m(F),slot:"end"},null,8,["icon"])]),_:1})]),z.value&&z.value.length>0&&!A.value?(d(),o("div",ge,[R.value?(d(),o("div",he,[(d(),o(N,null,D(3,e=>c("div",{key:`skeleton-${e}`,class:"result-item-skeleton"},[...a[5]||(a[5]=[c("div",{class:"skeleton-header"},[c("div",{class:"skeleton-name"}),c("div",{class:"skeleton-dob"})],-1)])])),64))])):T.value.length>0?(d(),o("div",be,[(d(!0),o(N,null,D(T.value,(e,r)=>(d(),o("div",{key:e.patientID||r,class:"result-item",onClick:a=>{return r=e,A.value=r,z.value="",P.value=!1,void(t&&(t.twinPatientId=r.patientID,t.twinName=`${r.firstName} ${r.middleName||""} ${r.lastName}`.trim()));var r}},[c("div",we,[c("span",xe,I(j(e)),1),c("span",ke,"MRN: "+I(e.patientID),1),c("span",_e,"DOB: "+I(B(e.birthdate)),1)]),c("div",Fe,[e.gender?(d(),o("p",Ne,[a[6]||(a[6]=c("strong",null,"Gender:",-1)),b(" "+I(e.gender),1)])):s("",!0)])],8,ye))),128))])):(d(),o("div",De,[u(m(f),{icon:m(g),class:"no-results-icon"},null,8,["icon"]),c("p",null,'No patients found matching "'+I(z.value)+'"',1),a[7]||(a[7]=c("p",{class:"info-text"},"The twin may not be registered yet. You can skip this step and register the twin later.",-1))]))])):s("",!0),A.value?(d(),o("div",Ie,[c("div",Se,[c("div",Ve,[c("div",ze,[c("div",Re,[c("img",{src:m(oe).icons.twins,alt:"Twin",class:"selected-header-icon"},null,8,Te)]),a[8]||(a[8]=c("div",{class:"header-separator"},null,-1)),a[9]||(a[9]=c("span",{class:"selected-subtitle"},"Twin Selected",-1))]),u(m(_),{fill:"clear",size:"small",onClick:O,class:"clear-selection-btn"},{default:p(()=>[u(m(f),{icon:m(S)},null,8,["icon"])]),_:1})]),c("div",Ae,[c("div",Pe,[c("div",Ce,[a[10]||(a[10]=c("span",{class:"info-label"},"Full Name",-1)),c("span",Me,I(j(A.value)),1)]),c("div",Oe,[a[11]||(a[11]=c("span",{class:"info-label"},"MRN",-1)),c("span",$e,I(A.value.patientID),1)]),A.value.birthdate?(d(),o("div",je,[a[12]||(a[12]=c("span",{class:"info-label"},"Date of Birth",-1)),c("span",Be,I(B(A.value.birthdate)),1)])):s("",!0),A.value.gender?(d(),o("div",Ee,[a[13]||(a[13]=c("span",{class:"info-label"},"Gender",-1)),c("span",Ge,I(A.value.gender),1)])):s("",!0)])])])])):s("",!0)]),_:1})])])):s("",!0)}}),[["__scopeId","data-v-9ecea754"]]),Ue=e=>{if(null!=e&&""!==e){if("string"==typeof e||"number"==typeof e)return e.toString();if("object"==typeof e){var a,t,r;const l=null!==(a=null!==(t=null!==(r=e.label)&&void 0!==r?r:e.value)&&void 0!==t?t:e.name)&&void 0!==a?a:e.title;if(null!=l&&""!==l)return l.toString()}}},Le=e=>{if(!e)return[];if(Array.isArray(e))return e.map(e=>Ue(e)).filter(e=>!!e);const a=Ue(e);return a?[a]:[]},Ke=e=>null==e?"":e.toString(),We={class:"birth-details-wrapper"},Ye=L(t({__name:"BirthDetails",setup(e,{expose:a}){const t=l(null),s=l(null),c=l(null),v=le[0].formData,p=v.slice(0,1),f=v.slice(1),g=r(re),h=l([]);V(async()=>{try{const e=await K.getAllFacilities();Array.isArray(e)?h.value=e:null!=e&&e.facilities&&Array.isArray(e.facilities)?h.value=e.facilities:null!=e&&e.records&&Array.isArray(e.records)?h.value=e.records:h.value=[]}catch(e){console.error("Error loading facilities:",e),h.value=[]}});const b=n(()=>f.map(e=>"birthFacility"===e.name?{...e,options:h.value.map(e=>{const a=e.name||e.facility_name||"Unknown";return{name:a,label:a,value:e.id||e.facility_id||a,code:e.code||e.facility_code,district:e.district||e.district_name}})}:e)),y=e=>{g&&(g.hasTwin=e.hasTwin||"")},w=e=>{g&&(g.placeOfBirth=Ue(e.placeOfBirth)||"",g.nameOfBirthFacility=Ue(e.birthFacility)||"",g.typeOfBirth=Ue(e.typeOfBirth)||"",g.birthWeight=Ke(e.birthWeight||""),g.timeOfBirth=Ke(e.birthTime||""))};return i(()=>{var e;return null===(e=s.value)||void 0===e?void 0:e.formValues},e=>{e&&w(e)},{deep:!0}),i(()=>s.value,e=>{null!=e&&e.getFormValues&&w(e.getFormValues())},{immediate:!0}),i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&y(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&y(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>s.value,getTwinQuestionFormRef:()=>t.value,validateForm:()=>{var e,a,r,l,n,i;const o=[(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null,(null===(r=s.value)||void 0===r||null===(l=r.validateForm)||void 0===l?void 0:l.call(r))||null,(null===(n=c.value)||void 0===n||null===(i=n.validateForm)||void 0===i?void 0:i.call(n))||null].filter(Boolean);return o.length?o.reduce((e,a)=>({...e,...a}),{}):null},getFormValues:()=>{var e,a,r,l,n,i;return{...(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{},...(null===(r=s.value)||void 0===r||null===(l=r.getFormValues)||void 0===l?void 0:l.call(r))||{},...(null===(n=c.value)||void 0===n||null===(i=n.getFormValues)||void 0===i?void 0:i.call(n))||{}}}}),(e,a)=>(d(),o("div",We,[u(W,{formData:m(p),ref_key:"twinQuestionFormRef",ref:t,class:"twin-question-form"},null,8,["formData"]),u(He,{ref_key:"twinSearchRef",ref:c},null,512),u(W,{formData:b.value,ref_key:"formRef",ref:s,class:"main-form"},null,8,["formData"])]))}}),[["__scopeId","data-v-9a714757"]]),qe=t({__name:"ReferralInformation",setup(e,{expose:a}){const t=l(null),o=le[1].formData,s=r(re),c=l([]);V(async()=>{try{const e=await K.getAllFacilities();Array.isArray(e)?c.value=e:null!=e&&e.facilities&&Array.isArray(e.facilities)?c.value=e.facilities:null!=e&&e.records&&Array.isArray(e.records)?c.value=e.records:c.value=[]}catch(e){console.error("Error loading facilities:",e),c.value=[]}});const u=n(()=>o.map(e=>"referringFacilityName"===e.name?{...e,options:c.value.map(e=>{const a=e.name||e.facility_name||"Unknown";return{name:a,label:a,value:e.id||e.facility_id||a,code:e.code||e.facility_code,district:e.district||e.district_name}})}:e)),m=e=>{if(!s)return;s.referredFromOtherFacility=e.referredFromAnotherFacility||"",s.referredFrom=Ue(e.referredFrom)||"";const a=e.referringFacilityName;s.referringFacilityName=(null==a?void 0:a.name)||Ke(a||""),s.modeOfTransport=Ue(e.modeOfTransport)||"",s.admittedFrom=Ue(e.admittedFrom)||""};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&m(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&m(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),z(W,{formData:u.value,ref_key:"formRef",ref:t},null,8,["formData"]))}}),Qe=t({__name:"BirthAssessment",setup(e,{expose:a}){const t=l(null),n=le[2].formData,o=r(re),s=e=>{o&&(o.criedAfterBirth=e.criedAfterBirth||"",o.apgarScoreAt1=Ue(e.apgar1)||"",o.apgarScoreAt5=Ue(e.apgar5)||"",o.apgarScoreAt10=Ue(e.apgar10)||"",o.resuscitationMethods=Le(e.resuscitationMethods))};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),z(W,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Je={class:"mother-search-container"},Ze={style:{border:"1px dotted #ececec","border-radius":"8px"}},Xe={class:"header-with-icon"},ea={class:"icon-wrapper"},aa=["src"],ta={class:"search-with-button"},ra={class:"search-wrapper"},la={class:"barcode-btn","aria-label":"Scan MRN"},na={key:0,class:"search-results"},ia={key:0,class:"search-loading"},oa={key:1,class:"results-list"},sa=["onClick"],da={class:"result-header"},ca={class:"mother-name"},ua={class:"mother-dob"},ma={class:"mother-gender"},va={class:"result-details"},pa={key:0,class:"mother-address"},fa={key:1,class:"mother-phone"},ga={key:0,class:"pagination"},ha={class:"page-info"},ba={key:2,class:"no-results"},ya={key:1,class:"selected-mother"},wa={class:"selected-card"},xa={class:"selected-card-header"},ka={class:"selected-header-with-button"},_a={class:"selected-card-content"},Fa={class:"selected-info"},Na={key:0},Da={key:1},Ia=L(t({__name:"MotherSearch",setup(e,{expose:a}){const t=R(),F=r(re),z=se(),O=H(),$=l(""),j=l(!1),B=l([]),E=l(null),G=l(1);V(async()=>{const e=z.getMotherPatientId;e&&z.shouldReturnToEnrollment&&(await L(e),z.clearEnrollmentContext())}),i(E,e=>{e&&F&&(F.motherPatientId=e.patientID,F.motherName=`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),F.motherNationalId=e.nationalId||"")});const L=async e=>{try{j.value=!0;const r=await O.getPatientData(e);if(r&&r.personInformation){var a,t;const l=r.personInformation,n=(null===(a=l.addresses)||void 0===a?void 0:a[0])||{},i=null===(t=l.person_attributes)||void 0===t?void 0:t.find(e=>{var a;return"Cell Phone Number"===(null===(a=e.person_attribute_type)||void 0===a?void 0:a.name)}),o={patientID:l.person_id||e,firstName:l.given_name||"",middleName:l.middle_name||"",lastName:l.family_name||"",gender:l.gender,birthdate:l.birthdate,nationalId:r.national_id||"",address:n,phone:(null==i?void 0:i.value)||""};E.value=o}}catch(r){console.error("Error fetching mother data:",r)}finally{j.value=!1}},K=n(()=>Math.ceil(B.value.length/10)),W=n(()=>{const e=10*(G.value-1),a=e+10;return B.value.slice(e,a)}),Y=async()=>{if(!$.value||$.value.trim().length<2)B.value=[];else{j.value=!0,G.value=1;try{const e=$.value.trim().split(" "),a={given_name:e[0],family_name:e[1]||"",page:"1",per_page:"50"},t=await U.search(a);B.value=Array.isArray(t)?t.filter(e=>{var a;const t=(null===(a=e.person)||void 0===a?void 0:a.gender)||e.gender;return"F"===t||"Female"===t}).map(e=>{var a,t,r;const l=e.person,n=(null===(a=l.names)||void 0===a?void 0:a[0])||{},i=(null===(t=l.addresses)||void 0===t?void 0:t[0])||{},o=null===(r=l.person_attributes)||void 0===r?void 0:r.find(e=>{var a;return"Cell Phone Number"===(null===(a=e.person_attribute_type)||void 0===a?void 0:a.name)});return{patientID:l.person_id,firstName:n.given_name||"",middleName:n.middle_name||"",lastName:n.family_name||"",gender:l.gender,birthdate:l.birthdate,nationalId:e.national_id||"",address:i,phone:(null==o?void 0:o.value)||""}}):[]}catch(e){console.error("Error searching for mothers:",e),B.value=[]}finally{j.value=!1}}},q=()=>{E.value=null,F&&(F.motherPatientId=void 0,F.motherName=void 0,F.motherNationalId=void 0)},Q=()=>{var e;const a=r("patient");a&&null!==(e=a.value)&&void 0!==e&&e.patientID&&z.setMotherCreationContext(a.value.patientID,4),t.push({path:"/registration/manual",query:{returnTo:"/neonatal/enrollment",context:"neonatal-mother"}})},J=()=>{G.value<K.value&&G.value++},Z=()=>{G.value>1&&G.value--},X=e=>e?new Date(e).toLocaleDateString():"",ee=e=>{if(!e)return"";if("string"==typeof e)return e;const a=[];return e.city_village&&a.push(e.city_village),e.township_division&&a.push(e.township_division),e.state_province&&a.push(e.state_province),a.join(", ")};return a({getFormRef:()=>({validate:()=>null!==E.value,getFormData:()=>{var e,a;return{motherPatientId:null===(e=E.value)||void 0===e?void 0:e.patientID,motherName:E.value?`${E.value.firstName} ${E.value.middleName||""} ${E.value.lastName}`.trim():void 0,motherNationalId:null===(a=E.value)||void 0===a?void 0:a.nationalId}}}),validateForm:()=>E.value?null:{motherSelection:"Please select a mother or register a new one"},getFormValues:()=>E.value?{motherPatientId:E.value.patientID,motherName:`${E.value.firstName} ${E.value.middleName||""} ${E.value.lastName}`.trim(),motherNationalId:E.value.nationalId}:{}}),(e,a)=>(d(),o("div",Je,[c("div",Ze,[u(m(v),null,{default:p(()=>[c("div",Xe,[c("div",ea,[c("img",{src:m(oe).icons.care,alt:"Care",class:"header-icon"},null,8,aa),u(m(f),{icon:m(g),class:"search-badge-icon"},null,8,["icon"])]),c("div",null,[u(m(h),null,{default:p(()=>[...a[1]||(a[1]=[b("Search for Mother",-1)])]),_:1}),u(m(y),null,{default:p(()=>[...a[2]||(a[2]=[b("Find mother's existing record",-1)])]),_:1})])])]),_:1}),u(m(w),null,{default:p(()=>[u(m(x),{class:"info-note"},{default:p(()=>[...a[3]||(a[3]=[b(" We now need to link this neonate's record to it's mother, please search and find the mother or register if mother not found. ",-1)])]),_:1}),c("div",ta,[c("div",ra,[u(m(k),{modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value=e),placeholder:"Search for mother's Name or scan MRN",onIonInput:Y,debounce:300,"show-clear-button":"focus",class:"search-input"},null,8,["modelValue"]),c("div",la,[u(m(f),{color:"primary",size:"small",icon:m(T),slot:"icon-only"},null,8,["icon"])])]),u(m(_),{color:"success",onClick:Q,class:"new-registration-btn"},{default:p(()=>[u(m(f),{icon:m(A),slot:"icon-only"},null,8,["icon"]),a[4]||(a[4]=b("New Registration ",-1))]),_:1})]),$.value&&$.value.length>0&&!E.value?(d(),o("div",na,[j.value?(d(),o("div",ia,[(d(),o(N,null,D(3,e=>c("div",{key:`skeleton-${e}`,class:"result-item-skeleton"},[...a[5]||(a[5]=[c("div",{class:"skeleton-header"},[c("div",{class:"skeleton-name"}),c("div",{class:"skeleton-dob"}),c("div",{class:"skeleton-gender"})],-1),c("div",{class:"skeleton-details"},[c("div",{class:"skeleton-address"}),c("div",{class:"skeleton-phone"})],-1)])])),64))])):B.value.length>0?(d(),o("div",oa,[(d(!0),o(N,null,D(W.value,(e,t)=>(d(),o("div",{key:e.patientID||t,class:"result-item",onClick:a=>(e=>{E.value=e,$.value="",F&&(F.motherPatientId=e.patientID,F.motherName=`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),F.motherNationalId=e.nationalId||"")})(e)},[c("div",da,[c("span",ca,I(e.firstName)+" "+I(e.middleName?e.middleName+" ":"")+I(e.lastName),1),c("span",ua,"DOB "+I(X(e.birthdate)),1),c("span",ma,I("F"===e.gender?"Female":e.gender),1)]),c("div",va,[e.address?(d(),o("p",pa,[a[6]||(a[6]=c("strong",null,"Current Address:",-1)),b(" "+I(ee(e.address)),1)])):s("",!0),e.phone?(d(),o("p",fa,[u(m(f),{icon:m(P)},null,8,["icon"]),b(" "+I(e.phone),1)])):s("",!0)])],8,sa))),128)),K.value>1?(d(),o("div",ga,[u(m(_),{fill:"outline",size:"small",onClick:Z,disabled:1===G.value},{default:p(()=>[u(m(f),{icon:m(C)},null,8,["icon"])]),_:1},8,["disabled"]),c("span",ha,"Page "+I(G.value)+" of "+I(K.value),1),u(m(_),{fill:"outline",size:"small",onClick:J,disabled:G.value===K.value},{default:p(()=>[u(m(f),{icon:m(M)},null,8,["icon"])]),_:1},8,["disabled"])])):s("",!0)])):(d(),o("div",ba,[u(m(f),{icon:m(g),class:"no-results-icon"},null,8,["icon"]),c("p",null,'No mothers found matching "'+I($.value)+'"',1),u(m(_),{expand:"block",onClick:Q},{default:p(()=>[...a[7]||(a[7]=[b("Register new mother",-1)])]),_:1})]))])):s("",!0),E.value?(d(),o("div",ya,[c("div",wa,[c("div",xa,[c("div",ka,[a[8]||(a[8]=c("span",{class:"selected-subtitle"},"Selected Mother",-1)),u(m(_),{fill:"clear",size:"small",color:"danger",onClick:q,class:"clear-selection-btn"},{default:p(()=>[u(m(f),{icon:m(S),slot:"icon-only"},null,8,["icon"])]),_:1})])]),c("div",_a,[c("div",Fa,[c("h3",null,I(E.value.firstName)+" "+I(E.value.middleName?E.value.middleName+" ":"")+I(E.value.lastName),1),c("p",null,[a[9]||(a[9]=c("strong",null,"MRN:",-1)),b(" "+I(E.value.patientID),1)]),E.value.birthdate?(d(),o("p",Na,[a[10]||(a[10]=c("strong",null,"DOB:",-1)),b(" "+I(X(E.value.birthdate)),1)])):s("",!0),E.value.address?(d(),o("p",Da,[a[11]||(a[11]=c("strong",null,"Address:",-1)),b(" "+I(ee(E.value.address)),1)])):s("",!0)])])])])):s("",!0)]),_:1})])]))}}),[["__scopeId","data-v-0beac54f"]]),Sa=t({__name:"Pregnancy",setup(e,{expose:a}){const t=l(null),n=le[4].formData,o=r(re),s=e=>{o&&(o.gestationWeeks=Ke(e.gestationWeeks||""),o.steroidsGiven=e.steroidsGiven||"",o.gestationMethodAssessment=Ue(e.gestationMethodAssessment)||"",o.ultraSoundScanning=e.ultraSoundScanning||"",o.onsetOfLabor=Ke(e.onsetOfLabor||""),o.ruptureOfMembranes=e.ruptureOfMembranes||"",o.durationOfRuptureMembranes=Ue(e.durationOfRuptureMembranes)||"",o.offensiveLiquor=e.offensiveLiquor||"",o.modeOfDelivery=Ue(e.modeOfDelivery)||"",o.meconiumPresent=e.meconiumPresent||"",o.maternalAnalgesia=e.maternalAnalgesia||"",o.analgesiasDrug=Ue(e.analgesiasDrug)||"",o.anesthesiaUsed=e.anesthesiaUsed||"",o.teo=e.teo||"",o.chlorohexidineCordCare=e.chlorohexidineCordCare||"",o.vitaminKGiven=e.vitaminKGiven||"",o.dextroseGiven=e.dextroseGiven||"")};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),z(W,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Va=t({__name:"MotherEnrollmentDetails",setup(e,{expose:a}){const t=l(null),n=le[5].formData,o=r(re),s=e=>{o&&(o.motherStatus=e.motherStatus||"",o.motherHivStatus=Ue(e.motherHivStatus)||"",o.lastHivTestDate=Ke(e.lastHivTestDate||""),o.doHivRetest=e.doHivRetest||"",o.babyGivenNvp=e.babyGivenNvp||"",o.motherVdrlResult=Ue(e.motherVdrlResult)||"",o.motherTreatedForVdrl=e.motherTreatedForVdrl||"",o.babyTestedForHepatitis=e.babyTestedForHepatitis||"",o.allThreeDosesCompleted=e.allThreeDosesCompleted||"",o.motherHepatitisResult=Ue(e.motherHepatitisResult)||"")};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),z(W,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),za=t({__name:"KnownMedicalConditions",setup(e,{expose:a}){const t=l(null),n=le[6].formData,o=r(re),s=e=>{o&&(o.tetanusDiphtheria=Le(e.tetanusDiphtheria))};return i(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.formValues},e=>{e&&s(e)},{deep:!0}),i(()=>t.value,e=>{null!=e&&e.getFormValues&&s(e.getFormValues())},{immediate:!0}),a({getFormRef:()=>t.value,validateForm:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e))||null},getFormValues:()=>{var e,a;return(null===(e=t.value)||void 0===e||null===(a=e.getFormValues)||void 0===a?void 0:a.call(e))||{}}}),(e,a)=>(d(),z(W,{formData:m(n),ref_key:"formRef",ref:t},null,8,["formData"]))}}),Ra=t({name:"NeonatalEnrollment",components:{IonPage:$,IonContent:O,Toolbar:Y,DemographicBar:te,NeonatalStepper:ne,BirthDetails:Ye,ReferralInformation:qe,BirthAssessment:Qe,MotherSearch:Ia,Pregnancy:Sa,MotherEnrollmentDetails:Va,KnownMedicalConditions:za},setup(){const e=R(),a=H(),{patient:t}=j(a),r=l(!1),n=B({...ie});E(re,n);const i=l(le.map((e,a)=>({title:e.title,number:a+1,checked:!1,class:0===a?"open_step common_step":"common_step",last_step:a===le.length-1?"last_step":""}))),o=[{title:le[0].title,value:"1",component:Ye},{title:le[1].title,value:"2",component:qe},{title:le[2].title,value:"3",component:Qe},{title:le[3].title,value:"4",component:Ia},{title:le[4].title,value:"5",component:Sa},{title:le[5].title,value:"6",component:Va},{title:le[6].title,value:"7",component:za}];return{router:e,patient:t,enrollmentFormData:n,stepperTitle:"Neonatal enrollment",currentOpenStepper:"1",wizardData:i,stepperData:o,updateStatus:e=>{e&&e.value&&i.value.forEach((a,t)=>{e.value===(t+1).toString()?(a.class="open_step common_step",a.checked=!1):t<parseInt(e.value)-1?(a.class="common_step color_white",a.checked=!0):(a.class="common_step",a.checked=!1)})},getSaveFunction:a=>a===o.length-1?async()=>{var a;if(null!==(a=t.value)&&void 0!==a&&a.patientID){if(!r.value)try{if(r.value=!0,!n.birthWeight||!n.timeOfBirth)return q("Please complete required birth details"),void(r.value=!1);if(n.motherPatientId)try{const e=(await Q.getRelations()).find(e=>"Mother"===e.b_is_to_a||"Parent"===e.b_is_to_a);e&&await Q.createRelation(t.value.patientID,n.motherPatientId,e.relationship_type_id)}catch(l){console.error("Failed to create mother-baby relationship",l)}await ae.enrollNeonate(t.value.patientID,n,J.sessionDate()),await Z.userProgramData(t.value.patientID),X("Neonate enrolled successfully"),e.push("/neonatal/triage")}catch(i){console.error("Neonatal enrollment failed",i),ee("Failed to enroll neonate. Please try again."),r.value=!1}}else q("No patient selected")}:null,isEnrolling:r}}});e("default",L(Ra,[["render",function(e,a,t,r,l,n){const i=G("Toolbar"),o=G("DemographicBar"),s=G("NeonatalStepper"),c=G("ion-content"),m=G("ion-page");return d(),z(m,{class:"neonatal-enrollment-page"},{default:p(()=>[u(i),u(c,{fullscreen:!0},{default:p(()=>[u(o),u(s,{wizardData:e.wizardData,StepperData:e.stepperData,stepperTitle:e.stepperTitle,openStepper:e.currentOpenStepper,backUrl:"/patientProfile",getSaveFunction:e.getSaveFunction,flowType:"enrollment",onUpdateStatus:e.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","onUpdateStatus"])]),_:1})]),_:1})}],["__scopeId","data-v-5456e187"]]))}}});
