import{u as U,aG as q,t as R,ai as m,b as j,K as J,_ as L,n as E}from"../index-CYcjB3lE.js";import{c as O,d as Q,r as N,b2 as X,w as Z,a as ee,e as ne,f as S,l as y,J as p,u as v,aV as V,O as W,bw as Y,n as M,aS as z,aR as G,Q as $}from"./vendor-BataJFSH.js";const te=()=>{const F=[{id:1,name:"Oral PreP for HIV"},{id:2,name:"Analgesic"},{id:3,name:"Anti-consulsive"},{id:4,name:"Anti-TB"},{id:5,name:"Antihelmintic"},{id:6,name:"Antimarials"},{id:7,name:"Antitussive"},{id:8,name:"Aspirin"},{id:9,name:"Calcium"},{id:10,name:"Doxylamine"},{id:11,name:"Hematinic"},{id:12,name:"Iron"},{id:13,name:"Metoclopramide"},{id:14,name:"Thyroid medication"},{id:15,name:"Antiacids"},{id:16,name:"Anti-psychotics"},{id:17,name:"Anti-diabetic"},{id:18,name:"Anti-hypertensive"},{id:19,name:"ARVs"},{id:20,name:"Antivirals"},{id:21,name:"Asthamatic"},{id:22,name:"Co-trimoxazole"},{id:23,name:"Folic acid"},{id:24,name:"Hemorrhoidal medication"},{id:25,name:"Magnesium"},{id:26,name:"Multivitamin"},{id:27,name:"Vitamin A"},{id:28,name:"Other"},{id:29,name:"None"}];return{medicationsFormSection:O(()=>[{componentType:"Heading",header:"Current Medications",name:"Current Medications",grid:{s:"12"}},{componentType:"multiSelectInputField",header:"Which medications is the woman currently prescribed?",name:"Current Medications",obsValueType:"value_text",isMultiple:!0,trackBy:"id",grid:{s:"12"},options:F,validation:i=>{if(!i||i.length===0)return"Please select at least one medication or 'None'";if(Array.isArray(i)){const e=i.some(n=>n.name==="None"),t=i.some(n=>n.name!=="None");if(e&&t)return"'None' cannot be selected with other medications"}return null},onChange:(i,e)=>{const t={};if(Array.isArray(i)){const n=i.some(a=>a.name==="None"),o=i.some(a=>a.name==="Other");if(n){const a=i.find(f=>f.name==="None");t.current_medications=[a],t.other_medication_notes=""}else o&&(t.other_medication_notes_required=!0);o||(t.other_medication_notes="")}return t}},{componentType:"inputField",header:"Specify other medications",name:"other_medication_notes",obsValueType:"value_text",grid:{s:"12"},condition:i=>{const e=i.current_medications;if(!Array.isArray(e))return!1;const t=e.some(o=>o.name==="Other"),n=e.some(o=>o.name==="None");return t&&!n},validation:(i,e)=>{const t=e.current_medications;if(!Array.isArray(t))return null;const n=t.some(a=>a.name==="Other"),o=t.some(a=>a.name==="None");return n&&!o&&(!i||i.trim()==="")?"Please specify other medications":null}}]),resetForm:()=>{}}},ie={class:"medications-container"},re=Q({__name:"Medications",setup(F,{expose:T}){const s=te(),i=N(null),e=N(0),t=U(),{patient:n}=X(t);Z(()=>{var r;return(r=n.value)==null?void 0:r.patientID},async(r,b)=>{r&&r!==b&&await f()});const o=O(()=>s.medicationsFormSection.value),a=r=>{console.log("Field changed:",r.fieldName,r.value),r.fieldName==="current_medications"&&console.log("Medications updated:",r.value)},f=async()=>{var r;e.value++,await M(),(r=i.value)!=null&&r.resetForm&&i.value.resetForm()},c=async()=>{if(!i.value)return console.error("Form reference is not available"),R("Form is not ready"),!1;const r=i.value.validateForm();if(r)return console.error("Validation errors:",r),R("Please fix validation errors before submitting"),!1;const b=i.value.getFormValues();console.log("Form data to submit:",b);const d=await _(b);if(d.length===0)return R("No medications data to save"),!1;try{return await m.addObsToEncounterPatient(d,j.MEDICATIONS),await f(),J("Medications saved successfully"),!0}catch(B){return console.error("Error saving medications:",B),R("Failed to save medications"),!1}},_=async r=>{const b=[],d=r.current_medications;if(Array.isArray(d)&&d.length>0){const B=d.map(A=>A.name).join(", ");b.push(await m.buildValueText("Current medications prescribed",B));const g=d.some(A=>A.name==="Other"),l=r.other_medication_notes;g&&l&&l.trim()!==""&&b.push(await m.buildValueText("Other medications notes",l.trim()))}return b};return ee(async()=>{await f()}),T({validateForm:()=>{var r;return(r=i.value)==null?void 0:r.validateForm()},onSubmit:c,resetForm:async()=>{await f()},getFormValues:()=>{var r;return((r=i.value)==null?void 0:r.getFormValues())||{}}}),(r,b)=>(S(),ne("div",ie,[y(v(Y),{class:"medications-card"},{default:p(()=>[y(v(V),null,{default:p(()=>[(S(),W(q,{formData:o.value,ref_key:"formRef",ref:i,key:e.value,onFieldChanged:a},null,8,["formData"]))]),_:1})]),_:1})]))}}),fe=L(re,[["__scopeId","data-v-84d90f8d"]]),oe=()=>{const F=()=>{},T=O(()=>[{componentType:"Heading",name:"Daily caffeine intake",grid:{s:"12"}},{componentType:"checkboxField",name:"Daily caffeine use",type:"multiple",required:!0,options:[{value:"More than 2 cups of coffee",label:"More than 2 cups of coffee"},{value:"More than 4 cups of tea",label:"More than 4 cups of tea"},{value:"More than 12 bars of chocolate",label:"More than 12 bars of chocolate"},{value:"More than one bottle of soda, energy, soft drink",label:"More than one bottle of soda, energy, soft drink"},{value:"None",label:"None"}],grid:{s:"12"},validation:s=>!s||Array.isArray(s)&&s.length===0?"Please select at least one option for daily caffeine intake":null,onChange:(s,i)=>{if(!i||!Array.isArray(s))return{};const e={},t=s.includes("None"),n=s.some(o=>o!=="None");return t&&n&&(e["Daily caffeine use"]=["None"]),e}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"Heading",name:"Drug and substance abuse",grid:{s:"12"}},{componentType:"checkboxField",name:"Drug and substance abuse",type:"multiple",required:!0,options:[{value:"Recently quit tobacco products",label:"Recently quit tobacco products"},{value:"Exposure to second hand smoke",label:"Exposure to second hand smoke"},{value:"Pica",label:"Pica"},{value:"Alcohol intake",label:"Alcohol intake"},{value:"None",label:"None"}],grid:{s:"12"},validation:s=>!s||Array.isArray(s)&&s.length===0?"Please select at least one option for drug and substance abuse":null,onChange:(s,i)=>{if(!i||!Array.isArray(s))return{};const e={},t=s.includes("None"),n=s.some(o=>o!=="None");return t&&n&&(e["Drug and substance abuse"]=["None"]),e}}]);return{resetForm:F,womanBehaviourFormSection:T}},ae={class:"container"},se=Q({__name:"WomanBehaviour",setup(F,{expose:T}){const s=oe(),i=N(null),e=N(0),t=U(),{patient:n}=X(t);Z(()=>{var c;return(c=n.value)==null?void 0:c.patientID},async(c,_)=>{c&&c!==_&&(e.value++,await M())});const o=async()=>{if(!i.value)return console.error("Form reference is not available"),!1;const c=i.value.validateForm();if(c)return R("Please fix validation errors before submitting"),console.log("Validation errors:",c),!1;const _=i.value.getFormValues(),r=await a(_);return r.length===0?(R("No woman behaviour data to save"),!1):(await m.addObsToEncounterPatient(r,j.WOMAN_BEHAVIOUR),e.value++,await M(),J("Woman behaviour saved successfully"),!0)},a=async c=>{const _=[],r=c["Daily caffeine use"];if(Array.isArray(r)&&r.length>0)for(const d of r)d&&d!==""&&_.push(await m.buildValueText("Daily caffeine use",d));const b=c["Drug and substance abuse"];if(Array.isArray(b)&&b.length>0)for(const d of b)d&&d!==""&&_.push(await m.buildValueText("Drug and substance abuse",d));return _};ee(async()=>{await M()});const f=O(()=>s.womanBehaviourFormSection.value);return T({validateForm:()=>{var c;return(c=i.value)==null?void 0:c.validateForm()},onSubmit:o,resetForm:()=>{e.value++}}),(c,_)=>(S(),ne("div",ae,[y(v(Y),{class:"section"},{default:p(()=>[y(v(V),null,{default:p(()=>[(S(),W(q,{formData:f.value,ref_key:"formRef",ref:i,key:e.value},null,8,["formData"]))]),_:1})]),_:1})]))}}),he=L(se,[["__scopeId","data-v-069dc36d"]]),ce=()=>{const F=()=>{},T=O(()=>[{componentType:"checkboxField",name:"past surgeries",type:"multiple",twoColumns:!0,options:[{value:"dilation and currettage",label:"Dilation and currettage"},{value:"myomectomy",label:"Myomectomy"},{value:"removal of ovarian cyst",label:"Removal of ovarian cyst"},{value:"oophorectomy",label:"Oophorectomy"},{value:"salpingectomy",label:"Salpingectomy"},{value:"cervical cone",label:"Cervical cone"},{value:"Other",label:"Other"},{value:"None",label:"None"}],grid:{s:"12",md:"6"},onChange:(e,t)=>{if(!Array.isArray(e))return{};const n={},o=e[e.length-1];if(o==="None")return n["past surgeries"]=["None"],n["Other surgery notes"]="",n;if(e.includes("None")&&o!=="None"){const a=e.filter(f=>f!=="None");return n["past surgeries"]=a,a.includes("Other")||(n["Other surgery notes"]=""),n}return e.includes("Other")||(n["Other surgery notes"]=""),n}},{componentType:"inputField",header:"Specify other surgery",name:"Other surgery notes",icon:E.editPen,required:!0,twoColumns:!0,grid:{s:"12"},validation:(e,t)=>{const n=t==null?void 0:t["past surgeries"];return Array.isArray(n)&&n.includes("Other")&&(!e||e==="")?"Please specify other surgery":null},condition:e=>{const t=e["past surgeries"];return Array.isArray(t)&&t.includes("Other")}}]),s=O(()=>[{componentType:"checkboxField",name:"Allergies",type:"multiple",twoColumns:!0,options:[{value:"albendazole",label:"Albendazole"},{value:"aluminium-hydroxide",label:"Aluminium-hydroxide"},{value:"calcium",label:"Calcium"},{value:"chamomile",label:"Chamomile"},{value:"folic-acid",label:"Folic-acid"},{value:"ginger",label:"Ginger"},{value:"fish",label:"Fish"},{value:"iron",label:"Iron"},{value:"sulfadoxine-pyrimethamine",label:"Sulfadoxine-Pyrimethamine"},{value:"mebendazole",label:"Mebendazole"},{value:"penicillin",label:"Penicillin"},{value:"prep-tdf",label:"PrEP(TDF)"},{value:"Other",label:"Other"},{value:"None",label:"None"}],grid:{s:"12"},onChange:(e,t)=>{if(!Array.isArray(e))return{};const n={},o=e[e.length-1];if(o==="None")return n.allergies=["None"],n["Other allergy notes"]="",n;if(e.includes("None")&&o!=="None"){const a=e.filter(f=>f!=="None");return n.allergies=a,a.includes("Other")||(n["Other allergy notes"]=""),n}return e.includes("Other")||(n["Other allergy notes"]=""),n}},{componentType:"inputField",header:"Specify other allergy",name:"Other allergy notes",icon:E.editPen,required:!0,grid:{s:"12"},validation:(e,t)=>{const n=t==null?void 0:t.allergies;return Array.isArray(n)&&n.includes("Other")&&(!e||e==="")?"Please specify other allergy":null},condition:e=>{const t=e.allergies;return Array.isArray(t)&&t.includes("Other")}}]),i=O(()=>[{componentType:"checkboxField",name:"chronic conditions",type:"multiple",twoColumns:!0,options:[{value:"auto immune disease",label:"Auto-immune desease"},{value:"asthma",label:"Asthma"},{value:"sickle cell",label:"Sickle cell"},{value:"anemia",label:"Anemia"},{value:"hiv positive",label:"HIV positive"},{value:"thalassemia",label:"Thalassemia"},{value:"gynae cancer",label:"Gynae Cancer"},{value:"ccf",label:"CCF"},{value:"rhd",label:"RHD"},{value:"gestational diabetes",label:"Gestational diabetes"},{value:"diabetes type 1",label:"Diabetes Type 1"},{value:"diabetes type 2",label:"Diabetes Type 2"},{value:"epilepsy",label:"Epilepsy"},{value:"hypertension",label:"Hypertension"},{value:"kidney disease",label:"Kidney Disease"},{value:"tb",label:"TB"},{value:"mental illness",label:"Mental illness"},{value:"Other",label:"Other"},{value:"None",label:"None"}],grid:{s:"12",md:"6"},onChange:(e,t)=>{if(!Array.isArray(e))return{};const n={},o=e[e.length-1];if(o==="None")return n["chronic conditions"]=["None"],n["Other chronic notes"]="",n["HIV test date"]="",n["Is client on ART"]="",n["Art number"]="",n["facility for art"]="",n;if(e.includes("None")&&o!=="None"){const a=e.filter(f=>f!=="None");return n["chronic conditions"]=a,a.includes("hiv positive")||(n["HIV test date"]="",n["Is client on ART"]="",n["Art number"]="",n["facility for art"]=""),a.includes("Other")||(n["Other chronic notes"]=""),n}return e.includes("hiv positive")||(n["HIV test date"]="",n["Is client on ART"]="",n["Art number"]="",n["facility for art"]=""),e.includes("Other")||(n["Other chronic notes"]=""),n}},{componentType:"inputField",header:"Specify other chronic conditions",name:"Other chronic notes",icon:E.editPen,required:!0,grid:{s:"12"},validation:(e,t)=>{const n=t==null?void 0:t["chronic conditions"];return Array.isArray(n)&&n.includes("Other")&&(!e||e==="")?"Please specify other chronic conditions":null},condition:e=>{const t=e["chronic conditions"];return Array.isArray(t)&&t.includes("Other")}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"dateInputField",header:"HIV test date*",name:"HIV test date",icon:E.calenderPrimary,required:!0,grid:{s:"12",md:"6"},validation:(e,t)=>{const n=t==null?void 0:t["chronic conditions"];return Array.isArray(n)&&n.includes("hiv positive")&&(!e||e==="")?"HIV test date is required":null},condition:e=>{const t=e["chronic conditions"];return Array.isArray(t)&&t.includes("hiv positive")}},{componentType:"radioButtonField",header:"Is the client on ART?*",name:"Is client on ART",required:!0,options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],grid:{s:"12",md:"6"},validation:(e,t)=>{const n=t==null?void 0:t["chronic conditions"];return Array.isArray(n)&&n.includes("hiv positive")&&(!e||e==="")?"Please specify if client is on ART":null},condition:e=>{const t=e["chronic conditions"];return Array.isArray(t)&&t.includes("hiv positive")},onChange:(e,t)=>{const n={};return e==="No"&&(n["Art number"]="",n["facility for art"]=""),n}},{grid:{s:"12"},componentType:"Dashes"},{componentType:"inputField",header:"ART number*",name:"Art number",icon:E.editPen,required:!0,grid:{s:"6"},validation:(e,t)=>{const n=t==null?void 0:t["chronic conditions"],o=t==null?void 0:t["Is client on ART"];return Array.isArray(n)&&n.includes("hiv positive")&&o==="Yes"&&(!e||e==="")?"ART number is required":null},condition:e=>{const t=e["chronic conditions"],n=e["Is client on ART"];return Array.isArray(t)&&t.includes("hiv positive")&&n==="Yes"}},{componentType:"inputField",header:"Facility for ART*",name:"facility for art",icon:E.search,required:!0,grid:{s:"12",md:"6"},validation:(e,t)=>{const n=t==null?void 0:t["chronic conditions"],o=t==null?void 0:t["Is client on ART"];return Array.isArray(n)&&n.includes("hiv positive")&&o==="Yes"&&(!e||e==="")?"Facility for ART is required":null},condition:e=>{const t=e["chronic conditions"],n=e["Is client on ART"];return Array.isArray(t)&&t.includes("hiv positive")&&n==="Yes"}}]);return{resetForm:F,pastSurgeriesFormSection:T,allergiesFormSection:s,chronicConditionsFormSection:i}},le={class:"container"},ue=Q({__name:"MedicalHistory",setup(F,{expose:T}){const s=ce(),i=N(null),e=N(null),t=N(null),n=N(0),o=N(0),a=N(0),f=U(),{patient:c}=X(f);Z(()=>{var g;return(g=c.value)==null?void 0:g.patientID},async(g,l)=>{g&&g!==l&&(n.value++,o.value++,a.value++,await M())});const _=async()=>{var k,C,H,u,I,P;const g=(k=i.value)==null?void 0:k.validateForm(),l=(C=e.value)==null?void 0:C.validateForm(),A=(H=t.value)==null?void 0:H.validateForm();if(g||l||A)return R("Please fix validation errors before submitting"),!1;const h=((u=i.value)==null?void 0:u.getFormValues())||{},w=((I=e.value)==null?void 0:I.getFormValues())||{},x=((P=t.value)==null?void 0:P.getFormValues())||{},D=await r(h,w,x);return D.length===0?(R("No medical history data to save"),!1):(await m.addObsToEncounterPatient(D,j.MEDICAL_HISTORY),n.value++,o.value++,a.value++,await M(),J("Medical history saved successfully"),!0)},r=async(g,l,A)=>{const h=[],w=g["past surgeries"];if(Array.isArray(w)&&w.length>0)for(const u of w)u&&u!==""&&h.push(await m.buildValueText("Past surgery",u));const x=g["Other surgery notes"];x&&x!==""&&h.push(await m.buildValueText("Other surgery notes",x));const D=l.allergies;if(Array.isArray(D)&&D.length>0)for(const u of D)u&&u!==""&&h.push(await m.buildValueText("Allergy",u));const k=l["Other allergy notes"];k&&k!==""&&h.push(await m.buildValueText("Other allergy notes",k));const C=A["chronic conditions"];if(Array.isArray(C)&&C.length>0)for(const u of C)u&&u!==""&&h.push(await m.buildValueText("Chronic condition",u));const H=A["Other chronic notes"];if(H&&H!==""&&h.push(await m.buildValueText("Other chronic condition notes",H)),Array.isArray(C)&&C.includes("hiv positive")){const u=A["HIV test date"];u&&u!==""&&h.push(await m.buildValueText("HIV test date",u));const I=A["Is client on ART"];if(I&&I!==""&&h.push(await m.buildValueText("Is client on ART",I)),I==="Yes"){const P=A["Art number"];P&&P!==""&&h.push(await m.buildValueText("ART number",P));const K=A["facility for art"];K&&K!==""&&h.push(await m.buildValueText("Facility for ART",K))}}return h};ee(async()=>{await M()});const b=O(()=>s.pastSurgeriesFormSection.value),d=O(()=>s.allergiesFormSection.value),B=O(()=>s.chronicConditionsFormSection.value);return T({validateForm:()=>{var h,w,x;const g=(h=i.value)==null?void 0:h.validateForm(),l=(w=e.value)==null?void 0:w.validateForm(),A=(x=t.value)==null?void 0:x.validateForm();return g||l||A},onSubmit:_,resetForm:()=>{n.value++,o.value++,a.value++}}),(g,l)=>(S(),ne("div",le,[y(v(Y),{class:"section"},{default:p(()=>[y(v(z),null,{default:p(()=>[y(v(G),{class:"sub_item_header"},{default:p(()=>[...l[0]||(l[0]=[$("Past Medical and Surgical History",-1)])]),_:1})]),_:1}),y(v(V),null,{default:p(()=>[(S(),W(q,{formData:b.value,ref_key:"surgeriesFormRef",ref:i,key:n.value},null,8,["formData"]))]),_:1})]),_:1}),y(v(Y),{class:"section"},{default:p(()=>[y(v(z),null,{default:p(()=>[y(v(G),{class:"sub_item_header"},{default:p(()=>[...l[1]||(l[1]=[$("Allergies",-1)])]),_:1})]),_:1}),y(v(V),null,{default:p(()=>[(S(),W(q,{formData:d.value,ref_key:"allergiesFormRef",ref:e,key:o.value},null,8,["formData"]))]),_:1})]),_:1}),y(v(Y),{class:"section"},{default:p(()=>[y(v(z),null,{default:p(()=>[y(v(G),{class:"sub_item_header"},{default:p(()=>[...l[2]||(l[2]=[$("Existing Chronic Health Conditions",-1)])]),_:1})]),_:1}),y(v(V),null,{default:p(()=>[(S(),W(q,{formData:B.value,ref_key:"chronicFormRef",ref:t,key:a.value},null,8,["formData"]))]),_:1})]),_:1})]))}}),ye=L(ue,[["__scopeId","data-v-806b49d9"]]);export{ye as M,he as W,fe as a};
