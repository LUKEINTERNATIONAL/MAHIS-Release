import{d$ as Fe,e0 as Ne,d as te,r as w,w as A,a as ie,O as Q,f as g,u as e,bi as xe,J as r,l as a,I as Ee,G as ve,E as Me,Q as C,K as k,a_ as pe,N as V,L as N,a2 as Ae,a3 as ue,k as y,e as U,m as S,_ as $,p as b,b2 as ee,W as q,a0 as Be,$ as ge,bC as he,F as Z,P as ne,bB as _e,bs as Pe,M as be,c as ae,bq as Oe,aR as $e,dX as Te,aQ as De,cy as Re,c$ as Ve,dk as ye,bD as qe,cj as Le,cK as ze,aU as je,e1 as He,e2 as Ge,e3 as Je,e4 as Ke,e5 as Qe,e6 as Ye,e7 as We,e8 as Xe,aq as Ze,cw as K,U as Ue,a5 as re,bH as ea,e9 as aa,a4 as we,dd as ta,de as oe,br as sa,a6 as la}from"./vendor-ChpUWbYC.js";import{N as ra}from"./NavigationMenu-CDoOsOph.js";import{E as oa}from"./EIRreportsStore-IODKEcL5.js";import{B as na}from"./bottomNavBar-rLS9-JOf.js";import{a8 as ia,aw as Se,U as ke,ax as ua,F as da,H as ca,s as X,_ as de,ay as Ce}from"../index-DySoFw7y.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-Cj7xBElI.js";function ma(){const I=()=>{const p="0123456789ABCDEF";let u="";for(let m=0;m<6;m++)u+=p[Math.floor(Math.random()*16)];return u};return{getAvatarUrl:(p,u=128)=>{const m="".concat(p),_=Fe(Ne,{seed:m,size:u,backgroundColor:[I()]}).toString(),M=unescape(encodeURIComponent(_));return"data:image/svg+xml;base64,".concat(btoa(M))}}}const fa=()=>{const I="programs",B=Se;async function p(m){const v=await B.getAll(I,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve programs.")}async function u(){const m=await ia.getAllPrograms(),v=[];return m.forEach(_=>{v.push({name:_.name,other:_,selected:!1})}),m}return{getPrograms:p,getEMRPrograms:u}},va=fa(),pa=()=>{const I="roles",B=Se;async function p(m){const v=await B.getAll(I,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve user roles.")}async function u(){return await ke.getAllRoles()}return{getUserRoles:p,getEMRUserRoles:u}},ga=pa(),ha={key:0,class:"error-message"},_a={key:1,class:"error-message"},ya={key:2,class:"error-message"},Ua={key:3,class:"error-message"},wa={key:5,class:"error-message"},Ca={key:0,class:"error-message"},Ia={style:{display:"flex",gap:"20px","margin-top":"8px"}},ba={key:6,class:"error-message"},Sa={key:7,class:"error-message"},ka={key:8,class:"error-message"},Fa={class:"form_el"},Ie=36,Na=te({__name:"UserFormModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["save","close"],setup(I,{emit:B}){const p=I,u=B,m=w(!1),v=w(null),_=w([]),M=w({}),x=w(),s=w({name:!1,firstName:!1,lastName:!1,password:!1,dateOfBirth:!1,gender:!1,roles:!1,programs:!1,usernameExists:!1}),n=w({name:"",firstName:"",lastName:"",password:"",gender:"",roles:[],programs:[]}),E=w([]),O=w([]);function L(o){const i=o.value.formattedDate;x.value=ca.toStandardHisFormat(i),s.value.dateOfBirth=!1}function P(){v.value?m.value=!1:m.value=!0}const z=o=>{v.value=o.selected_location,P()},T=()=>{n.value={name:"",firstName:"",lastName:"",password:"",dateOfBirth:"",gender:"",facility:null,roles:[],programs:[]},x.value=null,v.value=null,M.value={},m.value=!1,Object.keys(s.value).forEach(o=>{s.value[o]=!1})},D=()=>{var i;s.value.name=!1,s.value.firstName=!1,s.value.lastName=!1,s.value.password=!1,s.value.dateOfBirth=!1,s.value.gender=!1,s.value.roles=!1,s.value.programs=!1;let o=!0;return n.value.name.trim()||(s.value.name=!0,o=!1),n.value.firstName.trim()||(s.value.firstName=!0,o=!1),n.value.lastName.trim()||(s.value.lastName=!0,o=!1),!p.editingUser&&!((i=n.value.password)!=null&&i.trim())&&(s.value.password=!0,o=!1),x.value||(s.value.dateOfBirth=!0,o=!1),n.value.gender||(s.value.gender=!0,o=!1),n.value.roles.length||(s.value.roles=!0,o=!1),n.value.programs.length||(s.value.programs=!0,o=!1),o},R=()=>{if(!p.editingUser){const o=E.value.find(i=>i.program_id===Ie);o&&(n.value.programs=[o.name],s.value.programs=!1)}},Y=async()=>{try{const f=(await va.getEMRPrograms()).filter(F=>F.program_id===Ie);E.value=f.map(F=>({program_id:F.program_id,name:F.name})),R()}catch(o){console.error("Failed to fetch programs:",o),X("Failed to load programs.")}},j=async()=>{try{const i=await ga.getUserRoles();O.value=i.map(f=>f.name)}catch(o){X("Failed to load roles.")}},H=async o=>{const i=p.editingUser?p.editingUser.name!==o:!0;if(!o.trim()||!i)return s.value.usernameExists=!1,!0;try{const F=(await ke.doesUsernameExist(o)).exists===!0;return s.value.usernameExists=F,!F}catch(f){return console.error("Error checking username existence:",f),X("Failed to verify username availability. Proceeding with caution."),s.value.usernameExists=!1,!0}};A(()=>n.value.name,async o=>{o.trim()?(s.value.name=!1,await H(o)):(s.value.name=!0,s.value.usernameExists=!1)}),A(()=>n.value.firstName,()=>{n.value.firstName.trim()&&(s.value.firstName=!1)}),A(()=>n.value.lastName,()=>{n.value.lastName.trim()&&(s.value.lastName=!1)}),A(()=>n.value.password,()=>{var o;(o=n.value.password)!=null&&o.trim()&&(s.value.password=!1)}),A(()=>n.value.gender,()=>{n.value.gender&&(s.value.gender=!1)}),A(()=>n.value.roles,()=>{n.value.roles.length>0&&(s.value.roles=!1)}),A(()=>n.value.programs,()=>{n.value.programs.length>0&&(s.value.programs=!1)}),A(()=>p.editingUser,o=>{if(o){const i=o.name.split(" "),f=i[0]||"",F=i.length>1?i.slice(1).join(" "):"";n.value={name:o.name,firstName:f,lastName:F,dateOfBirth:o.dateOfBirth||"",gender:o.gender||"",facility:o.facility||null,roles:o.roles,programs:o.programs},o.dateOfBirth&&(x.value=o.dateOfBirth),o.facility&&(v.value=o.facility,M.value=o.facility)}else T(),R()},{immediate:!0}),A(()=>p.isOpen,o=>{o&&!p.editingUser&&(T(),R())});const d=async()=>{const o=D();P();const i=await H(n.value.name);if(!o||m.value||!i){!o||m.value?X("Please fill out all required fields."):i||X("The chosen username is already taken.");return}const f=n.value.programs.map(W=>{const se=E.value.find(t=>t.name===W);return se?se.program_id:null}).filter(W=>W!==null),F={...n.value,dateOfBirth:x.value,facility:v.value,programIDs:f};u("save",F)},G=()=>{u("close")};return ie(()=>{T(),Y(),j()}),(o,i)=>(g(),Q(e(xe),{"is-open":I.isOpen,onDidDismiss:G},{default:r(()=>[a(e(Ee),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(Me),null,{default:r(()=>[C(k(I.editingUser?"Edit User":"Add New User"),1)]),_:1}),a(e(pe),{slot:"end"},{default:r(()=>[a(e(V),{onClick:G,fill:"clear"},{default:r(()=>[a(e(N),{style:{"font-size":"35px"},icon:e(Ae)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ue),{class:"ion-padding"},{default:r(()=>[y("form",{id:"user-form",onSubmit:Pe(d,["prevent"])},[a(e($),{class:b({"error-item":s.value.name||s.value.usernameExists})},{default:r(()=>[a(e(ee),{modelValue:n.value.name,"onUpdate:modelValue":i[0]||(i[0]=f=>n.value.name=f),label:"Username","label-placement":"stacked",placeholder:"Enter username",required:"",class:b({"error-input":s.value.name||s.value.usernameExists})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.name?(g(),U("div",ha," Username is required ")):s.value.usernameExists?(g(),U("div",_a," This username is already taken. ")):S("",!0),a(e($),{class:b({"error-item":s.value.firstName})},{default:r(()=>[a(e(ee),{modelValue:n.value.firstName,"onUpdate:modelValue":i[1]||(i[1]=f=>n.value.firstName=f),label:"First Name","label-placement":"stacked",placeholder:"Enter first name",required:"",class:b({"error-input":s.value.firstName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.firstName?(g(),U("div",ya," First name is required ")):S("",!0),a(e($),{class:b({"error-item":s.value.lastName})},{default:r(()=>[a(e(ee),{modelValue:n.value.lastName,"onUpdate:modelValue":i[2]||(i[2]=f=>n.value.lastName=f),label:"Last Name","label-placement":"stacked",placeholder:"Enter last name",required:"",class:b({"error-input":s.value.lastName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.lastName?(g(),U("div",Ua," Last name is required ")):S("",!0),I.editingUser?S("",!0):(g(),Q(e($),{key:4,class:b({"error-item":s.value.password})},{default:r(()=>[a(e(ee),{modelValue:n.value.password,"onUpdate:modelValue":i[3]||(i[3]=f=>n.value.password=f),label:"Password","label-placement":"stacked",placeholder:"Enter password",type:"password",required:"",class:b({"error-input":s.value.password})},null,8,["modelValue","class"])]),_:1},8,["class"])),s.value.password&&!I.editingUser?(g(),U("div",wa," Password is required ")):S("",!0),y("div",{class:b(["form_el",{"error-section":s.value.dateOfBirth}])},[y("h6",{style:{"font-size":"16px","font-weight":"400"},class:b({"error-label":s.value.dateOfBirth})}," Date Of Birth ",2),a(ua,{place_holder:"Date Of Birth",onDateUpDated:L,date_prop:""}),s.value.dateOfBirth?(g(),U("div",Ca," Date of birth is required ")):S("",!0)],2),a(e($),{class:b({"error-item":s.value.gender})},{default:r(()=>[a(e(q),{position:"stacked",class:b({"error-label":s.value.gender})},{default:r(()=>[...i[7]||(i[7]=[C("Gender",-1)])]),_:1},8,["class"]),a(e(Be),{modelValue:n.value.gender,"onUpdate:modelValue":i[4]||(i[4]=f=>n.value.gender=f)},{default:r(()=>[y("div",Ia,[a(e($),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"male"}),a(e(q),null,{default:r(()=>[...i[8]||(i[8]=[C("Male",-1)])]),_:1})]),_:1}),a(e($),{lines:"none",style:{"--padding-start":"0"}},{default:r(()=>[a(e(ge),{slot:"start",value:"female"}),a(e(q),null,{default:r(()=>[...i[9]||(i[9]=[C("Female",-1)])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["class"]),s.value.gender?(g(),U("div",ba," Gender is required ")):S("",!0),a(e($),{class:b({"error-item":s.value.roles})},{default:r(()=>[a(e(he),{modelValue:n.value.roles,"onUpdate:modelValue":i[5]||(i[5]=f=>n.value.roles=f),label:"Roles","label-placement":"stacked",placeholder:"Select roles",multiple:"",class:b({"error-input":s.value.roles})},{default:r(()=>[(g(!0),U(Z,null,ne(O.value,f=>(g(),Q(e(_e),{key:f,value:f},{default:r(()=>[C(k(f),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.roles?(g(),U("div",Sa," At least one role is required ")):S("",!0),a(e($),{class:b({"error-item":s.value.programs})},{default:r(()=>[a(e(he),{modelValue:n.value.programs,"onUpdate:modelValue":i[6]||(i[6]=f=>n.value.programs=f),label:"Programs","label-placement":"stacked",placeholder:"Select programs",multiple:"",class:b({"error-input":s.value.programs})},{default:r(()=>[(g(!0),U(Z,null,ne(E.value,f=>(g(),Q(e(_e),{key:f.id,value:f.name},{default:r(()=>[C(k(f.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.programs?(g(),U("div",ka," At least one program is required ")):S("",!0),y("div",Fa,[i[10]||(i[10]=y("h6",{style:{"font-size":"16px","font-weight":"400"}},"Facility",-1)),a(da,{show_error:m.value,onFacilitySelected:z,selected_district_ids:_.value,selected_location:M.value},null,8,["show_error","selected_district_ids","selected_location"])])],32)]),_:1}),a(e(be),null,{default:r(()=>[a(e(ve),null,{default:r(()=>[a(e(pe),{slot:"end"},{default:r(()=>[y("div",null,[a(e(V),{onClick:G,fill:"solid"},{default:r(()=>[...i[11]||(i[11]=[C(" Cancel ",-1)])]),_:1}),a(e(V),{onClick:d,fill:"solid",style:{"margin-left":"10px","margin-right":"10px"}},{default:r(()=>[C(k(I.editingUser?"Update":"Create")+" User ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]))}}),xa=de(Na,[["__scopeId","data-v-1e565356"]]),Ea={class:"users-grid"},Ma={class:"user-header"},Aa=["src","alt"],Ba={class:"user-info"},Pa={key:0,class:"user-meta"},Oa={key:0,class:"meta-item"},$a={key:1,class:"meta-item"},Ta={class:"user-details"},Da={key:0,class:"detail-item"},Ra={key:1,class:"detail-item"},Va={key:2,class:"detail-item"},qa={class:"detail-item"},La={class:"detail-item"},za={class:"action-buttons"},ja={key:0,class:"empty-state"},Ha=te({__name:"miUsersTemplate",props:{initialSearchTerm:{default:""},initialStatusFilter:{default:"all"},initialItemsPerPage:{default:6},enableSearch:{type:Boolean,default:!0},enableStatusFilter:{type:Boolean,default:!0},enablePagination:{type:Boolean,default:!0},searchPlaceholder:{default:"Search users..."},searchDebounceTime:{default:300}},emits:["search-changed","status-filter-changed","users-filtered","user-edited","user-deleted","user-status-changed","user-created"],setup(I,{expose:B,emit:p}){const u=I,m=p,v=w([]),_=w(u.initialSearchTerm),M=w(u.initialStatusFilter),x=w(1),s=w(u.initialItemsPerPage),n=w(!1),E=w(null);let O=null;const L=t=>{var l,h,J,ce,me,fe;const{getAvatarUrl:c}=ma();return{id:t.id,name:t.username,email:t.username,dateOfBirth:(l=t.profile)==null?void 0:l.dateOfBirth,gender:(h=t.profile)==null?void 0:h.gender,facility:(ce=(J=t.facilities)==null?void 0:J[0])!=null&&ce.facility?{name:t.facilities[0].facility.facility_name,code:t.facilities[0].facility.facility_code}:null,roles:((me=t.roles)==null?void 0:me.map(le=>le.role.name))||[],programs:((fe=t.programs)==null?void 0:fe.map(le=>le.program.name))||[],status:"active",avatar:c(t.username),createdAt:new Date(t.createdAt),lastActive:new Date(t.updatedAt)}},P=ae(()=>{let t=v.value;if(u.enableSearch&&_.value){const c=_.value.toLowerCase();t=t.filter(l=>l.name.toLowerCase().includes(c)||l.email.toLowerCase().includes(c)||l.roles&&l.roles.some(h=>h.toLowerCase().includes(c))||l.programs&&l.programs.some(h=>h.toLowerCase().includes(c))||l.gender&&l.gender.toLowerCase().includes(c)||l.facility&&l.facility.name&&l.facility.name.toLowerCase().includes(c))}return u.enableStatusFilter&&M.value!=="all"&&(t=t.filter(c=>c.status===M.value)),t}),z=ae(()=>{if(!u.enablePagination)return P.value;const t=(x.value-1)*s.value,c=t+s.value;return P.value.slice(t,c)});A(()=>_.value,t=>{O&&clearTimeout(O),O=setTimeout(()=>{m("search-changed",t),x.value=1},u.searchDebounceTime)},{immediate:!1}),A(()=>M.value,t=>{m("status-filter-changed",t),x.value=1},{immediate:!1}),A(()=>P.value,t=>{m("users-filtered",t)},{deep:!0,immediate:!0});const T=t=>{x.value=t.page,s.value=t.itemsPerPage},D=t=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t),R=t=>{const c=new Date,l=new Date(t);let h=c.getFullYear()-l.getFullYear();const J=c.getMonth()-l.getMonth();return(J<0||J===0&&c.getDate()<l.getDate())&&h--,h},Y=t=>{E.value=t,n.value=!0},j=()=>{n.value=!1,E.value=null},H=async t=>{try{if(E.value){const c=v.value.findIndex(h=>h.id===E.value.id);if(c!==-1){const h={...v.value[c],...t};v.value[c]=h,m("user-edited",h)}(await K.create({message:"User updated successfully",duration:2e3,color:"success"})).present()}else{const c=await d(t),l=await Ce.register(c),h=L(l);h&&(v.value.push(h),m("user-created",h),(await K.create({message:"User created successfully",duration:2e3,color:"success"})).present())}j()}catch(c){(await K.create({message:"Error saving user: ".concat(c),duration:2e3,color:"danger"})).present()}},d=async t=>{if(!t||!t.facility)throw new Error("Invalid user data. 'facility' is required.");return{username:t.name,password:t.password,roles:t.roles,programs:t.programs,programIds:t.programIDs,facilities:[t.facility.code],profile:{firstName:t.firstName,lastName:t.lastName,gender:t.gender,dateOfBirth:"1990-01-01T00:00:00.000Z"}}},G=async t=>{(await Ue.create({header:"Confirm Status Change",message:"Are you sure you want to ".concat(t.status==="active"?"deactivate":"activate"," ").concat(t.name,"?"),buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:()=>{t.status=t.status==="active"?"inactive":"active",m("user-status-changed",t),K.create({message:"User ".concat(t.status==="active"?"activated":"deactivated"," successfully"),duration:2e3,color:"success"}).then(l=>l.present())}}]})).present()},o=async t=>{(await Ue.create({header:"Confirm Delete",message:"Are you sure you want to delete ".concat(t.name,"? This action cannot be undone."),buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{const l=v.value.findIndex(h=>h.id===t.id);l!==-1&&(v.value.splice(l,1),m("user-deleted",t.id),K.create({message:"User deleted successfully",duration:2e3,color:"success"}).then(h=>h.present()))}}]})).present()},i=t=>{_.value=t},f=t=>{M.value=t},F=async()=>{try{const t=await Ce.getUsers();v.value=t.map(L)}catch(t){console.error("Failed to fetch MIUM users:",t),K.create({message:"Failed to load users.",duration:2e3,color:"danger"}).then(c=>c.present())}},W=()=>{E.value=null,n.value=!0};return ie(async()=>{await F()}),B({setSearchTerm:i,setStatusFilter:f,refreshUsers:F,cleanup:()=>{O&&clearTimeout(O)},openAddUserModal:W,users:v.value,filteredUsers:P,paginatedUsers:z}),(t,c)=>(g(),U(Z,null,[a(e(ue),{class:"ion-padding",style:{height:"80vh"}},{default:r(()=>[y("div",Ea,[(g(!0),U(Z,null,ne(z.value,l=>(g(),Q(e(Oe),{key:l.id,class:"user-card"},{default:r(()=>[a(e($e),null,{default:r(()=>[y("div",Ma,[a(e(Te),null,{default:r(()=>[y("img",{src:l.avatar,alt:l.name},null,8,Aa)]),_:2},1024),y("div",Ba,[a(e(De),null,{default:r(()=>[C(k(l.name),1)]),_:2},1024),a(e(Re),null,{default:r(()=>[C(k(l.email),1)]),_:2},1024),l.gender||l.dateOfBirth?(g(),U("div",Pa,[l.gender?(g(),U("span",Oa,[a(e(N),{icon:e(Ve),class:"meta-icon"},null,8,["icon"]),C(" "+k(l.gender),1)])):S("",!0),l.dateOfBirth?(g(),U("span",$a,[a(e(N),{icon:e(ye),class:"meta-icon"},null,8,["icon"]),C(" "+k(R(l.dateOfBirth))+" years old ",1)])):S("",!0)])):S("",!0)]),a(e(qe),{color:l.status==="active"?"success":"medium",class:"status-chip"},{default:r(()=>[a(e(N),{icon:l.status==="active"?e(Le):e(ze),slot:"start"},null,8,["icon"]),a(e(q),null,{default:r(()=>[C(k(l.status),1)]),_:2},1024)]),_:2},1032,["color"])])]),_:2},1024),a(e(je),null,{default:r(()=>[y("div",Ta,[l.roles&&l.roles.length?(g(),U("div",Da,[a(e(N),{icon:e(He),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.roles.join(", ")),1)])):S("",!0),l.programs&&l.programs.length?(g(),U("div",Ra,[a(e(N),{icon:e(Ge),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.programs.join(", ")),1)])):S("",!0),l.facility?(g(),U("div",Va,[a(e(N),{icon:e(Je),class:"detail-icon"},null,8,["icon"]),y("span",null,k(l.facility.name||"Assigned Facility"),1)])):S("",!0),y("div",qa,[a(e(N),{icon:e(ye),class:"detail-icon"},null,8,["icon"]),y("span",null,"Joined "+k(D(l.createdAt)),1)]),y("div",La,[a(e(N),{icon:e(Ke),class:"detail-icon"},null,8,["icon"]),y("span",null,"Last active "+k(D(l.lastActive)),1)])]),y("div",za,[a(e(V),{onClick:h=>Y(l),fill:"outline",size:"small",color:"primary"},{default:r(()=>[a(e(N),{icon:e(Qe),slot:"start"},null,8,["icon"]),c[0]||(c[0]=C(" Edit ",-1))]),_:1},8,["onClick"]),a(e(V),{onClick:h=>G(l),fill:"outline",size:"small",color:l.status==="active"?"warning":"success"},{default:r(()=>[a(e(N),{icon:l.status==="active"?e(Ye):e(We),slot:"start"},null,8,["icon"]),C(" "+k(l.status==="active"?"Deactivate":"Activate"),1)]),_:2},1032,["onClick","color"]),a(e(V),{onClick:h=>o(l),fill:"outline",size:"small",color:"danger"},{default:r(()=>[a(e(N),{icon:e(Xe),slot:"start"},null,8,["icon"]),c[1]||(c[1]=C(" Delete ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),P.value.length===0?(g(),U("div",ja,[a(e(N),{icon:e(Ze),class:"empty-icon"},null,8,["icon"]),c[2]||(c[2]=y("h3",null,"No users found",-1)),c[3]||(c[3]=y("p",null,"Try adjusting your search or filter criteria",-1))])):S("",!0)]),_:1}),a(e(be),null,{default:r(()=>[a(na,{"total-items":P.value.length,"current-page":x.value,"items-per-page":s.value,"onUpdate:pagination":T},null,8,["total-items","current-page","items-per-page"])]),_:1}),a(xa,{"is-open":n.value,"editing-user":E.value,onSave:H,onClose:j},null,8,["is-open","editing-user"])],64))}}),Ga=de(Ha,[["__scopeId","data-v-8f4430d8"]]),Ja=te({__name:"UserNav",props:{searchTerm:{type:String,required:!0},statusFilter:{type:String,required:!0}},emits:["update:searchTerm","update:statusFilter","openAddUserModal"],setup(I,{emit:B}){return(p,u)=>(g(),U(Z,null,[a(e(we),{class:"ion-align-items-center"},{default:r(()=>[a(e(re),{size:"8"},{default:r(()=>[a(e(ea),{value:I.searchTerm,onIonInput:u[0]||(u[0]=m=>p.$emit("update:searchTerm",m.detail.value)),placeholder:"Search users...","show-clear-button":"focus",debounce:"300"},null,8,["value"])]),_:1}),a(e(re),{size:"4",class:"ion-text-right"},{default:r(()=>[a(e(V),{onClick:u[1]||(u[1]=m=>p.$emit("openAddUserModal")),fill:"solid"},{default:r(()=>[a(e(N),{icon:e(aa),slot:"start"},null,8,["icon"]),u[3]||(u[3]=C(" Add User ",-1))]),_:1})]),_:1})]),_:1}),a(e(we),{class:"ion-padding-start ion-padding-end"},{default:r(()=>[a(e(re),{size:"12"},{default:r(()=>[a(e(ta),{value:I.statusFilter,onIonChange:u[2]||(u[2]=m=>p.$emit("update:statusFilter",m.detail.value))},{default:r(()=>[a(e(oe),{value:"all"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[4]||(u[4]=[C("All",-1)])]),_:1})]),_:1}),a(e(oe),{value:"active"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[5]||(u[5]=[C("Active",-1)])]),_:1})]),_:1}),a(e(oe),{value:"inactive"},{default:r(()=>[a(e(q),null,{default:r(()=>[...u[6]||(u[6]=[C("Inactive",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})],64))}}),Ka={class:"sticky-user-nav"},Qa=te({__name:"miusers",setup(I,{expose:B}){const p=w(""),u=w("all"),m=w([]),v=w(0),_=w();ae(()=>p.value),ae(()=>u.value);const M=d=>{p.value=d,console.log("Search term updated:",d)},x=d=>{u.value=d,console.log("Status filter updated:",d)},s=d=>{p.value!==d&&(p.value=d),console.log("Internal search changed:",d)},n=d=>{u.value!==d&&(u.value=d),console.log("Internal filter changed:",d)},E=d=>{v.value=d.length},O=d=>{console.log("User created:",d)},L=d=>{console.log("User edited:",d)},P=d=>{console.log("User deleted:",d)},z=d=>{console.log("User status changed:",d)},T=()=>{_.value?_.value.openAddUserModal():console.log("usersTemplateRef is not yet available.")},D=async()=>{try{console.log("Loading users...")}catch(d){console.error("Error loading users:",d)}},R=async()=>{oa().setNavigationPayload("Manage Integrated Users",!0,!1,"/","home","")},Y=()=>{_.value&&_.value.refreshUsers(),D()},j=d=>{p.value=d,_.value&&_.value.setSearchTerm(d)},H=d=>{u.value=d,_.value&&_.value.setStatusFilter(d)};return ie(async()=>{await R(),await D()}),sa(()=>{_.value&&typeof _.value.cleanup=="function"&&_.value.cleanup()}),B({refreshUsers:Y,setSearch:j,setFilter:H,searchTerm:p,statusFilter:u,usersList:m,filteredUsersCount:v}),(d,G)=>(g(),Q(e(la),null,{default:r(()=>[a(ra),a(e(ue),{fullscreen:!0},{default:r(()=>[y("div",Ka,[a(Ja,{fullscreen:!0,searchTerm:p.value,statusFilter:u.value,"onUpdate:searchTerm":M,"onUpdate:statusFilter":x,onOpenAddUserModal:T},null,8,["searchTerm","statusFilter"])]),a(Ga,{ref_key:"usersTemplateRef",ref:_,"initial-users":m.value,"initial-search-term":p.value,"initial-status-filter":u.value,"search-debounce-time":500,"enable-search":!0,"enable-status-filter":!0,"enable-pagination":!0,onSearchChanged:s,onStatusFilterChanged:n,onUsersFiltered:E,onUserCreated:O,onUserEdited:L,onUserDeleted:P,onUserStatusChanged:z},null,8,["initial-users","initial-search-term","initial-status-filter"])]),_:1})]),_:1}))}}),st=de(Qa,[["__scopeId","data-v-5071b8a1"]]);export{st as default};
