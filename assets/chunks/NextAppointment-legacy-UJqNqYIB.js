System.register(["./vendor-legacy-DVP2kfMo.js","../index-legacy-CFTaXms3.js","./DashBox-legacy-BetvsCaF.js","./BasicForm-legacy-C-d4QTKz.js","./LabOrdersList-legacy-BopY1ePL.js","./group_validation-legacy-CfduED7r.js","./RadiologyStore-legacy-BbgyIvI7.js","./useFormWizard-legacy-BQEmMi52.js","./ncd_appointment_service-legacy-Bowx4v2A.js","./DateInputField-legacy-DMeh2yue.js"],function(t,e){"use strict";var a,n,i,o,s,d,l,r,c,p,u,m,h,g,v,f,b,y,x,_,D,I,w,S,A,k,L,E,C,B,O,N,M,R,P,F,z,T,H,U,V,$,j,q,W,Y,G,X,J,K,Q,Z,tt,et,at,nt,it,ot,st,dt,lt,rt,ct,pt,ut,mt,ht,gt,vt,ft,bt,yt,xt,_t,Dt,It,wt,St,At,kt,Lt,Et,Ct,Bt,Ot,Nt;return{setters:[t=>{a=t.d,n=t.aV,i=t.r,o=t.a,s=t.H,d=t.O,l=t.f,r=t.J,c=t.l,p=t.k,u=t.e,m=t.P,h=t.F,g=t.m,v=t.u,f=t.ah,b=t.b5,y=t.b2,x=t.G,_=t.E,D=t.ai,I=t.aj,w=t._,S=t.I,A=t.a3,k=t.bf,L=t.aU,E=t.Q,C=t.L,B=t.W,O=t.a5,N=t.p,M=t.K,R=t.c,P=t.aS,F=t.aR,z=t.aw,T=t.aP,H=t.N,U=t.a2,V=t.w,$=t.bv,j=t.bo,q=t.bP,W=t.aN},t=>{Y=t.O,G=t.bm,X=t.t,J=t.S,K=t.l,Q=t._,Z=t.J,tt=t.b5,et=t.B,at=t.bd,nt=t.M,it=t.o,ot=t.aQ,st=t.aH,dt=t.H,lt=t.u,rt=t.V,ct=t.aR,pt=t.bn,ut=t.bo,mt=t.aq,ht=t.bp,gt=t.A,vt=t.bq,ft=t.m,bt=t.b8,yt=t.e,xt=t.ay,_t=t.y,Dt=t.az,It=t.P,wt=t.a},t=>{St=t.D},t=>{At=t.B},t=>{kt=t.default},t=>{Lt=t.v},t=>{Et=t.u},t=>{Ct=t.b,Bt=t.d},t=>{Ot=t.A},t=>{Nt=t.D}],execute:function(){var e=document.createElement("style");e.textContent="#ABDOMEN-2[data-v-5ab54fe8],#SPINE[data-v-5ab54fe8]{display:none}.white-fill[data-v-5ab54fe8]{fill:#fff!important}.dark-green-stroke[data-v-5ab54fe8]{stroke:#006401!important}.dark-green-fill[data-v-5ab54fe8]{fill:#006401!important}.bright-green-fill[data-v-5ab54fe8]{fill:#ded!important}ion-footer[data-v-5ab54fe8]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-5ab54fe8]{--width: 90%;--height: 94%}.form-column[data-v-5ab54fe8]{border-left:1px solid #a3a1a1;max-height:600px;display:flex;flex-direction:column}.scrollable-container[data-v-5ab54fe8]{overflow-y:auto;max-height:100%;padding-right:10px;padding-left:10px}.form-section[data-v-5ab54fe8]{margin-bottom:20px}.form-section h6[data-v-5ab54fe8]{margin-top:0;margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid #eaeaea;font-weight:600}#container[data-v-0803dcda]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-0803dcda]{font-size:20px;line-height:26px}#container p[data-v-0803dcda]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-0803dcda]{text-decoration:none}.action_buttons[data-v-0803dcda]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-0803dcda]{padding-left:20px}.item_no_border[data-v-0803dcda]{--border-color: transparent}.search_result[data-v-0803dcda]{padding:10px}.action_buttons[data-v-0803dcda]{opacity:0;transition:opacity .3s}.dashed_bottom_border:hover .action_buttons[data-v-0803dcda]{opacity:1}.dashed_bottom_border[data-v-0803dcda]{font-weight:700}.sub_item_body[data-v-0803dcda]{margin-left:45px}ion-segment-button[data-v-0803dcda]{background:#fff;margin-right:1px;font-size:12px;text-transform:unset}.bottomSummary[data-v-0803dcda]{margin-top:20px;max-width:600px}.bottomSummary .segment-button-checked[data-v-0803dcda]{background:#fff!important;--indicator-color: none}.bottomSummary ion-segment-button[data-v-0803dcda]{background:#e6e6e6;margin-right:5px;border-top-right-radius:10px;border-top-left-radius:10px;text-transform:unset;font-style:normal;font-weight:700;font-size:12px}.medication-item[data-v-01c693a3]{padding:16px;border-radius:8px;background:#fff;border:1px solid #e5e7eb;margin-bottom:12px;transition:all .2s ease}.medication-item[data-v-01c693a3]:hover{box-shadow:0 2px 4px rgba(0,0,0,.05);border-color:#d1d5db}.medication-header[data-v-01c693a3]{margin-bottom:8px}.medication-name[data-v-01c693a3]{color:#111827;font-size:16px;font-weight:600;line-height:1.4;font-family:Inter,system-ui,-apple-system,sans-serif}.medication-details[data-v-01c693a3]{align-items:center}.details-col[data-v-01c693a3]{padding-right:16px}.details-text[data-v-01c693a3]{color:#4b5563;font-size:14px;font-weight:500;line-height:1.5;font-family:Inter,system-ui,-apple-system,sans-serif}.route-label[data-v-01c693a3]{color:#dc2626;font-weight:600;padding:2px 6px;background-color:#fee2e2;border-radius:4px;margin-left:4px}.actions-col[data-v-01c693a3]{display:flex;justify-content:flex-end;align-items:center;gap:12px}.action-button[data-v-01c693a3]{display:none;padding:6px;border-radius:4px;cursor:pointer;transition:all .2s ease}.action-button[data-v-01c693a3]:hover{background-color:#f3f4f6}.action-button ion-icon[data-v-01c693a3]{font-size:18px;color:#6b7280}.item-native[data-v-01c693a3]{background-color:#f9fafb!important;border-radius:6px}.truncate-text[data-v-01c693a3]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:100%;display:block}.details-text[data-v-01c693a3]{font-size:600;font-size:16px;color:#4575d6}@media(max-width:640px){.medication-item[data-v-01c693a3]{padding:12px}.medication-name[data-v-01c693a3]{font-size:15px}.details-text[data-v-01c693a3]{font-size:13px}.actions-col[data-v-01c693a3]{gap:8px}}#container[data-v-4de36202]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-4de36202]{font-size:20px;line-height:26px}#container p[data-v-4de36202]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-4de36202]{text-decoration:none}ion-item.medicalAl[data-v-4de36202]{--background: #fff;--border-radius: 5px}ion-button.medicalAlBtn[data-v-4de36202]{--background: #fecdca;--color: #b42318;text-transform:none}.error-label[data-v-4de36202]{background:#fecdca;color:#b42318;text-transform:none;padding:6%;border-radius:10px;margin-top:7px;display:flex;text-align:center}ion-button.addMedicalTpBtn[data-v-4de36202]{--background: #ddeedd;--color: #006401;text-transform:none;font-weight:600;font-size:16px}ion-button.medicalAlAddBtn[data-v-4de36202]{font-size:large}ion-icon.icon-al[data-v-4de36202]{font-size:x-large;margin-bottom:-5px}.item-al[data-v-4de36202]{cursor:pointer;padding:5px;background-color:#ebebeb;margin-top:8px}.item-al[data-v-4de36202]:hover{background-color:rgba(85,81,81,.282);padding:5px;border-radius:3px}ion-popover.popover-al[data-v-4de36202]{--background: #fff}ion-content.content-al[data-v-4de36202]{--background: #fff}ion-list.list-al[data-v-4de36202]{--background: #fff;-ion-item-background:#fff}.checkLbltp[data-v-4de36202]{border-bottom:2px dotted var(--ion-color-medium);--inner-border-width: 0}.tpStndCls[data-v-4de36202]{font-size:16px;font-weight:600;line-height:24px}.action_buttons[data-v-4de36202]{color:var(--ion-color-primary);display:flex;align-items:center;float:right}.action_buttons[data-v-4de36202]:hover{cursor:pointer}.spcls[data-v-4de36202]{display:flex;align-items:center}.previousView[data-v-4de36202]{width:100%;border-radius:10px;margin-top:10px}.previousLabel[data-v-4de36202]{font-weight:600;color:#000}.previousLabelDate[data-v-4de36202]{font-weight:600;color:#000;margin:2%}.previousSecDrgs[data-v-4de36202]{margin:2%}.notes_p[data-v-4de36202]{margin:4%}.custom-allergy-container[data-v-4de36202]{display:flex;align-items:center;gap:10px}.custom-input[data-v-4de36202]{max-width:300px;width:100%}.header-container[data-v-4de36202]{display:flex;align-items:center;gap:8px}.allergy-icon[data-v-4de36202]{font-size:24px;color:#b42318}.checklist-container[data-v-371e920f]{padding:16px}.no-border[data-v-371e920f]{--border-width: 0;--inner-border-width: 0}ion-item[data-v-371e920f]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:12px}ion-checkbox[data-v-371e920f]{margin-right:12px}ion-label[data-v-371e920f]{font-size:16px}.demographics[data-v-5d96ce77]{display:block;width:40vw;margin:50px auto 0;text-align:center}.demographics_title[data-v-5d96ce77]{font-weight:700;font-size:24px}.sub_title[data-v-5d96ce77]{font-weight:400;font-size:14px;color:#636363;margin:10px 0 30px;padding-top:20px;line-height:25px}.card_hearder[data-v-5d96ce77]{font-weight:600;color:#00190e;font-size:16px;padding-bottom:20px}.input_fields[data-v-5d96ce77]{padding:10px 100px 70px;text-align:left}.gender[data-v-5d96ce77]{display:flex;justify-content:space-between;max-width:170px;padding-top:10px}.gender_title[data-v-5d96ce77]{margin-top:30px}.marital_status[data-v-5d96ce77]{display:flex;justify-content:space-between}ion-datetime[data-v-5d96ce77]::part(calendar-day){padding:25px;margin:10px}.dp__flex_display[data-v-5d96ce77]{display:inherit}.enrollment_card[data-v-5d96ce77]{padding:20px;width:1200px}.card_content[data-v-5d96ce77]{width:100%}.sub_data[data-v-5d96ce77]{padding-top:10px;padding-bottom:5px;font-size:20px;font-weight:600;color:#00190e}.dates_title[data-v-5d96ce77]{color:gray;padding:20px;font-size:20px;font-weight:600}.calender[data-v-5d96ce77]{--dp-cell-padding: 30px;--dp-menu-padding: 20px 5px;--dp-font-size: 18px}.count-badge[data-v-5d96ce77]{padding:1px 4px;font-size:19px;margin-left:1px;position:relative;font-weight:700}.run-out-date[data-v-5d96ce77]{background-color:var(--dp-primary-color);border-radius:10%;color:#000;padding:7px}\n/*$vite$:1*/",document.head.appendChild(e);class Mt extends Y{constructor(){super()}async postActivities(t,e){const a=e.location_id,n=new G(parseInt(t),-1,a),i=await n.createEncounter();if(i){const t=await Y.buildLabOrders(i,e.orders||e);if(!(await Y.saveOrdersArray(i.encounter_id,t)))return X("Unable to save lab orders")}}}t("L",Mt);const Rt=t("_",a({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(t){this.userRole=J.getUserRoles();const e=J.getProgramID(),a=J.getProgramName();"Lab"==this.userRole&&14==e&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),14==e&&"Lab"!=this.userRole&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),12==e&&(this.userRoleSettings={url:"contact",btnName:"Back"}),"LABOUR AND DELIVERY PROGRAM"==a&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),"PNC PROGRAM"==a&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}})),Pt=["innerHTML"],Ft={class:"scrollable-container"},zt={key:0,class:"form-section"},Tt={key:1,class:"form-section"},Ht={key:2,class:"form-section"},Ut={key:3,class:"form-section"},Vt={key:4,class:"form-section"},$t={key:5,class:"form-section"},jt={key:6,class:"form-section"},qt={key:7,class:"form-section"},Wt=t("R",Q(a({__name:"RadiologyInvestigation",setup(t){const e=Et(),{head:a,neck:f,chest:b,abdomen:y,upper_extremity:x,spine:_,pelvis:D,lower_extremity:I}=n(e),w=i(K),S=i([]),A=(t,e,a)=>{document.querySelectorAll(`#${t} path`).forEach(t=>{t.classList.toggle("white-fill")}),document.querySelectorAll(`#${e} line`).forEach(t=>{t.classList.toggle("dark-green-stroke")}),document.querySelectorAll(`#${e} rect`).forEach(t=>{t.classList.toggle("bright-green-fill"),t.classList.toggle("dark-green-stroke")}),document.querySelectorAll(`#${e} path`).forEach(t=>{t.classList.toggle("dark-green-fill")}),document.querySelectorAll(`#${e} circle`).forEach(t=>{t.classList.toggle("bright-green-fill")});const n=S.value.findIndex(t=>t.id===a);n>=0?S.value.splice(n,1):S.value.unshift({id:a,active:!0})},k=()=>{const t=document.getElementById("SPINE");"none"===t.style.display||""==t.style.display?t.style.display="block":t.style.display="none",A("SPINE","SPINE_LABEL-2","spine")};return o(()=>{const t=document.getElementById("HEAD");t&&t.addEventListener("click",()=>{A("HEAD","LABEL-6","head")});const e=document.getElementById("NECK");e&&e.addEventListener("click",()=>{A("NECK","LABEL-5","neck")});const a=document.getElementById("CHEST");a&&a.addEventListener("click",()=>{A("CHEST","LABEL-4","chest")});const n=document.getElementById("ABDOMEN_LABEL");n&&n.addEventListener("click",()=>{const t=document.getElementById("ABDOMEN-2");"none"===t.style.display||""==t.style.display?t.style.display="block":t.style.display="none",A("ABDOMEN","ABDOMEN_LABEL-2","abdomen")});const i=document.getElementById("UPPER_EXTRMITY");i&&i.addEventListener("click",()=>{A("UPPER_EXTRMITY","LABEL-3","upper_extremity")});const o=document.getElementById("SPINE"),s=document.getElementById("SPINE_LABEL"),d=document.getElementById("LOWER_SPINE_INACTIVE");o&&o.addEventListener("click",()=>{k()}),s&&s.addEventListener("click",()=>{k()}),d&&d.addEventListener("click",()=>{k()});const l=document.getElementById("PELVIS");l&&l.addEventListener("click",()=>{A("PELVIS","LABEL-2","pelvis")});const r=document.getElementById("LOWER_EXTREMITY");r&&r.addEventListener("click",()=>{A("LOWER_EXTREMITY","LABEL","lower_extremity")})}),(t,e)=>{const n=s("ion-col"),i=s("ion-row");return l(),d(i,null,{default:r(()=>[c(n,{size:"7"},{default:r(()=>[p("div",{innerHTML:w.value.full_body_sk},null,8,Pt)]),_:1}),c(n,{size:"5",class:"form-column"},{default:r(()=>[p("div",Ft,[(l(!0),u(h,null,m(S.value,t=>(l(),u(h,null,["head"===t.id?(l(),u("div",zt,[e[0]||(e[0]=p("h6",null,"Body Part: Head",-1)),c(At,{contentData:v(a)},null,8,["contentData"])])):"neck"===t.id?(l(),u("div",Tt,[e[1]||(e[1]=p("h6",null,"Body Part: Neck",-1)),c(At,{contentData:v(f)},null,8,["contentData"])])):"chest"===t.id?(l(),u("div",Ht,[e[2]||(e[2]=p("h6",null,"Body Part: Chest",-1)),c(At,{contentData:v(b)},null,8,["contentData"])])):"abdomen"===t.id?(l(),u("div",Ut,[e[3]||(e[3]=p("h6",null,"Body Part: Abdomen",-1)),c(At,{contentData:v(y)},null,8,["contentData"])])):"upper_extremity"===t.id?(l(),u("div",Vt,[e[4]||(e[4]=p("h6",null,"Body Part: Upper Extremity",-1)),c(At,{contentData:v(x)},null,8,["contentData"])])):"spine"===t.id?(l(),u("div",$t,[e[5]||(e[5]=p("h6",null,"Body Part: Spine",-1)),c(At,{contentData:v(_)},null,8,["contentData"])])):"pelvis"===t.id?(l(),u("div",jt,[e[6]||(e[6]=p("h6",null,"Body Part: Pelvis",-1)),c(At,{contentData:v(D)},null,8,["contentData"])])):"lower_extremity"===t.id?(l(),u("div",qt,[e[7]||(e[7]=p("h6",null,"Body Part: Lower Extremity",-1)),c(At,{contentData:v(I)},null,8,["contentData"])])):g("",!0)],64))),256))])]),_:1})]),_:1})}}}),[["__scopeId","data-v-5ab54fe8"]])),Yt=a({name:"Menu",mixins:[Rt],components:{IonContent:A,IonHeader:S,IonItem:w,IonList:I,IonMenu:D,IonTitle:_,IonToolbar:x,IonInput:y,IonPopover:b,DashBox:St,SelectionPopover:at,BasicInputField:et,BasicForm:At,List:tt,DynamicButton:Z,LabOrdersList:kt,RadiologyInvestigation:Wt},data:()=>({segmentContent:"Lab Investigations",iconsContent:K,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}),setup:()=>({checkmark:L,pulseOutline:k}),computed:{...f(st,["investigations"]),...f(lt,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){var t;null!==(t=this.patient)&&void 0!==t&&t.labOrders&&(this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved])},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{setSegmentContent(t){this.segmentContent=t},async getTests(){let t;t=J.getPouchDbStatus()&&J.getLanConnectionStatus()?await it("test_types"):await Y.getTestTypes(),nt(this.investigations,"test","multiSelectData",t)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){var t;if(null===(t=this.patient)||void 0===t||!t.labOrders)return;this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const e=await this.labOrders.filter(t=>dt.toStandardHisFormat(dt.sessionDate())===dt.toStandardHisFormat(t.order_date));e.length>0?this.investigations[0].selectedData=e:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard(),st().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return Lt(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(nt(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(nt(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){Lt(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard()},isNameInData(t,e){for(let a of e)for(let e of a.tests)if(e.name===t)return!0;return!1},async saveTest(){const t=new Mt;await t.postActivities(this.patient.patientID,[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await ot.getConceptID(this.inputFields[1].value.name,!0)}]),nt(this.investigations,"specimen","disabled",!0),this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},async handleInputData(t){if("Test"==t.inputHeader&&this.checkTest(),nt(this.investigations,"specimen","alertsErrorMassage",""),"Test"==t.inputHeader&&t.value){let e;e=J.getPouchDbStatus()&&J.getLanConnectionStatus()?await it("specimens"):await Y.getSpecimens("",1e3),this.specimen=await ot.getConceptSet(t.value.name,"",{names:e.map(t=>t.name)}),1==this.specimen.length?(nt(this.investigations,"specimen","value",this.specimen[0]),nt(this.investigations,"specimen","disabled",!0)):(nt(this.investigations,"specimen","value",""),nt(this.investigations,"specimen","disabled",!1)),nt(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(t){return await this.labOrders.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))},async filterSpecimen(t){var e;return null!==(e=this.specimen[0])&&void 0!==e&&e.name&&t?await this.specimen.filter(e=>null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())):[]},setTest(t){this.selectedText=t.name,"Test"==this.inputFields[1].inputHeader?this.investigations[0].data.rowData[0].colData[0].value=t.name:this.investigations[0].data.rowData[0].colData[1].value=t.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),Gt={class:"background"},Xt={key:0},Jt={key:1},Kt={key:2},Qt={class:"",slot:"content",style:{"margin-bottom":"125px","margin-top":"2px"}},Zt={key:3},te={class:"ion-padding",slot:"content"},ee={key:4};t("I",Q(Yt,[["render",function(t,e,a,n,i,o){const d=s("ion-label"),m=s("ion-segment-button"),h=s("ion-segment"),v=s("VisitsHistory"),f=s("LabOrdersList"),b=s("RadiologyInvestigation");return l(),u("div",Gt,[c(h,{value:t.segmentContent,style:{"margin-top":"5px"}},{default:r(()=>[c(m,{value:"Lab Investigations",onClick:e[0]||(e[0]=e=>t.setSegmentContent("Lab Investigations"))},{default:r(()=>[c(d,null,{default:r(()=>[...e[3]||(e[3]=[E("Lab Investigations",-1)])]),_:1})]),_:1}),c(m,{value:"Radiology Investigation",onClick:e[1]||(e[1]=e=>t.setSegmentContent("Radiology Investigation"))},{default:r(()=>[c(d,null,{default:r(()=>[...e[4]||(e[4]=[E("Radiology Investigation",-1)])]),_:1})]),_:1}),c(m,{value:"Other Investigation",onClick:e[2]||(e[2]=e=>t.setSegmentContent("Other Investigation"))},{default:r(()=>[c(d,null,{default:r(()=>[...e[5]||(e[5]=[E("Other Investigation",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),"Radiology Investigation"==t.segmentContent?(l(),u("div",Xt,[c(v)])):g("",!0),"Other Investigation"==t.segmentContent?(l(),u("div",Jt)):g("",!0),"Lab Investigations"==t.segmentContent?(l(),u("div",Kt,[p("div",Qt,[p("span",null,[c(f,{propOrders:t.labOrders},null,8,["propOrders"])])])])):g("",!0),"Radiology Investigation"==t.segmentContent?(l(),u("div",Zt,[p("div",te,[c(b)])])):g("",!0),"Other Investigation"==t.segmentContent?(l(),u("div",ee)):g("",!0)])}],["__scopeId","data-v-0803dcda"]]));const ae=a({created(){},components:{IonItem:w,IonCol:O,IonLabel:B,IonIcon:C},data(){return{iconsContent:K,localMedicalDrugsList:[...this.$props._selectedMedicalDrugsList]}},props:{_selectedMedicalDrugsList:{type:Array,default:[]},show_actions_buttons:{type:Boolean,default:!0},highLightBackground:{type:String,default:"item-native"}},watch:{},methods:{highlightItem(t){const e=document.getElementById(t+"_lbl");e&&(e.style.color="#006401"),this.highlightActionBtns(t)},undoHighlightItem(t){const e=document.getElementById(t+"_lbl");e&&(e.style.color="#636363"),this.undohighlightActionBtns(t)},highlightActionBtns(t){const e=document.getElementsByClassName(t+"_spanlbl");for(let a=0;a<e.length;a++)e[a].style.display="inline-block"},undohighlightActionBtns(t){const e=document.getElementsByClassName(t+"_spanlbl");for(let a=0;a<e.length;a++)e[a].style.display="none"},asignLblID:t=>t+"_lbl",asignSpanLblID:t=>t+"_spanlbl",async removeItemAtIndex(t,e){await rt("Do you want to delete it?",e)&&this.$emit("remove-item",t)},editItemAtIndex(t){this.$emit("edit-item",t)},highLightBnd(t){return!!t&&(void 0!==t.highlightbackground&&1==t.highlightbackground?this.$props.highLightBackground:void 0)}}}),ne=["onMousemove","onMouseout"],ie={class:"route-label"};t("D",Q(ae,[["render",function(t,e,a,n,i,o){const v=s("ion-label"),f=s("ion-col"),b=s("ion-row"),y=s("ion-icon");return l(!0),u(h,null,m(t.localMedicalDrugsList,(e,a)=>(l(),u("div",{id:"df",class:"medication-item",key:a,onMousemove:e=>t.highlightItem(a),onMouseout:e=>t.undoHighlightItem(a)},[c(b,{class:"medication-header"},{default:r(()=>[c(f,{class:N(["ion-text-wrap",t.highLightBnd(e)])},{default:r(()=>[c(v,{id:t.asignLblID(a),class:"medication-name"},{default:r(()=>[E(M(e.drugName),1)]),_:2},1032,["id"])]),_:2},1032,["class"])]),_:2},1024),c(b,{class:"medication-details"},{default:r(()=>[c(f,{size:"10",class:N(["ion-text-wrap details-col",t.highLightBnd(e)])},{default:r(()=>[c(v,{class:"details-text"},{default:r(()=>[E(M(e.dose)+" / "+M(e.frequency)+" / daily / "+M(e.duration)+" / until "+M(e.prescription)+" ",1),p("span",ie,M(e.route_name),1)]),_:2},1024)]),_:2},1032,["class"]),t.show_actions_buttons?(l(),d(f,{key:0,class:N([t.highLightBnd(e),"actions-col"]),size:"2"},{default:r(()=>[c(v,{class:N(["action-button",t.asignSpanLblID(a)]),onClick:e=>t.editItemAtIndex(a)},{default:r(()=>[c(y,{icon:t.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),c(v,{class:N(["action-button",t.asignSpanLblID(a)]),onClick:e=>t.removeItemAtIndex(a,e)},{default:r(()=>[c(y,{icon:t.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1032,["class"])):g("",!0)]),_:2},1024)],40,ne))),128)}],["__scopeId","data-v-01c693a3"]]));const oe={key:0,class:"custom-allergy-container"},se={class:"button-group"},de=a({watch:{},name:"AllergiesComponent"}),le=a({...de,setup(t){const e=ct(),a=lt(),n=R(()=>e.selectedMedicalAllergiesList),s=R(()=>a.patient),m=R(()=>e.medicalAllergiesList),h=i(w(8,"item-")),f=i(""),b=i(!1),x=[{multi_Selection:!0,show_list_label:!0,unqueId:h.value,name_of_list:"Add/Remove allergies",placeHolder:"Search for an allergy",items:[],listUpdatedFN:function(t){t.forEach(t=>{1==t.selected&&"Other"===t.name&&(b.value="Other"===t.name),0==t.selected&&"Other"===t.name&&S()}),e.setSelectedMedicalAllergiesList(t),I()},listFilteredFN:()=>{},searchTextFN:async function(t){const a=t,n=await ot.getConceptSet("OPD Medication",a);n.map(t=>({label:t.name,value:t.name,other:t}));const i=pt(a),o=ut(i,n).sort((t,e)=>t.name.localeCompare(e.name));e.setMedicalAllergiesList(o),I()},use_internal_filter:!0,show_error:i(!1),error_message:"please select a User",disabled:i(!1)}],_=i(!1);o(async()=>{D()});const D=()=>{e.current_patient.ID!=s.value.ID&&(e.clearSelectedMedicalAllergiesList(),e.setCurrentPatient(s.value))};function I(){const t=m.value;n.value.forEach(e=>{let a=!1;t.forEach((n,i)=>{n.concept_id==e.concept_id&&!0===e.selected&&(t[i]=e,a=!0)}),a||!0!==e.selected||t.push(e)});const a=t.filter((t,e,a)=>e===a.findIndex(e=>(null==e?void 0:e.concept_id)===(null==t?void 0:t.concept_id)));e.setMedicalAllergiesList(a)}function w(t=8,e=""){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n=e;for(let i=0;i<t;i++)n+=a.charAt(Math.floor(62*Math.random()));return n+=`-${Date.now()}`,n}const S=()=>{b.value=!1,f.value="",_.value=!1;const t=e.findSelectedAllergyByName("Other");t&&e.unselectOther(t)};return(t,a)=>(l(),d(v(P),null,{default:r(()=>[c(v(F),null,{default:r(()=>[c(v(B),{class:"header-container"},{default:r(()=>[c(v(C),{icon:v(z),class:"allergy-icon"},null,8,["icon"]),a[3]||(a[3]=p("span",{style:{"font-size":"16px","font-weight":"600"}}," Allergies (Medication, Healthcare items, Environment and Food) ",-1))]),_:1})]),_:1}),c(v(T),null,{default:r(()=>[c(mt,{multiSelection:x[0].multi_Selection,show_label:x[0].show_list_label,uniqueId:x[0].unqueId,name_of_list:x[0].name_of_list,choose_place_holder:x[0].placeHolder,"items_-list":m.value,use_internal_filter:x[0].use_internal_filter,disabled:x[0].disabled.value,onItemListUpDated:x[0].listUpdatedFN,onItemListFiltered:x[0].listFilteredFN,onItemSearchText:x[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),b.value?(l(),u("div",oe,[c(v(y),{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=t=>f.value=t),placeholder:"Please specify the allergy",fill:"outline",class:"custom-input"},null,8,["modelValue"]),p("div",se,[c(v(H),{onClick:a[1]||(a[1]=t=>async function(t){try{const a=t.trim();if(a){const t={name:a,selected:!0,concept_id:w(8,"12"),concept_name_id:w(8,"34")};e.setMedicalAllergiesList([...m.value,t]),e.setSelectedMedicalAllergiesList(t),b.value=!1,_.value=!0,f.value="";const n=e.findSelectedAllergyByName("Other");e.unselectOther(n)}}catch(a){console.error(a)}}(f.value)),class:"addCustomAllergyBtn"},{default:r(()=>[...a[4]||(a[4]=[E(" Add Allergy ",-1)])]),_:1}),c(v(H),{onClick:a[2]||(a[2]=t=>S()),fill:"clear",class:"cancelBtn"},{default:r(()=>[c(v(C),{icon:v(U),slot:"icon-only"},null,8,["icon"])]),_:1})])])):g("",!0)]),_:1})]),_:1}))}}),re=(t("A",Q(le,[["__scopeId","data-v-4de36202"]])),{class:"checklist-container"}),ce=a({watch:{},name:"xxxComponent"}),pe=a({...ce,setup(t){const e=lt(),a=R(()=>e.patient),n=Ct(),i=n.items;o(async()=>{s()});const s=()=>{n.current_patient.ID!=a.value.ID&&(n.clearSelectednonPharmaTherapyStore(),n.setCurrentPatient(a.value))};return V(()=>a.value,async t=>{}),(t,e)=>(l(),u("div",re,[(l(!0),u(h,null,m(v(i),t=>(l(),d(v(w),{key:t.id,class:"no-border"},{default:r(()=>[c(v($),{id:t.id,modelValue:t.checked,"onUpdate:modelValue":e=>t.checked=e,slot:"start"},null,8,["id","modelValue","onUpdate:modelValue"]),c(v(B),{style:{"font-size":"16px","font-weight":"600"}},{default:r(()=>[E(M(t.label),1)]),_:2},1024)]),_:2},1024))),128))]))}}),ue=(t("a",Q(pe,[["__scopeId","data-v-371e920f"]])),a({components:{IonContent:A,IonHeader:S,IonItem:w,IonList:I,IonMenu:D,IonTitle:_,IonToolbar:x,BasicInputField:et,IonDatetime:q,IonBadge:j,DateInputField:Nt,DynamicButton:Z},props:{showPeripheral:{type:Boolean,default:!0}},setup(t){const e=xt(),a=i(0),n=R(()=>e.getDisabledDates()),o=R(()=>e.getAssignedAppointments()),s=i(),d=R(()=>t.showPeripheral);return{disabledDates:n,datesCounts:o,appointment_count:a,calendarOutline:W,inputPRDate:s,show_peripheral:d}},data:()=>(ht(),wt(),{iconsContent:K,date:new Date(J.getSessionDate()),tomorrow:new Date(J.getSessionDate()).getDate()+1,appointment:"",drugRunoutDate:"",nextAppointmentDate:"",minDate:new Date(J.getSessionDate())}),computed:{...f(ht,["nextAppointment","appointmentCountsCache","currentSelectedNextAppointmentDate"]),...f(xt,["maximumNumberOfDaysForEachDay","assignedAppointmentsDates"]),...f(lt,["patient"]),...f(wt,["activeProgram"]),calendarDate(){const t=ht();return t.currentSelectedNextAppointmentDate?dt.toStandardHisDisplayFormat(t.currentSelectedNextAppointmentDate):""},runOutDate(){var t;const e=ht();return 14===(null===(t=this.activeProgram)||void 0===t?void 0:t.program_id)?Bt():e.getAppointmentMedicationRunOutDate()}},watch:{calendarDate:{handler(){this.updateNextAppointment()},deep:!0},"$service.sessionDate":{handler(){this.updateMinDate()},immediate:!0},"patient.ID":{async handler(t,e){t!==e&&(this.cleanCurrentNextAppointmentDate(),this.checkIfSamePatientInContext(),this.clearNextAppointment())}}},async mounted(){this.checkIfSamePatientInContext(),await this.getAppointmentMents(this.runOutDate.date),await _t().loadGlobalProperty(),this.validateAppointmentCountsCache(),await this.preloadAppointmentCounts(),Dt();const t=J.getUserID(),e=new It;this.appointment=new gt(e.getID(),t),this.nextAppointmentDate=this.appointment.date,this.supposedRunOutDate(),window.addEventListener("storage",this.handleStorageChange),Bt()},beforeUnmount(){window.removeEventListener("storage",this.handleStorageChange)},methods:{handleStorageChange(t){"sessionDate"===t.key&&this.updateMinDate()},updateMinDate(){this.date=new Date(J.getSessionDate()),this.minDate=new Date(J.getSessionDate())},updateNextAppointment(){ht().setNextAppointment(this.calendarDate)},async handleDateUpdate(t){t&&(xt().setAssignedAppointmentsDates(t,!0),this.calendarDate=dt.toStandardHisDisplayFormat(t),await this.save(),await this.getAppointmentMents(t),await this.updateAppointmentCache(t),ht().setCurrentSelectedNextAppointmentDate(t,this.patient.ID))},async getAppointmentMents(t){if(yt().apiStatus)try{const e=await gt.getDailyAppointments(dt.toStandardHisFormat(t),dt.toStandardHisFormat(t));this.appointment_count=e.length}catch(e){}},getCounter(t){const e=dt.toStandardHisFormat(t);return this.appointmentCountsCache[e]||""},async save(){if(this.assignedAppointmentsDates.length>0)try{const t=new Ot;await t.createOfflineAppointment()}catch(t){}},async openCornfirmModal(t){this.calendarDate=dt.toStandardHisDisplayFormat(t),await this.getAppointmentMents(t),ft(bt,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Appointment?"},{cancel:t=>{},confirm:async e=>{1==e.detail&&await this.handleDateUpdate(t)}})},async handleInput(t){this.inputPRDate=dt.toStandardHisDisplayFormat(t),await this.openCornfirmModal(t)},async supposedRunOutDate(){await vt.getLastDrugsReceived(this.patient.patientID)},async preloadAppointmentCounts(){try{const e=new Date(J.getSessionDate());e.setDate(1);const a=new Date(J.getSessionDate());a.setMonth(a.getMonth()+2),a.setDate(0);try{const t=await gt.getDailyAppointments(dt.toStandardHisFormat(e),dt.toStandardHisFormat(a)),n=this.filterUniqueAppointments(t),i={};n.forEach(t=>{const e=new Date(t.appointment_date),a=dt.toStandardHisFormat(e);i[a]||(i[a]=0),i[a]++}),Object.keys(i).forEach(t=>{this.appointmentCountsCache[t]=i[t]})}catch(t){console.error("Error fetching appointments for date range:",t)}}catch(t){console.error("Error in preload process:",t)}},filterUniqueAppointments(t){const e=new Map;return t.forEach(t=>{const a=`${t.given_name}_${t.family_name}_${t.birthdate}_${t.appointment_date}`;e.has(a)||e.set(a,t)}),Array.from(e.values())},async updateAppointmentCache(t){try{const e=dt.toStandardHisFormat(t),a=await gt.getDailyAppointments(dt.toStandardHisFormat(t),dt.toStandardHisFormat(t));this.appointmentCountsCache[e]=a.length}catch(e){console.error("Error updating appointment cache:",e)}},validateAppointmentCountsCache(){ht().checkCurrentLocationIfInContext()},isRunOutDate(t){return!(!this.runOutDate||!this.runOutDate.date)&&dt.toStandardHisFormat(t)===dt.toStandardHisFormat(this.runOutDate.date)},cleanCurrentNextAppointmentDate(){ht().cleanCurrentSelectedNextAppointmentDate()},checkIfSamePatientInContext(){const t=ht();t.current_patient.ID!=this.patient.ID&&(this.cleanCurrentNextAppointmentDate(),t.setCurrentPatient(this.patient))},clearNextAppointment(){ht().clearAppointmentMedicationRunOutDate()}}})),me={class:"card_content"},he={class:"count-badge"},ge={class:"dates_title"},ve={class:"sub_data"},fe={class:"dates_title"},be={class:"sub_data"},ye={class:"dates_title"},xe={class:"sub_data"},_e={class:"dates_title"},De={class:"sub_data"};t("N",Q(ue,[["render",function(t,e,a,n,i,o){const m=s("VueDatePicker"),h=s("ion-col"),v=s("DynamicButton"),f=s("ion-item"),b=s("ion-row"),y=s("DateInputField");return l(),u("div",me,[c(b,null,{default:r(()=>[c(h,{"size-sm":"12","size-md":"12","size-lg":"12","size-xl":"8"},{default:r(()=>[c(m,{class:"calender",onDateUpdate:t.openCornfirmModal,inline:"","auto-apply":"","enable-time-picker":!1,"disabled-dates":t.disabledDates,"min-date":t.minDate,modelValue:t.runOutDate.date,"onUpdate:modelValue":e[0]||(e[0]=e=>t.runOutDate.date=e)},{day:r(({day:e,date:a})=>[(l(),u("p",{key:0,class:N({"run-out-date":t.isRunOutDate(a)}),style:{"font-weight":"600","font-size":"20px"}},[p("span",null,[E(M(e),1),p("sup",he,M(t.getCounter(a)),1)])],2))]),_:1},8,["onDateUpdate","disabled-dates","min-date","modelValue"])]),_:1}),t.show_peripheral?(l(),d(h,{key:0},{default:r(()=>[c(f,null,{default:r(()=>[p("div",ge,[e[3]||(e[3]=p("div",null,[E("Suggested Next Appointment Date "),p("span",{style:{"font-size":"16px"}},"(Medication run out date)")],-1)),p("div",ve,[E(M(t.runOutDate.formattedDate||"No run out date available")+" ",1),t.runOutDate.formattedDate?(l(),d(v,{key:0,onClick:e[1]||(e[1]=e=>t.handleDateUpdate(t.runOutDate.date)),name:"Set Next Appt.",fill:"solid",iconSlot:"icon-only",style:{float:"right"}})):g("",!0)])])]),_:1}),c(f,null,{default:r(()=>[p("div",fe,[e[4]||(e[4]=p("div",null,"User set appointment date",-1)),p("div",be,M(t.calendarDate),1)])]),_:1}),c(f,null,{default:r(()=>[p("div",ye,[e[5]||(e[5]=p("div",null,"Appointments",-1)),p("div",xe,M(t.appointment_count),1)])]),_:1}),c(f,null,{default:r(()=>[p("div",_e,[e[6]||(e[6]=p("div",null,"Appointment limit (per/day)",-1)),p("div",De,M(t.appointment_count)+"/"+M(t.maximumNumberOfDaysForEachDay),1)])]),_:1})]),_:1})):g("",!0)]),_:1}),t.show_peripheral?(l(),d(b,{key:0},{default:r(()=>[c(h,{size:"4"},{default:r(()=>[c(y,{inputHeader:"Preferred Next Appointment Date",bold:"600",fontSize:"17px",placeholderFontSize:"17px",placeholderFontWeight:"600",unit:"",icon:t.calendarOutline,placeholder:"press to select date",iconRight:"",inputWidth:"100%",inputValue:t.inputPRDate,eventType:"",minDate:t.minDate,maxDate:"",disabled:!1,"onUpdate:rawDateValue":e[2]||(e[2]=e=>t.handleInput(e))},null,8,["icon","inputValue","minDate"])]),_:1})]),_:1})):g("",!0)])}],["__scopeId","data-v-5d96ce77"]]))}}});
