import{cg as p,ck as _,ch as D,aF as u,aE as b}from"../index-gGhCNNm-.js";import{T as E,c as F}from"./tx_report_service-R7N_RYlG.js";import{d as O,r as d,O as v,f as A}from"./vendor-DoZkSJso.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BgIpHCiE.js";import"./age_groups-BkW1n_F5.js";const k=O({__name:"TxTB",setup(B){const s=d("-"),c=d([]),a=new E,w=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:p},..._(F)];function m(e){const t={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return Object.entries(e).forEach(([r,o])=>{r!=="Unknown"&&Object.entries(o).forEach(([R,g])=>{const n=R;t[n].rows.push({ageGroup:r,gender:n,...g}),Object.entries(g).forEach(([l,T])=>{var i;t[n].aggregate[l]=[...(i=t[n].aggregate[l])!=null?i:[],...T]})})}),t}async function f(e,t){try{await u.show(),a.setStartDate(e.dateRange.startDate),a.setEndDate(e.dateRange.endDate),a.setOccupation(e.occupation),s.value=a.getDateIntervalPeriod();const r=await a.getTxTbReport(t),o=m(r);c.value=[...o.F.rows,...o.M.rows,{ageGroup:"All",gender:"Male",...o.M.aggregate},...await a.buildMaternityAgreggateRows(o.F.aggregate)]}catch(r){b("ERROR! Unable to load report data"),console.error(r)}await u.hide()}function h(e){return"".concat(e.column.label," | ").concat(e.row.ageGroup," | ").concat(p(e.row.gender),"s")}return(e,t)=>(A(),v(D,{title:"PEPFAR TX TB Report","report-type":"PEPFAR",columns:w,rows:c.value,period:s.value,"drill-title":h,useDateRangeFilter:"",showIndices:"",onGenerate:f},null,8,["rows","period"]))}});export{k as default};
