import{d as F,aW as W,cp as P,r as i,w as _,a as A,b7 as w,cW as C,e as f,f as g,l as N,J,k as D,F as K,P as L,K as j,u as q}from"./vendor-9T3c-tPq.js";import{u as z,af as G,H as h,bb as Q,_ as U}from"../index-rnlHD_bJ.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-qlDaiiMc.js";const X={class:"table-responsive"},Y=F({__name:"VitalsMeasurementsSummary",setup(Z){const S=z(),{patient:n}=W(S),I=P(),B=i(null),c=i([]),y=i(""),M=i(["Date","Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic","BMI"]),T=i({responsive:!0,select:!1,layout:{topStart:"",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1}),p=async()=>{try{c.value=[];const r=(await G.getObsByEncounterId(6)).flatMap(e=>e.obs||[]),t=new Map;r.forEach(e=>{var a;if(e.obs_datetime){const s=e.obs_datetime.split(" ")[0];t.has(s)||t.set(s,[]),(a=t.get(s))==null||a.push(e)}});for(const[e,a]of t.entries())await E(e,a);c.value.sort((e,a)=>new Date(a[0]).getTime()-new Date(e[0]).getTime())}catch(o){console.error("Error updating vitals data:",o)}},E=async(o,r)=>{const t=H=>{var v;const m=r.find(R=>R.concept_name===H);return(v=m==null?void 0:m.value_numeric)!=null?v:""},e=t("Weight (kg)"),a=t("Height (cm)"),s=t("Temperature (c)"),l=t("Pulse"),u=t("Blood oxygen saturation"),d=t("Systolic blood pressure"),k=t("Respiratory rate"),x=t("Diastolic blood pressure");let b="";e&&a&&(b=await V(e,a));const O=[h.toStandardHisDisplayFormat(o),e,a,s,l,u,d,k,x,b];c.value.push(O)},V=async(o,r)=>{var t,e,a,s,l,u;if((e=(t=n.value)==null?void 0:t.personInformation)!=null&&e.gender&&((s=(a=n.value)==null?void 0:a.personInformation)!=null&&s.birthdate))try{return y.value=await Q.getBMI(parseInt(String(o)),parseInt(String(r)),n.value.personInformation.gender,h.calculateAge(n.value.personInformation.birthdate,h.sessionDate())),(u=(l=y.value)==null?void 0:l.index)!=null?u:""}catch(d){return console.error("Error calculating BMI:",d),""}return""};return _(()=>I.path,async()=>{await p()},{deep:!0}),_(n,async()=>{await p()},{deep:!0}),A(async()=>{await p(),w.use(C)}),(o,r)=>(g(),f("div",X,[N(q(w),{ref_key:"dataTable",ref:B,options:T.value,data:c.value,class:"display nowrap modern-table",width:"100%"},{default:J(()=>[D("thead",null,[D("tr",null,[(g(!0),f(K,null,L(M.value,t=>(g(),f("th",{key:t},j(t),1))),128))])])]),_:1},8,["options","data"])]))}}),st=U(Y,[["__scopeId","data-v-744fc55d"]]);export{st as default};
