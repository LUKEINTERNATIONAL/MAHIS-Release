import{cr as D,r as h,b2 as m,w as P}from"./vendor-BTebhqHt.js";import{e as _,S as w,U as O}from"../index-DBQF-8Xn.js";function R(){const f=D(),a=_(),c=h(!1),{OPDActivities:o,NCDActivities:l,ARTActivities:u,OPDWaitingLists:v}=m(a),r=async t=>{try{const e=w.getUserID();if(!e)return console.warn("User ID not available for property: ".concat(t)),[];const s=await O.getJson("user_properties",{user_id:e,property:t});return s!=null&&s.property_value?s.property_value.split(",").map(i=>i.trim()).filter(i=>i.length>0):[]}catch(e){return console.error("Error fetching user data for property '".concat(t,"':"),e),[]}},g=async t=>r(t),n=async()=>{try{c.value=!1;const[t,e,s,i]=await Promise.all([r("OPD_activities"),r("NCD_activities"),r("ART_Admin_assigned_activities"),r("OPD_waiting_list")]);t.length>0&&a.setOPDActivity(t),e.length>0&&a.setNCDActivity(e),s.length>0&&a.setARTActivity(s),i.length>0?a.setOPDWaitingLists(i):console.warn("Offline or empty API response â€” keeping cached OPDWaitingLists")}catch(t){console.error("Error updating activities and waiting lists:",t)}finally{c.value=!0}},A=async()=>n(),p=t=>v.value.includes(t),d=(t,e="OPD")=>{var i;return((i={OPD:o.value,NCD:l.value,ART:u.value}[e])==null?void 0:i.includes(t))||!1},y=async()=>{await n()};return P(()=>f,async()=>{await n()},{immediate:!0,deep:!0}),{ready:c,OPDActivities:o,NCDActivities:l,ARTActivities:u,OPDWaitingLists:v,getUserData:r,getUserActivities:g,updateActivitiesAndWaitingLists:n,updateActivities:A,hasWaitingList:p,hasActivity:d,refreshUserData:y}}export{R as u};
