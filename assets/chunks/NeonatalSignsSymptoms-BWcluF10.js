import{D as T,d as D,r as h,eT as V,w as d,e as w,f as F,l as S,u as v,a3 as k,a6 as z,ao as $,aV as A,eU as j,H as g,O as J,J as N}from"./vendor-hvlGrBh_.js";import{aC as b,_ as y,T as B,u as H,t as C,H as U,G as K}from"../index-rqBQVC3E.js";import{N as E}from"./neonatal_service-BraZwFaC.js";import{D as W}from"./DemographicBar-BYOXv5lM.js";import{g as G,h as p,i as I,N as q}from"./NeonatalStepper-Bor2kG1e.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-BtPTSgal.js";import"./SaveProgressModal-BSlCW3to.js";import"./images-DJIykHYW.js";import"./enrollment-DU-PLRUa.js";const _=()=>JSON.parse(JSON.stringify(G)),x=T("neonatalSignsSymptomsStore",{state:()=>({activePatientId:null,formData:_(),formCache:{}}),actions:{initializeForPatient(s){if(s==null){this.activePatientId=null,Object.assign(this.formData,_());return}this.activePatientId=s;const l=String(s),t=this.formCache[l];t?Object.assign(this.formData,t):Object.assign(this.formData,_()),this.saveSnapshot()},saveSnapshot(){if(this.activePatientId==null)return;const s=String(this.activePatientId);this.formCache[s]=JSON.parse(JSON.stringify(this.formData))},resetActiveForm(){Object.assign(this.formData,_()),this.saveSnapshot()},clearPatient(s){delete this.formCache[String(s)],this.activePatientId===s&&this.resetActiveForm()}},persist:{paths:["activePatientId","formData","formCache"]}}),L={class:"signs-symptoms-section-wrapper"},M=D({__name:"AdmissionSection",setup(s,{expose:l}){const t=h(null),r=p[0],u=r.formData,m=r.conditionalRules||[],i=V(I),c=e=>{i&&(i.is_readmission=e.is_readmission||"")};return d(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&c(e)},{deep:!0}),d(()=>t.value,e=>{e!=null&&e.getFormValues&&c(e.getFormValues())},{immediate:!0}),l({getFormRef:()=>t.value,validateForm:()=>{var e,o;return((o=(e=t.value)==null?void 0:e.validateForm)==null?void 0:o.call(e))||null},getFormValues:()=>{var e,o;return((o=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:o.call(e))||{}}}),(e,o)=>(F(),w("div",L,[S(b,{formData:v(u),conditionalRules:v(m),ref_key:"formRef",ref:t},null,8,["formData","conditionalRules"])]))}}),P=y(M,[["__scopeId","data-v-312c3ac7"]]),Q={class:"signs-symptoms-section-wrapper"},X=D({__name:"PresentingComplaintsSection",setup(s,{expose:l}){const t=h(null),r=p[1],u=r.formData,m=r.conditionalRules||[],i=V(I),c=e=>{i&&(i.presenting_complaints=e.presenting_complaints||[])};return d(()=>{var e;return(e=t.value)==null?void 0:e.formValues},e=>{e&&c(e)},{deep:!0}),d(()=>t.value,e=>{e!=null&&e.getFormValues&&c(e.getFormValues())},{immediate:!0}),l({getFormRef:()=>t.value,validateForm:()=>{var e,o;return((o=(e=t.value)==null?void 0:e.validateForm)==null?void 0:o.call(e))||null},getFormValues:()=>{var e,o;return((o=(e=t.value)==null?void 0:e.getFormValues)==null?void 0:o.call(e))||{}}}),(e,o)=>(F(),w("div",Q,[S(b,{formData:v(u),conditionalRules:v(m),ref_key:"formRef",ref:t},null,8,["formData","conditionalRules"])]))}}),R=y(X,[["__scopeId","data-v-2ad14f66"]]),Y=D({name:"NeonatalSignsSymptoms",components:{IonPage:z,IonContent:k,Toolbar:B,DemographicBar:W,NeonatalStepper:q,AdmissionSection:P,PresentingComplaintsSection:R},setup(){const s=$(),l=H(),{patient:t}=A(l),r=x(),u=n=>{const a=Number(n);return Number.isFinite(a)?a:null},m=()=>{var a;const n=u((a=t.value)==null?void 0:a.patientID);r.initializeForPatient(n)};m(),d(()=>{var n;return(n=t.value)==null?void 0:n.patientID},()=>m());const i=r.formData;j(I,i),d(()=>r.formData,()=>r.saveSnapshot(),{deep:!0});const c=h(p.map((n,a)=>({title:n.title,number:a+1,checked:!1,class:a===0?"open_step common_step":"common_step",last_step:a===p.length-1?"last_step":""}))),e=[{title:p[0].title,value:"1",component:P,configIndex:0},{title:p[1].title,value:"2",component:R,configIndex:1}],o="Signs & Symptoms Assessment",O=h("1");return{wizardData:c,stepperData:e,stepperTitle:o,currentOpenStepper:O,updateStatus:n=>{n&&n.value&&c.value.forEach((a,f)=>{n.value===(f+1).toString()?(a.class="open_step common_step",a.checked=!1):f<parseInt(n.value)-1?(a.class="common_step color_white",a.checked=!0):(a.class="common_step",a.checked=!1)})},getSaveFunction:n=>n===e.length-1?async()=>{var a;if(!((a=t.value)!=null&&a.patientID)){C("No patient selected");return}try{const f=U.sessionDate();await E.saveSignsSymptomsAssessment(t.value.patientID,i,f),K("Signs & symptoms assessment saved successfully"),r.clearPatient(t.value.patientID),s.push({path:"/neonatal/review-of-systems"})}catch(f){console.error("Failed to save signs/symptoms assessment",f),C("Failed to save signs/symptoms assessment")}}:null,neonatalSignsSymptomsSections:p}}});function Z(s,l,t,r,u,m){const i=g("Toolbar"),c=g("NeonatalStepper"),e=g("ion-content"),o=g("ion-page");return F(),J(o,{class:"neonatal-signs-symptoms-page"},{default:N(()=>[S(i),S(e,{fullscreen:!0},{default:N(()=>[S(c,{wizardData:s.wizardData,StepperData:s.stepperData,stepperTitle:s.stepperTitle,openStepper:s.currentOpenStepper,backUrl:"/NeonatalHome",getSaveFunction:s.getSaveFunction,flowType:"signsSymptoms",sectionsConfig:s.neonatalSignsSymptomsSections,onUpdateStatus:s.updateStatus},null,8,["wizardData","StepperData","stepperTitle","openStepper","getSaveFunction","sectionsConfig","onUpdateStatus"])]),_:1})]),_:1})}const ue=y(Y,[["render",Z],["__scopeId","data-v-317f5999"]]);export{ue as default};
