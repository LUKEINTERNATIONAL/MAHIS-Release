System.register(["./vendor-legacy-Bsps4SCm.js","../index-legacy-DmY7Iugt.js","./patient_diagnosis_service-legacy-DIIc8Z9c.js","./DashBox-legacy-2Cjvk8SJ.js","./lodash-legacy-pOOc9Efu.js"],function(e,a){"use strict";var i,t,n,o,s,l,d,r,c,u,p,g,v,m,h,f,y,D,_,b,x,I,w,k,S,C,B,F,M,T,H,P,A,E,O,j,L,G,N,$,z,W,V,J,Q,R;return{setters:[e=>{i=e.d,t=e.ah,n=e.G,o=e.E,s=e.ai,l=e.aj,d=e._,r=e.I,c=e.a3,u=e.R,p=e.bf,g=e.aT,v=e.H,m=e.e,h=e.f,f=e.k,y=e.l,D=e.r,_=e.c,b=e.w,x=e.a,I=e.m,w=e.O,k=e.J,S=e.u,C=e.Q,B=e.F},e=>{F=e.b4,M=e.H,T=e.ag,H=e.b6,P=e.b5,A=e.u,E=e._,O=e.bW,j=e.aC,L=e.l,G=e.aD,N=e.J,$=e.S,z=e.s,W=e.b2,V=e.G},e=>{J=e.P},e=>{Q=e.D},e=>{R=e.l}],execute:function(){var a=document.createElement("style");a.textContent=".bmi_blood[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:190px}.graphBtn[data-v-88580898]{font-size:14px;font-weight:500;border:1px solid #ddeedd;border-radius:4px;padding:4px;min-width:90px}._active[data-v-88580898]{background-color:#ded;color:#006401;padding:5px;border-radius:4px}.iconBg[data-v-88580898]{background:#ded;padding:2px;border-radius:5px}#container[data-v-0ac31033]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-0ac31033]{font-size:20px;line-height:26px}#container p[data-v-0ac31033]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-0ac31033]{text-decoration:none}.action_buttons[data-v-0ac31033]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-0ac31033]{padding-left:20px}.item_no_border[data-v-0ac31033]{--border-color: transparent}.search_result[data-v-0ac31033]{padding:10px}.previousView[data-v-0ac31033]{margin-top:70px;margin-bottom:20px}\n/*$vite$:1*/",document.head.appendChild(a);const q=i({name:"Menu",components:{IonContent:c,IonHeader:r,IonItem:d,IonList:l,IonMenu:s,IonTitle:o,IonToolbar:n,List:F},computed:{...t(A,["patient"])},data:()=>({valueNumericArray:[],obsDatetime:[],graphIcon:P(["#006401"]),listIcon:H(["#636363"]),displayGraph:!0,orders:[],height:[],BMI:[],iconBg:{},activeWeight:[],activeHeight:[],activeBMI:[],list:[],series:[{name:"",data:[]}]}),setup:()=>({checkmark:g,pulseOutline:p}),async mounted(){const e=[...await T.getAll(this.patient.patientID,"Primary diagnosis")||[],...await T.getAll(this.patient.patientID,"Secondary diagnosis")||[],...await T.getAll(this.patient.patientID,"Attempted/ Differential diagnosis")||[]],a=R.isEmpty(e)?[]:Promise.all(e.map(async e=>({name:await T.getConceptName(e.value_coded),obs_date:e.obs_datetime})));this.setListData(await a)},methods:{dismiss(){u.dismiss()},handleIcon(){},setActivClass(e){this.activeHeight="",this.activeBMI="",this.activeWeight="","height"==e?this.activeHeight="_active":"weight"==e?this.activeWeight="_active":"BMI"==e&&(this.activeBMI="_active")},setListData(e){this.list=[],this.list.push({actionBtn:!1,class:"col_background",header:!0,minHeight:"--min-height: 25px;",display:["Date","Diagnosis","Notes"]}),e.forEach(e=>{this.list.push({actionBtn:!1,minHeight:"--min-height: 25px;",class:"col_background",display:[M.toStandardHisFormat(e.obs_date),e.name,""]})})}}}),Y={class:"modal_wrapper"},K=E(q,[["render",function(e,a,i,t,n,o){const s=v("list");return h(),m("div",Y,[f("div",null,[y(s,{listData:e.list},null,8,["listData"])])])}],["__scopeId","data-v-88580898"]]),U={class:"custom_card",style:{padding:"10px"}},X={key:0},Z={key:0,style:{color:"red","margin-top":"10px",background:"lightgoldenrodyellow"}},ee={class:"ion-padding",slot:"content"};e("O",E(i({__name:"OPDDiagnosis",setup(e,{expose:a}){const i=L,t=D(!0),n=D(!1),o=D(!0),s=D(!1),l=D(!0),r=D(""),c=D(""),u=D([]),p=D([]),g=D(),M=D(null);O();const H=_(()=>p.value.some(e=>6542===e.data.concept_id));b(p,()=>{Y()},{deep:!0});const P=_(()=>[{name:"primaryDiagnosis",header:"Primary Diagnosis",componentType:"multiSelectInputField",options:u.value,icon:i.search,onSearchChange:R,validation:j.required},{componentType:"checkboxField",label:"Secondary Diagnosis",type:"single",grid:{s:"6"},name:"secondaryDiagnosisCheckbox"},{componentType:"checkboxField",label:"Differential Diagnosis",type:"single",grid:{s:"6"},name:"differentialDiagnosisCheckbox"},{componentType:"Dashes"},{name:"secondaryDiagnosis",header:"Secondary Diagnosis",componentType:"multiSelectInputField",isMultiple:!0,options:u.value,icon:i.search,condition:e=>null==e?void 0:e.secondaryDiagnosisCheckbox,onSearchChange:R,validation:(e,a)=>A(a,"secondaryDiagnosis")},{name:"differentialDiagnosis",header:"Differential Diagnosis",componentType:"multiSelectInputField",options:u.value,icon:i.search,isMultiple:!0,condition:e=>null==e?void 0:e.differentialDiagnosisCheckbox,onSearchChange:R,validation:(e,a)=>A(a,"differentialDiagnosis")}]),A=(e,a)=>{var i,t,n;if(!e)return null;const o=null===(i=e.primaryDiagnosis)||void 0===i?void 0:i.name,s=(null===(t=e.secondaryDiagnosis)||void 0===t?void 0:t.map(e=>e.name))||[],l=(null===(n=e.differentialDiagnosis)||void 0===n?void 0:n.map(e=>e.name))||[];if("secondaryDiagnosis"===a&&s.includes(o))return`${o} is already the primary diagnosis`;if("differentialDiagnosis"===a&&l.includes(o))return`${o} is already the primary diagnosis`;const d=s.find(e=>l.includes(e));return d?`${d} cannot be both secondary and differential`:null},E=()=>{var e;const a=[],i=p.value.map(e=>e.name),t=(null===(e=M.value)||void 0===e?void 0:e.getFormValues())||{},n=t.primaryDiagnosis||[],o=t.secondaryDiagnosis||[],s=t.differentialDiagnosis||[];if(n.name&&!i.includes(n.name)){if(p.value.some(e=>6542===e.data.concept_id))return z("Only one primary diagnosis is allowed"),!1;a.push({actionBtn:!0,btn:["delete"],name:n.name,id:n.concept_id,display:[n.name,"Primary diagnosis"],data:{concept_id:6542,value_coded:n.concept_id,obs_datetime:$.getSessionDate()}})}return o&&o.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Secondary diagnosis"],data:{concept_id:6543,value_coded:e.concept_id,obs_datetime:$.getSessionDate()}})}),s&&s.forEach(e=>{i.includes(e.name)||a.push({actionBtn:!0,btn:["delete"],name:e.name,id:e.concept_id,display:[e.name,"Differential diagnosis"],data:{concept_id:10201,value_coded:e.concept_id,obs_datetime:$.getSessionDate()}})}),a.length>0&&(p.value=[...p.value,...a]),!0},R=async e=>{const a=e.trim().toLowerCase()||"";return u.value=await J.getDiagnosis(a,1,15),u.value},q=e=>{const a=p.value,i=e.name,t=a.filter(e=>e.display[0]!==i);p.value=t},Y=()=>{p.value.length>0?(s.value=!0,t.value=!1):n.value||(t.value=!0),l.value=!H.value};return x(async()=>{Y(),await R("")}),a({onSubmit:async()=>{if(p.value.length<=0)return;const e=p.value.flatMap(e=>e.data);e.length<=0||(await T.addObsToEncounterPatient(e,W.DIAGNOSIS),V("Diagnosis saved successful"),p.value=[])}}),(e,a)=>{const u=v("ion-row"),D=v("ion-label"),_=v("ion-accordion"),b=v("ion-accordion-group");return h(),m(B,null,[f("div",U,[y(Q,{status:t.value,content:"No Diagnosis added"},null,8,["status"]),s.value?(h(),m("span",X,[y(F,{listData:p.value,"onClicked:delete":q},null,8,["listData"]),H.value?(h(),m("div",Z," In order to update the diagnosis list, please remove/delete the primary diagnosis only and then re-add or change it along with the secondary and differential diagnoses. ")):I("",!0)])):I("",!0),n.value?(h(),w(u,{key:1},{default:k(()=>{var e;return[f("div",null,[y(G,{formData:P.value,ref_key:"formRef",ref:M},null,8,["formData"])]),f("div",null,[y(N,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[0]||(a[0]=e=>(async()=>{var e;null==(null===(e=M.value)||void 0===e?void 0:e.validateForm())&&(E(),n.value=!1,s.value=!0,l.value=!0,o.value=!1)})()),name:"Save",disabled:null===(e=M.value)||void 0===e?void 0:e.validateForm(),class:"ion-margin-top"},null,8,["icon","disabled"])])]}),_:1})):I("",!0),l.value?(h(),w(u,{key:2,style:{"margin-top":"10px"}},{default:k(()=>[y(N,{fill:"clear",icon:S(i).plus,iconSlot:"icon-only","onClicked:btn":a[1]||(a[1]=e=>(c.value="",r.value="",t.value=!1,l.value=!1,void(n.value=!0))),name:"Add new Diagnosis"},null,8,["icon"])]),_:1})):I("",!0)]),y(u,null,{default:k(()=>[y(b,{ref_key:"accordionGroup",ref:g,class:"previousView"},{default:k(()=>[y(_,{value:"first","toggle-icon-slot":"start",class:"custom_card"},{default:k(()=>[y(S(d),{slot:"header",color:"light"},{default:k(()=>[y(D,{class:"previousLabel"},{default:k(()=>[...a[2]||(a[2]=[C("Previous Diagnosis",-1)])]),_:1})]),_:1}),f("div",ee,[y(K)])]),_:1})]),_:1},512)]),_:1})],64)}}}),[["__scopeId","data-v-0ac31033"]]))}}});
