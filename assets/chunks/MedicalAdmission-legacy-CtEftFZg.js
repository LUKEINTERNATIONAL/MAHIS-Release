System.register(["./vendor-legacy-yRrh2kya.js","../index-legacy-Cux3rgIH.js","./DemographicBar-legacy-Dhm_rkPD.js","./useFormWizard-legacy-zmCsImFh.js","./ComplicationsStore-legacy-BbzXpcMa.js","./nonPharmaTherapyStore-legacy-CD-QzFCz.js","./lodash-legacy-pOOc9Efu.js","./formatServerData-legacy-D5zS0lNg.js","./usePatientProfile-legacy-CGt3wOOP.js","./apexcharts-legacy-D_Tg9bdX.js","./drug_prescription_service-legacy-B-OUTQLj.js","./patient_diagnosis_service-legacy-VbxavwYc.js","./Registration-legacy-BhFwVj7L.js","./useSetRegistrationValues-legacy-D1MaF-bm.js","./useLocation-legacy-DN0f-JsQ.js","./vaccines_service-legacy-B4Ep1GsK.js","./sms_service-legacy--NGxtDhR.js","./EIRreportsStore-legacy-ABoXvqgn.js","./Export-legacy-DjSyOe1o.js","./user_role_management-legacy--hmiyvvo.js","./useNeonatalEnrollmentStore-legacy-DH5gbqMf.js","./enrollment-legacy-BWFKsMdA.js","./Outcome-legacy-FuleqfJO.js","./wardsStore-legacy-CJvSgo28.js"],function(e,t){"use strict";var i,a,n,l,s,o,r,c,u,g,v,d,y,m,f,p,S,h,b,D,P,H,w,x,I,_,R,j,C,M,A,E,F,T,O,k,L,z,B,N,V,$,W,J,Q,U,X,Y,Z,q,G,K,ee,te,ie,ae,ne,le;return{setters:[e=>{i=e.d,a=e.am,n=e.cr,l=e.r,s=e.c,o=e.b2,r=e.w,c=e.a,u=e.H,g=e.O,v=e.f,d=e.J,y=e.l,m=e.u,f=e.ab,p=e.k,S=e.m,h=e.i,b=e.bT,D=e.v,P=e.ae,H=e.ba},e=>{w=e.b9,x=e.u,I=e.ba,_=e.bb,R=e.b1,j=e.bc,C=e.e,M=e.b2,A=e.i,E=e.a8,F=e.f,T=e.T,O=e.D,k=e.a1,L=e.H,z=e.b4,B=e.bd,N=e.I,V=e.be,$=e.t,W=e.ap,J=e.F,Q=e.bf,U=e.aa,X=e.S},e=>{Y=e.D},e=>{Z=e.u,q=e._},e=>{G=e.u},e=>{K=e.s,ee=e.c,te=e.u},e=>{ie=e.l},e=>{ae=e.f,ne=e.a},e=>{le=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const t={style:{width:"88vw",margin:"0 auto","margin-top":"10px"}},se={class:"back_profile"};e("default",i({__name:"MedicalAdmission",setup(e,{expose:i}){const{onTabBeforeChange:oe,currentTabIndex:re}=Z();le();const ce=a(),ue=n();l([]),l([]),l(!1);const ge=l(!0),ve=l(!1),de=l(!1),ye=s(()=>({text:de.value?"Saving...":"Finish",icon:de.value?"hourglass-outline":"checkmark",hideText:!1,hideIcon:!1,disabled:ve.value||de.value})),me=w(),fe=x(),pe=I(),Se=_();R();const he=j(),be=C();M();const De=A(),Pe=G(),He=E(),{patient:we}=o(fe),{vitals:xe}=o(me),{investigations:Ie}=o(pe),{diagnosis:_e}=o(Se),{substance:Re}=o(De),{selectedNCDMedicationList:je}=o(he),{FootScreening:Ce,visualScreening:Me,cvScreening:Ae}=o(Pe),{sessionDate:Ee}=o(He),{apiStatus:Fe}=o(F());r(ye,(e,t)=>{console.log("Done button options changed:",{from:t,to:e,currentStep:re.value,tabsLength:ke.value.length}),e.disabled!==(null==t?void 0:t.disabled)&&console.log("Done button "+(e.disabled?"disabled":"enabled")),e.text!==(null==t?void 0:t.text)&&console.log(`Done button text changed from "${null==t?void 0:t.text}" to "${e.text}"`)},{deep:!0}),r(de,(e,t)=>{e!==t&&(console.log(`Saving state changed: ${t} -> ${e}`),e?console.log("Starting save process..."):console.log("Save process completed"))});const Te=e=>{console.log("Done button change received from wizard:",e),e.newOptions.disabled&&console.log("Done button has been disabled"),e.isLastStep&&console.log("User is on the last step, done button should be visible")},Oe=()=>{let e=!1;return Be(),de.value&&(e=!0),ve.value=e,!e},ke=l([{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]),Le=l(null),ze=l(null),Be=()=>{var e;if(!ke.value||0===ke.value.length)return console.log("Tabs not yet initialized"),null;const t=re.value>=0&&re.value<ke.value.length?re.value:0;switch(null===(e=ke.value[t])||void 0===e?void 0:e.title){case"Presenting Complaints":return"Presenting Complaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan";default:if(be.NCDActivities.length>0)switch(be.NCDActivities[0]){case"Presenting Complaints":return"PresentingComplaints";case"Drug History":return"DrugHistory";case"Past Medical History":return"PastMedicalHistory";case"Past Surgical History":return"PastSurgicalHistory";case"Allergy":return"Allergy";case"Intoxication":return"Intoxication";case"Social History":return"SocialHistory";case"Family History":return"FamilyHistory";case"Review of Systems":return"ReviewOfSystems";case"Physical Examination":return"PhysicalExamination";case"Summary":return"Summary";case"Differential Diagnosis":return"DifferentialDiagnosis";case"Investigation":return"Investigation";case"Management Plan":return"ManagementPlan"}return null}},Ne=()=>{ge.value=!1,setTimeout(()=>{re.value=0,ge.value=!0},0)},Ve=()=>{const e=w();e.setVitals(e.getInitialVitals(we.value.ID))},$e=async()=>{const e=k(Ee.value,"sessionDate","value")||L.sessionDate(),t=z("vitals");for(let a=0;a<ke.value.length;a++){const n=ke.value[a];if("Vital Signs"===n.title)ke.value[a].icon=We(e,t)?H:"";else if("Risk Assessment"===n.title){const t=z("substanceAbuse");ke.value[a].icon=We(e,t)?H:""}else if("Investigations"===n.title){var i;const t=null==we||null===(i=we.value)||void 0===i||null===(i=i.labOrders)||void 0===i?void 0:i.saved,n=null==t?void 0:t.filter(t=>L.toStandardHisFormat(e)===L.toStandardHisFormat(t.order_date));ke.value[a].icon=(null==n?void 0:n.length)>0?H:""}else if("Diagnosis"===n.title){const t=z("diagnosis");ke.value[a].icon=We(e,t)?H:""}else if("Complications Screening"===n.title){const t=z("screening");ke.value[a].icon=We(e,t)?H:""}else"Treatment Plan"===n.title&&(je.value.length>0?ke.value[a].icon=B()?H:"":ke.value[a].icon="")}Oe()},We=(e,t)=>{const i=new Date(e);return i.setHours(0,0,0,0),t.some(e=>{const t=new Date(e.obs_datetime);return t.setHours(0,0,0,0),t.getTime()===i.getTime()})},Je=async(e,t)=>{var i;const a=null===(i=ke.value[t])||void 0===i?void 0:i.title;var n,l;e%1==0&&(re.value=e),"Vital Signs"==a&&(null===(n=Le.value)||void 0===n||n.onSubmit()),"Risk Assessment"==a&&(null===(l=ze.value)||void 0===l||l.onSubmit()),"Complications Screening"==a&&await(async()=>{const e=[],t=await ae(Me.value),i=await ne(Ce.value),a=await ae(Ae.value);var n,l,s,o;t.length>0&&e.push({concept_id:await W.getConceptID("Visual acuity",!0),value_text:"visual acuity test",obs_datetime:W.getSessionDate(),child:t}),i.length>0&&e.push({concept_id:await W.getConceptID("Foot check",!0),value_text:"foot screening",obs_datetime:W.getSessionDate(),child:i}),a.length>0&&e.push(...a),e.length>0?(null!==(l=(n=null!==(o=(s=we.value).screening)&&void 0!==o?o:s.screening={}).unsaved)&&void 0!==l||(n.unsaved=[]),we.value.screening.unsaved.push(...e),J("Complications saved successfully")):$("No complications data to save")})(),"Treatment Plan"==a&&await(async()=>{const e=Q();if(!ie.isEmpty(e.selectedMedicalAllergiesList)){const t=U(),i=e.selectedMedicalAllergiesList.map(e=>({concept_id:e.concept_id,obs_datetime:X.getSessionDate(),value_coded:e.concept_id,location_id:t.facilityLocation.code,value_text:e.name})),a=await K(i);we.value=Object.assign(we.value,a),console.log("Allergies staged successfully:",we.value),e.clearSelectedMedicalAllergiesList()}const t=await ee();we.value=Object.assign(we.value,t);const i=await te().saveNonPharmaTherapyPatientData();we.value=Object.assign(we.value,i)})(),await N(we.value)},Qe=async()=>{de.value=!0;try{await V(),await N(we.value),ce.push("/triageList")}catch(e){console.error("Error saving data:",e),$("Error occurred while saving data. Please try again.")}finally{de.value=!1}};return c(async()=>{0!==be.NCDActivities.length?(G().resetScreening(),ke.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}],await $e(),(void 0===re.value||re.value<0)&&(re.value=0,console.log("Setting initial tab index to 0")),ve.value=!1,de.value=!1,Oe()):ce.push("patientProfile")}),r(re,async()=>{await Oe()}),r(xe,async()=>{await $e()},{deep:!0}),r(we,async()=>{G().resetScreening(),await $e()},{deep:!0}),r(Ee,async()=>{await $e()},{deep:!0}),r(Ie,async()=>{await $e()},{deep:!0}),r(_e,async()=>{await $e()},{deep:!0}),r(Re,async()=>{await $e()},{deep:!0}),r(je,async()=>{await $e()},{deep:!0}),r(ue,async e=>{Ne(),Ve(),ke.value=[{title:"Presenting Complaints",icon:""},{title:"Drug History",icon:""},{title:"Past Medical History",icon:""},{title:"Past Surgical History",icon:""},{title:"Allergy",icon:""},{title:"Intoxication",icon:""},{title:"Social History",icon:""},{title:"Family History",icon:""},{title:"Review of Systems",icon:""},{title:"Physical Examination",icon:""},{title:"Summary",icon:""},{title:"Differential Diagnosis",icon:""},{title:"Investigation",icon:""},{title:"Management Plan",icon:""}]},{deep:!0}),r(we,async(e,t)=>{e.ID!=t.ID&&(Ne(),Ve())},{deep:!0}),i({saveData:Qe,markWizard:$e,refreshWizard:Ne,validateDoneButtonState:Oe}),(e,i)=>{const a=u("PresentingComplaints"),n=u("DrugHistory"),l=u("PastMedicalHistory"),s=u("PastSurgicalHistory"),o=u("Allergy"),r=u("Intoxication"),c=u("SocialHistory"),H=u("FamilyHistory"),w=u("ReviewOfSystems"),x=u("PhysicalExamination"),I=u("Summary"),_=u("DifferentialDiagnosis"),R=u("Investigation"),j=u("ManagementPlan");return v(),g(m(P),null,{default:d(()=>[y(T),y(m(f),{fullscreen:!0},{default:d(()=>[y(Y),p("div",t,[ge.value?(v(),g(q,{key:0,ref:"wizard",headingTitle:"Medical Inpatient Admission Sheet","vertical-tabs":"","navigable-tabs":"","scrollable-tabs":"",startIndex:0,doneButton:ye.value,"custom-tabs":ke.value,beforeChange:m(oe),onChange:Je,"onComplete:wizard":i[1]||(i[1]=e=>Qe()),onDoneButtonChanged:Te},{default:d(()=>[p("div",null,[p("div",se,[y(O,{name:"Back to profile",iconSlot:"start",fill:"clear",icon:m(b),"font-weight":"600",onClick:i[0]||(i[0]=e=>{ce.push("/patientProfile")})},null,8,["icon"])])]),h(p("div",null,[y(a,{ref:"presentingComplaintsRef"},null,512)],512),[[D,"PresentingComplaints"==Be()]]),h(p("div",null,[y(n,{ref:"drugHistoryRef"},null,512)],512),[[D,"DrugHistory"==Be()]]),h(p("div",null,[y(l,{ref:"pastMedicalHistoryRef"},null,512)],512),[[D,"PastMedicalHistory"==Be()]]),h(p("div",null,[y(s,{ref:"pastSurgicalHistoryRef"},null,512)],512),[[D,"PastSurgicalHistory"==Be()]]),h(p("div",null,[y(o,{ref:"allergyRef"},null,512)],512),[[D,"Allergy"==Be()]]),h(p("div",null,[y(r,{ref:"IntoxicationRef"},null,512)],512),[[D,"Intoxication"==Be()]]),h(p("div",null,[y(c,{ref:"socialHistoryRef"},null,512)],512),[[D,"SocialHistory"==Be()]]),h(p("div",null,[y(H,{ref:"familyHistoryRef"},null,512)],512),[[D,"FamilyHistory"==Be()]]),h(p("div",null,[y(w,{ref:"reviewOfSystemsRef"},null,512)],512),[[D,"ReviewOfSystems"==Be()]]),h(p("div",null,[y(x,{ref:"physicalExaminationRef"},null,512)],512),[[D,"PhysicalExamination"==Be()]]),h(p("div",null,[y(I,{ref:"summaryRef"},null,512)],512),[[D,"Summary"==Be()]]),h(p("div",null,[y(_,{ref:"differentialDiagnosisRef"},null,512)],512),[[D,"DifferentialDiagnosis"==Be()]]),h(p("div",null,[y(R,{ref:"investigationRef"},null,512)],512),[[D,"Investigation"==Be()]]),h(p("div",null,[y(j,{ref:"managementPlanRef"},null,512)],512),[[D,"ManagementPlan"==Be()]])]),_:1},8,["doneButton","custom-tabs","beforeChange"])):S("",!0)])]),_:1})]),_:1})}}}))}}});
