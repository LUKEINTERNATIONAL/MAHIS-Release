import{d as z,X as M,a6 as $,$ as ge,H as Y,e as J,f as _,P as fe,O as y,J as a,l as o,Q as N,K as T,k as U,p as ce,F as ae,r as l,w as X,u as e,dR as be,m as k,bN as we,a as ee,aS as te,aQ as le,aR as oe,a5 as R,bl as ve,dX as he,bn as ne,a3 as re,aP as se,N as De,aV as Se,c as Ie,aj as ke}from"./vendor-B45YKAfe.js";import{h as Ve,X as Ce,k as Fe,_ as Q,B as _e,aW as Ae,q as Be,aK as de,t as Z,aw as me,M as j,J as He,L as Pe,y as Ue,ay as Ne,az as xe,ar as Ee,a8 as Te,n as Re,bo as $e,S as pe,H as ie,K as Oe}from"./index-BqZqQXlC.js";import{l as Le}from"./lodash-NJiRuGo9.js";const Me=z({components:{IonItem:ge,IonCol:$,IonLabel:M},data(){return{iconsContent:Fe}},props:{displayData:{type:Array,default:[]}},methods:{highlightItem(u){const f=document.getElementById(u+"_lbl");f&&(f.style.color="#006401"),this.highlightActionBtns(u)},undoHighlightItem(u){const f=document.getElementById(u+"_lbl");f&&(f.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(u)},highlightActionBtns(u){const f=document.getElementsByClassName(u+"_spanlbl");for(let v=0;v<f.length;v++)f[v].style.display="block"},undohighlightActionBtns(u){const f=document.getElementsByClassName(u+"_spanlbl");for(let v=0;v<f.length;v++)f[v].style.display="none"},asignLblID(u){return u+"_lbl"},asignSpanLblID(u){return u+"_spanlbl"},async removeItemAtIndex(u,f){await Ce("Do you want to delete it?",f)&&this.$emit("update:removeItem",u)},async editItemAtIndex(u,f,v){await Ve("Do you want to edit it?",v)&&this.$emit("update:editItem",{index:u,item:f})},fomartDate(u){const f=u.year,v=(u.month<10?"0":"")+u.month,D=(u.day<10?"0":"")+u.day;return f+"-"+v+"-"+D}}});function qe(u,f,v,D,I,h){const p=Y("ion-label"),w=Y("ion-col"),S=Y("ion-icon"),b=Y("ion-item");return _(!0),J(ae,null,fe(u.displayData,(n,s)=>(_(),y(b,{displayData:u.displayData,class:"ionLbltp",key:s,onMousemove:g=>u.highlightItem(s),onMouseout:g=>u.undoHighlightItem(s)},{default:a(()=>[o(w,{class:"col-st1"},{default:a(()=>[o(p,{id:u.asignLblID(s),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[N(T(n.type),1)]),_:2},1032,["id"])]),_:2},1024),o(w,{class:"col-st2"},{default:a(()=>[o(p,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:a(()=>[f[0]||(f[0]=U("span",{class:"spaceBetween"},null,-1)),N(" "+T(n.name)+" ",1),f[1]||(f[1]=U("span",{class:"spaceBetween"},null,-1)),N(T(n.reason),1),f[2]||(f[2]=U("span",{class:"spaceBetween"},null,-1)),N(T(u.fomartDate(n.date)),1)]),_:2},1024)]),_:2},1024),o(w,{class:"action_buttons"},{default:a(()=>[o(p,{class:ce(u.asignSpanLblID(s)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:g=>u.editItemAtIndex(s,n,g)},{default:a(()=>[o(S,{icon:u.iconsContent.edit},null,8,["icon"])]),_:1},8,["class","onClick"]),o(p,{class:ce(u.asignSpanLblID(s)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:g=>u.removeItemAtIndex(s,g)},{default:a(()=>[o(S,{icon:u.iconsContent.delete},null,8,["icon"])]),_:1},8,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}const We=Q(Me,[["render",qe],["__scopeId","data-v-4346bf77"]]),ye=z({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(u,{emit:f}){const v=l(),D=l({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),I=l(),h={name:"Now",show:!0,fn:O},p=l(!0),w=l(!1),S=l(0),b=u;X(()=>b.time_prop,B=>{B&&(v.value=B.time)},{immediate:!0,deep:!0});const n=f;function s(){n("timeUpDated",I.value)}function g(B){w.value==!0?(p.value=!1,w.value=!1):p.value=!0,D.value.isOpen=!0,D.value.event=B}function A(B){v.value=B.detail.value;const H=C(v.value);if(x(H)==!0){O();return}v.value=H}function x(B){return B.indexOf("NaN")!==-1}function C(B){let H=new Date(B),F=H.getHours(),q=H.getMinutes(),L=F>=12?"PM":"AM";F=F%12,F=F||12;let i=F.toString().padStart(2,"0")+":"+q.toString().padStart(2,"0")+" "+L;return I.value={time:i,meridian:L},s(),i}function O(){w.value=!0,v.value=C(new Date),p.value=!1,S.value++}return(B,H)=>{const F=Y("ion-popover");return _(),J(ae,null,[(_(),y(_e,{placeholder:b.place_holder.default,inputValue:v.value,icon:e(be),"-inner-action-btn-propeties":h,"onClicked:inputValue":g,"onUpdate:InnerActionBtnPropetiesAction":h.fn,key:S.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),o(F,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":D.value.isOpen,event:D.value.event,side:"top",onDidDismiss:H[0]||(H[0]=q=>D.value.isOpen=!1)},{default:a(()=>[p.value?(_(),y(e(we),{key:0,onIonChange:A,id:"datetime",presentation:"time","show-default-buttons":!0})):k("",!0)]),_:1},8,["is-open","event"])],64)}}});class ze extends Ae{constructor(f,v){super(f,114,v)}}async function Ke(u={}){try{const{name:f="",page:v=1,page_size:D=10}=u,I=f?{name:"%".concat(f,"%")}:{};return(await Be("wards",{likeClause:I,currentPage:v,itemsPerPage:D}).then(p=>p.records)).map(p=>({name:p.name,value:p.name,other:p}))}catch(f){throw console.error("Error fetching offline wards:",f.message),f}}const Xe=z({name:"xxxComponent"}),je=z({...Xe,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(u,{emit:f}){const v=l([]),D=de(),I=l(NaN),h=l(!1),p=l(),w=l(!1);ee(async()=>{H(),A()});const S=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:F},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:P}],b=[{placeHolder:"Reason",dataHandler:O,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],n=[{placeHolder:{default:"Enter date"},dataHandler:C,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],s=[{placeHolder:{default:"Enter time of admission"},dataHandler:x,dataValue:l(),show_error:l(!1),error_message:"error"}],g=u;X(()=>g.selected_ward_prop,m=>{m&&(p.value=m)},{immediate:!0,deep:!0}),X(()=>g.admitted_other_props,m=>{m&&(b[0].dataValue.value=m.reason,s[0].dataValue.value=m.time,n[0].dataValue.value=m.date)},{immediate:!0,deep:!0});function A(m=!0){w.value=m}function x(m){s[0].dataValue.value=m,F(!1)}function C(m){const d={day:m.value.day,month:m.value.month,year:m.value.year,formattedDate:m.value.formattedDate};n[0].dataValue.value=d,F(!1)}function O(m){const d=m.target.value;b[0].dataValue.value=d,B(),A(!1)}function B(){w.value==!0&&Z("Remember to press the SAVE button",1e4)}async function H(m){(await Ke({name:"",page:1,page_size:1e3})).forEach(c=>{const E={name:c.name,selected:!1,other:c,location_ward_id:c.other.location_id};v.value.push(E)})}function F(m=!0){q(),L(),V(),W(),n[0].show_error.value==!1&&s[0].show_error.value==!1&&b[0].show_error.value==!1&&h.value==!1?i():m&&Z("Please enter correct data values",4e3)}function q(){p.value===void 0||p.value==""?h.value=!0:h.value=!1}function L(){b[0].dataValue.value==""||b[0].dataValue.value===void 0?b[0].show_error.value=!0:b[0].show_error.value=!1}async function i(){const m={name:p.value.name,type:"Admitted for short stay",date:n[0].dataValue,time:s[0].dataValue,reason:b[0].dataValue,other:p.value,selected:!0};await D.addOutcomeData(m,I.value)&&r({dataSaved:!1})}const t=f;function r(m={dataSaved:!0}){t("dataSaved",m)}function P(){r()}function V(){n[0].dataValue.value===void 0||n[0].dataValue.value==""?n[0].show_error.value=!0:n[0].show_error.value=!1}function W(){s[0].dataValue.value===void 0||n[0].dataValue.value==""?s[0].show_error.value=!0:s[0].show_error.value=!1}const G=m=>{p.value=m,A(),F(!1)};return(m,d)=>(_(),y(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...d[3]||(d[3]=[N("Admitted for Short Stay",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(ve),{modelValue:p.value,"onUpdate:modelValue":[d[0]||(d[0]=c=>p.value=c),d[1]||(d[1]=c=>G(c))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:d[2]||(d[2]=c=>c={}),"track-by":"location_ward_id",options:v.value},null,8,["modelValue","options"]),U("div",null,[h.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[...d[4]||(d[4]=[N(T("Please select a ward"),-1)])]),_:1})):k("",!0)])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:n[0].placeHolder,onDateUpDated:n[0].dataHandler,date_prop:n[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[n[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(n[0].error_message),1)]),_:1})):k("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:s[0].placeHolder,onTimeUpDated:s[0].dataHandler,time_prop:s[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[s[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(s[0].error_message),1)]),_:1})):k("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:b[0].placeHolder,icon:e(he),inputValue:b[0].dataValue.value,"onUpdate:inputValue":b[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[b[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(b[0].error_message),1)]),_:1})):k("",!0)])]),_:1})]),_:1}),S[0].showAddItemButton?(_(),y(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[S[0].addItemButton?(_(),y(j,{key:0,name:S[0].name,fill:S[0].btnFill,icon:e(ne),"onClicked:btn":S[0].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0),S[1].addItemButton?(_(),y(j,{key:1,name:S[1].name,fill:S[1].btnFill,icon:e(re),"onClicked:btn":S[1].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0)]),_:1})):k("",!0)]),_:1})]),_:1}))}}),Je=Q(je,[["__scopeId","data-v-d012b300"]]),Qe=z({name:"xxxComponent"}),Ge=z({...Qe,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(u,{emit:f}){const v=l(NaN),D=l(null),I=de(),h=l(!1),p=l([]),w=l({}),S=l(!0),b={location_data:{}},n=[{placeHolder:"Reason",dataHandler:C,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],s=[{placeHolder:{default:"Enter date"},dataHandler:x,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],g=[{placeHolder:{default:"Enter time of referral"},dataHandler:B,dataValue:l(),show_error:l(!1),error_message:"error"}],A=u;X(()=>A.selected_other_referral_data,d=>{d&&(n[0].dataValue.value=d.reason,s[0].dataValue.value=d.date,g[0].dataValue.value=d.time)},{immediate:!0,deep:!0}),X(()=>A.selected_referral_data,d=>{if(!d)return;D.value=d.selected_location,b.location_data=d;const c=Array.isArray(d.selected_district_ids)?[...d.selected_district_ids]:[],E=d.selected_location?{...d.selected_location}:null;p.value=c,w.value=E},{immediate:!0,deep:!0}),ee(()=>{t()});function x(d){const c={day:d.value.day,month:d.value.month,year:d.value.year,formattedDate:d.value.formattedDate};s[0].dataValue.value=c,H(!1)}function C(d){const c=d.target.value;n[0].dataValue.value=c,O(),t(!1)}function O(){S.value==!0&&Z("Remember to press the SAVE button",1e4)}function B(d){g[0].dataValue.value=d,H(!1)}function H(d=!0){i(),F(),q(),L(),s[0].show_error.value==!1&&g[0].show_error.value==!1&&n[0].show_error.value==!1&&h.value==!1?P():d&&Z("Please enter correct data values",4e3)}function F(){n[0].dataValue.value==""||n[0].dataValue.value===void 0?n[0].show_error.value=!0:n[0].show_error.value=!1}function q(){s[0].dataValue.value===void 0||s[0].dataValue.value==""?s[0].show_error.value=!0:s[0].show_error.value=!1}function L(){g[0].dataValue.value===void 0||s[0].dataValue.value==""?g[0].show_error.value=!0:g[0].show_error.value=!1}function i(){D.value?h.value=!1:h.value=!0}function t(d=!0){S.value=d}const r=d=>{D.value=d.selected_location,i(),b.location_data=d,t(),H(!1)},P=async()=>{const d={name:D.value.name,type:"Referred out",selected:!0,date:s[0].dataValue,time:g[0].dataValue,reason:n[0].dataValue},c={...d,other:{ref_data:d,location_data:b.location_data}};await I.addOutcomeData(c,v.value)&&G({dataSaved:!1})},V=()=>{G()},W=f;function G(d={dataSaved:!0}){W("dataSaved",d)}const m=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:H},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:V}];return(d,c)=>(_(),y(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...c[0]||(c[0]=[N("Referred Out",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(He,{show_error:h.value,onFacilitySelected:r,selected_district_ids:p.value,selected_location:w.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:s[0].placeHolder,onDateUpDated:s[0].dataHandler,date_prop:s[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[s[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(s[0].error_message),1)]),_:1})):k("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(ye,{place_holder:g[0].placeHolder,onTimeUpDated:g[0].dataHandler,time_prop:g[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),U("div",null,[g[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(g[0].error_message),1)]),_:1})):k("",!0)])])]),_:1})]),_:1}),o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(_e,{placeholder:n[0].placeHolder,icon:e(he),inputValue:n[0].dataValue.value,"onUpdate:inputValue":n[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),U("div",null,[n[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(n[0].error_message),1)]),_:1})):k("",!0)])]),_:1})]),_:1}),m[0].showAddItemButton?(_(),y(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[m[0].addItemButton?(_(),y(j,{key:0,name:m[0].name,fill:m[0].btnFill,icon:e(ne),"onClicked:btn":m[0].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0),m[1].addItemButton?(_(),y(j,{key:1,name:m[1].name,fill:m[1].btnFill,icon:e(re),"onClicked:btn":m[1].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0)]),_:1})):k("",!0)]),_:1})]),_:1}))}}),Ye=Q(Ge,[["__scopeId","data-v-f25626fb"]]),Ze=z({name:"xxxComponent"}),ea=z({...Ze,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(u,{emit:f}){const v=l(NaN),D=l([]),I=de(),h=l();ee(async()=>{x("")});const p=[{placeHolder:"Reason",dataHandler:n,dataValue:l(),show_error:l(!1),error_message:"please provide a reason"}],w=[{placeHolder:{default:"Enter date"},dataHandler:b,dataValue:l(),show_error:l(!1),error_message:"please provide date"}],S=u;X(()=>S.selected_discharged_prop,t=>{t&&(h.value=t)},{immediate:!0,deep:!0}),X(()=>S.selected_discharged_data,t=>{t&&(w[0].dataValue.value=t.date||"",t.reason&&(p[0].dataValue.value=t.reason))},{immediate:!0,deep:!0});function b(t){const r={day:t.value.day,month:t.value.month,year:t.value.year,formattedDate:t.value.formattedDate};w[0].dataValue.value=r,O(!1)}function n(t){const r=t.target.value;p[0].dataValue.value=r}D.value,l(!1),l(!1);const s=[{placeHolder:{default:"Enter time of referral"},dataHandler:g,dataValue:l(),show_error:l(!1),error_message:"error"}];function g(t){s[0].dataValue.value=t}const A=new Set;async function x(t){const r=t;(await Pe.getFacilities({name:r})).forEach(V=>{A.has(V.location_id)||(A.add(V.location_id),Le.isEmpty(V.name)==!1&&D.value.push({name:V.name,selected:!1,other:V}))})}function C(t){D.value=t}function O(t=!0){B(),w[0].show_error.value?t&&Z("Please enter a valid date",4e3):H()}function B(){w[0].dataValue.value===void 0||w[0].dataValue.value==""?w[0].show_error.value=!0:w[0].show_error.value=!1}async function H(){const t={type:"Discharged Home",date:w[0].dataValue,reason:p[0].dataValue.value};await I.addOutcomeData(t,v.value)&&L({dataSaved:!1})}function F(){L()}const q=f;function L(t={dataSaved:!0}){q("dataSaved",t)}const i=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:O},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:F}];return(t,r)=>(_(),y(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...r[0]||(r[0]=[N("Discharged Home",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[U("div",null,[o(me,{place_holder:w[0].placeHolder,onDateUpDated:w[0].dataHandler,date_prop:w[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),U("div",null,[w[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(w[0].error_message),1)]),_:1})):k("",!0)])])]),_:1})]),_:1}),i[0].showAddItemButton?(_(),y(e(R),{key:0,class:"action-buttons-row"},{default:a(()=>[i[0].addItemButton?(_(),y(j,{key:0,name:i[0].name,fill:i[0].btnFill,icon:e(ne),"onClicked:btn":i[0].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0),i[1].addItemButton?(_(),y(j,{key:1,name:i[1].name,fill:i[1].btnFill,icon:e(re),"onClicked:btn":i[1].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0)]),_:1})):k("",!0)]),_:1})]),_:1}))}}),aa=Q(ea,[["__scopeId","data-v-b5701ac2"]]),ta={class:"date-results-container"},la={class:"date-buttons-container"},oa={key:0,class:"validation-message"},na={__name:"DatePillSelector",props:{availableDates:{type:Array,required:!0,default:()=>[]}},emits:["dateSelected"],setup(u,{expose:f,emit:v}){const D=u,I=v,h=l(null),p=l(!1),w=s=>{h.value=s,p.value=!1,I("dateSelected",{date:D.availableDates[s],index:s})},S=s=>{const g=new Date(s),A={weekday:"short",month:"short",day:"numeric"};return isNaN(g)?s:g.toLocaleDateString("en-US",A)};return f({validateSelection:()=>h.value===null?(p.value=!0,!1):(p.value=!1,!0),getSelectedDate:()=>h.value!==null?D.availableDates[h.value]:null}),(s,g)=>(_(),J("div",ta,[U("div",la,[(_(!0),J(ae,null,fe(u.availableDates,(A,x)=>(_(),y(e(De),{key:x,class:ce(["date-button",{selected:h.value===x,"error-border":p.value&&h.value!==x}]),fill:"outline",shape:"round",onClick:C=>w(x)},{default:a(()=>[N(T(S(A)),1)]),_:2},1032,["class","onClick"]))),128))]),p.value?(_(),J("p",oa," ⚠️ Please select an available date to proceed. ")):k("",!0)]))}},ra=Q(na,[["__scopeId","data-v-1e34f199"]]),sa=z({__name:"ReferToAnotherClinic",emits:["programDateSelected","referralDataReady","dataSaved"],setup(u,{emit:f}){const v=f,D=l([]),I=l([]),h=l([]),p=Ue(),w=Ne(),{activeProgram:S}=Se(p),b=l(!1),n=[{multi_Selection:!0,show_list_label:!0,unqueId:"qwerty_8_562",name_of_list:"Clinics",placeHolder:"Search for programs",items:[],listUpdatedFN:B,listFilteredFN:()=>{},searchTextFN:()=>{},use_internal_filter:!0,show_error:l(!1),error_message:"Please select one or more clinics/programs to refer to.",disabled:l(!1)}],s=async()=>{b.value=!1;const i=I.value.length>0;if(n[0].show_error.value=!i,!i){console.log("Validation Failed: No programs selected.");return}let t=!0;h.value=[];for(const r of I.value)if(r.dateSelectorRef)if(!r.dateSelectorRef.validateSelection())t=!1;else{const V=r.dateSelectorRef.getSelectedDate();V?h.value.push({programId:r.id,programName:r.name,date:V}):t=!1}else t=!1,console.error("Date Selector ref is missing for program ".concat(r.name));if(!t){b.value=!0,console.log("Validation Failed: Not all dates selected.");return}console.log("Validation Passed! Ready to refer patient with data:",h.value),v("referralDataReady",h.value),await L(h.value,g)},g=async i=>{try{const t=pe.getUserID(),r=pe.getPatientID(),P=new ze(r,t);await P.createEncounter();const V=i.map(W=>({concept_id:2227,value_numeric:W.programId,obs_datetime:ie.sessionDate(),child:[{concept_id:11242,value_text:ie.toStandardHisFormat(W.date),obs_datetime:ie.sessionDate()}]}));await P.saveObservationList(V),Oe("Patient referral saved successfully"),x()}catch(t){Z("Error saving referral data. Please try again.",4e3),console.error("Error in sub_refferal_data:",t)}},A=()=>{x()};function x(i={dataSaved:!0}){v("dataSaved",i)}const C=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:s},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:A}],O=(i,t,r)=>{v("programDateSelected",{programId:t,programName:r,date:i}),b.value=!1;const P=h.value.findIndex(W=>W.programId===t),V={programId:t,programName:r,date:i};P>-1?h.value[P]=V:h.value.push(V)};async function B(i){D.value=i,H(),b.value=!1,await F()}function H(){const i=[];D.value.forEach(r=>{r.selected==!0&&i.push(r.other)});const t=i.map(r=>r.program_id);I.value=I.value.filter(r=>t.includes(r.id)),h.value=h.value.filter(r=>t.includes(r.programId)),i.forEach(r=>{I.value.some(P=>P.id===r.program_id)||I.value.push({id:r.program_id,name:r.name,dates:[],dateSelectorRef:null})}),n[0].show_error.value=i.length===0}const F=async()=>{const i=I.value.map(async t=>{try{const r=w.getAvailableDatesByProgramId(t.id,90,!0,4);t.dates=r}catch(r){console.error("Error fetching dates for program ".concat(t.name,":"),r),t.dates=[]}});await Promise.all(i)};async function q(){const i=S.value.program_id,t=await Te.getAllPrograms(),r=[];t.forEach(P=>{P.program_id!==i&&r.push({name:P.name,other:P,selected:!1})}),D.value=r}const L=async(i,t)=>{Re($e,{class:"otherVitalsModal"},!0,{message:"Are you sure you want to add this Referral(s)?"},{cancel:W=>{},confirm:async W=>{W.detail==!0&&await t(i)}})};return ee(async()=>{await q(),xe()}),(i,t)=>(_(),y(e(te),null,{default:a(()=>[o(e(oe),null,{default:a(()=>[o(e(le),null,{default:a(()=>[...t[0]||(t[0]=[N("Refer to another clinic",-1)])]),_:1})]),_:1}),o(e(se),null,{default:a(()=>[o(e(R),null,{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-left":"0px","margin-top":"0px",color:"grey"}},{default:a(()=>[...t[1]||(t[1]=[N(" Program(s)",-1),U("span",{style:{color:"#b42318"}},"*",-1)])]),_:1}),o(Ee,{multiSelection:n[0].multi_Selection,show_label:n[0].show_list_label,uniqueId:n[0].unqueId,name_of_list:n[0].name_of_list,choose_place_holder:n[0].placeHolder,"items_-list":D.value,use_internal_filter:n[0].use_internal_filter,disabled:n[0].disabled.value,onItemListUpDated:n[0].listUpdatedFN,onItemListFiltered:n[0].listFilteredFN,onItemSearchText:n[0].searchTextFN},null,8,["multiSelection","show_label","uniqueId","name_of_list","choose_place_holder","items_-list","use_internal_filter","disabled","onItemListUpDated","onItemListFiltered","onItemSearchText"]),U("div",null,[n[0].show_error.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[N(T(n[0].error_message),1)]),_:1})):k("",!0)])]),_:1})]),_:1}),(_(!0),J(ae,null,fe(I.value,(r,P)=>(_(),y(e(R),{key:r.id},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{style:{margin:"10px","margin-top":"20px","font-weight":"bold",display:"block"}},{default:a(()=>[t[2]||(t[2]=U("span",{style:{color:"gray"}},"Available Dates for:",-1)),N(" "+T(r.name),1)]),_:2},1024),o(ra,{availableDates:r.dates,onDateSelected:V=>O(V,r.id,r.name),ref_for:!0,ref:V=>{V&&(r.dateSelectorRef=V)}},null,8,["availableDates","onDateSelected"])]),_:2},1024)]),_:2},1024))),128)),b.value?(_(),y(e(R),{key:0,style:{"margin-top":"-10px"}},{default:a(()=>[o(e($),null,{default:a(()=>[o(e(M),{class:"error-label"},{default:a(()=>[...t[3]||(t[3]=[N(" ⚠️ Please select an available date for all selected programs. ",-1)])]),_:1})]),_:1})]),_:1})):k("",!0),o(e(R),{class:"action-buttons"},{default:a(()=>[o(e($),{class:"ion-text-end"},{default:a(()=>[C[1].addItemButton?(_(),y(j,{key:0,name:C[1].name,fill:C[1].btnFill,icon:e(re),"onClicked:btn":C[1].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0),I.value.length>0?(_(),y(j,{key:1,name:C[0].name,fill:C[0].btnFill,icon:e(ne),"onClicked:btn":C[0].fn},null,8,["name","fill","icon","onClicked:btn"])):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),da=Q(sa,[["__scopeId","data-v-721c6ae2"]]),ua={class:"dash_box"},ia={key:0,style:{"margin-top":"100px"}},ca=z({name:"xxxComponent"}),fa=z({...ca,setup(u){const f=l("No outcome created yet"),v=l(!1),D=l(!0),I=l(""),h=l(!0),p=l(!1),w=de(),S=Ie(()=>w.outcomes),b=l(!1),n=l(!1),s=l(!1),g=l(!1),A=l(!1),x=l(!1),C=l(),O=l(null),B=l(null),H=l(null),F=l(null),q=l(null),L=l(null),i=l([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1},{name:"Send to Another Clinic",selected:!1}]);function t(c){i.value.forEach(E=>{c.selected==!0&&(c.name==E.name||c.type==E.name)&&(I.value=E.name)})}ee(async()=>{P()}),X(()=>I.value,async c=>{b.value==!0?b.value=!1:G()}),X(()=>S.value.length,async c=>{P()});function r(){i.value.forEach(c=>{c.selected=!1}),I.value=""}function P(){S.value.length>0?h.value=!1:S.value.length==0&&p.value==!1&&(h.value=!0)}function V(c){S.value.splice(c,1)}const W=c=>{V(c.index),t(c.item),O.value=c.item.other.location_data,B.value={reason:c.item.reason,date:c.item.date,time:c.item.time},H.value=c.item.other,F.value=c.item,c.item.type==="Discharged Home"&&(q.value=c.item,L.value={reason:c.item.reason,date:c.item.date})};async function G(c=!0){const E=I.value;I.value=E;const K=I.value;K==i.value[0].name?s.value=!0:s.value=!1,K==i.value[1].name?g.value=!0:g.value=!1,K==i.value[2].name?A.value=!0:A.value=!1,K==i.value[3].name?x.value=!0:x.value=!1}function m(){n.value=!1,s.value=!1,A.value=!1,g.value=!1,r()}const d=c=>{i.value.forEach(E=>{E.selected=!1}),C.value=c,C.value.selected=!0,t(C.value)};return(c,E)=>{const K=Y("ion-row");return _(),y(e(ke),null,{default:a(()=>[o(K,null,{default:a(()=>[o(e($),null,{default:a(()=>[(_(),y(We,{key:0,"onUpdate:removeItem":V,"onUpdate:editItem":W,displayData:S.value},null,8,["displayData"]))]),_:1})]),_:1}),h.value?(_(),y(K,{key:0},{default:a(()=>[U("span",ua,T(f.value),1)]),_:1})):k("",!0),o(K,null,{default:a(()=>[o(e($),null,{default:a(()=>[D.value?(_(),J("div",ia,[o(K,null,{default:a(()=>[o(e(ve),{modelValue:C.value,"onUpdate:modelValue":[E[0]||(E[0]=ue=>C.value=ue),E[1]||(E[1]=ue=>d(ue))],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:i.value},null,8,["modelValue","options"]),U("div",null,[v.value?(_(),y(e(M),{key:0,class:"error-label"},{default:a(()=>[...E[2]||(E[2]=[N(T("please select a type"),-1)])]),_:1})):k("",!0)])]),_:1})])):k("",!0)]),_:1})]),_:1}),s.value?(_(),y(Je,{key:1,onDataSaved:m,selected_ward_prop:H.value,admitted_other_props:F.value},null,8,["selected_ward_prop","admitted_other_props"])):k("",!0),g.value?(_(),y(Ye,{key:2,onDataSaved:m,selected_referral_data:O.value,selected_other_referral_data:B.value},null,8,["selected_referral_data","selected_other_referral_data"])):k("",!0),A.value?(_(),y(aa,{key:3,onDataSaved:m,selected_discharged_prop:q.value,selected_discharged_data:L.value},null,8,["selected_discharged_prop","selected_discharged_data"])):k("",!0),x.value?(_(),y(da,{key:4,onDataSaved:m})):k("",!0)]),_:1})}}}),va=Q(fa,[["__scopeId","data-v-2873182f"]]);export{Je as A,We as D,va as O,Ye as R,ye as _,aa as a,da as b};
