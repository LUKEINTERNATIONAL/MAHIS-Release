import{dR as Ne,dS as Fe,d as te,r as w,w as P,a as ie,O as Q,f as g,u as e,bi as Ee,J as o,l as a,I as Me,G as ve,E as Ae,Q as I,K as S,a_ as pe,N as V,L as N,a3 as Pe,a4 as ue,k as y,e as U,m as b,$ as T,p as C,b2 as ee,X as q,a1 as xe,a0 as ge,bq as he,F as K,P as ne,br as _e,bt as Be,M as be,c as ae,aS as Oe,aR as Te,dN as $e,aQ as Re,ct as De,cW as Ve,df as ye,bv as qe,cf as Le,cF as ze,aP as je,dT as Ge,dU as He,dV as Ye,dW as Je,dX as Qe,dY as We,dZ as Xe,d_ as Ze,ap as Ke,cr as J,U as Ue,a6 as re,bA as ea,d$ as aa,a5 as we,d8 as ta,d9 as oe,cD as sa,a7 as la}from"./vendor-Cz4Jol8q.js";import{N as ra}from"./NavigationMenu-DNYgOMXt.js";import{E as oa}from"./EIRreportsStore-vAKRB_GI.js";import{B as na}from"./bottomNavBar-BvtXPAz6.js";import{a8 as ia,av as Se,U as ke,aw as ua,G as da,H as ca,v as Z,_ as de,ax as Ie}from"./index-CabMHQ-Y.js";import"./lodash-Dt8AsbQm.js";import"./apexcharts-Qw5Ia0w3.js";function ma(){const F=()=>{const p="0123456789ABCDEF";let u="";for(let m=0;m<6;m++)u+=p[Math.floor(Math.random()*16)];return u};return{getAvatarUrl:(p,u=128)=>{const m="".concat(p),_=Ne(Fe,{seed:m,size:u,backgroundColor:[F()]}).toString(),A=unescape(encodeURIComponent(_));return"data:image/svg+xml;base64,".concat(btoa(A))}}}const fa=()=>{const F="programs",x=Se;async function p(m){const v=await x.getAll(F,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve programs.")}async function u(){const m=await ia.getAllPrograms(),v=[];return m.forEach(_=>{v.push({name:_.name,other:_,selected:!1})}),m}return{getPrograms:p,getEMRPrograms:u}},va=fa(),pa=()=>{const F="roles",x=Se;async function p(m){const v=await x.getAll(F,m);if(v!=null&&v.ok)return await v.json();throw new Error("Failed to retrieve user roles.")}async function u(){return await ke.getAllRoles()}return{getUserRoles:p,getEMRUserRoles:u}},ga=pa(),ha={key:0,class:"error-message"},_a={key:1,class:"error-message"},ya={key:2,class:"error-message"},Ua={key:3,class:"error-message"},wa={key:5,class:"error-message"},Ia={key:0,class:"error-message"},Ca={style:{display:"flex",gap:"20px","margin-top":"8px"}},ba={key:6,class:"error-message"},Sa={key:7,class:"error-message"},ka={key:8,class:"error-message"},Na={class:"form_el"},Ce=36,Fa=te({__name:"UserFormModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["save","close"],setup(F,{emit:x}){const p=F,u=x,m=w(!1),v=w(null),_=w([]),A=w({}),E=w(),s=w({name:!1,firstName:!1,lastName:!1,password:!1,dateOfBirth:!1,gender:!1,roles:!1,programs:!1,usernameExists:!1}),n=w({name:"",firstName:"",lastName:"",password:"",gender:"",roles:[],programs:[]}),M=w([]),O=w([]);function L(l){const i=l.value.formattedDate;E.value=ca.toStandardHisFormat(i),s.value.dateOfBirth=!1}function B(){v.value?m.value=!1:m.value=!0}const z=l=>{v.value=l.selected_location,B()},$=()=>{n.value={name:"",firstName:"",lastName:"",password:"",dateOfBirth:"",gender:"",facility:null,roles:[],programs:[]},E.value=null,v.value=null,A.value={},m.value=!1,Object.keys(s.value).forEach(l=>{s.value[l]=!1})},R=()=>{var i;s.value.name=!1,s.value.firstName=!1,s.value.lastName=!1,s.value.password=!1,s.value.dateOfBirth=!1,s.value.gender=!1,s.value.roles=!1,s.value.programs=!1;let l=!0;return n.value.name.trim()||(s.value.name=!0,l=!1),n.value.firstName.trim()||(s.value.firstName=!0,l=!1),n.value.lastName.trim()||(s.value.lastName=!0,l=!1),!p.editingUser&&!((i=n.value.password)!=null&&i.trim())&&(s.value.password=!0,l=!1),E.value||(s.value.dateOfBirth=!0,l=!1),n.value.gender||(s.value.gender=!0,l=!1),n.value.roles.length||(s.value.roles=!0,l=!1),n.value.programs.length||(s.value.programs=!0,l=!1),l},D=()=>{if(!p.editingUser){const l=M.value.find(i=>i.program_id===Ce);l&&(n.value.programs=[l.name],s.value.programs=!1)}},W=async()=>{try{const f=(await va.getEMRPrograms()).filter(k=>k.program_id===Ce);M.value=f.map(k=>({program_id:k.program_id,name:k.name})),D()}catch(l){console.error("Failed to fetch programs:",l),Z("Failed to load programs.")}},j=async()=>{try{const i=await ga.getUserRoles();O.value=i.map(f=>f.name)}catch(l){Z("Failed to load roles.")}},G=async l=>{const i=p.editingUser?p.editingUser.name!==l:!0;if(!l.trim()||!i)return s.value.usernameExists=!1,!0;try{const k=(await ke.doesUsernameExist(l)).exists===!0;return s.value.usernameExists=k,!k}catch(f){return console.error("Error checking username existence:",f),Z("Failed to verify username availability. Proceeding with caution."),s.value.usernameExists=!1,!0}};P(()=>n.value.name,async l=>{l.trim()?(s.value.name=!1,await G(l)):(s.value.name=!0,s.value.usernameExists=!1)}),P(()=>n.value.firstName,()=>{n.value.firstName.trim()&&(s.value.firstName=!1)}),P(()=>n.value.lastName,()=>{n.value.lastName.trim()&&(s.value.lastName=!1)}),P(()=>n.value.password,()=>{var l;(l=n.value.password)!=null&&l.trim()&&(s.value.password=!1)}),P(()=>n.value.gender,()=>{n.value.gender&&(s.value.gender=!1)}),P(()=>n.value.roles,()=>{n.value.roles.length>0&&(s.value.roles=!1)}),P(()=>n.value.programs,()=>{n.value.programs.length>0&&(s.value.programs=!1)}),P(()=>p.editingUser,l=>{if(l){const i=l.name.split(" "),f=i[0]||"",k=i.length>1?i.slice(1).join(" "):"";n.value={name:l.name,firstName:f,lastName:k,dateOfBirth:l.dateOfBirth||"",gender:l.gender||"",facility:l.facility||null,roles:l.roles,programs:l.programs},l.dateOfBirth&&(E.value=l.dateOfBirth),l.facility&&(v.value=l.facility,A.value=l.facility)}else $(),D()},{immediate:!0}),P(()=>p.isOpen,l=>{l&&!p.editingUser&&($(),D())});const d=async()=>{const l=R();B();const i=await G(n.value.name);if(!l||m.value||!i){!l||m.value?Z("Please fill out all required fields."):i||Z("The chosen username is already taken.");return}const f=n.value.programs.map(X=>{const se=M.value.find(t=>t.name===X);return se?se.program_id:null}).filter(X=>X!==null),k={...n.value,dateOfBirth:E.value,facility:v.value,programIDs:f};u("save",k)},H=()=>{u("close")};return ie(()=>{$(),W(),j()}),(l,i)=>(g(),Q(e(Ee),{"is-open":l.isOpen,onDidDismiss:H},{default:o(()=>[a(e(Me),null,{default:o(()=>[a(e(ve),null,{default:o(()=>[a(e(Ae),null,{default:o(()=>[I(S(l.editingUser?"Edit User":"Add New User"),1)]),_:1}),a(e(pe),{slot:"end"},{default:o(()=>[a(e(V),{onClick:H,fill:"clear"},{default:o(()=>[a(e(N),{style:{"font-size":"35px"},icon:e(Pe)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ue),{class:"ion-padding"},{default:o(()=>[y("form",{id:"user-form",onSubmit:Be(d,["prevent"])},[a(e(T),{class:C({"error-item":s.value.name||s.value.usernameExists})},{default:o(()=>[a(e(ee),{modelValue:n.value.name,"onUpdate:modelValue":i[0]||(i[0]=f=>n.value.name=f),label:"Username","label-placement":"stacked",placeholder:"Enter username",required:"",class:C({"error-input":s.value.name||s.value.usernameExists})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.name?(g(),U("div",ha," Username is required ")):s.value.usernameExists?(g(),U("div",_a," This username is already taken. ")):b("",!0),a(e(T),{class:C({"error-item":s.value.firstName})},{default:o(()=>[a(e(ee),{modelValue:n.value.firstName,"onUpdate:modelValue":i[1]||(i[1]=f=>n.value.firstName=f),label:"First Name","label-placement":"stacked",placeholder:"Enter first name",required:"",class:C({"error-input":s.value.firstName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.firstName?(g(),U("div",ya," First name is required ")):b("",!0),a(e(T),{class:C({"error-item":s.value.lastName})},{default:o(()=>[a(e(ee),{modelValue:n.value.lastName,"onUpdate:modelValue":i[2]||(i[2]=f=>n.value.lastName=f),label:"Last Name","label-placement":"stacked",placeholder:"Enter last name",required:"",class:C({"error-input":s.value.lastName})},null,8,["modelValue","class"])]),_:1},8,["class"]),s.value.lastName?(g(),U("div",Ua," Last name is required ")):b("",!0),l.editingUser?b("",!0):(g(),Q(e(T),{key:4,class:C({"error-item":s.value.password})},{default:o(()=>[a(e(ee),{modelValue:n.value.password,"onUpdate:modelValue":i[3]||(i[3]=f=>n.value.password=f),label:"Password","label-placement":"stacked",placeholder:"Enter password",type:"password",required:"",class:C({"error-input":s.value.password})},null,8,["modelValue","class"])]),_:1},8,["class"])),s.value.password&&!l.editingUser?(g(),U("div",wa," Password is required ")):b("",!0),y("div",{class:C(["form_el",{"error-section":s.value.dateOfBirth}])},[y("h6",{style:{"font-size":"16px","font-weight":"400"},class:C({"error-label":s.value.dateOfBirth})}," Date Of Birth ",2),a(ua,{place_holder:"Date Of Birth",onDateUpDated:L,date_prop:""}),s.value.dateOfBirth?(g(),U("div",Ia," Date of birth is required ")):b("",!0)],2),a(e(T),{class:C({"error-item":s.value.gender})},{default:o(()=>[a(e(q),{position:"stacked",class:C({"error-label":s.value.gender})},{default:o(()=>i[7]||(i[7]=[I("Gender")])),_:1,__:[7]},8,["class"]),a(e(xe),{modelValue:n.value.gender,"onUpdate:modelValue":i[4]||(i[4]=f=>n.value.gender=f)},{default:o(()=>[y("div",Ca,[a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:o(()=>[a(e(ge),{slot:"start",value:"male"}),a(e(q),null,{default:o(()=>i[8]||(i[8]=[I("Male")])),_:1,__:[8]})]),_:1}),a(e(T),{lines:"none",style:{"--padding-start":"0"}},{default:o(()=>[a(e(ge),{slot:"start",value:"female"}),a(e(q),null,{default:o(()=>i[9]||(i[9]=[I("Female")])),_:1,__:[9]})]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["class"]),s.value.gender?(g(),U("div",ba," Gender is required ")):b("",!0),a(e(T),{class:C({"error-item":s.value.roles})},{default:o(()=>[a(e(he),{modelValue:n.value.roles,"onUpdate:modelValue":i[5]||(i[5]=f=>n.value.roles=f),label:"Roles","label-placement":"stacked",placeholder:"Select roles",multiple:"",class:C({"error-input":s.value.roles})},{default:o(()=>[(g(!0),U(K,null,ne(O.value,f=>(g(),Q(e(_e),{key:f,value:f},{default:o(()=>[I(S(f),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.roles?(g(),U("div",Sa," At least one role is required ")):b("",!0),a(e(T),{class:C({"error-item":s.value.programs})},{default:o(()=>[a(e(he),{modelValue:n.value.programs,"onUpdate:modelValue":i[6]||(i[6]=f=>n.value.programs=f),label:"Programs","label-placement":"stacked",placeholder:"Select programs",multiple:"",class:C({"error-input":s.value.programs})},{default:o(()=>[(g(!0),U(K,null,ne(M.value,f=>(g(),Q(e(_e),{key:f.id,value:f.name},{default:o(()=>[I(S(f.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["class"]),s.value.programs?(g(),U("div",ka," At least one program is required ")):b("",!0),y("div",Na,[i[10]||(i[10]=y("h6",{style:{"font-size":"16px","font-weight":"400"}},"Facility",-1)),a(da,{show_error:m.value,onFacilitySelected:z,selected_district_ids:_.value,selected_location:A.value},null,8,["show_error","selected_district_ids","selected_location"])])],32)]),_:1}),a(e(be),null,{default:o(()=>[a(e(ve),null,{default:o(()=>[a(e(pe),{slot:"end"},{default:o(()=>[y("div",null,[a(e(V),{onClick:H,fill:"solid"},{default:o(()=>i[11]||(i[11]=[I(" Cancel ")])),_:1,__:[11]}),a(e(V),{onClick:d,fill:"solid",style:{"margin-left":"10px","margin-right":"10px"}},{default:o(()=>[I(S(l.editingUser?"Update":"Create")+" User ",1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["is-open"]))}}),Ea=de(Fa,[["__scopeId","data-v-1e565356"]]),Ma={class:"users-grid"},Aa={class:"user-header"},Pa=["src","alt"],xa={class:"user-info"},Ba={key:0,class:"user-meta"},Oa={key:0,class:"meta-item"},Ta={key:1,class:"meta-item"},$a={class:"user-details"},Ra={key:0,class:"detail-item"},Da={key:1,class:"detail-item"},Va={key:2,class:"detail-item"},qa={class:"detail-item"},La={class:"detail-item"},za={class:"action-buttons"},ja={key:0,class:"empty-state"},Ga=te({__name:"miUsersTemplate",props:{initialSearchTerm:{default:""},initialStatusFilter:{default:"all"},initialItemsPerPage:{default:6},enableSearch:{type:Boolean,default:!0},enableStatusFilter:{type:Boolean,default:!0},enablePagination:{type:Boolean,default:!0},searchPlaceholder:{default:"Search users..."},searchDebounceTime:{default:300}},emits:["search-changed","status-filter-changed","users-filtered","user-edited","user-deleted","user-status-changed","user-created"],setup(F,{expose:x,emit:p}){const u=F,m=p,v=w([]),_=w(u.initialSearchTerm),A=w(u.initialStatusFilter),E=w(1),s=w(u.initialItemsPerPage),n=w(!1),M=w(null);let O=null;const L=t=>{var r,h,Y,ce,me,fe;const{getAvatarUrl:c}=ma();return{id:t.id,name:t.username,email:t.username,dateOfBirth:(r=t.profile)==null?void 0:r.dateOfBirth,gender:(h=t.profile)==null?void 0:h.gender,facility:(ce=(Y=t.facilities)==null?void 0:Y[0])!=null&&ce.facility?{name:t.facilities[0].facility.facility_name,code:t.facilities[0].facility.facility_code}:null,roles:((me=t.roles)==null?void 0:me.map(le=>le.role.name))||[],programs:((fe=t.programs)==null?void 0:fe.map(le=>le.program.name))||[],status:"active",avatar:c(t.username),createdAt:new Date(t.createdAt),lastActive:new Date(t.updatedAt)}},B=ae(()=>{let t=v.value;if(u.enableSearch&&_.value){const c=_.value.toLowerCase();t=t.filter(r=>r.name.toLowerCase().includes(c)||r.email.toLowerCase().includes(c)||r.roles&&r.roles.some(h=>h.toLowerCase().includes(c))||r.programs&&r.programs.some(h=>h.toLowerCase().includes(c))||r.gender&&r.gender.toLowerCase().includes(c)||r.facility&&r.facility.name&&r.facility.name.toLowerCase().includes(c))}return u.enableStatusFilter&&A.value!=="all"&&(t=t.filter(c=>c.status===A.value)),t}),z=ae(()=>{if(!u.enablePagination)return B.value;const t=(E.value-1)*s.value,c=t+s.value;return B.value.slice(t,c)});P(()=>_.value,t=>{O&&clearTimeout(O),O=setTimeout(()=>{m("search-changed",t),E.value=1},u.searchDebounceTime)},{immediate:!1}),P(()=>A.value,t=>{m("status-filter-changed",t),E.value=1},{immediate:!1}),P(()=>B.value,t=>{m("users-filtered",t)},{deep:!0,immediate:!0});const $=t=>{E.value=t.page,s.value=t.itemsPerPage},R=t=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t),D=t=>{const c=new Date,r=new Date(t);let h=c.getFullYear()-r.getFullYear();const Y=c.getMonth()-r.getMonth();return(Y<0||Y===0&&c.getDate()<r.getDate())&&h--,h},W=t=>{M.value=t,n.value=!0},j=()=>{n.value=!1,M.value=null},G=async t=>{try{if(M.value){const c=v.value.findIndex(h=>h.id===M.value.id);if(c!==-1){const h={...v.value[c],...t};v.value[c]=h,m("user-edited",h)}(await J.create({message:"User updated successfully",duration:2e3,color:"success"})).present()}else{const c=await d(t),r=await Ie.register(c),h=L(r);h&&(v.value.push(h),m("user-created",h),(await J.create({message:"User created successfully",duration:2e3,color:"success"})).present())}j()}catch(c){(await J.create({message:"Error saving user: ".concat(c),duration:2e3,color:"danger"})).present()}},d=async t=>{if(!t||!t.facility)throw new Error("Invalid user data. 'facility' is required.");return{username:t.name,password:t.password,roles:t.roles,programs:t.programs,programIds:t.programIDs,facilities:[t.facility.code],profile:{firstName:t.firstName,lastName:t.lastName,gender:t.gender,dateOfBirth:"1990-01-01T00:00:00.000Z"}}},H=async t=>{(await Ue.create({header:"Confirm Status Change",message:"Are you sure you want to ".concat(t.status==="active"?"deactivate":"activate"," ").concat(t.name,"?"),buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",handler:()=>{t.status=t.status==="active"?"inactive":"active",m("user-status-changed",t),J.create({message:"User ".concat(t.status==="active"?"activated":"deactivated"," successfully"),duration:2e3,color:"success"}).then(r=>r.present())}}]})).present()},l=async t=>{(await Ue.create({header:"Confirm Delete",message:"Are you sure you want to delete ".concat(t.name,"? This action cannot be undone."),buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{const r=v.value.findIndex(h=>h.id===t.id);r!==-1&&(v.value.splice(r,1),m("user-deleted",t.id),J.create({message:"User deleted successfully",duration:2e3,color:"success"}).then(h=>h.present()))}}]})).present()},i=t=>{_.value=t},f=t=>{A.value=t},k=async()=>{try{const t=await Ie.getUsers();v.value=t.map(L)}catch(t){console.error("Failed to fetch MIUM users:",t),J.create({message:"Failed to load users.",duration:2e3,color:"danger"}).then(c=>c.present())}},X=()=>{M.value=null,n.value=!0};return ie(async()=>{await k()}),x({setSearchTerm:i,setStatusFilter:f,refreshUsers:k,cleanup:()=>{O&&clearTimeout(O)},openAddUserModal:X,users:v.value,filteredUsers:B,paginatedUsers:z}),(t,c)=>(g(),U(K,null,[a(e(ue),{class:"ion-padding",style:{height:"80vh"}},{default:o(()=>[y("div",Ma,[(g(!0),U(K,null,ne(z.value,r=>(g(),Q(e(Oe),{key:r.id,class:"user-card"},{default:o(()=>[a(e(Te),null,{default:o(()=>[y("div",Aa,[a(e($e),null,{default:o(()=>[y("img",{src:r.avatar,alt:r.name},null,8,Pa)]),_:2},1024),y("div",xa,[a(e(Re),null,{default:o(()=>[I(S(r.name),1)]),_:2},1024),a(e(De),null,{default:o(()=>[I(S(r.email),1)]),_:2},1024),r.gender||r.dateOfBirth?(g(),U("div",Ba,[r.gender?(g(),U("span",Oa,[a(e(N),{icon:e(Ve),class:"meta-icon"},null,8,["icon"]),I(" "+S(r.gender),1)])):b("",!0),r.dateOfBirth?(g(),U("span",Ta,[a(e(N),{icon:e(ye),class:"meta-icon"},null,8,["icon"]),I(" "+S(D(r.dateOfBirth))+" years old ",1)])):b("",!0)])):b("",!0)]),a(e(qe),{color:r.status==="active"?"success":"medium",class:"status-chip"},{default:o(()=>[a(e(N),{icon:r.status==="active"?e(Le):e(ze),slot:"start"},null,8,["icon"]),a(e(q),null,{default:o(()=>[I(S(r.status),1)]),_:2},1024)]),_:2},1032,["color"])])]),_:2},1024),a(e(je),null,{default:o(()=>[y("div",$a,[r.roles&&r.roles.length?(g(),U("div",Ra,[a(e(N),{icon:e(Ge),class:"detail-icon"},null,8,["icon"]),y("span",null,S(r.roles.join(", ")),1)])):b("",!0),r.programs&&r.programs.length?(g(),U("div",Da,[a(e(N),{icon:e(He),class:"detail-icon"},null,8,["icon"]),y("span",null,S(r.programs.join(", ")),1)])):b("",!0),r.facility?(g(),U("div",Va,[a(e(N),{icon:e(Ye),class:"detail-icon"},null,8,["icon"]),y("span",null,S(r.facility.name||"Assigned Facility"),1)])):b("",!0),y("div",qa,[a(e(N),{icon:e(ye),class:"detail-icon"},null,8,["icon"]),y("span",null,"Joined "+S(R(r.createdAt)),1)]),y("div",La,[a(e(N),{icon:e(Je),class:"detail-icon"},null,8,["icon"]),y("span",null,"Last active "+S(R(r.lastActive)),1)])]),y("div",za,[a(e(V),{onClick:h=>W(r),fill:"outline",size:"small",color:"primary"},{default:o(()=>[a(e(N),{icon:e(Qe),slot:"start"},null,8,["icon"]),c[0]||(c[0]=I(" Edit "))]),_:2,__:[0]},1032,["onClick"]),a(e(V),{onClick:h=>H(r),fill:"outline",size:"small",color:r.status==="active"?"warning":"success"},{default:o(()=>[a(e(N),{icon:r.status==="active"?e(We):e(Xe),slot:"start"},null,8,["icon"]),I(" "+S(r.status==="active"?"Deactivate":"Activate"),1)]),_:2},1032,["onClick","color"]),a(e(V),{onClick:h=>l(r),fill:"outline",size:"small",color:"danger"},{default:o(()=>[a(e(N),{icon:e(Ze),slot:"start"},null,8,["icon"]),c[1]||(c[1]=I(" Delete "))]),_:2,__:[1]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),B.value.length===0?(g(),U("div",ja,[a(e(N),{icon:e(Ke),class:"empty-icon"},null,8,["icon"]),c[2]||(c[2]=y("h3",null,"No users found",-1)),c[3]||(c[3]=y("p",null,"Try adjusting your search or filter criteria",-1))])):b("",!0)]),_:1}),a(e(be),null,{default:o(()=>[a(na,{"total-items":B.value.length,"current-page":E.value,"items-per-page":s.value,"onUpdate:pagination":$},null,8,["total-items","current-page","items-per-page"])]),_:1}),a(Ea,{"is-open":n.value,"editing-user":M.value,onSave:G,onClose:j},null,8,["is-open","editing-user"])],64))}}),Ha=de(Ga,[["__scopeId","data-v-8f4430d8"]]),Ya=te({__name:"UserNav",props:{searchTerm:{type:String,required:!0},statusFilter:{type:String,required:!0}},emits:["update:searchTerm","update:statusFilter","openAddUserModal"],setup(F,{emit:x}){return(p,u)=>(g(),U(K,null,[a(e(we),{class:"ion-align-items-center"},{default:o(()=>[a(e(re),{size:"8"},{default:o(()=>[a(e(ea),{value:F.searchTerm,onIonInput:u[0]||(u[0]=m=>p.$emit("update:searchTerm",m.detail.value)),placeholder:"Search users...","show-clear-button":"focus",debounce:"300"},null,8,["value"])]),_:1}),a(e(re),{size:"4",class:"ion-text-right"},{default:o(()=>[a(e(V),{onClick:u[1]||(u[1]=m=>p.$emit("openAddUserModal")),fill:"solid"},{default:o(()=>[a(e(N),{icon:e(aa),slot:"start"},null,8,["icon"]),u[3]||(u[3]=I(" Add User "))]),_:1,__:[3]})]),_:1})]),_:1}),a(e(we),{class:"ion-padding-start ion-padding-end"},{default:o(()=>[a(e(re),{size:"12"},{default:o(()=>[a(e(ta),{value:F.statusFilter,onIonChange:u[2]||(u[2]=m=>p.$emit("update:statusFilter",m.detail.value))},{default:o(()=>[a(e(oe),{value:"all"},{default:o(()=>[a(e(q),null,{default:o(()=>u[4]||(u[4]=[I("All")])),_:1,__:[4]})]),_:1}),a(e(oe),{value:"active"},{default:o(()=>[a(e(q),null,{default:o(()=>u[5]||(u[5]=[I("Active")])),_:1,__:[5]})]),_:1}),a(e(oe),{value:"inactive"},{default:o(()=>[a(e(q),null,{default:o(()=>u[6]||(u[6]=[I("Inactive")])),_:1,__:[6]})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})],64))}}),Ja={class:"sticky-user-nav"},Qa=te({__name:"miusers",setup(F,{expose:x}){const p=w(""),u=w("all"),m=w([]),v=w(0),_=w();ae(()=>p.value),ae(()=>u.value);const A=d=>{p.value=d,console.log("Search term updated:",d)},E=d=>{u.value=d,console.log("Status filter updated:",d)},s=d=>{p.value!==d&&(p.value=d),console.log("Internal search changed:",d)},n=d=>{u.value!==d&&(u.value=d),console.log("Internal filter changed:",d)},M=d=>{v.value=d.length},O=d=>{console.log("User created:",d)},L=d=>{console.log("User edited:",d)},B=d=>{console.log("User deleted:",d)},z=d=>{console.log("User status changed:",d)},$=()=>{_.value?_.value.openAddUserModal():console.log("usersTemplateRef is not yet available.")},R=async()=>{try{console.log("Loading users...")}catch(d){console.error("Error loading users:",d)}},D=async()=>{oa().setNavigationPayload("Manage Integrated Users",!0,!1,"/","home","")},W=()=>{_.value&&_.value.refreshUsers(),R()},j=d=>{p.value=d,_.value&&_.value.setSearchTerm(d)},G=d=>{u.value=d,_.value&&_.value.setStatusFilter(d)};return ie(async()=>{await D(),await R()}),sa(()=>{_.value&&typeof _.value.cleanup=="function"&&_.value.cleanup()}),x({refreshUsers:W,setSearch:j,setFilter:G,searchTerm:p,statusFilter:u,usersList:m,filteredUsersCount:v}),(d,H)=>(g(),Q(e(la),null,{default:o(()=>[a(ra),a(e(ue),{fullscreen:!0},{default:o(()=>[y("div",Ja,[a(Ya,{fullscreen:!0,searchTerm:p.value,statusFilter:u.value,"onUpdate:searchTerm":A,"onUpdate:statusFilter":E,onOpenAddUserModal:$},null,8,["searchTerm","statusFilter"])]),a(Ha,{ref_key:"usersTemplateRef",ref:_,"initial-users":m.value,"initial-search-term":p.value,"initial-status-filter":u.value,"search-debounce-time":500,"enable-search":!0,"enable-status-filter":!0,"enable-pagination":!0,onSearchChanged:s,onStatusFilterChanged:n,onUsersFiltered:M,onUserCreated:O,onUserEdited:L,onUserDeleted:B,onUserStatusChanged:z},null,8,["initial-users","initial-search-term","initial-status-filter"])]),_:1})]),_:1}))}}),st=de(Qa,[["__scopeId","data-v-5071b8a1"]]);export{st as default};
