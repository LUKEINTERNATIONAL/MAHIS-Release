const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./EmergencyRefill-C5KI5-7X.js","./vendor-BzS-GRGX.js","./lodash-Dt8AsbQm.js","./vendor-DbFgDcHS.css","./index-xmN8DORW.js","./index-D6REMbYN.css","./SelectFacility-6P3xWhl_.js","./SelectFacility-DSRLpBbj.css","./app_encounter_service-BLy4tvzY.js","./adherence_service-CL7CtIqv.js","./LocationFieldOptions-CWZ4QrJi.js","./EmergencyRefill-C5p0BOKy.css","./ARTPatientType-CQU1epOg.js","./patient_type_service-nOdFUE8B.js","./BasicRadioSelect-DmelF8wU.js","./BasicRadioSelect-DPSSyycU.css","./ARTPatientType-DokMITEU.css","./FilingNumberManagement-QQd3Xvc7.js","./FilingNumberManagement-UU0AGTHA.css","./ArtClinicRegistration-D7FRj_v_.js","./Staging-DXES7lDv.js","./BasicYesNoSelect-shKT8wd2.js","./BasicYesNoSelect-DGYtztsf.css","./Staging-T6Jlb5dR.css","./patient_registration_service-CFAH8qPh.js","./vitals_service-BRG3__5_.js","./ArtClinicRegistration--KIJsfKm.css","./Reception-CuzZT8O0.js","./relations_service-Bn-59oxu.js","./identifier_service-mpJ5VrrB.js","./Reception-C-kfxzen.css","./Vitals-B49sCyf_.js","./Vitals.vue_vue_type_script_setup_true_lang-Bi9bqOTO.js","./StandardForm.vue_vue_type_script_setup_true_lang-CeePT3_R.js","./StandardForm-BNcR9uev.css","./useVitals-bvhM3859.js","./SvgDynamicColor-Q4ht95M8.js","./SvgDynamicColor-B6V07T2v.css","./previousVitals-D-HJoxII.js","./apexcharts-C_xTRKVr.js","./previousVitals-BGyZoFyl.css","./encounter_type-DTeQY3C6.js","./ARTConsultation-B7O8xFWK.js","./prescription_service-CN87LLUE.js","./Arrays-CfBll-2n.js","./patient_lab_service-BOxBHrs2.js","./ARTConsultation-DOKtDOLI.css","./ARTAdherence-C3CatQ9G.js","./ARTAdherence-B8uvff9k.css","./Prescription-CKUBsp-I.js","./Prescription-eAcim8VQ.css","./ArtDispensation-B1OFeL_R.js","./ArtDispensation.vue_vue_type_script_setup_true_lang-B9LL9DAx.js","./ARTAppointment-DxrqGEl0.js","./appointment_service-CN-qRZ8n.js","./clinicalDaysStore-BCbmfDC-.js","./ARTAppointment-BIwX_dyU.css"])))=>i.map(i=>d[i]);
import{d as U,bQ as Y,b2 as q,au as G,r as d,w as Q,y as m,f as s,z as l,l as a,u as t,eu as Z,k as f,as as j,a9 as X,e as D,ac as ee,F as te,L as ne,G as oe,I as _,ev as ae,ew as re,eq as le,B as L,c7 as se,V as O,U as N,W as V,A,dK as ie,bK as ue,b0 as ce,aZ as pe,e6 as de,cs as me,dk as _e,c4 as ge,m as fe,ex as ve,af as be,bS as u,an as c}from"./vendor-BzS-GRGX.js";import{S as B,u as ye,T as Ie,aK as Te,l as De,_ as ke}from"./index-xmN8DORW.js";import"./lodash-Dt8AsbQm.js";class x extends B{constructor(){super()}static nextTask(v){return super.getJson("/workflows/".concat(super.getProgramID(),"/").concat(v),{date:super.getSessionDate()})}static async getNextTaskParams(v,E=""){let g=E;try{if(!g){const{name:b}=await x.nextTask(v);g=b}}catch(b){g=""}return{name:g.toLowerCase(),params:{patient_id:v}}}}const we={key:1,style:{"margin-top":"10%"},class:"ion-padding ion-text-center"},Pe={class:"ion-page",id:"main"},xe={key:0,class:"placeholder-content"},Ee={style:{margin:"0px auto"},class:"ion-text-center"},he={key:1},Ve={key:2,class:"ion-padding ion-text-center",style:{"margin-top":"15%"}},Ae=U({__name:"ARTVisit",setup(Ce){const v=Y(),E=ye(),{patient:g}=q(E),b=[{label:"Emergency Refill",enableForDebugging:!1,component:u(()=>c(()=>import("./EmergencyRefill-C5KI5-7X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url))},{encounterTypeID:5,userProp:"patient type",label:"Patient Type",enableForDebugging:!1,component:u(()=>c(()=>import("./ARTPatientType-CQU1epOg.js"),__vite__mapDeps([12,1,2,3,4,5,13,8,6,7,14,15,16]),import.meta.url))},{label:"Filing Number Management",enableForDebugging:!1,component:u(()=>c(()=>import("./FilingNumberManagement-QQd3Xvc7.js"),__vite__mapDeps([17,1,2,3,4,5,18]),import.meta.url))},{encounterTypeID:9,userProp:"HIV first visits",enableForDebugging:!1,label:"HIV Clinic Registration",component:u(()=>c(()=>import("./ArtClinicRegistration-D7FRj_v_.js"),__vite__mapDeps([19,8,4,1,2,3,5,10,6,7,20,21,22,23,24,25,14,15,26]),import.meta.url))},{encounterTypeID:51,userProp:"HIV reception visits",label:"Reception",enableForDebugging:!1,component:u(()=>c(()=>import("./Reception-CuzZT8O0.js"),__vite__mapDeps([27,1,2,3,4,5,8,28,24,29,21,22,13,30]),import.meta.url))},{encounterTypeID:6,otherWorkflowNames:["htn_vitals"],userProp:"vitals",label:"Vitals",enableForDebugging:!1,component:u(()=>c(()=>import("./Vitals-B49sCyf_.js"),__vite__mapDeps([31,32,33,1,2,3,4,5,34,35,36,37,38,39,40,41,8]),import.meta.url))},{encounterTypeID:52,userProp:"HIV staging visits",label:"Staging",enableForDebugging:!1,component:u(()=>c(()=>import("./Staging-DXES7lDv.js"),__vite__mapDeps([20,1,2,3,8,4,5,6,7,21,22,23]),import.meta.url))},{encounterTypeID:53,userProp:"HIV clinic consultations",label:"Consultation",enableForDebugging:!1,component:u(()=>c(()=>import("./ARTConsultation-B7O8xFWK.js").then(n=>n.b),__vite__mapDeps([42,1,2,3,4,5,43,8,21,22,14,15,44,13,6,7,45,39,46]),import.meta.url))},{encounterTypeID:68,userProp:"ART adherence",label:"ART Adherence",enableForDebugging:!1,component:u(()=>c(()=>import("./ARTAdherence-C3CatQ9G.js"),__vite__mapDeps([47,1,2,3,4,5,9,8,48]),import.meta.url))},{encounterTypeID:25,userProp:"Prescriptions",label:"Prescription",enableForDebugging:!1,component:u(()=>c(()=>import("./Prescription-CKUBsp-I.js"),__vite__mapDeps([49,1,2,3,43,8,4,5,44,13,50]),import.meta.url))},{encounterTypeID:54,userProp:"Drug Dispensations",label:"Dispense drugs",enableForDebugging:!1,component:u(()=>c(()=>import("./ArtDispensation-B1OFeL_R.js"),__vite__mapDeps([51,52,1,2,3,8,4,5]),import.meta.url))},{encounterTypeID:7,userProp:"Manage Appointments",label:"Appointment",enableForDebugging:!1,component:u(()=>c(()=>import("./ARTAppointment-DxrqGEl0.js"),__vite__mapDeps([53,4,1,2,3,5,54,8,55,56]),import.meta.url))}],C=G(),p=d(-1),k=d(null),r=d([]),R=d([]),y=d(!1),h=d(-1),w=d(""),I=d(""),S=d("");function W(n){var e;return R.value.includes((e=n==null?void 0:n.encounterTypeID)!=null?e:0)}function P(n){var e;return n.enableForDebugging?!0:n?!y.value&&h.value===(n==null?void 0:n.encounterTypeID)||((e=n==null?void 0:n.otherWorkflowNames)!=null?e:[]).includes(w.value):!1}function H(){if(r.value.length===0||p.value===r.value.length-1)return!1;const n=r.value[p.value];return n&&P(n)}async function $(){const n=await Te.getEncounters(g.value.patientID,{date:x.getSessionDate()});R.value=n.map(e=>e.encounter_type)}async function F(){var n;S.value="",y.value=!0,I.value="",w.value="";try{const e=await x.nextTask(g.value.patientID);if(!e){I.value="No workflows found. You may exit this page or refresh",y.value=!1,p.value=-1;return}w.value=e.name,h.value=(n=e==null?void 0:e.encounter_type_id)!=null?n:-1;const i=r.value.findIndex(o=>{var T;return(o==null?void 0:o.encounterTypeID)===h.value||((T=o.otherWorkflowNames)!=null?T:[]).includes(w.value)});if(i!==-1){S.value=e.description;const o=[...r.value.slice(i),...r.value.slice(0,i)];r.value=o,p.value=0}else I.value="Error loading workflow task",p.value=i}catch(e){I.value="An error has occured while loading next task: "+e,console.error(e)}finally{await $(),y.value=!1}}async function z(){p.value=-1,r.value=[];const n=await B.getJson("user_properties",{property:"activities"});try{if(!n.property_value){r.value=b;return}const e=n.property_value.split(",").map(i=>i.toLowerCase());r.value=b.filter(i=>{var o;return i.enableForDebugging||e.includes((o=i.userProp)==null?void 0:o.toLowerCase())})}catch(e){De("Unable to load activities"),console.error(e)}}function K(){return k.value&&typeof k.value.onSubmit=="function"?k.value.onSubmit():Promise.resolve(!0)}function M(){K().then(n=>n&&F())}function J(n){if(n<0||n>=r.value.length)return;const e=r.value[n];e&&P(e)&&(p.value=n)}return Q(()=>v.fullPath,()=>{z().then(F)},{immediate:!0,deep:!0}),(n,e)=>(s(),m(t(be),null,{default:l(()=>[a(Ie),a(t(Z),{style:{"margin-top":"70px"},when:"xs",contentId:"main"},{default:l(()=>{var i;return[a(t(j),{contentId:"main"},{default:l(()=>[a(t(X),null,{default:l(()=>[r.value.length>0?(s(),m(t(ee),{key:0},{default:l(()=>[(s(!0),D(te,null,ne(r.value,(o,T)=>(s(),m(t(oe),{onClick:Re=>J(T),lines:"none",key:T,disabled:!P(o),button:""},{default:l(()=>[W(o)?(s(),m(t(_),{key:0,icon:t(ae),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):P(o)?(s(),m(t(_),{key:2,icon:t(le),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):(s(),m(t(_),{key:1,icon:t(re),style:{padding:"10px"},slot:"start"},null,8,["icon"])),f("b",null,L(o.label),1)]),_:2},1032,["onClick","disabled"]))),128))]),_:1})):(s(),D("div",we,[a(t(_),{style:{"font-size":"2rem"},icon:t(se)},null,8,["icon"]),e[2]||(e[2]=f("h4",null,"You are not assigned to any activities",-1))]))]),_:1}),a(t(O),null,{default:l(()=>[a(t(N),{color:"light"},{default:l(()=>[a(t(V),{onClick:e[0]||(e[0]=o=>t(C).back())},{default:l(()=>[a(t(_),{icon:t(ie),slot:"start"},null,8,["icon"]),e[3]||(e[3]=A(" Back to dashboard "))]),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),f("div",Pe,[y.value?(s(),D("div",xe,[f("div",Ee,[a(t(ue),{name:"bubbles"}),e[4]||(e[4]=f("p",null,[f("h1",null,"Please wait...")],-1))])])):(i=r.value[p.value])!=null&&i.component?(s(),D("div",he,[a(t(ce),null,{default:l(()=>[a(t(pe),null,{default:l(()=>{var o;return[(s(),m(de,null,[(s(),m(me((o=r.value[p.value])==null?void 0:o.component),{ref_key:"formRef",ref:k},null,512))],1024))]}),_:1})]),_:1})])):(s(),D("div",Ve,[a(t(_),{style:{color:"green","font-size":"80px"},icon:t(_e)},null,8,["icon"]),f("h2",null,L(I.value),1),a(t(V),{size:"large",fill:"clear",onClick:e[1]||(e[1]=o=>t(C).back())},{default:l(()=>[a(t(_),{slot:"start",icon:t(ge)},null,8,["icon"]),e[5]||(e[5]=A(" Exit page "))]),_:1,__:[5]})])),a(t(O),null,{default:l(()=>[a(t(N),{color:"light"},{default:l(()=>[H()?(s(),m(t(V),{key:0,onClick:M,color:"primary",style:{padding:"4px"},slot:"end"},{default:l(()=>[e[6]||(e[6]=A(" Save and continue ")),a(t(_),{style:{padding:"4px"},icon:t(ve),slot:"end"},null,8,["icon"])]),_:1,__:[6]})):fe("",!0)]),_:1})]),_:1})])]}),_:1})]),_:1}))}}),Oe=ke(Ae,[["__scopeId","data-v-5180e530"]]);export{Oe as default};
