System.register(["./index-legacy-BfHk0QIs.js","./vendor-legacy-B0ctPPIE.js","./lodash-legacy-pOOc9Efu.js"],function(e,a){"use strict";var t,l,n,o,d,r,i,s,u,c,p,v,m,_,f,h,g,b,y,w,D,I,x,V,S,k,A,B,P,C,H,O,E,N,T,U,M,F,L,$,R,W,j,G,X,Y,z,J;return{setters:[e=>{t=e.S,l=e.m,n=e.y,o=e.aN,d=e.n,r=e.l,i=e.aa,s=e.C,u=e.i,c=e._,p=e.B,v=e.aC,m=e.t,_=e.ba,f=e.D,h=e.bb,g=e.L},e=>{b=e.d,y=e.D,w=e.aj,D=e.G,I=e.E,x=e.e,V=e.f,S=e.L,k=e.y,A=e.z,B=e.l,P=e.A,C=e.B,H=e.k,O=e.p,E=e.F,N=e.r,T=e.w,U=e.u,M=e.dT,F=e.m,L=e.ae,$=e.a,R=e.ak,W=e.bo,j=e.ai,G=e.dB,X=e.bq,Y=e.ag,z=e.c},e=>{J=e.l}],execute:function(){var a=document.createElement("style");a.textContent=".spaceBetween[data-v-4346bf77]{margin-left:10px;margin-right:10px}ion-item.ionLbltp[data-v-4346bf77]{border-bottom:2px dotted var(--ion-color-medium);--inner-border-width:0}.action_buttons[data-v-4346bf77]{color:var(--ion-color-primary);display:flex;align-items:center;float:right}.action_buttons[data-v-4346bf77]:hover{cursor:pointer}.modify_buttons[data-v-4346bf77]{padding-left:20px}.truncate-text[data-v-4346bf77]{overflow:hidden!important;white-space:nowrap!important;text-overflow:ellipsis!important}.col-st1[data-v-4346bf77]{max-width:23%}.col-st2[data-v-4346bf77]{max-width:58%}.error-label[data-v-5ab5c4cb]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.spc_btwn[data-v-5ab5c4cb]{margin-top:2%}.lsp-cls-1[data-v-5ab5c4cb]{margin:-15px -15px -15px 0}.error-label[data-v-0bd5d54b]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.spc_btwn[data-v-0bd5d54b]{margin-top:2%}.aro-cls-1[data-v-0bd5d54b]{margin:-1.3% -1.3% -1.3% 0%}.lsp-cls-1[data-v-0bd5d54b]{margin:-15px -15px -15px 0}.error-label[data-v-2483ba45]{background:#fecdca;color:#b42318;text-transform:none;padding:2% 5%;border-radius:10px;margin-top:4px;display:flex;text-align:center}.spc_btwn[data-v-2483ba45]{margin-top:2%}.aro-cls-1[data-v-2483ba45]{margin:-1.3% -1.3% -1.3% 0%}.lsp-cls-1[data-v-2483ba45]{margin:-15px -15px -15px 0}.initTxt[data-v-6366419c]{text-align:center}.spc_btwn[data-v-6366419c]{margin-top:2%}.item-al[data-v-6366419c]{cursor:pointer;padding:5px;background-color:#ebebeb;margin-top:8px}.item-al[data-v-6366419c]:hover{background-color:rgba(85,81,81,.282);padding:5px;border-radius:3px}ion-popover.popover-al[data-v-6366419c]{--background: #fff}ion-list.list-al[data-v-6366419c]{--background: #fff;-ion-item-background:#fff}.saveContainer[data-v-6366419c]{display:flex;align-items:flex-end}.action_buttons[data-v-6366419c]{margin-top:5px}.error-label[data-v-6366419c]{background:#fecdca;color:#b42318;text-transform:none;padding:6%;border-radius:10px;margin-top:7px;display:flex;text-align:center}\n/*$vite$:1*/",document.head.appendChild(a);const q="stages",K="unsavedStages";e("S",class extends t{static getOperationMode(){const e=t.getAPIStatus(),a=t.getModsStatus(),l=t.getUseIndexDBStatus();return e&&!l?"API_ONLY":e&&l?"API_WITH_INDEXDB":a&&!l?"MODS_ONLY":a&&l?"MODS_WITH_INDEXDB":"OFFLINE"}static async addPatientToStage(e,a,t,n){const o=this.getOperationMode();try{switch(o){case"API_ONLY":return await this._handleApiOnly(e,a,t,n);case"API_WITH_INDEXDB":return await this._handleApiWithIndexDB(e,a,t,n);case"MODS_ONLY":return await this._handleModsOnly(e,a,t,n);case"MODS_WITH_INDEXDB":return await this._handleModsWithIndexDB(e,a,t,n);default:throw new Error("Error adding patient mode")}}catch(d){throw l(`Failed to move patient to ${a}`),d}}static async _handleApiOnly(e,a,t,l){const o=await this._addPatientToStageViaAPI(e,a,t,l);return n(`Patient moved to ${a}`),o}static async _handleApiWithIndexDB(e,a,t,l){try{const o=await this._addPatientToStageViaAPI(e,a,t,l);return await this._storeInIndexDB(o),n(`Patient moved to ${a}`),o}catch(o){return console.warn("API failed, falling back to IndexDB"),this._addPatientToStageOffline(e,a,t,l)}}static async _handleModsOnly(e,a,t,l){if(!(await o()))throw new Error("MODS connection unavailable");const d=await this._addPatientToStageViaAPI(e,a,t,l);return n(`Patient moved to ${a} (MODS)`),d}static async _handleModsWithIndexDB(e,a,t,l){try{if(await o()){const o=await this._addPatientToStageViaAPI(e,a,t,l);return await this._storeInIndexDB(o),n(`Patient moved to ${a}`),o}throw new Error("MODS connection unavailable")}catch(d){return console.warn("MODS failed, falling back to IndexDB"),this._addPatientToStageOffline(e,a,t,l)}}static async movePatientToNextStage(e,a,t,l,n){return await this.safeDeactivateStages(e),this.addPatientToStage(e,t,l,n)}static async _addPatientToStageViaAPI(e,a,t,l){return(await super.postJson("/stages",{stage:{patient_id:e,stage:a,location_id:t,visit_id:l,arrivalTime:(new Date).toISOString()}})).data}static async _addPatientToStageOffline(e,a,t,l){const o=(new Date).toISOString(),r=d(),{fullName:i}=await this._resolvePatientDetails(e,t),s={patient_id:e,visit_id:l,stage:a,location_id:t,arrivalTime:o,status:1,fullName:i,sync_status:"pending"};return await r.postData("ADD_STAGE",{storeName:K,data:s}),n(`Patient queued for ${a} (offline)`),s}static async _storeInIndexDB(e){if(!t.getUseIndexDBStatus())return;const a=d();await a.postData("ADD_STAGE",{storeName:q,data:{...e,sync_status:"synced"}})}static async safeDeactivateStages(e){const a=this.getOperationMode();try{return a.includes("API")&&await super.patchJson("/stages/deactivate",{patientId:e}),(a.includes("INDEXDB")||"OFFLINE"===a)&&await this._deactivateStagesOffline(e),1}catch(t){throw console.error("Deactivation failed:",t),t}}static async _deactivateStagesOffline(e){const a=d(),t=(new Date).toISOString();await a.postData("UPDATE_STAGE",{storeName:K,whereClause:{patient_id:e,status:1},data:{status:0,updated_at:t,sync_status:"pending"}}),await a.postData("UPDATE_STAGE",{storeName:q,whereClause:{patient_id:e,status:1},data:{status:0,updated_at:t,sync_status:"pending"}})}static async getCurrentStage(e){var a;const t=this.getOperationMode();try{if(t.includes("API"))return(await super.getJson("/stages/current",{patientId:e})).stage}catch(l){console.warn("Online fetch failed, falling back to offline")}return(null===(a=(await r(K,{whereClause:{patient_id:e,status:1}}))[0])||void 0===a?void 0:a.stage)||null}static async _resolvePatientDetails(e,a){var t;const l=(await r("patientRecords",{whereClause:{patientID:e}}))[0];return{fullName:null!=l&&l.personInformation?[l.personInformation.given_name,l.personInformation.family_name].filter(Boolean).join(" "):void 0,visit_id:null===(t=(await r("visits",{whereClause:{patientId:e,location_id:a}}))[0])||void 0===t?void 0:t.id}}});const Q=b({components:{IonItem:D,IonCol:w,IonLabel:y},data:()=>({iconsContent:u}),props:{displayData:{type:Array,default:[]}},methods:{highlightItem(e){const a=document.getElementById(e+"_lbl");a&&(a.style.color="#006401"),this.highlightActionBtns(e)},undoHighlightItem(e){const a=document.getElementById(e+"_lbl");a&&(a.style.color="rgb(0,0,0)"),this.undohighlightActionBtns(e)},highlightActionBtns(e){const a=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<a.length;t++)a[t].style.display="block"},undohighlightActionBtns(e){const a=document.getElementsByClassName(e+"_spanlbl");for(let t=0;t<a.length;t++)a[t].style.display="none"},asignLblID:e=>e+"_lbl",asignSpanLblID:e=>e+"_spanlbl",async removeItemAtIndex(e,a){await s("Do you want to delete it?",a)&&this.$emit("update:removeItem",e)},async editItemAtIndex(e,a,t){await i("Do you want to edit it?",t)&&this.$emit("update:editItem",{index:e,item:a})},fomartDate:e=>e.year+"-"+(e.month<10?"0":"")+e.month+"-"+(e.day<10?"0":"")+e.day}}),Z=e("D",c(Q,[["render",function(e,a,t,l,n,o){const d=I("ion-label"),r=I("ion-col"),i=I("ion-icon"),s=I("ion-item");return V(!0),x(E,null,S(e.displayData,(t,l)=>(V(),k(s,{displayData:e.displayData,class:"ionLbltp",key:l,onMousemove:a=>e.highlightItem(l),onMouseout:a=>e.undoHighlightItem(l)},{default:A(()=>[B(r,{class:"col-st1"},{default:A(()=>[B(d,{id:e.asignLblID(l),class:"truncate-text",style:{color:"#00190E","font-weight":"400",font:"inter","line-height":"21px"}},{default:A(()=>[P(C(t.type),1)]),_:2},1032,["id"])]),_:2},1024),B(r,{class:"col-st2"},{default:A(()=>[B(d,{class:"truncate-text",style:{color:"#636363","font-weight":"400",font:"inter","line-height":"21px"}},{default:A(()=>[a[0]||(a[0]=H("span",{class:"spaceBetween"},null,-1)),P(" "+C(t.name)+" ",1),a[1]||(a[1]=H("span",{class:"spaceBetween"},null,-1)),P(C(t.reason),1),a[2]||(a[2]=H("span",{class:"spaceBetween"},null,-1)),P(C(e.fomartDate(t.date)),1)]),_:2,__:[0,1,2]},1024)]),_:2},1024),B(r,{class:"action_buttons"},{default:A(()=>[B(d,{class:O(e.asignSpanLblID(l)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:a=>e.editItemAtIndex(l,t,a)},{default:A(()=>[B(i,{icon:e.iconsContent.edit},null,8,["icon"])]),_:2},1032,["class","onClick"]),B(d,{class:O(e.asignSpanLblID(l)),style:{cursor:"pointer",display:"none","text-align":"end"},onClick:a=>e.removeItemAtIndex(l,a)},{default:A(()=>[B(i,{icon:e.iconsContent.delete},null,8,["icon"])]),_:2},1032,["class","onClick"])]),_:2},1024)]),_:2},1032,["displayData","onMousemove","onMouseout"]))),128)}],["__scopeId","data-v-4346bf77"]])),ee=b({__name:"TimePicker",props:{place_holder:{},time_prop:{}},emits:["timeUpDated"],setup(e,{emit:a}){const t=N(),l=N({title:"Set Time",popoverOpen:!1,isOpen:!1,event:{},keyboardClose:!1,popoverData:{}}),n=N(),o={name:"Now",show:!0,fn:_},d=N(!0),r=N(!1),i=N(0),s=e;T(()=>s.time_prop,e=>{e&&(t.value=e.time)},{immediate:!0,deep:!0});const u=a;function c(e){1==r.value?(d.value=!1,r.value=!1):d.value=!0,l.value.isOpen=!0,l.value.event=e}function v(e){t.value=e.detail.value;const a=m(t.value);1!=(-1!==a.indexOf("NaN"))?t.value=a:_()}function m(e){let a=new Date(e),t=a.getHours(),l=a.getMinutes(),o=t>=12?"PM":"AM";t%=12,t=t||12;let d=t.toString().padStart(2,"0")+":"+l.toString().padStart(2,"0")+" "+o;return n.value={time:d,meridian:o},u("timeUpDated",n.value),d}function _(){r.value=!0,t.value=m(new Date),d.value=!1,i.value++}return(e,a)=>{const n=I("ion-popover");return V(),x(E,null,[(V(),k(p,{placeholder:s.place_holder.default,inputValue:t.value,icon:U(M),"-inner-action-btn-propeties":o,"onClicked:inputValue":c,"onUpdate:InnerActionBtnPropetiesAction":o.fn,key:i.value},null,8,["placeholder","inputValue","icon","onUpdate:InnerActionBtnPropetiesAction"])),B(n,{"show-backdrop":!1,"keep-contents-mounted":!0,"is-open":l.value.isOpen,event:l.value.event,side:"top",onDidDismiss:a[0]||(a[0]=e=>l.value.isOpen=!1)},{default:A(()=>[d.value?(V(),k(U(L),{key:0,onIonChange:v,id:"datetime",presentation:"time","show-default-buttons":!0})):F("",!0)]),_:1},8,["is-open","event"])],64)}}}),ae=b({name:"xxxComponent"}),te=b({...ae,props:{selected_ward_prop:{},admitted_other_props:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=N([]),l=v(),n=N(NaN),o=N(!1),d=N(),i=N(!1);$(async()=>{!async function(){(await async function(e={}){try{const{name:a="",page:t=1,page_size:l=10}=e,n=a?{name:`%${a}%`}:{};return(await r("wards",{likeClause:n,currentPage:t,itemsPerPage:l}).then(e=>e.records)).map(e=>({name:e.name,value:e.name,other:e}))}catch(a){throw console.error("Error fetching offline wards:",a.message),a}}({name:"",page:1,page_size:1e3})).forEach(e=>{const a={name:e.name,selected:!1,other:e,location_ward_id:e.other.location_id};t.value.push(a)})}(),b()});const s=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:D},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:function(){x()}}],u=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;u[0].dataValue.value=a,1==i.value&&m("Remember to press the SAVE button",1e4),b(!1)},dataValue:N(),show_error:N(!1),error_message:"please provide a reason"}],c=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};c[0].dataValue.value=a,D(!1)},dataValue:N(),show_error:N(!1),error_message:"please provide date"}],h=[{placeHolder:{default:"Enter time of admission"},dataHandler:function(e){h[0].dataValue.value=e,D(!1)},dataValue:N(),show_error:N(!1),error_message:"error"}],g=e;function b(e=!0){i.value=e}function D(e=!0){void 0===d.value||""==d.value?o.value=!0:o.value=!1,""==u[0].dataValue.value||void 0===u[0].dataValue.value?u[0].show_error.value=!0:u[0].show_error.value=!1,void 0===c[0].dataValue.value||""==c[0].dataValue.value?c[0].show_error.value=!0:c[0].show_error.value=!1,void 0===h[0].dataValue.value||""==c[0].dataValue.value?h[0].show_error.value=!0:h[0].show_error.value=!1,0==c[0].show_error.value&&0==h[0].show_error.value&&0==u[0].show_error.value&&0==o.value?async function(){const e={name:d.value.name,type:"Admitted for short stay",date:c[0].dataValue,time:h[0].dataValue,reason:u[0].dataValue,other:d.value,selected:!0};await l.addOutcomeData(e,n.value)&&x({dataSaved:!1})}():e&&m("Please enter correct data values",4e3)}T(()=>g.selected_ward_prop,e=>{e&&(d.value=e)},{immediate:!0,deep:!0}),T(()=>g.admitted_other_props,e=>{e&&(u[0].dataValue.value=e.reason,h[0].dataValue.value=e.time,c[0].dataValue.value=e.date)},{immediate:!0,deep:!0});const I=a;function x(e={dataSaved:!0}){I("dataSaved",e)}return(e,a)=>(V(),k(U(R),null,{default:A(()=>[B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[B(U(W),{modelValue:d.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>d.value=e),a[1]||(a[1]=e=>{return a=e,d.value=a,b(),void D(!1);var a})],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom","tag-placeholder":"Find and select a ward",placeholder:"Find and select a ward",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:a[2]||(a[2]=e=>({})),"track-by":"location_ward_id",options:t.value},null,8,["modelValue","options"]),H("div",null,[o.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>a[3]||(a[3]=[P(C("Please select a ward"))])),_:1,__:[3]})):F("",!0)])]),_:1})]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[H("div",null,[B(_,{place_holder:c[0].placeHolder,onDateUpDated:c[0].dataHandler,date_prop:c[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),H("div",null,[c[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(c[0].error_message),1)]),_:1})):F("",!0)])])]),_:1})]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[H("div",null,[B(ee,{place_holder:h[0].placeHolder,onTimeUpDated:h[0].dataHandler,time_prop:h[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),H("div",null,[h[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(h[0].error_message),1)]),_:1})):F("",!0)])])]),_:1})]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[B(p,{placeholder:u[0].placeHolder,icon:U(G),inputValue:u[0].dataValue.value,"onUpdate:inputValue":u[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),H("div",null,[u[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(u[0].error_message),1)]),_:1})):F("",!0)])]),_:1})]),_:1}),s[0].showAddItemButton?(V(),k(U(j),{key:0,class:"spc_btwn"},{default:A(()=>[s[0].addItemButton?(V(),k(f,{key:0,name:s[0].name,fill:s[0].btnFill,icon:U(X),"onClicked:btn":s[0].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0),s[1].addItemButton?(V(),k(f,{key:1,name:s[1].name,fill:s[1].btnFill,icon:U(Y),"onClicked:btn":s[1].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0)]),_:1})):F("",!0)]),_:1}))}}),le=e("A",c(te,[["__scopeId","data-v-5ab5c4cb"]])),ne=b({name:"xxxComponent"}),oe=b({...ne,props:{selected_referral_data:{},selected_other_referral_data:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=N(NaN),l=N(null),n=v(),o=N(!1),d=N([]),r=N({}),i=N(!0),s={location_data:{}},u=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;u[0].dataValue.value=a,1==i.value&&m("Remember to press the SAVE button",1e4),x(!1)},dataValue:N(),show_error:N(!1),error_message:"please provide a reason"}],c=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};c[0].dataValue.value=a,D(!1)},dataValue:N(),show_error:N(!1),error_message:"please provide date"}],g=[{placeHolder:{default:"Enter time of referral"},dataHandler:function(e){g[0].dataValue.value=e,D(!1)},dataValue:N(),show_error:N(!1),error_message:"error"}],b=e;function D(e=!0){I(),""==u[0].dataValue.value||void 0===u[0].dataValue.value?u[0].show_error.value=!0:u[0].show_error.value=!1,void 0===c[0].dataValue.value||""==c[0].dataValue.value?c[0].show_error.value=!0:c[0].show_error.value=!1,void 0===g[0].dataValue.value||""==c[0].dataValue.value?g[0].show_error.value=!0:g[0].show_error.value=!1,0==c[0].show_error.value&&0==g[0].show_error.value&&0==u[0].show_error.value&&0==o.value?O():e&&m("Please enter correct data values",4e3)}function I(){l.value?o.value=!1:o.value=!0}function x(e=!0){i.value=e}T(()=>b.selected_other_referral_data,e=>{e&&(u[0].dataValue.value=e.reason,c[0].dataValue.value=e.date,g[0].dataValue.value=e.time)},{immediate:!0,deep:!0}),T(()=>b.selected_referral_data,e=>{if(!e)return;l.value=e.selected_location,s.location_data=e;const a=Array.isArray(e.selected_district_ids)?[...e.selected_district_ids]:[],t=e.selected_location?{...e.selected_location}:null;d.value=a,r.value=t},{immediate:!0,deep:!0}),$(()=>{x()});const S=e=>{l.value=e.selected_location,I(),s.location_data=e,x(),D(!1)},O=async()=>{const e={name:l.value.name,type:"Referred out",selected:!0,date:c[0].dataValue,time:g[0].dataValue,reason:u[0].dataValue},a={...e,other:{ref_data:e,location_data:s.location_data}};await n.addOutcomeData(a,t.value)&&M({dataSaved:!1})},E=a;function M(e={dataSaved:!0}){E("dataSaved",e)}const L=[{showAddItemButton:!0,addItemButton:!0,name:" save",btnFill:"clear",fn:D},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:()=>{M()}}];return(e,a)=>(V(),k(U(R),null,{default:A(()=>[B(U(j),null,{default:A(()=>[B(h,{show_error:o.value,onFacilitySelected:S,selected_district_ids:d.value,selected_location:r.value},null,8,["show_error","selected_district_ids","selected_location"])]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[H("div",null,[B(_,{place_holder:c[0].placeHolder,onDateUpDated:c[0].dataHandler,date_prop:c[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),H("div",null,[c[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(c[0].error_message),1)]),_:1})):F("",!0)])])]),_:1})]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[H("div",null,[B(ee,{place_holder:g[0].placeHolder,onTimeUpDated:g[0].dataHandler,time_prop:g[0].dataValue.value},null,8,["place_holder","onTimeUpDated","time_prop"]),H("div",null,[g[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(g[0].error_message),1)]),_:1})):F("",!0)])])]),_:1})]),_:1}),B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[B(p,{placeholder:u[0].placeHolder,icon:U(G),inputValue:u[0].dataValue.value,"onUpdate:inputValue":u[0].dataHandler},null,8,["placeholder","icon","inputValue","onUpdate:inputValue"]),H("div",null,[u[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(u[0].error_message),1)]),_:1})):F("",!0)])]),_:1})]),_:1}),L[0].showAddItemButton?(V(),k(U(j),{key:0,class:"spc_btwn"},{default:A(()=>[L[0].addItemButton?(V(),k(f,{key:0,name:L[0].name,fill:L[0].btnFill,icon:U(X),"onClicked:btn":L[0].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0),L[1].addItemButton?(V(),k(f,{key:1,name:L[1].name,fill:L[1].btnFill,icon:U(Y),"onClicked:btn":L[1].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0)]),_:1})):F("",!0)]),_:1}))}}),de=e("R",c(oe,[["__scopeId","data-v-0bd5d54b"]])),re=b({name:"xxxComponent"}),ie=b({...re,props:{selected_discharged_prop:{},selected_discharged_data:{}},emits:["dataSaved"],setup(e,{emit:a}){const t=N(NaN),l=N([]),n=v(),o=N();$(async()=>{c("")});const d=[{placeHolder:"Reason",dataHandler:function(e){const a=e.target.value;d[0].dataValue.value=a},dataValue:N(),show_error:N(!1),error_message:"please provide a reason"}],r=[{placeHolder:{default:"Enter date"},dataHandler:function(e){const a={day:e.value.day,month:e.value.month,year:e.value.year,formattedDate:e.value.formattedDate};r[0].dataValue.value=a,p(!1)},dataValue:N(),show_error:N(!1),error_message:"please provide date"}],i=e;T(()=>i.selected_discharged_prop,e=>{e&&(o.value=e)},{immediate:!0,deep:!0}),T(()=>i.selected_discharged_data,e=>{e&&(r[0].dataValue.value=e.date||"",e.reason&&(d[0].dataValue.value=e.reason))},{immediate:!0,deep:!0}),l.value,N(!1),N(!1);const s=[{placeHolder:{default:"Enter time of referral"},dataHandler:function(e){s[0].dataValue.value=e},dataValue:N(),show_error:N(!1),error_message:"error"}],u=new Set;async function c(e){const a=e;(await g.getFacilities({name:a})).forEach(e=>{u.has(e.location_id)||(u.add(e.location_id),0==J.isEmpty(e.name)&&l.value.push({name:e.name,selected:!1,other:e}))})}function p(e=!0){void 0===r[0].dataValue.value||""==r[0].dataValue.value?r[0].show_error.value=!0:r[0].show_error.value=!1,r[0].show_error.value?e&&m("Please enter a valid date",4e3):async function(){const e={type:"Discharged Home",date:r[0].dataValue,reason:d[0].dataValue.value};await n.addOutcomeData(e,t.value)&&b({dataSaved:!1})}()}const h=a;function b(e={dataSaved:!0}){h("dataSaved",e)}const D=[{showAddItemButton:!0,addItemButton:!0,name:"save",btnFill:"clear",fn:p},{showAddItemButton:!0,addItemButton:!0,name:"cancel",btnFill:"clear",fn:function(){b()}}];return(e,a)=>(V(),k(U(R),null,{default:A(()=>[B(U(j),null,{default:A(()=>[B(U(w),null,{default:A(()=>[H("div",null,[B(_,{place_holder:r[0].placeHolder,onDateUpDated:r[0].dataHandler,date_prop:r[0].dataValue.value},null,8,["place_holder","onDateUpDated","date_prop"]),H("div",null,[r[0].show_error.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>[P(C(r[0].error_message),1)]),_:1})):F("",!0)])])]),_:1})]),_:1}),D[0].showAddItemButton?(V(),k(U(j),{key:0,class:"spc_btwn"},{default:A(()=>[D[0].addItemButton?(V(),k(f,{key:0,name:D[0].name,fill:D[0].btnFill,icon:U(X),"onClicked:btn":D[0].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0),D[1].addItemButton?(V(),k(f,{key:1,name:D[1].name,fill:D[1].btnFill,icon:U(Y),"onClicked:btn":D[1].fn},null,8,["name","fill","icon","onClicked:btn"])):F("",!0)]),_:1})):F("",!0)]),_:1}))}}),se=e("a",c(ie,[["__scopeId","data-v-2483ba45"]])),ue={class:"dash_box"},ce={key:0,style:{"margin-top":"100px"}},pe=b({name:"xxxComponent"}),ve=b({...pe,setup(e){const a=N("No outcome created yet"),t=N(!1),l=N(!0),n=N(""),o=N(!0),d=N(!1),r=v(),i=z(()=>r.outcomes),s=N(!1),u=N(!1),c=N(!1),p=N(!1),m=N(!1),_=N(),f=N(null),h=N(null),g=N(null),b=N(null),D=N(null),S=N(null),O=N([{name:"Admitted for short stay",selected:!1},{name:"Referred out",selected:!1},{name:"Discharged Home",selected:!1}]);function E(e){O.value.forEach(a=>{1!=e.selected||e.name!=a.name&&e.type!=a.name||(n.value=a.name)})}function M(){i.value.length>0?o.value=!1:0==i.value.length&&0==d.value&&(o.value=!0)}function L(e){i.value.splice(e,1)}$(async()=>{M()}),T(()=>n.value,async e=>{1==s.value?s.value=!1:async function(){const e=n.value;n.value=e;const a=n.value;a==O.value[0].name?c.value=!0:c.value=!1,a==O.value[1].name?p.value=!0:p.value=!1,a==O.value[2].name?m.value=!0:m.value=!1}()}),T(()=>i.value.length,async e=>{M()});const j=e=>{L(e.index),E(e.item),f.value=e.item.other.location_data,h.value={reason:e.item.reason,date:e.item.date,time:e.item.time},g.value=e.item.other,b.value=e.item,"Discharged Home"===e.item.type&&(D.value=e.item,S.value={reason:e.item.reason,date:e.item.date})};function G(){u.value=!1,c.value=!1,m.value=!1,p.value=!1,O.value.forEach(e=>{e.selected=!1}),n.value=""}return(e,n)=>{const d=I("ion-row");return V(),k(U(R),null,{default:A(()=>[B(d,null,{default:A(()=>[B(U(w),null,{default:A(()=>[(V(),k(Z,{key:0,"onUpdate:removeItem":L,"onUpdate:editItem":j,displayData:i.value},null,8,["displayData"]))]),_:1})]),_:1}),o.value?(V(),k(d,{key:0},{default:A(()=>[H("span",ue,C(a.value),1)]),_:1})):F("",!0),B(d,null,{default:A(()=>[B(U(w),null,{default:A(()=>[l.value?(V(),x("div",ce,[B(d,null,{default:A(()=>[B(U(W),{modelValue:_.value,"onUpdate:modelValue":[n[0]||(n[0]=e=>_.value=e),n[1]||(n[1]=e=>{return a=e,O.value.forEach(e=>{e.selected=!1}),_.value=a,_.value.selected=!0,void E(_.value);var a})],multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"top","tag-placeholder":"find and select a referral type",placeholder:"find and select a referral type",selectLabel:"",label:"name",searchable:!0,disabled:!1,onSearchChange:()=>{},"track-by":"name",options:O.value},null,8,["modelValue","options"]),H("div",null,[t.value?(V(),k(U(y),{key:0,class:"error-label"},{default:A(()=>n[2]||(n[2]=[P(C("please select a type"))])),_:1,__:[2]})):F("",!0)])]),_:1})])):F("",!0)]),_:1})]),_:1}),c.value?(V(),k(le,{key:1,onDataSaved:G,selected_ward_prop:g.value,admitted_other_props:b.value},null,8,["selected_ward_prop","admitted_other_props"])):F("",!0),p.value?(V(),k(de,{key:2,onDataSaved:G,selected_referral_data:f.value,selected_other_referral_data:h.value},null,8,["selected_referral_data","selected_other_referral_data"])):F("",!0),m.value?(V(),k(se,{key:3,onDataSaved:G,selected_discharged_prop:D.value,selected_discharged_data:S.value},null,8,["selected_discharged_prop","selected_discharged_data"])):F("",!0)]),_:1})}}});e("O",c(ve,[["__scopeId","data-v-6366419c"]]))}}});
