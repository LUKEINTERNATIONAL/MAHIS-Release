var qe=Object.defineProperty;var Oe=(A,p,c)=>p in A?qe(A,p,{enumerable:!0,configurable:!0,writable:!0,value:c}):A[p]=c;var be=(A,p,c)=>Oe(A,typeof p!="symbol"?p+"":p,c);import{d as ie,r as v,e as w,f as h,m as E,l as s,k as a,u as t,bM as Ie,z as o,U as ge,T as he,A as H,aU as Pe,W as G,I as B,b1 as _e,S as we,F as se,L as Ue,y as Ae,ac as me,a$ as Be,a_ as We,B as S,ca as Fe,d4 as Le,a0 as je,a9 as le,G as W,D as F,X as O,R as Je,c as R,ai as C,w as j,a as De,E as Y,i as Ee,v as Ne,d5 as $e,a3 as J,bo as Z,cZ as ze,V as Ce,d6 as ne,aa as Ze,ab as Ve,d7 as xe,d8 as Ge,d9 as Xe,da as Ke,db as Qe,dc as Ye,d2 as ea,d1 as aa,bd as ta,p as sa,af as la,dd as K,de as na,df as fe,dg as ye,dh as oa,di as ia,dj as ra}from"./vendor-CDoWWVkO.js";import{S as L,z as Me,t as U,_ as Se,i as Q,D as Te,U as He,T as da,j as ua}from"./index-w0bp8tHE.js";import{v as ca}from"./voidReason-D-pFrrPq.js";import{l as va}from"./lodash-Dt8AsbQm.js";import"./apexcharts-BHjAlFBS.js";class re extends L{constructor(){super();be(this,"ENDPOINT","eir/session_schedule")}async create(c){return L.postJson(this.ENDPOINT,c)}async get(c){return L.getJson(this.ENDPOINT,{session_id:c})}async update(c,l){return L.putJson("".concat(this.ENDPOINT,"/").concat(l),c)}async delete(c,l){return L.delete("".concat(this.ENDPOINT,"?id=").concat(c),{void_reason:l})}async getSessions(c="",l="",b="",D=1,y=10){return L.getJson(this.ENDPOINT)}}const pa={key:0,class:"spinner-overlay"},ma={style:{display:"flex","justify-content":"space-between","align-items":"center"}},fa={style:{display:"flex","align-items":"center"}},ya={slot:"start",class:"icon-color"},ga=["width","height"],ha={slot:"start",class:"icon-color"},_a=["width","height"],wa=["innerHTML"],Da={slot:"start",class:"icon-color"},Ma=["width","height"],Sa={slot:"start",class:"icon-color"},ba=["width","height"],Va=ie({__name:"ViewImmunizationSessionModal",props:{data:{type:Array,default:[],required:!0}},setup(A){const p=A,c=v(40),l=v(40),b=v(!1),D=v({}),y=M=>{var i;return(((i=M.session_vaccines)==null?void 0:i.vaccines)||[]).map(u=>"".concat(u.drug_name," <b>(").concat(u.missed_doses,")</b>")).join(", ")},N=async M=>{O.dismiss({edit:M})},x=async M=>{const d=await O.create({component:ca,cssClass:"otherVitalsModal",componentProps:{data:p.data}});await d.present(),d.onDidDismiss().then(async i=>{i.data&&(b.value=!0,await new re().delete(Number(M.session_schedule_id),i.data.name)?Me("Immunization schedule deleted successfully!"):U("An error occurred, please try again later."),b.value=!1,O.dismiss({update:!0}))})},k=()=>{O.dismiss()};return(M,d)=>(h(),w(se,null,[b.value?(h(),w("div",pa,[s(t(Ie),{name:"bubbles"}),d[0]||(d[0]=a("div",{class:"loading-text"},"Please wait...",-1))])):E("",!0),s(t(we),null,{default:o(()=>[s(t(ge),null,{default:o(()=>[s(t(he),null,{default:o(()=>d[1]||(d[1]=[H("View Immunization Session Schedule")])),_:1,__:[1]}),s(t(Pe),{slot:"end"},{default:o(()=>[s(t(G),{onClick:k},{default:o(()=>[s(t(B),{icon:t(_e),color:"white"},null,8,["icon"])]),_:1})]),_:1}),d[2]||(d[2]=a("div",{slot:"start"},[a("div",{style:{"margin-left":"15px"}},[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 64 64"},[a("path",{fill:"currentColor",d:"M33.208 25.544a3.616 3.616 0 0 1 4.548 2.347a3.62 3.62 0 0 1-2.346 4.549l-9.838 3.144a3.62 3.62 0 0 1-3.331-.597l-4.069-3.184l8.835 31.777H1.267V23.208a4.32 4.32 0 0 1 4.319-4.317h6.435c.918 0 1.764.293 2.46.836l10.711 8.379l8.016-2.563zM17.486 37.718h-3.904v-3.909H8.923v3.909h-3.89v4.673h3.89v3.889h4.659v-3.889h3.904zM9.655 16.951a7.77 7.77 0 0 0 0-15.538a7.77 7.77 0 0 0-7.769 7.768a7.77 7.77 0 0 0 7.769 7.77m45.715.028a7.78 7.78 0 0 0 7.779-7.777c0-4.301-3.486-7.787-7.779-7.787a7.783 7.783 0 0 0-7.781 7.787a7.78 7.78 0 0 0 7.781 7.777"}),a("path",{fill:"currentColor",d:"M53.02 19.069c-3.184 0-4.628 1.089-5.837 2.975l-.782 1.504l-4.547-1.328l.192-1.239l-10.857-2.432l-.304 1.354l-2.031-.452l.302-1.358l-.815-.18l-.932 4.16l.811.18l.311-1.358l2.031.454l-.304 1.361l10.86 2.432l.351-1.274l4.399.707l-11.335 21.8a3.545 3.545 0 0 0 1.588 4.757a3.553 3.553 0 0 0 4.764-1.586l9.456-18.351h1.551v32.386h11.147V19.07H53.021z"})])])],-1))]),_:1,__:[2]})]),_:1}),s(t(le),null,{default:o(()=>[p.data.length>0?(h(!0),w(se,{key:0},Ue(p.data,(i,u)=>(h(),Ae(t(me),{style:{margin:"-10px"},key:i.id},{default:o(()=>[a("div",ma,[s(t(Be),{style:{flex:"1"}},{default:o(()=>[a("div",null,[s(t(We),{class:"ion-text-wrap text-mobile"},{default:o(()=>[H(S(i.session_name),1)]),_:2},1024),s(t(Fe),null,{default:o(()=>[H(" Scheduled from: "+S(i.start_date)+" to "+S(i.end_date),1)]),_:2},1024)])]),_:2},1024),a("div",fa,[s(t(G),{fill:"clear",id:"click-trigger-".concat(u,"-"),style:{"margin-left":"auto"}},{default:o(()=>[s(t(B),{icon:t(Le)},null,8,["icon"])]),_:2},1032,["id"])]),s(t(je),{"dismiss-on-select":"",trigger:"click-trigger-".concat(u,"-"),"trigger-action":"click",ref_for:!0,ref:n=>{n&&(D.value[u]=n)}},{default:o(()=>[s(t(le),null,{default:o(()=>[s(t(me),null,{default:o(()=>[s(t(W),{button:"",onClick:n=>N(i)},{default:o(()=>[s(t(F),null,{default:o(()=>d[3]||(d[3]=[H("Edit")])),_:1,__:[3]})]),_:2},1032,["onClick"]),s(t(W),{button:"",onClick:n=>x(i)},{default:o(()=>[s(t(F),null,{default:o(()=>d[4]||(d[4]=[H("Cancel")])),_:1,__:[4]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),s(t(me),{style:{margin:"10px"}},{default:o(()=>[s(t(W),null,{default:o(()=>[a("div",ya,[(h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:l.value,height:c.value,viewBox:"0 0 20 20"},d[5]||(d[5]=[a("g",{fill:"currentColor"},[a("g",{opacity:"0.2"},[a("path",{d:"M9.75 7.75a3 3 0 1 1-6 0a3 3 0 0 1 6 0"}),a("path",{"fill-rule":"evenodd",d:"M6.75 8.75a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 2a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M6.8 11.5A1.5 1.5 0 0 0 5.3 13v1.5a1 1 0 0 1-2 0V13a3.5 3.5 0 0 1 7 0v.5a1 1 0 1 1-2 0V13a1.5 1.5 0 0 0-1.5-1.5","clip-rule":"evenodd"}),a("path",{d:"M12.75 7.75a3 3 0 1 0 6 0a3 3 0 0 0-6 0"}),a("path",{"fill-rule":"evenodd",d:"M15.75 8.75a1 1 0 1 1 0-2a1 1 0 0 1 0 2m0 2a3 3 0 1 1 0-6a3 3 0 0 1 0 6","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M15.7 11.5a1.5 1.5 0 0 1 1.5 1.5v1.5a1 1 0 1 0 2 0V13a3.5 3.5 0 0 0-7 0v.5a1 1 0 1 0 2 0V13a1.5 1.5 0 0 1 1.5-1.5","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M11.3 14.25a1.5 1.5 0 0 0-1.5 1.5v1.5a1 1 0 0 1-2 0v-1.5a3.5 3.5 0 0 1 7 0v1.5a1 1 0 1 1-2 0v-1.5a1.5 1.5 0 0 0-1.5-1.5","clip-rule":"evenodd"}),a("path",{d:"M14.25 10.5a3 3 0 1 1-6 0a3 3 0 0 1 6 0"}),a("path",{"fill-rule":"evenodd",d:"M11.25 11.5a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 2a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),a("path",{d:"M4.25 11.5h5v4h-5zm9 0h5v4h-5z"}),a("path",{d:"M9.25 13.5h4l.5 4.75h-5z"})]),a("path",{"fill-rule":"evenodd",d:"M5 9a2 2 0 1 0 0-4a2 2 0 0 0 0 4m0 1a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M3.854 8.896a.5.5 0 0 1 0 .708l-.338.337A3.47 3.47 0 0 0 2.5 12.394v1.856a.5.5 0 1 1-1 0v-1.856a4.47 4.47 0 0 1 1.309-3.16l.337-.338a.5.5 0 0 1 .708 0m11.792-.3a.5.5 0 0 0 0 .708l.338.337A3.47 3.47 0 0 1 17 12.094v2.156a.5.5 0 0 0 1 0v-2.156a4.47 4.47 0 0 0-1.309-3.16l-.337-.338a.5.5 0 0 0-.708 0","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M14 9a2 2 0 1 1 0-4a2 2 0 0 1 0 4m0 1a3 3 0 1 1 0-6a3 3 0 0 1 0 6m-4.5 3.25a2.5 2.5 0 0 0-2.5 2.5v1.3a.5.5 0 0 1-1 0v-1.3a3.5 3.5 0 0 1 7 0v1.3a.5.5 0 1 1-1 0v-1.3a2.5 2.5 0 0 0-2.5-2.5","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M9.5 11.75a2 2 0 1 0 0-4a2 2 0 0 0 0 4m0 1a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"})],-1)]),8,ga))]),s(t(F),null,{default:o(()=>{var n,_;return[d[6]||(d[6]=a("h3",{class:"ion-label-h3"},"Expected Clients",-1)),a("p",null,S((n=i.session_vaccines)==null?void 0:n.total_clients)+" people (Under 5), "+S((_=i.session_vaccines)==null?void 0:_.total_missed_doses)+" doses required ",1)]}),_:2,__:[6]},1024)]),_:2},1024),s(t(W),null,{default:o(()=>[a("div",ha,[(h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:l.value,height:c.value,viewBox:"0 0 48 48"},d[7]||(d[7]=[a("g",{fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M6.818 14.5a1.157 1.157 0 0 1 0-1.636l6.546-6.546A1.157 1.157 0 1 1 15 7.955l-.818.817l4.09 4.09l3.273-3.272a1.157 1.157 0 1 1 1.637 1.636l-1.637 1.637l13.91 13.91a5.79 5.79 0 0 1 1.295 6.205l1.159 1.159c.605.605.805 1.463.6 2.235l2.673 2.673a1.157 1.157 0 1 1-1.637 1.637l-2.673-2.673a2.31 2.31 0 0 1-2.236-.6l-1.158-1.158a5.79 5.79 0 0 1-6.205-1.296l-2.14-2.14l6.767-6.768l-11.77-11.77l-5.353 5.354L17.147 22h-2.829l-.955-.955l-1.636 1.636a1.157 1.157 0 1 1-1.636-1.636l3.273-3.273l-4.09-4.09l-.82.818a1.157 1.157 0 0 1-1.636 0m5.95-4.313l-2.08 2.08l4.09 4.09l2.08-2.08zM28.687 33.54a3.79 3.79 0 0 0 4.061.847l2.14-2.14a3.79 3.79 0 0 0-.848-4.06l-.504-.505l-5.353 5.354zm6.768 1.414q-.112.113-.229.216l.824.824a.314.314 0 1 0 .445-.444l-.824-.824a6 6 0 0 1-.216.228","clip-rule":"evenodd"}),a("path",{d:"M16 28a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 0 1-2 0v-2h-2a1 1 0 0 1 0-2h2v-2a1 1 0 0 1 1-1"}),a("path",{"fill-rule":"evenodd",d:"M8.66 37.689A12.12 12.12 0 0 0 15.5 42a12.12 12.12 0 0 0 6.84-4.31A12.35 12.35 0 0 0 25 29.997V26.4c0-.637-.25-1.247-.695-1.697a2.36 2.36 0 0 0-1.68-.703H8.376c-.63 0-1.234.253-1.68.703A2.4 2.4 0 0 0 6 26.4v3.598a12.35 12.35 0 0 0 2.66 7.69M23 29.999v.004a10.35 10.35 0 0 1-2.228 6.445a10.13 10.13 0 0 1-5.273 3.492a10.13 10.13 0 0 1-5.271-3.492A10.35 10.35 0 0 1 8 30.002V26.4c0-.113.045-.217.117-.29a.36.36 0 0 1 .257-.11h14.252c.092 0 .185.037.257.11a.4.4 0 0 1 .117.29z","clip-rule":"evenodd"})],-1)]),8,_a))]),s(t(F),null,{default:o(()=>[d[8]||(d[8]=a("h3",{class:"ion-label-h3"},"Vaccines",-1)),a("p",{innerHTML:y(i)},null,8,wa)]),_:2,__:[8]},1024)]),_:2},1024),s(t(W),null,{default:o(()=>[a("div",Da,[(h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:l.value,height:c.value,viewBox:"0 0 32 32"},d[9]||(d[9]=[a("path",{fill:"currentColor",d:"m27 25.586l-2-2V21h-2v3.414L25.586 27z"},null,-1),a("path",{fill:"currentColor",d:"M24 31c-3.86 0-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7s-3.14 7-7 7m0-12c-2.757 0-5 2.243-5 5s2.243 5 5 5s5-2.243 5-5s-2.243-5-5-5m4-4h2V5c0-1.103-.897-2-2-2h-3v2h3z"},null,-1),a("circle",{cx:"9",cy:"13",r:"2",fill:"currentColor"},null,-1),a("circle",{cx:"16",cy:"13",r:"2",fill:"currentColor"},null,-1),a("circle",{cx:"23",cy:"13",r:"2",fill:"currentColor"},null,-1),a("path",{fill:"currentColor",d:"M7 23H4c-1.103 0-2-.897-2-2V5c0-1.103.897-2 2-2h3v2H4v16h3z"},null,-1)]),8,Ma))]),s(t(F),null,{default:o(()=>[d[11]||(d[11]=a("h3",{class:"ion-label-h3"},"Session type",-1)),a("p",null,[H(S(i.session_type)+" ("+S(i.repeat_type)+" repeat - ",1),a("span",null,[a("b",null,S(i.frequency)+" times",1)]),d[10]||(d[10]=H(")"))])]),_:2,__:[11]},1024)]),_:2},1024),s(t(W),null,{default:o(()=>[a("div",Sa,[(h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:l.value,height:c.value,viewBox:"0 0 256 256"},d[12]||(d[12]=[a("g",{fill:"currentColor"},[a("path",{d:"M112 168a32 32 0 1 1-32-32a32 32 0 0 1 32 32M80 32a32 32 0 1 0 32 32a32 32 0 0 0-32-32m96 104a32 32 0 1 0 32 32a32 32 0 0 0-32-32m0-40a32 32 0 1 0-32-32a32 32 0 0 0 32 32",opacity:"0.2"}),a("path",{d:"M27.2 126.4a8 8 0 0 0 11.2-1.6a52 52 0 0 1 83.2 0a8 8 0 0 0 11.2 1.59a7.7 7.7 0 0 0 1.59-1.59a52 52 0 0 1 83.2 0a8 8 0 0 0 12.8-9.61A67.85 67.85 0 0 0 203 93.51a40 40 0 1 0-53.94 0a67.3 67.3 0 0 0-21 14.31a67.3 67.3 0 0 0-21-14.31a40 40 0 1 0-53.94 0A67.9 67.9 0 0 0 25.6 115.2a8 8 0 0 0 1.6 11.2M176 40a24 24 0 1 1-24 24a24 24 0 0 1 24-24m-96 0a24 24 0 1 1-24 24a24 24 0 0 1 24-24m123 157.51a40 40 0 1 0-53.94 0a67.3 67.3 0 0 0-21 14.31a67.3 67.3 0 0 0-21-14.31a40 40 0 1 0-53.94 0A67.9 67.9 0 0 0 25.6 219.2a8 8 0 1 0 12.8 9.6a52 52 0 0 1 83.2 0a8 8 0 0 0 11.2 1.59a7.7 7.7 0 0 0 1.59-1.59a52 52 0 0 1 83.2 0a8 8 0 0 0 12.8-9.61A67.85 67.85 0 0 0 203 197.51M80 144a24 24 0 1 1-24 24a24 24 0 0 1 24-24m96 0a24 24 0 1 1-24 24a24 24 0 0 1 24-24"})],-1)]),8,ba))]),s(t(F),null,{default:o(()=>[d[13]||(d[13]=a("h3",{class:"ion-label-h3"},"Assignees",-1)),a("p",null,S(i.assignees.map(n=>"".concat(n.given_name,"\n                                ").concat(n.family_name)).join(", ")),1)]),_:2,__:[13]},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):E("",!0)]),_:1})],64))}}),xa=Se(Va,[["__scopeId","data-v-2367d70b"]]),ke=[{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Session name",value:"",name:"batch",eventType:"input",alertsErrorMassage:"",valueType:"text",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"Start Date",icon:Q.calenderPrimary,value:"",name:"start date",eventType:"input",alertsErrorMassage:"",required:!0,isDatePopover:!0,minDate:"",maxDate:"",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"End date",icon:Q.calenderPrimary,value:"",name:"end date",eventType:"input",alertsErrorMassage:"",required:!0,isDatePopover:!0,minDate:"",maxDate:"",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"Session type",icon:Q.search,value:"",name:"product name",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isSingleSelect:!0,trackBy:"id",multiSelectData:[{id:"1",name:"Static"},{id:"2",name:"Outreach"}]}]}]}},{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Repeat",icon:Q.search,value:"",name:"repeat",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isSingleSelect:!0,trackBy:"id",multiSelectData:[{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]}]}]}},{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Assignees",icon:Q.search,value:[],name:"assignees",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isMultiSelect:!0,trackBy:"user_id",multiSelectData:[]}]}]}}],ka=Je("immunizationSessionsStore",{state:()=>({immunizationSessions:[...ke]}),actions:{setImmunizationSessions(A){this.immunizationSessions=A},getImmunizationSessions(){return[...va.cloneDeep(ke)]},resetFieldValues(){const A={string:"",number:0,boolean:!1,array:new Array,object:{}};this.immunizationSessions.forEach(p=>{p.data.rowData.forEach(c=>{c.colData.forEach(l=>{l.value=A[Array.isArray(l.value),"array"]})})})}}}),Ia="Immunization session schedule created successfully",Aa="Immunization session schedule creation failed",oe=(A,p,c,l,b,D)=>{const y=[];if(A.trim()||y.push({field:"sessionName",message:"Session name is required."}),Array.isArray(p))if(p.length!==2)y.push({field:"dateRange",message:"Date range is required."});else{const[N,x]=p;N>x&&y.push({field:"dateRange",message:"Start date must be before end date."})}else typeof p=="string"&&p.trim()===""&&y.push({field:"dateRange",message:"A date is required."});if(c||y.push({field:"repeatType",message:"Repeat type is required."}),c!=="Never"&&(!l||l<1)){const N={Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"};y.push({field:"numberOfDays",message:"Number of ".concat(N[c]," is required.")})}return b||y.push({field:"sessionType",message:"Session type is required."}),D.length===0&&y.push({field:"assignees",message:"At least one assignee is required."}),{isValid:y.length===0,errors:y}},Ea={key:0,class:"spinner-overlay"},Na={key:0,class:"alerts_error"},$a={style:{"margin-top":"20px"}},za={key:0,class:"alerts_error"},Ca={key:0,style:{"margin-top":"20px"}},Ta={style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},Ha={key:0,class:"alerts_error"},Ra={style:{"margin-top":"20px"}},qa={key:0,class:"alerts_error"},Oa={style:{"margin-top":"20px"}},Pa={key:0,class:"alerts_error"},Ua={style:{"margin-top":"20px"}},Ba={key:0,class:"alerts_error"},Wa=ie({__name:"AddImmunizationSessionModal",setup(A){const p=ka(),c=v(!1),l=v(),b=r=>C(new Date(r),"MM/dd/yyyy"),D=v([{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]),y=v(""),N=v([{id:"1",name:"Static"},{id:"2",name:"Outreach"}]),x=v(""),k=v(!1),M=v(1),d=v([]),i=v(""),u=v([]),n=v(""),_=v(""),V=v(""),$=v(""),z=v(""),g=v(""),T=R(()=>y.value===null?!0:y.value.toLowerCase()!=="daily"),P=R(()=>{if(!l.value)return"";if(Array.isArray(l.value)){const[r,e]=l.value;return!r&&!e?"":!r||!e?b(r||e):"".concat(b(r)," - ").concat(b(e))}return b(l.value)}),de=R(()=>Array.isArray(l.value)&&l.value!==void 0?b(l.value[0]):!Array.isArray(l.value)&&l.value!==void 0&&l.value!==void 0?b(String(l.value)):""),ue=R(()=>Array.isArray(l.value)?b(l.value[1]):Array.isArray(l.value)?"":l.value!==void 0?b(String(l.value)):""),ee=R(()=>({Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"})[y.value]||""),ae=R(()=>"Enter number of ".concat(ee.value)),ce=async()=>{const r=oe(i.value,l.value||String,y.value,M.value,x.value,u.value);if(r.isValid){c.value=!0;const e=d.value.filter(q=>u.value.includes(q.username)).map(q=>q.id),f={session_name:i.value,start_date:C(new Date(de.value),"yyyy-MM-dd"),end_date:C(new Date(ue.value),"yyyy-MM-dd"),session_type:x.value,repeat:y.value,assignees:e,frequency:M.value};await new re().create(f),f?Me(Ia):U(Aa),c.value=!1,p.resetFieldValues(),O.dismiss("dismiss")}else te(r.errors),U("Please make sure to fill all required fields"),c.value=!1},te=r=>{const e={sessionName:n,dateRange:_,repeatType:V,numberOfDays:$,sessionType:z,assignees:g};Object.keys(e).forEach(f=>{e[f].value=""}),r.forEach(f=>{e[f.field]&&(e[f.field].value=f.message)})},ve=async(r="")=>{const f=(await He.getUsersByRole({role:"Health Surveillance"})).map(m=>({...m,name:m.username,id:m.user_id}));d.value=f},X=()=>{O.dismiss({update:!0})};j(y,(r,e)=>{if(r===e)return;const f={null:()=>{k.value=!1},Never:()=>{k.value=!1},Daily:()=>{k.value=!0,M.value=1,l.value=""},Weekly:()=>{k.value=!0,M.value=1,Array.isArray(l.value)||(l.value=[])},Monthly:()=>{k.value=!0,M.value=1,Array.isArray(l.value)||(l.value=[])},default:()=>{k.value=!0,M.value=1}};(f[r]||f.default)()}),j([i,l,y,M,x,u],()=>{const r=oe(i.value,l.value||String,y.value,M.value,x.value,u.value);te(r.errors)});const pe=()=>{U("Weekly repeat type is not available for more than 7 days"),l.value=void 0};return j(l,r=>{if(!Array.isArray(r)||r.length!==2)return;const[e,f]=r,m=ne(f,e);y.value==="Weekly"&&m>7&&pe()}),De(async()=>{await ve()}),(r,e)=>{const f=Y("ion-spinner"),m=Y("VueDatePicker"),q=Y("ion-col"),Re=Y("ion-row");return h(),w(se,null,[c.value?(h(),w("div",Ea,[s(f,{name:"bubbles"}),e[9]||(e[9]=a("div",{class:"loading-text"},"Please wait...",-1))])):E("",!0),s(t(we),null,{default:o(()=>[s(t(ge),null,{default:o(()=>[s(t(he),{class:"modalTitle"},{default:o(()=>e[10]||(e[10]=[H("Create Immunization Session Schedule")])),_:1,__:[10]}),s(t(G),{fill:"clear",slot:"end",onClick:e[0]||(e[0]=I=>X())},{default:o(()=>[s(t(B),{icon:t(_e),color:"white"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),Ee(s(t($e),{trigger:"open-loading",message:"Saving, please wait..."},null,512),[[Ne,c.value]]),s(t(le),{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:o(()=>[a("div",null,[e[11]||(e[11]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session name",-1)),s(t(J),{clear:"",fill:"outline",placeholder:"Enter the session name",modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=I=>i.value=I)},null,8,["modelValue"]),n.value?(h(),w("div",Na,S(n.value),1)):E("",!0)]),a("div",$a,[e[12]||(e[12]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Repeat type",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:D.value.map(I=>I.name),modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=I=>y.value=I),searchable:!1,"show-labels":!1,placeholder:"Select repeat type"},null,8,["options","modelValue"]),V.value?(h(),w("div",za,S(V.value),1)):E("",!0)]),k.value?(h(),w("div",Ca,[a("label",Ta,"Number of "+S(ee.value),1),s(t(J),{modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=I=>M.value=I),clear:"",fill:"outline",placeholder:ae.value},null,8,["modelValue","placeholder"]),$.value?(h(),w("div",Ha,S($.value),1)):E("",!0)])):E("",!0),a("div",Ra,[e[13]||(e[13]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Start & End Date",-1)),s(m,{required:"",position:"left",placeholder:"select start & end date",range:T.value,ui:{input:"datepicker"},format:"dd/MM/yyyy",modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=I=>l.value=I),"min-date":new Date},{trigger:o(()=>[s(t(J),{clear:"",fill:"outline",placeholder:"select start & end date",value:"".concat(P.value)},{default:o(()=>[s(t(B),{slot:"start",icon:t(ze)},null,8,["icon"])]),_:1},8,["value"])]),_:1},8,["range","modelValue","min-date"]),_.value?(h(),w("div",qa,S(_.value),1)):E("",!0)]),a("div",Oa,[e[14]||(e[14]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session type",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:N.value.map(I=>I.name),modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=I=>x.value=I),searchable:!1,"show-labels":!1,placeholder:"Select session type"},null,8,["options","modelValue"]),z.value?(h(),w("div",Pa,S(z.value),1)):E("",!0)]),a("div",Ua,[e[15]||(e[15]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Assignees",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:d.value.map(I=>I.username),modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=I=>u.value=I),searchable:!1,"show-labels":!1,placeholder:"Select assignees"},null,8,["options","modelValue"]),g.value?(h(),w("div",Ba,S(g.value),1)):E("",!0)])]),_:1}),s(t(Ce),{collapse:"fade"},{default:o(()=>[s(Re,null,{default:o(()=>[s(q,null,{default:o(()=>[s(t(G),{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:e[7]||(e[7]=I=>X())},{default:o(()=>e[16]||(e[16]=[H(" Cancel ")])),_:1,__:[16]})]),_:1}),s(q,null,{default:o(()=>[s(Te,{onClick:e[8]||(e[8]=I=>ce()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}}}),Fa=Se(Wa,[["__scopeId","data-v-097a281e"]]),La={class:"ion-padding"},ja={key:0,class:"alerts_error"},Ja={style:{"margin-top":"20px"}},Za={key:0,class:"alerts_error"},Ga={key:0,style:{"margin-top":"20px"}},Xa={style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},Ka={key:0,class:"alerts_error"},Qa={style:{"margin-top":"20px"}},Ya={key:0,class:"alerts_error"},et={style:{"margin-top":"20px"}},at={key:0,class:"alerts_error"},tt={style:{"margin-top":"20px"}},st={key:0,class:"alerts_error"},lt=ie({__name:"EditImmunizationSessionModal",props:{data:{required:!0,type:Object}},setup(A){const p=A,c=v(!1),l=v(),b=v([{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]),D=v(""),y=v([{id:"1",name:"Static"},{id:"2",name:"Outreach"}]),N=v(""),x=v(!1),k=v(1),M=v([]),d=v(""),i=v([]),u=v(""),n=v(""),_=v(""),V=v(""),$=v(""),z=v(""),g=r=>C(new Date(r),"MM/dd/yyyy"),T=R(()=>D.value===null?!0:D.value.toLowerCase()!=="daily"),P=R(()=>{if(!l.value)return"";if(Array.isArray(l.value)){const[r,e]=l.value;return!r&&!e?"":!r||!e?g(r||e):"".concat(g(r)," - ").concat(g(e))}return g(l.value)}),de=R(()=>Array.isArray(l.value)?g(l.value[0]):Array.isArray(l.value)?"":l.value!==void 0?g(String(l.value)):""),ue=R(()=>Array.isArray(l.value)?g(l.value[1]):Array.isArray(l.value)?"":l.value!==void 0?g(String(l.value)):""),ee=R(()=>({Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"})[D.value]||""),ae=r=>{const e={sessionName:u,dateRange:n,repeatType:_,numberOfDays:V,sessionType:$,assignees:z};Object.keys(e).forEach(f=>{e[f].value=""}),r.forEach(f=>{e[f.field]&&(e[f.field].value=f.message)})},ce=async()=>{const r=oe(d.value,l.value,D.value,k.value,N.value,i.value);if(r.isValid){c.value=!0;const e=M.value.filter(q=>i.value.includes(q.username)).map(q=>q.id),f={session_name:d.value,start_date:C(new Date(de.value),"yyyy-MM-dd"),end_date:C(new Date(ue.value),"yyyy-MM-dd"),session_type:N.value,repeat:D.value,assignees:e,frequency:k.value},m=new re;console.log(p.data),await m.update(f,p.data.session_schedule_id),f?Me("Immunization session schedule updated successfully!"):U("An error occurred, please try again later"),c.value=!1,O.dismiss("dismiss")}else ae(r.errors),U("Please make sure to fill all required fields"),c.value=!1},te=()=>{d.value=p.data.session_name,l.value=p.data.repeat_type.toLowerCase()=="daily"?p.data.start_date:[new Date(p.data.start_date),new Date(p.data.end_date)],D.value=p.data.repeat_type,N.value=p.data.session_type,k.value=p.data.frequency,i.value=p.data.assignees.map(r=>r.username)},ve=async(r="")=>{const f=(await He.getUsersByRole({role:"Health Surveillance"})).map(m=>({...m,name:m.username,id:m.user_id}));M.value=f},X=()=>{O.dismiss({update:!1})};j(D,(r,e)=>{if(r===e)return;const f={null:()=>{x.value=!1},Never:()=>{x.value=!1},Daily:()=>{x.value=!0,k.value=1,l.value=""},Weekly:()=>{x.value=!0,typeof l.value=="string"&&(l.value=[])},Monthly:()=>{x.value=!0,typeof l.value=="string"&&(l.value=[])},default:()=>{x.value=!0}};(f[r]||f.default)()}),j([d,l,D,k,N,i],()=>{const r=oe(d.value,l.value,D.value,k.value,N.value,i.value);ae(r.errors)});const pe=()=>{U("Weekly repeat type is not available for more than 7 days"),l.value=void 0};return j(l,r=>{if(!Array.isArray(r)||r.length!==2)return;const[e,f]=r,m=ne(f,e);D.value==="Weekly"&&m>7&&pe()}),De(()=>{ve(),te()}),(r,e)=>{const f=Y("VueDatePicker");return h(),w(se,null,[s(t(we),null,{default:o(()=>[s(t(ge),null,{default:o(()=>[s(t(he),{class:"modalTitle"},{default:o(()=>e[9]||(e[9]=[H("Edit Immunization Session Schedule")])),_:1,__:[9]}),s(t(G),{fill:"clear",slot:"end",onClick:e[0]||(e[0]=m=>X())},{default:o(()=>[s(t(B),{icon:t(_e),color:"white"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),Ee(s(t($e),{trigger:"open-loading",message:"Saving, please wait..."},null,512),[[Ne,c.value]]),a("div",La,[a("div",null,[e[10]||(e[10]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session name",-1)),s(t(J),{clear:"",fill:"outline",placeholder:"Enter the session name",modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=m=>d.value=m)},null,8,["modelValue"]),u.value?(h(),w("div",ja,S(u.value),1)):E("",!0)]),a("div",Ja,[e[11]||(e[11]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Repeat type",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:b.value.map(m=>m.name),modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=m=>D.value=m),searchable:!1,"show-labels":!1,placeholder:"Select repeat type"},null,8,["options","modelValue"]),_.value?(h(),w("div",Za,S(_.value),1)):E("",!0)]),x.value?(h(),w("div",Ga,[a("label",Xa,"Number of "+S(ee.value),1),s(t(J),{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=m=>k.value=m),clear:"",fill:"outline",placeholder:"Enter the number of days"},null,8,["modelValue"]),V.value?(h(),w("div",Ka,S(V.value),1)):E("",!0)])):E("",!0),a("div",Qa,[e[12]||(e[12]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Start & End Date",-1)),s(f,{required:"",position:"left",placeholder:"select start & end date",range:T.value,ui:{input:"datepicker"},format:"dd/MM/yyyy",modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=m=>l.value=m),"min-date":new Date},{trigger:o(()=>[s(t(J),{clear:"",fill:"outline",placeholder:"select start & end date",value:"".concat(P.value)},{default:o(()=>[s(t(B),{slot:"start",icon:t(ze)},null,8,["icon"])]),_:1},8,["value"])]),_:1},8,["range","modelValue","min-date"]),n.value?(h(),w("div",Ya,S(n.value),1)):E("",!0)]),a("div",et,[e[13]||(e[13]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session type",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:y.value.map(m=>m.name),modelValue:N.value,"onUpdate:modelValue":e[5]||(e[5]=m=>N.value=m),searchable:!1,"show-labels":!1,placeholder:"Select session type"},null,8,["options","modelValue"]),$.value?(h(),w("div",at,S($.value),1)):E("",!0)]),a("div",tt,[e[14]||(e[14]=a("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Assignees",-1)),s(t(Z),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:M.value.map(m=>m.username),modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=m=>i.value=m),searchable:!1,"show-labels":!1,placeholder:"Select assignees"},null,8,["options","modelValue"]),z.value?(h(),w("div",st,S(z.value),1)):E("",!0)])]),s(t(Ce),{collapse:"fade"},{default:o(()=>[s(t(Ze),null,{default:o(()=>[s(t(Ve),null,{default:o(()=>[s(t(G),{onClick:e[7]||(e[7]=m=>X()),id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:o(()=>e[15]||(e[15]=[H(" Cancel ")])),_:1,__:[15]})]),_:1}),s(t(Ve),null,{default:o(()=>[s(Te,{onClick:e[8]||(e[8]=m=>ce()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}}}),nt={key:0,class:"spinner-overlay"},ot={class:"container"},it={style:{"margin-top":"15px"}},rt=ie({__name:"ScheduleImmunizationSessions",setup(A){const p=v([]),c=v(!1),l=xe(),b=Ge({selectedDate:C(new Date,"yyyy-MM-dd"),defaultView:l.name,isDark:!1,isResponsive:!0,views:[xe(),Xe(),Ke(),Qe()],events:[],callbacks:{onEventClick(i){const u=p.value.filter(n=>n.session_schedule_id===i.id);k(u)}}});async function D(){c.value=!0;try{const u=await new re().getSessions();b.events.getAll().forEach(n=>{b.events.remove(n.id)}),u.forEach(n=>{var $;const _={Weekly:y(C(new Date(n.start_date),"yyyy-MM-dd '08:00'"),C(new Date(n.end_date),"yyyy-MM-dd '16:00'"),n.frequency||1),Never:[{start_date:new Date(n.start_date),end_date:new Date(n.end_date)}],Daily:N(C(new Date(n.start_date),"yyyy-MM-dd '08:00'"),n.frequency||1),Monthly:x(C(new Date(n.start_date),"yyyy-MM-dd '08:00'"),C(new Date(n.end_date),"yyyy-MM-dd '16:00'"),n.frequency||1)},V=(($=n.repeat_type)==null?void 0:$.toString())||"Never";_[V].forEach(z=>{var g;b.events.add({id:Number(n.session_schedule_id),title:n.session_name,start:C(new Date(z.start_date),"yyyy-MM-dd HH:mm"),end:C(new Date(z.end_date),"yyyy-MM-dd HH:mm"),people:(g=n.assignees)==null?void 0:g.map(T=>T.username),location:n.target})})}),p.value=u}catch(i){console.error(i)}finally{c.value=!1}}const y=(i,u,n)=>{const _=K(i,"yyyy-MM-dd HH:mm",new Date),V=K(u,"yyyy-MM-dd HH:mm",new Date);if(isNaN(_.getTime())||isNaN(V.getTime()))throw new Error("Invalid date format");const $=ne(V,_),z=[];let g=na(_),T=0;for(;T<n;){const P=fe(g,$);ye(g)||(z.push({start_date:g,end_date:P}),T++),g=oa(g,1)}return z},N=(i,u)=>{const n=K(i,"yyyy-MM-dd HH:mm",new Date);if(isNaN(n.getTime()))throw new Error("Invalid start date format");const _=[];let V=n,$=0;for(;$<u;)ye(V)||(_.push({start_date:new Date(V.setHours(0,0,0,0)),end_date:new Date(V.setHours(23,59,59,999))}),$++),V=fe(V,1);return _},x=(i,u,n)=>{const _=K(i,"yyyy-MM-dd HH:mm",new Date),V=K(u,"yyyy-MM-dd HH:mm",new Date);if(isNaN(_.getTime())||isNaN(V.getTime()))throw new Error("Invalid date format");const $=ne(V,_),z=[];let g=ia(_),T=0;for(;T<n;){const P=fe(g,$);ye(g)||(z.push({start_date:g,end_date:P}),T++),g=ra(g,1)}return z};async function k(i){if(i.length>0){const u=await O.create({component:xa,componentProps:{data:i},cssClass:"otherVitalsModal largeModal mobileView"});await u.present();const{data:n}=await u.onDidDismiss();n&&(n.update&&D(),n.edit&&M(n,"modal"))}}const M=async(i,u="view")=>{const n=await O.create({component:lt,cssClass:"otherVitalsModal",componentProps:{data:i.edit,showName:""}});await n.present();const{data:_}=await n.onDidDismiss();_==="dismiss"&&D()},d=()=>{ua(Fa,{class:"otherVitalsModal largeModal"}).then(u=>{u&&D()})};return De(async()=>{await D()}),(i,u)=>(h(),Ae(t(la),{class:sa({loading:c.value})},{default:o(()=>[c.value?(h(),w("div",nt,[s(t(Ie),{name:"bubbles"}),u[1]||(u[1]=a("div",{class:"loading-text"},"Please wait...",-1))])):E("",!0),s(da),s(t(le),null,{default:o(()=>[a("div",ot,[u[2]||(u[2]=a("h1",{class:"heading"},"Schedule Immunization Sessions",-1)),a("div",it,[s(t(Ye),{"calendar-app":t(b)},null,8,["calendar-app"])])]),s(t(ea),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:o(()=>[s(t(aa),{onClick:u[0]||(u[0]=n=>d())},{default:o(()=>[s(t(B),{icon:t(ta)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}}),ft=Se(rt,[["__scopeId","data-v-e2bb2908"]]);export{ft as default};
