import{c as l,d as M,a as G,y as $,f,u as t,r as p,bW as le,au as ue,z as _,e as y,m as h,l as u,k as c,bP as ce,S as de,a9 as me,i as F,v as R,V as fe,W as L,A as B,F as ve,L as pe,p as A,af as _e}from"./vendor-BsZAuWFl.js";import{u as Y,e as U,R as q,c as ye,f as ge,d as he,a as Fe,_ as Re,b as ke}from"./BirthRegistration.vue_vue_type_script_setup_true_lang-BfdUDen2.js";import{_ as j}from"./StandardForm.vue_vue_type_script_setup_true_lang-CLG7dJ4i.js";import{i as J,ak as N,S as W,t as we,A as Pe,_ as Ve}from"./index-xeAXLgY8.js";import"./lodash-Dt8AsbQm.js";import"./vaccines_service-BRXHDMAt.js";import"./app_encounter_service-CmxD9NQd.js";import"./sms_service-CCiRaSom.js";import"./appointment_service-DLf6ASe2.js";import"./EIRreportsStore-C6kJ0nS9.js";import"./Export-Cekdy6Kd.js";import"./relations_service-BM7yPXPz.js";const be=()=>{const{countriesList:o}=Y();return{country:l(()=>[{componentType:"Heading",name:"Country",position:"center"},{componentType:"multiSelectInputField",header:"Country",name:"country",trackBy:"district_id",openDirection:"auto",icon:J.search,validation:v=>N.required(v),options:o.value}])}},Ce=M({__name:"Country",setup(o,{expose:s}){const{country:v}=be(),{formRef:a,exposeFormMethods:r}=U();return G(()=>{var d;(d=a.value)==null||d.setFormValue("country",{district_id:292,name:"Malawi",region_id:4})}),s(r()),(d,g)=>(f(),$(j,{formData:t(v),ref_key:"formRef",ref:a},null,8,["formData"]))}}),xe=()=>{const{facilityList:o,getFacilities:s}=Y();return s(),{patientType:l(()=>[{componentType:"Heading",name:"Patient Type",position:"center"},{componentType:"radioButtonField",header:"Patient Type",name:"patient_type",type:"inline",validation:N.required,options:[{label:"New patient",value:"New patient"},{label:"Emergency supply",value:"Emergency supply"},{label:"External consultation",value:"External consultation"}]},{componentType:"multiSelectInputField",header:"Facility",name:"facility",trackBy:"facility_id",openDirection:"auto",icon:J.search,validation:a=>N.required(a),options:o.value.facilities,condition:a=>(a==null?void 0:a.patient_type)=="Emergency supply"||(a==null?void 0:a.patient_type)=="External consultation"}])}},Ie=M({__name:"PatientType",setup(o,{expose:s}){const{patientType:v}=xe(),{formRef:a,exposeFormMethods:r}=U();return s(r()),(d,g)=>(f(),$(j,{formData:t(v),ref_key:"formRef",ref:a},null,8,["formData"]))}});function Te(){const o=p(1),s=p(4),v=4,a=()=>{const m=window.innerWidth;return m>=992?4:m>=768?3:m>=576?2:1},r=l(()=>s.value===0?v:Math.ceil(v/s.value)),d=l(()=>r.value>1),g=l(()=>d.value&&o.value>1),w=l(()=>d.value&&o.value<r.value),P=m=>{if(r.value===1)return!0;const x=(o.value-1)*s.value,I=x+s.value-1;return m>=x&&m<=I},V=()=>{o.value<r.value&&o.value++},b=()=>{o.value>1&&o.value--},C=m=>{m>=1&&m<=r.value&&(o.value=m)},k=()=>{s.value=a(),o.value>r.value&&(o.value=r.value),o.value===0&&r.value>0&&(o.value=1)};return G(()=>{window.addEventListener("resize",k),k()}),le(()=>{window.removeEventListener("resize",k)}),{currentPage:o,columnsPerRow:s,totalPages:r,showPaginationButtons:d,showPreviousButton:g,showNextButton:w,nextPage:V,prevPage:b,goToPage:C,handleResize:k,isCardVisible:P}}const Le={key:0,class:"spinner-overlay"},Be={class:"masonry-grid"},$e={class:"card-container"},De={class:"custom-card"},Se={class:"card-container"},Ee={key:0,class:"custom-card"},Ne={key:1,class:"custom-card"},Me={class:"custom-card card-margin-top"},He={key:0,class:"card-container"},ze={class:"custom-card"},Ae={class:"custom-card card-margin-top"},qe={class:"card-container"},We={class:"custom-card"},Ge={key:0,class:"custom-card card-margin-top"},Ye={class:"footer-content"},Ue={class:"footer-buttons-left"},je={key:0,class:"pagination-dots"},Je=["onClick","aria-label"],Ke={class:"footer-buttons-right"},Oe=M({__name:"Registration",setup(o){const s=p(!1),v=ue(),a=p(null),r=p(null),d=p(null),g=p(null),w=p(null),P=p(null),V=p(null),b=p(null),C=l(()=>{var e;return((e=a.value)==null?void 0:e.currentFormValues)||{}}),k=l(()=>{var e;return((e=r.value)==null?void 0:e.currentFormValues)||{}}),m=l(()=>{var e;return((e=d.value)==null?void 0:e.currentFormValues)||{}}),x=l(()=>{var e;return((e=g.value)==null?void 0:e.currentFormValues)||{}}),I=l(()=>{var e;return((e=w.value)==null?void 0:e.currentFormValues)||{}}),K=l(()=>{var e;return((e=P.value)==null?void 0:e.currentFormValues)||{}}),O=l(()=>{var e;return((e=V.value)==null?void 0:e.currentFormValues)||{}}),Q=l(()=>{var e;return((e=b.value)==null?void 0:e.currentFormValues)||{}}),X=l(()=>({personalInformation:C.value,birthRegistration:k.value,socialHistory:m.value,country:x.value,currentLocation:I.value,homeLocation:K.value,guardianInformation:O.value,patientType:Q.value})),Z=()=>{const e=[a,r,d,g,w,P,V,b];return e.forEach(n=>{var i;return(i=n.value)==null?void 0:i.validateForm()}),e.every(n=>{var i;return((i=n.value)==null?void 0:i.validateForm())==null})},D=l(()=>new q().checkIfChild(C.value)),{nextPage:ee,prevPage:te,goToPage:ne,isCardVisible:T,showPreviousButton:oe,showPaginationButtons:ae,totalPages:H,currentPage:z,showNextButton:re}=Te(),se=async()=>{if(!Z()){we("Please fill in all required fields");return}await new q().saveRegistrationData(X.value)&&(W.getProgramID()==32?S("/NCDEnrollment"):S("/patientProfile"))},ie=async()=>{await Pe("Do you want to cancel registration?","",{confirmBtnLabel:"Yes",icon:"",showBackdrop:!0})&&S("/home")},S=e=>{v.push({path:e})};return(e,n)=>(f(),$(t(_e),{class:A({loading:s.value})},{default:_(()=>[s.value?(f(),y("div",Le,[u(t(ce),{name:"bubbles"}),n[3]||(n[3]=c("div",{class:"loading-text"},"Please wait...",-1))])):h("",!0),u(t(de),null,{default:_(()=>n[4]||(n[4]=[c("div",{class:"header-title"},"New Patient Registration",-1)])),_:1,__:[4]}),u(t(me),null,{default:_(()=>{var i,E;return[c("div",Be,[F(c("div",$e,[c("div",De,[u(ye,{ref_key:"personalInformationRef",ref:a},null,512)])],512),[[R,t(T)(0)]]),F(c("div",Se,[D.value.underNineMonths?(f(),y("div",Ee,[D.value.underNineMonths?(f(),$(ge,{key:0,ref_key:"birthRegistrationRef",ref:r},null,512)):h("",!0)])):h("",!0),D.value.moreThanThirteenYears?(f(),y("div",Ne,[u(he,{ref_key:"socialHistoryRef",ref:d},null,512)])):h("",!0),c("div",Me,[u(Ce,{ref_key:"countryRef",ref:g},null,512)])],512),[[R,t(T)(1)]]),((E=(i=x.value)==null?void 0:i.country)==null?void 0:E.name)==="Malawi"?F((f(),y("div",He,[c("div",ze,[u(Fe,{ref_key:"currentLocationRef",ref:w},null,512)]),c("div",Ae,[u(Re,{currentLocationFormValues:I.value,ref_key:"homeLocationRef",ref:P},null,8,["currentLocationFormValues"])])],512)),[[R,t(T)(2)]]):h("",!0),F(c("div",qe,[c("div",We,[u(ke,{personalInformationFormValues:C.value,ref_key:"guardianInformationRef",ref:V},null,8,["personalInformationFormValues"])]),t(W).getProgramID()==1?(f(),y("div",Ge,[u(Ie,{ref_key:"patientTypeRef",ref:b},null,512)])):h("",!0)],512),[[R,t(T)(3)]])])]}),_:1}),u(t(fe),null,{default:_(()=>[c("div",Ye,[c("div",Ue,[u(t(L),{color:"danger","aria-label":"Cancel registration",onClick:n[0]||(n[0]=i=>ie())},{default:_(()=>n[5]||(n[5]=[B("Cancel")])),_:1,__:[5]}),F(u(t(L),{onClick:n[1]||(n[1]=i=>t(te)()),"aria-label":"Go to previous page"},{default:_(()=>n[6]||(n[6]=[B("Previous")])),_:1,__:[6]},512),[[R,t(oe)]])]),t(ae)?(f(),y("div",je,[(f(!0),y(ve,null,pe(t(H),i=>(f(),y("span",{key:i,class:A({dot:!0,active:i===t(z)}),onClick:E=>t(ne)(i),"aria-label":"Go to page ".concat(i),role:"button"},null,10,Je))),128))])):h("",!0),c("div",Ke,[F(u(t(L),{name:"Save",onClick:se,"aria-label":"Save patient data"},{default:_(()=>n[7]||(n[7]=[B("Save")])),_:1,__:[7]},512),[[R,t(z)===t(H)]]),F(u(t(L),{onClick:n[2]||(n[2]=i=>t(ee)()),"aria-label":"Go to next page"},{default:_(()=>n[8]||(n[8]=[B("Next")])),_:1,__:[8]},512),[[R,t(re)]])])])]),_:1})]),_:1},8,["class"]))}}),ut=Ve(Oe,[["__scopeId","data-v-bbbeaa03"]]);export{ut as default};
