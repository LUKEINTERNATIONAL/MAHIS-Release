import{d as _,r as y,cF as x,a as P,e as p,y as T,z as l,l as s,x as a,aI as V,aJ as C,j as n,aK as S,A as d,br as w,f as v,F as L,J as k,G as B,bq as D,D as N,B as q,bj as R,m as j,V as A,aH as E}from"./vendor-65256339.js";import{a as G,L as H,t as u,b as J}from"./index-dd8b4458.js";import{P as g}from"./patient_type_service-ac489e6d.js";import"./lodash-7be49fbd.js";import"./apexcharts-583f3fdc.js";import"./chartjs-bbe0813a.js";import"./barcode-qrcode-reader-d9469be9.js";const U={key:0,class:"ion-padding"},z={class:"ion-padding"},Z=_({__name:"ARTPatientType",setup(K){const c=y(!1),f=y([]),m=y([]),b=new G,o=new g(b.getID(),-1),t=x({patientType:null,prevType:null,transerFacility:null});async function F(i=""){try{const e=await H.getFacilities({name:i});m.value=e}catch(e){console.error("Error fetching facilities:",e)}}function h(){var i;if(t.patientType!==t.prevType){if(!t.patientType)return u("Patient type is required");if(!/new patient/i.test(t.patientType)&&t.patientType!==t.prevType&&!t.transerFacility)return u("Facility is required");o.setPatientType(t.patientType),o.setLocationName(((i=t.transerFacility)==null?void 0:i.name)||""),o.save().then(e=>{e?J("Patient type saved successfully"):u("Failed to save patient type")}).catch(e=>u("Failed to save patient type: ".concat(e)))}}return P(()=>{c.value=!0,f.value=g.getPatientTypes(),o.loadPatientType().then(()=>{const i=o.getType();i&&!/n\/a/i.test(i)&&(t.prevType=o.getType(),t.patientType=o.getType())}).finally(()=>{c.value=!1})}),(i,e)=>(p(),T(a(E),{style:{height:"65vh"}},{default:l(()=>[s(a(V),null,{default:l(()=>[s(a(C),null,{default:l(()=>e[2]||(e[2]=[n("span",{class:"ion-text-center"},[n("h3",null," Patient type")],-1),n("hr",{style:{"border-top":"1px dashed #0c0c0c","margin-top":"10px"}},null,-1)])),_:1,__:[2]})]),_:1}),s(a(S),null,{default:l(()=>[n("div",null,[e[3]||(e[3]=n("h2",{style:{"font-weight":"bold",margin:"12px"}},[d("Patient Type "),n("span",{style:{color:"red"}},"*")],-1)),s(a(w),{modelValue:t.patientType,"onUpdate:modelValue":e[0]||(e[0]=r=>t.patientType=r)},{default:l(()=>[(p(!0),v(L,null,k(f.value,(r,I)=>(p(),T(a(B),{key:I},{default:l(()=>[s(a(D),{slot:"start",value:r.value},null,8,["value"]),s(a(N),{style:{margin:"10px"}},{default:l(()=>[d(q(r.label),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),t.prevType!==t.patientType&&!/new patient/i.test(t.patientType)?(p(),v("div",U,[e[4]||(e[4]=n("h2",{style:{"font-weight":"bold",margin:"12px"}},[d("Facility "),n("span",{style:{color:"red"}},"*")],-1)),s(a(R),{modelValue:t.transerFacility,"onUpdate:modelValue":e[1]||(e[1]=r=>t.transerFacility=r),multiple:!1,taggable:!1,"hide-selected":!0,"close-on-select":!0,openDirection:"bottom",onSearchChange:F,"tag-placeholder":"Find and select facility",placeholder:"Find and select facility",selectLabel:"",label:"name",searchable:!0,"track-by":"code",options:m.value},null,8,["modelValue","options"])])):j("",!0),n("div",z,[s(a(A),{disabled:c.value,onClick:h},{default:l(()=>e[5]||(e[5]=[d("Submit")])),_:1,__:[5]},8,["disabled"])])]),_:1})]),_:1}))}});export{Z as default};
