import{d as F,r as l,au as L,a as P,E as U,y as A,f as m,z as s,l as o,u as a,a9 as N,k as n,a$ as D,aY as M,d2 as R,T as K,e as I,A as f,B as g,a3 as w,D as k,cg as T,d3 as V,bF as H,d4 as O,W,af as $}from"./vendor-CKGLxZg5.js";import{m as S,J as q,K as j,l as b,t as G,I as J,M as Y,o as Q,N as X,_ as Z}from"./index-kdr2EpoV.js";import{i as ee}from"./Img-CJEgX1Vr.js";import"./lodash-Dt8AsbQm.js";const ae={class:"login-container"},te={key:0,style:{"justify-content":"center",display:"block"}},oe={style:{"font-size":"15px"}},se={style:{"font-size":"12px",color:"#34af4d"}},ne={key:1},le={style:{"font-size":"15px"}},ie={style:{"text-align":"left"}},re=F({__name:"Login",setup(ue){const i=l(""),r=l(""),p=l(""),u=l(!1),v=l("test"),c=l(new X),x=L(),C=S(),h=async()=>{C.terminate(),await S().postData("SET_OFFLINE_PROGRAMS")},z=()=>{p.value=localStorage.getItem("core_version")||""},B=async()=>{const t=J(),e=await Y();e&&(t.setUserFacilityName(e.name),t.setFacilityLocation(e),localStorage.setItem("facility_code",e.code))},E=async()=>{const t=await c.value.checkUserPrograms(void 0);t!=null&&t.programs&&Q().setAuthorizedPrograms(t==null?void 0:t.programs)},_=async()=>{if(i.value&&r.value){c.value.setUsername(i.value);try{await c.value.login(r.value),await B(),await E(),await q(),x.push("/home")}catch(t){t instanceof j?b("Invalid username or password"):b("".concat(t),5e4)}}else G("Complete form to log in")};return P(async()=>{localStorage.setItem("apiKey",""),await c.value.loadConfig(),z(),await h()}),(t,e)=>{const y=U("ion-icon");return m(),A(a($),null,{default:s(()=>[o(a(N),{class:"ion-padding login-page"},{default:s(()=>[n("div",ae,[o(a(D),{style:{"background-color":"#fff"}},{default:s(()=>[o(a(M),null,{default:s(()=>[o(a(R),{class:"login_img",src:a(ee)("mw.png"),id:"logo"},null,8,["src"]),o(a(K),{class:"login-title"},{default:s(()=>[v.value==="development"||v.value==="test"?(m(),I("span",te,[n("div",null,[e[3]||(e[3]=f(" MaHIS ")),n("small",oe,"(v"+g(p.value)+")",1)]),n("div",se,"("+g(v.value)+")",1)])):(m(),I("span",ne,[e[4]||(e[4]=f(" MaHIS ")),n("small",le,"(v"+g(p.value)+")",1)]))]),_:1}),n("span",ie,[o(a(w),{value:i.value,onIonInput:e[0]||(e[0]=d=>i.value=d.target.value||""),type:"text",label:"Username",ref:"usernameRef","label-placement":"floating",fill:"outline",placeholder:"Enter Username",class:"input-fields",required:""},{default:s(()=>[o(a(k),{slot:"end"},{default:s(()=>[o(y,{icon:a(T)},null,8,["icon"])]),_:1})]),_:1},8,["value"]),o(a(w),{value:r.value,onIonInput:e[2]||(e[2]=d=>r.value=d.target.value||""),type:u.value?"text":"password",label:"Password",ref:"passwordRef","label-placement":"floating",fill:"outline",placeholder:"Enter Password",class:"input-fields",required:"",onKeydown:V(_,["enter"])},{default:s(()=>[o(a(k),{slot:"end"},{default:s(()=>[o(y,{icon:u.value?a(H):a(O),onClick:e[1]||(e[1]=d=>u.value=!u.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type"])]),o(a(W),{expand:"block",style:{"--background":"var(--ion-color-primary)","font-size":"var(--ion-button-font)"},onClick:_,class:"login-button"},{default:s(()=>e[5]||(e[5]=[f(" Login ")])),_:1,__:[5]}),e[6]||(e[6]=n("p",{class:"signup-link"},[f("For help click "),n("a",{href:"#"},"Here")],-1))]),_:1,__:[6]})]),_:1})])]),_:1})]),_:1})}}}),ve=Z(re,[["__scopeId","data-v-fdd85313"]]);export{ve as default};
