!function(){function e(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}System.register(["./vendor-legacy-CFX0KWSj.js","./app_encounter_service-legacy-Cxa6AD1t.js","./index-legacy-D84VBdSl.js","./SelectFacility-legacy-xLTNWrs-.js","./BasicYesNoSelect-legacy-dM8jGnMM.js","./lodash-legacy-pOOc9Efu.js"],function(t,i){"use strict";var o,n,a,s,r,d,c,l,u,g,p,h,y,f,m,v,A,b,w,C,T,_,D,E,I,S,O,H,P,V,B,G,N,W,M,k,L,F,U,x,R,j,$,Y;return{setters:[e=>{o=e.d,n=e.r,a=e.w,s=e.cZ,r=e.a,d=e.y,c=e.f,l=e.z,u=e.l,g=e.u,p=e.aY,h=e.e,y=e.m,f=e.k,m=e.bm,v=e.aa,A=e.ab,b=e.M,w=e.F,C=e.L,T=e.J,_=e.G,D=e.D,E=e.A,I=e.B,S=e.da,O=e.ac,H=e.bN,P=e.aX,V=e.a3,B=e.a$,G=e.O},e=>{N=e.A},e=>{W=e.af,M=e.Y,k=e.L,L=e.P,F=e.a8,U=e.t,x=e.j,R=e.l,j=e._},e=>{$=e.S},e=>{Y=e.B},null],execute:function(){var i=document.createElement("style");i.textContent=".section-header ion-label[data-v-33541e66]{font-size:1rem;font-weight:600;letter-spacing:.5px;color:var(--ion-color-primary);text-transform:uppercase}ion-checkbox[data-v-33541e66]{--size: 24px !important}ion-radio[data-v-33541e66]{--size: 27px !important}.error[data-v-33541e66]{color:red;font-weight:700;font-style:italic}\n/*$vite$:1*/",document.head.appendChild(i);const q="2016-04-30",z={"Adults with stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:e=>4===e}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{reasonForArt:e=>"WHO STAGE IV ADULT"===e}},"Adults with stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:e=>3===e}},"Adults with stage 2 conditions":{concept:"WHO STAGE II ADULT",priority:4,conditions:{stage:e=>2===e}},"Adults with stage 1 conditions":{concept:"WHO STAGE I ADULT",priority:5,conditions:{stage:e=>1===e}}},Q={"Children with stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:1,conditions:{stage:e=>4===e}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV PEDS",priority:2,conditions:{reasonForArt:e=>"WHO STAGE IV PEDS"===e}},"For children with stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:3,conditions:{stage:e=>3===e}},"Children with stage 2 conditions":{concept:"WHO STAGE II PEDS",priority:4,conditions:{stage:e=>2===e}},"Children with stage 1 conditions":{concept:"WHO STAGE I PEDS",priority:5,conditions:{stage:e=>1===e}}},K={"Warn if Severe weight loss is selected when actual patient BMI is acceptable":{priority:1,actions:{alert:async e=>await W(`Patient's BMI of ${e.bmi} greater than 18.5, do you wish to proceed?`,{confirmBtnLabel:"Yes, keep severe weightloss",cancelBtnLabel:"No, cancel"})},conditions:{selectedCondition:e=>"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===e,bmi:e=>e>18.5}},"Warn for contradicting stage defining conditions":{priority:1,actions:{alert:async e=>!!(await W("CONTRADICTING STAGE DEFINING CONDITIONS",{confirmBtnLabel:"Keep Asymptomatic",cancelBtnLabel:"Keep other(s)"}))},conditions:{selectedCondition:e=>"Asymptomatic HIV infection"===e}}},J={"Enable TB staging condition if client is TB positive":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:()=>"Client registered as a TB Patient in the TB Module"},conditions:{tbPositive:e=>e,selectedCondition:e=>/\bTuberculosis \(PTB or EPTB\)|\bPulmonary tuberculosis/i.test(e)}},"Enable TB staging condition if client is EPTB positive":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:()=>"Client registered with EPTB in TB Module"},conditions:{eptbPositive:e=>e,selectedCondition:e=>/Extrapulmonary tuberculosis/i.test(e)}},"For children whose current weight percentile is less than 70":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:e=>`Child has a low weight percentile of ${e.weightPercentile}`},conditions:{selectedCondition:e=>"Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)"===e,weightPercentile:e=>e<70}},"Enable Moderate unexplained malnutrition for children whose weight for height is 70-79%":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:e=>`Child has weight percentile of ${e.weightPercentile}`},conditions:{selectedCondition:e=>"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===e,weightPercentile:e=>e>=70&&e<=79}},"Disable moderate weight loss when Severe unexplained weight loss is chosen":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:()=>"Severe weight loss/manutrition was already selected"},conditions:{selectedCondition:e=>"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===e,selectedConditions:e=>e.includes("Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)")}}},X={"Enable TB staging condition if client is TB positive":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:()=>"Client registered Positive in TB Module"},conditions:{tbPositive:e=>e,selectedCondition:e=>/\bTuberculosis \(PTB or EPTB\)|\bPulmonary tuberculosis/i.test(e)}},"Enable TB staging condition if client is EPTB positive":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:()=>"Client registered with EPTB in TB Module"},conditions:{eptbPositive:e=>e,selectedCondition:e=>/Extrapulmonary tuberculosis/i.test(e)}},"Adults with a BMI less than 16":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:e=>`Adult has a low BMI of ${e.bmi}`},conditions:{selectedCondition:e=>"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===e,bmi:e=>e<16}},"Adults whose BMI is between 16 and 18":{priority:3,actions:{isChecked:!0},description:{color:"warning",show:"onChecked",info:e=>`BMI of ${e.bmi} is between 16 and 18`},conditions:{selectedCondition:e=>"Moderate weight loss less than or equal to 10 percent, unexplained"===e,bmi:e=>e>=16&&e<=18.5}},"Disable Moderate weight loss if severe weightloss is selected":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:()=>"Severe weight loss was already selected"},conditions:{selectedCondition:e=>"Moderate weight loss less than or equal to 10 percent, unexplained"===e,selectedConditions:e=>e.includes("Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained")}}},Z={"Children under twelve months who tested positive on Rapid test and have presumed severe HIV":{concept:"PRESUMED SEVERE HIV",priority:1,conditions:{ageInMonths:e=>e<12,selectedConditions:e=>M.getConceptsByCategory("pshd_condition").some(t=>e.includes(t.name)),testType:e=>"HIV rapid test"===e}},"Has stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:2,conditions:{stage:e=>4===e}},"Has stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:3,conditions:{stage:e=>3===e}},"Children under twelve who tested positive via HIV DNA Polymerase Chain Reaction test":{concept:"HIV DNA polymerase chain reaction",priority:4,conditions:{ageInMonths:e=>e<12,testType:e=>"HIV DNA polymerase chain reaction"===e}},"Children who are less than 24 months":{concept:"HIV infected",priority:5,conditions:{ageInMonths:e=>e<24}},"Children between 24 and 56 months who have stage 2 or 1 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 750",priority:6,conditions:{ageInMonths:e=>e>=24&&e<=56,cd4Date:e=>new Date(e)<=new Date(q),cd4:e=>e<=750,cd4Modifier:e=>"<"===e||"="===e,stage:e=>e<=2}},"Children with CD4 count less than 500 and have stage 1 and stage 2 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:7,conditions:{cd4:e=>e<=500,cd4Date:e=>new Date(e)<=new Date(q),cd4Modifier:e=>"<"===e||"="===e,stage:e=>e<=2}},"Children who are more than five years old and have cd4 count less than 500":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:9,conditions:{cd4Date:e=>new Date(e)<=new Date(q),age:e=>e>5,cd4:e=>e<=500,cd4Modifier:e=>"<"===e||"="===e}},"Children over date 2014-04-01 and less than Five years old":{concept:"HIV infected",priority:10,conditions:{date:e=>e>="2014-04-01",age:e=>e<=5}},"Women who are breast feeding":{concept:"BREASTFEEDING",priority:11,conditions:{gender:e=>"F"===e,breastFeeding:e=>"Yes"===e,stage:e=>e<=2}},"Women who are pregnant":{concept:"PATIENT PREGNANT",priority:12,conditions:{gender:e=>"F"===e,pregnant:e=>"Yes"===e,stage:e=>e<=2}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:13,conditions:{stage:e=>e<=2}}},ee={"Has stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:e=>4===e}},"Has HIV wasting syndrome identified in stage 3":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{selectedConditions:e=>M.getConceptsByCategory("severe_hiv_wasting_syndrome").reduce((t,i)=>e.includes(i.name)?t+1:0,0)>=2}},"Has stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:e=>3===e}},"CD4 less than 350 for adults before 2014":{concept:"cd4 less than or equal to 350",priority:4,conditions:{cd4Date:e=>new Date(e)<=new Date(q),cd4:e=>e<=350,cd4Modifier:e=>"<"===e||"="===e}},"CD4 less than 250 for adults after 2014":{concept:"cd4 less than or equal to 250",priority:4,conditions:{cd4Date:e=>new Date(e)<=new Date(q),cd4:e=>e<=250,cd4Modifier:e=>"<"===e||"="===e}},"CD4 less than 350 for adults after 2014":{concept:"cd4 less than or equal to 350",priority:5,conditions:{cd4Date:e=>new Date(e)<=new Date(q),cd4:e=>e<=350,cd4Modifier:e=>"<"===e||"="===e}},"CD4 less than 500 for adults after 2014":{concept:"cd4 less than or equal to 500",priority:6,conditions:{cd4Date:e=>new Date(e)<=new Date(q),cd4:e=>e<=500,cd4Modifier:e=>"<"===e||"="===e}},"Women who are breast feeding":{concept:"BREASTFEEDING",priority:8,conditions:{gender:e=>"F"===e,breastFeeding:e=>"Yes"===e,stage:e=>e<=2}},"Women who are pregnant":{concept:"PATIENT PREGNANT",priority:7,conditions:{gender:e=>"F"===e,pregnant:e=>"Yes"===e,stage:e=>e<=2}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:9,conditions:{stage:e=>e<=2}}};class te extends N{constructor(t,i,o){super(t,52,o),e(this,"age",void 0),e(this,"confirmatoryTest",void 0),this.age=i,this.confirmatoryTest=null}isAdult(){return this.age>=15}isPedaid(){return this.age<=14}setAge(e){this.age=e}getFacilities(e=""){return k.getFacilities({name:e})}getConfirmatoryTestType(){return this.confirmatoryTest}cd4CountIsValid(e){try{return!!e.match(/^(=|<|>)([0-9]*)$/m)}catch(t){return!1}}getAlertGuidelines(){return K}getWhoStageGuidelines(){return this.isAdult()?z:Q}getProgramEligibilityGuidelines(){return this.isAdult()?ee:Z}getRecommendedConditionGuidelines(){return this.isAdult()?X:J}getStagingConditions(e){const t=this.getStagingCategoryByNum(e);return N.getConceptsByCategory(t)}buildWhoStageObs(e){return this.buildValueCoded("Who stage",e)}buildWhoCriteriaObs(e){return this.buildValueCoded("Who stages criteria present",e)}buildReasonForArtObs(e){return this.buildValueCoded("Reason for ART eligibility",e)}getStagingCategoryByNum(e){switch(e){case 1:return this.isAdult()?"stage_1_conditions_adults":"stage_1_conditions_pedaids";case 2:return this.isAdult()?"stage_2_conditions_adults":"stage_2_conditions_pedaids";case 3:return this.isAdult()?"stage_3_conditions_adults":"stage_3_conditions_pedaids";case 4:return this.isAdult()?"stage_4_conditions_adults":"stage_4_conditions_pedaids";default:return""}}async loadHivConfirmatoryTestType(){const e=await N.getFirstValueCoded(this.patientID,"Confirmatory hiv test type");e&&(this.confirmatoryTest=e)}}const ie={key:0,class:"ion-padding"},oe={class:"accordion_group ion-padding"},ne={style:{"font-weight":"bold"}},ae={class:"error"},se={class:"ion-padding",slot:"content"},re={class:"ion-padding"},de={class:"ion-padding"},ce={key:0,class:"ion-padding"},le={class:"error"},ue={class:"error"},ge={class:"error"},pe={class:"ion-padding",style:{"border-bottom":"dashed #ccc"}},he=o({__name:"Staging",props:{hideSubmit:{type:Boolean,default:!1},date:{default:te.getSessionDate()}},setup(e,{expose:t}){const i=e,o=new L,N=n({}),W=new te(o.getID(),o.getAge(),-1);a(()=>i.date,e=>{var t;const i=null!==(t=null==e?void 0:e.standardDate)&&void 0!==t?t:te.getSessionDate(),n=G(i).diff(o.getBirthdate(),"years");W.setAge(n),W.setDate(i)},{deep:!0,immediate:!0});const k=s({stage_4_conditions:{title:"Stage 4 Conditions",options:[]},stage_3_conditions:{title:"Stage 3 Conditions",options:[]},stage_2_conditions:{title:"Stage 2 Conditions",options:[]},stage_1_conditions:{title:"Stage 1 Conditions",options:[]}});n([]);const j=s({cd4:"",cd4Date:"",isChildBearing:!1,reasonForArt:"",pregnant:"",breastFeeding:"",cd4Available:"",cd4Location:"",whoStage:"",staging:[],confirmatoryTest:""}),q={reasonForArt:{buildObs:()=>W.buildReasonForArtObs(j.reasonForArt),suggestAvalue:()=>({"PRESUMED SEVERE HIV":{priority:1,condition:()=>o.getAgeInMonths()<12&&"HIV rapid test"===j.confirmatoryTest&&M.getConceptsByCategory("pshd_condition").some(e=>he().includes(e.name))},"WHO STAGE IV PEDS":{priority:2,condition:()=>W.isPedaid()&&z(["stage_4_conditions"])},"WHO STAGE III PEDS":{priority:3,condition:()=>W.isPedaid()&&z(["stage_3_conditions"])},"HIV DNA polymerase chain reaction":{priority:4,condition:()=>o.getAgeInMonths()<12&&"HIV DNA polymerase chain reaction"===j.confirmatoryTest},"CD4 COUNT LESS THAN OR EQUAL TO 750":{priority:5,condition:()=>Z(750)&&ee()&&Q()&&o.ageInMonths()>=24&&o.ageInMonths()<=56},"CD4 COUNT LESS THAN OR EQUAL TO 500":{priority:6,condition:()=>W.isPedaid()&&Z(500)&&ee()&&Q()},"HIV infected":{priority:7,condition:()=>o.getAgeInMonths()<24||o.getAge()<=5},"WHO STAGE IV ADULT":{priority:1,condition:()=>{const e=M.getConceptsByCategory("severe_hiv_wasting_syndrome");return W.isAdult()&&(z(["stage_4_conditions"])||e.filter(e=>he().includes(e.name)).length>=2)}},"WHO STAGE III ADULT":{priority:2,condition:()=>W.isAdult()&&z(["stage_3_conditions"])},"cd4 less than or equal to 350":{priority:3,condition:()=>W.isAdult()&&Z(350)&&Q()},"cd4 less than or equal to 250":{priority:4,condition:()=>W.isAdult()&&Z(250)&&Q()},"cd4 less than or equal to 500":{priority:4,condition:()=>W.isAdult()&&Z(500)&&Q()},BREASTFEEDING:{priority:5,condition:()=>W.isAdult()&&"Yes"===j.breastFeeding&&ee()},"PATIENT PREGNANT":{priority:6,condition:()=>W.isAdult()&&"Yes"===j.pregnant&&ee()},Asymptomatic:{priority:7,condition:()=>ee()}})},whoStage:{buildObs:()=>W.buildWhoStageObs(j.whoStage),suggestAvalue:()=>({"WHO STAGE IV ADULT":{priority:1,condition:()=>W.isAdult()&&z(["stage_4_conditions"])},"WHO STAGE III ADULT":{priority:2,condition:()=>W.isAdult()&&z(["stage_3_conditions"])},"WHO STAGE II ADULT":{priority:3,condition:()=>W.isAdult()&&z(["stage_2_conditions"])},"WHO STAGE I ADULT":{priority:4,condition:()=>W.isAdult()&&z(["stage_1_conditions"])},"WHO STAGE IV PEDS":{priority:1,condition:()=>W.isPedaid()&&(z(["stage_4_conditions"])||"WHO STAGE IV PEDS"===j.reasonForArt)},"WHO STAGE III PEDS":{priority:2,condition:()=>W.isPedaid()&&z(["stage_3_conditions"])},"WHO STAGE II PEDS":{priority:3,condition:()=>W.isPedaid()&&z(["stage_2_conditions"])},"WHO STAGE I PEDS":{priority:4,condition:()=>W.isPedaid()&&z(["stage_1_conditions"])}})},cd4Available:{required:()=>!0,dataHandler:e=>{"Yes"!=e&&(j.cd4="",j.cd4Date=""),N.value.cd4="",N.value.cd4Date="",N.value.cd4Location=""}},pregnant:{required:()=>j.isChildBearing,buildObs:()=>W.buildValueCoded("Is patient pregnant?",j.pregnant)},breastFeeding:{required:()=>j.isChildBearing,buildObs:()=>W.buildValueCoded("Is patient breast feeding?",j.breastFeeding)},cd4:{required:()=>"Yes"===j.cd4Available,validation:()=>{X()?J()>1e4&&(N.value.cd4="CD4 value cannot exceed 10,000"):N.value.cd4="Invalid cd4 count format, expected e.g. <100 or >500 or =750"},buildObs:()=>W.buildValueNumber("CD4 count",J(),K())},cd4Date:{required:()=>"Yes"===j.cd4Available,dataHandler:e=>{e&&(j.cd4Date=G(e).format("YYYY-MM-DD"))},validation:()=>{if(isNaN(new Date(j.cd4Date).getTime()))return void(N.value.cd4Date="Invalid CD4 date");const e=G(j.cd4Date);e.isAfter(G(W.getDate()))?N.value.cd4Date=`Cd4 result date can't be greater than ${W.getDate()}`:e.isBefore(G(o.getBirthdate()))&&(N.value.cd4Date="CD4 date must not be earlier than birthdate")},buildObs:()=>W.buildValueDate("Cd4 count datetime",j.cd4Date)},cd4Location:{required:()=>"Yes"===j.cd4Available,dataHandler:e=>j.cd4Location=e.name,buildObs:()=>W.buildValueText("Cd4 count location",j.cd4Location)},staging:{validation:()=>{if(Object.keys(k).every(e=>me(e)<=0))return void(N.value.staging="Please select one or more staging conditions");const e=["stage_4_conditions","stage_3_conditions","stage_2_conditions"].some(e=>me(e)>0);k.stage_1_conditions.options.some(e=>/asymptomatic/i.test(e.name)&&e.checked)&&e&&(N.value.staging="Asymptomatic cannot be selected with other staging conditions")},buildObs:()=>Object.keys(k).reduce((e,t)=>(k[t].options.forEach(t=>{t.checked&&e.push(t.name)}),e),[]).map(e=>W.buildWhoCriteriaObs(e))}};function z(e){return e.some(e=>me(e)>0)}function Q(){return new Date(j.cd4Date)<=new Date("2016-04-30")}function K(){var e,t,i;return null!==(e=null===(t=`${null!==(i=j.cd4)&&void 0!==i?i:""}`.match(/^([=><]{1})/))||void 0===t?void 0:t[0])&&void 0!==e?e:""}function J(){var e,t;return parseInt(null!==(e=null===(t=`${j.cd4}`.match(/\d+$/))||void 0===t?void 0:t[0])&&void 0!==e?e:"0")}function X(){return/^([=><]{1})(\d+)$/i.test(`${j.cd4}`)}function Z(e){if(!X())return!1;const t=K(),i=J();return"="===t&&e===i||("<"===t&&i<=e||">"===t&&i>=e)}function ee(){return z(["stage_2_conditions","stage_1_conditions"])}function he(){return Object.keys(k).reduce((e,t)=>(k[t].options.forEach(t=>t.checked&&e.push(t.name)),e),[])}function ye(e){if(N.value[e]="","function"==typeof q[e].required){if(q[e].required()&&!j[e])return void(N.value[e]="This field is required")}j[e]&&"function"==typeof q[e].validation&&q[e].validation()}function fe(){return Object.keys(j).reduce((e,t)=>{if(t in q&&j[t]&&"function"==typeof q[t].buildObs){const i=q[t].buildObs();return Array.isArray(i)?[...e,...i]:[...e,i]}return e},[])}function me(e){return k[e].options.filter(e=>e.checked).length}function ve(e,t){e in q&&"function"==typeof q[e].dataHandler&&q[e].dataHandler(t),ye(e),Object.keys(q).forEach(e=>function(e){if(q[e]&&"suggestAvalue"in q[e]){var t,i;j[e]="";const o=q[e].suggestAvalue(),n=Object.keys(o).reduce((e,t)=>{const i=o[t];return"function"==typeof i.condition&&i.condition()?[...e,{value:t,priority:i.priority}]:e},[]);j[e]=null!==(t=null===(i=n.sort((e,t)=>e.priority-t.priority))||void 0===i||null===(i=i[0])||void 0===i?void 0:i.value)&&void 0!==t?t:""}}(e))}function Ae(){Object.keys(k).forEach(e=>{var t,i;const o=Number(null!==(t=null===(i=e.match(/\d+/))||void 0===i?void 0:i[0])&&void 0!==t?t:0),n=W.getStagingConditions(o);k[e].options=n.map(e=>({checked:!1,name:e.name,concept_id:e.concept_id}))})}function be(){return Object.keys(q).forEach(e=>ye(e)),Object.keys(N.value).every(e=>`${N.value[e]}`.length<=0)}return a(()=>i.date,e=>{W.setDate(e),o.date=e,Object.keys(j).forEach(e=>{"boolean"==typeof j[e]?j[e]=!1:Array.isArray(j[e])?j[e]=[]:j[e]=""}),Object.keys(N.value).forEach(e=>N.value[e]=""),Ae()}),r(async()=>{await async function(){await W.loadHivConfirmatoryTestType(),j.confirmatoryTest=W.getConfirmatoryTestType(),j.isChildBearing=o.isChildBearing()}(),Ae()}),t({validateStagingForm:be,buildPayload:fe,onSubmit:async function(){if(console.log("Submitting staging"),!be())return U("Please review form for errors"),!1;try{const e=await Promise.all(fe());return await W.createEncounter(),await W.saveObservationList(e),x("Staging Observations saved!"),!0}catch(e){return console.error(e),R("Error has occured while saving observations"),!1}}}),(e,t)=>(c(),d(g(B),null,{default:l(()=>[u(g(p),null,{default:l(()=>[j.isChildBearing?(c(),h("div",ie,[u(g(m),null,{default:l(()=>[u(g(v),null,{default:l(()=>[u(g(A),null,{default:l(()=>[u(Y,{label:"Pregnant?",modelValue:j.pregnant,"onUpdate:modelValue":t[0]||(t[0]=e=>j.pregnant=e),onIonChange:t[1]||(t[1]=e=>ve("pregnant",e)),"error-message":N.value.pregnant},null,8,["modelValue","error-message"])]),_:1}),u(g(A),null,{default:l(()=>[u(Y,{label:"Breastfeeding?",modelValue:j.breastFeeding,"onUpdate:modelValue":t[2]||(t[2]=e=>j.breastFeeding=e),onOnChange:t[3]||(t[3]=e=>ve("breastFeeding",e)),"error-message":N.value.breastFeeding},null,8,["modelValue","error-message"])]),_:1})]),_:1})]),_:1})])):y("",!0),f("div",oe,[u(g(b),{color:"light"},{default:l(()=>[(c(!0),h(w,null,C(k,(e,i)=>(c(),d(g(T),{key:i},{default:l(()=>[u(g(_),{color:"light",slot:"header"},{default:l(()=>[u(g(D),{style:{color:"grey","font-size":"17px"},class:"ion-padding"},{default:l(()=>[f("b",ne,[E(I(e.title)+" ",1),u(g(S),{color:me(`${i}`)>0?"primary":void 0},{default:l(()=>[E(" Selected: "+I(me(`${i}`)),1)]),_:2},1032,["color"])]),f("p",ae,I(N.value.staging),1)]),_:2},1024)]),_:2},1024),f("div",se,[u(g(O),null,{default:l(()=>[(c(!0),h(w,null,C(e.options,(e,o)=>(c(),d(g(_),{key:o},{default:l(()=>[u(g(H),{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,onIonChange:t=>ve("staging",{stage_type:i,raw:t,option:e})},null,8,["modelValue","onUpdate:modelValue","onIonChange"]),u(g(D),{style:{margin:"13px"}},{default:l(()=>[E(I(e.name),1)]),_:2},1024),t[12]||(t[12]=f("p",null,null,-1)),e.description?(c(),d(g(P),{key:0,color:e.color},{default:l(()=>[E(I(e.text),1)]),_:2},1032,["color"])):y("",!0)]),_:2,__:[12]},1024))),128))]),_:2},1024)])]),_:2},1024))),128))]),_:1})]),f("div",re,[f("div",de,[u(Y,{label:"Recent CD4 count results available?",modelValue:j.cd4Available,"onUpdate:modelValue":t[4]||(t[4]=e=>j.cd4Available=e),onOnChange:t[5]||(t[5]=e=>ve("cd4Available",e)),"error-message":N.value.cd4Available},null,8,["modelValue","error-message"])]),"Yes"===j.cd4Available?(c(),h("div",ce,[u(g(m),{class:"ion-padding"},{default:l(()=>[u(g(v),null,{default:l(()=>[u(g(A),null,{default:l(()=>[u(g(D),null,{default:l(()=>t[13]||(t[13]=[E(" CD4 Count Date ")])),_:1,__:[13]}),u(F,{place_holder:"Enter CD4 Date",onDateUpDated:t[6]||(t[6]=e=>ve("cd4Date",`${e.value.year}-${e.value.month}-${e.value.day}`)),date_prop:""}),f("div",le,I(N.value.cd4Date),1)]),_:1})]),_:1}),u(g(v),{style:{"margin-top":"15px"}},{default:l(()=>[u(g(A),null,{default:l(()=>[u(g(V),{modelValue:j.cd4,"onUpdate:modelValue":t[7]||(t[7]=e=>j.cd4=e),onIonInput:t[8]||(t[8]=e=>ve("cd4",e)),placeholder:"CD4 count e.g. <100 or >500","label-placement":"stacked",label:"CD4 Count",fill:"outline"},null,8,["modelValue"]),f("div",ue,I(N.value.cd4),1)]),_:1}),u(g(A),null,{default:l(()=>[u($,{show_error:!1,selected_district_ids:[],selected_location:null,onFacilitySelected:t[9]||(t[9]=e=>{j.cd4Location=e.selected_location,ve("cd4Location",e.selected_location)})}),f("div",ge,I(N.value.cd4Location),1)]),_:1})]),_:1})]),_:1})])):y("",!0)]),f("div",pe,[u(g(m),null,{default:l(()=>[u(g(v),null,{default:l(()=>[u(g(A),null,{default:l(()=>[u(g(V),{readonly:"",placeholder:"N/A",label:"REASON FOR ART:",modelValue:j.reasonForArt,"onUpdate:modelValue":t[10]||(t[10]=e=>j.reasonForArt=e)},null,8,["modelValue"])]),_:1}),u(g(A),null,{default:l(()=>[u(g(V),{readonly:"",placeholder:"N/A",label:"WHO STAGE:",modelValue:j.whoStage,"onUpdate:modelValue":t[11]||(t[11]=e=>j.whoStage=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}))}});t("default",j(he,[["__scopeId","data-v-33541e66"]]))}}})}();
