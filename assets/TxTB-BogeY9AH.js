import{d as p,l as d,a as b}from"./index-CFMJvuky.js";import{t as D,R as _}from"./ReportTable-DHwaxHHH.js";import{a as E,c as F}from"./tx_report_service-DkmnPznI.js";import{d as v,r as u,y,f as A}from"./vendor-BQy1yowl.js";import"./lodash-Dt8AsbQm.js";import"./apexcharts-BscU8zyp.js";import"./chartjs-DCBI7UVv.js";import"./barcode-qrcode-reader-D898z2nS.js";import"./report_service-XUVlIo_o.js";import"./age_groups-BkW1n_F5.js";const $=v({__name:"TxTB",setup(B){const s=u("-"),g=u([]),r=new E,m=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:p},...D(F)];function w(e){const t={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return Object.entries(e).forEach(([a,o])=>{a!=="Unknown"&&Object.entries(o).forEach(([h,c])=>{const n=h;t[n].rows.push({ageGroup:a,gender:n,...c}),Object.entries(c).forEach(([i,T])=>{var l;t[n].aggregate[i]=[...(l=t[n].aggregate[i])!=null?l:[],...T]})})}),t}async function f(e,t){try{await d.show(),r.setStartDate(e.dateRange.startDate),r.setEndDate(e.dateRange.endDate),r.setOccupation(e.occupation),s.value=r.getDateIntervalPeriod();const a=await r.getTxTbReport(t),o=w(a);g.value=[...o.F.rows,...o.M.rows,{ageGroup:"All",gender:"Male",...o.M.aggregate},...await r.buildMaternityAgreggateRows(o.F.aggregate)]}catch(a){b("ERROR! Unable to load report data"),console.error(a)}await d.hide()}function R(e){return"".concat(e.column.label," | ").concat(e.row.ageGroup," | ").concat(p(e.row.gender),"s")}return(e,t)=>(A(),y(_,{title:"PEPFAR TX TB Report","report-type":"PEPFAR",columns:m,rows:g.value,period:s.value,"drill-title":R,useDateRangeFilter:"",showIndices:"",onGenerate:f},null,8,["rows","period"]))}});export{$ as default};
