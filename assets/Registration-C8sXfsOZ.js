import{c as l,d as M,a as G,y as $,f,u as t,r as p,bW as ue,au as ce,z as _,e as y,m as h,l as u,k as c,bP as me,S as de,a9 as fe,i as F,v as R,V as ve,W as L,A as B,F as pe,L as _e,p as z,af as ye}from"./vendor-CKGLxZg5.js";import{u as Y,R as q,c as ge,e as he,d as Fe,a as Re,_ as ke,b as we}from"./BirthRegistration.vue_vue_type_script_setup_true_lang-hZti_n8U.js";import{_ as U}from"./StandardForm.vue_vue_type_script_setup_true_lang-CyskiRBJ.js";import{i as j,ak as N,S as W,t as Pe,A as Ve,_ as be}from"./index-kdr2EpoV.js";import{u as J}from"./useExposeFromStandardForm-XnUzMZ5A.js";import"./lodash-Dt8AsbQm.js";import"./vaccines_service-CbixEgRR.js";import"./app_encounter_service-98GsPszC.js";import"./sms_service-pu0o93Nu.js";import"./appointment_service-CRplC5P0.js";import"./EIRreportsStore-zKv7S2eM.js";import"./Export-D4js6FKi.js";import"./relations_service-DCqjFL58.js";const Ce=()=>{const{countriesList:o}=Y();return{country:l(()=>[{componentType:"Heading",name:"Country",position:"center"},{componentType:"multiSelectInputField",header:"Country",name:"country",trackBy:"district_id",openDirection:"auto",icon:j.search,validation:v=>N.required(v),options:o.value}])}},xe=M({__name:"Country",setup(o,{expose:i}){const{country:v}=Ce(),{formRef:a,exposeFormMethods:s}=J();return G(()=>{var m;(m=a.value)==null||m.setFormValue("country",{district_id:292,name:"Malawi",region_id:4})}),i(s()),(m,g)=>(f(),$(U,{formData:t(v),ref_key:"formRef",ref:a},null,8,["formData"]))}}),Ie=()=>{const{facilityList:o,getFacilities:i}=Y();return i(),{patientType:l(()=>[{componentType:"Heading",name:"Patient Type",position:"center"},{componentType:"radioButtonField",header:"Patient Type",name:"patient_type",type:"inline",validation:N.required,options:[{label:"New patient",value:"New patient"},{label:"Emergency supply",value:"Emergency supply"},{label:"External consultation",value:"External consultation"}]},{componentType:"multiSelectInputField",header:"Facility",name:"facility",trackBy:"facility_id",openDirection:"auto",icon:j.search,validation:a=>N.required(a),options:o.value.facilities,condition:a=>(a==null?void 0:a.patient_type)=="Emergency supply"||(a==null?void 0:a.patient_type)=="External consultation"}])}},Te=M({__name:"PatientType",setup(o,{expose:i}){const{patientType:v}=Ie(),{formRef:a,exposeFormMethods:s}=J();return i(s()),(m,g)=>(f(),$(U,{formData:t(v),ref_key:"formRef",ref:a},null,8,["formData"]))}});function Le(){const o=p(1),i=p(4),v=4,a=()=>{const d=window.innerWidth;return d>=992?4:d>=768?3:d>=576?2:1},s=l(()=>i.value===0?v:Math.ceil(v/i.value)),m=l(()=>s.value>1),g=l(()=>m.value&&o.value>1),k=l(()=>m.value&&o.value<s.value),w=d=>{if(s.value===1)return!0;const x=(o.value-1)*i.value,I=x+i.value-1;return d>=x&&d<=I},P=()=>{o.value<s.value&&o.value++},V=()=>{o.value>1&&o.value--},C=d=>{d>=1&&d<=s.value&&(o.value=d)},b=()=>{i.value=a(),o.value>s.value&&(o.value=s.value),o.value===0&&s.value>0&&(o.value=1)};return G(()=>{window.addEventListener("resize",b),b()}),ue(()=>{window.removeEventListener("resize",b)}),{currentPage:o,columnsPerRow:i,totalPages:s,showPaginationButtons:m,showPreviousButton:g,showNextButton:k,nextPage:P,prevPage:V,goToPage:C,handleResize:b,isCardVisible:w}}const Be={key:0,class:"spinner-overlay"},$e={class:"masonry-grid"},De={class:"card-container"},Ee={class:"custom-card"},Se={class:"card-container"},Ne={key:0,class:"custom-card"},Me={key:1,class:"custom-card"},He={class:"custom-card card-margin-top"},Ae={key:0,class:"card-container"},ze={class:"custom-card"},qe={class:"custom-card card-margin-top"},We={class:"card-container"},Ge={class:"custom-card"},Ye={key:0,class:"custom-card card-margin-top"},Ue={class:"footer-content"},je={class:"footer-buttons-left"},Je={key:0,class:"pagination-dots"},Ke=["onClick","aria-label"],Oe={class:"footer-buttons-right"},Qe=M({__name:"Registration",setup(o){const i=p(!1),v=ce(),a=p(null),s=p(null),m=p(null),g=p(null),k=p(null),w=p(null),P=p(null),V=p(null),C=l(()=>{var e;return((e=a.value)==null?void 0:e.currentFormValues)||{}}),b=l(()=>{var e;return((e=s.value)==null?void 0:e.currentFormValues)||{}}),d=l(()=>{var e;return((e=m.value)==null?void 0:e.currentFormValues)||{}}),x=l(()=>{var e;return((e=g.value)==null?void 0:e.currentFormValues)||{}}),I=l(()=>{var e;return((e=k.value)==null?void 0:e.currentFormValues)||{}}),K=l(()=>{var e;return((e=w.value)==null?void 0:e.currentFormValues)||{}}),O=l(()=>{var e;return((e=P.value)==null?void 0:e.currentFormValues)||{}}),Q=l(()=>{var e;return((e=V.value)==null?void 0:e.currentFormValues)||{}}),X=l(()=>({personalInformation:C.value,birthRegistration:b.value,socialHistory:d.value,country:x.value,currentLocation:I.value,homeLocation:K.value,guardianInformation:O.value,patientType:Q.value})),Z=()=>{const e=[a,s,m,g,k,w,P,V];return e.forEach(n=>{var r;return(r=n.value)==null?void 0:r.validateForm()}),e.every(n=>{var r;return((r=n.value)==null?void 0:r.validateForm())==null})},ee=()=>{[a,s,m,k,w,P,V].forEach(n=>{var r;return(r=n.value)==null?void 0:r.resetForm()})},D=l(()=>new q().checkIfChild(C.value)),{nextPage:te,prevPage:ne,goToPage:oe,isCardVisible:T,showPreviousButton:ae,showPaginationButtons:re,totalPages:H,currentPage:A,showNextButton:se}=Le(),ie=async()=>{if(!Z()){Pe("Please fill in all required fields");return}await new q().saveRegistrationData(X.value)&&(ee(),W.getProgramID()==32?E("/NCDEnrollment"):E("/patientProfile"))},le=async()=>{await Ve("Do you want to cancel registration?","",{confirmBtnLabel:"Yes",icon:"",showBackdrop:!0})&&E("/home")},E=e=>{v.push({path:e})};return(e,n)=>(f(),$(t(ye),{class:z({loading:i.value})},{default:_(()=>[i.value?(f(),y("div",Be,[u(t(me),{name:"bubbles"}),n[3]||(n[3]=c("div",{class:"loading-text"},"Please wait...",-1))])):h("",!0),u(t(de),null,{default:_(()=>n[4]||(n[4]=[c("div",{class:"header-title"},"New Patient Registration",-1)])),_:1,__:[4]}),u(t(fe),null,{default:_(()=>{var r,S;return[c("div",$e,[F(c("div",De,[c("div",Ee,[u(ge,{ref_key:"personalInformationRef",ref:a},null,512)])],512),[[R,t(T)(0)]]),F(c("div",Se,[D.value.underNineMonths?(f(),y("div",Ne,[D.value.underNineMonths?(f(),$(he,{key:0,ref_key:"birthRegistrationRef",ref:s},null,512)):h("",!0)])):h("",!0),D.value.moreThanThirteenYears?(f(),y("div",Me,[u(Fe,{ref_key:"socialHistoryRef",ref:m},null,512)])):h("",!0),c("div",He,[u(xe,{ref_key:"countryRef",ref:g},null,512)])],512),[[R,t(T)(1)]]),((S=(r=x.value)==null?void 0:r.country)==null?void 0:S.name)==="Malawi"?F((f(),y("div",Ae,[c("div",ze,[u(Re,{ref_key:"currentLocationRef",ref:k},null,512)]),c("div",qe,[u(ke,{currentLocationFormValues:I.value,ref_key:"homeLocationRef",ref:w},null,8,["currentLocationFormValues"])])],512)),[[R,t(T)(2)]]):h("",!0),F(c("div",We,[c("div",Ge,[u(we,{personalInformationFormValues:C.value,ref_key:"guardianInformationRef",ref:P},null,8,["personalInformationFormValues"])]),t(W).getProgramID()==1?(f(),y("div",Ye,[u(Te,{ref_key:"patientTypeRef",ref:V},null,512)])):h("",!0)],512),[[R,t(T)(3)]])])]}),_:1}),u(t(ve),null,{default:_(()=>[c("div",Ue,[c("div",je,[u(t(L),{color:"danger","aria-label":"Cancel registration",onClick:n[0]||(n[0]=r=>le())},{default:_(()=>n[5]||(n[5]=[B("Cancel")])),_:1,__:[5]}),F(u(t(L),{onClick:n[1]||(n[1]=r=>t(ne)()),"aria-label":"Go to previous page"},{default:_(()=>n[6]||(n[6]=[B("Previous")])),_:1,__:[6]},512),[[R,t(ae)]])]),t(re)?(f(),y("div",Je,[(f(!0),y(pe,null,_e(t(H),r=>(f(),y("span",{key:r,class:z({dot:!0,active:r===t(A)}),onClick:S=>t(oe)(r),"aria-label":"Go to page ".concat(r),role:"button"},null,10,Ke))),128))])):h("",!0),c("div",Oe,[F(u(t(L),{name:"Save",onClick:ie,"aria-label":"Save patient data"},{default:_(()=>n[7]||(n[7]=[B("Save")])),_:1,__:[7]},512),[[R,t(A)===t(H)]]),F(u(t(L),{onClick:n[2]||(n[2]=r=>t(te)()),"aria-label":"Go to next page"},{default:_(()=>n[8]||(n[8]=[B("Next")])),_:1,__:[8]},512),[[R,t(se)]])])])]),_:1})]),_:1},8,["class"]))}}),mt=be(Qe,[["__scopeId","data-v-e6be7808"]]);export{mt as default};
