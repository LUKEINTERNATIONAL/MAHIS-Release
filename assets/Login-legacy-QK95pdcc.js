System.register(["./vendor-legacy-DnHM1LDc.js","./index-legacy-BqvH6Jqq.js","./Img-legacy-BNmikZ_d.js","./userService-legacy-B6zia0bh.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-Brrz_x1F.js"],function(e,a){"use strict";var l,t,n,s,o,r,i,u,c,d,v,p,f,w,g,m,y,P,b,x,h,_,k,I,C,q,z,S,E,U,j,N,L,$,O,R,F,H,K,M,A,D,B,G,J,T,Y,Z;return{setters:[e=>{l=e.d,t=e.r,n=e.ak,s=e.c,o=e.a,r=e.H,i=e.N,u=e.f,c=e.J,d=e.l,v=e.u,p=e.a8,f=e.k,w=e.aR,g=e.aO,m=e.e,y=e.m,P=e.dx,b=e.E,x=e.P,h=e.K,_=e.a2,k=e.b1,I=e.cM,C=e.bu,q=e.c9,z=e.cs,S=e.M,E=e.bp,U=e.p,j=e.ae},e=>{N=e.y,L=e.a0,$=e.t,O=e.U,R=e.N,F=e.a1,H=e.v,K=e.a2,M=e.a3,A=e.a4,D=e.$,B=e.z,G=e.a5,J=e._},e=>{T=e.i},e=>{Y=e.p,Z=e.g},null,null],execute:function(){var a=document.createElement("style");a.textContent='.login-page[data-v-55ce6322]{background-color:#fff}.login-container[data-v-55ce6322]{display:flex;justify-content:center;align-items:center;text-align:center;height:90vh}.login-title[data-v-55ce6322]{font-size:24px;margin-bottom:30px;font-weight:700;margin-top:20px}.input-fields[data-v-55ce6322]{margin-bottom:35px}.invalid-input[data-v-55ce6322]{--border-color: #ff4444 !important;--color: #ff4444 !important}.password-requirements[data-v-55ce6322]{text-align:left;margin-bottom:20px;padding:15px;background-color:#f8f9fa;border-radius:8px;border-left:4px solid #34af4d}.requirements-title[data-v-55ce6322]{margin:0 0 10px;font-weight:600;color:#333;font-size:14px}.requirements-list[data-v-55ce6322]{margin:0;padding-left:20px;list-style:none}.requirements-list li[data-v-55ce6322]{margin-bottom:5px;font-size:13px;color:#666;position:relative}.requirements-list li[data-v-55ce6322]:before{content:"✗";color:#f44;font-weight:700;position:absolute;left:-20px}.requirements-list li.valid[data-v-55ce6322]:before{content:"✓";color:#34af4d}.requirements-list li.valid[data-v-55ce6322]{color:#34af4d}.password-toggle[data-v-55ce6322]{cursor:pointer;position:absolute;margin-top:-73px;margin-left:130px;z-index:1000}.login-button[data-v-55ce6322]{color:#fff;margin-top:30px}.login-button[data-v-55ce6322]:disabled{opacity:.5;cursor:not-allowed}.signup-link[data-v-55ce6322]{margin-top:50px}.signup-link a[data-v-55ce6322]{text-decoration:underline;color:#34af4d;cursor:pointer}.signup-link a[data-v-55ce6322]:hover{color:#2d8f3f}.password-toggle[data-v-55ce6322]{font-size:20px}.login_img[data-v-55ce6322]{width:90px;margin:auto}ion-card[data-v-55ce6322]{min-width:330px}@media (max-width: 902px){.login-page[data-v-55ce6322]{--ion-background-color: #ffffff}ion-card[data-v-55ce6322]{box-shadow:unset}}\n/*$vite$:1*/',document.head.appendChild(a);const Q={class:"login-container"},V={key:0,style:{"justify-content":"center",display:"block"}},W={style:{"font-size":"15px"}},X={style:{"font-size":"12px",color:"#34af4d"}},ee={key:1},ae={style:{"font-size":"15px"}},le={key:0},te={style:{"text-align":"left"}},ne={class:"signup-link"},se={key:1},oe={style:{"text-align":"left"}},re={key:0,class:"password-requirements"},ie={class:"requirements-list"},ue={class:"signup-link"};e("default",J(l({__name:"Login",setup(e){const a=t(""),l=t(""),J=t(""),ce=t(!1),de=t(!1),ve=t("test"),pe=t(new G),fe=t({username:"",currentPassword:"",newPassword:"",confirmPassword:""}),we=t(!1),ge=t(!1),me=t(!1),ye=n(),Pe=N(),be=s(()=>""!==fe.value.username.trim()&&""!==fe.value.currentPassword.trim()&&""!==fe.value.newPassword.trim()&&""!==fe.value.confirmPassword.trim()&&L(fe.value.newPassword)&&fe.value.newPassword===fe.value.confirmPassword&&fe.value.newPassword!==fe.value.currentPassword),xe=()=>{de.value=!de.value,de.value&&(fe.value={username:"",currentPassword:"",newPassword:"",confirmPassword:""})},he=()=>{$("Help functionality to be implemented")},_e=async()=>{if(!be.value)return $("Please complete all fields correctly"),void $("Password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, one number, and one special character.");try{const e=await pe.value.requestLogin(fe.value.currentPassword,fe.value.username);if(e){const{authorization:a}=e,{token:l,user:t}=a;t&&(localStorage.setItem("apiKey",l),await O.updateUser(t.user_id,{password:fe.value.newPassword}),R("Password changed successfully!"),await pe.value.requestLogin(fe.value.newPassword,fe.value.username),fe.value={username:"",currentPassword:"",newPassword:"",confirmPassword:""},de.value=!1,localStorage.setItem("apiKey",""))}}catch(e){H(e instanceof F?"Current password is incorrect":`Error changing password: ${e}`)}},ke=async()=>{if(a.value&&l.value){pe.value.setUsername(a.value);try{await pe.value.login(l.value),await(async()=>{const e=D(),a=await Z();a&&(e.setUserFacilityName(a.name),e.setFacilityLocation(a),localStorage.setItem("facility_code",a.code))})(),await(async()=>{const e=await pe.value.checkUserPrograms(void 0);null!=e&&e.programs&&B().setAuthorizedPrograms(null==e?void 0:e.programs)})(),await K(),await Y(),ye.push("/home")}catch(e){e instanceof F&&H("Invalid username or password"),e instanceof M&&(xe(),H("Please change your password",5e4)),e instanceof A?(xe(),H("Your password has expired. Please change your password",5e4)):H(`${e}`,5e4)}}else $("Complete form to log in")};return o(async()=>{localStorage.setItem("apiKey",""),await pe.value.loadConfig(),J.value=localStorage.getItem("core_version")||"",await(async()=>{Pe.terminate(),await N().postData("SET_OFFLINE_PROGRAMS")})()}),(e,t)=>{const n=r("ion-icon");return u(),i(v(j),null,{default:c(()=>[d(v(p),{class:"ion-padding login-page"},{default:c(()=>[f("div",Q,[d(v(w),{style:{"background-color":"#fff"}},{default:c(()=>[d(v(g),null,{default:c(()=>[d(v(P),{class:"login_img",src:v(T)("mw.png"),id:"logo"},null,8,["src"]),d(v(b),{class:"login-title"},{default:c(()=>["development"===ve.value||"test"===ve.value?(u(),m("span",V,[f("div",null,[t[10]||(t[10]=x(" MaHIS ",-1)),f("small",W,"(v"+h(J.value)+")",1)]),f("div",X,"("+h(ve.value)+")",1)])):(u(),m("span",ee,[t[11]||(t[11]=x(" MaHIS ",-1)),f("small",ae,"(v"+h(J.value)+")",1)]))]),_:1}),de.value?y("",!0):(u(),m("div",le,[f("span",te,[d(v(_),{value:a.value,onIonInput:t[0]||(t[0]=e=>a.value=e.target.value||""),type:"text",label:"Username",ref:"usernameRef","label-placement":"floating",fill:"outline",placeholder:"Enter Username",class:"input-fields",required:""},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:v(I)},null,8,["icon"])]),_:1})]),_:1},8,["value"]),d(v(_),{value:l.value,onIonInput:t[2]||(t[2]=e=>l.value=e.target.value||""),type:ce.value?"text":"password",label:"Password",ref:"passwordRef","label-placement":"floating",fill:"outline",placeholder:"Enter Password",class:"input-fields",required:"",onKeydown:C(ke,["enter"])},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:ce.value?v(q):v(z),onClick:t[1]||(t[1]=e=>ce.value=!ce.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type"])]),d(v(S),{expand:"block",style:{"--background":"var(--ion-color-primary)","font-size":"var(--ion-button-font)"},onClick:ke,class:"login-button"},{default:c(()=>t[12]||(t[12]=[x(" Login ",-1)])),_:1,__:[12]}),f("p",ne,[t[13]||(t[13]=x(" For help click ",-1)),f("a",{href:"#",onClick:E(he,["prevent"])},"Here"),t[14]||(t[14]=x(" | ",-1)),f("a",{href:"#",onClick:E(xe,["prevent"])},"Change Password")])])),de.value?(u(),m("div",se,[t[17]||(t[17]=f("h3",{style:{"text-align":"center","margin-bottom":"20px",color:"#34af4d"}},"Change Password",-1)),f("span",oe,[d(v(_),{value:fe.value.username,onIonInput:t[3]||(t[3]=e=>fe.value.username=e.target.value||""),type:"text",label:"Username","label-placement":"floating",fill:"outline",placeholder:"Enter Username",class:"input-fields",required:""},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:v(I)},null,8,["icon"])]),_:1})]),_:1},8,["value"]),d(v(_),{value:fe.value.currentPassword,onIonInput:t[5]||(t[5]=e=>fe.value.currentPassword=e.target.value||""),type:we.value?"text":"password",label:"Current Password","label-placement":"floating",fill:"outline",placeholder:"Enter Current Password",class:"input-fields",required:""},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:we.value?v(q):v(z),onClick:t[4]||(t[4]=e=>we.value=!we.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type"]),d(v(_),{value:fe.value.newPassword,onIonInput:t[7]||(t[7]=e=>fe.value.newPassword=e.target.value||""),type:ge.value?"text":"password",label:"New Password","label-placement":"floating",fill:"outline",placeholder:"Enter New Password",class:U(["input-fields",{"invalid-input":fe.value.newPassword&&!v(L)(fe.value.newPassword)}]),required:""},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:ge.value?v(q):v(z),onClick:t[6]||(t[6]=e=>ge.value=!ge.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type","class"]),d(v(_),{value:fe.value.confirmPassword,onIonInput:t[9]||(t[9]=e=>fe.value.confirmPassword=e.target.value||""),type:me.value?"text":"password",label:"Confirm New Password","label-placement":"floating",fill:"outline",placeholder:"Confirm New Password",class:U(["input-fields",{"invalid-input":fe.value.confirmPassword&&fe.value.newPassword!==fe.value.confirmPassword}]),required:""},{default:c(()=>[d(v(k),{slot:"end"},{default:c(()=>[d(n,{icon:me.value?v(q):v(z),onClick:t[8]||(t[8]=e=>me.value=!me.value)},null,8,["icon"])]),_:1})]),_:1},8,["value","type","class"])]),fe.value.newPassword?(u(),m("div",re,[t[15]||(t[15]=f("p",{class:"requirements-title"},"Password Requirements:",-1)),f("ul",ie,[f("li",{class:U({valid:fe.value.newPassword.length>=8})},"At least 8 characters",2),f("li",{class:U({valid:/[A-Z]/.test(fe.value.newPassword)})},"One uppercase letter",2),f("li",{class:U({valid:/[0-9]/.test(fe.value.newPassword)})},"One number",2),f("li",{class:U({valid:/[@#$%^&+=*!-]/.test(fe.value.newPassword)})},"One special character (@#$%^&+=*!-)",2),f("li",{class:U({valid:fe.value.newPassword!==fe.value.currentPassword&&""!==fe.value.currentPassword})},"Different from current password",2)])])):y("",!0),d(v(S),{expand:"block",style:{"--background":"var(--ion-color-primary)","font-size":"var(--ion-button-font)"},onClick:_e,class:"login-button",disabled:!be.value},{default:c(()=>t[16]||(t[16]=[x(" Change Password ",-1)])),_:1,__:[16]},8,["disabled"]),f("p",ue,[f("a",{href:"#",onClick:E(xe,["prevent"])},"Back to Login")])])):y("",!0)]),_:1})]),_:1})])]),_:1})]),_:1})}}}),[["__scopeId","data-v-55ce6322"]]))}}});
