import{d as Z,at as Ye,r as k,c as X,e as V,f as w,by as Be,p as oe,bt as Qe,k as a,l as t,F as ce,P as pe,W as Ze,J as n,u as e,a6 as L,L as _e,X as z,K as b,a5 as J,H as ie,bI as et,Q as d,R as ze,aV as ge,a as Ke,O as K,m as G,bc as ue,N as W,aZ as tt,bv as Pe,$ as A,cR as st,bi as Ne,I as Ee,G as Ue,E as Ae,a_ as Le,a4 as We,M as nt,aO as at,w as qe,cQ as lt,dG as ot,al as it,ak as ae,aj as rt,de as fe,b5 as ut}from"./vendor-D0D29_A_.js";import{l as dt}from"./lodash-NJiRuGo9.js";import{_ as ee,S as se,M as de,aB as Y,n as he,aC as me,o as j,u as xe,t as ye,aQ as ve,bz as te,O as je,N as ct,l as pt,ah as vt,aW as mt,H as le,P as ft}from"./index-B7bZSySF.js";import{u as _t}from"./usePatientProfile-BA0_qrSh.js";import yt from"./WeightHeightChart-PYL6D9fC.js";import{O as gt,w as ht}from"./weightAndHeight-c5uBMKOv.js";import"./apexcharts-yV10MRMc.js";import"./Registration-Ch1Wkyeg.js";import"./useLocation-BncweiOR.js";import"./useExposeFromStandardForm-B-7fYItb.js";import"./vaccines_service-CUX-y9J7.js";import"./sms_service-B67BqxNq.js";import"./EIRreportsStore-B8oLXCLf.js";import"./Export-CqhNtO8t.js";import"./Outcome-DE4tVHwH.js";import"./chartjs-BswcERCW.js";import"./BasicForm-Ci2wUU8K.js";import"./DateInputField-DHvyg1hM.js";import"./customDatePicker-Djjwd3BA.js";import"./VitalsMixin.vue_vue_type_script_lang-2qkOdI7v.js";import"./formatServerData-DHxyvUJQ.js";const xt=["onKeydown"],wt={class:"ripple-container"},bt=["onAnimationend"],Ct={class:"status-badge"},Tt={class:"ion-text-wrap"},kt=Z({__name:"ReferralCard",props:{icon:{type:String,default:Ye},status:{type:String,default:"Referred OPD"},title:{type:String,required:!0},type:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},emits:["pressed","click"],setup(O,{emit:C}){const x=O,D=C,c=k(!1),I=k(null),i=k([]);let v=0;const F=X(()=>{if(x.disabled)return"timeline-item-disabled";switch(x.type){case"hiv":return"timeline-item-hiv";case"hepatitis":return"timeline-item-hepatitis";default:return"timeline-item-default"}}),B=X(()=>{if(x.disabled)return"icon-container-disabled";switch(x.type){case"hiv":return"icon-container-hiv";case"hepatitis":return"icon-container-hepatitis";default:return"icon-container-default"}}),H=l=>{if(x.disabled||!I.value)return;const p=I.value.getBoundingClientRect(),h=Math.max(p.width,p.height)*2;let u,o;if(l.type==="keydown")u=p.width/2-h/2,o=p.height/2-h/2;else{const R=l.type.includes("touch")?l.touches[0].clientX:l.clientX,M=l.type.includes("touch")?l.touches[0].clientY:l.clientY;u=R-p.left-h/2,o=M-p.top-h/2}const y={id:v++,x:u,y:o,size:h,duration:600};i.value.push(y)},_=l=>{const p=i.value.findIndex(h=>h.id===l);p>-1&&i.value.splice(p,1)},g=l=>{x.disabled||(H(l),D("pressed",{type:x.type,title:x.title,status:x.status,event:l}),D("click",l))},$=l=>{x.disabled||(c.value=!0,H(l))},P=()=>{c.value=!1},N=()=>{c.value=!1},r=l=>{x.disabled||(c.value=!0,H(l))},T=()=>{c.value=!1};return(l,p)=>(w(),V("div",{class:oe(["timeline-item",F.value,{"timeline-item-pressed":c.value}]),onClick:g,onMousedown:$,onMouseup:P,onMouseleave:N,onTouchstart:r,onTouchend:T,role:"button",tabindex:"0",onKeydown:[Be(g,["enter"]),Be(Qe(g,["prevent"]),["space"])],ref_key:"timelineElement",ref:I},[a("div",wt,[(w(!0),V(ce,null,pe(i.value,h=>(w(),V("div",{key:h.id,class:"ripple",style:Ze({left:h.x+"px",top:h.y+"px",width:h.size+"px",height:h.size+"px",animationDuration:h.duration+"ms"}),onAnimationend:u=>_(h.id)},null,44,bt))),128))]),t(e(J),null,{default:n(()=>[t(e(L),{class:"ion-text-center"},{default:n(()=>[a("div",null,[t(e(_e),{class:oe(["icon-container",B.value]),icon:O.icon,"aria-hidden":"true"},null,8,["class","icon"])])]),_:1}),t(e(L),{class:"ion-text-center"},{default:n(()=>[t(e(z),null,{default:n(()=>[a("span",Ct,b(O.status),1)]),_:1})]),_:1}),t(e(L),{class:"ion-text-center"},{default:n(()=>[t(e(z),null,{default:n(()=>[a("h2",Tt,b(O.title),1)]),_:1})]),_:1})]),_:1})],42,xt))}}),It=ee(kt,[["__scopeId","data-v-897e90a9"]]),Rt={style:{"padding-left":"10px","padding-right":"10px"}},St={class:"content"},$t={style:{"margin-top":"10px"}},Dt={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Ht=Z({__name:"OutcomeSummaryModal",setup(O){k("Detremin");const C=()=>se.getSessionDate();k(null);const x=async()=>{await ze.dismiss(),de("Outcome summary saved successfully.")};return(D,c)=>{const I=ie("ion-button");return w(),V("div",Rt,[a("div",St,[c[2]||(c[2]=a("h4",null,"Outcome Summary",-1)),a("div",null,[c[1]||(c[1]=a("span",null,"Todays Date : ",-1)),a("span",null,b(C()),1)])]),a("div",$t,[t(e(et),{name:"outcome_summary",fill:"outline",placeholder:"Outcome Summary","auto-grow":!0,style:{"min-height":"150px"}})]),a("div",Dt,[t(I,{onClick:c[0]||(c[0]=i=>x())},{default:n(()=>[...c[3]||(c[3]=[d("Complete",-1)])]),_:1})])])}}}),Je=ee(Ht,[["__scopeId","data-v-3b844e45"]]),Mt={style:{"padding-left":"10px","padding-right":"10px"}},Ft={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Vt=Z({__name:"RiskCategoryFollowUpModal",setup(O){const C=k("Detremin"),x=X(()=>[{componentType:"multiSelectInputField",header:"Risk Category",name:"risk_category",obsValueType:"value_text",trackBy:"id",validation:Y.required,onChange:i=>{c()},options:[{id:"1",name:"Sex worker"},{id:"2",name:"MSM"},{id:"3",name:"AGYW"},{id:"4",name:"Client of sex workers"},{id:"5",name:"Female sex workers"},{id:"6",name:"Risk age group"},{id:"7",name:"None"}]},{componentType:"dateInputField",name:"next_appointment",header:"Next Appointment",obsValueType:"value_text",icon:he.scanner,onChange:i=>{c()},validation:Y.required}]),D=k(null),c=()=>{var v,F,B,H,_,g,$;const i=(v=D.value)==null?void 0:v.getFormValues();((F=i==null?void 0:i.test_results)==null?void 0:F.name)=="Reactive"&&((B=i==null?void 0:i.test_type)==null?void 0:B.name)=="Detremin"?C.value="Unigold":((H=i==null?void 0:i.test_results)==null?void 0:H.name)=="Reactive"&&((_=i==null?void 0:i.test_type)==null?void 0:_.name)=="Unigold"?C.value="Bioline":((g=i==null?void 0:i.test_results)==null?void 0:g.name)=="Reactive"&&(($=i==null?void 0:i.test_type)==null?void 0:$.name)=="Bioline"?C.value="Summary":C.value="Detremin"},I=async()=>{await ze.dismiss(),await j(Je,{class:"mediumAutoHeightModal"})};return(i,v)=>{const F=ie("ion-button");return w(),V("div",Mt,[v[3]||(v[3]=a("div",{class:"content"},[a("h4",null,"Risk Category & Follow-up")],-1)),a("div",null,[t(me,{formData:x.value,ref_key:"formRef",ref:D},null,8,["formData"])]),a("div",Ft,[t(F,{color:"danger"},{default:n(()=>[...v[1]||(v[1]=[d("Cancel",-1)])]),_:1}),t(F,{onClick:v[0]||(v[0]=B=>I())},{default:n(()=>[...v[2]||(v[2]=[d("Save",-1)])]),_:1})])])}}}),Ot=ee(Vt,[["__scopeId","data-v-d24f2c34"]]),Bt={style:{"padding-left":"10px","padding-right":"10px"}},Pt={class:"content"},Nt={style:{"text-align":"center",padding:"15px"}},Et={style:{display:"flex","justify-content":"space-between",padding:"10px"}},Ut=Z({__name:"HIVTestingModal",props:{order:{}},setup(O){const C=k(null),x=xe(),{patient:D}=ge(x),c=k([]),I=k(""),i=k(""),v=k(""),F=O,B=X(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:Y.required,type:"inline",onChange:u=>{_()},options:[{label:"Reactive",value:"Reactive"},{label:"Non reactive",value:"Non reactive"}]},{componentType:"radioButtonField",header:"Test Type",name:"test_type",obsValueType:"value_text",type:"inline",validation:Y.required,onChange:u=>{_()},options:[{label:"Detremin",value:"Detremin"},{label:"Unigold",value:"Unigold"},{label:"Bioline",value:"Bioline"}]},{componentType:"inputField",header:"Test Kit Serial Number",name:"test_kit_serial_number",obsValueType:"value_text",icon:he.scanner,onChange:u=>{_()},validation:Y.required}]),H=()=>se.getSessionDate(),_=()=>{var R;const u=(R=C.value)==null?void 0:R.getFormValues();if(!(u!=null&&u.test_results)){i.value="",v.value="";return}const o=u.test_type,y=u.test_results;o==="Detremin"?y==="Non reactive"?(i.value="risk_category",v.value="Continue to Risk Category"):y==="Reactive"&&(i.value="unigold",v.value="Continue to Unigold"):o==="Unigold"?y==="Non reactive"?(i.value="repeat_determine",v.value="Repeat Determine Test"):y==="Reactive"&&(i.value="bioline",v.value="Continue to Bioline"):o==="Bioline"&&(y==="Non reactive"?(i.value="inconclusive",v.value="Schedule Inconclusive Follow-up"):y==="Reactive"&&(i.value="summary",v.value="Continue to Summary"))},g=async()=>{var E,Q;if(((E=C.value)==null?void 0:E.validateForm())!=null){ye("Please fill in all required fields");return}const u=(Q=C.value)==null?void 0:Q.getFormValues(),o=u.test_type;c.value.push({type:o,result:u.test_results});let y=F.order,R="";const M=await ve.getConceptID(y.value_text,!0);y!=null&&y.new_order&&(R=await h(M,y.value_text,"Blood"));const S=await te.buildResults([{name:"HIV test",concept_id:M,value:"".concat(o,"-").concat(u.test_results)}]);await te.saveResults(D.value,S,y.order_obs_id,R,I.value),N(o,u.test_results)?await r(o,u.test_results):de("Test result saved")},$=async()=>{var u,o;if(((u=C.value)==null?void 0:u.validateForm())!=null){ye("Please fill in all required fields");return}switch(await g(),i.value){case"risk_category":await ue.dismiss(),await j(Ot,{class:"mediumAutoHeightModal"});break;case"unigold":case"repeat_determine":case"bioline":(o=C.value)==null||o.resetForm(),_();break;case"inconclusive":await l();break;case"summary":await P();break}},P=async()=>{await ue.dismiss(),await j(Je,{class:"mediumAutoHeightModal"})},N=(u,o)=>u==="Detremin"&&o==="Non reactive"?!1:[...c.value].length>=3,r=async(u,o)=>{const y=c.value,R=y.find(E=>E.type==="Detremin"),M=y.find(E=>E.type==="Unigold"),S=y.find(E=>E.type==="Bioline");(R==null?void 0:R.result)==="Reactive"&&(M==null?void 0:M.result)==="Reactive"&&(S==null?void 0:S.result)==="Reactive"?await T():(S==null?void 0:S.result)==="Non reactive"&&await l()},T=async()=>{await ue.dismiss(),de("Positive result confirmed. Proceeding to ART enrollment.")},l=async()=>{await P(),de("Scheduled 2-week follow-up appointment.")},p=async()=>{var u;try{const o=await te.getLabResults(D.value);if((u=o==null?void 0:o.latestTest)!=null&&u.value){const R=o.latestTest.value.split("-");R.length===2&&(c.value=[{type:R[0],result:R[1]}])}}catch(o){console.error("Error loading previous tests:",o)}},h=async(u,o,y)=>{var E,Q,re,m,s,q;const R=[{concept_id:u,name:o,specimen:y,reason:"Routine",specimenConcept:await ve.getConceptID(y,!0)}],M=await je.buildLabOrders("",R,I.value),S=JSON.parse(JSON.stringify(D.value));return(re=(Q=(E=S.labOrders)!=null?E:S.labOrders={}).unsaved)!=null||(Q.unsaved=[]),(q=(s=(m=S.labOrders)!=null?m:S.labOrders={}).saved)!=null||(s.saved=[]),S.labOrders.unsaved.push(...M),D.value=S,M[0].offline_id};return Ke(async()=>{var u;I.value=(u=F.order)==null?void 0:u.past_date,await p(),_()}),(u,o)=>{const y=ie("ion-button");return w(),V("div",Bt,[a("div",Pt,[o[3]||(o[3]=a("h4",null,"HIV Testing",-1)),a("div",null,[o[2]||(o[2]=a("span",null,"Todays Date : ",-1)),a("span",null,b(H()),1)])]),a("div",null,[t(me,{formData:B.value,ref_key:"formRef",ref:C},null,8,["formData"])]),a("div",Nt,[o[4]||(o[4]=a("span",null,"Reported by: ",-1)),a("span",null,b(e(se).getUserName()),1)]),a("div",Et,[t(y,{onClick:o[0]||(o[0]=R=>g())},{default:n(()=>[...o[5]||(o[5]=[d("Complete",-1)])]),_:1}),i.value?(w(),K(y,{key:0,onClick:o[1]||(o[1]=R=>$())},{default:n(()=>[d(b(v.value),1)]),_:1})):G("",!0)])])}}}),Ge=ee(Ut,[["__scopeId","data-v-266560f4"]]),At={style:{"padding-left":"10px","padding-right":"10px"}},Lt={class:"content"},Wt={style:{"text-align":"center",padding:"15px"}},qt={style:{display:"flex","justify-content":"center",padding:"10px"}},zt=Z({__name:"HepatitisModal",props:{order:{}},setup(O){const C=k(null);let x=k({});const D=xe(),{patient:c}=ge(D),I=k(""),i=O,v=X(()=>[{componentType:"radioButtonField",header:"Test result",name:"test_results",obsValueType:"value_text",validation:Y.required,type:"inline",options:[{label:"Positive",value:"Positive"},{label:"Negative",value:"Negative"},{label:"Inconclusive",value:"Inconclusive"}]}]),F=()=>se.getSessionDate(),B=async()=>{var N,r;if(((N=C.value)==null?void 0:N.validateForm())!=null){ye("Please fill in all required fields");return}let _=i.order;I.value=_.past_date;let g="";const $=await ve.getConceptID(_.value_text,!0);x.value=(r=C.value)==null?void 0:r.getFormValues(),_!=null&&_.new_order&&(g=await H($,_.value_text,"Blood"));const P=await te.buildResults([{name:_.value_text,concept_id:$,value:x.value.test_results}]);await te.saveResults(c.value,P,_.order_obs_id,g,I.value),await ue.dismiss()},H=async(_,g,$)=>{var T,l,p,h,u,o;const P=[{concept_id:_,name:g,specimen:$,reason:"Routine",specimenConcept:await ve.getConceptID($,!0)}],N=await je.buildLabOrders("",P,I.value),r=JSON.parse(JSON.stringify(c.value));return(p=(l=(T=r.labOrders)!=null?T:r.labOrders={}).unsaved)!=null||(l.unsaved=[]),(o=(u=(h=r.labOrders)!=null?h:r.labOrders={}).saved)!=null||(u.saved=[]),r.labOrders.unsaved.push(...N),c.value=r,N[0].offline_id};return(_,g)=>{const $=ie("ion-button");return w(),V("div",At,[a("div",Lt,[a("h4",null,b(O.order.value_text)+" Testing",1),a("div",null,[g[1]||(g[1]=a("span",null,"Todays Date : ",-1)),a("span",null,b(F()),1)])]),a("div",null,[t(me,{formData:v.value,ref_key:"formRef",ref:C},null,8,["formData"])]),a("div",Wt,[g[2]||(g[2]=a("span",null,"Reported by: ",-1)),a("span",null,b(e(se).getUserName()),1)]),a("div",qt,[t($,{onClick:g[0]||(g[0]=P=>B())},{default:n(()=>[...g[3]||(g[3]=[d("Complete",-1)])]),_:1})])])}}}),Xe=ee(zt,[["__scopeId","data-v-8a252bcf"]]),Kt={class:"past-test-results"},jt={class:"header"},Jt={class:"test-results-list"},Gt={class:"test-info"},Xt={class:"test-name"},Yt={class:"test-date"},Qt={class:"add-results-section"},Zt={class:"modal-test-results-list"},es={class:"test-info"},ts={class:"test-name"},ss={class:"test-date"},ns=Z({__name:"PastTestResults",props:{results:{default:()=>[]}},emits:["seeFullHistory","enterKnownResults"],setup(O,{emit:C}){const x=O,D=C,c=k(!1),I=k(!1),i=k(null),v=X(()=>x.results||[]),F=X(()=>v.value.slice(0,3)),B=X(()=>[{componentType:"radioButtonField",header:"Select test",name:"test",obsValueType:"value_text",validation:Y.required,type:"standard",options:[{label:"Hepatitis B Test",value:"Hepatitis B Test"},{label:"Hepatitis C Test",value:"Hepatitis C Test"},{label:"HIV test",value:"HIV test"},{label:"Syphilis",value:"Syphilis"}]},{componentType:"dateInputField",header:"Past Date",name:"past_date",validation:Y.required}]),H=T=>{const l=T.toLowerCase();return l.includes("reactive")&&!l.includes("non reactive")?"reactive":l.includes("non reactive")||l.includes("negative")?"non-reactive":(l.includes("inconclusive"),"default")},_=async()=>{var p;const T=(p=i.value)==null?void 0:p.getFormValues(),l={value_text:T.test,new_order:!0,past_date:T.past_date};r(),await g(l)},g=async T=>{T.value_text=="HIV test"&&await j(Ge,{class:"otherVitalsModal"},!0,{order:T}),(T.value_text=="Syphilis"||T.value_text=="Hepatitis B Test"||T.value_text=="Hepatitis C Test")&&await j(Xe,{class:"otherVitalsModal"},!0,{order:T})},$=()=>{I.value=!0},P=()=>{c.value=!0,D("seeFullHistory")},N=()=>{c.value=!1},r=()=>{I.value=!1};return(T,l)=>(w(),V("div",Kt,[a("div",jt,[l[2]||(l[2]=a("h2",{class:"header-title"},"PAST TEST RESULTS",-1)),t(e(W),{fill:"clear",size:"small",class:"see-history-btn",onClick:P},{default:n(()=>[l[1]||(l[1]=d(" See full History ",-1)),t(e(_e),{icon:e(tt),slot:"end"},null,8,["icon"])]),_:1})]),a("div",Jt,[(w(!0),V(ce,null,pe(F.value,(p,h)=>(w(),K(e(A),{key:h,class:"test-result-item",lines:"none"},{default:n(()=>[a("div",Gt,[a("h3",Xt,b(p.name),1),a("p",Yt,b(p.date),1)]),t(e(Pe),{class:oe(["result-chip",H(p.value)]),slot:"end"},{default:n(()=>[d(b(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))]),a("div",Qt,[t(e(W),{fill:"clear",size:"default",class:"add-results-btn",onClick:l[0]||(l[0]=p=>$())},{default:n(()=>[t(e(_e),{icon:e(st),slot:"start"},null,8,["icon"]),l[3]||(l[3]=d(" Enter Known Past Results ",-1))]),_:1})]),t(e(Ne),{"is-open":c.value,onDidDismiss:N,class:"history-modal"},{default:n(()=>[t(e(Ee),null,{default:n(()=>[t(e(Ue),null,{default:n(()=>[t(e(Ae),null,{default:n(()=>[d("Full Test History ("+b(v.value.length)+")",1)]),_:1}),t(e(Le),{slot:"end"},{default:n(()=>[t(e(W),{onClick:N},{default:n(()=>[...l[4]||(l[4]=[d("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(We),{class:"modal-content"},{default:n(()=>[a("div",Zt,[(w(!0),V(ce,null,pe(v.value,(p,h)=>(w(),K(e(A),{key:"modal-".concat(h),class:"test-result-item",lines:"none"},{default:n(()=>[a("div",es,[a("h3",ts,b(p.name),1),a("p",ss,b(p.date),1)]),t(e(Pe),{class:oe(["result-chip",H(p.value)]),slot:"end"},{default:n(()=>[d(b(p.value),1)]),_:2},1032,["class"])]),_:2},1024))),128))])]),_:1})]),_:1},8,["is-open"]),t(e(Ne),{"is-open":I.value,onDidDismiss:r,class:"history-modal"},{default:n(()=>[t(e(Ee),null,{default:n(()=>[t(e(Ue),null,{default:n(()=>[t(e(Ae),null,{default:n(()=>[...l[5]||(l[5]=[d("Select Test and Date",-1)])]),_:1}),t(e(Le),{slot:"end"},{default:n(()=>[t(e(W),{onClick:r},{default:n(()=>[...l[6]||(l[6]=[d("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(We),{class:"modal-content"},{default:n(()=>[t(me,{formData:B.value,ref_key:"formRef",ref:i},null,8,["formData"])]),_:1}),t(e(nt),{style:{padding:"10px"}},{default:n(()=>[t(ct,{style:{float:"right"},name:"Cont.",onClick:_})]),_:1})]),_:1},8,["is-open"])]))}}),as=ee(ns,[["__scopeId","data-v-29352a6b"]]),ls={style:{"max-width":"900px",margin:"auto"}},os={style:{"--background":"#fff"}},is={class:"demographics"},rs={style:{"text-overflow":"ellipsis"}},us={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},ds={style:{"margin-right":"5px"}},cs={style:{"margin-top":"5px"}},ps={class:"demographicsFirstRow"},vs={class:"name custom-name-container"},ms={class:"demographicsOtherRow",style:{"margin-top":"10px"}},fs={class:"demographicsText",style:{display:"flex","flex-wrap":"wrap"}},_s={style:{"flex-shrink":"0"}},ys={style:{"flex-shrink":"0"}},gs={key:0,class:"demographicsOtherRow"},hs={class:"demographicsText mediumFontColor"},xs={key:1,class:"demographicsOtherRow"},ws={class:"demographicsText mediumFontColor"},bs={class:"demographicsOtherRow"},Cs={class:"demographicsText smallFont"},Ts={class:"mediumFontColor"},ks={style:{background:"transparent"}},Is={class:"graphSection"},Rs={class:"graphBtn",style:{"margin-bottom":"5px"}},Ss={class:"weightHeightGraphBtns"},$s={key:0},Ds={key:1},Hs={class:"test-results-container"},Ms={class:"test-buttons-container"},Fs={style:{"margin-left":"10px","margin-right":"10px","margin-top":"10px"}},Vs={class:"ion-padding",slot:"content"},Os=Z({__name:"HTSPatientProfile",setup(O){const{event:C,popoverOpen:x,openPopover:D,openPIM:c,printVisitSummary:I,printID:i,formatCurrentAddress:v}=_t(),F=at(),B=he,H=k(!1),_=k(7),g=k([]),$=k([]),P=k([]),N=xe(),{patient:r}=ge(N),T=async m=>{_.value=m},l=async()=>{const m=te.getLabResults(r.value);P.value=m.results},p=async()=>{var m;$.value=await se.getJson("/hts_referral_orders",{patient_id:(m=r.value)==null?void 0:m.patientID,filter_by_lab_result:!0})},h=async()=>{var s;const m=await vt.getObsByEncounterId(mt.REFERRAL);g.value=((s=m[0])==null?void 0:s.obs)||[]},u=m=>le.calculateDisplayAge(le.toStandardHisFormat(m)),o=()=>{var m,s,q,ne;dt.isEmpty((s=(m=r.value)==null?void 0:m.personInformation)==null?void 0:s.birthdate)||(H.value=le.dateDiffInDays(le.sessionDate(),(ne=(q=r.value)==null?void 0:q.personInformation)==null?void 0:ne.birthdate)<42)},y=()=>{j(gt,{class:"otherVitalsModal"})},R=()=>{j(ht,{class:"otherVitalsModal"})},M=async m=>{m.value_text=="HIV test"&&await j(Ge,{class:"otherVitalsModal"},!0,{order:m}),(m.value_text=="Syphilis"||m.value_text=="Hepatitis B Test"||m.value_text=="Hepatitis C Test")&&await j(Xe,{class:"otherVitalsModal"},!0,{order:m})},S=()=>!!new ft().isUnderFive(),E=()=>{console.log("Navigate to full history")},Q=()=>{console.log("Enter known results")},re=()=>{var m,s;return le.toStandardHisDisplayFormat((s=(m=r.value)==null?void 0:m.personInformation)==null?void 0:s.birthdate)};return qe(()=>F.currentRoute.value,async m=>{m.name=="patientProfile"&&r.value.patientID}),qe(r,async()=>{r&&(o(),await l(),await p())}),Ke(async()=>{o(),await h(),await p(),await l()}),(m,s)=>{var ne,we,be,Ce,Te,ke,Ie,Re,Se,$e,De,He,Me,Fe,Ve,Oe;const q=ie("ion-icon");return w(),V("div",ls,[a("div",os,[a("div",is,[a("div",rs,[a("div",us,[a("div",ds,[t(e(J),null,{default:n(()=>[t(e(L),null,{default:n(()=>{var f,U;return[a("div",{class:oe(((U=(f=e(r))==null?void 0:f.personInformation)==null?void 0:U.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor"),style:{display:"flex","flex-direction":"column","align-items":"center"}},[t(q,{style:{color:"#fff","font-size":"100px"},icon:e(lt)},null,8,["icon"])],2)]}),_:1})]),_:1}),t(e(J),null,{default:n(()=>[t(e(L),null,{default:n(()=>[...s[15]||(s[15]=[a("span",{class:"pill-text"},"Returning Client",-1)])]),_:1})]),_:1})]),a("div",cs,[a("div",ps,[a("div",vs,[(we=(ne=e(r))==null?void 0:ne.personInformation)!=null&&we.given_name?(w(),K(e(J),{key:0,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var f,U;return[d(b((U=(f=e(r))==null?void 0:f.personInformation)==null?void 0:U.given_name),1)]}),_:1})]),_:1})):G("",!0),(Ce=(be=e(r))==null?void 0:be.personInformation)!=null&&Ce.middle_name?(w(),K(e(J),{key:1,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var f,U;return[d(b((U=(f=e(r))==null?void 0:f.personInformation)==null?void 0:U.middle_name),1)]}),_:1})]),_:1})):G("",!0),(ke=(Te=e(r))==null?void 0:Te.personInformation)!=null&&ke.family_name?(w(),K(e(J),{key:2,class:"custom-name-row"},{default:n(()=>[t(e(L),{class:"custom-name-col"},{default:n(()=>{var f,U;return[d(b((U=(f=e(r))==null?void 0:f.personInformation)==null?void 0:U.family_name),1)]}),_:1})]),_:1})):G("",!0)])]),a("div",ms,[a("div",fs,[a("span",_s,b(((Re=(Ie=e(r))==null?void 0:Ie.personInformation)==null?void 0:Re.gender)=="M"?"Male":"Female"),1),s[16]||(s[16]=a("span",{style:{"flex-shrink":"0"}},".",-1)),a("span",ys,b(u(($e=(Se=e(r))==null?void 0:Se.personInformation)==null?void 0:$e.birthdate))+" ("+b(re())+")",1)])]),(He=(De=e(r))==null?void 0:De.personInformation)!=null&&He.current_district?(w(),V("div",gs,[s[17]||(s[17]=a("div",{class:"demographicsText"},"Current Address:",-1)),a("div",hs,b(e(v)(e(r))),1)])):G("",!0),(Fe=(Me=e(r))==null?void 0:Me.personInformation)!=null&&Fe.country?(w(),V("div",xs,[s[18]||(s[18]=a("div",{class:"demographicsText"},"Country:",-1)),a("div",ws,b((Oe=(Ve=e(r))==null?void 0:Ve.personInformation)==null?void 0:Oe.country),1)])):G("",!0),a("div",bs,[a("div",Cs,[s[19]||(s[19]=d(" MRN: ",-1)),a("span",Ts,b(e(r).ID),1)])])])])]),a("div",ks,[t(e(J),{class:"no-wrap-row",style:{"align-items":"center"}},{default:n(()=>[t(e(L),{style:{flex:"1","min-width":"0"}},{default:n(()=>[t(e(W),{class:"deactivate-button",fill:"solid",shape:"round"},{default:n(()=>[...s[20]||(s[20]=[d(" Deactivate Visit ",-1)])]),_:1})]),_:1}),t(e(L),{size:"auto",style:{"flex-shrink":"0"}},{default:n(()=>[a("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:s[0]||(s[0]=f=>e(D)(f))},[t(q,{icon:e(ot)},null,8,["icon"])])]),_:1})]),_:1})])]),a("div",Is,[a("div",null,[S()?(w(),K(yt,{key:0,checkUnderSixWeeks:H.value,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):G("",!0),S()?G("",!0):(w(),K(pt,{key:1}))]),a("div",Rs,[a("div",Ss,[a("div",null,[t(e(W),{class:"btnText",fill:"solid",onClick:s[1]||(s[1]=f=>R())},{default:n(()=>[H.value?(w(),V("span",Ds," Enter Weight")):(w(),V("span",$s," Enter Weight/Height")),t(q,{slot:"end",size:"small",icon:e(B).whiteHeightWeight},null,8,["icon"])]),_:1})]),a("div",null,[t(e(W),{class:"btnText",fill:"solid",onClick:s[2]||(s[2]=f=>y())},{default:n(()=>[s[21]||(s[21]=d(" Enter Other Vitals ",-1)),t(q,{slot:"end",size:"small",icon:e(B).whiteVitals},null,8,["icon"])]),_:1})])])])]),a("div",null,[t(e(A),{class:"new-orders-header"},{default:n(()=>[t(e(z),{class:"new-orders-label"},{default:n(()=>[...s[22]||(s[22]=[d(" NEW ORDERS ",-1)])]),_:1})]),_:1}),a("div",Hs,[a("div",Ms,[t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[3]||(s[3]=f=>M({value_text:"HIV test",new_order:!0}))},{default:n(()=>[...s[23]||(s[23]=[d(" HIV ",-1)])]),_:1}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[4]||(s[4]=f=>M({value_text:"Syphilis",new_order:!0}))},{default:n(()=>[...s[24]||(s[24]=[d(" Syphilis ",-1)])]),_:1}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[5]||(s[5]=f=>M({value_text:"Hepatitis B Test",new_order:!0}))},{default:n(()=>[...s[25]||(s[25]=[d(" Hepatitis B ",-1)])]),_:1}),t(e(W),{class:"test-button",fill:"outline",shape:"round",onClick:s[6]||(s[6]=f=>M({value_text:"Hepatitis C Test",new_order:!0}))},{default:n(()=>[...s[26]||(s[26]=[d(" Hepatitis C ",-1)])]),_:1})]),t(as,{results:P.value,onSeeFullHistory:E,onEnterKnownResults:Q},null,8,["results"])]),t(e(A),{class:"new-orders-header",style:{"margin-top":"10px"}},{default:n(()=>[t(e(z),{class:"new-orders-label"},{default:n(()=>[...s[27]||(s[27]=[d(" ORDERS FROM OTHER CLINICS ",-1)])]),_:1})]),_:1}),a("div",Fs,[(w(!0),V(ce,null,pe($.value,(f,U)=>(w(),K(e(J),{key:U,style:{"margin-bottom":"10px"}},{default:n(()=>[t(e(L),null,{default:n(()=>[t(It,{title:f.value_text,status:"Referred ".concat(f.program_name),type:"hiv",onPressed:Bs=>M(f)},null,8,["title","status","onPressed"])]),_:2},1024)]),_:2},1024))),128))])])]),t(e(ut),{style:{"--offset-x":"-10px"},"is-open":e(x),"show-backdrop":!1,event:e(C),onDidDismiss:s[14]||(s[14]=f=>x.value=!1)},{default:n(()=>[a("div",null,[t(e(it),{multiple:!0},{default:n(()=>[t(e(ae),{value:"first","toggle-icon":"",onClick:s[7]||(s[7]=f=>e(c)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>[...s[28]||(s[28]=[d("Update demographics",-1)])]),_:1})]),_:1})]),_:1}),t(e(ae),{value:"first","toggle-icon":"",onClick:s[8]||(s[8]=()=>{})},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>[...s[29]||(s[29]=[d("Follow up visits",-1)])]),_:1})]),_:1})]),_:1}),t(e(ae),{value:"second","toggle-icon":"",onClick:s[9]||(s[9]=f=>e(I)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>[...s[30]||(s[30]=[d("Print visit summary",-1)])]),_:1})]),_:1})]),_:1}),t(e(ae),{value:"third","toggle-icon":"",onClick:s[10]||(s[10]=f=>e(i)())},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>[...s[31]||(s[31]=[d("Print client identifier",-1)])]),_:1})]),_:1})]),_:1}),t(e(ae),{value:"fourth"},{default:n(()=>[t(e(A),{slot:"header",color:"light"},{default:n(()=>[t(e(z),null,{default:n(()=>[...s[32]||(s[32]=[d("Update outcome",-1)])]),_:1})]),_:1}),a("div",Vs,[t(e(rt),null,{default:n(()=>[t(e(A),null,{default:n(()=>[t(e(fe),{checked:_.value==7,value:"active",onIonChange:s[11]||(s[11]=f=>T(7))},{default:n(()=>[...s[33]||(s[33]=[d(" Active ",-1)])]),_:1},8,["checked"])]),_:1}),t(e(A),null,{default:n(()=>[t(e(fe),{checked:_.value==6,value:"inactive",onIonChange:s[12]||(s[12]=f=>T(6))},{default:n(()=>[...s[34]||(s[34]=[d(" Inactive ",-1)])]),_:1},8,["checked"])]),_:1}),t(e(A),null,{default:n(()=>[t(e(fe),{checked:_.value==3,value:"died",onIonChange:s[13]||(s[13]=f=>T(3))},{default:n(()=>[...s[35]||(s[35]=[d(" Died ",-1)])]),_:1},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])])}}}),an=ee(Os,[["__scopeId","data-v-90989646"]]);export{an as default};
