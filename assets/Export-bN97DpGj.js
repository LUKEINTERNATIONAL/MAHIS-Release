import{r as p,d_ as E,w as D,c8 as P,c9 as T,d$ as _,e0 as d,e1 as x,e2 as B}from"./vendor-DpZZY0VV.js";import{l as M}from"./lodash-NJiRuGo9.js";import{t as y,s as b,K as v}from"./index-CSx4mJoz.js";var i=(t=>(t.WEB="WEB",t.FILE_SYSTEM="FILE_SYSTEM",t))(i||{});const m={Desktop:{profileName:"Desktop",fileExport:"WEB",scanner:"BARCODE_SCANNER",printer:"WEB",keyboard:"NATIVE_AND_HIS_KEYBOARD"},Mobile:{profileName:"Mobile",fileExport:"FILE_SYSTEM",scanner:"CAMERA_SCANNER",printer:"BLUETOOTH",keyboard:"HIS_KEYBOARD_ONLY"}};function S(){const t=p(m.Desktop),e=p({}),r=localStorage.getItem("active_profile"),o=localStorage.getItem("platformProfiles");return typeof o=="string"?e.value=JSON.parse(o):e.value=m,typeof r=="string"&&"".concat(r).match(/\{.*\}/)?t.value=JSON.parse(r):M.isEmpty(e.value)||(E("mobile")&&"Mobile"in e.value?t.value=e.value.Mobile:E("desktop")&&"Desktop"in e.value&&(t.value=e.value.Desktop)),D(()=>t.value,a=>{localStorage.setItem("active_profile",JSON.stringify(a))}),{activePlatformProfile:t,platformProfiles:e}}function k(t){return t.reduce((e,r)=>e+r.map(o=>'"'.concat(o,'"')).join(",")+"\n","")}function g(t,e,r){let o=null;const a="MaHIS/".concat(t.replaceAll("/","_"));v('Exporting file to "Documents/'.concat(a,'"...')),r==="blob"?o=_({path:a,blob:e,directory:d.Documents,recursive:!0}):o=x.writeFile({path:a,data:e,directory:d.Documents,encoding:B.UTF8,recursive:!0}),o!=null&&o.then(()=>v('File exported to "Documents/'.concat(a,'"!'),3e3)).catch(l=>b(l))}function F(t,e,r="document"){e=h(e);const o=k(t.concat(e)),{activePlatformProfile:a}=S(),l="".concat(r,".csv");if(a.value.fileExport===i.WEB){const n=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.setAttribute("id","csv"),s.href=window.URL.createObjectURL(n),s.setAttribute("download","".concat(r,".csv")),document.body.appendChild(s),s.click(),s.remove()}else a.value.fileExport===i.FILE_SYSTEM?g(l,o,"text"):y("Platform not supported")}function L(t,e,r="document",o=!1,a={}){e=h(e);const l=new P({...a}),n=l.splitTextToSize(r,180),s=n.length<=1?20:n.length*10;l.text(n,14,10);const c={startY:s,head:[t[t.length-1]],body:e};o&&(c.tableWidth="wrap",c.horizontalPageBreak=!0,c.horizontalPageBreakRepeat=0),T(l,c);const{activePlatformProfile:f}=S(),u="".concat(r,".pdf");f.value.fileExport===i.WEB?l.save(u):f.value.fileExport===i.FILE_SYSTEM?g(u,l.output(),"blob"):b("Platform not supported")}function h(t){return t.map(r=>r.map(o=>typeof o=="string"?o.replace(/&lt;/g,"<"):o))}export{i as F,L as a,g as e,F as t,S as u};
