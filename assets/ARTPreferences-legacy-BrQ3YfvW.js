System.register(["./vendor-legacy-C9lSrixH.js","./index-legacy-B5pKdIAM.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-pS4pQAVP.js"],function(e,a){"use strict";var t,l,i,n,s,d,u,r,o,c,v,g,m,p,y,_,b,N,C,f,h,E,A,P,M,S,H,I,L,T,V,R,O,w,D,x,$,k,U,B,F,G,j;return{setters:[e=>{t=e.d,l=e.r,i=e.a,n=e.w,s=e.e,d=e.f,u=e.k,r=e.F,o=e.P,c=e.l,v=e.J,g=e.Q,m=e.K,p=e.u,y=e.bs,_=e.eX,b=e.d9,N=e.eY,C=e.eE,f=e.b$,h=e.eZ,E=e.e_,A=e.O,P=e.a4,M=e.aS,S=e.aP,H=e.al,I=e.ak,L=e.$,T=e.m,V=e.L,R=e.X,O=e.bP,w=e.aj,D=e.de,x=e.Z,$=e.b2,k=e.a7},e=>{U=e._,B=e.a0,F=e.c1,G=e.T,j=e.c2},null,null],execute:function(){var a=document.createElement("style");a.textContent=".clinic-days-selector[data-v-95b0e034]{width:100%}.days-container[data-v-95b0e034]{display:flex;flex-wrap:wrap;gap:10px}.day-checkbox[data-v-95b0e034]{min-width:120px}\n/*$vite$:1*/",document.head.appendChild(a);const X={class:"clinic-days-selector"},Y={class:"days-container"},z=U(t({__name:"ClinicDaysSelector",props:{modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:a}){const t=e,_=a,b=[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],N=l([]);return i(()=>{if(t.modelValue)try{try{const e=JSON.parse(t.modelValue);Array.isArray(e)?N.value=e:N.value=t.modelValue.split(",").map(e=>e.trim())}catch{N.value=t.modelValue.split(",").map(e=>e.trim())}}catch(e){console.error("Error parsing clinic days:",e),N.value=[]}}),n(()=>t.modelValue,e=>{if(e)try{try{const a=JSON.parse(e);Array.isArray(a)?N.value=a:N.value=e.split(",").map(e=>e.trim())}catch{N.value=e.split(",").map(e=>e.trim())}}catch(a){console.error("Error parsing clinic days:",a),N.value=[]}else N.value=[]}),(e,a)=>(d(),s("div",X,[u("div",Y,[(d(),s(r,null,o(b,e=>u("div",{key:e.value,class:"day-checkbox"},[c(p(y),{value:e.value,checked:N.value.includes(e.value),onIonChange:a=>(e=>{const a=N.value.indexOf(e);-1===a?N.value.push(e):N.value.splice(a,1);const t=N.value.join(",");_("update:modelValue",t),_("change",t)})(e.value),labelPlacement:"end"},{default:v(()=>[g(m(e.label),1)]),_:2},1032,["value","checked","onIonChange"])])),64))])]))}}),[["__scopeId","data-v-95b0e034"]]),J={class:"ion-padding",slot:"content"},K={key:0},W={key:1},Z={key:2},Q={class:"ion-padding"},q={key:3},ee={class:"ion-padding"};e("default",t({__name:"ARTPreferences",setup(e){const a=l({}),t=async(e,t,l)=>{if(a.value[l]){const n=Boolean(e);a.value[l].data[t]=n,a.value[l].isLoading=!0,a.value[l].statusMessage=void 0;try{await B.set(t,n?"true":"false"),console.log(`Successfully saved ${t} with value: ${n}`)}catch(i){console.error(`Error saving ${t}:`,i),a.value[l].statusMessage=`Failed to save: ${i instanceof Error?i.message:"Unknown error"}`}finally{a.value[l].isLoading=!1}}},i=async(e,t,l,i=!1)=>{if(a.value[l]){a.value[l].data[t]=e,a.value[l].isLoading=!0,a.value[l].statusMessage=void 0;try{let n=e;if(e&&"object"==typeof e&&"value"in e&&(n=e.label),i&&"string"==typeof n){const e=Number(n);if(isNaN(e))return a.value[l].statusMessage="Please enter a valid number",void(a.value[l].isLoading=!1)}await B.set(t,n)}catch(n){console.error(`Error saving ${t}:`,n),a.value[l].statusMessage=`Failed to save: ${n instanceof Error?n.message:"Unknown error"}`}finally{a.value[l].isLoading=!1}}},n=[{icon:_,title:"Filing Numbers",options:[{id:F.FILING_NUMBERS,title:"Enabled Filing Number",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.FILING_NUMBER_LIMIT,title:"Filing Number Limit",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<1||n>1e3?a.value[l].statusMessage="Filing number limit should be between 1 and 1000":i(e,t,l,!0)}}]},{icon:b,title:"Appointments",options:[{id:F.APPOINTMENT_LIMIT,title:"Appointment Limit",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<1||n>500?a.value[l].statusMessage="Appointment limit should be between 1 and 500":i(e,t,l,!0)}},{id:F.ADULT_CLINIC_DAYS,title:"Clinic days (adults: 18 yrs and over)",type:"clinic-days",get:e=>B.get(e)||"",dataHandler:(e,a,t)=>i(e,a,t,!1)},{id:F.PEADS_CLINIC_DAYS,title:"Clinic days (children: Under 18 yrs)",type:"clinic-days",get:e=>B.get(e)||"",dataHandler:(e,a,t)=>i(e,a,t,!1)}]},{icon:N,title:"Clinic Preferences",options:[{id:F.IS_DIC_SITE,title:"Is Military Site",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)}]},{icon:C,title:"Viral load Preferences",options:[{id:F.VL_ROUTINE_CHECK,title:"Activate VL routine check",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.CAN_SCAN_DBS_BARCODE,title:"Scan DBS barcode",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)}]},{icon:f,title:"Lab preferences",options:[{id:F.EXTENDED_LABS,title:"Activate Extended Labs",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.TARGET_LAB,title:"Target lab",type:"facility",get:e=>B.get(e)||"",dataHandler:(e,a,t)=>i(e,a,t,!1)},{id:F.LAB_ORDER_PRINT_COPIES,title:"Specify number of copies to print after an order",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<1||n>10?a.value[l].statusMessage="Number of copies should be between 1 and 10":i(e,t,l,!0)}}]},{icon:h,title:"Hypertension Preferences",options:[{id:F.HTN_ENHANCEMENT,title:"Activate Hypertension screening",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.HTN_DIASTOLIC_THRESHOLD,title:"Set diastolic blood pressure minimum threshold",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<40||n>120?a.value[l].statusMessage="Diastolic BP should be between 40 and 120 mmHg":i(e,t,l,!0)}},{id:F.HTN_SYSTOLIC_THRESHOLD,title:"Set systolic blood pressure minimum threshold",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<70||n>220?a.value[l].statusMessage="Systolic BP should be between 70 and 220 mmHg":i(e,t,l,!0)}},{id:F.HTN_SCREENING_AGE_THRESHOLD,title:"Set HTN Age",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<10||n>100?a.value[l].statusMessage="Age threshold should be between 10 and 100 years":i(e,t,l,!0)}}]},{icon:E,title:"Cervical Cancer Preferences",onOpen:async()=>{var e;a.value["Cervical Cancer Preferences"].data={[F.CERVICAL_CANCER_AGE_BOUNDS]:await B.get(F.CERVICAL_CANCER_AGE_BOUNDS)||""};const[t,l]=(null!==(e=a.value["Cervical Cancer Preferences"].data[F.CERVICAL_CANCER_AGE_BOUNDS])&&void 0!==e?e:"0:0").split(":").map(Number);a.value["Cervical Cancer Preferences"].data.min_cervical_age=t,a.value["Cervical Cancer Preferences"].data.max_cervical_age=l},options:[{id:F.CERVICAL_CANCER_SCREENING,title:"Activate Cervical Cancer Screening",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:"min_cervical_age",title:"Starting screening age",type:"input",get:()=>a.value["Cervical Cancer Preferences"].data.min_cervical_age||"",dataHandler:(e,t,l)=>{const n=Number(e);if(isNaN(n))return void(a.value[l].statusMessage="Please enter valid min age");if(n<10||n>100)return void(a.value[l].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age");const s=a.value[l].data.max_cervical_age;s&&n>=Number(s)?a.value[l].statusMessage="Minimum age should be less than the maximum age":i(`${n}:${s}`,F.CERVICAL_CANCER_AGE_BOUNDS,l,!1)}},{id:"max_cervical_age",title:"Maximum screening age",type:"input",get:()=>a.value["Cervical Cancer Preferences"].data.max_cervical_age||"",dataHandler:(e,t,l)=>{const n=Number(e);if(isNaN(n))return void(a.value[l].statusMessage="Please enter valid max age");if(n<10||n>100)return void(a.value[l].statusMessage="Age bounds should be between 10 and 100 years, with the minimum age being less than the maximum age");const s=a.value[l].data.min_cervical_age;s&&n<Number(s)?a.value[l].statusMessage="Maximum age should be less than the minimum age":i(`${s}:${n}`,F.CERVICAL_CANCER_AGE_BOUNDS,l,!1)}}]},{icon:N,title:"Other Preferences",options:[{id:F.PILLS_REMAINING,title:"Ask pills remaining at home",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.THREE_HP_AUTO_SELECT,title:"Activate 3HP auto select",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.EXCLUDE_EXTERNAL_AND_DRUG_REFILLS,title:"(DATA CLEANING) Exclude External and Emergency supply",type:"toggle",get:e=>B.isProp(`${e}=true`),dataHandler:(e,a,l)=>t(e,a,l)},{id:F.NOTIFICATION_PERIOD,title:"Set Auto Cleaning Alert Days",type:"input",get:e=>B.get(e)||"",dataHandler:(e,t,l)=>{const n=Number(e);isNaN(n)?a.value[l].statusMessage="Please enter a valid number":n<1||n>365?a.value[l].statusMessage="Notification period should be between 1 and 365 days":i(e,t,l,!0)}}]}];return(e,t)=>(d(),A(p(k),null,{default:v(()=>[c(G),c(p(P),{class:"ion-padding"},{default:v(()=>[c(p(M),{style:{margin:"0px auto",width:"70%"}},{default:v(()=>[c(p(S),null,{default:v(()=>[c(p(H),{onIonChange:t[0]||(t[0]=e=>async function(e){const t=n.find(a=>a.title===e);if(t){a.value[t.title]||(a.value[t.title]={isLoading:!1,data:{},statusMessage:void 0}),a.value[t.title].isLoading=!0,t.onOpen&&await t.onOpen().catch(e=>{console.error(`Error loading ${t.title} settings:`,e),a.value[t.title].statusMessage=`Failed to load settings: ${e instanceof Error?e.message:"Unknown error"}`});const e=await Promise.all(t.options.map(async e=>({[e.id]:await e.get(e.id)})));a.value[t.title].data={...a.value[t.title].data,...e.reduce((e,a)=>({...e,...a}),{})},a.value[t.title].isLoading=!1}}(e.detail.value))},{default:v(()=>[(d(),s(r,null,o(n,(e,t)=>c(p(I),{key:t,class:"ion-padding",value:e.title},{default:v(()=>[c(p(L),{slot:"header"},{default:v(()=>{var t,l;return[c(p(V),{size:"large",icon:e.icon},null,8,["icon"]),c(p(R),{style:{padding:"10px"}},{default:v(()=>[g(m(e.title),1)]),_:2},1024),null!==(t=null===(l=a.value)||void 0===l||null===(l=l[e.title])||void 0===l?void 0:l.isLoading)&&void 0!==t&&t?(d(),A(p(O),{key:0,name:"dots",size:"small",slot:"end"})):T("",!0)]}),_:2},1024),u("div",J,[c(p(M),null,{default:v(()=>[c(p(S),null,{default:v(()=>{var t;return[null!==(t=a.value)&&void 0!==t&&null!==(t=t[e.title])&&void 0!==t&&t.data?(d(),A(p(w),{key:0,style:{background:"white"}},{default:v(()=>[(d(!0),s(r,null,o(e.options,t=>{var l,i,n,r,o,y;return d(),s("div",{key:t.id},["toggle"===t.type?(d(),s("div",K,[c(p(L),{color:"light"},{default:v(()=>[c(p(R),null,{default:v(()=>[g(m(t.title),1)]),_:2},1024),c(p(D),{"onUpdate:modelValue":[a=>t.dataHandler(a,t.id,e.title),l=>a.value[e.title].data[t.id]=l],modelValue:a.value[e.title].data[t.id],size:"large",slot:"end","enable-on-off-labels":!0},null,8,["onUpdate:modelValue","modelValue"])]),_:2},1024),null!==(l=a.value[e.title])&&void 0!==l&&l.statusMessage?(d(),A(p(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(m(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])):T("",!0),"input"===t.type?(d(),s("div",W,[c(p($),{"label-placement":"stacked",onIonChange:a=>t.dataHandler(a.detail.value,t.id,e.title),modelValue:a.value[e.title].data[t.id],"onUpdate:modelValue":l=>a.value[e.title].data[t.id]=l,style:{"margin-top":"20px"},label:t.title,fill:"outline",placeholder:"Enter value",slot:"end"},null,8,["onIonChange","modelValue","onUpdate:modelValue","label"]),null!==(i=a.value[e.title])&&void 0!==i&&i.statusMessage?(d(),A(p(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(m(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])):T("",!0),"clinic-days"===t.type?(d(),s("div",Z,[c(p(L),{color:"light"},{default:v(()=>[c(p(R),null,{default:v(()=>[g(m(t.title),1)]),_:2},1024)]),_:2},1024),u("div",Q,[c(z,{modelValue:a.value[e.title].data[t.id],"onUpdate:modelValue":l=>a.value[e.title].data[t.id]=l,onChange:a=>t.dataHandler(a,t.id,e.title)},null,8,["modelValue","onUpdate:modelValue","onChange"]),null!==(n=a.value[e.title])&&void 0!==n&&n.statusMessage?(d(),A(p(x),{key:0,color:"danger"},{default:v(()=>{var t;return[g(m(null===(t=a.value[e.title])||void 0===t?void 0:t.statusMessage),1)]}),_:2},1024)):T("",!0)])])):T("",!0),"facility"===t.type?(d(),s("div",q,[c(p(L),{color:"light"},{default:v(()=>[c(p(R),null,{default:v(()=>[g(m(t.title),1)]),_:2},1024)]),_:2},1024),u("div",ee,[c(j,{label:null!==(r=null===(o=a.value[e.title].data[t.id])||void 0===o?void 0:o.label)&&void 0!==r?r:a.value[e.title].data[t.id],modelValue:a.value[e.title].data[t.id],"onUpdate:modelValue":l=>a.value[e.title].data[t.id]=l,onOnChange:a=>t.dataHandler(a,t.id,e.title),"error-message":null===(y=a.value[e.title])||void 0===y?void 0:y.statusMessage},null,8,["label","modelValue","onUpdate:modelValue","onOnChange","error-message"])])])):T("",!0)])}),128))]),_:2},1024)):T("",!0)]}),_:2},1024)]),_:2},1024)])]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}))}}});
