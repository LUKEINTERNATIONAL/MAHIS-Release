!function(){function t(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var s=a.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}System.register(["./vendor-legacy-aFxqAHge.js","./index-legacy-DJgBI0ZS.js","./BasicForm-legacy-B3k8xV0U.js","./DashBox-legacy-C1VAA5bV.js","./group_validation-legacy-DWn5Gt64.js"],function(e,a){"use strict";var s,i,n,o,l,r,d,u,c,p,h,m,b,v,g,f,y,_,I,D,w,x,S,O,k,T,B,C,R,F,L,M,N,z,P,E,j,$,H,U,A,q,W,J,Y,G,V,X,K,Q,Z,tt,et,at,st,it,nt,ot,lt;return{setters:[t=>{s=t.R,i=t.d,n=t.ar,o=t.V,l=t.as,r=t.af,d=t.D,u=t.dr,c=t.dy,p=t.ac,h=t.G,m=t.T,b=t.U,v=t.a9,g=t.S,f=t.b8,y=t.W,_=t.aU,I=t.X,D=t.E,w=t.y,x=t.f,S=t.z,O=t.l,k=t.k,T=t.B,B=t.A,C=t.e,R=t.F,F=t.L,L=t.a0,M=t.a3,N=t.a1,z=t.a2,P=t.I,E=t.a8,j=t.j},t=>{$=t.aP,H=t.az,U=t.D,A=t.aO,q=t.S,W=t.m,J=t.H,Y=t.ax,G=t.z,V=t.u,X=t._,K=t.i,Q=t.aE,Z=t.B,tt=t.aF,et=t.x,at=t.ay,st=t.bl,it=t.t},t=>{nt=t.B},t=>{ot=t.D},t=>{lt=t.v}],execute:function(){var a=document.createElement("style");a.textContent="ion-footer[data-v-a9001ab2]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-a9001ab2]{--width: 90%;--height: 94%}ion-footer[data-v-5d6713fe]{--ion-toolbar-background: #f4f4f4f4}ion-modal[data-v-5d6713fe]{--width: 90%;--height: 94%}.ion-padding[data-v-bae5aa39]{--padding-start: var(--ion-padding, 0px);--padding-end: var(--ion-padding, 0px);--padding-top: var(--ion-padding, 0px);--padding-bottom: var(--ion-padding, 16px)}#container[data-v-bae5aa39]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container strong[data-v-bae5aa39]{font-size:20px;line-height:26px}#container p[data-v-bae5aa39]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container a[data-v-bae5aa39]{text-decoration:none}.action_buttons[data-v-bae5aa39]{color:var(--ion-color-primary);display:flex;align-items:center;float:right;max-width:70px}.modify_buttons[data-v-bae5aa39]{padding-left:20px}.item_no_border[data-v-bae5aa39]{--border-color: transparent}.search_result[data-v-bae5aa39]{padding:10px}.action_buttons[data-v-bae5aa39]{opacity:0;transition:opacity .3s}.dashed_bottom_border:hover .action_buttons[data-v-bae5aa39]{opacity:1}.dashed_bottom_border[data-v-bae5aa39]{font-weight:700}.sub_item_body[data-v-bae5aa39]{margin-left:45px}ion-segment-button[data-v-bae5aa39]{background:#fff;margin-right:1px;font-size:12px;text-transform:unset}.bottomSummary[data-v-bae5aa39]{margin-top:20px;max-width:600px}.bottomSummary .segment-button-checked[data-v-bae5aa39]{background:#fff!important;--indicator-color: none}.bottomSummary ion-segment-button[data-v-bae5aa39]{background:#e6e6e6;margin-right:5px;border-top-right-radius:10px;border-top-left-radius:10px;text-transform:unset;font-style:normal;font-weight:700;font-size:12px}ion-modal[data-v-72d46b65]{--background: rgba(0, 0, 0, .9);--width: 100%;--height: 200px;--max-width: 700px;--max-height: 100%}.modal-wrapper[data-v-72d46b65]{display:flex;flex-direction:column;gap:20px;padding:16px}.modal-header[data-v-72d46b65]{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap}.modal-title[data-v-72d46b65]{top:20px;font-size:1.3rem;font-weight:600;color:#1e1e1e;line-height:1.4;max-width:90%;white-space:normal;word-break:break-word}.close-btn[data-v-72d46b65]{font-size:1.5rem;color:#b02a37;--padding-start: 0;--padding-end: 0;margin-left:auto}.modal-body[data-v-72d46b65]{font-size:1rem;color:#444;line-height:1.5;padding:4px;margin-left:20px;margin-right:15px}.modal-footer[data-v-72d46b65]{display:flex;justify-content:flex-end;gap:12px;flex-wrap:wrap}.action-btn[data-v-72d46b65]{min-width:100px;height:40px;font-size:.9rem;border-radius:8px;text-transform:none;padding:20px}.confirm-btn[data-v-72d46b65]{--background: var(--ion-color-success);color:#fff}\n/*$vite$:1*/",document.head.appendChild(a);const rt=e("u",s("labResultsStore",{state:()=>({labResults:[]}),actions:{setLabResults(t){this.labResults=t}},persist:!0}));class dt extends ${constructor(e){super(e,32),t(this,"patientID",void 0),t(this,"testTypeID",void 0),t(this,"resultDate",void 0),t(this,"testID",void 0),this.patientID=e,this.testTypeID=-1,this.resultDate="",this.testID=-1}createLabResult(t){return $.postJson(`lab/tests/${this.testID}/results`,{encounter_id:this.encounterID,date:this.resultDate,measures:t})}getTestID(){return this.testID}getTestTypeID(){return this.testTypeID}setTestTypeID(t){this.testTypeID=t}setResultDate(t){this.resultDate=t}setTestID(t){this.testID=t}getTestsWithoutResults(){return H.getOrders(this.patientID,{status:"drawn"})}getTestIndicators(){return H.getJson("lab/test_result_indicators",{test_type_id:this.testTypeID})}static getTestIndicatorsWithID(t){return H.getJson("lab/test_result_indicators",{test_type_id:t})}}e("P",dt);const ut=i({components:{IonButtons:_,IonButton:y,IonModal:f,IonHeader:g,IonContent:v,IonToolbar:b,IonTitle:m,IonItem:h,IonList:p,IonAvatar:c,IonImg:u,IonLabel:d,IonPage:r,IonMenu:l,BasicForm:nt,IonFooter:o,DynamicButton:U},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{type:Object,default:{}},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},computed:{...n(V,["patient"]),...n(rt,["labResults"])},mounted(){},methods:{dismiss(){I.dismiss()},async saveResults(){const t=await this.buildResults();this.patient.labOrders.results=[{encounter_id:"",date:J.sessionDate(),measures:t,test_id:this.labResults[0].id}];let e=!1;for(let a=0;a<this.patient.labOrders.unsaved.length;a++)if(this.patient.labOrders.unsaved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.unsaved[a].tests&&this.patient.labOrders.unsaved[a].tests.length>0){this.patient.labOrders.unsaved[a].tests[0].result=t,e=!0;break}if(!e)for(let a=0;a<this.patient.labOrders.saved.length;a++)if(this.patient.labOrders.saved[a].tests[0].id===this.labResults[0].id&&this.patient.labOrders.saved[a].tests&&this.patient.labOrders.saved[a].tests.length>0){this.patient.labOrders.saved[a].tests[0].result=t;break}await Y(this.patient),G("Saved successfully"),this.$emit("saved")},async buildResults(){let t=[];return await Promise.all(this.labResults[1].data.rowData[0].colData.map(async e=>{var a;let s;s=q.getUseIndexDBStatus()||q.getModsStatus()?await W("testResultIndicators",{whereClause:{test_type_id:e.id}}):await dt.getTestIndicatorsWithID(e.id),t.push({indicator:{name:null===(a=s[0])||void 0===a?void 0:a.name,concept_id:e.id},value:e.value.name||e.value||"not done",value_modifier:"",value_type:"text"})})),t},async nav(t,e){const a=rt();"not_save"==e?(await A(),a.setLabResults(!1)):a.setLabResults(!0),this.dismiss(),this.$router.push(t)}}}),ct={class:"modal_wrapper"},pt={class:"center text_12"};e("a",X(ut,[["render",function(t,e,a,s,i,n){const o=D("ion-title"),l=D("ion-button"),r=D("ion-buttons"),d=D("ion-toolbar"),u=D("ion-header"),c=D("basic-form"),p=D("ion-row"),h=D("ion-content"),m=D("DynamicButton"),b=D("ion-footer"),v=D("ion-modal");return x(),w(v,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[2]||(e[2]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:S(()=>[O(u,null,{default:S(()=>[O(d,null,{default:S(()=>[O(o,null,{default:S(()=>[k("b",null,"Enter lab results for ("+T(t.labResults[0].name)+") test",1)]),_:1}),O(r,{slot:"end"},{default:S(()=>[O(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:S(()=>e[3]||(e[3]=[B("Close")])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),O(h,{class:"ion-padding"},{default:S(()=>[k("div",ct,[k("div",pt,[O(p,null,{default:S(()=>[O(c,{contentData:t.labResults},null,8,["contentData"])]),_:1})])])]),_:1}),O(b,{translucent:!0},{default:S(()=>[O(d,null,{default:S(()=>[O(m,{onClick:e[1]||(e[1]=e=>t.saveResults()),name:"Save",fill:"clear",iconSlot:"icon-only",style:{float:"right"}})]),_:1})]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-a9001ab2"]]));const ht=i({components:{IonButtons:_,IonButton:y,IonModal:f,IonHeader:g,IonContent:v,IonToolbar:b,IonTitle:m,IonItem:h,IonList:p,IonAvatar:c,IonImg:u,IonLabel:d,IonPage:r,IonMenu:l,BasicForm:nt,IonFooter:o,DynamicButton:U},data:()=>({popoverStatus:null}),props:{keyboardClose:{type:Boolean,default:!1},keepContentsMounted:{type:Boolean,default:!1},content:{default:[]},popoverOpen:{type:Boolean,default:!1},event:{type:Event,default:""},title:{type:String,default:""}},methods:{dismiss(){I.dismiss()},nav(t,e){this.dismiss(),this.$router.push(t)}}}),mt={class:"modal_wrapper"},bt={class:"center text_12"};e("L",X(ht,[["render",function(t,e,a,s,i,n){const o=D("ion-title"),l=D("ion-button"),r=D("ion-buttons"),d=D("ion-toolbar"),u=D("ion-header"),c=D("ion-col"),p=D("ion-row"),h=D("ion-content"),m=D("ion-modal");return x(),w(m,{"is-open":t.popoverOpen,"show-backdrop":!0,onDidDismiss:e[1]||(e[1]=e=>t.$emit("closePopoover",!1)),"keyboard-close":t.keyboardClose},{default:S(()=>[O(u,null,{default:S(()=>[O(d,null,{default:S(()=>[O(o,null,{default:S(()=>[k("b",null,"Lab results for ("+T(t.content.name)+") test",1)]),_:1}),O(r,{slot:"end"},{default:S(()=>[O(l,{onClick:e[0]||(e[0]=e=>t.$emit("closeModal"))},{default:S(()=>e[2]||(e[2]=[B("Close")])),_:1,__:[2]})]),_:1})]),_:1})]),_:1}),O(h,{class:"ion-padding"},{default:S(()=>[k("div",mt,[k("div",bt,[O(p,null,{default:S(()=>[(x(!0),C(R,null,F(t.content.result,(t,a)=>(x(),w(c,{size:"4",key:a},{default:S(()=>[O(p,null,{default:S(()=>[O(c,{size:"8"},{default:S(()=>[B(T(t.indicator.name),1)]),_:2},1024),O(c,{class:"bold",size:"0.5"},{default:S(()=>e[3]||(e[3]=[B(":")])),_:1,__:[3]}),O(c,{class:"bold",size:"2"},{default:S(()=>[B(T(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),_:1})]),_:1},8,["is-open","keyboard-close"])}],["__scopeId","data-v-5d6713fe"]]));const vt=s("investigationNCDStore",{state:()=>({investigations:[{db_data:[],isFinishBtn:!1,selectedData:[],displayData:[],data:{rowData:[{colData:[{inputHeader:"Test",icon:K.search,value:"",name:"test",popOver:!0,eventType:"input",required:!0,alertsErrorMassage:"",isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"test_id",validationFunctionName:"required"},{inputHeader:"Specimen",icon:K.search,value:"",name:"specimen",eventType:"input",required:!0,alertsErrorMassage:"",disabled:!0,isSingleSelect:!0,trackBy:"concept_id",multiSelectData:[],id:"",idName:"specimen_id",validationFunctionName:"required"}]}]}}]}),actions:{setInvestigations(t){this.investigations=t}}}),gt=e("_",i({data:()=>({userRole:"",ready:!1,userRoleSettings:{}}),watch:{$route:{async handler(t){this.userRole=q.getUserRoles();const e=q.getProgramID(),a=q.getProgramName();"Lab"==this.userRole&&14==e&&(this.userRoleSettings={url:"home",btnName:"Back to home",stepperTitle:"Laboratory"}),14==e&&"Lab"!=this.userRole&&(this.userRoleSettings={url:"home",btnName:"Go to waiting list",stepperTitle:"Consultation Plan"}),12==e&&(this.userRoleSettings={url:"contact",btnName:"Back"}),"LABOUR AND DELIVERY PROGRAM"==a&&(this.userRoleSettings={url:"labour/labourHome",btnName:"Back to home"}),"PNC PROGRAM"==a&&(this.userRoleSettings={url:"pnc/home",btnName:"Back to home"})},immediate:!0,deep:!0}}})),ft=i({name:"Menu",mixins:[gt],components:{IonContent:v,IonHeader:g,IonItem:h,IonList:p,IonMenu:l,IonTitle:m,IonToolbar:b,IonInput:M,IonPopover:L,DashBox:ot,SelectionPopover:tt,BasicInputField:Z,BasicForm:nt,List:Q,DynamicButton:U},data:()=>({segmentContent:"Lab Investigations",iconsContent:K,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",testResult:"",test:"",labOrders:"",filteredSpecimen:"",testData:[],popoverOpen:!1,labOrderStatus:!1,event:"",specimen:"",radiologyOrdersStatus:!1,otherOrdersStatus:!1}),setup:()=>({checkmark:z,pulseOutline:N}),computed:{...n(vt,["investigations"]),...n(V,["patient"]),inputFields(){return this.investigations[0].data.rowData[0].colData}},watch:{investigations:{handler(){this.setDashedBox()},deep:!0},patient:{async handler(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved]},deep:!0},$route:{async handler(){await this.getTests()},deep:!0}},async mounted(){await this.getTests(),this.updateInvestigationsStores(),this.setDashedBox(),this.updateInvestigationWizard()},methods:{dismiss(){I.dismiss()},setSegmentContent(t){this.segmentContent=t},async getTests(){let t;t=q.getUseIndexDBStatus()&&q.getModsStatus()?await W("testTypes"):await H.getTestTypes(),et(this.investigations,"test","multiSelectData",t)},toggleLabOrderStatus(){this.labOrderStatus=!this.labOrderStatus},async updateInvestigationWizard(){this.labOrders=[...this.patient.labOrders.saved,...this.patient.labOrders.unsaved];const t=await this.labOrders.filter(t=>J.toStandardHisFormat(J.sessionDate())===J.toStandardHisFormat(t.order_date));t.length>0?this.investigations[0].selectedData=t:this.investigations[0].selectedData=""},async updateInvestigationsStores(){await this.updateInvestigationWizard();vt().setInvestigations(this.investigations)},displayInputFields(){this.testResult="",this.selectedText="",this.no_item=!1,this.addItemButton=!1,this.search_item=!0},async validateRowData(){return lt(this.investigations)},async checkTest(){return await this.isNameInData(this.inputFields[0].value.name,await this.investigations[0].selectedData)?(et(this.investigations,"test","alertsErrorMassage","Lab order already selected"),!1):(et(this.investigations,"test","alertsErrorMassage",""),!0)},async addNewRow(){lt(this.investigations)&&await this.checkTest()&&(await this.saveTest(),this.investigations[0].data.rowData[0].colData[0].value="",this.investigations[0].data.rowData[0].colData[1].value="",this.search_item=!1,this.display_item=!0,this.addItemButton=!0),this.updateInvestigationWizard(),this.dismiss()},isNameInData(t,e){for(let a of e)for(let e of a.tests)if(e.name===t)return!0;return!1},async saveTest(){var t,e,a,s,i,n;const o=[{concept_id:this.inputFields[0].value.concept_id,name:this.inputFields[0].value.name,specimen:this.inputFields[1].value.name,reason:"Routine",specimenConcept:await at.getConceptID(this.inputFields[1].value.name,!0)}];let l=(await H.buildLabOrders("",o))[0];l.order_date=l.date,l.specimen.name=this.inputFields[1].value.name,l.tests[0].name=this.inputFields[0].value.name;const r=JSON.parse(JSON.stringify(this.patient));null!==(e=(t=null!==(a=r.labOrders)&&void 0!==a?a:r.labOrders={}).unsaved)&&void 0!==e||(t.unsaved=[]),null!==(i=(s=null!==(n=r.labOrders)&&void 0!==n?n:r.labOrders={}).saved)&&void 0!==i||(s.saved=[]),r.labOrders.unsaved.push(l),await Y(r),et(this.investigations,"specimen","disabled",!0),this.labOrders=[...r.labOrders.saved,...r.labOrders.unsaved]},async handleInputData(t){if("Test"==t.inputHeader&&this.checkTest(),et(this.investigations,"specimen","alertsErrorMassage",""),"Test"==t.inputHeader&&t.value){let e;e=q.getUseIndexDBStatus()&&q.getModsStatus()?await W("specimens"):await H.getSpecimens("",1e3),this.specimen=await at.getConceptSet(t.value.name,"",{names:e.map(t=>t.name)}),1==this.specimen.length?(et(this.investigations,"specimen","value",this.specimen[0]),et(this.investigations,"specimen","disabled",!0)):(et(this.investigations,"specimen","value",""),et(this.investigations,"specimen","disabled",!1)),et(this.investigations,"specimen","multiSelectData",this.specimen)}},async filterTest(t){return await this.labOrders.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))},async filterSpecimen(t){var e;return null!==(e=this.specimen[0])&&void 0!==e&&e.name&&t?await this.specimen.filter(e=>null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())):[]},setTest(t){this.selectedText=t.name,"Test"==this.inputFields[1].inputHeader?this.investigations[0].data.rowData[0].colData[0].value=t.name:this.investigations[0].data.rowData[0].colData[1].value=t.name,this.updateInvestigationsStores()},setDashedBox(){(this.inputFields[1].value||this.inputFields[0].value)&&(this.addItemButton=!1,this.search_item=!0,this.no_item=!1),this.investigations[0].selectedData.length>0?(this.display_item=!0,this.no_item=!1):this.search_item||(this.no_item=!0)}}}),yt={class:"modal_wrapper"},_t={class:""};e("E",X(ft,[["render",function(t,e,a,s,i,n){const o=D("ion-title"),l=D("ion-icon"),r=D("ion-header"),d=D("basic-form"),u=D("ion-content"),c=D("DynamicButton"),p=D("ion-col"),h=D("ion-row"),m=D("ion-footer");return x(),C(R,null,[O(r,{style:{display:"flex","justify-content":"space-between"}},{default:S(()=>[O(o,{class:"modalTitle"},{default:S(()=>e[2]||(e[2]=[B("Add Lab Test")])),_:1,__:[2]}),O(l,{onClick:e[0]||(e[0]=e=>t.dismiss()),style:{"padding-top":"10px","padding-right":"10px"},icon:t.iconsContent.cancel},null,8,["icon"])]),_:1}),O(u,{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:S(()=>[k("div",yt,[k("div",_t,[O(d,{contentData:t.investigations,"onUpdate:selected":t.handleInputData,"onUpdate:inputValue":t.handleInputData},null,8,["contentData","onUpdate:selected","onUpdate:inputValue"])])])]),_:1}),O(m,{collapse:"fade",class:"ion-no-border"},{default:S(()=>[O(h,null,{default:S(()=>[O(p,null,{default:S(()=>[O(c,{onClick:e[1]||(e[1]=e=>t.addNewRow()),name:"Save",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}],["__scopeId","data-v-bae5aa39"]]));const It=i({name:"CheckInConfirmationModal",components:{IonModal:f,IonTitle:m,IonButton:y,IonContent:v,IonIcon:P,DynamicButton:U},props:{isOpen:{type:Boolean,required:!0,default:!1},closeModalFunc:{type:Function,required:!0},onYes:{type:Function,required:!0},onNo:{type:Function,required:!0},title:{type:String,required:!0}},methods:{closeCircleOutline:()=>E,closeModal(){this.closeModalFunc()}}}),Dt={class:"modal-header"},wt={class:"modal-body"},xt={class:"modal-footer"};e("S",X(It,[["render",function(t,e,a,s,i,n){const o=D("ion-title"),l=D("ion-icon"),r=D("ion-button"),d=D("DynamicButton"),u=D("ion-content"),c=D("ion-modal");return x(),w(c,{"is-open":t.isOpen,"show-backdrop":!0,onDidDismiss:t.closeModal},{default:S(()=>[O(u,{class:"modal-wrapper"},{default:S(()=>[k("div",Dt,[O(o,{class:"modal-title"},{default:S(()=>[B(T(t.title),1)]),_:1}),O(r,{fill:"clear",class:"close-btn",onClick:t.closeModal},{default:S(()=>[O(l,{icon:t.closeCircleOutline()},null,8,["icon"])]),_:1},8,["onClick"])]),k("div",wt,[j(t.$slots,"default",{},()=>[e[0]||(e[0]=B(" Sending the patient to the lab will pause this consultation. Youâ€™ll return to the waiting list while waiting for lab results this patient. "))],!0)]),k("div",xt,[O(r,{fill:"outline",color:"danger",class:"action-btn",onClick:t.onNo,style:{"--border-color":"#b42318"}},{default:S(()=>e[1]||(e[1]=[B(" Cancel ")])),_:1,__:[1]},8,["onClick"]),O(d,{name:"Confirm",color:"success",class:"action-btn confirm-btn",fill:"solid",onClick:t.onYes},null,8,["onClick"])])]),_:3})]),_:3},8,["is-open","onDidDismiss"])}],["__scopeId","data-v-72d46b65"]]));e("b",class extends H{constructor(){super()}async postActivities(t,e){const a=e.location_id,s=new st(parseInt(t),-1,a),i=await s.createEncounter();if(i){const t=await H.buildLabOrders(i,e.orders||e);if(!(await H.saveOrdersArray(i.encounter_id,t)))return it("Unable to save lab orders")}}})}}})}();
