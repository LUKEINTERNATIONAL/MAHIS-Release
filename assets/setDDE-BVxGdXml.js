import{d as H,ao as g,db as k,an as V,V as $,U as B,T as F,ap as L,ak as M,G as T,S as N,ah as U,O as A,E as i,y as G,f as u,z as a,e as _,m as S,l as t,k as r,A as n,B as l,p as Y}from"./vendor-jr-7G0gv.js";import{D as z}from"./OutcomeModal-D1NBz2MQ.js";import{F as j,T as R,H as J,J as y,S as f,K as b,t as h,G as K,Q as O,m as Q,R as W,z as D,V as q,j as X,_ as Z}from"./index-DQkIblaa.js";import{B as x}from"./BasicForm-DeMCQ3x2.js";import{F as tt}from"./FacilityInformationBar-DGWBafq1.js";import"./lodash-Dt8AsbQm.js";import"./apexcharts-CRjgaQ7J.js";import"./DateInputField-By-SxJtk.js";const at=H({name:"Menu",components:{IonContent:U,IonHeader:N,IonItem:T,IonList:M,IonMenu:L,IonTitle:F,IonToolbar:B,BasicForm:x,Toolbar:R,DynamicButton:j,IonFooter:$,IonPage:V,FacilityInformationBar:tt,IonToggle:k},data(){return{cardData:{},inputField:"",isDDEEnabled:!0,setName:"",initialPersonalData:[],iconsContent:X,apiDate:"",date:"",DDE:{},isLoading:!1}},computed:{...g(q,["sessionDate"]),...g(D,["globalPropertyStore"])},watch:{globalPropertyStore:{async handler(){await this.setDDEStatus()},deep:!0},$route:{async handler(){await this.ddeData()},deep:!0}},async mounted(){try{this.isLoading=!1,await D().loadDDEStatus(),this.apiDate=await f.getApiDate(),await this.ddeData(),this.date=y(this.sessionDate,"sessionDate","value"),this.isLoading=!1}catch(s){console.log(s)}},methods:{async setDDEStatus(){await D().setGlobalProperty("dde_enabled","".concat(this.globalPropertyStore.dde_enabled)),await this.ddeData()},async ddeData(){if(this.globalPropertyStore.dde_enabled==="true")try{const e=(await W.getRemainingNpids()).npid_status[0],p=e.unassigned,c=e.avg_consumption_rate_per_day||1;this.DDE={id:e.location_id,avg:c,unassigned:e.unassigned,assigned:e.assigned,daysLeft:Math.floor(p/c),allocated:e.allocated,unallocated:e.unallocated,lastUpdated:A(e.date_last_updated).format("DD/MMM/YYYY HH:mm:ss"),title:e.location_name+" DDE NPID Status"}}catch(s){}},openModal(){Q(z)},S(s){return O(this.sessionDate,s.name,this[s.name])},handleInputData(){},async resetSessionDate(){K(this.sessionDate,"sessionDate","value","");try{await f.resetSessionDate(),b("Session date has been reset to ".concat(this.formatDate(this.apiDate))),this.redirect()}catch(s){h("".concat(s))}},redirect(){this.$router.back()},async onSubmit(){this.date=y(this.sessionDate,"sessionDate","value"),console.log("ðŸš€ ~ onSubmit ~ date:",this.date);try{await f.setSessionDate(this.date),b("Successfully Back dated to ".concat(this.formatDate(this.date))),this.redirect()}catch(s){h("".concat(s))}},formatDate(s){return J.toStandardHisDisplayFormat(s)}}}),et={key:0,class:"spinner-overlay"},st={key:0,class:"positionCenter"},ot={class:"card_content"},nt={key:1,class:"positionCenter"},dt={class:"card_content"},lt={class:"card_hearder"},it={key:2};function rt(s,e,p,c,ut,_t){const E=i("ion-spinner"),v=i("Toolbar"),C=i("ion-toggle"),m=i("ion-card"),o=i("ion-row"),d=i("ion-col"),I=i("ion-content"),w=i("ion-page");return u(),G(w,{class:Y({loading:s.isLoading})},{default:a(()=>[s.isLoading?(u(),_("div",et,[t(E,{name:"bubbles"}),e[1]||(e[1]=r("div",{class:"loading-text"},"Please wait...",-1))])):S("",!0),t(v),t(I,{fullscreen:!0},{default:a(()=>[s.globalPropertyStore.dde_enabled?S("",!0):(u(),_("div",st,[t(m,{class:"registration_ion_card"},{default:a(()=>[r("div",ot,[e[3]||(e[3]=r("div",{class:"card_hearder"},"Set DDE",-1)),t(C,{"enable-on-off-labels":!0,modelValue:s.globalPropertyStore.dde_enabled,"onUpdate:modelValue":e[0]||(e[0]=P=>s.globalPropertyStore.dde_enabled=P)},{default:a(()=>e[2]||(e[2]=[n("Enable DDE",-1)])),_:1,__:[2]},8,["modelValue"])])]),_:1})])),s.globalPropertyStore.dde_enabled=="true"?(u(),_("div",nt,[t(m,{class:"registration_ion_card"},{default:a(()=>[r("div",dt,[r("div",lt,l(s.DDE.title),1),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[4]||(e[4]=[n("Location ID",-1)])),_:1,__:[4]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.id),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[5]||(e[5]=[n("Estimated days left",-1)])),_:1,__:[5]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.avg),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[6]||(e[6]=[n("Unassigned",-1)])),_:1,__:[6]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.unassigned),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[7]||(e[7]=[n("Assigned",-1)])),_:1,__:[7]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.assigned),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[8]||(e[8]=[n("Unallocated",-1)])),_:1,__:[8]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.unallocated),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[9]||(e[9]=[n("Allocated",-1)])),_:1,__:[9]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.allocated),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[10]||(e[10]=[n("Average consumption per day",-1)])),_:1,__:[10]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.daysLeft),1)]),_:1})]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(d,null,{default:a(()=>[t(o,{class:"ddeStatusHeader"},{default:a(()=>e[11]||(e[11]=[n("Last update",-1)])),_:1,__:[11]})]),_:1}),t(d,null,{default:a(()=>[t(o,{class:"ddeStatusContent"},{default:a(()=>[n(l(s.DDE.lastUpdated),1)]),_:1})]),_:1})]),_:1})])]),_:1})])):(u(),_("div",it,e[12]||(e[12]=[r("div",{class:"card_hearder"},"DDE is disabled",-1)])))]),_:1})]),_:1},8,["class"])}const bt=Z(at,[["render",rt],["__scopeId","data-v-b3fd4877"]]);export{bt as default};
