!function(){function e(e,a,l){return(a=function(e){var a=function(e,a){if("object"!=typeof e||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var t=l.call(e,a||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:a+""}(a))in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}System.register(["./vendor-legacy-BYCqecn6.js","./index-legacy-khbCnrxi.js","./voidReason-legacy-DIJrE1HW.js","./lodash-legacy-pOOc9Efu.js","./apexcharts-legacy-BVZ4VPx8.js"],function(a,l){"use strict";var t,s,n,i,r,o,d,u,c,v,m,p,y,f,h,g,_,w,b,M,D,x,S,k,V,A,N,z,E,C,T,H,q,I,P,$,j,U,O,R,B,W,F,L,J,X,G,K,Q,Y,Z,ee,ae,le,te,se,ne,ie,re,oe,de,ue,ce,ve,me,pe,ye,fe,he,ge,_e,we,be,Me,De,xe,Se;return{setters:[e=>{t=e.d,s=e.r,n=e.e,i=e.f,r=e.m,o=e.l,d=e.k,u=e.u,c=e.bQ,v=e.z,m=e.U,p=e.T,y=e.A,f=e.aR,h=e.W,g=e.I,_=e.b1,w=e.S,b=e.F,M=e.L,D=e.y,x=e.ak,S=e.a$,k=e.a_,V=e.B,A=e.cf,N=e.dc,z=e.a8,E=e.ah,C=e.G,T=e.D,H=e.X,q=e.R,I=e.c,P=e.aX,$=e.w,j=e.a,U=e.E,O=e.i,R=e.v,B=e.dd,W=e.ab,F=e.bo,L=e.d6,J=e.V,X=e.de,G=e.ai,K=e.aj,Q=e.df,Y=e.dg,Z=e.dh,ee=e.di,ae=e.dj,le=e.dk,te=e.da,se=e.d9,ne=e.bd,ie=e.p,re=e.an,oe=e.dl,de=e.dm,ue=e.dn,ce=e.dp,ve=e.dq,me=e.dr,pe=e.ds},e=>{ye=e.S,fe=e.K,he=e.t,ge=e._,_e=e.j,we=e.F,be=e.U,Me=e.T,De=e.m},e=>{xe=e.v},e=>{Se=e.l},null],execute:function(){var l=document.createElement("style");l.textContent=".icon-container[data-v-2367d70b]{display:flex;justify-content:center;align-items:center;background-color:#bbf7d0;padding:5px;border-radius:5px;width:35px;height:35px;margin-right:5px}.text-mobile[data-v-2367d70b]{font-size:1.5rem}@media (max-width: 768px){.text-mobile[data-v-2367d70b]{font-size:1.2rem}}.alerts_error[data-v-097a281e]{margin-top:2px;color:#b42318;display:flex;font-size:15px;overflow:hidden;overflow:auto;padding:5px;border-radius:3px}.heading[data-v-e2bb2908]{width:100%;text-align:center;font-weight:700}\n/*$vite$:1*/",document.head.appendChild(l);class ke extends ye{constructor(){super(),e(this,"ENDPOINT","eir/session_schedule")}async create(e){return ye.postJson(this.ENDPOINT,e)}async get(e){return ye.getJson(this.ENDPOINT,{session_id:e})}async update(e,a){return ye.putJson(`${this.ENDPOINT}/${a}`,e)}async delete(e,a){return ye.delete(`${this.ENDPOINT}?id=${e}`,{void_reason:a})}async getSessions(e="",a="",l="",t=1,s=10){return ye.getJson(this.ENDPOINT)}}const Ve={key:0,class:"spinner-overlay"},Ae={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ne={style:{display:"flex","align-items":"center"}},ze={slot:"start",class:"icon-color"},Ee=["width","height"],Ce={slot:"start",class:"icon-color"},Te=["width","height"],He=["innerHTML"],qe={slot:"start",class:"icon-color"},Ie=["width","height"],Pe={slot:"start",class:"icon-color"},$e=["width","height"],je=ge(t({__name:"ViewImmunizationSessionModal",props:{data:{type:Array,default:[],required:!0}},setup(e){const a=e,l=s(40),t=s(40),q=s(!1),I=s({}),P=e=>{var a;return((null===(a=e.session_vaccines)||void 0===a?void 0:a.vaccines)||[]).map(e=>`${e.drug_name} <b>(${e.missed_doses})</b>`).join(", ")},$=()=>{H.dismiss()};return(e,s)=>(i(),n(b,null,[q.value?(i(),n("div",Ve,[o(u(c),{name:"bubbles"}),s[0]||(s[0]=d("div",{class:"loading-text"},"Please wait...",-1))])):r("",!0),o(u(w),null,{default:v(()=>[o(u(m),null,{default:v(()=>[o(u(p),null,{default:v(()=>s[1]||(s[1]=[y("View Immunization Session Schedule",-1)])),_:1,__:[1]}),o(u(f),{slot:"end"},{default:v(()=>[o(u(h),{onClick:$},{default:v(()=>[o(u(g),{icon:u(_),color:"white"},null,8,["icon"])]),_:1})]),_:1}),s[2]||(s[2]=d("div",{slot:"start"},[d("div",{style:{"margin-left":"15px"}},[d("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 64 64"},[d("path",{fill:"currentColor",d:"M33.208 25.544a3.616 3.616 0 0 1 4.548 2.347a3.62 3.62 0 0 1-2.346 4.549l-9.838 3.144a3.62 3.62 0 0 1-3.331-.597l-4.069-3.184l8.835 31.777H1.267V23.208a4.32 4.32 0 0 1 4.319-4.317h6.435c.918 0 1.764.293 2.46.836l10.711 8.379l8.016-2.563zM17.486 37.718h-3.904v-3.909H8.923v3.909h-3.89v4.673h3.89v3.889h4.659v-3.889h3.904zM9.655 16.951a7.77 7.77 0 0 0 0-15.538a7.77 7.77 0 0 0-7.769 7.768a7.77 7.77 0 0 0 7.769 7.77m45.715.028a7.78 7.78 0 0 0 7.779-7.777c0-4.301-3.486-7.787-7.779-7.787a7.783 7.783 0 0 0-7.781 7.787a7.78 7.78 0 0 0 7.781 7.777"}),d("path",{fill:"currentColor",d:"M53.02 19.069c-3.184 0-4.628 1.089-5.837 2.975l-.782 1.504l-4.547-1.328l.192-1.239l-10.857-2.432l-.304 1.354l-2.031-.452l.302-1.358l-.815-.18l-.932 4.16l.811.18l.311-1.358l2.031.454l-.304 1.361l10.86 2.432l.351-1.274l4.399.707l-11.335 21.8a3.545 3.545 0 0 0 1.588 4.757a3.553 3.553 0 0 0 4.764-1.586l9.456-18.351h1.551v32.386h11.147V19.07H53.021z"})])])],-1))]),_:1,__:[2]})]),_:1}),o(u(E),null,{default:v(()=>[a.data.length>0?(i(!0),n(b,{key:0},M(a.data,(e,r)=>(i(),D(u(x),{style:{margin:"-10px"},key:e.id},{default:v(()=>[d("div",Ae,[o(u(S),{style:{flex:"1"}},{default:v(()=>[d("div",null,[o(u(k),{class:"ion-text-wrap text-mobile"},{default:v(()=>[y(V(e.session_name),1)]),_:2},1024),o(u(A),null,{default:v(()=>[y(" Scheduled from: "+V(e.start_date)+" to "+V(e.end_date),1)]),_:2},1024)])]),_:2},1024),d("div",Ne,[o(u(h),{fill:"clear",id:`click-trigger-${r}-`,style:{"margin-left":"auto"}},{default:v(()=>[o(u(g),{icon:u(N)},null,8,["icon"])]),_:2},1032,["id"])]),o(u(z),{"dismiss-on-select":"",trigger:`click-trigger-${r}-`,"trigger-action":"click",ref_for:!0,ref:e=>{e&&(I.value[r]=e)}},{default:v(()=>[o(u(E),null,{default:v(()=>[o(u(x),null,{default:v(()=>[o(u(C),{button:"",onClick:a=>(async e=>{H.dismiss({edit:e})})(e)},{default:v(()=>[o(u(T),null,{default:v(()=>s[3]||(s[3]=[y("Edit",-1)])),_:1,__:[3]})]),_:2},1032,["onClick"]),o(u(C),{button:"",onClick:l=>(async e=>{const l=await H.create({component:xe,cssClass:"otherVitalsModal",componentProps:{data:a.data}});await l.present(),l.onDidDismiss().then(async a=>{if(a.data){q.value=!0;const l=new ke;await l.delete(Number(e.session_schedule_id),a.data.name)?fe("Immunization schedule deleted successfully!"):he("An error occurred, please try again later."),q.value=!1,H.dismiss({update:!0})}})})(e)},{default:v(()=>[o(u(T),null,{default:v(()=>s[4]||(s[4]=[y("Cancel",-1)])),_:1,__:[4]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["trigger"])]),o(u(x),{style:{margin:"10px"}},{default:v(()=>[o(u(C),null,{default:v(()=>[d("div",ze,[(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.value,height:l.value,viewBox:"0 0 20 20"},s[5]||(s[5]=[d("g",{fill:"currentColor"},[d("g",{opacity:"0.2"},[d("path",{d:"M9.75 7.75a3 3 0 1 1-6 0a3 3 0 0 1 6 0"}),d("path",{"fill-rule":"evenodd",d:"M6.75 8.75a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 2a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M6.8 11.5A1.5 1.5 0 0 0 5.3 13v1.5a1 1 0 0 1-2 0V13a3.5 3.5 0 0 1 7 0v.5a1 1 0 1 1-2 0V13a1.5 1.5 0 0 0-1.5-1.5","clip-rule":"evenodd"}),d("path",{d:"M12.75 7.75a3 3 0 1 0 6 0a3 3 0 0 0-6 0"}),d("path",{"fill-rule":"evenodd",d:"M15.75 8.75a1 1 0 1 1 0-2a1 1 0 0 1 0 2m0 2a3 3 0 1 1 0-6a3 3 0 0 1 0 6","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M15.7 11.5a1.5 1.5 0 0 1 1.5 1.5v1.5a1 1 0 1 0 2 0V13a3.5 3.5 0 0 0-7 0v.5a1 1 0 1 0 2 0V13a1.5 1.5 0 0 1 1.5-1.5","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M11.3 14.25a1.5 1.5 0 0 0-1.5 1.5v1.5a1 1 0 0 1-2 0v-1.5a3.5 3.5 0 0 1 7 0v1.5a1 1 0 1 1-2 0v-1.5a1.5 1.5 0 0 0-1.5-1.5","clip-rule":"evenodd"}),d("path",{d:"M14.25 10.5a3 3 0 1 1-6 0a3 3 0 0 1 6 0"}),d("path",{"fill-rule":"evenodd",d:"M11.25 11.5a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 2a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),d("path",{d:"M4.25 11.5h5v4h-5zm9 0h5v4h-5z"}),d("path",{d:"M9.25 13.5h4l.5 4.75h-5z"})]),d("path",{"fill-rule":"evenodd",d:"M5 9a2 2 0 1 0 0-4a2 2 0 0 0 0 4m0 1a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M3.854 8.896a.5.5 0 0 1 0 .708l-.338.337A3.47 3.47 0 0 0 2.5 12.394v1.856a.5.5 0 1 1-1 0v-1.856a4.47 4.47 0 0 1 1.309-3.16l.337-.338a.5.5 0 0 1 .708 0m11.792-.3a.5.5 0 0 0 0 .708l.338.337A3.47 3.47 0 0 1 17 12.094v2.156a.5.5 0 0 0 1 0v-2.156a4.47 4.47 0 0 0-1.309-3.16l-.337-.338a.5.5 0 0 0-.708 0","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M14 9a2 2 0 1 1 0-4a2 2 0 0 1 0 4m0 1a3 3 0 1 1 0-6a3 3 0 0 1 0 6m-4.5 3.25a2.5 2.5 0 0 0-2.5 2.5v1.3a.5.5 0 0 1-1 0v-1.3a3.5 3.5 0 0 1 7 0v1.3a.5.5 0 1 1-1 0v-1.3a2.5 2.5 0 0 0-2.5-2.5","clip-rule":"evenodd"}),d("path",{"fill-rule":"evenodd",d:"M9.5 11.75a2 2 0 1 0 0-4a2 2 0 0 0 0 4m0 1a3 3 0 1 0 0-6a3 3 0 0 0 0 6","clip-rule":"evenodd"})],-1)]),8,Ee))]),o(u(T),null,{default:v(()=>{var a,l;return[s[6]||(s[6]=d("h3",{class:"ion-label-h3"},"Expected Clients",-1)),d("p",null,V(null===(a=e.session_vaccines)||void 0===a?void 0:a.total_clients)+" people (Under 5), "+V(null===(l=e.session_vaccines)||void 0===l?void 0:l.total_missed_doses)+" doses required ",1)]}),_:2,__:[6]},1024)]),_:2},1024),o(u(C),null,{default:v(()=>[d("div",Ce,[(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.value,height:l.value,viewBox:"0 0 48 48"},s[7]||(s[7]=[d("g",{fill:"currentColor"},[d("path",{"fill-rule":"evenodd",d:"M6.818 14.5a1.157 1.157 0 0 1 0-1.636l6.546-6.546A1.157 1.157 0 1 1 15 7.955l-.818.817l4.09 4.09l3.273-3.272a1.157 1.157 0 1 1 1.637 1.636l-1.637 1.637l13.91 13.91a5.79 5.79 0 0 1 1.295 6.205l1.159 1.159c.605.605.805 1.463.6 2.235l2.673 2.673a1.157 1.157 0 1 1-1.637 1.637l-2.673-2.673a2.31 2.31 0 0 1-2.236-.6l-1.158-1.158a5.79 5.79 0 0 1-6.205-1.296l-2.14-2.14l6.767-6.768l-11.77-11.77l-5.353 5.354L17.147 22h-2.829l-.955-.955l-1.636 1.636a1.157 1.157 0 1 1-1.636-1.636l3.273-3.273l-4.09-4.09l-.82.818a1.157 1.157 0 0 1-1.636 0m5.95-4.313l-2.08 2.08l4.09 4.09l2.08-2.08zM28.687 33.54a3.79 3.79 0 0 0 4.061.847l2.14-2.14a3.79 3.79 0 0 0-.848-4.06l-.504-.505l-5.353 5.354zm6.768 1.414q-.112.113-.229.216l.824.824a.314.314 0 1 0 .445-.444l-.824-.824a6 6 0 0 1-.216.228","clip-rule":"evenodd"}),d("path",{d:"M16 28a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 0 1-2 0v-2h-2a1 1 0 0 1 0-2h2v-2a1 1 0 0 1 1-1"}),d("path",{"fill-rule":"evenodd",d:"M8.66 37.689A12.12 12.12 0 0 0 15.5 42a12.12 12.12 0 0 0 6.84-4.31A12.35 12.35 0 0 0 25 29.997V26.4c0-.637-.25-1.247-.695-1.697a2.36 2.36 0 0 0-1.68-.703H8.376c-.63 0-1.234.253-1.68.703A2.4 2.4 0 0 0 6 26.4v3.598a12.35 12.35 0 0 0 2.66 7.69M23 29.999v.004a10.35 10.35 0 0 1-2.228 6.445a10.13 10.13 0 0 1-5.273 3.492a10.13 10.13 0 0 1-5.271-3.492A10.35 10.35 0 0 1 8 30.002V26.4c0-.113.045-.217.117-.29a.36.36 0 0 1 .257-.11h14.252c.092 0 .185.037.257.11a.4.4 0 0 1 .117.29z","clip-rule":"evenodd"})],-1)]),8,Te))]),o(u(T),null,{default:v(()=>[s[8]||(s[8]=d("h3",{class:"ion-label-h3"},"Vaccines",-1)),d("p",{innerHTML:P(e)},null,8,He)]),_:2,__:[8]},1024)]),_:2},1024),o(u(C),null,{default:v(()=>[d("div",qe,[(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.value,height:l.value,viewBox:"0 0 32 32"},s[9]||(s[9]=[d("path",{fill:"currentColor",d:"m27 25.586l-2-2V21h-2v3.414L25.586 27z"},null,-1),d("path",{fill:"currentColor",d:"M24 31c-3.86 0-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7s-3.14 7-7 7m0-12c-2.757 0-5 2.243-5 5s2.243 5 5 5s5-2.243 5-5s-2.243-5-5-5m4-4h2V5c0-1.103-.897-2-2-2h-3v2h3z"},null,-1),d("circle",{cx:"9",cy:"13",r:"2",fill:"currentColor"},null,-1),d("circle",{cx:"16",cy:"13",r:"2",fill:"currentColor"},null,-1),d("circle",{cx:"23",cy:"13",r:"2",fill:"currentColor"},null,-1),d("path",{fill:"currentColor",d:"M7 23H4c-1.103 0-2-.897-2-2V5c0-1.103.897-2 2-2h3v2H4v16h3z"},null,-1)]),8,Ie))]),o(u(T),null,{default:v(()=>[s[11]||(s[11]=d("h3",{class:"ion-label-h3"},"Session type",-1)),d("p",null,[y(V(e.session_type)+" ("+V(e.repeat_type)+" repeat - ",1),d("span",null,[d("b",null,V(e.frequency)+" times",1)]),s[10]||(s[10]=y(")",-1))])]),_:2,__:[11]},1024)]),_:2},1024),o(u(C),null,{default:v(()=>[d("div",Pe,[(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.value,height:l.value,viewBox:"0 0 256 256"},s[12]||(s[12]=[d("g",{fill:"currentColor"},[d("path",{d:"M112 168a32 32 0 1 1-32-32a32 32 0 0 1 32 32M80 32a32 32 0 1 0 32 32a32 32 0 0 0-32-32m96 104a32 32 0 1 0 32 32a32 32 0 0 0-32-32m0-40a32 32 0 1 0-32-32a32 32 0 0 0 32 32",opacity:"0.2"}),d("path",{d:"M27.2 126.4a8 8 0 0 0 11.2-1.6a52 52 0 0 1 83.2 0a8 8 0 0 0 11.2 1.59a7.7 7.7 0 0 0 1.59-1.59a52 52 0 0 1 83.2 0a8 8 0 0 0 12.8-9.61A67.85 67.85 0 0 0 203 93.51a40 40 0 1 0-53.94 0a67.3 67.3 0 0 0-21 14.31a67.3 67.3 0 0 0-21-14.31a40 40 0 1 0-53.94 0A67.9 67.9 0 0 0 25.6 115.2a8 8 0 0 0 1.6 11.2M176 40a24 24 0 1 1-24 24a24 24 0 0 1 24-24m-96 0a24 24 0 1 1-24 24a24 24 0 0 1 24-24m123 157.51a40 40 0 1 0-53.94 0a67.3 67.3 0 0 0-21 14.31a67.3 67.3 0 0 0-21-14.31a40 40 0 1 0-53.94 0A67.9 67.9 0 0 0 25.6 219.2a8 8 0 1 0 12.8 9.6a52 52 0 0 1 83.2 0a8 8 0 0 0 11.2 1.59a7.7 7.7 0 0 0 1.59-1.59a52 52 0 0 1 83.2 0a8 8 0 0 0 12.8-9.61A67.85 67.85 0 0 0 203 197.51M80 144a24 24 0 1 1-24 24a24 24 0 0 1 24-24m96 0a24 24 0 1 1-24 24a24 24 0 0 1 24-24"})],-1)]),8,$e))]),o(u(T),null,{default:v(()=>[s[13]||(s[13]=d("h3",{class:"ion-label-h3"},"Assignees",-1)),d("p",null,V(e.assignees.map(e=>`${e.given_name}\n                                ${e.family_name}`).join(", ")),1)]),_:2,__:[13]},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):r("",!0)]),_:1})],64))}}),[["__scopeId","data-v-2367d70b"]]),Ue=[{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Session name",value:"",name:"batch",eventType:"input",alertsErrorMassage:"",valueType:"text",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"Start Date",icon:_e.calenderPrimary,value:"",name:"start date",eventType:"input",alertsErrorMassage:"",required:!0,isDatePopover:!0,minDate:"",maxDate:"",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"End date",icon:_e.calenderPrimary,value:"",name:"end date",eventType:"input",alertsErrorMassage:"",required:!0,isDatePopover:!0,minDate:"",maxDate:"",validationFunctionName:"required"}]}]}},{data:{rowData:[{colData:[{inputHeader:"Session type",icon:_e.search,value:"",name:"product name",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isSingleSelect:!0,trackBy:"id",multiSelectData:[{id:"1",name:"Static"},{id:"2",name:"Outreach"}]}]}]}},{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Repeat",icon:_e.search,value:"",name:"repeat",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isSingleSelect:!0,trackBy:"id",multiSelectData:[{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]}]}]}},{selectedData:{},isFinishBtn:!1,data:{rowData:[{colData:[{inputHeader:"Assignees",icon:_e.search,value:[],name:"assignees",eventType:"input",alertsErrorMassage:"",selectedID:"",validationFunctionName:"required",isMultiSelect:!0,trackBy:"user_id",multiSelectData:[]}]}]}}],Oe=q("immunizationSessionsStore",{state:()=>({immunizationSessions:[...Ue]}),actions:{setImmunizationSessions(e){this.immunizationSessions=e},getImmunizationSessions:()=>[...Se.cloneDeep(Ue)],resetFieldValues(){const e={string:"",number:0,boolean:!1,array:new Array,object:{}};this.immunizationSessions.forEach(a=>{a.data.rowData.forEach(a=>{a.colData.forEach(a=>{a.value=e[(Array.isArray(a.value),"array")]})})})}}}),Re=(e,a,l,t,s,n)=>{const i=[];if(e.trim()||i.push({field:"sessionName",message:"Session name is required."}),Array.isArray(a))if(2!==a.length)i.push({field:"dateRange",message:"Date range is required."});else{const[e,l]=a;e>l&&i.push({field:"dateRange",message:"Start date must be before end date."})}else"string"==typeof a&&""===a.trim()&&i.push({field:"dateRange",message:"A date is required."});if(l||i.push({field:"repeatType",message:"Repeat type is required."}),"Never"!==l&&(!t||t<1)){const e={Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"};i.push({field:"numberOfDays",message:`Number of ${e[l]} is required.`})}return s||i.push({field:"sessionType",message:"Session type is required."}),0===n.length&&i.push({field:"assignees",message:"At least one assignee is required."}),{isValid:0===i.length,errors:i}},Be={key:0,class:"spinner-overlay"},We={key:0,class:"alerts_error"},Fe={style:{"margin-top":"20px"}},Le={key:0,class:"alerts_error"},Je={key:0,style:{"margin-top":"20px"}},Xe={style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},Ge={key:0,class:"alerts_error"},Ke={style:{"margin-top":"20px"}},Qe={key:0,class:"alerts_error"},Ye={style:{"margin-top":"20px"}},Ze={key:0,class:"alerts_error"},ea={style:{"margin-top":"20px"}},aa={key:0,class:"alerts_error"},la=ge(t({__name:"AddImmunizationSessionModal",setup(e){const a=Oe(),l=s(!1),t=s(),c=e=>P(new Date(e),"MM/dd/yyyy"),f=s([{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]),M=s(""),D=s([{id:"1",name:"Static"},{id:"2",name:"Outreach"}]),x=s(""),S=s(!1),k=s(1),A=s([]),N=s(""),z=s([]),C=s(""),T=s(""),q=s(""),G=s(""),K=s(""),Q=s(""),Y=I(()=>null===M.value||"daily"!==M.value.toLowerCase()),Z=I(()=>{if(!t.value)return"";if(Array.isArray(t.value)){const[e,a]=t.value;return e||a?e&&a?`${c(e)} - ${c(a)}`:c(e||a):""}return c(t.value)}),ee=I(()=>Array.isArray(t.value)&&void 0!==t.value?c(t.value[0]):Array.isArray(t.value)||void 0===t.value?"":void 0!==t.value?c(String(t.value)):""),ae=I(()=>Array.isArray(t.value)?c(t.value[1]):Array.isArray(t.value)?"":void 0!==t.value?c(String(t.value)):""),le=I(()=>({Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"}[M.value]||"")),te=I(()=>`Enter number of ${le.value}`),se=e=>{const a={sessionName:C,dateRange:T,repeatType:q,numberOfDays:G,sessionType:K,assignees:Q};Object.keys(a).forEach(e=>{a[e].value=""}),e.forEach(e=>{a[e.field]&&(a[e.field].value=e.message)})},ne=()=>{H.dismiss({update:!0})};$(M,(e,a)=>{if(e===a)return;const l={null:()=>{S.value=!1},Never:()=>{S.value=!1},Daily:()=>{S.value=!0,k.value=1,t.value=""},Weekly:()=>{S.value=!0,k.value=1,Array.isArray(t.value)||(t.value=[])},Monthly:()=>{S.value=!0,k.value=1,Array.isArray(t.value)||(t.value=[])},default:()=>{S.value=!0,k.value=1}};(l[e]||l.default)()}),$([N,t,M,k,x,z],()=>{const e=Re(N.value,t.value||String,M.value,k.value,x.value,z.value);se(e.errors)});return $(t,e=>{if(!Array.isArray(e)||2!==e.length)return;const[a,l]=e,s=X(l,a);"Weekly"===M.value&&s>7&&(he("Weekly repeat type is not available for more than 7 days"),t.value=void 0)}),j(async()=>{await(async()=>{const e=(await be.getUsersByRole({role:"Health Surveillance"})).map(e=>({...e,name:e.username,id:e.user_id}));A.value=e})()}),(e,s)=>{const c=U("ion-spinner"),I=U("VueDatePicker"),$=U("ion-col"),j=U("ion-row");return i(),n(b,null,[l.value?(i(),n("div",Be,[o(c,{name:"bubbles"}),s[9]||(s[9]=d("div",{class:"loading-text"},"Please wait...",-1))])):r("",!0),o(u(w),null,{default:v(()=>[o(u(m),null,{default:v(()=>[o(u(p),{class:"modalTitle"},{default:v(()=>s[10]||(s[10]=[y("Create Immunization Session Schedule",-1)])),_:1,__:[10]}),o(u(h),{fill:"clear",slot:"end",onClick:s[0]||(s[0]=e=>ne())},{default:v(()=>[o(u(g),{icon:u(_),color:"white"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),O(o(u(B),{trigger:"open-loading",message:"Saving, please wait..."},null,512),[[R,l.value]]),o(u(E),{fullscreen:!0,class:"ion-padding",style:{"--background":"#fff"}},{default:v(()=>[d("div",null,[s[11]||(s[11]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session name",-1)),o(u(W),{clear:"",fill:"outline",placeholder:"Enter the session name",modelValue:N.value,"onUpdate:modelValue":s[1]||(s[1]=e=>N.value=e)},null,8,["modelValue"]),C.value?(i(),n("div",We,V(C.value),1)):r("",!0)]),d("div",Fe,[s[12]||(s[12]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Repeat type",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:f.value.map(e=>e.name),modelValue:M.value,"onUpdate:modelValue":s[2]||(s[2]=e=>M.value=e),searchable:!1,"show-labels":!1,placeholder:"Select repeat type"},null,8,["options","modelValue"]),q.value?(i(),n("div",Le,V(q.value),1)):r("",!0)]),S.value?(i(),n("div",Je,[d("label",Xe,"Number of "+V(le.value),1),o(u(W),{modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=e=>k.value=e),clear:"",fill:"outline",placeholder:te.value},null,8,["modelValue","placeholder"]),G.value?(i(),n("div",Ge,V(G.value),1)):r("",!0)])):r("",!0),d("div",Ke,[s[13]||(s[13]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Start & End Date",-1)),o(I,{required:"",position:"left",placeholder:"select start & end date",range:Y.value,ui:{input:"datepicker"},format:"dd/MM/yyyy",modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=e=>t.value=e),"min-date":new Date},{trigger:v(()=>[o(u(W),{clear:"",fill:"outline",placeholder:"select start & end date",value:`${Z.value}`},{default:v(()=>[o(u(g),{slot:"start",icon:u(L)},null,8,["icon"])]),_:1},8,["value"])]),_:1},8,["range","modelValue","min-date"]),T.value?(i(),n("div",Qe,V(T.value),1)):r("",!0)]),d("div",Ye,[s[14]||(s[14]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session type",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:D.value.map(e=>e.name),modelValue:x.value,"onUpdate:modelValue":s[5]||(s[5]=e=>x.value=e),searchable:!1,"show-labels":!1,placeholder:"Select session type"},null,8,["options","modelValue"]),K.value?(i(),n("div",Ze,V(K.value),1)):r("",!0)]),d("div",ea,[s[15]||(s[15]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Assignees",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:A.value.map(e=>e.username),modelValue:z.value,"onUpdate:modelValue":s[6]||(s[6]=e=>z.value=e),searchable:!1,"show-labels":!1,placeholder:"Select assignees"},null,8,["options","modelValue"]),Q.value?(i(),n("div",aa,V(Q.value),1)):r("",!0)])]),_:1}),o(u(J),{collapse:"fade"},{default:v(()=>[o(j,null,{default:v(()=>[o($,null,{default:v(()=>[o(u(h),{id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"},onClick:s[7]||(s[7]=e=>ne())},{default:v(()=>s[16]||(s[16]=[y(" Cancel ",-1)])),_:1,__:[16]})]),_:1}),o($,null,{default:v(()=>[o(we,{onClick:s[8]||(s[8]=e=>(async()=>{const e=Re(N.value,t.value||String,M.value,k.value,x.value,z.value);if(e.isValid){l.value=!0;const e=A.value.filter(e=>z.value.includes(e.username)).map(e=>e.id),t={session_name:N.value,start_date:P(new Date(ee.value),"yyyy-MM-dd"),end_date:P(new Date(ae.value),"yyyy-MM-dd"),session_type:x.value,repeat:M.value,assignees:e,frequency:k.value},s=new ke;await s.create(t),t?fe("Immunization session schedule created successfully"):he("Immunization session schedule creation failed"),l.value=!1,a.resetFieldValues(),H.dismiss("dismiss")}else se(e.errors),he("Please make sure to fill all required fields"),l.value=!1})()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}}}),[["__scopeId","data-v-097a281e"]]),ta={class:"ion-padding"},sa={key:0,class:"alerts_error"},na={style:{"margin-top":"20px"}},ia={key:0,class:"alerts_error"},ra={key:0,style:{"margin-top":"20px"}},oa={style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},da={key:0,class:"alerts_error"},ua={style:{"margin-top":"20px"}},ca={key:0,class:"alerts_error"},va={style:{"margin-top":"20px"}},ma={key:0,class:"alerts_error"},pa={style:{"margin-top":"20px"}},ya={key:0,class:"alerts_error"},fa=t({__name:"EditImmunizationSessionModal",props:{data:{required:!0,type:Object}},setup(e){const a=e,l=s(!1),t=s(),c=s([{id:"1",name:"Never"},{id:"2",name:"Daily"},{id:"3",name:"Weekly"},{id:"4",name:"Monthly"}]),f=s(""),M=s([{id:"1",name:"Static"},{id:"2",name:"Outreach"}]),D=s(""),x=s(!1),S=s(1),k=s([]),A=s(""),N=s([]),z=s(""),E=s(""),C=s(""),T=s(""),q=s(""),Q=s(""),Y=e=>P(new Date(e),"MM/dd/yyyy"),Z=I(()=>null===f.value||"daily"!==f.value.toLowerCase()),ee=I(()=>{if(!t.value)return"";if(Array.isArray(t.value)){const[e,a]=t.value;return e||a?e&&a?`${Y(e)} - ${Y(a)}`:Y(e||a):""}return Y(t.value)}),ae=I(()=>Array.isArray(t.value)?Y(t.value[0]):Array.isArray(t.value)?"":void 0!==t.value?Y(String(t.value)):""),le=I(()=>Array.isArray(t.value)?Y(t.value[1]):Array.isArray(t.value)?"":void 0!==t.value?Y(String(t.value)):""),te=I(()=>({Never:"Never",Daily:"days",Weekly:"weeks",Monthly:"months"}[f.value]||"")),se=e=>{const a={sessionName:z,dateRange:E,repeatType:C,numberOfDays:T,sessionType:q,assignees:Q};Object.keys(a).forEach(e=>{a[e].value=""}),e.forEach(e=>{a[e.field]&&(a[e.field].value=e.message)})},ne=()=>{H.dismiss({update:!1})};$(f,(e,a)=>{if(e===a)return;const l={null:()=>{x.value=!1},Never:()=>{x.value=!1},Daily:()=>{x.value=!0,S.value=1,t.value=""},Weekly:()=>{x.value=!0,"string"==typeof t.value&&(t.value=[])},Monthly:()=>{x.value=!0,"string"==typeof t.value&&(t.value=[])},default:()=>{x.value=!0}};(l[e]||l.default)()}),$([A,t,f,S,D,N],()=>{const e=Re(A.value,t.value,f.value,S.value,D.value,N.value);se(e.errors)});return $(t,e=>{if(!Array.isArray(e)||2!==e.length)return;const[a,l]=e,s=X(l,a);"Weekly"===f.value&&s>7&&(he("Weekly repeat type is not available for more than 7 days"),t.value=void 0)}),j(()=>{(async()=>{const e=(await be.getUsersByRole({role:"Health Surveillance"})).map(e=>({...e,name:e.username,id:e.user_id}));k.value=e})(),A.value=a.data.session_name,t.value="daily"==a.data.repeat_type.toLowerCase()?a.data.start_date:[new Date(a.data.start_date),new Date(a.data.end_date)],f.value=a.data.repeat_type,D.value=a.data.session_type,S.value=a.data.frequency,N.value=a.data.assignees.map(e=>e.username)}),(e,s)=>{const I=U("VueDatePicker");return i(),n(b,null,[o(u(w),null,{default:v(()=>[o(u(m),null,{default:v(()=>[o(u(p),{class:"modalTitle"},{default:v(()=>s[9]||(s[9]=[y("Edit Immunization Session Schedule",-1)])),_:1,__:[9]}),o(u(h),{fill:"clear",slot:"end",onClick:s[0]||(s[0]=e=>ne())},{default:v(()=>[o(u(g),{icon:u(_),color:"white"},null,8,["icon"])]),_:1})]),_:1})]),_:1}),O(o(u(B),{trigger:"open-loading",message:"Saving, please wait..."},null,512),[[R,l.value]]),d("div",ta,[d("div",null,[s[10]||(s[10]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session name",-1)),o(u(W),{clear:"",fill:"outline",placeholder:"Enter the session name",modelValue:A.value,"onUpdate:modelValue":s[1]||(s[1]=e=>A.value=e)},null,8,["modelValue"]),z.value?(i(),n("div",sa,V(z.value),1)):r("",!0)]),d("div",na,[s[11]||(s[11]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Repeat type",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:c.value.map(e=>e.name),modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=e=>f.value=e),searchable:!1,"show-labels":!1,placeholder:"Select repeat type"},null,8,["options","modelValue"]),C.value?(i(),n("div",ia,V(C.value),1)):r("",!0)]),x.value?(i(),n("div",ra,[d("label",oa,"Number of "+V(te.value),1),o(u(W),{modelValue:S.value,"onUpdate:modelValue":s[3]||(s[3]=e=>S.value=e),clear:"",fill:"outline",placeholder:"Enter the number of days"},null,8,["modelValue"]),T.value?(i(),n("div",da,V(T.value),1)):r("",!0)])):r("",!0),d("div",ua,[s[12]||(s[12]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Start & End Date",-1)),o(I,{required:"",position:"left",placeholder:"select start & end date",range:Z.value,ui:{input:"datepicker"},format:"dd/MM/yyyy",modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=e=>t.value=e),"min-date":new Date},{trigger:v(()=>[o(u(W),{clear:"",fill:"outline",placeholder:"select start & end date",value:`${ee.value}`},{default:v(()=>[o(u(g),{slot:"start",icon:u(L)},null,8,["icon"])]),_:1},8,["value"])]),_:1},8,["range","modelValue","min-date"]),E.value?(i(),n("div",ca,V(E.value),1)):r("",!0)]),d("div",va,[s[13]||(s[13]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Session type",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:M.value.map(e=>e.name),modelValue:D.value,"onUpdate:modelValue":s[5]||(s[5]=e=>D.value=e),searchable:!1,"show-labels":!1,placeholder:"Select session type"},null,8,["options","modelValue"]),q.value?(i(),n("div",ma,V(q.value),1)):r("",!0)]),d("div",pa,[s[14]||(s[14]=d("label",{style:{"font-size":"18px","font-weight":"500","margin-bottom":"10px"}},"Assignees",-1)),o(u(F),{"hide-selected":!1,"close-on-select":!0,openDirection:"bottom","prevent-autofocus":!0,options:k.value.map(e=>e.username),modelValue:N.value,"onUpdate:modelValue":s[6]||(s[6]=e=>N.value=e),searchable:!1,"show-labels":!1,placeholder:"Select assignees"},null,8,["options","modelValue"]),Q.value?(i(),n("div",ya,V(Q.value),1)):r("",!0)])]),o(u(J),{collapse:"fade"},{default:v(()=>[o(u(G),null,{default:v(()=>[o(u(K),null,{default:v(()=>[o(u(h),{onClick:s[7]||(s[7]=e=>ne()),id:"cbtn",class:"btnText cbtn",fill:"solid",style:{width:"130px"}},{default:v(()=>s[15]||(s[15]=[y(" Cancel ",-1)])),_:1,__:[15]})]),_:1}),o(u(K),null,{default:v(()=>[o(we,{onClick:s[8]||(s[8]=e=>(async()=>{const e=Re(A.value,t.value,f.value,S.value,D.value,N.value);if(e.isValid){l.value=!0;const e=k.value.filter(e=>N.value.includes(e.username)).map(e=>e.id),t={session_name:A.value,start_date:P(new Date(ae.value),"yyyy-MM-dd"),end_date:P(new Date(le.value),"yyyy-MM-dd"),session_type:D.value,repeat:f.value,assignees:e,frequency:S.value},s=new ke;console.log(a.data),await s.update(t,a.data.session_schedule_id),t?fe("Immunization session schedule updated successfully!"):he("An error occurred, please try again later"),l.value=!1,H.dismiss("dismiss")}else se(e.errors),he("Please make sure to fill all required fields"),l.value=!1})()),name:"Save changes",fill:"solid",style:{float:"right",margin:"2%",width:"130px"}})]),_:1})]),_:1})]),_:1})],64)}}}),ha={key:0,class:"spinner-overlay"},ga={class:"container"},_a={style:{"margin-top":"15px"}};a("default",ge(t({__name:"ScheduleImmunizationSessions",setup(e){const a=s([]),l=s(!1),t=Q(),m=Y({selectedDate:P(new Date,"yyyy-MM-dd"),defaultView:t.name,isDark:!1,isResponsive:!0,views:[Q(),Z(),ee(),ae()],events:[],callbacks:{onEventClick(e){!async function(e){if(e.length>0){const a=await H.create({component:je,componentProps:{data:e},cssClass:"otherVitalsModal largeModal mobileView"});await a.present();const{data:l}=await a.onDidDismiss();l&&(l.update&&p(),l.edit&&_(l,"modal"))}}(a.value.filter(a=>a.session_schedule_id===e.id))}}});async function p(){l.value=!0;try{const e=new ke,l=await e.getSessions();m.events.getAll().forEach(e=>{m.events.remove(e.id)}),l.forEach(e=>{var a;({Weekly:y(P(new Date(e.start_date),"yyyy-MM-dd '08:00'"),P(new Date(e.end_date),"yyyy-MM-dd '16:00'"),e.frequency||1),Never:[{start_date:new Date(e.start_date),end_date:new Date(e.end_date)}],Daily:f(P(new Date(e.start_date),"yyyy-MM-dd '08:00'"),e.frequency||1),Monthly:h(P(new Date(e.start_date),"yyyy-MM-dd '08:00'"),P(new Date(e.end_date),"yyyy-MM-dd '16:00'"),e.frequency||1)})[(null===(a=e.repeat_type)||void 0===a?void 0:a.toString())||"Never"].forEach(a=>{var l;m.events.add({id:Number(e.session_schedule_id),title:e.session_name,start:P(new Date(a.start_date),"yyyy-MM-dd HH:mm"),end:P(new Date(a.end_date),"yyyy-MM-dd HH:mm"),people:null===(l=e.assignees)||void 0===l?void 0:l.map(e=>e.username),location:e.target})})}),a.value=l}catch(e){console.error(e)}finally{l.value=!1}}const y=(e,a,l)=>{const t=oe(e,"yyyy-MM-dd HH:mm",new Date),s=oe(a,"yyyy-MM-dd HH:mm",new Date);if(isNaN(t.getTime())||isNaN(s.getTime()))throw new Error("Invalid date format");const n=X(s,t),i=[];let r=de(t),o=0;for(;o<l;){const e=ue(r,n);ce(r)||(i.push({start_date:r,end_date:e}),o++),r=ve(r,1)}return i},f=(e,a)=>{const l=oe(e,"yyyy-MM-dd HH:mm",new Date);if(isNaN(l.getTime()))throw new Error("Invalid start date format");const t=[];let s=l,n=0;for(;n<a;)ce(s)||(t.push({start_date:new Date(s.setHours(0,0,0,0)),end_date:new Date(s.setHours(23,59,59,999))}),n++),s=ue(s,1);return t},h=(e,a,l)=>{const t=oe(e,"yyyy-MM-dd HH:mm",new Date),s=oe(a,"yyyy-MM-dd HH:mm",new Date);if(isNaN(t.getTime())||isNaN(s.getTime()))throw new Error("Invalid date format");const n=X(s,t),i=[];let r=me(t),o=0;for(;o<l;){const e=ue(r,n);ce(r)||(i.push({start_date:r,end_date:e}),o++),r=pe(r,1)}return i};const _=async(e,a="view")=>{const l=await H.create({component:fa,cssClass:"otherVitalsModal",componentProps:{data:e.edit,showName:""}});await l.present();const{data:t}=await l.onDidDismiss();"dismiss"===t&&p()};return j(async()=>{await p()}),(e,a)=>(i(),D(u(re),{class:ie({loading:l.value})},{default:v(()=>[l.value?(i(),n("div",ha,[o(u(c),{name:"bubbles"}),a[1]||(a[1]=d("div",{class:"loading-text"},"Please wait...",-1))])):r("",!0),o(Me),o(u(E),null,{default:v(()=>[d("div",ga,[a[2]||(a[2]=d("h1",{class:"heading"},"Schedule Immunization Sessions",-1)),d("div",_a,[o(u(le),{"calendar-app":u(m)},null,8,["calendar-app"])])]),o(u(te),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:v(()=>[o(u(se),{onClick:a[0]||(a[0]=e=>{De(la,{class:"otherVitalsModal largeModal"}).then(e=>{e&&p()})})},{default:v(()=>[o(u(g),{icon:u(ne)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]))}}),[["__scopeId","data-v-e2bb2908"]]))}}})}();
