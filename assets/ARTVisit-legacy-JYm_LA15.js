System.register(["./vendor-legacy-phTeNEOA.js","./index-legacy-41CLX9DW.js","./tasks-legacy-CvI5Vz_x.js","./lodash-legacy-C-x9g9Na.js","./apexcharts-legacy-Daa5aA7l.js"],(function(e,t){"use strict";var a,n,l,i,o,u,r,s,d,c,v,p,f,m,y,g,h,x,k,_,w,b,I,D,P,C,N,S,T,$,E,R,j,B,M,A,L,z,F,J,K,U,G,Q,W,Y,O,V,Z,q,H,X,ee,te,ae,ne,le,ie;return{setters:[e=>{a=e.d,n=e.ct,l=e.aS,i=e.aI,o=e.r,u=e.w,r=e.O,s=e.f,d=e.J,c=e.l,v=e.u,p=e.eQ,f=e.k,m=e.ac,y=e.a7,g=e.e,h=e.F,x=e.P,k=e.dA,_=e.ad,w=e.a2,b=e.L,I=e.eR,D=e.d$,P=e.eM,C=e.K,N=e.bU,S=e.M,T=e.G,$=e.N,E=e.Q,R=e.e9,j=e.aP,B=e.aM,M=e.m,A=e.ew,L=e.bN,z=e.bP,F=e.cK,J=e.eS,K=e.aa,U=e.R},e=>{G=e.S,Q=e.u,W=e.P,Y=e.T,O=e.bJ,V=e.s,Z=e.bi,q=e.ai,H=e.Z,X=e.bK,ee=e.l,te=e.bL,ae=e.a8,ne=e._},e=>{le=e.i,ie=e.a},null,null],execute:function(){var t=document.createElement("style");t.textContent="#main[data-v-9a619323]{height:calc(100vh - 69px);overflow-y:auto}.placeholder-content[data-v-9a619323]{padding:20px}\n/*$vite$:1*/",document.head.appendChild(t);class oe extends G{constructor(){super()}static nextTask(e){return super.getJson(`/workflows/${super.getProgramID()}/${e}`,{date:super.getSessionDate()})}static async getNextTaskParams(e,t=""){let a=t;try{if(!a){const{name:t}=await oe.nextTask(e);a=t}}catch(n){a=""}return{name:a.toLowerCase(),params:{patient_id:e}}}}const ue={key:0,class:"ion-padding"},re={key:2,style:{"margin-top":"10%"},class:"ion-padding ion-text-center"},se={class:"ion-page",id:"main"},de={key:0,class:"ion-padding"},ce={key:1},ve={key:2,class:"ion-padding ion-text-center",style:{"margin-top":"15%"}},pe={style:{color:"black"}};e("default",ne(a({__name:"ARTVisit",setup(e){const t=n(),a=Q(),{patient:ne}=l(a),fe=new W,me=i(),ye=o(-1),ge=o(null),he=o([]),xe=o([]),ke=o(!1),_e=o(!1),we=o(-1),be=o(""),Ie=o(""),De=o(""),Pe=o(!1),Ce=o(null);function Ne(e){var t;return!!e&&(!_e.value&&we.value===(null==e?void 0:e.encounterTypeID)||(null!==(t=null==e?void 0:e.otherWorkflowNames)&&void 0!==t?t:[]).includes(be.value))}async function Se(){var e;Pe.value=null!==(e=G.isBDE())&&void 0!==e&&e,De.value="",_e.value=!0,Ie.value="",be.value="";try{var t;const e=await oe.nextTask(ne.value.patientID);if(!e)return Ie.value="No workflows found. You may exit this page or refresh",_e.value=!1,void(ye.value=-1);be.value=e.name,we.value=null!==(t=null==e?void 0:e.encounter_type_id)&&void 0!==t?t:-1;const a=he.value.findIndex((e=>{var t;return(null==e?void 0:e.encounterTypeID)===we.value||(null!==(t=e.otherWorkflowNames)&&void 0!==t?t:[]).includes(be.value)}));-1!==a||(Ie.value=be.value?`"${be.value}" is not available in the current workflow. Contact your administrator or update ART activity selection`:"No next task found"),ye.value=a}catch(a){Ie.value="An error has occured while loading next task: "+a,console.error(a)}finally{await async function(){const e=await Z.getEncounters(ne.value.patientID,{date:oe.getSessionDate()});xe.value=e.map((e=>e.encounter_type))}(),_e.value=!1}}async function Te(){ye.value=-1,he.value=[],ke.value=!0;try{const e=q.map((async e=>{if(("function"!=typeof e.disabled||!e.disabled(q))&&e.workflowID&&e.component&&await le(e.workflowID)&&await ie(e.workflowID))return e}));he.value=(await Promise.all(e)).filter((e=>void 0!==e)),async function(){if(await H.isProp(`${X.FILING_NUMBERS}=true`)){if(fe.patient=await W.findByID(ne.value.patientID),!/n\/a/i.test(fe.getFilingNumber()))return;ee(ae,{},!1,{title:"New filing number assignment",useComponent:te,onClose:()=>{U.dismiss()}})}}()}catch(e){V("Unable to load activities"),console.error(e)}finally{ke.value=!1}}function $e(){(function(){if(Pe.value){if(!Ce.value)return void V("BDE Provider component is not available");if(!Ce.value.isProviderSelected())return V("Please select a provider"),void Ce.value.openModal()}return ge.value&&"function"==typeof ge.value.onSubmit?ge.value.onSubmit():Promise.resolve(!0)})().then((e=>e&&Se()))}return u((()=>t.fullPath),(()=>{Te().then(Se)}),{immediate:!0,deep:!0}),(e,t)=>(s(),r(v(K),null,{default:d((()=>[c(Y),c(v(p),{style:{"margin-top":"70px"},when:"xs",contentId:"main"},{default:d((()=>{var e;return[c(v(m),{contentId:"main"},{default:d((()=>[c(v(y),null,{default:d((()=>[ke.value?(s(),g("div",ue,[(s(),g(h,null,x(5,(e=>c(v(k),{key:e,animated:"",style:{height:"60px","margin-bottom":"10px","border-radius":"8px"}}))),64))])):he.value.length>0?(s(),r(v(_),{key:1},{default:d((()=>[(s(!0),g(h,null,x(he.value,((e,t)=>(s(),r(v(w),{onClick:e=>function(e){if(e<0||e>=he.value.length)return;const t=he.value[e];t&&Ne(t)&&(ye.value=e)}(t),lines:"none",key:t,disabled:!Ne(e),button:""},{default:d((()=>{var t,a,n;return[(a=e,xe.value.includes(null!==(n=null==a?void 0:a.encounterTypeID)&&void 0!==n?n:0)?(s(),r(v(b),{key:0,icon:v(I),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):Ne(e)?(s(),r(v(b),{key:2,icon:v(P),style:{padding:"10px",color:"green"},slot:"start"},null,8,["icon"])):(s(),r(v(b),{key:1,icon:v(D),style:{padding:"10px"},slot:"start"},null,8,["icon"]))),f("b",null,C(null!==(t=e.displayName)&&void 0!==t?t:e.name),1)]})),_:2},1032,["onClick","disabled"])))),128))])),_:1})):(s(),g("div",re,[c(v(b),{style:{"font-size":"2rem"},icon:v(N)},null,8,["icon"]),t[2]||(t[2]=f("h4",null,"You are not assigned to any activities",-1))]))])),_:1}),c(v(S),null,{default:d((()=>[c(v(T),{color:"light"},{default:d((()=>[c(v($),{onClick:t[0]||(t[0]=e=>v(me).back())},{default:d((()=>[c(v(b),{icon:v(R),slot:"start"},null,8,["icon"]),t[3]||(t[3]=E(" Back to dashboard "))])),_:1,__:[3]})])),_:1})])),_:1})])),_:1}),f("div",se,[_e.value||ke.value?(s(),g("div",de,[c(v(j),null,{default:d((()=>[c(v(B),null,{default:d((()=>[c(v(k),{animated:"",style:{height:"40px","margin-bottom":"20px"}}),c(v(k),{animated:"",style:{height:"20px",width:"80%","margin-bottom":"15px"}}),c(v(k),{animated:"",style:{height:"20px",width:"60%","margin-bottom":"15px"}}),c(v(k),{animated:"",style:{height:"60px","margin-bottom":"20px"}}),c(v(k),{animated:"",style:{height:"20px",width:"70%","margin-bottom":"15px"}}),c(v(k),{animated:"",style:{height:"20px",width:"50%","margin-bottom":"15px"}})])),_:1})])),_:1})])):null!==(e=he.value[ye.value])&&void 0!==e&&e.component?(s(),g("div",ce,[c(v(j),null,{default:d((()=>[c(v(B),null,{default:d((()=>{var e;return[Pe.value?(s(),r(O,{key:0,ref_key:"bdeProviderComponent",ref:Ce},null,512)):M("",!0),(s(),r(A,null,[(s(),r(L(null===(e=he.value[ye.value])||void 0===e?void 0:e.component),{ref_key:"formRef",ref:ge},null,512))],1024))]})),_:1})])),_:1})])):(s(),g("div",ve,[c(v(b),{style:{color:"green","font-size":"80px"},icon:v(z)},null,8,["icon"]),f("h2",pe,C(Ie.value),1),c(v($),{size:"large",fill:"clear",onClick:t[1]||(t[1]=e=>v(me).back())},{default:d((()=>[c(v(b),{slot:"start",icon:v(F)},null,8,["icon"]),t[4]||(t[4]=E(" Exit page "))])),_:1,__:[4]})])),c(v(S),null,{default:d((()=>[c(v(T),{color:"light"},{default:d((()=>[ye.value>=0?(s(),r(v($),{key:0,onClick:$e,color:"primary",style:{padding:"4px"},slot:"end"},{default:d((()=>[t[5]||(t[5]=E(" Save and continue ")),c(v(b),{style:{padding:"4px"},icon:v(J),slot:"end"},null,8,["icon"])])),_:1,__:[5]})):M("",!0)])),_:1})])),_:1})])]})),_:1})])),_:1}))}}),[["__scopeId","data-v-9a619323"]]))}}}));
