import{d as W,af as E,b4 as P,Z as $,a2 as V,G as F,E as R,ag as N,ab as J,a1 as G,I as K,a8 as Z,cG as j,_ as q,$ as z,H as Q,e as g,f,l as U,J as X,k as x,F as Y,O as tt,K as et}from"./vendor-f_p5GZUu.js";import{J as at,bd as st,B as it,bl as nt,ae as u,H as d,bi as L,aI as ot,bn as rt,P as k,V as ct,u as lt,aC as pt,l as ut,_ as dt}from"./index-CNte205p.js";import{D as mt}from"./DashBox-blLbnHwk.js";import{B as ht}from"./BasicForm-TMB5fcwf.js";import{p as gt}from"./previousDiagnosis-Di2K1_Oc.js";import"./lodash-NJiRuGo9.js";import"./apexcharts-Db13O_GS.js";import"./DateInputField-BQ6fXNn6.js";const ft=W({name:"Menu",components:{IonContent:Z,IonHeader:K,IonItem:G,IonList:J,IonMenu:N,IonTitle:R,IonToolbar:F,IonInput:V,IonPopover:$,DashBox:mt,SelectionPopover:nt,BasicInputField:it,List:st,BasicForm:ht,DynamicButton:at,previousDiagnosis:gt,DataTable:P},data(){return{iconsContent:ut,no_item:!1,search_item:!1,display_item:!1,addItemButton:!0,selectedText:"",conditionStatus:"",data:[],diagnosisData:[],popoverOpen:!1,event:"",selectedCondition:"",tableData:[],options:{responsive:!0,select:!1,layout:{topStart:"",topEnd:"search",bottomStart:"info",bottomEnd:"paging"},ordering:!1},header:["Date","Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic","BMI"],visits:[],BMI:"",nextAppointMent:"",drugs:"",visitDate:[],primaryDiagnosis:[],presentingComplaint:[],secondaryDiagnosis:[],labOrders:[],vitals:{},vitalsWeightHeight:{},savedEncounters:[],pregnancy:{}}},setup(){return{checkmark:z,pulseOutline:q}},computed:{...E(pt,["diagnosis"]),...E(lt,["patient"])},watch:{$route:{async handler(){await this.setListData()},deep:!0}},async mounted(){await this.updateData(),await this.setListData(),this.$nextTick(()=>{const t=this.$refs.dataTable.dt;t.columns.adjust().draw(),t.on("click",".delete-btn",a=>{const e=a.target.getAttribute("data-id");this.voidDiagnosis(JSON.parse(e),a)})})},methods:{async voidDiagnosis(t,a){await ct("Do you want to delete ".concat(t.name," ?"),a)&&(await u.voidObs(t.id),await this.setListData())},async openEnterResultModal(){await this.setListData()},async updateData(){const t=new k;this.visits=await k.getPatientVisits(t.getID(),!1),this.tableData=[],Promise.all(this.visits.map(async a=>{await this.loadSavedEncounters(a)}))},covertDate(t){return d.toStandardHisDisplayFormat(t)},async loadSavedEncounters(t){this.visitDate=t;const a=await rt.getEncounters(this.patient.patientID,{date:t});await this.setVitalsEncounters(a,t)},findEncounter(t,a){return t.find(e=>e.type&&e.type.name===a)},async getConceptValues(t,a){if(t)return await Promise.all(t==null?void 0:t.map(async e=>await ot.getConceptName(e.value_coded)))},filterObs(t,a){return t==null?void 0:t.filter(e=>e.concept.concept_names.some(s=>s.name===a))},async setVitalsEncounters(t,a){var n,l,p,I,v,D,y,b,_,S,w,B,M,C,T,H,O;const e=(n=this.findEncounter(t,"VITALS"))==null?void 0:n.observations;let s="";if(!e)return;const c=["Weight","Height (cm)","Temperature","Pulse","SAO2","Systolic","Respiration rate","Diastolic"].map(i=>this.filterObs(e,i).length||0),r=Math.max(...c);for(let i=0;i<r;i++){const m=(p=(l=this.filterObs(e,"Weight")[i])==null?void 0:l.value_numeric)!=null?p:"",h=(v=(I=this.filterObs(e,"Height (cm)")[i])==null?void 0:I.value_numeric)!=null?v:"";m&&h&&(s=await this.setBMI(m,h));const A=[a,m,h,(y=(D=this.filterObs(e,"Temperature")[i])==null?void 0:D.value_numeric)!=null?y:"",(_=(b=this.filterObs(e,"Pulse")[i])==null?void 0:b.value_numeric)!=null?_:"",(w=(S=this.filterObs(e,"SAO2")[i])==null?void 0:S.value_numeric)!=null?w:"",(M=(B=this.filterObs(e,"Systolic")[i])==null?void 0:B.value_numeric)!=null?M:"",(T=(C=this.filterObs(e,"Respiration rate")[i])==null?void 0:C.value_numeric)!=null?T:"",(O=(H=this.filterObs(e,"Diastolic")[i])==null?void 0:H.value_numeric)!=null?O:"",s||""];this.tableData.push(A)}},async setBMI(t,a){var e,s,o,c,r,n,l,p;return(s=(e=this.patient)==null?void 0:e.personInformation)!=null&&s.gender&&((c=(o=this.patient)==null?void 0:o.personInformation)!=null&&c.birthdate)&&(this.BMI=await L.getBMI(parseInt(t),parseInt(a),(n=(r=this.patient)==null?void 0:r.personInformation)==null?void 0:n.gender,d.calculateAge((p=(l=this.patient)==null?void 0:l.personInformation)==null?void 0:p.birthdate,d.sessionDate()))),this.updateBMI()},async updateBMI(){var a,e,s,o,c,r,n;const t=(e=(a=this.BMI)==null?void 0:a.color)!=null?e:[];return this.vitalsWeightHeight.icon=L.iconBMI(t),this.vitalsWeightHeight.backgroundColor=t[0],this.vitalsWeightHeight.textColor=t[1],this.vitalsWeightHeight.index="BMI "+((o=(s=this.BMI)==null?void 0:s.index)!=null?o:""),this.vitalsWeightHeight.value=(r=(c=this.BMI)==null?void 0:c.result)!=null?r:"",(n=this.BMI)==null?void 0:n.index},async setListData(){const t=await u.getAll(this.patient.patientID,"Primary diagnosis"),a=await u.getAll(this.patient.patientID,"Secondary diagnosis");[...t||[],...a||[]],P.use(j)},async generateListItems(t){return t.length>0?await Promise.all(t.map(async e=>{const s=await u.getConceptName(e.value_coded),o=e.obs_datetime;return[s,d.toStandardHisFormat(o)]})):[]}}}),It={class:"table-responsive"};function vt(t,a,e,s,o,c){const r=Q("DataTable");return f(),g("div",It,[U(r,{ref:"dataTable",options:t.options,data:t.tableData,class:"display nowrap",width:"100%"},{default:X(()=>[x("thead",null,[x("tr",null,[(f(!0),g(Y,null,tt(t.header,n=>(f(),g("th",{key:n},et(n),1))),128))])])]),_:1},8,["options","data"])])}const Ct=dt(ft,[["render",vt],["__scopeId","data-v-cf07efa2"]]);export{Ct as default};
