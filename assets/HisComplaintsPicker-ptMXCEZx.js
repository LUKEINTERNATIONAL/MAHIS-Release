import{d as T,bs as B,a1 as x,bp as F,H as l,e as d,f as p,l as n,J as i,F as k,P as y,Q as b,K as L,O as C,m as N,i as D,v as I,k as H}from"./vendor-C2-6JN9w.js";import E from"./SelectMixin-DzJjPVaF.js";import{P as K}from"./patient_complaints_service-BVoT5pBM.js";import{l as U}from"./lodash-NJiRuGo9.js";import{H as z}from"./KbHandler-D3fvi-j_.js";import{_ as Y}from"./index-cswYPnpf.js";import"./BaseTextInput-B3sTvb2_.js";import"./Export-DiQbezkb.js";import"./apexcharts-k3hWD3Dm.js";import"./ReportMixin.vue_vue_type_script_lang-Ck_0Epqb.js";import"./FieldMixin.vue_vue_type_script_lang-8OrIu1g0.js";const J=T({components:{IonCheckbox:F,IonText:x,IonChip:B,HisKeyboard:z},name:"HisComplaintsPicker",mixins:[E],data:()=>({complaintsList:{},ActiveCategory:"",allComplainList:{},displayComplainList:{},groupNames:[],showKeyboard:!1,groupData:[]}),methods:{async init(){this.$emit("onFieldActivated",this);const t=await K.getComplaintsList("Presenting complaint group");this.listData=this.mapListToOptions(t),this.groupData=t,this.groupNames=this.listData;for(const e in this.listData){const s=this.listData[e].label,o=await K.getComplaintsList(s);this.allComplainList[s]=this.mapListToOptions(o,s)}this.$emit("onValue",this.getChecked(this.complaintsList))},async onselect(t,e){this.$nextTick(async()=>{const s={...t};if(s.isChecked=e.target.checked,this.onValue&&s.isChecked&&!await this.onValue(s))return e.target.checked=!1;this.onValueUpdate&&(this.complaintsList=await this.onValueUpdate({...this.complaintsList},s)),this.$emit("onValue",this.getChecked(this.complaintsList))})},async onKBValue(t){if(t!=""){for(const e in this.groupNames)this.groupNames[e].other.display=!1;for(const e in this.listData){let s="";const o=this.listData[e].label,c=[],r=this.allComplainList[o];for(const h in r)r[h].label.toLowerCase().match(t.toLowerCase())&&o?(r[h].other.display=!0,c.push(r[h]),s=o,this.ActiveCategory=o):(r[h].other.display=!1,c.push(r[h]));if(s!="")for(const h in this.groupNames)this.groupNames[h].label==o&&(this.groupNames[h].other.display=!0);this.allComplainList[o]=c}this.complaintsList[this.ActiveCategory]=this.allComplainList[this.ActiveCategory]}else{for(const e in this.listData){const s=this.listData[e].label,o=[],c=this.allComplainList[s];for(const r in c)c[r].other.display=!0,o.push(c[r]);this.allComplainList[s]=o}this.groupNames=this.mapListToOptions(this.groupData),console.log(this.groupNames),this.ActiveCategory=""}},keyboardStatus(){this.showKeyboard=!this.showKeyboard},async getSpecificComplaints(t){t in this.complaintsList||(this.complaintsList[t]=this.allComplainList[t]),this.ActiveCategory=t},mapListToOptions(t,e=""){if(U.isEmpty(t))return[];const s={display:!0};return t.map(o=>{const c={label:o.name,value:o.name,isChecked:!1,other:{...o,...s}};return e&&(c.other.parent=e),c})},uncheck(t){this.complaintsList[t.other.parent].forEach(e=>{e.label===t.label&&(e.isChecked=!1)})},getChecked(t){const e=[];for(const s in t)e.push(...t[s].filter(o=>o.isChecked));return e}},computed:{checkedItems(){return this.getChecked(this.complaintsList)},activeCategoryItems(){return this.complaintsList[this.ActiveCategory]}},watch:{clear(){for(const t in this.complaintsList)this.complaintsList[t]=this.complaintsList[t].map(e=>(e.isChecked=!1,e))}},mounted(){this.init()},activated(){this.init()}}),M={style:{}};function Q(t,e,s,o,c,r){const h=l("his-text-input"),f=l("ion-text"),g=l("ion-label"),A=l("ion-chip"),_=l("ion-col"),v=l("ion-row"),w=l("ion-item"),V=l("ion-list"),$=l("ion-checkbox"),S=l("his-keyboard"),P=l("ion-grid"),O=l("view-port");return p(),d("div",null,[n(O,{showFull:!t.showKeyboard,style:{padding:"0",height:"82vh"}},{default:i(()=>[n(h,{value:t.selected,placeholder:"Search",onOnValue:t.onKBValue,onClick:t.keyboardStatus},null,8,["value","onOnValue","onClick"]),n(P,null,{default:i(()=>[n(v,null,{default:i(()=>[n(_,{size:"12"},{default:i(()=>[(p(!0),d(k,null,y(t.checkedItems,(a,m)=>(p(),d("span",{key:m},[n(A,{color:"danger",onClick:u=>t.uncheck(a)},{default:i(()=>[n(g,null,{default:i(()=>[n(f,{class:"his-md-text"},{default:i(()=>[b(L(a.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]),_:1})]),_:1}),n(v,null,{default:i(()=>[n(_,{size:"4"},{default:i(()=>[n(V,{style:{overflowY:"auto",height:"80vh",margin:0}},{default:i(()=>[(p(!0),d(k,null,y(t.groupNames,(a,m)=>D((p(),C(w,{key:m,onClick:u=>t.getSpecificComplaints(a.value),detail:!0,color:t.ActiveCategory===a.label?"light":""},{default:i(()=>[n(g,null,{default:i(()=>[n(f,{class:"his-md-text"},{default:i(()=>[b(L(a.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","color"])),[[I,a.other.display]])),128))]),_:1})]),_:1}),t.ActiveCategory?(p(),C(_,{key:0,style:{overflowY:"auto",height:"75vh"}},{default:i(()=>[H("div",M,[n(V,{class:"view-port-content"},{default:i(()=>[(p(!0),d(k,null,y(t.activeCategoryItems,(a,m)=>D((p(),C(w,{key:m,color:a.isChecked?"light":""},{default:i(()=>[n(g,null,{default:i(()=>[n(f,{class:"his-md-text"},{default:i(()=>[b(L(a.label),1)]),_:2},1024)]),_:2},1024),n($,{slot:"end",modelValue:a.isChecked,"onUpdate:modelValue":u=>a.isChecked=u,onIonChange:u=>t.onselect(a,u),disabled:a==null?void 0:a.disabled},null,8,["modelValue","onUpdate:modelValue","onIonChange","disabled"])]),_:2},1032,["color"])),[[I,a.other.display]])),128))]),_:1})])]),_:1})):N("",!0),t.showKeyboard?(p(),C(S,{key:1,kbConfig:t.keyboard,onKeyPress:t.keypress},null,8,["kbConfig","onKeyPress"])):N("",!0)]),_:1})]),_:1})]),_:1},8,["showFull"])])}const it=Y(J,[["render",Q],["__scopeId","data-v-7b352988"]]);export{it as default};
