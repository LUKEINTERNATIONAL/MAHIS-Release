System.register(["./vendor-legacy-DnHM1LDc.js","./index-legacy-BydGqEaO.js","./Registration-legacy-ChklZg0w.js","./Outcome-legacy-CpDF_9Yg.js"],function(e,t){"use strict";var l,a,n,i,o,s,r,d,u,p,c,v,f,g,m,y,b,x,h,_,w,k,N,D,C,I,P,z,S,O,j,V,M,E,T,$,q,A,U,G,F,B,L,Q,R,Y,Z,H,J,K,W,X,ee,te,le;return{setters:[e=>{l=e.d,a=e.N,n=e.f,i=e.r,o=e.e,s=e.l,r=e.J,d=e.u,u=e.G,p=e.E,c=e.k,v=e.aZ,f=e.M,g=e.a0,m=e.a7,y=e.I,b=e.a9,x=e.aa,h=e.a8,_=e.L,w=e.F,k=e.Q,N=e.ak,D=e.aT,C=e.c,I=e.a,P=e.w,z=e.ck,S=e.ab,O=e.m,j=e.a1,V=e.b1,M=e.K,E=e.ar,T=e.a2,$=e.aN,q=e.aA,A=e.bi,U=e.P,G=e.O,F=e.Y,B=e.dN,L=e.aY},e=>{Q=e.u,R=e.P,Y=e.ad,Z=e.aH,H=e._,J=e.S,K=e.b1,W=e.o,X=e.ax,ee=e.b2},e=>{te=e.R},e=>{le=e.O}],execute:function(){var t=document.createElement("style");t.textContent="ion-card[data-v-56ceadb9]{margin:16px 0;border-radius:12px}.sub-menu-icon[data-v-56ceadb9]{font-size:1.2rem}ion-item[data-v-56ceadb9]{--padding-start: 8px;margin:8px 0}.current-ncd-item[data-v-56ceadb9]{--background: var(--ion-color-success-tint);border-radius:8px;margin:8px 0;border-left:4px solid var(--ion-color-primary)}.current-ncd-item ion-label h2[data-v-56ceadb9]{font-weight:600;color:var(--ion-color-primary)}.current-ncd-item ion-label p[data-v-56ceadb9]{font-size:1.1em;margin-top:4px;color:var(--ion-color-dark)}.custom-input[data-v-56ceadb9]{--padding-start: 0;font-size:1.5em}.prefix-container[data-v-56ceadb9]{display:flex;align-items:center;height:100%}.prefix-part[data-v-56ceadb9]{border:none;background:#f0f0f0;padding:0 8px;border-right:1px solid #ccc;color:var(--ion-color-dark);font-weight:600}.error-message[data-v-56ceadb9]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;margin-top:8px;background-color:rgba(255,0,0,.1);border-radius:4px}.error-content[data-v-56ceadb9]{display:flex;align-items:center;gap:8px}.close-button[data-v-56ceadb9]{margin-left:auto}#container[data-v-74669b71]{font-family:monospace;font-size:24px;overflow:hidden;padding:15px;width:594px}ul[data-v-74669b71],ol[data-v-74669b71]{list-style-type:none;padding-left:0;margin:0}\n/*$vite$:1*/",document.head.appendChild(t),e("u",function(){const e=i(L.isNativePlatform()),t=i([]),l=i(null),a=i(!1),n=i(null),o=Q().patient;return{isMobile:e,visits:t,event:l,popoverOpen:a,program:n,patient:o,openPopover:e=>{l.value=e,a.value=!0},openPIM:()=>{W(ae,{class:"fullScreenModal"})},openOutCome:()=>{W(de,{class:"large-modal-x10"})},printVisitSummary:async()=>{1==J.getProgramID()?await ee():32==J.getProgramID()?await async function(){await K(He,{copies:1})}():(new X).printData("visit")},printID:()=>{(new X).printData("barcode")},formatCurrentAddress:e=>{var t,l,a;return[null==e||null===(t=e.personInformation)||void 0===t?void 0:t.current_district,null==e||null===(l=e.personInformation)||void 0===l?void 0:l.current_traditional_authority,null==e||null===(a=e.personInformation)||void 0===a?void 0:a.current_village].filter(Boolean).join(",")},openUpdateNCDNUmbers:()=>{W(Pe,{class:"large-modal-x10"})}}});const ae=e("_",l({__name:"personalInformationModal",setup:e=>(e,t)=>(n(),a(te,{editMode:!0}))})),ne={style:{"font-weight":"400","font-size":"19px"}},ie={style:{display:"flex","align-items":"center"}},oe={class:""},se={class:"center text_12"},re=l({watch:{},name:"xxxComponent"}),de=l({...re,props:{is_open:{},user_id:{}},emits:["closePopoover","save"],setup(e,{emit:t}){i("");const l=t;return(e,t)=>(n(),o(w,null,[s(d(y),null,{default:r(()=>[s(d(u),null,{default:r(()=>[s(d(p),null,{default:r(()=>t[1]||(t[1]=[c("div",{style:{display:"flex","align-items":"center"}},[c("b",{style:{"margin-left":"6px"}},"Patient Outcome")],-1)])),_:1,__:[1]}),s(d(v),{slot:"end"},{default:r(()=>[s(d(p),null,{default:r(()=>[s(d(f),{onClick:t[0]||(t[0]=e=>(l("closePopoover",!1),void k.dismiss())),fill:"solid"},{default:r(()=>[c("span",ne,[c("div",ie,[s(d(g),{icon:d(m),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[2]||(t[2]=c("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d(h),{class:"ion-padding"},{default:r(()=>[c("div",oe,[c("div",se,[s(d(b),null,{default:r(()=>[s(d(x),null,{default:r(()=>[s(le)]),_:1})]),_:1})])])]),_:1}),s(d(_),null,{default:r(()=>[s(d(u))]),_:1})],64))}}),ue={style:{display:"flex","align-items":"center"}},pe={style:{"font-weight":"400","font-size":"19px"}},ce={style:{display:"flex","align-items":"center"}},ve={style:{"font-weight":"600","font-size":"17px"}},fe={style:{"margin-top":"15px",width:"100%"}},ge={key:0,class:"error-message"},me={key:1},ye={slot:"start",class:"prefix-container"},be=["value"],xe={key:0,class:"error-message"},he={style:{"font-size":"16px","font-weight":"600px",color:"red"}},_e={key:1},we={style:{"font-weight":"400","font-size":"19px"}},ke={style:{display:"flex","align-items":"center"}},Ne={style:{"font-weight":"400","font-size":"20px"}},De={style:{display:"flex","align-items":"center"}},Ce=l({name:"UpdateNCDNumberModal"}),Ie=l({...Ce,emits:["closePopoover","save"],setup(e,{emit:t}){const l=N(),a=Q(),{patient:b}=D(a),x=i(""),U=i(""),G=i(""),F=i(!1),B=new R;let L=null;const H=e=>{const t=e.target.value.replace(/[^0-9]/g,"");t!==e.target.value&&(F.value=!0,L&&clearTimeout(L),L=window.setTimeout(()=>{F.value=!1,L=null},3e3),x.value=t)},J=()=>{F.value=!1,L&&(clearTimeout(L),L=null)},K=C(()=>x.value&&""!==x.value.trim()),W=async()=>{try{const e=await Y.getNextSuggestedNCDNumber(),t=e.ncd_number.replace(/^\D+|\s/g,""),l=e.ncd_number.replace(/\d+/g,"")+"-NCD-";x.value=t,U.value=l}catch(e){console.error("Error fetching suggested NCD number:",e),G.value="Failed to fetch suggested NCD number (missing SITE Prefix)"}};I(()=>{W()}),P(()=>b.value.ID,()=>{W()},{deep:!0});const X=t;function ee(){X("closePopoover",!1),k.dismiss()}async function te(){try{if(G.value="",!K.value)return void(G.value="Please enter a valid NCD number");const e=`${U.value}${x.value}`,t=await R.findByID(b.value.patientID);for(const l of t.patient_identifiers)31===l.identifier_type&&(await B.updateNCDNumber(l.patient_identifier_id,e),X("save",{newNcdId:e}));await Z(b.value),ee()}catch(e){console.error(e)}}return(e,t)=>(n(),o(w,null,[s(d(y),null,{default:r(()=>[s(d(u),null,{default:r(()=>[s(d(p),null,{default:r(()=>[c("div",ue,[s(d(g),{icon:d(z),class:"sub-menu-icon",style:{"font-size":"1.6rem"}},null,8,["icon"]),t[3]||(t[3]=c("b",{style:{"margin-left":"6px"}},"Update NCD Number",-1))])]),_:1}),s(d(v),{slot:"end"},{default:r(()=>[s(d(p),null,{default:r(()=>[s(d(f),{onClick:t[0]||(t[0]=e=>ee()),fill:"solid"},{default:r(()=>[c("span",pe,[c("div",ce,[s(d(g),{icon:d(m),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[4]||(t[4]=c("span",{style:{"margin-left":"6px"}},"Close",-1))])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d(h),{class:"ion-padding"},{default:r(()=>[s(d(S),null,{default:r(()=>[s(d(j),{class:"current-ncd-item"},{default:r(()=>[s(d(V),null,{default:r(()=>[t[5]||(t[5]=c("h2",null,"Current NCD Number",-1)),c("p",ve,M(d(b).NcdID||"Not assigned"),1)]),_:1,__:[5]})]),_:1}),s(d(j),null,{default:r(()=>[c("div",fe,[F.value?(n(),o("div",ge,[s(d(g),{icon:d(E),color:"danger"},null,8,["icon"]),t[6]||(t[6]=c("span",{style:{"font-size":"16px","font-weight":"600px",color:"red"}},"Only numbers are allowed",-1)),s(d(f),{fill:"clear",size:"small",onClick:J},{default:r(()=>[s(d(g),{icon:d(m)},null,8,["icon"])]),_:1})])):O("",!0),G.value?O("",!0):(n(),o("div",me,[t[7]||(t[7]=c("span",{style:{"font-weight":"600","font-size":"17px",color:"grey"}},"New NCD Number",-1)),s(d(T),{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),placeholder:"Enter number",inputmode:"numeric",pattern:"[0-9]*",onInput:H,class:"custom-input"},{default:r(()=>[c("div",ye,[c("input",{value:U.value,readonly:"",class:"prefix-part",type:"text"},null,8,be)])]),_:1},8,["modelValue"])]))])]),_:1}),G.value?(n(),o("div",xe,[s(d($),{color:"danger"},{default:r(()=>[c("span",he,M(G.value),1)]),_:1})])):O("",!0),G.value?(n(),o("div",_e,[s(d(f),{onClick:t[2]||(t[2]=e=>function(e){try{console.log(e),l.push(e)}catch(t){console.error(t)}}("setSitePrefix")),fill:"solid",style:{margin:"14px"}},{default:r(()=>[c("span",we,[c("div",ke,[s(d(g),{icon:d(q),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[8]||(t[8]=c("span",{style:{"margin-left":"6px"}},"set Site Prefix",-1))])])]),_:1})])):O("",!0)]),_:1})]),_:1}),s(d(_),null,{default:r(()=>[s(d(u),null,{default:r(()=>[s(d(v),{slot:"end"},{default:r(()=>[s(d(p),null,{default:r(()=>[s(d(f),{onClick:te,fill:"solid",disabled:!K.value},{default:r(()=>[c("span",Ne,[c("div",De,[s(d(g),{icon:d(A),slot:"start",class:"sub-menu-icon"},null,8,["icon"]),t[9]||(t[9]=c("span",{style:{"margin-left":"6px"}},"Save",-1))])])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}}),Pe=H(Ie,[["__scopeId","data-v-56ceadb9"]]),ze={key:0,style:{display:"flex","justify-content":"space-between",width:"100%"}},Se={key:0},Oe={key:1,style:{"font-weight":"bold",padding:"1.7px"}},je={key:1,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},Ve={key:0},Me={key:1},Ee={key:2},Te={key:2},$e={style:{display:"flex","flex-wrap":"wrap",gap:"8px",width:"100%"}},qe={key:3,style:{display:"flex","flex-wrap":"wrap",gap:"20px",width:"100%"}},Ae={key:0},Ue={key:1},Ge={key:2},Fe={key:3},Be={key:4,style:{width:"100%","text-align":"center","border-collapse":"collapse",border:"1px solid black"}},Le={key:0},Qe={style:{border:"1px solid black"}},Re={style:{border:"1px solid black"}},Ye={style:{border:"1px solid black"}},Ze={style:{border:"1px solid black"}},He=H(l({__name:"NCDVisitLbl",props:{imageOut:{type:Object},patient:{type:Object}},emits:["label-out"],setup(e,{emit:t}){const l=t,a=i(null),s=i(0),r=i(""),d=i(4),u=e,p=C(()=>{var e;return null!==(e=u.patient)&&void 0!==e&&e.medications?u.patient.medications.filter(e=>e&&(e.name||e.dose||e.frequency||e.quantity)):[]}),v=C(()=>{var e,t;const l=null===(e=u.patient)||void 0===e?void 0:e.vitals;return l&&(l.height||l.weight||l.bloodPressure||(null===(t=u.patient)||void 0===t?void 0:t.bloodGlucose))}),f=C(()=>{const e=p.value;if(0===e.length)return[];if(0===s.value)return e.slice(0,2);{J.getIsIpPrintersStatus()?d.value=7:d.value=4;const t=2+(s.value-1)*d.value;return e.slice(t,t+d.value)}}),g=C(()=>{const e=p.value.length;if(e<=2)return 1;const t=e-2;return J.getIsIpPrintersStatus()?d.value=7:d.value=4,1+Math.ceil(t/d.value)});return I(async()=>{try{const e=await(async()=>{const e=[];for(let l=0;l<g.value;l++){s.value=l,await new Promise(e=>setTimeout(e,100));try{let t;J.getIsIpPrintersStatus()?(r.value="800px",t=await B.toCanvas(a.value,{height:300,width:800})):t=await B.toPng(a.value,{height:300,width:594}),e.push(t)}catch(t){console.error("Error generating image for page",l,t)}}return e})();l("label-out",e),"function"==typeof u.imageOut&&u.imageOut(e)}catch(e){console.error("Error generating patient labels:",e)}}),(t,l)=>{var i,d,u,p,g,m,y,b,x,h,_,k,N,D,C,I,P,z;return n(),o("div",{ref_key:"lblComponent",ref:a,id:"container",style:F("padding: 15px; width:"+r.value)},[0===s.value&&(null!==(i=e.patient)&&void 0!==i&&i.latestVisitDate||null!==(d=e.patient)&&void 0!==d&&d.patientID)?(n(),o("div",ze,[null!==(u=e.patient)&&void 0!==u&&u.latestVisitDate?(n(),o("span",Se,[l[0]||(l[0]=c("b",null,"Visit:",-1)),U(" "+M(e.patient.latestVisitDate),1)])):O("",!0),null!==(p=e.patient)&&void 0!==p&&p.patientID?(n(),o("span",Oe,M(e.patient.patientID),1)):O("",!0)])):O("",!0),0===s.value&&(null!==(g=e.patient)&&void 0!==g&&g.patientName||null!==(m=e.patient)&&void 0!==m&&m.gender||null!==(y=e.patient)&&void 0!==y&&y.diagnoses&&e.patient.diagnoses.length>0)?(n(),o("div",je,[null!==(b=e.patient)&&void 0!==b&&b.patientName||null!==(x=e.patient)&&void 0!==x&&x.gender?(n(),o("span",Ve,[c("b",null,M(null===(h=e.patient)||void 0===h?void 0:h.patientName)+M(null!==(_=e.patient)&&void 0!==_&&_.gender?`(${e.patient.gender})`:""),1)])):O("",!0),null!==(k=e.patient)&&void 0!==k&&k.prescriber?(n(),o("span",Me,[l[1]||(l[1]=c("b",null,"Seen by:",-1)),U(M(e.patient.prescriber),1)])):O("",!0),null!==(N=e.patient)&&void 0!==N&&N.nextAppointment?(n(),o("span",Ee,[l[2]||(l[2]=c("b",null,"Nxt App:",-1)),U(" "+M(e.patient.nextAppointment),1)])):O("",!0)])):O("",!0),0===s.value&&null!==(D=e.patient)&&void 0!==D&&D.diagnoses&&e.patient.diagnoses.length>0?(n(),o("div",Te,[c("span",$e,[l[3]||(l[3]=c("b",null,"Diagnoses:",-1)),U(" "+M(e.patient.diagnoses.filter(e=>e).join(", ")),1)])])):O("",!0),0===s.value&&v.value?(n(),o("div",qe,[null!==(C=e.patient)&&void 0!==C&&null!==(C=C.vitals)&&void 0!==C&&C.height?(n(),o("span",Ae,M(e.patient.vitals.height||""),1)):O("",!0),null!==(I=e.patient)&&void 0!==I&&null!==(I=I.vitals)&&void 0!==I&&I.weight?(n(),o("span",Ue,M(e.patient.vitals.weight||""),1)):O("",!0),null!==(P=e.patient)&&void 0!==P&&null!==(P=P.vitals)&&void 0!==P&&P.bloodPressure?(n(),o("span",Ge,M(e.patient.vitals.bloodPressure||""),1)):O("",!0),null!==(z=e.patient)&&void 0!==z&&z.bloodGlucose?(n(),o("span",Fe,M(e.patient.bloodGlucose||""),1)):O("",!0)])):O("",!0),f.value.length>0?(n(),o("table",Be,[0===s.value?(n(),o("thead",Le,l[4]||(l[4]=[c("tr",null,[c("th",{style:{border:"1px solid black"}},"Drug"),c("th",{style:{border:"1px solid black"}},"Dose"),c("th",{style:{border:"1px solid black"}},"Freq"),c("th",{style:{border:"1px solid black"}},"Qty")],-1)]))):O("",!0),c("tbody",null,[(n(!0),o(w,null,G(f.value,(e,t)=>(n(),o("tr",{key:t},[c("td",Qe,M((null==e?void 0:e.name)||""),1),c("td",Re,M((null==e?void 0:e.dose)||""),1),c("td",Ye,M((null==e?void 0:e.frequency)||""),1),c("td",Ze,M((null==e?void 0:e.quantity)||""),1)]))),128))])])):O("",!0)],4)}}}),[["__scopeId","data-v-74669b71"]])}}});
