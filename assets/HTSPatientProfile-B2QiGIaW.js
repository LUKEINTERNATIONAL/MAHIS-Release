import{d as nt,af as V,a9 as at,be as lt,b1 as rt,a1 as dt,ai as ct,ah as pt,aP as ut,cb as mt,aQ as ht,aO as gt,aR as vt,M as ft,G as _t,E as St,ae as yt,c0 as kt,I as Dt,a8 as Vt,cM as wt,dA as Ct,$ as bt,bC as It,H as r,e as c,f as l,k as s,l as o,p as Mt,m as u,K as p,P as a,N as k,J as i,F as Tt}from"./vendor-BTD4y0_l.js";import{j as Pt,J as At,Q as Ht,T as Ot,H as v,k as I,o as f,S as D,t as Q,N as Ft,bB as $t,P as Et,aR as Rt,a6 as Bt,aE as Ut,aD as Nt,aN as Wt,l as Gt,_ as zt}from"./index-CHQBF5A7.js";import{D as Lt}from"./DemographicBar-CKr44tpw.js";import{S as jt}from"./SaveProgressModal-DSG6WsTg.js";import{S as xt}from"./Stepper-0ZPVa7Oj.js";import{T as Qt}from"./NextAppointment-OuMC4Got.js";import{l as w}from"./lodash-Dt8AsbQm.js";import{a as J,D as Jt}from"./drug_prescription_service-_c334Bul.js";import Kt from"./WeightHeightChart-dHwBtW3Z.js";import{c as Yt,a as Xt,_ as Zt,m as qt,b as te,d as ee,f as se,v as oe,w as ie,O as ne}from"./PatientProfile.vue_vue_type_script_lang-D1iqbkrH.js";import"./apexcharts-DR6FmxCR.js";import"./OPDOutcome-Cask0stK.js";import"./patient_complaints_service-BljgviWD.js";import"./DashBox-DNuC-Ys-.js";import"./useExposeFromStandardForm-C6-IUGrn.js";import"./BasicForm-Ci9c4wUc.js";import"./DateInputField-BbxdSCBF.js";import"./formatServerData-DiKnOMkf.js";import"./drug_service-CutpIS0x.js";import"./Outcome-Uh7Bgbps.js";import"./TreatmentPlan-t5v_HNZI.js";import"./previousDiagnosis-rq28d-xB.js";import"./group_validation-DaCgJLGE.js";import"./FeatusModal-N2G2FP2Q.js";import"./BasicCard-DliH5qJI.js";import"./PastObstreticHistoryStore-CAY1zW-h.js";import"./lab_order-BSZ_94cY.js";import"./UpcomingFeature-CsCQFy74.js";import"./ncd_appointment_service-ydQDmE4f.js";import"./chartjs-nzlBkdg_.js";import"./customDatePicker.vue_vue_type_style_index_0_lang-m9q6nkqi.js";import"./SetRelationship.vue_vue_type_script_lang-DDK0Bnho.js";import"./relationship_service-DaY3PhmL.js";import"./AdministerOtherVaccinesStore-B9OcBTMD.js";import"./vaccines_service-CwQdyUM0.js";import"./sms_service-DeAP1w1q.js";import"./EIRreportsStore-BQ6HmNCJ.js";import"./Export-B3JOLFnC.js";import"./stock_service-jTxAh0py.js";import"./barcode-qrcode-reader-CrlC_VHh.js";import"./usePatientProfile-BLyj5mcx.js";import"./Registration-vCAT4YiW.js";import"./useLocation-Cvz5BLCL.js";const ae=nt({mixins:[Zt],name:"Home",components:{IonContent:Vt,IonHeader:Dt,IonMenuButton:kt,IonPage:yt,IonTitle:St,IonToolbar:_t,Toolbar:Ot,ToolbarSearch:Ht,DemographicBar:Lt,IonButton:ft,IonCard:vt,IonCardContent:gt,IonCardHeader:ht,IonCardSubtitle:mt,IonCardTitle:ut,IonAccordion:pt,IonAccordionGroup:ct,IonItem:dt,IonLabel:rt,IonModal:lt,Stepper:xt,DynamicButton:At,WeightHeightChart:Kt,PreviousVitals:Pt,customSlider:Xt,IonRow:at,customVaccine:Yt},data(){return{wizardData:[],StepperData:[],isOpen:!1,iconsContent:Gt,current_milestone:"",checkUnderSixWeeks:!1,unprotected_at_birth:"",protectedStatus:"",todays_date:v.toStandardHisDisplayFormat(D.getSessionDate()),lastVaccine:[],visits:[],selectedStatus:7}},computed:{...V(Wt,["vitals"]),...V(Nt,["selectedMedicalDrugsList","nonPharmalogicalTherapyAndOtherNotes","selectedMedicalAllergiesList"]),...V(Ut,["outcomes"]),...V(I,["currentMilestone","missedVaccineSchedules","overDueVaccinesCount","lastVaccinesGiven","lastVaccineGievenDate","nextAppointMentDate"])},async mounted(){this.loadCurrentMilestone(),this.checkAge(),await this.checkProtectedStatus(),await this.openFollowModal(),await this.programEnrollment()},watch:{currentMilestone:{handler(){this.loadCurrentMilestone()}},$route:{async handler(t){t.name=="patientProfile"&&this.patient.patientID&&(await this.checkProtectedStatus(),await this.programEnrollment())}},patient:{async handler(){this.patient&&(await this.checkProtectedStatus(),await this.programEnrollment(),this.checkAge(),this.setMilestoneReload())}}},setup(){return{chevronBackOutline:It,checkmark:bt,ellipsisVerticalSharp:Ct,person:wt}},methods:{handleChange(t){this.selectedStatus=t},async programEnrollment(){if(this.patient.patientID){this.program=new Bt(this.patient.patientID);const t=await this.program.getProgramCurrentStates();if(t)this.selectedStatus=t.state;else{try{await this.program.enrollProgram(),await this.program.setStateId(7)}catch(e){await this.program.setStateId(7)}await this.program.updateState(),this.selectedStatus=7}}},async updateState(t){this.selectedStatus=t,await this.program.setStateId(t),await this.program.updateState()},getAge(t){return v.calculateDisplayAge(v.toStandardHisFormat(t))},async checkProtectedStatus(){this.protectedStatus=this.getData(this.patient.birthRegistration,11759)[0]},getData(t,e){return t?t.filter(n=>n.concept_id==e).map(n=>n.value_text):""},checkAge(){var t,e,n,m;w.isEmpty((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)||(this.checkUnderSixWeeks=v.dateDiffInDays(v.sessionDate(),(m=(n=this.patient)==null?void 0:n.personInformation)==null?void 0:m.birthdate)<42)},openVitalsModal(){f(ne,{class:"otherVitalsModal"})},openWH(){f(ie,{class:"otherVitalsModal"})},openVH(){f(oe,{class:"otherVitalsModal vaccineHistoryModal"})},async openFollowModal(){var t;if((t=this.patient)!=null&&t.patientID){this.lastVaccine=await Rt.getLastDrugsReceived(this.patient.patientID);const e={protectedStatus:this.protectedStatus,lastVaccinesGiven:this.lastVaccinesGiven};this.lastVaccinesGiven.length>0&&f(se,{class:"fullScreenModal"},!0,e)}},openAdministerVaccineModal(){f(ee,{class:"otherVitalsModal"})},openAdministerOtherVaccineModal(){f(te,{class:"otherVitalsModal"})},isChild(){return!!new Et().isUnderFive()},getFormatedData(t){return t.map(e=>e==null?void 0:e.data)},async saveVitals(){if(this.vitals.validationStatus){const t=D.getUserID();new $t(this.patient.patientID,t).onFinish(this.vitals)}},async saveTreatmentPlan(){const t=D.getUserID(),e=this.patient.patientID,n=new Qt;if(!w.isEmpty(this.selectedMedicalAllergiesList)){const m=this.mapToAllergies();n.onSubmitAllergies(e,t,m)}if(!w.isEmpty(this.nonPharmalogicalTherapyAndOtherNotes)){const m=[{concept_id:2688,obs_datetime:D.getSessionDate(),value_text:this.nonPharmalogicalTherapyAndOtherNotes}];n.onSubmitNotes(e,t,m)}if(!w.isEmpty(this.selectedMedicalDrugsList)){const m=this.mapToOrders(),C=new J(e,t);if(!await C.createEncounter())return Q("Unable to create treatment encounter");if(!await C.createDrugOrder(m))return Q("Unable to create drug orders!");Ft("Drug order has been created")}},openModal(){f(jt)},mapToOrders(){return this.selectedMedicalDrugsList.map(t=>{const e=J.getSessionDate(),n=Jt.find(m=>m.label===t.frequency)||{};return{drug_inventory_id:t.drug_id,equivalent_daily_dose:t.dose=="Unknown"?0:t.dose*(n==null?void 0:n.value)||0,start_date:e,auto_expire_date:this.calculateExpireDate(e,t.duration),units:t.units,instructions:"".concat(t.drugName,": ").concat(t.dose," ").concat(t.units," ").concat((n==null?void 0:n.code)||""," for ").concat(t.duration," days"),dose:t.dose,frequency:(n==null?void 0:n.code)||""}})},formatBirthdate(){var t,e;return v.toStandardHisDisplayFormat((e=(t=this.patient)==null?void 0:t.personInformation)==null?void 0:e.birthdate)},calculateExpireDate(t,e){const n=new Date(t);return n.setDate(n.getDate()+parseInt(e)),v.toStandardHisFormat(n)},mapToAllergies(){return this.selectedMedicalAllergiesList.map(t=>({concept_id:985,obs_datetime:D.getSessionDate(),value_coded:t.concept_id}))},loadCurrentMilestone(){const t=I();this.current_milestone=t.getCurrentMilestone()},showMissedVaccines(){this.missedVaccineSchedules.length>0&&f(qt,{class:"otherVitalsModal vaccineHistoryModal"})},setMilestoneReload(){const t=I();t.setVaccineReload(!t.getVaccineReload())},getLastVaccinesGivenDisplayDate(){return v.toStandardHisDisplayFormat(this.lastVaccineGievenDate)}}}),le={fullscreen:!0,style:{"--background":"#fff"}},re={class:"demographics"},de={style:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},ce={style:{display:"flex","justify-content":"space-between","align-content":"center","padding-bottom":"5px","padding-top":"5px","padding-left":"5px"}},pe={style:{"margin-right":"5px"}},ue={class:"demographicsFirstRow"},me={class:"name"},he={class:"demographicsOtherRow",style:{"margin-top":"10px"}},ge={class:"demographicsText"},ve={key:0,class:"demographicsOtherRow"},fe={class:"demographicsText mediumFontColor"},_e={key:1,class:"demographicsOtherRow"},Se={class:"demographicsText mediumFontColor"},ye={class:"demographicsOtherRow"},ke={class:"demographicsText smallFont"},De={class:"mediumFontColor"},Ve={class:"demographicsOtherRow"},we={key:0,class:"demographicsText smallFont"},Ce={key:1,class:"demographicsText smallFont"},be={key:2,class:"demographicsText smallFont"},Ie={class:"demographicsOtherRow",style:{"margin-bottom":"10px"}},Me={class:"demographicsText smallFont"},Te={key:0,style:{background:"#fedf89",color:"#b54708"},class:"protectedStatus"},Pe={key:1,style:{background:"#ddeedd"},class:"protectedStatus"},Ae={key:2,class:"protectedStatus",style:{background:"#fecdca",color:"#b42318"}},He={class:"graphSection"},Oe={class:"graphBtn",style:{"margin-bottom":"5px"}},Fe={class:"weightHeightGraphBtns"},$e={key:0},Ee={key:1},Re={key:0,class:"graphBtn"},Be={class:"dueAlert"},Ue={class:"missed_vaccine_alert"},Ne={style:{"margin-right":"5px"}},We={class:"vaccinesTitle"},Ge={style:{width:"100%",display:"flex","justify-content":"space-between","align-content":"center"}},ze={class:"vaccinesTitleDate"},Le={class:"milestone"},je={style:{display:"flex","justify-content":"space-between","align-content":"center"}},xe={style:{color:"#636363","margin-left":"5px","margin-top":"-4px"}},Qe={style:{color:"#636363","font-weight":"bold","font-size":"14px"}},Je={class:"lastVaccine"},Ke={class:"lastVaccineTitle"},Ye={key:0,class:"lastVaccineText"},Xe={class:"seeFullList"},Ze={style:{color:"#316cba","margin-left":"1%"}},qe={style:{"margin-bottom":"10px"}},ts={style:{"margin-bottom":"10px"}},es={style:{"margin-bottom":"10px"}},ss={class:"ion-padding",slot:"content"};function os(t,e,n,m,C,K){var T,P,A,H,O,F,$,E,R,B,U,N,W,G,z,L,j,x;const h=r("ion-icon"),Y=r("WeightHeightChart"),X=r("PreviousVitals"),_=r("ion-button"),Z=r("ion-col"),q=r("ion-row"),tt=r("customSlider"),M=r("row"),et=r("customVaccine"),S=r("ion-label"),g=r("ion-item"),y=r("ion-accordion"),b=r("ion-toggle"),st=r("ion-list"),ot=r("ion-accordion-group"),it=r("ion-popover");return l(),c(Tt,null,[s("div",le,[s("div",re,[s("div",de,[s("div",ce,[s("div",pe,[s("div",{class:Mt(((P=(T=t.patient)==null?void 0:T.personInformation)==null?void 0:P.gender)=="M"?"initialsBox maleColor":"initialsBox femaleColor")},[o(h,{style:{color:"#fff","font-size":"100px"},icon:t.person},null,8,["icon"])],2)]),s("div",null,[s("div",ue,[s("div",me,p((H=(A=t.patient)==null?void 0:A.personInformation)==null?void 0:H.given_name)+" "+p((F=(O=t.patient)==null?void 0:O.personInformation)==null?void 0:F.middle_name)+" "+p((E=($=t.patient)==null?void 0:$.personInformation)==null?void 0:E.family_name),1)]),s("div",he,[s("div",ge,[a(p(((B=(R=t.patient)==null?void 0:R.personInformation)==null?void 0:B.gender)=="M"?"Male":"Female")+" ",1),e[15]||(e[15]=s("span",{class:"dot"},".",-1)),a(" "+p(t.getAge((N=(U=t.patient)==null?void 0:U.personInformation)==null?void 0:N.birthdate))+" ("+p(t.formatBirthdate())+") ",1)])]),(G=(W=t.patient)==null?void 0:W.personInformation)!=null&&G.current_district?(l(),c("div",ve,[e[16]||(e[16]=s("div",{class:"demographicsText"},"Current Address:",-1)),s("div",fe,p(t.formatCurrentAddress(t.patient)),1)])):u("",!0),(L=(z=t.patient)==null?void 0:z.personInformation)!=null&&L.country?(l(),c("div",_e,[e[17]||(e[17]=s("div",{class:"demographicsText"},"Country:",-1)),s("div",Se,p((x=(j=t.patient)==null?void 0:j.personInformation)==null?void 0:x.country),1)])):u("",!0),s("div",ye,[s("div",ke,[e[18]||(e[18]=a(" MRN: ",-1)),s("span",De,p(t.patient.ID),1)])]),s("div",Ve,[t.selectedStatus==7?(l(),c("div",we,e[19]||(e[19]=[a(" Outcome: ",-1),s("span",{class:"outcomeStatus"}," Active",-1)]))):u("",!0),t.selectedStatus==6?(l(),c("div",Ce,e[20]||(e[20]=[a(" Outcome: ",-1),s("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Inactive",-1)]))):u("",!0),t.selectedStatus==3?(l(),c("div",be,e[21]||(e[21]=[a(" Outcome: ",-1),s("span",{class:"outcomeStatus",style:{background:"#fecdca",color:"#b42318"}}," Died",-1)]))):u("",!0)]),s("div",Ie,[s("div",Me,[e[22]||(e[22]=a(" Status: ",-1)),t.protectedStatus=="No"?(l(),c("span",Te,"Unprotected at birth")):t.protectedStatus=="Yes"?(l(),c("span",Pe,"Protected at birth")):(l(),c("span",Ae,"Unknown protection at birth"))])])])])]),s("div",{class:"name",style:{color:"var(--ion-color-primary)","margin-top":"10px"},onClick:e[0]||(e[0]=d=>t.openPopover(d))},[o(h,{icon:t.ellipsisVerticalSharp},null,8,["icon"])])]),s("div",He,[s("div",null,[t.isChild()?(l(),k(Y,{key:0,checkUnderSixWeeks:t.checkUnderSixWeeks,showHeightWeight:!0},null,8,["checkUnderSixWeeks"])):u("",!0),t.isChild()?u("",!0):(l(),k(X,{key:1}))]),s("div",Oe,[s("div",Fe,[s("div",null,[o(_,{class:"btnText",fill:"solid",onClick:e[1]||(e[1]=d=>t.openWH())},{default:i(()=>[t.checkUnderSixWeeks?(l(),c("span",Ee," Enter Weight")):(l(),c("span",$e," Enter Weight/Height")),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteHeightWeight},null,8,["icon"])]),_:1})]),s("div",null,[o(_,{class:"btnText",fill:"solid",onClick:e[2]||(e[2]=d=>t.openVitalsModal())},{default:i(()=>[e[23]||(e[23]=a(" Enter Other Vitals ",-1)),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[23]})])])])]),s("div",null,[t.overDueVaccinesCount>0?(l(),c("div",Re,[s("div",Be,[o(q,null,{default:i(()=>[t.overDueVaccinesCount>0?(l(),k(Z,{key:0,style:{display:"flex","justify-content":"center",cursor:"pointer"},onClick:t.showMissedVaccines},{default:i(()=>[s("div",Ue,[o(h,{slot:"start",icon:t.iconsContent.alertDangerRed},null,8,["icon"]),s("span",Ne,p(t.overDueVaccinesCount)+" vaccine(s) overdue",1)])]),_:1},8,["onClick"])):u("",!0)]),_:1})])])):u("",!0),s("div",We,[s("div",Ge,[e[25]||(e[25]=s("div",{class:"vaccinesTitleText"},"Administer Vaccines",-1)),s("div",ze,[e[24]||(e[24]=s("span",{style:{"font-size":"13px"}},"Next Appt. Date: ",-1)),s("b",null,p(t.nextAppointMentDate),1)])])]),s("div",Le,[s("div",je,[o(h,{size:"small",icon:t.iconsContent.greenCalender},null,8,["icon"]),s("div",xe,[e[26]||(e[26]=a(" at ",-1)),s("span",Qe,p(t.current_milestone),1)])]),e[27]||(e[27]=s("div",{class:"vaccinesTitleDate"},"(Swipe left or right for other milestones)",-1))]),o(tt),s("div",Je,[s("div",Ke,[t.lastVaccinesGiven.length>0?(l(),c("div",Ye,"Last vaccines given")):u("",!0),s("div",Xe,[o(_,{onClick:e[3]||(e[3]=d=>t.openVH()),style:{color:"#016302"},class:"btnText btnTextWeight",size:"small",fill:"clear"},{default:i(()=>e[28]||(e[28]=[s("span",null,"See full History",-1)])),_:1,__:[28]})])]),t.lastVaccinesGiven.length>0?(l(),k(M,{key:0},{default:i(()=>[o(h,{size:"medium",style:{"margin-bottom":"-6px"},icon:t.iconsContent.calendar},null,8,["icon"]),s("span",Ze,p(t.getLastVaccinesGivenDisplayDate()),1)]),_:1})):u("",!0),t.lastVaccinesGiven.length>0?(l(),k(M,{key:1},{default:i(()=>[o(et,{vaccines:t.lastVaccinesGiven,milestone_status:""},null,8,["vaccines"])]),_:1})):u("",!0)]),s("div",null,[s("div",qe,[o(_,{class:"btnText",fill:"solid",onClick:e[4]||(e[4]=d=>t.openVitalsModal())},{default:i(()=>[e[29]||(e[29]=a(" HIV Test ",-1)),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[29]})]),s("div",ts,[o(_,{class:"btnText",fill:"solid",onClick:e[5]||(e[5]=d=>t.openVitalsModal())},{default:i(()=>[e[30]||(e[30]=a(" Hepatitis B ",-1)),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[30]})]),s("div",es,[o(_,{class:"btnText",fill:"solid",onClick:e[6]||(e[6]=d=>t.openVitalsModal())},{default:i(()=>[e[31]||(e[31]=a(" Hepatitis B ",-1)),o(h,{slot:"end",size:"small",icon:t.iconsContent.whiteVitals},null,8,["icon"])]),_:1,__:[31]})])])])]),o(it,{style:{"--offset-x":"-10px"},"is-open":t.popoverOpen,"show-backdrop":!1,event:t.event,onDidDismiss:e[14]||(e[14]=d=>t.popoverOpen=!1)},{default:i(()=>[s("div",null,[o(ot,{multiple:!0},{default:i(()=>[o(y,{value:"first","toggle-icon":"",onClick:e[7]||(e[7]=d=>t.openPIM())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(S,null,{default:i(()=>e[32]||(e[32]=[a("Update demographics",-1)])),_:1,__:[32]})]),_:1})]),_:1}),o(y,{value:"first","toggle-icon":"",onClick:e[8]||(e[8]=d=>t.openFollowModal())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(S,null,{default:i(()=>e[33]||(e[33]=[a("Follow up visits",-1)])),_:1,__:[33]})]),_:1})]),_:1}),o(y,{value:"second","toggle-icon":"",onClick:e[9]||(e[9]=d=>t.printVisitSummary())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(S,null,{default:i(()=>e[34]||(e[34]=[a("Print visit summary",-1)])),_:1,__:[34]})]),_:1})]),_:1}),o(y,{value:"third","toggle-icon":"",onClick:e[10]||(e[10]=d=>t.printID())},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(S,null,{default:i(()=>e[35]||(e[35]=[a("Print client identifier",-1)])),_:1,__:[35]})]),_:1})]),_:1}),o(y,{value:"fourth"},{default:i(()=>[o(g,{slot:"header",color:"light"},{default:i(()=>[o(S,null,{default:i(()=>e[36]||(e[36]=[a("Update outcome",-1)])),_:1,__:[36]})]),_:1}),s("div",ss,[o(st,null,{default:i(()=>[o(g,null,{default:i(()=>[o(b,{checked:t.selectedStatus==7,value:"active",onIonChange:e[11]||(e[11]=d=>t.updateState(7))},{default:i(()=>e[37]||(e[37]=[a(" Active ",-1)])),_:1,__:[37]},8,["checked"])]),_:1}),o(g,null,{default:i(()=>[o(b,{checked:t.selectedStatus==6,value:"inactive",onIonChange:e[12]||(e[12]=d=>t.updateState(6))},{default:i(()=>e[38]||(e[38]=[a(" Inactive ",-1)])),_:1,__:[38]},8,["checked"])]),_:1}),o(g,null,{default:i(()=>[o(b,{checked:t.selectedStatus==3,value:"died",onIonChange:e[13]||(e[13]=d=>t.updateState(3))},{default:i(()=>e[39]||(e[39]=[a(" Died ",-1)])),_:1,__:[39]},8,["checked"])]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1},8,["is-open","event"])],64)}const Qs=zt(ae,[["render",os],["__scopeId","data-v-a009f5c7"]]);export{Qs as default};
